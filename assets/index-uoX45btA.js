function _mergeNamespaces(_,e){for(var j=0;j<e.length;j++){const Vt=e[j];if(typeof Vt!="string"&&!Array.isArray(Vt)){for(const zt in Vt)if(zt!=="default"&&!(zt in _)){const _r=Object.getOwnPropertyDescriptor(Vt,zt);_r&&Object.defineProperty(_,zt,_r.get?_r:{enumerable:!0,get:()=>Vt[zt]})}}}return Object.freeze(Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const zt of document.querySelectorAll('link[rel="modulepreload"]'))Vt(zt);new MutationObserver(zt=>{for(const _r of zt)if(_r.type==="childList")for(const _o of _r.addedNodes)_o.tagName==="LINK"&&_o.rel==="modulepreload"&&Vt(_o)}).observe(document,{childList:!0,subtree:!0});function j(zt){const _r={};return zt.integrity&&(_r.integrity=zt.integrity),zt.referrerPolicy&&(_r.referrerPolicy=zt.referrerPolicy),zt.crossOrigin==="use-credentials"?_r.credentials="include":zt.crossOrigin==="anonymous"?_r.credentials="omit":_r.credentials="same-origin",_r}function Vt(zt){if(zt.ep)return;zt.ep=!0;const _r=j(zt);fetch(zt.href,_r)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$b=Symbol.for("react.element"),n$7=Symbol.for("react.portal"),p$g=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$5=Symbol.for("react.profiler"),t$l=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w$6=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(_){return _===null||typeof _!="object"?null:(_=z$1&&_[z$1]||_["@@iterator"],typeof _=="function"?_:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(_,e,j){this.props=_,this.context=e,this.refs=D$1,this.updater=j||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(_,e){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,e,"setState")};E$1.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(_,e,j){this.props=_,this.context=e,this.refs=D$1,this.updater=j||B$1}var H$2=G$1.prototype=new F;H$2.constructor=G$1;C$1(H$2,E$1.prototype);H$2.isPureReactComponent=!0;var I$6=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(_,e,j){var Vt,zt={},_r=null,_o=null;if(e!=null)for(Vt in e.ref!==void 0&&(_o=e.ref),e.key!==void 0&&(_r=""+e.key),e)J.call(e,Vt)&&!L$1.hasOwnProperty(Vt)&&(zt[Vt]=e[Vt]);var ga=arguments.length-2;if(ga===1)zt.children=j;else if(1<ga){for(var _a=Array(ga),_l=0;_l<ga;_l++)_a[_l]=arguments[_l+2];zt.children=_a}if(_&&_.defaultProps)for(Vt in ga=_.defaultProps,ga)zt[Vt]===void 0&&(zt[Vt]=ga[Vt]);return{$$typeof:l$b,type:_,key:_r,ref:_o,props:zt,_owner:K$1.current}}function N$1(_,e){return{$$typeof:l$b,type:_.type,key:e,ref:_.ref,props:_.props,_owner:_._owner}}function O$1(_){return typeof _=="object"&&_!==null&&_.$$typeof===l$b}function escape$1(_){var e={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function(j){return e[j]})}var P$2=/\/+/g;function Q$1(_,e){return typeof _=="object"&&_!==null&&_.key!=null?escape$1(""+_.key):e.toString(36)}function R$2(_,e,j,Vt,zt){var _r=typeof _;(_r==="undefined"||_r==="boolean")&&(_=null);var _o=!1;if(_===null)_o=!0;else switch(_r){case"string":case"number":_o=!0;break;case"object":switch(_.$$typeof){case l$b:case n$7:_o=!0}}if(_o)return _o=_,zt=zt(_o),_=Vt===""?"."+Q$1(_o,0):Vt,I$6(zt)?(j="",_!=null&&(j=_.replace(P$2,"$&/")+"/"),R$2(zt,e,j,"",function(_l){return _l})):zt!=null&&(O$1(zt)&&(zt=N$1(zt,j+(!zt.key||_o&&_o.key===zt.key?"":(""+zt.key).replace(P$2,"$&/")+"/")+_)),e.push(zt)),1;if(_o=0,Vt=Vt===""?".":Vt+":",I$6(_))for(var ga=0;ga<_.length;ga++){_r=_[ga];var _a=Vt+Q$1(_r,ga);_o+=R$2(_r,e,j,_a,zt)}else if(_a=A$1(_),typeof _a=="function")for(_=_a.call(_),ga=0;!(_r=_.next()).done;)_r=_r.value,_a=Vt+Q$1(_r,ga++),_o+=R$2(_r,e,j,_a,zt);else if(_r==="object")throw e=String(_),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return _o}function S$1(_,e,j){if(_==null)return _;var Vt=[],zt=0;return R$2(_,Vt,"","",function(_r){return e.call(j,_r,zt++)}),Vt}function T$1(_){if(_._status===-1){var e=_._result;e=e(),e.then(function(j){(_._status===0||_._status===-1)&&(_._status=1,_._result=j)},function(j){(_._status===0||_._status===-1)&&(_._status=2,_._result=j)}),_._status===-1&&(_._status=0,_._result=e)}if(_._status===1)return _._result.default;throw _._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(_,e,j){S$1(_,function(){e.apply(this,arguments)},j)},count:function(_){var e=0;return S$1(_,function(){e++}),e},toArray:function(_){return S$1(_,function(e){return e})||[]},only:function(_){if(!O$1(_))throw Error("React.Children.only expected to receive a single React element child.");return _}};react_production_min.Component=E$1;react_production_min.Fragment=p$g;react_production_min.Profiler=r$5;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w$6;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(_,e,j){if(_==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+_+".");var Vt=C$1({},_.props),zt=_.key,_r=_.ref,_o=_._owner;if(e!=null){if(e.ref!==void 0&&(_r=e.ref,_o=K$1.current),e.key!==void 0&&(zt=""+e.key),_.type&&_.type.defaultProps)var ga=_.type.defaultProps;for(_a in e)J.call(e,_a)&&!L$1.hasOwnProperty(_a)&&(Vt[_a]=e[_a]===void 0&&ga!==void 0?ga[_a]:e[_a])}var _a=arguments.length-2;if(_a===1)Vt.children=j;else if(1<_a){ga=Array(_a);for(var _l=0;_l<_a;_l++)ga[_l]=arguments[_l+2];Vt.children=ga}return{$$typeof:l$b,type:_.type,key:zt,ref:_r,props:Vt,_owner:_o}};react_production_min.createContext=function(_){return _={$$typeof:u,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},_.Provider={$$typeof:t$l,_context:_},_.Consumer=_};react_production_min.createElement=M$1;react_production_min.createFactory=function(_){var e=M$1.bind(null,_);return e.type=_,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(_){return{$$typeof:v$1,render:_}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(_){return{$$typeof:y$1,_payload:{_status:-1,_result:_},_init:T$1}};react_production_min.memo=function(_,e){return{$$typeof:x,type:_,compare:e===void 0?null:e}};react_production_min.startTransition=function(_){var e=V$1.transition;V$1.transition={};try{_()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(_,e){return U$1.current.useCallback(_,e)};react_production_min.useContext=function(_){return U$1.current.useContext(_)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(_){return U$1.current.useDeferredValue(_)};react_production_min.useEffect=function(_,e){return U$1.current.useEffect(_,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(_,e,j){return U$1.current.useImperativeHandle(_,e,j)};react_production_min.useInsertionEffect=function(_,e){return U$1.current.useInsertionEffect(_,e)};react_production_min.useLayoutEffect=function(_,e){return U$1.current.useLayoutEffect(_,e)};react_production_min.useMemo=function(_,e){return U$1.current.useMemo(_,e)};react_production_min.useReducer=function(_,e,j){return U$1.current.useReducer(_,e,j)};react_production_min.useRef=function(_){return U$1.current.useRef(_)};react_production_min.useState=function(_){return U$1.current.useState(_)};react_production_min.useSyncExternalStore=function(_,e,j){return U$1.current.useSyncExternalStore(_,e,j)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$f=reactExports,k$1=Symbol.for("react.element"),l$a=Symbol.for("react.fragment"),m$e=Object.prototype.hasOwnProperty,n$6=f$f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$f={key:!0,ref:!0,__self:!0,__source:!0};function q(_,e,j){var Vt,zt={},_r=null,_o=null;j!==void 0&&(_r=""+j),e.key!==void 0&&(_r=""+e.key),e.ref!==void 0&&(_o=e.ref);for(Vt in e)m$e.call(e,Vt)&&!p$f.hasOwnProperty(Vt)&&(zt[Vt]=e[Vt]);if(_&&_.defaultProps)for(Vt in e=_.defaultProps,e)zt[Vt]===void 0&&(zt[Vt]=e[Vt]);return{$$typeof:k$1,type:_,key:_r,ref:_o,props:zt,_owner:n$6.current}}reactJsxRuntime_production_min.Fragment=l$a;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(_){function e(RE,FE){var VE=RE.length;RE.push(FE);e:for(;0<VE;){var BE=VE-1>>>1,qE=RE[BE];if(0<zt(qE,FE))RE[BE]=FE,RE[VE]=qE,VE=BE;else break e}}function j(RE){return RE.length===0?null:RE[0]}function Vt(RE){if(RE.length===0)return null;var FE=RE[0],VE=RE.pop();if(VE!==FE){RE[0]=VE;e:for(var BE=0,qE=RE.length,e_=qE>>>1;BE<e_;){var b_=2*(BE+1)-1,m_=RE[b_],I_=b_+1,w0=RE[I_];if(0>zt(m_,VE))I_<qE&&0>zt(w0,m_)?(RE[BE]=w0,RE[I_]=VE,BE=I_):(RE[BE]=m_,RE[b_]=VE,BE=b_);else if(I_<qE&&0>zt(w0,VE))RE[BE]=w0,RE[I_]=VE,BE=I_;else break e}}return FE}function zt(RE,FE){var VE=RE.sortIndex-FE.sortIndex;return VE!==0?VE:RE.id-FE.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _r=performance;_.unstable_now=function(){return _r.now()}}else{var _o=Date,ga=_o.now();_.unstable_now=function(){return _o.now()-ga}}var _a=[],_l=[],_d=1,_f=null,_m=3,tE=!1,rE=!1,oE=!1,dE=typeof setTimeout=="function"?setTimeout:null,nE=typeof clearTimeout=="function"?clearTimeout:null,sE=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function lE(RE){for(var FE=j(_l);FE!==null;){if(FE.callback===null)Vt(_l);else if(FE.startTime<=RE)Vt(_l),FE.sortIndex=FE.expirationTime,e(_a,FE);else break;FE=j(_l)}}function EE(RE){if(oE=!1,lE(RE),!rE)if(j(_a)!==null)rE=!0,jE(wE);else{var FE=j(_l);FE!==null&&UE(EE,FE.startTime-RE)}}function wE(RE,FE){rE=!1,oE&&(oE=!1,nE(kE),kE=-1),tE=!0;var VE=_m;try{for(lE(FE),_f=j(_a);_f!==null&&(!(_f.expirationTime>FE)||RE&&!LE());){var BE=_f.callback;if(typeof BE=="function"){_f.callback=null,_m=_f.priorityLevel;var qE=BE(_f.expirationTime<=FE);FE=_.unstable_now(),typeof qE=="function"?_f.callback=qE:_f===j(_a)&&Vt(_a),lE(FE)}else Vt(_a);_f=j(_a)}if(_f!==null)var e_=!0;else{var b_=j(_l);b_!==null&&UE(EE,b_.startTime-FE),e_=!1}return e_}finally{_f=null,_m=VE,tE=!1}}var IE=!1,_E=null,kE=-1,ME=5,bE=-1;function LE(){return!(_.unstable_now()-bE<ME)}function TE(){if(_E!==null){var RE=_.unstable_now();bE=RE;var FE=!0;try{FE=_E(!0,RE)}finally{FE?OE():(IE=!1,_E=null)}}else IE=!1}var OE;if(typeof sE=="function")OE=function(){sE(TE)};else if(typeof MessageChannel<"u"){var vE=new MessageChannel,NE=vE.port2;vE.port1.onmessage=TE,OE=function(){NE.postMessage(null)}}else OE=function(){dE(TE,0)};function jE(RE){_E=RE,IE||(IE=!0,OE())}function UE(RE,FE){kE=dE(function(){RE(_.unstable_now())},FE)}_.unstable_IdlePriority=5,_.unstable_ImmediatePriority=1,_.unstable_LowPriority=4,_.unstable_NormalPriority=3,_.unstable_Profiling=null,_.unstable_UserBlockingPriority=2,_.unstable_cancelCallback=function(RE){RE.callback=null},_.unstable_continueExecution=function(){rE||tE||(rE=!0,jE(wE))},_.unstable_forceFrameRate=function(RE){0>RE||125<RE?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ME=0<RE?Math.floor(1e3/RE):5},_.unstable_getCurrentPriorityLevel=function(){return _m},_.unstable_getFirstCallbackNode=function(){return j(_a)},_.unstable_next=function(RE){switch(_m){case 1:case 2:case 3:var FE=3;break;default:FE=_m}var VE=_m;_m=FE;try{return RE()}finally{_m=VE}},_.unstable_pauseExecution=function(){},_.unstable_requestPaint=function(){},_.unstable_runWithPriority=function(RE,FE){switch(RE){case 1:case 2:case 3:case 4:case 5:break;default:RE=3}var VE=_m;_m=RE;try{return FE()}finally{_m=VE}},_.unstable_scheduleCallback=function(RE,FE,VE){var BE=_.unstable_now();switch(typeof VE=="object"&&VE!==null?(VE=VE.delay,VE=typeof VE=="number"&&0<VE?BE+VE:BE):VE=BE,RE){case 1:var qE=-1;break;case 2:qE=250;break;case 5:qE=1073741823;break;case 4:qE=1e4;break;default:qE=5e3}return qE=VE+qE,RE={id:_d++,callback:FE,priorityLevel:RE,startTime:VE,expirationTime:qE,sortIndex:-1},VE>BE?(RE.sortIndex=VE,e(_l,RE),j(_a)===null&&RE===j(_l)&&(oE?(nE(kE),kE=-1):oE=!0,UE(EE,VE-BE))):(RE.sortIndex=qE,e(_a,RE),rE||tE||(rE=!0,jE(wE))),RE},_.unstable_shouldYield=LE,_.unstable_wrapCallback=function(RE){var FE=_m;return function(){var VE=_m;_m=FE;try{return RE.apply(this,arguments)}finally{_m=VE}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$e(_){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+_,j=1;j<arguments.length;j++)e+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+_+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(_,e){ha(_,e),ha(_+"Capture",e)}function ha(_,e){for(ea[_]=e,_=0;_<e.length;_++)da.add(e[_])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(_){return ja.call(ma,_)?!0:ja.call(la,_)?!1:ka.test(_)?ma[_]=!0:(la[_]=!0,!1)}function pa(_,e,j,Vt){if(j!==null&&j.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return Vt?!1:j!==null?!j.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function qa(_,e,j,Vt){if(e===null||typeof e>"u"||pa(_,e,j,Vt))return!0;if(Vt)return!1;if(j!==null)switch(j.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v(_,e,j,Vt,zt,_r,_o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=Vt,this.attributeNamespace=zt,this.mustUseProperty=j,this.propertyName=_,this.type=e,this.sanitizeURL=_r,this.removeEmptyString=_o}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){z[_]=new v(_,0,!1,_,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var e=_[0];z[e]=new v(e,1,!1,_[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(_){z[_]=new v(_,2,!1,_.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){z[_]=new v(_,2,!1,_,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){z[_]=new v(_,3,!1,_.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(_){z[_]=new v(_,3,!0,_,null,!1,!1)});["capture","download"].forEach(function(_){z[_]=new v(_,4,!1,_,null,!1,!1)});["cols","rows","size","span"].forEach(function(_){z[_]=new v(_,6,!1,_,null,!1,!1)});["rowSpan","start"].forEach(function(_){z[_]=new v(_,5,!1,_.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var e=_.replace(ra,sa);z[e]=new v(e,1,!1,_,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var e=_.replace(ra,sa);z[e]=new v(e,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(_){var e=_.replace(ra,sa);z[e]=new v(e,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(_){z[_]=new v(_,1,!1,_.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(_){z[_]=new v(_,1,!1,_.toLowerCase(),null,!0,!0)});function ta(_,e,j,Vt){var zt=z.hasOwnProperty(e)?z[e]:null;(zt!==null?zt.type!==0:Vt||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,j,zt,Vt)&&(j=null),Vt||zt===null?oa(e)&&(j===null?_.removeAttribute(e):_.setAttribute(e,""+j)):zt.mustUseProperty?_[zt.propertyName]=j===null?zt.type===3?!1:"":j:(e=zt.attributeName,Vt=zt.attributeNamespace,j===null?_.removeAttribute(e):(zt=zt.type,j=zt===3||zt===4&&j===!0?"":""+j,Vt?_.setAttributeNS(Vt,e,j):_.setAttribute(e,j))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(_){return _===null||typeof _!="object"?null:(_=Ja&&_[Ja]||_["@@iterator"],typeof _=="function"?_:null)}var A=Object.assign,La;function Ma(_){if(La===void 0)try{throw Error()}catch(j){var e=j.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+_}var Na=!1;function Oa(_,e){if(!_||Na)return"";Na=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_l){var Vt=_l}Reflect.construct(_,[],e)}else{try{e.call()}catch(_l){Vt=_l}_.call(e.prototype)}else{try{throw Error()}catch(_l){Vt=_l}_()}}catch(_l){if(_l&&Vt&&typeof _l.stack=="string"){for(var zt=_l.stack.split(`
`),_r=Vt.stack.split(`
`),_o=zt.length-1,ga=_r.length-1;1<=_o&&0<=ga&&zt[_o]!==_r[ga];)ga--;for(;1<=_o&&0<=ga;_o--,ga--)if(zt[_o]!==_r[ga]){if(_o!==1||ga!==1)do if(_o--,ga--,0>ga||zt[_o]!==_r[ga]){var _a=`
`+zt[_o].replace(" at new "," at ");return _.displayName&&_a.includes("<anonymous>")&&(_a=_a.replace("<anonymous>",_.displayName)),_a}while(1<=_o&&0<=ga);break}}}finally{Na=!1,Error.prepareStackTrace=j}return(_=_?_.displayName||_.name:"")?Ma(_):""}function Pa(_){switch(_.tag){case 5:return Ma(_.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return _=Oa(_.type,!1),_;case 11:return _=Oa(_.type.render,!1),_;case 1:return _=Oa(_.type,!0),_;default:return""}}function Qa(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Ca:return(_.displayName||"Context")+".Consumer";case Ba:return(_._context.displayName||"Context")+".Provider";case Da:var e=_.render;return _=_.displayName,_||(_=e.displayName||e.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Ga:return e=_.displayName||null,e!==null?e:Qa(_.type)||"Memo";case Ha:e=_._payload,_=_._init;try{return Qa(_(e))}catch{}}return null}function Ra(_){var e=_.type;switch(_.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=e.render,_=_.displayName||_.name||"",e.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function Ta(_){var e=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(_){var e=Ta(_)?"checked":"value",j=Object.getOwnPropertyDescriptor(_.constructor.prototype,e),Vt=""+_[e];if(!_.hasOwnProperty(e)&&typeof j<"u"&&typeof j.get=="function"&&typeof j.set=="function"){var zt=j.get,_r=j.set;return Object.defineProperty(_,e,{configurable:!0,get:function(){return zt.call(this)},set:function(_o){Vt=""+_o,_r.call(this,_o)}}),Object.defineProperty(_,e,{enumerable:j.enumerable}),{getValue:function(){return Vt},setValue:function(_o){Vt=""+_o},stopTracking:function(){_._valueTracker=null,delete _[e]}}}}function Va(_){_._valueTracker||(_._valueTracker=Ua(_))}function Wa(_){if(!_)return!1;var e=_._valueTracker;if(!e)return!0;var j=e.getValue(),Vt="";return _&&(Vt=Ta(_)?_.checked?"true":"false":_.value),_=Vt,_!==j?(e.setValue(_),!0):!1}function Xa(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function Ya(_,e){var j=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:j??_._wrapperState.initialChecked})}function Za(_,e){var j=e.defaultValue==null?"":e.defaultValue,Vt=e.checked!=null?e.checked:e.defaultChecked;j=Sa(e.value!=null?e.value:j),_._wrapperState={initialChecked:Vt,initialValue:j,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(_,e){e=e.checked,e!=null&&ta(_,"checked",e,!1)}function bb(_,e){ab(_,e);var j=Sa(e.value),Vt=e.type;if(j!=null)Vt==="number"?(j===0&&_.value===""||_.value!=j)&&(_.value=""+j):_.value!==""+j&&(_.value=""+j);else if(Vt==="submit"||Vt==="reset"){_.removeAttribute("value");return}e.hasOwnProperty("value")?cb(_,e.type,j):e.hasOwnProperty("defaultValue")&&cb(_,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(_.defaultChecked=!!e.defaultChecked)}function db(_,e,j){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var Vt=e.type;if(!(Vt!=="submit"&&Vt!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+_._wrapperState.initialValue,j||e===_.value||(_.value=e),_.defaultValue=e}j=_.name,j!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,j!==""&&(_.name=j)}function cb(_,e,j){(e!=="number"||Xa(_.ownerDocument)!==_)&&(j==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+j&&(_.defaultValue=""+j))}var eb=Array.isArray;function fb(_,e,j,Vt){if(_=_.options,e){e={};for(var zt=0;zt<j.length;zt++)e["$"+j[zt]]=!0;for(j=0;j<_.length;j++)zt=e.hasOwnProperty("$"+_[j].value),_[j].selected!==zt&&(_[j].selected=zt),zt&&Vt&&(_[j].defaultSelected=!0)}else{for(j=""+Sa(j),e=null,zt=0;zt<_.length;zt++){if(_[zt].value===j){_[zt].selected=!0,Vt&&(_[zt].defaultSelected=!0);return}e!==null||_[zt].disabled||(e=_[zt])}e!==null&&(e.selected=!0)}}function gb(_,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p$e(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function hb(_,e){var j=e.value;if(j==null){if(j=e.children,e=e.defaultValue,j!=null){if(e!=null)throw Error(p$e(92));if(eb(j)){if(1<j.length)throw Error(p$e(93));j=j[0]}e=j}e==null&&(e=""),j=e}_._wrapperState={initialValue:Sa(j)}}function ib(_,e){var j=Sa(e.value),Vt=Sa(e.defaultValue);j!=null&&(j=""+j,j!==_.value&&(_.value=j),e.defaultValue==null&&_.defaultValue!==j&&(_.defaultValue=j)),Vt!=null&&(_.defaultValue=""+Vt)}function jb(_){var e=_.textContent;e===_._wrapperState.initialValue&&e!==""&&e!==null&&(_.value=e)}function kb(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(_,e){return _==null||_==="http://www.w3.org/1999/xhtml"?kb(e):_==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var mb,nb=function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,j,Vt,zt){MSApp.execUnsafeLocalFunction(function(){return _(e,j,Vt,zt)})}:_}(function(_,e){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;e.firstChild;)_.appendChild(e.firstChild)}});function ob(_,e){if(e){var j=_.firstChild;if(j&&j===_.lastChild&&j.nodeType===3){j.nodeValue=e;return}}_.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(_){qb.forEach(function(e){e=e+_.charAt(0).toUpperCase()+_.substring(1),pb[e]=pb[_]})});function rb(_,e,j){return e==null||typeof e=="boolean"||e===""?"":j||typeof e!="number"||e===0||pb.hasOwnProperty(_)&&pb[_]?(""+e).trim():e+"px"}function sb(_,e){_=_.style;for(var j in e)if(e.hasOwnProperty(j)){var Vt=j.indexOf("--")===0,zt=rb(j,e[j],Vt);j==="float"&&(j="cssFloat"),Vt?_.setProperty(j,zt):_[j]=zt}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(_,e){if(e){if(tb[_]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p$e(137,_));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p$e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p$e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p$e(62))}}function vb(_,e){if(_.indexOf("-")===-1)return typeof e.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var yb=null,zb=null,Ab=null;function Bb(_){if(_=Cb(_)){if(typeof yb!="function")throw Error(p$e(280));var e=_.stateNode;e&&(e=Db(e),yb(_.stateNode,_.type,e))}}function Eb(_){zb?Ab?Ab.push(_):Ab=[_]:zb=_}function Fb(){if(zb){var _=zb,e=Ab;if(Ab=zb=null,Bb(_),e)for(_=0;_<e.length;_++)Bb(e[_])}}function Gb(_,e){return _(e)}function Hb(){}var Ib=!1;function Jb(_,e,j){if(Ib)return _(e,j);Ib=!0;try{return Gb(_,e,j)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(_,e){var j=_.stateNode;if(j===null)return null;var Vt=Db(j);if(Vt===null)return null;j=Vt[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(Vt=!Vt.disabled)||(_=_.type,Vt=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!Vt;break e;default:_=!1}if(_)return null;if(j&&typeof j!="function")throw Error(p$e(231,e,typeof j));return j}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(_,e,j,Vt,zt,_r,_o,ga,_a){var _l=Array.prototype.slice.call(arguments,3);try{e.apply(j,_l)}catch(_d){this.onError(_d)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(_){Ob=!0,Pb=_}};function Tb(_,e,j,Vt,zt,_r,_o,ga,_a){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(_,e,j,Vt,zt,_r,_o,ga,_a){if(Tb.apply(this,arguments),Ob){if(Ob){var _l=Pb;Ob=!1,Pb=null}else throw Error(p$e(198));Qb||(Qb=!0,Rb=_l)}}function Vb(_){var e=_,j=_;if(_.alternate)for(;e.return;)e=e.return;else{_=e;do e=_,e.flags&4098&&(j=e.return),_=e.return;while(_)}return e.tag===3?j:null}function Wb(_){if(_.tag===13){var e=_.memoizedState;if(e===null&&(_=_.alternate,_!==null&&(e=_.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(_){if(Vb(_)!==_)throw Error(p$e(188))}function Yb(_){var e=_.alternate;if(!e){if(e=Vb(_),e===null)throw Error(p$e(188));return e!==_?null:_}for(var j=_,Vt=e;;){var zt=j.return;if(zt===null)break;var _r=zt.alternate;if(_r===null){if(Vt=zt.return,Vt!==null){j=Vt;continue}break}if(zt.child===_r.child){for(_r=zt.child;_r;){if(_r===j)return Xb(zt),_;if(_r===Vt)return Xb(zt),e;_r=_r.sibling}throw Error(p$e(188))}if(j.return!==Vt.return)j=zt,Vt=_r;else{for(var _o=!1,ga=zt.child;ga;){if(ga===j){_o=!0,j=zt,Vt=_r;break}if(ga===Vt){_o=!0,Vt=zt,j=_r;break}ga=ga.sibling}if(!_o){for(ga=_r.child;ga;){if(ga===j){_o=!0,j=_r,Vt=zt;break}if(ga===Vt){_o=!0,Vt=_r,j=zt;break}ga=ga.sibling}if(!_o)throw Error(p$e(189))}}if(j.alternate!==Vt)throw Error(p$e(190))}if(j.tag!==3)throw Error(p$e(188));return j.stateNode.current===j?_:e}function Zb(_){return _=Yb(_),_!==null?$b(_):null}function $b(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var e=$b(_);if(e!==null)return e;_=_.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(_){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,_,void 0,(_.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(_){return _>>>=0,_===0?32:31-(pc(_)/qc|0)|0}var rc=64,sc=4194304;function tc(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function uc(_,e){var j=_.pendingLanes;if(j===0)return 0;var Vt=0,zt=_.suspendedLanes,_r=_.pingedLanes,_o=j&268435455;if(_o!==0){var ga=_o&~zt;ga!==0?Vt=tc(ga):(_r&=_o,_r!==0&&(Vt=tc(_r)))}else _o=j&~zt,_o!==0?Vt=tc(_o):_r!==0&&(Vt=tc(_r));if(Vt===0)return 0;if(e!==0&&e!==Vt&&!(e&zt)&&(zt=Vt&-Vt,_r=e&-e,zt>=_r||zt===16&&(_r&4194240)!==0))return e;if(Vt&4&&(Vt|=j&16),e=_.entangledLanes,e!==0)for(_=_.entanglements,e&=Vt;0<e;)j=31-oc(e),zt=1<<j,Vt|=_[j],e&=~zt;return Vt}function vc(_,e){switch(_){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(_,e){for(var j=_.suspendedLanes,Vt=_.pingedLanes,zt=_.expirationTimes,_r=_.pendingLanes;0<_r;){var _o=31-oc(_r),ga=1<<_o,_a=zt[_o];_a===-1?(!(ga&j)||ga&Vt)&&(zt[_o]=vc(ga,e)):_a<=e&&(_.expiredLanes|=ga),_r&=~ga}}function xc(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function yc(){var _=rc;return rc<<=1,!(rc&4194240)&&(rc=64),_}function zc(_){for(var e=[],j=0;31>j;j++)e.push(_);return e}function Ac(_,e,j){_.pendingLanes|=e,e!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,e=31-oc(e),_[e]=j}function Bc(_,e){var j=_.pendingLanes&~e;_.pendingLanes=e,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=e,_.mutableReadLanes&=e,_.entangledLanes&=e,e=_.entanglements;var Vt=_.eventTimes;for(_=_.expirationTimes;0<j;){var zt=31-oc(j),_r=1<<zt;e[zt]=0,Vt[zt]=-1,_[zt]=-1,j&=~_r}}function Cc(_,e){var j=_.entangledLanes|=e;for(_=_.entanglements;j;){var Vt=31-oc(j),zt=1<<Vt;zt&e|_[Vt]&e&&(_[Vt]|=e),j&=~zt}}var C=0;function Dc(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(_,e){switch(_){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(_,e,j,Vt,zt,_r){return _===null||_.nativeEvent!==_r?(_={blockedOn:e,domEventName:j,eventSystemFlags:Vt,nativeEvent:_r,targetContainers:[zt]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),_):(_.eventSystemFlags|=Vt,e=_.targetContainers,zt!==null&&e.indexOf(zt)===-1&&e.push(zt),_)}function Uc(_,e,j,Vt,zt){switch(e){case"focusin":return Lc=Tc(Lc,_,e,j,Vt,zt),!0;case"dragenter":return Mc=Tc(Mc,_,e,j,Vt,zt),!0;case"mouseover":return Nc=Tc(Nc,_,e,j,Vt,zt),!0;case"pointerover":var _r=zt.pointerId;return Oc.set(_r,Tc(Oc.get(_r)||null,_,e,j,Vt,zt)),!0;case"gotpointercapture":return _r=zt.pointerId,Pc.set(_r,Tc(Pc.get(_r)||null,_,e,j,Vt,zt)),!0}return!1}function Vc(_){var e=Wc(_.target);if(e!==null){var j=Vb(e);if(j!==null){if(e=j.tag,e===13){if(e=Wb(j),e!==null){_.blockedOn=e,Ic(_.priority,function(){Gc(j)});return}}else if(e===3&&j.stateNode.current.memoizedState.isDehydrated){_.blockedOn=j.tag===3?j.stateNode.containerInfo:null;return}}}_.blockedOn=null}function Xc(_){if(_.blockedOn!==null)return!1;for(var e=_.targetContainers;0<e.length;){var j=Yc(_.domEventName,_.eventSystemFlags,e[0],_.nativeEvent);if(j===null){j=_.nativeEvent;var Vt=new j.constructor(j.type,j);wb=Vt,j.target.dispatchEvent(Vt),wb=null}else return e=Cb(j),e!==null&&Fc(e),_.blockedOn=j,!1;e.shift()}return!0}function Zc(_,e,j){Xc(_)&&j.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(_,e){_.blockedOn===e&&(_.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(_){function e(zt){return ad(zt,_)}if(0<Kc.length){ad(Kc[0],_);for(var j=1;j<Kc.length;j++){var Vt=Kc[j];Vt.blockedOn===_&&(Vt.blockedOn=null)}}for(Lc!==null&&ad(Lc,_),Mc!==null&&ad(Mc,_),Nc!==null&&ad(Nc,_),Oc.forEach(e),Pc.forEach(e),j=0;j<Qc.length;j++)Vt=Qc[j],Vt.blockedOn===_&&(Vt.blockedOn=null);for(;0<Qc.length&&(j=Qc[0],j.blockedOn===null);)Vc(j),j.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(_,e,j,Vt){var zt=C,_r=cd.transition;cd.transition=null;try{C=1,fd(_,e,j,Vt)}finally{C=zt,cd.transition=_r}}function gd(_,e,j,Vt){var zt=C,_r=cd.transition;cd.transition=null;try{C=4,fd(_,e,j,Vt)}finally{C=zt,cd.transition=_r}}function fd(_,e,j,Vt){if(dd){var zt=Yc(_,e,j,Vt);if(zt===null)hd(_,e,Vt,id,j),Sc(_,Vt);else if(Uc(zt,_,e,j,Vt))Vt.stopPropagation();else if(Sc(_,Vt),e&4&&-1<Rc.indexOf(_)){for(;zt!==null;){var _r=Cb(zt);if(_r!==null&&Ec(_r),_r=Yc(_,e,j,Vt),_r===null&&hd(_,e,Vt,id,j),_r===zt)break;zt=_r}zt!==null&&Vt.stopPropagation()}else hd(_,e,Vt,null,j)}}var id=null;function Yc(_,e,j,Vt){if(id=null,_=xb(Vt),_=Wc(_),_!==null)if(e=Vb(_),e===null)_=null;else if(j=e.tag,j===13){if(_=Wb(e),_!==null)return _;_=null}else if(j===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;_=null}else e!==_&&(_=null);return id=_,null}function jd(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var _,e=ld,j=e.length,Vt,zt="value"in kd?kd.value:kd.textContent,_r=zt.length;for(_=0;_<j&&e[_]===zt[_];_++);var _o=j-_;for(Vt=1;Vt<=_o&&e[j-Vt]===zt[_r-Vt];Vt++);return md=zt.slice(_,1<Vt?1-Vt:void 0)}function od(_){var e=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&e===13&&(_=13)):_=e,_===10&&(_=13),32<=_||_===13?_:0}function pd(){return!0}function qd(){return!1}function rd(_){function e(j,Vt,zt,_r,_o){this._reactName=j,this._targetInst=zt,this.type=Vt,this.nativeEvent=_r,this.target=_o,this.currentTarget=null;for(var ga in _)_.hasOwnProperty(ga)&&(j=_[ga],this[ga]=j?j(_r):_r[ga]);return this.isDefaultPrevented=(_r.defaultPrevented!=null?_r.defaultPrevented:_r.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var j=this.nativeEvent;j&&(j.preventDefault?j.preventDefault():typeof j.returnValue!="unknown"&&(j.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var j=this.nativeEvent;j&&(j.stopPropagation?j.stopPropagation():typeof j.cancelBubble!="unknown"&&(j.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==yd&&(yd&&_.type==="mousemove"?(wd=_.screenX-yd.screenX,xd=_.screenY-yd.screenY):xd=wd=0,yd=_),wd)},movementY:function(_){return"movementY"in _?_.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(_){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(_):(_=Od[_])?!!e[_]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(_){if(_.key){var e=Md[_.key]||_.key;if(e!=="Unidentified")return e}return _.type==="keypress"?(_=od(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?Nd[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(_){return _.type==="keypress"?od(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?od(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(_,e){switch(_){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var ie=!1;function je(_,e){switch(_){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return _=e.data,_===ee&&fe?null:_;default:return null}}function ke(_,e){if(ie)return _==="compositionend"||!ae&&ge(_,e)?(_=nd(),md=ld=kd=null,ie=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(_){var e=_&&_.nodeName&&_.nodeName.toLowerCase();return e==="input"?!!le[_.type]:e==="textarea"}function ne(_,e,j,Vt){Eb(Vt),e=oe(e,"onChange"),0<e.length&&(j=new td("onChange","change",null,j,Vt),_.push({event:j,listeners:e}))}var pe=null,qe=null;function re$1(_){se(_,0)}function te(_){var e=ue(_);if(Wa(e))return _}function ve(_,e){if(_==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(_){if(_.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,_,xb(_)),Jb(re$1,e)}}function Ce(_,e,j){_==="focusin"?(Ae(),pe=e,qe=j,pe.attachEvent("onpropertychange",Be)):_==="focusout"&&Ae()}function De(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return te(qe)}function Ee(_,e){if(_==="click")return te(e)}function Fe(_,e){if(_==="input"||_==="change")return te(e)}function Ge(_,e){return _===e&&(_!==0||1/_===1/e)||_!==_&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(_,e){if(He(_,e))return!0;if(typeof _!="object"||_===null||typeof e!="object"||e===null)return!1;var j=Object.keys(_),Vt=Object.keys(e);if(j.length!==Vt.length)return!1;for(Vt=0;Vt<j.length;Vt++){var zt=j[Vt];if(!ja.call(e,zt)||!He(_[zt],e[zt]))return!1}return!0}function Je(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Ke(_,e){var j=Je(_);_=0;for(var Vt;j;){if(j.nodeType===3){if(Vt=_+j.textContent.length,_<=e&&Vt>=e)return{node:j,offset:e-_};_=Vt}e:{for(;j;){if(j.nextSibling){j=j.nextSibling;break e}j=j.parentNode}j=void 0}j=Je(j)}}function Le(_,e){return _&&e?_===e?!0:_&&_.nodeType===3?!1:e&&e.nodeType===3?Le(_,e.parentNode):"contains"in _?_.contains(e):_.compareDocumentPosition?!!(_.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var _=window,e=Xa();e instanceof _.HTMLIFrameElement;){try{var j=typeof e.contentWindow.location.href=="string"}catch{j=!1}if(j)_=e.contentWindow;else break;e=Xa(_.document)}return e}function Ne(_){var e=_&&_.nodeName&&_.nodeName.toLowerCase();return e&&(e==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||e==="textarea"||_.contentEditable==="true")}function Oe(_){var e=Me(),j=_.focusedElem,Vt=_.selectionRange;if(e!==j&&j&&j.ownerDocument&&Le(j.ownerDocument.documentElement,j)){if(Vt!==null&&Ne(j)){if(e=Vt.start,_=Vt.end,_===void 0&&(_=e),"selectionStart"in j)j.selectionStart=e,j.selectionEnd=Math.min(_,j.value.length);else if(_=(e=j.ownerDocument||document)&&e.defaultView||window,_.getSelection){_=_.getSelection();var zt=j.textContent.length,_r=Math.min(Vt.start,zt);Vt=Vt.end===void 0?_r:Math.min(Vt.end,zt),!_.extend&&_r>Vt&&(zt=Vt,Vt=_r,_r=zt),zt=Ke(j,_r);var _o=Ke(j,Vt);zt&&_o&&(_.rangeCount!==1||_.anchorNode!==zt.node||_.anchorOffset!==zt.offset||_.focusNode!==_o.node||_.focusOffset!==_o.offset)&&(e=e.createRange(),e.setStart(zt.node,zt.offset),_.removeAllRanges(),_r>Vt?(_.addRange(e),_.extend(_o.node,_o.offset)):(e.setEnd(_o.node,_o.offset),_.addRange(e)))}}for(e=[],_=j;_=_.parentNode;)_.nodeType===1&&e.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<e.length;j++)_=e[j],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(_,e,j){var Vt=j.window===j?j.document:j.nodeType===9?j:j.ownerDocument;Te||Qe==null||Qe!==Xa(Vt)||(Vt=Qe,"selectionStart"in Vt&&Ne(Vt)?Vt={start:Vt.selectionStart,end:Vt.selectionEnd}:(Vt=(Vt.ownerDocument&&Vt.ownerDocument.defaultView||window).getSelection(),Vt={anchorNode:Vt.anchorNode,anchorOffset:Vt.anchorOffset,focusNode:Vt.focusNode,focusOffset:Vt.focusOffset}),Se&&Ie(Se,Vt)||(Se=Vt,Vt=oe(Re,"onSelect"),0<Vt.length&&(e=new td("onSelect","select",null,e,j),_.push({event:e,listeners:Vt}),e.target=Qe)))}function Ve(_,e){var j={};return j[_.toLowerCase()]=e.toLowerCase(),j["Webkit"+_]="webkit"+e,j["Moz"+_]="moz"+e,j}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(_){if(Xe[_])return Xe[_];if(!We[_])return _;var e=We[_],j;for(j in e)if(e.hasOwnProperty(j)&&j in Ye)return Xe[_]=e[j];return _}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(_,e){df.set(_,e),fa(e,[_])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(_,e,j){var Vt=_.type||"unknown-event";_.currentTarget=j,Ub(Vt,e,void 0,_),_.currentTarget=null}function se(_,e){e=(e&4)!==0;for(var j=0;j<_.length;j++){var Vt=_[j],zt=Vt.event;Vt=Vt.listeners;e:{var _r=void 0;if(e)for(var _o=Vt.length-1;0<=_o;_o--){var ga=Vt[_o],_a=ga.instance,_l=ga.currentTarget;if(ga=ga.listener,_a!==_r&&zt.isPropagationStopped())break e;nf(zt,ga,_l),_r=_a}else for(_o=0;_o<Vt.length;_o++){if(ga=Vt[_o],_a=ga.instance,_l=ga.currentTarget,ga=ga.listener,_a!==_r&&zt.isPropagationStopped())break e;nf(zt,ga,_l),_r=_a}}}if(Qb)throw _=Rb,Qb=!1,Rb=null,_}function D(_,e){var j=e[of];j===void 0&&(j=e[of]=new Set);var Vt=_+"__bubble";j.has(Vt)||(pf(e,_,2,!1),j.add(Vt))}function qf(_,e,j){var Vt=0;e&&(Vt|=4),pf(j,_,Vt,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(_){if(!_[rf]){_[rf]=!0,da.forEach(function(j){j!=="selectionchange"&&(mf.has(j)||qf(j,!1,_),qf(j,!0,_))});var e=_.nodeType===9?_:_.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(_,e,j,Vt){switch(jd(e)){case 1:var zt=ed;break;case 4:zt=gd;break;default:zt=fd}j=zt.bind(null,e,j,_),zt=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(zt=!0),Vt?zt!==void 0?_.addEventListener(e,j,{capture:!0,passive:zt}):_.addEventListener(e,j,!0):zt!==void 0?_.addEventListener(e,j,{passive:zt}):_.addEventListener(e,j,!1)}function hd(_,e,j,Vt,zt){var _r=Vt;if(!(e&1)&&!(e&2)&&Vt!==null)e:for(;;){if(Vt===null)return;var _o=Vt.tag;if(_o===3||_o===4){var ga=Vt.stateNode.containerInfo;if(ga===zt||ga.nodeType===8&&ga.parentNode===zt)break;if(_o===4)for(_o=Vt.return;_o!==null;){var _a=_o.tag;if((_a===3||_a===4)&&(_a=_o.stateNode.containerInfo,_a===zt||_a.nodeType===8&&_a.parentNode===zt))return;_o=_o.return}for(;ga!==null;){if(_o=Wc(ga),_o===null)return;if(_a=_o.tag,_a===5||_a===6){Vt=_r=_o;continue e}ga=ga.parentNode}}Vt=Vt.return}Jb(function(){var _l=_r,_d=xb(j),_f=[];e:{var _m=df.get(_);if(_m!==void 0){var tE=td,rE=_;switch(_){case"keypress":if(od(j)===0)break e;case"keydown":case"keyup":tE=Rd;break;case"focusin":rE="focus",tE=Fd;break;case"focusout":rE="blur",tE=Fd;break;case"beforeblur":case"afterblur":tE=Fd;break;case"click":if(j.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tE=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tE=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tE=Vd;break;case $e:case af:case bf:tE=Hd;break;case cf:tE=Xd;break;case"scroll":tE=vd;break;case"wheel":tE=Zd;break;case"copy":case"cut":case"paste":tE=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tE=Td}var oE=(e&4)!==0,dE=!oE&&_==="scroll",nE=oE?_m!==null?_m+"Capture":null:_m;oE=[];for(var sE=_l,lE;sE!==null;){lE=sE;var EE=lE.stateNode;if(lE.tag===5&&EE!==null&&(lE=EE,nE!==null&&(EE=Kb(sE,nE),EE!=null&&oE.push(tf(sE,EE,lE)))),dE)break;sE=sE.return}0<oE.length&&(_m=new tE(_m,rE,null,j,_d),_f.push({event:_m,listeners:oE}))}}if(!(e&7)){e:{if(_m=_==="mouseover"||_==="pointerover",tE=_==="mouseout"||_==="pointerout",_m&&j!==wb&&(rE=j.relatedTarget||j.fromElement)&&(Wc(rE)||rE[uf]))break e;if((tE||_m)&&(_m=_d.window===_d?_d:(_m=_d.ownerDocument)?_m.defaultView||_m.parentWindow:window,tE?(rE=j.relatedTarget||j.toElement,tE=_l,rE=rE?Wc(rE):null,rE!==null&&(dE=Vb(rE),rE!==dE||rE.tag!==5&&rE.tag!==6)&&(rE=null)):(tE=null,rE=_l),tE!==rE)){if(oE=Bd,EE="onMouseLeave",nE="onMouseEnter",sE="mouse",(_==="pointerout"||_==="pointerover")&&(oE=Td,EE="onPointerLeave",nE="onPointerEnter",sE="pointer"),dE=tE==null?_m:ue(tE),lE=rE==null?_m:ue(rE),_m=new oE(EE,sE+"leave",tE,j,_d),_m.target=dE,_m.relatedTarget=lE,EE=null,Wc(_d)===_l&&(oE=new oE(nE,sE+"enter",rE,j,_d),oE.target=lE,oE.relatedTarget=dE,EE=oE),dE=EE,tE&&rE)t:{for(oE=tE,nE=rE,sE=0,lE=oE;lE;lE=vf(lE))sE++;for(lE=0,EE=nE;EE;EE=vf(EE))lE++;for(;0<sE-lE;)oE=vf(oE),sE--;for(;0<lE-sE;)nE=vf(nE),lE--;for(;sE--;){if(oE===nE||nE!==null&&oE===nE.alternate)break t;oE=vf(oE),nE=vf(nE)}oE=null}else oE=null;tE!==null&&wf(_f,_m,tE,oE,!1),rE!==null&&dE!==null&&wf(_f,dE,rE,oE,!0)}}e:{if(_m=_l?ue(_l):window,tE=_m.nodeName&&_m.nodeName.toLowerCase(),tE==="select"||tE==="input"&&_m.type==="file")var wE=ve;else if(me(_m))if(we)wE=Fe;else{wE=De;var IE=Ce}else(tE=_m.nodeName)&&tE.toLowerCase()==="input"&&(_m.type==="checkbox"||_m.type==="radio")&&(wE=Ee);if(wE&&(wE=wE(_,_l))){ne(_f,wE,j,_d);break e}IE&&IE(_,_m,_l),_==="focusout"&&(IE=_m._wrapperState)&&IE.controlled&&_m.type==="number"&&cb(_m,"number",_m.value)}switch(IE=_l?ue(_l):window,_){case"focusin":(me(IE)||IE.contentEditable==="true")&&(Qe=IE,Re=_l,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(_f,j,_d);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(_f,j,_d)}var _E;if(ae)e:{switch(_){case"compositionstart":var kE="onCompositionStart";break e;case"compositionend":kE="onCompositionEnd";break e;case"compositionupdate":kE="onCompositionUpdate";break e}kE=void 0}else ie?ge(_,j)&&(kE="onCompositionEnd"):_==="keydown"&&j.keyCode===229&&(kE="onCompositionStart");kE&&(de&&j.locale!=="ko"&&(ie||kE!=="onCompositionStart"?kE==="onCompositionEnd"&&ie&&(_E=nd()):(kd=_d,ld="value"in kd?kd.value:kd.textContent,ie=!0)),IE=oe(_l,kE),0<IE.length&&(kE=new Ld(kE,_,null,j,_d),_f.push({event:kE,listeners:IE}),_E?kE.data=_E:(_E=he(j),_E!==null&&(kE.data=_E)))),(_E=ce?je(_,j):ke(_,j))&&(_l=oe(_l,"onBeforeInput"),0<_l.length&&(_d=new Ld("onBeforeInput","beforeinput",null,j,_d),_f.push({event:_d,listeners:_l}),_d.data=_E))}se(_f,e)})}function tf(_,e,j){return{instance:_,listener:e,currentTarget:j}}function oe(_,e){for(var j=e+"Capture",Vt=[];_!==null;){var zt=_,_r=zt.stateNode;zt.tag===5&&_r!==null&&(zt=_r,_r=Kb(_,j),_r!=null&&Vt.unshift(tf(_,_r,zt)),_r=Kb(_,e),_r!=null&&Vt.push(tf(_,_r,zt))),_=_.return}return Vt}function vf(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function wf(_,e,j,Vt,zt){for(var _r=e._reactName,_o=[];j!==null&&j!==Vt;){var ga=j,_a=ga.alternate,_l=ga.stateNode;if(_a!==null&&_a===Vt)break;ga.tag===5&&_l!==null&&(ga=_l,zt?(_a=Kb(j,_r),_a!=null&&_o.unshift(tf(j,_a,ga))):zt||(_a=Kb(j,_r),_a!=null&&_o.push(tf(j,_a,ga)))),j=j.return}_o.length!==0&&_.push({event:e,listeners:_o})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(_){return(typeof _=="string"?_:""+_).replace(xf,`
`).replace(yf,"")}function Af(_,e,j){if(e=zf(e),zf(_)!==e&&j)throw Error(p$e(425))}function Bf(){}var Cf=null,Df=null;function Ef(_,e){return _==="textarea"||_==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(_){return Hf.resolve(null).then(_).catch(If)}:Ff;function If(_){setTimeout(function(){throw _})}function Kf(_,e){var j=e,Vt=0;do{var zt=j.nextSibling;if(_.removeChild(j),zt&&zt.nodeType===8)if(j=zt.data,j==="/$"){if(Vt===0){_.removeChild(zt),bd(e);return}Vt--}else j!=="$"&&j!=="$?"&&j!=="$!"||Vt++;j=zt}while(j);bd(e)}function Lf(_){for(;_!=null;_=_.nextSibling){var e=_.nodeType;if(e===1||e===3)break;if(e===8){if(e=_.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return _}function Mf(_){_=_.previousSibling;for(var e=0;_;){if(_.nodeType===8){var j=_.data;if(j==="$"||j==="$!"||j==="$?"){if(e===0)return _;e--}else j==="/$"&&e++}_=_.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(_){var e=_[Of];if(e)return e;for(var j=_.parentNode;j;){if(e=j[uf]||j[Of]){if(j=e.alternate,e.child!==null||j!==null&&j.child!==null)for(_=Mf(_);_!==null;){if(j=_[Of])return j;_=Mf(_)}return e}_=j,j=_.parentNode}return null}function Cb(_){return _=_[Of]||_[uf],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function ue(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(p$e(33))}function Db(_){return _[Pf]||null}var Sf=[],Tf=-1;function Uf(_){return{current:_}}function E(_){0>Tf||(_.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(_,e){Tf++,Sf[Tf]=_.current,_.current=e}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(_,e){var j=_.type.contextTypes;if(!j)return Vf;var Vt=_.stateNode;if(Vt&&Vt.__reactInternalMemoizedUnmaskedChildContext===e)return Vt.__reactInternalMemoizedMaskedChildContext;var zt={},_r;for(_r in j)zt[_r]=e[_r];return Vt&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=e,_.__reactInternalMemoizedMaskedChildContext=zt),zt}function Zf(_){return _=_.childContextTypes,_!=null}function $f(){E(Wf),E(H$1)}function ag(_,e,j){if(H$1.current!==Vf)throw Error(p$e(168));G(H$1,e),G(Wf,j)}function bg(_,e,j){var Vt=_.stateNode;if(e=e.childContextTypes,typeof Vt.getChildContext!="function")return j;Vt=Vt.getChildContext();for(var zt in Vt)if(!(zt in e))throw Error(p$e(108,Ra(_)||"Unknown",zt));return A({},j,Vt)}function cg(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G(H$1,_),G(Wf,Wf.current),!0}function dg(_,e,j){var Vt=_.stateNode;if(!Vt)throw Error(p$e(169));j?(_=bg(_,e,Xf),Vt.__reactInternalMemoizedMergedChildContext=_,E(Wf),E(H$1),G(H$1,_)):E(Wf),G(Wf,j)}var eg=null,fg=!1,gg=!1;function hg(_){eg===null?eg=[_]:eg.push(_)}function ig(_){fg=!0,hg(_)}function jg(){if(!gg&&eg!==null){gg=!0;var _=0,e=C;try{var j=eg;for(C=1;_<j.length;_++){var Vt=j[_];do Vt=Vt(!0);while(Vt!==null)}eg=null,fg=!1}catch(zt){throw eg!==null&&(eg=eg.slice(_+1)),ac(fc,jg),zt}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(_,e){kg[lg++]=ng,kg[lg++]=mg,mg=_,ng=e}function ug(_,e,j){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=_;var Vt=rg;_=sg;var zt=32-oc(Vt)-1;Vt&=~(1<<zt),j+=1;var _r=32-oc(e)+zt;if(30<_r){var _o=zt-zt%5;_r=(Vt&(1<<_o)-1).toString(32),Vt>>=_o,zt-=_o,rg=1<<32-oc(e)+zt|j<<zt|Vt,sg=_r+_}else rg=1<<_r|j<<zt|Vt,sg=_}function vg(_){_.return!==null&&(tg(_,1),ug(_,1,0))}function wg(_){for(;_===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;_===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$5=!1,zg=null;function Ag(_,e){var j=Bg(5,null,null,0);j.elementType="DELETED",j.stateNode=e,j.return=_,e=_.deletions,e===null?(_.deletions=[j],_.flags|=16):e.push(j)}function Cg(_,e){switch(_.tag){case 5:var j=_.type;return e=e.nodeType!==1||j.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(_.stateNode=e,xg=_,yg=Lf(e.firstChild),!0):!1;case 6:return e=_.pendingProps===""||e.nodeType!==3?null:e,e!==null?(_.stateNode=e,xg=_,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(j=qg!==null?{id:rg,overflow:sg}:null,_.memoizedState={dehydrated:e,treeContext:j,retryLane:1073741824},j=Bg(18,null,null,0),j.stateNode=e,j.return=_,_.child=j,xg=_,yg=null,!0):!1;default:return!1}}function Dg(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Eg(_){if(I$5){var e=yg;if(e){var j=e;if(!Cg(_,e)){if(Dg(_))throw Error(p$e(418));e=Lf(j.nextSibling);var Vt=xg;e&&Cg(_,e)?Ag(Vt,j):(_.flags=_.flags&-4097|2,I$5=!1,xg=_)}}else{if(Dg(_))throw Error(p$e(418));_.flags=_.flags&-4097|2,I$5=!1,xg=_}}}function Fg(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;xg=_}function Gg(_){if(_!==xg)return!1;if(!I$5)return Fg(_),I$5=!0,!1;var e;if((e=_.tag!==3)&&!(e=_.tag!==5)&&(e=_.type,e=e!=="head"&&e!=="body"&&!Ef(_.type,_.memoizedProps)),e&&(e=yg)){if(Dg(_))throw Hg(),Error(p$e(418));for(;e;)Ag(_,e),e=Lf(e.nextSibling)}if(Fg(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(p$e(317));e:{for(_=_.nextSibling,e=0;_;){if(_.nodeType===8){var j=_.data;if(j==="/$"){if(e===0){yg=Lf(_.nextSibling);break e}e--}else j!=="$"&&j!=="$!"&&j!=="$?"||e++}_=_.nextSibling}yg=null}}else yg=xg?Lf(_.stateNode.nextSibling):null;return!0}function Hg(){for(var _=yg;_;)_=Lf(_.nextSibling)}function Ig(){yg=xg=null,I$5=!1}function Jg(_){zg===null?zg=[_]:zg.push(_)}var Kg=ua.ReactCurrentBatchConfig;function Lg(_,e,j){if(_=j.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(j._owner){if(j=j._owner,j){if(j.tag!==1)throw Error(p$e(309));var Vt=j.stateNode}if(!Vt)throw Error(p$e(147,_));var zt=Vt,_r=""+_;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===_r?e.ref:(e=function(_o){var ga=zt.refs;_o===null?delete ga[_r]:ga[_r]=_o},e._stringRef=_r,e)}if(typeof _!="string")throw Error(p$e(284));if(!j._owner)throw Error(p$e(290,_))}return _}function Mg(_,e){throw _=Object.prototype.toString.call(e),Error(p$e(31,_==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":_))}function Ng(_){var e=_._init;return e(_._payload)}function Og(_){function e(nE,sE){if(_){var lE=nE.deletions;lE===null?(nE.deletions=[sE],nE.flags|=16):lE.push(sE)}}function j(nE,sE){if(!_)return null;for(;sE!==null;)e(nE,sE),sE=sE.sibling;return null}function Vt(nE,sE){for(nE=new Map;sE!==null;)sE.key!==null?nE.set(sE.key,sE):nE.set(sE.index,sE),sE=sE.sibling;return nE}function zt(nE,sE){return nE=Pg(nE,sE),nE.index=0,nE.sibling=null,nE}function _r(nE,sE,lE){return nE.index=lE,_?(lE=nE.alternate,lE!==null?(lE=lE.index,lE<sE?(nE.flags|=2,sE):lE):(nE.flags|=2,sE)):(nE.flags|=1048576,sE)}function _o(nE){return _&&nE.alternate===null&&(nE.flags|=2),nE}function ga(nE,sE,lE,EE){return sE===null||sE.tag!==6?(sE=Qg(lE,nE.mode,EE),sE.return=nE,sE):(sE=zt(sE,lE),sE.return=nE,sE)}function _a(nE,sE,lE,EE){var wE=lE.type;return wE===ya?_d(nE,sE,lE.props.children,EE,lE.key):sE!==null&&(sE.elementType===wE||typeof wE=="object"&&wE!==null&&wE.$$typeof===Ha&&Ng(wE)===sE.type)?(EE=zt(sE,lE.props),EE.ref=Lg(nE,sE,lE),EE.return=nE,EE):(EE=Rg(lE.type,lE.key,lE.props,null,nE.mode,EE),EE.ref=Lg(nE,sE,lE),EE.return=nE,EE)}function _l(nE,sE,lE,EE){return sE===null||sE.tag!==4||sE.stateNode.containerInfo!==lE.containerInfo||sE.stateNode.implementation!==lE.implementation?(sE=Sg(lE,nE.mode,EE),sE.return=nE,sE):(sE=zt(sE,lE.children||[]),sE.return=nE,sE)}function _d(nE,sE,lE,EE,wE){return sE===null||sE.tag!==7?(sE=Tg(lE,nE.mode,EE,wE),sE.return=nE,sE):(sE=zt(sE,lE),sE.return=nE,sE)}function _f(nE,sE,lE){if(typeof sE=="string"&&sE!==""||typeof sE=="number")return sE=Qg(""+sE,nE.mode,lE),sE.return=nE,sE;if(typeof sE=="object"&&sE!==null){switch(sE.$$typeof){case va:return lE=Rg(sE.type,sE.key,sE.props,null,nE.mode,lE),lE.ref=Lg(nE,null,sE),lE.return=nE,lE;case wa:return sE=Sg(sE,nE.mode,lE),sE.return=nE,sE;case Ha:var EE=sE._init;return _f(nE,EE(sE._payload),lE)}if(eb(sE)||Ka(sE))return sE=Tg(sE,nE.mode,lE,null),sE.return=nE,sE;Mg(nE,sE)}return null}function _m(nE,sE,lE,EE){var wE=sE!==null?sE.key:null;if(typeof lE=="string"&&lE!==""||typeof lE=="number")return wE!==null?null:ga(nE,sE,""+lE,EE);if(typeof lE=="object"&&lE!==null){switch(lE.$$typeof){case va:return lE.key===wE?_a(nE,sE,lE,EE):null;case wa:return lE.key===wE?_l(nE,sE,lE,EE):null;case Ha:return wE=lE._init,_m(nE,sE,wE(lE._payload),EE)}if(eb(lE)||Ka(lE))return wE!==null?null:_d(nE,sE,lE,EE,null);Mg(nE,lE)}return null}function tE(nE,sE,lE,EE,wE){if(typeof EE=="string"&&EE!==""||typeof EE=="number")return nE=nE.get(lE)||null,ga(sE,nE,""+EE,wE);if(typeof EE=="object"&&EE!==null){switch(EE.$$typeof){case va:return nE=nE.get(EE.key===null?lE:EE.key)||null,_a(sE,nE,EE,wE);case wa:return nE=nE.get(EE.key===null?lE:EE.key)||null,_l(sE,nE,EE,wE);case Ha:var IE=EE._init;return tE(nE,sE,lE,IE(EE._payload),wE)}if(eb(EE)||Ka(EE))return nE=nE.get(lE)||null,_d(sE,nE,EE,wE,null);Mg(sE,EE)}return null}function rE(nE,sE,lE,EE){for(var wE=null,IE=null,_E=sE,kE=sE=0,ME=null;_E!==null&&kE<lE.length;kE++){_E.index>kE?(ME=_E,_E=null):ME=_E.sibling;var bE=_m(nE,_E,lE[kE],EE);if(bE===null){_E===null&&(_E=ME);break}_&&_E&&bE.alternate===null&&e(nE,_E),sE=_r(bE,sE,kE),IE===null?wE=bE:IE.sibling=bE,IE=bE,_E=ME}if(kE===lE.length)return j(nE,_E),I$5&&tg(nE,kE),wE;if(_E===null){for(;kE<lE.length;kE++)_E=_f(nE,lE[kE],EE),_E!==null&&(sE=_r(_E,sE,kE),IE===null?wE=_E:IE.sibling=_E,IE=_E);return I$5&&tg(nE,kE),wE}for(_E=Vt(nE,_E);kE<lE.length;kE++)ME=tE(_E,nE,kE,lE[kE],EE),ME!==null&&(_&&ME.alternate!==null&&_E.delete(ME.key===null?kE:ME.key),sE=_r(ME,sE,kE),IE===null?wE=ME:IE.sibling=ME,IE=ME);return _&&_E.forEach(function(LE){return e(nE,LE)}),I$5&&tg(nE,kE),wE}function oE(nE,sE,lE,EE){var wE=Ka(lE);if(typeof wE!="function")throw Error(p$e(150));if(lE=wE.call(lE),lE==null)throw Error(p$e(151));for(var IE=wE=null,_E=sE,kE=sE=0,ME=null,bE=lE.next();_E!==null&&!bE.done;kE++,bE=lE.next()){_E.index>kE?(ME=_E,_E=null):ME=_E.sibling;var LE=_m(nE,_E,bE.value,EE);if(LE===null){_E===null&&(_E=ME);break}_&&_E&&LE.alternate===null&&e(nE,_E),sE=_r(LE,sE,kE),IE===null?wE=LE:IE.sibling=LE,IE=LE,_E=ME}if(bE.done)return j(nE,_E),I$5&&tg(nE,kE),wE;if(_E===null){for(;!bE.done;kE++,bE=lE.next())bE=_f(nE,bE.value,EE),bE!==null&&(sE=_r(bE,sE,kE),IE===null?wE=bE:IE.sibling=bE,IE=bE);return I$5&&tg(nE,kE),wE}for(_E=Vt(nE,_E);!bE.done;kE++,bE=lE.next())bE=tE(_E,nE,kE,bE.value,EE),bE!==null&&(_&&bE.alternate!==null&&_E.delete(bE.key===null?kE:bE.key),sE=_r(bE,sE,kE),IE===null?wE=bE:IE.sibling=bE,IE=bE);return _&&_E.forEach(function(TE){return e(nE,TE)}),I$5&&tg(nE,kE),wE}function dE(nE,sE,lE,EE){if(typeof lE=="object"&&lE!==null&&lE.type===ya&&lE.key===null&&(lE=lE.props.children),typeof lE=="object"&&lE!==null){switch(lE.$$typeof){case va:e:{for(var wE=lE.key,IE=sE;IE!==null;){if(IE.key===wE){if(wE=lE.type,wE===ya){if(IE.tag===7){j(nE,IE.sibling),sE=zt(IE,lE.props.children),sE.return=nE,nE=sE;break e}}else if(IE.elementType===wE||typeof wE=="object"&&wE!==null&&wE.$$typeof===Ha&&Ng(wE)===IE.type){j(nE,IE.sibling),sE=zt(IE,lE.props),sE.ref=Lg(nE,IE,lE),sE.return=nE,nE=sE;break e}j(nE,IE);break}else e(nE,IE);IE=IE.sibling}lE.type===ya?(sE=Tg(lE.props.children,nE.mode,EE,lE.key),sE.return=nE,nE=sE):(EE=Rg(lE.type,lE.key,lE.props,null,nE.mode,EE),EE.ref=Lg(nE,sE,lE),EE.return=nE,nE=EE)}return _o(nE);case wa:e:{for(IE=lE.key;sE!==null;){if(sE.key===IE)if(sE.tag===4&&sE.stateNode.containerInfo===lE.containerInfo&&sE.stateNode.implementation===lE.implementation){j(nE,sE.sibling),sE=zt(sE,lE.children||[]),sE.return=nE,nE=sE;break e}else{j(nE,sE);break}else e(nE,sE);sE=sE.sibling}sE=Sg(lE,nE.mode,EE),sE.return=nE,nE=sE}return _o(nE);case Ha:return IE=lE._init,dE(nE,sE,IE(lE._payload),EE)}if(eb(lE))return rE(nE,sE,lE,EE);if(Ka(lE))return oE(nE,sE,lE,EE);Mg(nE,lE)}return typeof lE=="string"&&lE!==""||typeof lE=="number"?(lE=""+lE,sE!==null&&sE.tag===6?(j(nE,sE.sibling),sE=zt(sE,lE),sE.return=nE,nE=sE):(j(nE,sE),sE=Qg(lE,nE.mode,EE),sE.return=nE,nE=sE),_o(nE)):j(nE,sE)}return dE}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(_){var e=Wg.current;E(Wg),_._currentValue=e}function bh(_,e,j){for(;_!==null;){var Vt=_.alternate;if((_.childLanes&e)!==e?(_.childLanes|=e,Vt!==null&&(Vt.childLanes|=e)):Vt!==null&&(Vt.childLanes&e)!==e&&(Vt.childLanes|=e),_===j)break;_=_.return}}function ch(_,e){Xg=_,Zg=Yg=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&e&&(dh=!0),_.firstContext=null)}function eh(_){var e=_._currentValue;if(Zg!==_)if(_={context:_,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p$e(308));Yg=_,Xg.dependencies={lanes:0,firstContext:_}}else Yg=Yg.next=_;return e}var fh=null;function gh(_){fh===null?fh=[_]:fh.push(_)}function hh(_,e,j,Vt){var zt=e.interleaved;return zt===null?(j.next=j,gh(e)):(j.next=zt.next,zt.next=j),e.interleaved=j,ih(_,Vt)}function ih(_,e){_.lanes|=e;var j=_.alternate;for(j!==null&&(j.lanes|=e),j=_,_=_.return;_!==null;)_.childLanes|=e,j=_.alternate,j!==null&&(j.childLanes|=e),j=_,_=_.return;return j.tag===3?j.stateNode:null}var jh=!1;function kh(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(_,e){_=_.updateQueue,e.updateQueue===_&&(e.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function mh(_,e){return{eventTime:_,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(_,e,j){var Vt=_.updateQueue;if(Vt===null)return null;if(Vt=Vt.shared,K&2){var zt=Vt.pending;return zt===null?e.next=e:(e.next=zt.next,zt.next=e),Vt.pending=e,ih(_,j)}return zt=Vt.interleaved,zt===null?(e.next=e,gh(Vt)):(e.next=zt.next,zt.next=e),Vt.interleaved=e,ih(_,j)}function oh(_,e,j){if(e=e.updateQueue,e!==null&&(e=e.shared,(j&4194240)!==0)){var Vt=e.lanes;Vt&=_.pendingLanes,j|=Vt,e.lanes=j,Cc(_,j)}}function ph(_,e){var j=_.updateQueue,Vt=_.alternate;if(Vt!==null&&(Vt=Vt.updateQueue,j===Vt)){var zt=null,_r=null;if(j=j.firstBaseUpdate,j!==null){do{var _o={eventTime:j.eventTime,lane:j.lane,tag:j.tag,payload:j.payload,callback:j.callback,next:null};_r===null?zt=_r=_o:_r=_r.next=_o,j=j.next}while(j!==null);_r===null?zt=_r=e:_r=_r.next=e}else zt=_r=e;j={baseState:Vt.baseState,firstBaseUpdate:zt,lastBaseUpdate:_r,shared:Vt.shared,effects:Vt.effects},_.updateQueue=j;return}_=j.lastBaseUpdate,_===null?j.firstBaseUpdate=e:_.next=e,j.lastBaseUpdate=e}function qh(_,e,j,Vt){var zt=_.updateQueue;jh=!1;var _r=zt.firstBaseUpdate,_o=zt.lastBaseUpdate,ga=zt.shared.pending;if(ga!==null){zt.shared.pending=null;var _a=ga,_l=_a.next;_a.next=null,_o===null?_r=_l:_o.next=_l,_o=_a;var _d=_.alternate;_d!==null&&(_d=_d.updateQueue,ga=_d.lastBaseUpdate,ga!==_o&&(ga===null?_d.firstBaseUpdate=_l:ga.next=_l,_d.lastBaseUpdate=_a))}if(_r!==null){var _f=zt.baseState;_o=0,_d=_l=_a=null,ga=_r;do{var _m=ga.lane,tE=ga.eventTime;if((Vt&_m)===_m){_d!==null&&(_d=_d.next={eventTime:tE,lane:0,tag:ga.tag,payload:ga.payload,callback:ga.callback,next:null});e:{var rE=_,oE=ga;switch(_m=e,tE=j,oE.tag){case 1:if(rE=oE.payload,typeof rE=="function"){_f=rE.call(tE,_f,_m);break e}_f=rE;break e;case 3:rE.flags=rE.flags&-65537|128;case 0:if(rE=oE.payload,_m=typeof rE=="function"?rE.call(tE,_f,_m):rE,_m==null)break e;_f=A({},_f,_m);break e;case 2:jh=!0}}ga.callback!==null&&ga.lane!==0&&(_.flags|=64,_m=zt.effects,_m===null?zt.effects=[ga]:_m.push(ga))}else tE={eventTime:tE,lane:_m,tag:ga.tag,payload:ga.payload,callback:ga.callback,next:null},_d===null?(_l=_d=tE,_a=_f):_d=_d.next=tE,_o|=_m;if(ga=ga.next,ga===null){if(ga=zt.shared.pending,ga===null)break;_m=ga,ga=_m.next,_m.next=null,zt.lastBaseUpdate=_m,zt.shared.pending=null}}while(!0);if(_d===null&&(_a=_f),zt.baseState=_a,zt.firstBaseUpdate=_l,zt.lastBaseUpdate=_d,e=zt.shared.interleaved,e!==null){zt=e;do _o|=zt.lane,zt=zt.next;while(zt!==e)}else _r===null&&(zt.shared.lanes=0);rh|=_o,_.lanes=_o,_.memoizedState=_f}}function sh(_,e,j){if(_=e.effects,e.effects=null,_!==null)for(e=0;e<_.length;e++){var Vt=_[e],zt=Vt.callback;if(zt!==null){if(Vt.callback=null,Vt=j,typeof zt!="function")throw Error(p$e(191,zt));zt.call(Vt)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(_){if(_===th)throw Error(p$e(174));return _}function yh(_,e){switch(G(wh,e),G(vh,_),G(uh,th),_=e.nodeType,_){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:_=_===8?e.parentNode:e,e=_.namespaceURI||null,_=_.tagName,e=lb(e,_)}E(uh),G(uh,e)}function zh(){E(uh),E(vh),E(wh)}function Ah(_){xh(wh.current);var e=xh(uh.current),j=lb(e,_.type);e!==j&&(G(vh,_),G(uh,j))}function Bh(_){vh.current===_&&(E(uh),E(vh))}var L=Uf(0);function Ch(_){for(var e=_;e!==null;){if(e.tag===13){var j=e.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||j.data==="$?"||j.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===_)break;for(;e.sibling===null;){if(e.return===null||e.return===_)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var _=0;_<Dh.length;_++)Dh[_]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$e(321))}function Mh(_,e){if(e===null)return!1;for(var j=0;j<e.length&&j<_.length;j++)if(!He(_[j],e[j]))return!1;return!0}function Nh(_,e,j,Vt,zt,_r){if(Hh=_r,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=_===null||_.memoizedState===null?Oh:Ph,_=j(Vt,zt),Jh){_r=0;do{if(Jh=!1,Kh=0,25<=_r)throw Error(p$e(301));_r+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,_=j(Vt,zt)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p$e(300));return _}function Sh(){var _=Kh!==0;return Kh=0,_}function Th(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=_:O=O.next=_,O}function Uh(){if(N===null){var _=M.alternate;_=_!==null?_.memoizedState:null}else _=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=_;else{if(_===null)throw Error(p$e(310));N=_,_={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=_:O=O.next=_}return O}function Vh(_,e){return typeof e=="function"?e(_):e}function Wh(_){var e=Uh(),j=e.queue;if(j===null)throw Error(p$e(311));j.lastRenderedReducer=_;var Vt=N,zt=Vt.baseQueue,_r=j.pending;if(_r!==null){if(zt!==null){var _o=zt.next;zt.next=_r.next,_r.next=_o}Vt.baseQueue=zt=_r,j.pending=null}if(zt!==null){_r=zt.next,Vt=Vt.baseState;var ga=_o=null,_a=null,_l=_r;do{var _d=_l.lane;if((Hh&_d)===_d)_a!==null&&(_a=_a.next={lane:0,action:_l.action,hasEagerState:_l.hasEagerState,eagerState:_l.eagerState,next:null}),Vt=_l.hasEagerState?_l.eagerState:_(Vt,_l.action);else{var _f={lane:_d,action:_l.action,hasEagerState:_l.hasEagerState,eagerState:_l.eagerState,next:null};_a===null?(ga=_a=_f,_o=Vt):_a=_a.next=_f,M.lanes|=_d,rh|=_d}_l=_l.next}while(_l!==null&&_l!==_r);_a===null?_o=Vt:_a.next=ga,He(Vt,e.memoizedState)||(dh=!0),e.memoizedState=Vt,e.baseState=_o,e.baseQueue=_a,j.lastRenderedState=Vt}if(_=j.interleaved,_!==null){zt=_;do _r=zt.lane,M.lanes|=_r,rh|=_r,zt=zt.next;while(zt!==_)}else zt===null&&(j.lanes=0);return[e.memoizedState,j.dispatch]}function Xh(_){var e=Uh(),j=e.queue;if(j===null)throw Error(p$e(311));j.lastRenderedReducer=_;var Vt=j.dispatch,zt=j.pending,_r=e.memoizedState;if(zt!==null){j.pending=null;var _o=zt=zt.next;do _r=_(_r,_o.action),_o=_o.next;while(_o!==zt);He(_r,e.memoizedState)||(dh=!0),e.memoizedState=_r,e.baseQueue===null&&(e.baseState=_r),j.lastRenderedState=_r}return[_r,Vt]}function Yh(){}function Zh(_,e){var j=M,Vt=Uh(),zt=e(),_r=!He(Vt.memoizedState,zt);if(_r&&(Vt.memoizedState=zt,dh=!0),Vt=Vt.queue,$h(ai.bind(null,j,Vt,_),[_]),Vt.getSnapshot!==e||_r||O!==null&&O.memoizedState.tag&1){if(j.flags|=2048,bi(9,ci.bind(null,j,Vt,zt,e),void 0,null),Q===null)throw Error(p$e(349));Hh&30||di(j,e,zt)}return zt}function di(_,e,j){_.flags|=16384,_={getSnapshot:e,value:j},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[_]):(j=e.stores,j===null?e.stores=[_]:j.push(_))}function ci(_,e,j,Vt){e.value=j,e.getSnapshot=Vt,ei(e)&&fi(_)}function ai(_,e,j){return j(function(){ei(e)&&fi(_)})}function ei(_){var e=_.getSnapshot;_=_.value;try{var j=e();return!He(_,j)}catch{return!0}}function fi(_){var e=ih(_,1);e!==null&&gi(e,_,1,-1)}function hi(_){var e=Th();return typeof _=="function"&&(_=_()),e.memoizedState=e.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:_},e.queue=_,_=_.dispatch=ii.bind(null,M,_),[e.memoizedState,_]}function bi(_,e,j,Vt){return _={tag:_,create:e,destroy:j,deps:Vt,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=_.next=_):(j=e.lastEffect,j===null?e.lastEffect=_.next=_:(Vt=j.next,j.next=_,_.next=Vt,e.lastEffect=_)),_}function ji(){return Uh().memoizedState}function ki(_,e,j,Vt){var zt=Th();M.flags|=_,zt.memoizedState=bi(1|e,j,void 0,Vt===void 0?null:Vt)}function li(_,e,j,Vt){var zt=Uh();Vt=Vt===void 0?null:Vt;var _r=void 0;if(N!==null){var _o=N.memoizedState;if(_r=_o.destroy,Vt!==null&&Mh(Vt,_o.deps)){zt.memoizedState=bi(e,j,_r,Vt);return}}M.flags|=_,zt.memoizedState=bi(1|e,j,_r,Vt)}function mi(_,e){return ki(8390656,8,_,e)}function $h(_,e){return li(2048,8,_,e)}function ni(_,e){return li(4,2,_,e)}function oi(_,e){return li(4,4,_,e)}function pi(_,e){if(typeof e=="function")return _=_(),e(_),function(){e(null)};if(e!=null)return _=_(),e.current=_,function(){e.current=null}}function qi(_,e,j){return j=j!=null?j.concat([_]):null,li(4,4,pi.bind(null,e,_),j)}function ri(){}function si(_,e){var j=Uh();e=e===void 0?null:e;var Vt=j.memoizedState;return Vt!==null&&e!==null&&Mh(e,Vt[1])?Vt[0]:(j.memoizedState=[_,e],_)}function ti(_,e){var j=Uh();e=e===void 0?null:e;var Vt=j.memoizedState;return Vt!==null&&e!==null&&Mh(e,Vt[1])?Vt[0]:(_=_(),j.memoizedState=[_,e],_)}function ui(_,e,j){return Hh&21?(He(j,e)||(j=yc(),M.lanes|=j,rh|=j,_.baseState=!0),e):(_.baseState&&(_.baseState=!1,dh=!0),_.memoizedState=j)}function vi(_,e){var j=C;C=j!==0&&4>j?j:4,_(!0);var Vt=Gh.transition;Gh.transition={};try{_(!1),e()}finally{C=j,Gh.transition=Vt}}function wi(){return Uh().memoizedState}function xi(_,e,j){var Vt=yi(_);if(j={lane:Vt,action:j,hasEagerState:!1,eagerState:null,next:null},zi(_))Ai(e,j);else if(j=hh(_,e,j,Vt),j!==null){var zt=R$1();gi(j,_,Vt,zt),Bi(j,e,Vt)}}function ii(_,e,j){var Vt=yi(_),zt={lane:Vt,action:j,hasEagerState:!1,eagerState:null,next:null};if(zi(_))Ai(e,zt);else{var _r=_.alternate;if(_.lanes===0&&(_r===null||_r.lanes===0)&&(_r=e.lastRenderedReducer,_r!==null))try{var _o=e.lastRenderedState,ga=_r(_o,j);if(zt.hasEagerState=!0,zt.eagerState=ga,He(ga,_o)){var _a=e.interleaved;_a===null?(zt.next=zt,gh(e)):(zt.next=_a.next,_a.next=zt),e.interleaved=zt;return}}catch{}finally{}j=hh(_,e,zt,Vt),j!==null&&(zt=R$1(),gi(j,_,Vt,zt),Bi(j,e,Vt))}}function zi(_){var e=_.alternate;return _===M||e!==null&&e===M}function Ai(_,e){Jh=Ih=!0;var j=_.pending;j===null?e.next=e:(e.next=j.next,j.next=e),_.pending=e}function Bi(_,e,j){if(j&4194240){var Vt=e.lanes;Vt&=_.pendingLanes,j|=Vt,e.lanes=j,Cc(_,j)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(_,e){return Th().memoizedState=[_,e===void 0?null:e],_},useContext:eh,useEffect:mi,useImperativeHandle:function(_,e,j){return j=j!=null?j.concat([_]):null,ki(4194308,4,pi.bind(null,e,_),j)},useLayoutEffect:function(_,e){return ki(4194308,4,_,e)},useInsertionEffect:function(_,e){return ki(4,2,_,e)},useMemo:function(_,e){var j=Th();return e=e===void 0?null:e,_=_(),j.memoizedState=[_,e],_},useReducer:function(_,e,j){var Vt=Th();return e=j!==void 0?j(e):e,Vt.memoizedState=Vt.baseState=e,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:e},Vt.queue=_,_=_.dispatch=xi.bind(null,M,_),[Vt.memoizedState,_]},useRef:function(_){var e=Th();return _={current:_},e.memoizedState=_},useState:hi,useDebugValue:ri,useDeferredValue:function(_){return Th().memoizedState=_},useTransition:function(){var _=hi(!1),e=_[0];return _=vi.bind(null,_[1]),Th().memoizedState=_,[e,_]},useMutableSource:function(){},useSyncExternalStore:function(_,e,j){var Vt=M,zt=Th();if(I$5){if(j===void 0)throw Error(p$e(407));j=j()}else{if(j=e(),Q===null)throw Error(p$e(349));Hh&30||di(Vt,e,j)}zt.memoizedState=j;var _r={value:j,getSnapshot:e};return zt.queue=_r,mi(ai.bind(null,Vt,_r,_),[_]),Vt.flags|=2048,bi(9,ci.bind(null,Vt,_r,j,e),void 0,null),j},useId:function(){var _=Th(),e=Q.identifierPrefix;if(I$5){var j=sg,Vt=rg;j=(Vt&~(1<<32-oc(Vt)-1)).toString(32)+j,e=":"+e+"R"+j,j=Kh++,0<j&&(e+="H"+j.toString(32)),e+=":"}else j=Lh++,e=":"+e+"r"+j.toString(32)+":";return _.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(_){var e=Uh();return ui(e,N.memoizedState,_)},useTransition:function(){var _=Wh(Vh)[0],e=Uh().memoizedState;return[_,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(_){var e=Uh();return N===null?e.memoizedState=_:ui(e,N.memoizedState,_)},useTransition:function(){var _=Xh(Vh)[0],e=Uh().memoizedState;return[_,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(_,e){if(_&&_.defaultProps){e=A({},e),_=_.defaultProps;for(var j in _)e[j]===void 0&&(e[j]=_[j]);return e}return e}function Di(_,e,j,Vt){e=_.memoizedState,j=j(Vt,e),j=j==null?e:A({},e,j),_.memoizedState=j,_.lanes===0&&(_.updateQueue.baseState=j)}var Ei={isMounted:function(_){return(_=_._reactInternals)?Vb(_)===_:!1},enqueueSetState:function(_,e,j){_=_._reactInternals;var Vt=R$1(),zt=yi(_),_r=mh(Vt,zt);_r.payload=e,j!=null&&(_r.callback=j),e=nh(_,_r,zt),e!==null&&(gi(e,_,zt,Vt),oh(e,_,zt))},enqueueReplaceState:function(_,e,j){_=_._reactInternals;var Vt=R$1(),zt=yi(_),_r=mh(Vt,zt);_r.tag=1,_r.payload=e,j!=null&&(_r.callback=j),e=nh(_,_r,zt),e!==null&&(gi(e,_,zt,Vt),oh(e,_,zt))},enqueueForceUpdate:function(_,e){_=_._reactInternals;var j=R$1(),Vt=yi(_),zt=mh(j,Vt);zt.tag=2,e!=null&&(zt.callback=e),e=nh(_,zt,Vt),e!==null&&(gi(e,_,Vt,j),oh(e,_,Vt))}};function Fi(_,e,j,Vt,zt,_r,_o){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(Vt,_r,_o):e.prototype&&e.prototype.isPureReactComponent?!Ie(j,Vt)||!Ie(zt,_r):!0}function Gi(_,e,j){var Vt=!1,zt=Vf,_r=e.contextType;return typeof _r=="object"&&_r!==null?_r=eh(_r):(zt=Zf(e)?Xf:H$1.current,Vt=e.contextTypes,_r=(Vt=Vt!=null)?Yf(_,zt):Vf),e=new e(j,_r),_.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,_.stateNode=e,e._reactInternals=_,Vt&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=zt,_.__reactInternalMemoizedMaskedChildContext=_r),e}function Hi(_,e,j,Vt){_=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(j,Vt),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(j,Vt),e.state!==_&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(_,e,j,Vt){var zt=_.stateNode;zt.props=j,zt.state=_.memoizedState,zt.refs={},kh(_);var _r=e.contextType;typeof _r=="object"&&_r!==null?zt.context=eh(_r):(_r=Zf(e)?Xf:H$1.current,zt.context=Yf(_,_r)),zt.state=_.memoizedState,_r=e.getDerivedStateFromProps,typeof _r=="function"&&(Di(_,e,_r,j),zt.state=_.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof zt.getSnapshotBeforeUpdate=="function"||typeof zt.UNSAFE_componentWillMount!="function"&&typeof zt.componentWillMount!="function"||(e=zt.state,typeof zt.componentWillMount=="function"&&zt.componentWillMount(),typeof zt.UNSAFE_componentWillMount=="function"&&zt.UNSAFE_componentWillMount(),e!==zt.state&&Ei.enqueueReplaceState(zt,zt.state,null),qh(_,j,zt,Vt),zt.state=_.memoizedState),typeof zt.componentDidMount=="function"&&(_.flags|=4194308)}function Ji(_,e){try{var j="",Vt=e;do j+=Pa(Vt),Vt=Vt.return;while(Vt);var zt=j}catch(_r){zt=`
Error generating stack: `+_r.message+`
`+_r.stack}return{value:_,source:e,stack:zt,digest:null}}function Ki(_,e,j){return{value:_,source:null,stack:j??null,digest:e??null}}function Li(_,e){try{console.error(e.value)}catch(j){setTimeout(function(){throw j})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(_,e,j){j=mh(-1,j),j.tag=3,j.payload={element:null};var Vt=e.value;return j.callback=function(){Oi||(Oi=!0,Pi=Vt),Li(_,e)},j}function Qi(_,e,j){j=mh(-1,j),j.tag=3;var Vt=_.type.getDerivedStateFromError;if(typeof Vt=="function"){var zt=e.value;j.payload=function(){return Vt(zt)},j.callback=function(){Li(_,e)}}var _r=_.stateNode;return _r!==null&&typeof _r.componentDidCatch=="function"&&(j.callback=function(){Li(_,e),typeof Vt!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _o=e.stack;this.componentDidCatch(e.value,{componentStack:_o!==null?_o:""})}),j}function Si(_,e,j){var Vt=_.pingCache;if(Vt===null){Vt=_.pingCache=new Mi;var zt=new Set;Vt.set(e,zt)}else zt=Vt.get(e),zt===void 0&&(zt=new Set,Vt.set(e,zt));zt.has(j)||(zt.add(j),_=Ti.bind(null,_,e,j),e.then(_,_))}function Ui(_){do{var e;if((e=_.tag===13)&&(e=_.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return _;_=_.return}while(_!==null);return null}function Vi(_,e,j,Vt,zt){return _.mode&1?(_.flags|=65536,_.lanes=zt,_):(_===e?_.flags|=65536:(_.flags|=128,j.flags|=131072,j.flags&=-52805,j.tag===1&&(j.alternate===null?j.tag=17:(e=mh(-1,1),e.tag=2,nh(j,e,1))),j.lanes|=1),_)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(_,e,j,Vt){e.child=_===null?Vg(e,null,j,Vt):Ug(e,_.child,j,Vt)}function Yi(_,e,j,Vt,zt){j=j.render;var _r=e.ref;return ch(e,zt),Vt=Nh(_,e,j,Vt,_r,zt),j=Sh(),_!==null&&!dh?(e.updateQueue=_.updateQueue,e.flags&=-2053,_.lanes&=~zt,Zi(_,e,zt)):(I$5&&j&&vg(e),e.flags|=1,Xi(_,e,Vt,zt),e.child)}function $i(_,e,j,Vt,zt){if(_===null){var _r=j.type;return typeof _r=="function"&&!aj(_r)&&_r.defaultProps===void 0&&j.compare===null&&j.defaultProps===void 0?(e.tag=15,e.type=_r,bj(_,e,_r,Vt,zt)):(_=Rg(j.type,null,Vt,e,e.mode,zt),_.ref=e.ref,_.return=e,e.child=_)}if(_r=_.child,!(_.lanes&zt)){var _o=_r.memoizedProps;if(j=j.compare,j=j!==null?j:Ie,j(_o,Vt)&&_.ref===e.ref)return Zi(_,e,zt)}return e.flags|=1,_=Pg(_r,Vt),_.ref=e.ref,_.return=e,e.child=_}function bj(_,e,j,Vt,zt){if(_!==null){var _r=_.memoizedProps;if(Ie(_r,Vt)&&_.ref===e.ref)if(dh=!1,e.pendingProps=Vt=_r,(_.lanes&zt)!==0)_.flags&131072&&(dh=!0);else return e.lanes=_.lanes,Zi(_,e,zt)}return cj(_,e,j,Vt,zt)}function dj(_,e,j){var Vt=e.pendingProps,zt=Vt.children,_r=_!==null?_.memoizedState:null;if(Vt.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=j;else{if(!(j&1073741824))return _=_r!==null?_r.baseLanes|j:j,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:_,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=_,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt=_r!==null?_r.baseLanes:j,G(ej,fj),fj|=Vt}else _r!==null?(Vt=_r.baseLanes|j,e.memoizedState=null):Vt=j,G(ej,fj),fj|=Vt;return Xi(_,e,zt,j),e.child}function gj(_,e){var j=e.ref;(_===null&&j!==null||_!==null&&_.ref!==j)&&(e.flags|=512,e.flags|=2097152)}function cj(_,e,j,Vt,zt){var _r=Zf(j)?Xf:H$1.current;return _r=Yf(e,_r),ch(e,zt),j=Nh(_,e,j,Vt,_r,zt),Vt=Sh(),_!==null&&!dh?(e.updateQueue=_.updateQueue,e.flags&=-2053,_.lanes&=~zt,Zi(_,e,zt)):(I$5&&Vt&&vg(e),e.flags|=1,Xi(_,e,j,zt),e.child)}function hj(_,e,j,Vt,zt){if(Zf(j)){var _r=!0;cg(e)}else _r=!1;if(ch(e,zt),e.stateNode===null)ij(_,e),Gi(e,j,Vt),Ii(e,j,Vt,zt),Vt=!0;else if(_===null){var _o=e.stateNode,ga=e.memoizedProps;_o.props=ga;var _a=_o.context,_l=j.contextType;typeof _l=="object"&&_l!==null?_l=eh(_l):(_l=Zf(j)?Xf:H$1.current,_l=Yf(e,_l));var _d=j.getDerivedStateFromProps,_f=typeof _d=="function"||typeof _o.getSnapshotBeforeUpdate=="function";_f||typeof _o.UNSAFE_componentWillReceiveProps!="function"&&typeof _o.componentWillReceiveProps!="function"||(ga!==Vt||_a!==_l)&&Hi(e,_o,Vt,_l),jh=!1;var _m=e.memoizedState;_o.state=_m,qh(e,Vt,_o,zt),_a=e.memoizedState,ga!==Vt||_m!==_a||Wf.current||jh?(typeof _d=="function"&&(Di(e,j,_d,Vt),_a=e.memoizedState),(ga=jh||Fi(e,j,ga,Vt,_m,_a,_l))?(_f||typeof _o.UNSAFE_componentWillMount!="function"&&typeof _o.componentWillMount!="function"||(typeof _o.componentWillMount=="function"&&_o.componentWillMount(),typeof _o.UNSAFE_componentWillMount=="function"&&_o.UNSAFE_componentWillMount()),typeof _o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof _o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=Vt,e.memoizedState=_a),_o.props=Vt,_o.state=_a,_o.context=_l,Vt=ga):(typeof _o.componentDidMount=="function"&&(e.flags|=4194308),Vt=!1)}else{_o=e.stateNode,lh(_,e),ga=e.memoizedProps,_l=e.type===e.elementType?ga:Ci(e.type,ga),_o.props=_l,_f=e.pendingProps,_m=_o.context,_a=j.contextType,typeof _a=="object"&&_a!==null?_a=eh(_a):(_a=Zf(j)?Xf:H$1.current,_a=Yf(e,_a));var tE=j.getDerivedStateFromProps;(_d=typeof tE=="function"||typeof _o.getSnapshotBeforeUpdate=="function")||typeof _o.UNSAFE_componentWillReceiveProps!="function"&&typeof _o.componentWillReceiveProps!="function"||(ga!==_f||_m!==_a)&&Hi(e,_o,Vt,_a),jh=!1,_m=e.memoizedState,_o.state=_m,qh(e,Vt,_o,zt);var rE=e.memoizedState;ga!==_f||_m!==rE||Wf.current||jh?(typeof tE=="function"&&(Di(e,j,tE,Vt),rE=e.memoizedState),(_l=jh||Fi(e,j,_l,Vt,_m,rE,_a)||!1)?(_d||typeof _o.UNSAFE_componentWillUpdate!="function"&&typeof _o.componentWillUpdate!="function"||(typeof _o.componentWillUpdate=="function"&&_o.componentWillUpdate(Vt,rE,_a),typeof _o.UNSAFE_componentWillUpdate=="function"&&_o.UNSAFE_componentWillUpdate(Vt,rE,_a)),typeof _o.componentDidUpdate=="function"&&(e.flags|=4),typeof _o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof _o.componentDidUpdate!="function"||ga===_.memoizedProps&&_m===_.memoizedState||(e.flags|=4),typeof _o.getSnapshotBeforeUpdate!="function"||ga===_.memoizedProps&&_m===_.memoizedState||(e.flags|=1024),e.memoizedProps=Vt,e.memoizedState=rE),_o.props=Vt,_o.state=rE,_o.context=_a,Vt=_l):(typeof _o.componentDidUpdate!="function"||ga===_.memoizedProps&&_m===_.memoizedState||(e.flags|=4),typeof _o.getSnapshotBeforeUpdate!="function"||ga===_.memoizedProps&&_m===_.memoizedState||(e.flags|=1024),Vt=!1)}return jj(_,e,j,Vt,_r,zt)}function jj(_,e,j,Vt,zt,_r){gj(_,e);var _o=(e.flags&128)!==0;if(!Vt&&!_o)return zt&&dg(e,j,!1),Zi(_,e,_r);Vt=e.stateNode,Wi.current=e;var ga=_o&&typeof j.getDerivedStateFromError!="function"?null:Vt.render();return e.flags|=1,_!==null&&_o?(e.child=Ug(e,_.child,null,_r),e.child=Ug(e,null,ga,_r)):Xi(_,e,ga,_r),e.memoizedState=Vt.state,zt&&dg(e,j,!0),e.child}function kj(_){var e=_.stateNode;e.pendingContext?ag(_,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(_,e.context,!1),yh(_,e.containerInfo)}function lj(_,e,j,Vt,zt){return Ig(),Jg(zt),e.flags|=256,Xi(_,e,j,Vt),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(_){return{baseLanes:_,cachePool:null,transitions:null}}function oj(_,e,j){var Vt=e.pendingProps,zt=L.current,_r=!1,_o=(e.flags&128)!==0,ga;if((ga=_o)||(ga=_!==null&&_.memoizedState===null?!1:(zt&2)!==0),ga?(_r=!0,e.flags&=-129):(_===null||_.memoizedState!==null)&&(zt|=1),G(L,zt&1),_===null)return Eg(e),_=e.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(e.mode&1?_.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(_o=Vt.children,_=Vt.fallback,_r?(Vt=e.mode,_r=e.child,_o={mode:"hidden",children:_o},!(Vt&1)&&_r!==null?(_r.childLanes=0,_r.pendingProps=_o):_r=pj(_o,Vt,0,null),_=Tg(_,Vt,j,null),_r.return=e,_.return=e,_r.sibling=_,e.child=_r,e.child.memoizedState=nj(j),e.memoizedState=mj,_):qj(e,_o));if(zt=_.memoizedState,zt!==null&&(ga=zt.dehydrated,ga!==null))return rj(_,e,_o,Vt,ga,zt,j);if(_r){_r=Vt.fallback,_o=e.mode,zt=_.child,ga=zt.sibling;var _a={mode:"hidden",children:Vt.children};return!(_o&1)&&e.child!==zt?(Vt=e.child,Vt.childLanes=0,Vt.pendingProps=_a,e.deletions=null):(Vt=Pg(zt,_a),Vt.subtreeFlags=zt.subtreeFlags&14680064),ga!==null?_r=Pg(ga,_r):(_r=Tg(_r,_o,j,null),_r.flags|=2),_r.return=e,Vt.return=e,Vt.sibling=_r,e.child=Vt,Vt=_r,_r=e.child,_o=_.child.memoizedState,_o=_o===null?nj(j):{baseLanes:_o.baseLanes|j,cachePool:null,transitions:_o.transitions},_r.memoizedState=_o,_r.childLanes=_.childLanes&~j,e.memoizedState=mj,Vt}return _r=_.child,_=_r.sibling,Vt=Pg(_r,{mode:"visible",children:Vt.children}),!(e.mode&1)&&(Vt.lanes=j),Vt.return=e,Vt.sibling=null,_!==null&&(j=e.deletions,j===null?(e.deletions=[_],e.flags|=16):j.push(_)),e.child=Vt,e.memoizedState=null,Vt}function qj(_,e){return e=pj({mode:"visible",children:e},_.mode,0,null),e.return=_,_.child=e}function sj(_,e,j,Vt){return Vt!==null&&Jg(Vt),Ug(e,_.child,null,j),_=qj(e,e.pendingProps.children),_.flags|=2,e.memoizedState=null,_}function rj(_,e,j,Vt,zt,_r,_o){if(j)return e.flags&256?(e.flags&=-257,Vt=Ki(Error(p$e(422))),sj(_,e,_o,Vt)):e.memoizedState!==null?(e.child=_.child,e.flags|=128,null):(_r=Vt.fallback,zt=e.mode,Vt=pj({mode:"visible",children:Vt.children},zt,0,null),_r=Tg(_r,zt,_o,null),_r.flags|=2,Vt.return=e,_r.return=e,Vt.sibling=_r,e.child=Vt,e.mode&1&&Ug(e,_.child,null,_o),e.child.memoizedState=nj(_o),e.memoizedState=mj,_r);if(!(e.mode&1))return sj(_,e,_o,null);if(zt.data==="$!"){if(Vt=zt.nextSibling&&zt.nextSibling.dataset,Vt)var ga=Vt.dgst;return Vt=ga,_r=Error(p$e(419)),Vt=Ki(_r,Vt,void 0),sj(_,e,_o,Vt)}if(ga=(_o&_.childLanes)!==0,dh||ga){if(Vt=Q,Vt!==null){switch(_o&-_o){case 4:zt=2;break;case 16:zt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:zt=32;break;case 536870912:zt=268435456;break;default:zt=0}zt=zt&(Vt.suspendedLanes|_o)?0:zt,zt!==0&&zt!==_r.retryLane&&(_r.retryLane=zt,ih(_,zt),gi(Vt,_,zt,-1))}return tj(),Vt=Ki(Error(p$e(421))),sj(_,e,_o,Vt)}return zt.data==="$?"?(e.flags|=128,e.child=_.child,e=uj.bind(null,_),zt._reactRetry=e,null):(_=_r.treeContext,yg=Lf(zt.nextSibling),xg=e,I$5=!0,zg=null,_!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=_.id,sg=_.overflow,qg=e),e=qj(e,Vt.children),e.flags|=4096,e)}function vj(_,e,j){_.lanes|=e;var Vt=_.alternate;Vt!==null&&(Vt.lanes|=e),bh(_.return,e,j)}function wj(_,e,j,Vt,zt){var _r=_.memoizedState;_r===null?_.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:Vt,tail:j,tailMode:zt}:(_r.isBackwards=e,_r.rendering=null,_r.renderingStartTime=0,_r.last=Vt,_r.tail=j,_r.tailMode=zt)}function xj(_,e,j){var Vt=e.pendingProps,zt=Vt.revealOrder,_r=Vt.tail;if(Xi(_,e,Vt.children,j),Vt=L.current,Vt&2)Vt=Vt&1|2,e.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=e.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&vj(_,j,e);else if(_.tag===19)vj(_,j,e);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===e)break e;for(;_.sibling===null;){if(_.return===null||_.return===e)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}Vt&=1}if(G(L,Vt),!(e.mode&1))e.memoizedState=null;else switch(zt){case"forwards":for(j=e.child,zt=null;j!==null;)_=j.alternate,_!==null&&Ch(_)===null&&(zt=j),j=j.sibling;j=zt,j===null?(zt=e.child,e.child=null):(zt=j.sibling,j.sibling=null),wj(e,!1,zt,j,_r);break;case"backwards":for(j=null,zt=e.child,e.child=null;zt!==null;){if(_=zt.alternate,_!==null&&Ch(_)===null){e.child=zt;break}_=zt.sibling,zt.sibling=j,j=zt,zt=_}wj(e,!0,j,null,_r);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(_,e){!(e.mode&1)&&_!==null&&(_.alternate=null,e.alternate=null,e.flags|=2)}function Zi(_,e,j){if(_!==null&&(e.dependencies=_.dependencies),rh|=e.lanes,!(j&e.childLanes))return null;if(_!==null&&e.child!==_.child)throw Error(p$e(153));if(e.child!==null){for(_=e.child,j=Pg(_,_.pendingProps),e.child=j,j.return=e;_.sibling!==null;)_=_.sibling,j=j.sibling=Pg(_,_.pendingProps),j.return=e;j.sibling=null}return e.child}function yj(_,e,j){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var Vt=e.type._context,zt=e.memoizedProps.value;G(Wg,Vt._currentValue),Vt._currentValue=zt;break;case 13:if(Vt=e.memoizedState,Vt!==null)return Vt.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):j&e.child.childLanes?oj(_,e,j):(G(L,L.current&1),_=Zi(_,e,j),_!==null?_.sibling:null);G(L,L.current&1);break;case 19:if(Vt=(j&e.childLanes)!==0,_.flags&128){if(Vt)return xj(_,e,j);e.flags|=128}if(zt=e.memoizedState,zt!==null&&(zt.rendering=null,zt.tail=null,zt.lastEffect=null),G(L,L.current),Vt)break;return null;case 22:case 23:return e.lanes=0,dj(_,e,j)}return Zi(_,e,j)}var zj,Aj,Bj,Cj;zj=function(_,e){for(var j=e.child;j!==null;){if(j.tag===5||j.tag===6)_.appendChild(j.stateNode);else if(j.tag!==4&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break;for(;j.sibling===null;){if(j.return===null||j.return===e)return;j=j.return}j.sibling.return=j.return,j=j.sibling}};Aj=function(){};Bj=function(_,e,j,Vt){var zt=_.memoizedProps;if(zt!==Vt){_=e.stateNode,xh(uh.current);var _r=null;switch(j){case"input":zt=Ya(_,zt),Vt=Ya(_,Vt),_r=[];break;case"select":zt=A({},zt,{value:void 0}),Vt=A({},Vt,{value:void 0}),_r=[];break;case"textarea":zt=gb(_,zt),Vt=gb(_,Vt),_r=[];break;default:typeof zt.onClick!="function"&&typeof Vt.onClick=="function"&&(_.onclick=Bf)}ub(j,Vt);var _o;j=null;for(_l in zt)if(!Vt.hasOwnProperty(_l)&&zt.hasOwnProperty(_l)&&zt[_l]!=null)if(_l==="style"){var ga=zt[_l];for(_o in ga)ga.hasOwnProperty(_o)&&(j||(j={}),j[_o]="")}else _l!=="dangerouslySetInnerHTML"&&_l!=="children"&&_l!=="suppressContentEditableWarning"&&_l!=="suppressHydrationWarning"&&_l!=="autoFocus"&&(ea.hasOwnProperty(_l)?_r||(_r=[]):(_r=_r||[]).push(_l,null));for(_l in Vt){var _a=Vt[_l];if(ga=zt!=null?zt[_l]:void 0,Vt.hasOwnProperty(_l)&&_a!==ga&&(_a!=null||ga!=null))if(_l==="style")if(ga){for(_o in ga)!ga.hasOwnProperty(_o)||_a&&_a.hasOwnProperty(_o)||(j||(j={}),j[_o]="");for(_o in _a)_a.hasOwnProperty(_o)&&ga[_o]!==_a[_o]&&(j||(j={}),j[_o]=_a[_o])}else j||(_r||(_r=[]),_r.push(_l,j)),j=_a;else _l==="dangerouslySetInnerHTML"?(_a=_a?_a.__html:void 0,ga=ga?ga.__html:void 0,_a!=null&&ga!==_a&&(_r=_r||[]).push(_l,_a)):_l==="children"?typeof _a!="string"&&typeof _a!="number"||(_r=_r||[]).push(_l,""+_a):_l!=="suppressContentEditableWarning"&&_l!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_l)?(_a!=null&&_l==="onScroll"&&D("scroll",_),_r||ga===_a||(_r=[])):(_r=_r||[]).push(_l,_a))}j&&(_r=_r||[]).push("style",j);var _l=_r;(e.updateQueue=_l)&&(e.flags|=4)}};Cj=function(_,e,j,Vt){j!==Vt&&(e.flags|=4)};function Dj(_,e){if(!I$5)switch(_.tailMode){case"hidden":e=_.tail;for(var j=null;e!==null;)e.alternate!==null&&(j=e),e=e.sibling;j===null?_.tail=null:j.sibling=null;break;case"collapsed":j=_.tail;for(var Vt=null;j!==null;)j.alternate!==null&&(Vt=j),j=j.sibling;Vt===null?e||_.tail===null?_.tail=null:_.tail.sibling=null:Vt.sibling=null}}function S(_){var e=_.alternate!==null&&_.alternate.child===_.child,j=0,Vt=0;if(e)for(var zt=_.child;zt!==null;)j|=zt.lanes|zt.childLanes,Vt|=zt.subtreeFlags&14680064,Vt|=zt.flags&14680064,zt.return=_,zt=zt.sibling;else for(zt=_.child;zt!==null;)j|=zt.lanes|zt.childLanes,Vt|=zt.subtreeFlags,Vt|=zt.flags,zt.return=_,zt=zt.sibling;return _.subtreeFlags|=Vt,_.childLanes=j,e}function Ej(_,e,j){var Vt=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return Vt=e.stateNode,zh(),E(Wf),E(H$1),Eh(),Vt.pendingContext&&(Vt.context=Vt.pendingContext,Vt.pendingContext=null),(_===null||_.child===null)&&(Gg(e)?e.flags|=4:_===null||_.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(_,e),S(e),null;case 5:Bh(e);var zt=xh(wh.current);if(j=e.type,_!==null&&e.stateNode!=null)Bj(_,e,j,Vt,zt),_.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!Vt){if(e.stateNode===null)throw Error(p$e(166));return S(e),null}if(_=xh(uh.current),Gg(e)){Vt=e.stateNode,j=e.type;var _r=e.memoizedProps;switch(Vt[Of]=e,Vt[Pf]=_r,_=(e.mode&1)!==0,j){case"dialog":D("cancel",Vt),D("close",Vt);break;case"iframe":case"object":case"embed":D("load",Vt);break;case"video":case"audio":for(zt=0;zt<lf.length;zt++)D(lf[zt],Vt);break;case"source":D("error",Vt);break;case"img":case"image":case"link":D("error",Vt),D("load",Vt);break;case"details":D("toggle",Vt);break;case"input":Za(Vt,_r),D("invalid",Vt);break;case"select":Vt._wrapperState={wasMultiple:!!_r.multiple},D("invalid",Vt);break;case"textarea":hb(Vt,_r),D("invalid",Vt)}ub(j,_r),zt=null;for(var _o in _r)if(_r.hasOwnProperty(_o)){var ga=_r[_o];_o==="children"?typeof ga=="string"?Vt.textContent!==ga&&(_r.suppressHydrationWarning!==!0&&Af(Vt.textContent,ga,_),zt=["children",ga]):typeof ga=="number"&&Vt.textContent!==""+ga&&(_r.suppressHydrationWarning!==!0&&Af(Vt.textContent,ga,_),zt=["children",""+ga]):ea.hasOwnProperty(_o)&&ga!=null&&_o==="onScroll"&&D("scroll",Vt)}switch(j){case"input":Va(Vt),db(Vt,_r,!0);break;case"textarea":Va(Vt),jb(Vt);break;case"select":case"option":break;default:typeof _r.onClick=="function"&&(Vt.onclick=Bf)}Vt=zt,e.updateQueue=Vt,Vt!==null&&(e.flags|=4)}else{_o=zt.nodeType===9?zt:zt.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=kb(j)),_==="http://www.w3.org/1999/xhtml"?j==="script"?(_=_o.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof Vt.is=="string"?_=_o.createElement(j,{is:Vt.is}):(_=_o.createElement(j),j==="select"&&(_o=_,Vt.multiple?_o.multiple=!0:Vt.size&&(_o.size=Vt.size))):_=_o.createElementNS(_,j),_[Of]=e,_[Pf]=Vt,zj(_,e,!1,!1),e.stateNode=_;e:{switch(_o=vb(j,Vt),j){case"dialog":D("cancel",_),D("close",_),zt=Vt;break;case"iframe":case"object":case"embed":D("load",_),zt=Vt;break;case"video":case"audio":for(zt=0;zt<lf.length;zt++)D(lf[zt],_);zt=Vt;break;case"source":D("error",_),zt=Vt;break;case"img":case"image":case"link":D("error",_),D("load",_),zt=Vt;break;case"details":D("toggle",_),zt=Vt;break;case"input":Za(_,Vt),zt=Ya(_,Vt),D("invalid",_);break;case"option":zt=Vt;break;case"select":_._wrapperState={wasMultiple:!!Vt.multiple},zt=A({},Vt,{value:void 0}),D("invalid",_);break;case"textarea":hb(_,Vt),zt=gb(_,Vt),D("invalid",_);break;default:zt=Vt}ub(j,zt),ga=zt;for(_r in ga)if(ga.hasOwnProperty(_r)){var _a=ga[_r];_r==="style"?sb(_,_a):_r==="dangerouslySetInnerHTML"?(_a=_a?_a.__html:void 0,_a!=null&&nb(_,_a)):_r==="children"?typeof _a=="string"?(j!=="textarea"||_a!=="")&&ob(_,_a):typeof _a=="number"&&ob(_,""+_a):_r!=="suppressContentEditableWarning"&&_r!=="suppressHydrationWarning"&&_r!=="autoFocus"&&(ea.hasOwnProperty(_r)?_a!=null&&_r==="onScroll"&&D("scroll",_):_a!=null&&ta(_,_r,_a,_o))}switch(j){case"input":Va(_),db(_,Vt,!1);break;case"textarea":Va(_),jb(_);break;case"option":Vt.value!=null&&_.setAttribute("value",""+Sa(Vt.value));break;case"select":_.multiple=!!Vt.multiple,_r=Vt.value,_r!=null?fb(_,!!Vt.multiple,_r,!1):Vt.defaultValue!=null&&fb(_,!!Vt.multiple,Vt.defaultValue,!0);break;default:typeof zt.onClick=="function"&&(_.onclick=Bf)}switch(j){case"button":case"input":case"select":case"textarea":Vt=!!Vt.autoFocus;break e;case"img":Vt=!0;break e;default:Vt=!1}}Vt&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(_&&e.stateNode!=null)Cj(_,e,_.memoizedProps,Vt);else{if(typeof Vt!="string"&&e.stateNode===null)throw Error(p$e(166));if(j=xh(wh.current),xh(uh.current),Gg(e)){if(Vt=e.stateNode,j=e.memoizedProps,Vt[Of]=e,(_r=Vt.nodeValue!==j)&&(_=xg,_!==null))switch(_.tag){case 3:Af(Vt.nodeValue,j,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&Af(Vt.nodeValue,j,(_.mode&1)!==0)}_r&&(e.flags|=4)}else Vt=(j.nodeType===9?j:j.ownerDocument).createTextNode(Vt),Vt[Of]=e,e.stateNode=Vt}return S(e),null;case 13:if(E(L),Vt=e.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(I$5&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,_r=!1;else if(_r=Gg(e),Vt!==null&&Vt.dehydrated!==null){if(_===null){if(!_r)throw Error(p$e(318));if(_r=e.memoizedState,_r=_r!==null?_r.dehydrated:null,!_r)throw Error(p$e(317));_r[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),_r=!1}else zg!==null&&(Fj(zg),zg=null),_r=!0;if(!_r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=j,e):(Vt=Vt!==null,Vt!==(_!==null&&_.memoizedState!==null)&&Vt&&(e.child.flags|=8192,e.mode&1&&(_===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(_,e),_===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(L),_r=e.memoizedState,_r===null)return S(e),null;if(Vt=(e.flags&128)!==0,_o=_r.rendering,_o===null)if(Vt)Dj(_r,!1);else{if(T!==0||_!==null&&_.flags&128)for(_=e.child;_!==null;){if(_o=Ch(_),_o!==null){for(e.flags|=128,Dj(_r,!1),Vt=_o.updateQueue,Vt!==null&&(e.updateQueue=Vt,e.flags|=4),e.subtreeFlags=0,Vt=j,j=e.child;j!==null;)_r=j,_=Vt,_r.flags&=14680066,_o=_r.alternate,_o===null?(_r.childLanes=0,_r.lanes=_,_r.child=null,_r.subtreeFlags=0,_r.memoizedProps=null,_r.memoizedState=null,_r.updateQueue=null,_r.dependencies=null,_r.stateNode=null):(_r.childLanes=_o.childLanes,_r.lanes=_o.lanes,_r.child=_o.child,_r.subtreeFlags=0,_r.deletions=null,_r.memoizedProps=_o.memoizedProps,_r.memoizedState=_o.memoizedState,_r.updateQueue=_o.updateQueue,_r.type=_o.type,_=_o.dependencies,_r.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),j=j.sibling;return G(L,L.current&1|2),e.child}_=_.sibling}_r.tail!==null&&B()>Gj&&(e.flags|=128,Vt=!0,Dj(_r,!1),e.lanes=4194304)}else{if(!Vt)if(_=Ch(_o),_!==null){if(e.flags|=128,Vt=!0,j=_.updateQueue,j!==null&&(e.updateQueue=j,e.flags|=4),Dj(_r,!0),_r.tail===null&&_r.tailMode==="hidden"&&!_o.alternate&&!I$5)return S(e),null}else 2*B()-_r.renderingStartTime>Gj&&j!==1073741824&&(e.flags|=128,Vt=!0,Dj(_r,!1),e.lanes=4194304);_r.isBackwards?(_o.sibling=e.child,e.child=_o):(j=_r.last,j!==null?j.sibling=_o:e.child=_o,_r.last=_o)}return _r.tail!==null?(e=_r.tail,_r.rendering=e,_r.tail=e.sibling,_r.renderingStartTime=B(),e.sibling=null,j=L.current,G(L,Vt?j&1|2:j&1),e):(S(e),null);case 22:case 23:return Hj(),Vt=e.memoizedState!==null,_!==null&&_.memoizedState!==null!==Vt&&(e.flags|=8192),Vt&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p$e(156,e.tag))}function Ij(_,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),_=e.flags,_&65536?(e.flags=_&-65537|128,e):null;case 3:return zh(),E(Wf),E(H$1),Eh(),_=e.flags,_&65536&&!(_&128)?(e.flags=_&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),_=e.memoizedState,_!==null&&_.dehydrated!==null){if(e.alternate===null)throw Error(p$e(340));Ig()}return _=e.flags,_&65536?(e.flags=_&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(_,e){var j=_.ref;if(j!==null)if(typeof j=="function")try{j(null)}catch(Vt){W(_,e,Vt)}else j.current=null}function Mj(_,e,j){try{j()}catch(Vt){W(_,e,Vt)}}var Nj=!1;function Oj(_,e){if(Cf=dd,_=Me(),Ne(_)){if("selectionStart"in _)var j={start:_.selectionStart,end:_.selectionEnd};else e:{j=(j=_.ownerDocument)&&j.defaultView||window;var Vt=j.getSelection&&j.getSelection();if(Vt&&Vt.rangeCount!==0){j=Vt.anchorNode;var zt=Vt.anchorOffset,_r=Vt.focusNode;Vt=Vt.focusOffset;try{j.nodeType,_r.nodeType}catch{j=null;break e}var _o=0,ga=-1,_a=-1,_l=0,_d=0,_f=_,_m=null;t:for(;;){for(var tE;_f!==j||zt!==0&&_f.nodeType!==3||(ga=_o+zt),_f!==_r||Vt!==0&&_f.nodeType!==3||(_a=_o+Vt),_f.nodeType===3&&(_o+=_f.nodeValue.length),(tE=_f.firstChild)!==null;)_m=_f,_f=tE;for(;;){if(_f===_)break t;if(_m===j&&++_l===zt&&(ga=_o),_m===_r&&++_d===Vt&&(_a=_o),(tE=_f.nextSibling)!==null)break;_f=_m,_m=_f.parentNode}_f=tE}j=ga===-1||_a===-1?null:{start:ga,end:_a}}else j=null}j=j||{start:0,end:0}}else j=null;for(Df={focusedElem:_,selectionRange:j},dd=!1,V=e;V!==null;)if(e=V,_=e.child,(e.subtreeFlags&1028)!==0&&_!==null)_.return=e,V=_;else for(;V!==null;){e=V;try{var rE=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(rE!==null){var oE=rE.memoizedProps,dE=rE.memoizedState,nE=e.stateNode,sE=nE.getSnapshotBeforeUpdate(e.elementType===e.type?oE:Ci(e.type,oE),dE);nE.__reactInternalSnapshotBeforeUpdate=sE}break;case 3:var lE=e.stateNode.containerInfo;lE.nodeType===1?lE.textContent="":lE.nodeType===9&&lE.documentElement&&lE.removeChild(lE.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$e(163))}}catch(EE){W(e,e.return,EE)}if(_=e.sibling,_!==null){_.return=e.return,V=_;break}V=e.return}return rE=Nj,Nj=!1,rE}function Pj(_,e,j){var Vt=e.updateQueue;if(Vt=Vt!==null?Vt.lastEffect:null,Vt!==null){var zt=Vt=Vt.next;do{if((zt.tag&_)===_){var _r=zt.destroy;zt.destroy=void 0,_r!==void 0&&Mj(e,j,_r)}zt=zt.next}while(zt!==Vt)}}function Qj(_,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var j=e=e.next;do{if((j.tag&_)===_){var Vt=j.create;j.destroy=Vt()}j=j.next}while(j!==e)}}function Rj(_){var e=_.ref;if(e!==null){var j=_.stateNode;switch(_.tag){case 5:_=j;break;default:_=j}typeof e=="function"?e(_):e.current=_}}function Sj(_){var e=_.alternate;e!==null&&(_.alternate=null,Sj(e)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(e=_.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function Tj(_){return _.tag===5||_.tag===3||_.tag===4}function Uj(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||Tj(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function Vj(_,e,j){var Vt=_.tag;if(Vt===5||Vt===6)_=_.stateNode,e?j.nodeType===8?j.parentNode.insertBefore(_,e):j.insertBefore(_,e):(j.nodeType===8?(e=j.parentNode,e.insertBefore(_,j)):(e=j,e.appendChild(_)),j=j._reactRootContainer,j!=null||e.onclick!==null||(e.onclick=Bf));else if(Vt!==4&&(_=_.child,_!==null))for(Vj(_,e,j),_=_.sibling;_!==null;)Vj(_,e,j),_=_.sibling}function Wj(_,e,j){var Vt=_.tag;if(Vt===5||Vt===6)_=_.stateNode,e?j.insertBefore(_,e):j.appendChild(_);else if(Vt!==4&&(_=_.child,_!==null))for(Wj(_,e,j),_=_.sibling;_!==null;)Wj(_,e,j),_=_.sibling}var X=null,Xj=!1;function Yj(_,e,j){for(j=j.child;j!==null;)Zj(_,e,j),j=j.sibling}function Zj(_,e,j){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,j)}catch{}switch(j.tag){case 5:U||Lj(j,e);case 6:var Vt=X,zt=Xj;X=null,Yj(_,e,j),X=Vt,Xj=zt,X!==null&&(Xj?(_=X,j=j.stateNode,_.nodeType===8?_.parentNode.removeChild(j):_.removeChild(j)):X.removeChild(j.stateNode));break;case 18:X!==null&&(Xj?(_=X,j=j.stateNode,_.nodeType===8?Kf(_.parentNode,j):_.nodeType===1&&Kf(_,j),bd(_)):Kf(X,j.stateNode));break;case 4:Vt=X,zt=Xj,X=j.stateNode.containerInfo,Xj=!0,Yj(_,e,j),X=Vt,Xj=zt;break;case 0:case 11:case 14:case 15:if(!U&&(Vt=j.updateQueue,Vt!==null&&(Vt=Vt.lastEffect,Vt!==null))){zt=Vt=Vt.next;do{var _r=zt,_o=_r.destroy;_r=_r.tag,_o!==void 0&&(_r&2||_r&4)&&Mj(j,e,_o),zt=zt.next}while(zt!==Vt)}Yj(_,e,j);break;case 1:if(!U&&(Lj(j,e),Vt=j.stateNode,typeof Vt.componentWillUnmount=="function"))try{Vt.props=j.memoizedProps,Vt.state=j.memoizedState,Vt.componentWillUnmount()}catch(ga){W(j,e,ga)}Yj(_,e,j);break;case 21:Yj(_,e,j);break;case 22:j.mode&1?(U=(Vt=U)||j.memoizedState!==null,Yj(_,e,j),U=Vt):Yj(_,e,j);break;default:Yj(_,e,j)}}function ak(_){var e=_.updateQueue;if(e!==null){_.updateQueue=null;var j=_.stateNode;j===null&&(j=_.stateNode=new Kj),e.forEach(function(Vt){var zt=bk.bind(null,_,Vt);j.has(Vt)||(j.add(Vt),Vt.then(zt,zt))})}}function ck(_,e){var j=e.deletions;if(j!==null)for(var Vt=0;Vt<j.length;Vt++){var zt=j[Vt];try{var _r=_,_o=e,ga=_o;e:for(;ga!==null;){switch(ga.tag){case 5:X=ga.stateNode,Xj=!1;break e;case 3:X=ga.stateNode.containerInfo,Xj=!0;break e;case 4:X=ga.stateNode.containerInfo,Xj=!0;break e}ga=ga.return}if(X===null)throw Error(p$e(160));Zj(_r,_o,zt),X=null,Xj=!1;var _a=zt.alternate;_a!==null&&(_a.return=null),zt.return=null}catch(_l){W(zt,e,_l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,_),e=e.sibling}function dk(_,e){var j=_.alternate,Vt=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(ck(e,_),ek(_),Vt&4){try{Pj(3,_,_.return),Qj(3,_)}catch(oE){W(_,_.return,oE)}try{Pj(5,_,_.return)}catch(oE){W(_,_.return,oE)}}break;case 1:ck(e,_),ek(_),Vt&512&&j!==null&&Lj(j,j.return);break;case 5:if(ck(e,_),ek(_),Vt&512&&j!==null&&Lj(j,j.return),_.flags&32){var zt=_.stateNode;try{ob(zt,"")}catch(oE){W(_,_.return,oE)}}if(Vt&4&&(zt=_.stateNode,zt!=null)){var _r=_.memoizedProps,_o=j!==null?j.memoizedProps:_r,ga=_.type,_a=_.updateQueue;if(_.updateQueue=null,_a!==null)try{ga==="input"&&_r.type==="radio"&&_r.name!=null&&ab(zt,_r),vb(ga,_o);var _l=vb(ga,_r);for(_o=0;_o<_a.length;_o+=2){var _d=_a[_o],_f=_a[_o+1];_d==="style"?sb(zt,_f):_d==="dangerouslySetInnerHTML"?nb(zt,_f):_d==="children"?ob(zt,_f):ta(zt,_d,_f,_l)}switch(ga){case"input":bb(zt,_r);break;case"textarea":ib(zt,_r);break;case"select":var _m=zt._wrapperState.wasMultiple;zt._wrapperState.wasMultiple=!!_r.multiple;var tE=_r.value;tE!=null?fb(zt,!!_r.multiple,tE,!1):_m!==!!_r.multiple&&(_r.defaultValue!=null?fb(zt,!!_r.multiple,_r.defaultValue,!0):fb(zt,!!_r.multiple,_r.multiple?[]:"",!1))}zt[Pf]=_r}catch(oE){W(_,_.return,oE)}}break;case 6:if(ck(e,_),ek(_),Vt&4){if(_.stateNode===null)throw Error(p$e(162));zt=_.stateNode,_r=_.memoizedProps;try{zt.nodeValue=_r}catch(oE){W(_,_.return,oE)}}break;case 3:if(ck(e,_),ek(_),Vt&4&&j!==null&&j.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(oE){W(_,_.return,oE)}break;case 4:ck(e,_),ek(_);break;case 13:ck(e,_),ek(_),zt=_.child,zt.flags&8192&&(_r=zt.memoizedState!==null,zt.stateNode.isHidden=_r,!_r||zt.alternate!==null&&zt.alternate.memoizedState!==null||(fk=B())),Vt&4&&ak(_);break;case 22:if(_d=j!==null&&j.memoizedState!==null,_.mode&1?(U=(_l=U)||_d,ck(e,_),U=_l):ck(e,_),ek(_),Vt&8192){if(_l=_.memoizedState!==null,(_.stateNode.isHidden=_l)&&!_d&&_.mode&1)for(V=_,_d=_.child;_d!==null;){for(_f=V=_d;V!==null;){switch(_m=V,tE=_m.child,_m.tag){case 0:case 11:case 14:case 15:Pj(4,_m,_m.return);break;case 1:Lj(_m,_m.return);var rE=_m.stateNode;if(typeof rE.componentWillUnmount=="function"){Vt=_m,j=_m.return;try{e=Vt,rE.props=e.memoizedProps,rE.state=e.memoizedState,rE.componentWillUnmount()}catch(oE){W(Vt,j,oE)}}break;case 5:Lj(_m,_m.return);break;case 22:if(_m.memoizedState!==null){gk(_f);continue}}tE!==null?(tE.return=_m,V=tE):gk(_f)}_d=_d.sibling}e:for(_d=null,_f=_;;){if(_f.tag===5){if(_d===null){_d=_f;try{zt=_f.stateNode,_l?(_r=zt.style,typeof _r.setProperty=="function"?_r.setProperty("display","none","important"):_r.display="none"):(ga=_f.stateNode,_a=_f.memoizedProps.style,_o=_a!=null&&_a.hasOwnProperty("display")?_a.display:null,ga.style.display=rb("display",_o))}catch(oE){W(_,_.return,oE)}}}else if(_f.tag===6){if(_d===null)try{_f.stateNode.nodeValue=_l?"":_f.memoizedProps}catch(oE){W(_,_.return,oE)}}else if((_f.tag!==22&&_f.tag!==23||_f.memoizedState===null||_f===_)&&_f.child!==null){_f.child.return=_f,_f=_f.child;continue}if(_f===_)break e;for(;_f.sibling===null;){if(_f.return===null||_f.return===_)break e;_d===_f&&(_d=null),_f=_f.return}_d===_f&&(_d=null),_f.sibling.return=_f.return,_f=_f.sibling}}break;case 19:ck(e,_),ek(_),Vt&4&&ak(_);break;case 21:break;default:ck(e,_),ek(_)}}function ek(_){var e=_.flags;if(e&2){try{e:{for(var j=_.return;j!==null;){if(Tj(j)){var Vt=j;break e}j=j.return}throw Error(p$e(160))}switch(Vt.tag){case 5:var zt=Vt.stateNode;Vt.flags&32&&(ob(zt,""),Vt.flags&=-33);var _r=Uj(_);Wj(_,_r,zt);break;case 3:case 4:var _o=Vt.stateNode.containerInfo,ga=Uj(_);Vj(_,ga,_o);break;default:throw Error(p$e(161))}}catch(_a){W(_,_.return,_a)}_.flags&=-3}e&4096&&(_.flags&=-4097)}function hk(_,e,j){V=_,ik(_)}function ik(_,e,j){for(var Vt=(_.mode&1)!==0;V!==null;){var zt=V,_r=zt.child;if(zt.tag===22&&Vt){var _o=zt.memoizedState!==null||Jj;if(!_o){var ga=zt.alternate,_a=ga!==null&&ga.memoizedState!==null||U;ga=Jj;var _l=U;if(Jj=_o,(U=_a)&&!_l)for(V=zt;V!==null;)_o=V,_a=_o.child,_o.tag===22&&_o.memoizedState!==null?jk(zt):_a!==null?(_a.return=_o,V=_a):jk(zt);for(;_r!==null;)V=_r,ik(_r),_r=_r.sibling;V=zt,Jj=ga,U=_l}kk(_)}else zt.subtreeFlags&8772&&_r!==null?(_r.return=zt,V=_r):kk(_)}}function kk(_){for(;V!==null;){var e=V;if(e.flags&8772){var j=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var Vt=e.stateNode;if(e.flags&4&&!U)if(j===null)Vt.componentDidMount();else{var zt=e.elementType===e.type?j.memoizedProps:Ci(e.type,j.memoizedProps);Vt.componentDidUpdate(zt,j.memoizedState,Vt.__reactInternalSnapshotBeforeUpdate)}var _r=e.updateQueue;_r!==null&&sh(e,_r,Vt);break;case 3:var _o=e.updateQueue;if(_o!==null){if(j=null,e.child!==null)switch(e.child.tag){case 5:j=e.child.stateNode;break;case 1:j=e.child.stateNode}sh(e,_o,j)}break;case 5:var ga=e.stateNode;if(j===null&&e.flags&4){j=ga;var _a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":_a.autoFocus&&j.focus();break;case"img":_a.src&&(j.src=_a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _l=e.alternate;if(_l!==null){var _d=_l.memoizedState;if(_d!==null){var _f=_d.dehydrated;_f!==null&&bd(_f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$e(163))}U||e.flags&512&&Rj(e)}catch(_m){W(e,e.return,_m)}}if(e===_){V=null;break}if(j=e.sibling,j!==null){j.return=e.return,V=j;break}V=e.return}}function gk(_){for(;V!==null;){var e=V;if(e===_){V=null;break}var j=e.sibling;if(j!==null){j.return=e.return,V=j;break}V=e.return}}function jk(_){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var j=e.return;try{Qj(4,e)}catch(_a){W(e,j,_a)}break;case 1:var Vt=e.stateNode;if(typeof Vt.componentDidMount=="function"){var zt=e.return;try{Vt.componentDidMount()}catch(_a){W(e,zt,_a)}}var _r=e.return;try{Rj(e)}catch(_a){W(e,_r,_a)}break;case 5:var _o=e.return;try{Rj(e)}catch(_a){W(e,_o,_a)}}}catch(_a){W(e,e.return,_a)}if(e===_){V=null;break}var ga=e.sibling;if(ga!==null){ga.return=e.return,V=ga;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(_){return _.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(_=C,_!==0||(_=window.event,_=_===void 0?16:jd(_.type)),_):1}function gi(_,e,j,Vt){if(50<yk)throw yk=0,zk=null,Error(p$e(185));Ac(_,j,Vt),(!(K&2)||_!==Q)&&(_===Q&&(!(K&2)&&(qk|=j),T===4&&Ck(_,Z)),Dk(_,Vt),j===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(_,e){var j=_.callbackNode;wc(_,e);var Vt=uc(_,_===Q?Z:0);if(Vt===0)j!==null&&bc(j),_.callbackNode=null,_.callbackPriority=0;else if(e=Vt&-Vt,_.callbackPriority!==e){if(j!=null&&bc(j),e===1)_.tag===0?ig(Ek.bind(null,_)):hg(Ek.bind(null,_)),Jf(function(){!(K&6)&&jg()}),j=null;else{switch(Dc(Vt)){case 1:j=fc;break;case 4:j=gc;break;case 16:j=hc;break;case 536870912:j=jc;break;default:j=hc}j=Fk(j,Gk.bind(null,_))}_.callbackPriority=e,_.callbackNode=j}}function Gk(_,e){if(Ak=-1,Bk=0,K&6)throw Error(p$e(327));var j=_.callbackNode;if(Hk()&&_.callbackNode!==j)return null;var Vt=uc(_,_===Q?Z:0);if(Vt===0)return null;if(Vt&30||Vt&_.expiredLanes||e)e=Ik(_,Vt);else{e=Vt;var zt=K;K|=2;var _r=Jk();(Q!==_||Z!==e)&&(uk=null,Gj=B()+500,Kk(_,e));do try{Lk();break}catch(ga){Mk(_,ga)}while(!0);$g(),mk.current=_r,K=zt,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(zt=xc(_),zt!==0&&(Vt=zt,e=Nk(_,zt))),e===1)throw j=pk,Kk(_,0),Ck(_,Vt),Dk(_,B()),j;if(e===6)Ck(_,Vt);else{if(zt=_.current.alternate,!(Vt&30)&&!Ok(zt)&&(e=Ik(_,Vt),e===2&&(_r=xc(_),_r!==0&&(Vt=_r,e=Nk(_,_r))),e===1))throw j=pk,Kk(_,0),Ck(_,Vt),Dk(_,B()),j;switch(_.finishedWork=zt,_.finishedLanes=Vt,e){case 0:case 1:throw Error(p$e(345));case 2:Pk(_,tk,uk);break;case 3:if(Ck(_,Vt),(Vt&130023424)===Vt&&(e=fk+500-B(),10<e)){if(uc(_,0)!==0)break;if(zt=_.suspendedLanes,(zt&Vt)!==Vt){R$1(),_.pingedLanes|=_.suspendedLanes&zt;break}_.timeoutHandle=Ff(Pk.bind(null,_,tk,uk),e);break}Pk(_,tk,uk);break;case 4:if(Ck(_,Vt),(Vt&4194240)===Vt)break;for(e=_.eventTimes,zt=-1;0<Vt;){var _o=31-oc(Vt);_r=1<<_o,_o=e[_o],_o>zt&&(zt=_o),Vt&=~_r}if(Vt=zt,Vt=B()-Vt,Vt=(120>Vt?120:480>Vt?480:1080>Vt?1080:1920>Vt?1920:3e3>Vt?3e3:4320>Vt?4320:1960*lk(Vt/1960))-Vt,10<Vt){_.timeoutHandle=Ff(Pk.bind(null,_,tk,uk),Vt);break}Pk(_,tk,uk);break;case 5:Pk(_,tk,uk);break;default:throw Error(p$e(329))}}}return Dk(_,B()),_.callbackNode===j?Gk.bind(null,_):null}function Nk(_,e){var j=sk;return _.current.memoizedState.isDehydrated&&(Kk(_,e).flags|=256),_=Ik(_,e),_!==2&&(e=tk,tk=j,e!==null&&Fj(e)),_}function Fj(_){tk===null?tk=_:tk.push.apply(tk,_)}function Ok(_){for(var e=_;;){if(e.flags&16384){var j=e.updateQueue;if(j!==null&&(j=j.stores,j!==null))for(var Vt=0;Vt<j.length;Vt++){var zt=j[Vt],_r=zt.getSnapshot;zt=zt.value;try{if(!He(_r(),zt))return!1}catch{return!1}}}if(j=e.child,e.subtreeFlags&16384&&j!==null)j.return=e,e=j;else{if(e===_)break;for(;e.sibling===null;){if(e.return===null||e.return===_)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(_,e){for(e&=~rk,e&=~qk,_.suspendedLanes|=e,_.pingedLanes&=~e,_=_.expirationTimes;0<e;){var j=31-oc(e),Vt=1<<j;_[j]=-1,e&=~Vt}}function Ek(_){if(K&6)throw Error(p$e(327));Hk();var e=uc(_,0);if(!(e&1))return Dk(_,B()),null;var j=Ik(_,e);if(_.tag!==0&&j===2){var Vt=xc(_);Vt!==0&&(e=Vt,j=Nk(_,Vt))}if(j===1)throw j=pk,Kk(_,0),Ck(_,e),Dk(_,B()),j;if(j===6)throw Error(p$e(345));return _.finishedWork=_.current.alternate,_.finishedLanes=e,Pk(_,tk,uk),Dk(_,B()),null}function Qk(_,e){var j=K;K|=1;try{return _(e)}finally{K=j,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(_){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var j=ok.transition,Vt=C;try{if(ok.transition=null,C=1,_)return _()}finally{C=Vt,ok.transition=j,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(_,e){_.finishedWork=null,_.finishedLanes=0;var j=_.timeoutHandle;if(j!==-1&&(_.timeoutHandle=-1,Gf(j)),Y!==null)for(j=Y.return;j!==null;){var Vt=j;switch(wg(Vt),Vt.tag){case 1:Vt=Vt.type.childContextTypes,Vt!=null&&$f();break;case 3:zh(),E(Wf),E(H$1),Eh();break;case 5:Bh(Vt);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(Vt.type._context);break;case 22:case 23:Hj()}j=j.return}if(Q=_,Y=_=Pg(_.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(j=fh[e],Vt=j.interleaved,Vt!==null){j.interleaved=null;var zt=Vt.next,_r=j.pending;if(_r!==null){var _o=_r.next;_r.next=zt,Vt.next=_o}j.pending=Vt}fh=null}return _}function Mk(_,e){do{var j=Y;try{if($g(),Fh.current=Rh,Ih){for(var Vt=M.memoizedState;Vt!==null;){var zt=Vt.queue;zt!==null&&(zt.pending=null),Vt=Vt.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,j===null||j.return===null){T=1,pk=e,Y=null;break}e:{var _r=_,_o=j.return,ga=j,_a=e;if(e=Z,ga.flags|=32768,_a!==null&&typeof _a=="object"&&typeof _a.then=="function"){var _l=_a,_d=ga,_f=_d.tag;if(!(_d.mode&1)&&(_f===0||_f===11||_f===15)){var _m=_d.alternate;_m?(_d.updateQueue=_m.updateQueue,_d.memoizedState=_m.memoizedState,_d.lanes=_m.lanes):(_d.updateQueue=null,_d.memoizedState=null)}var tE=Ui(_o);if(tE!==null){tE.flags&=-257,Vi(tE,_o,ga,_r,e),tE.mode&1&&Si(_r,_l,e),e=tE,_a=_l;var rE=e.updateQueue;if(rE===null){var oE=new Set;oE.add(_a),e.updateQueue=oE}else rE.add(_a);break e}else{if(!(e&1)){Si(_r,_l,e),tj();break e}_a=Error(p$e(426))}}else if(I$5&&ga.mode&1){var dE=Ui(_o);if(dE!==null){!(dE.flags&65536)&&(dE.flags|=256),Vi(dE,_o,ga,_r,e),Jg(Ji(_a,ga));break e}}_r=_a=Ji(_a,ga),T!==4&&(T=2),sk===null?sk=[_r]:sk.push(_r),_r=_o;do{switch(_r.tag){case 3:_r.flags|=65536,e&=-e,_r.lanes|=e;var nE=Ni(_r,_a,e);ph(_r,nE);break e;case 1:ga=_a;var sE=_r.type,lE=_r.stateNode;if(!(_r.flags&128)&&(typeof sE.getDerivedStateFromError=="function"||lE!==null&&typeof lE.componentDidCatch=="function"&&(Ri===null||!Ri.has(lE)))){_r.flags|=65536,e&=-e,_r.lanes|=e;var EE=Qi(_r,ga,e);ph(_r,EE);break e}}_r=_r.return}while(_r!==null)}Sk(j)}catch(wE){e=wE,Y===j&&j!==null&&(Y=j=j.return);continue}break}while(!0)}function Jk(){var _=mk.current;return mk.current=Rh,_===null?Rh:_}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(_,e){var j=K;K|=2;var Vt=Jk();(Q!==_||Z!==e)&&(uk=null,Kk(_,e));do try{Tk();break}catch(zt){Mk(_,zt)}while(!0);if($g(),K=j,mk.current=Vt,Y!==null)throw Error(p$e(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(_){var e=Vk(_.alternate,_,fj);_.memoizedProps=_.pendingProps,e===null?Sk(_):Y=e,nk.current=null}function Sk(_){var e=_;do{var j=e.alternate;if(_=e.return,e.flags&32768){if(j=Ij(j,e),j!==null){j.flags&=32767,Y=j;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{T=6,Y=null;return}}else if(j=Ej(j,e,fj),j!==null){Y=j;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=_}while(e!==null);T===0&&(T=5)}function Pk(_,e,j){var Vt=C,zt=ok.transition;try{ok.transition=null,C=1,Wk(_,e,j,Vt)}finally{ok.transition=zt,C=Vt}return null}function Wk(_,e,j,Vt){do Hk();while(wk!==null);if(K&6)throw Error(p$e(327));j=_.finishedWork;var zt=_.finishedLanes;if(j===null)return null;if(_.finishedWork=null,_.finishedLanes=0,j===_.current)throw Error(p$e(177));_.callbackNode=null,_.callbackPriority=0;var _r=j.lanes|j.childLanes;if(Bc(_,_r),_===Q&&(Y=Q=null,Z=0),!(j.subtreeFlags&2064)&&!(j.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),_r=(j.flags&15990)!==0,j.subtreeFlags&15990||_r){_r=ok.transition,ok.transition=null;var _o=C;C=1;var ga=K;K|=4,nk.current=null,Oj(_,j),dk(j,_),Oe(Df),dd=!!Cf,Df=Cf=null,_.current=j,hk(j),dc(),K=ga,C=_o,ok.transition=_r}else _.current=j;if(vk&&(vk=!1,wk=_,xk=zt),_r=_.pendingLanes,_r===0&&(Ri=null),mc(j.stateNode),Dk(_,B()),e!==null)for(Vt=_.onRecoverableError,j=0;j<e.length;j++)zt=e[j],Vt(zt.value,{componentStack:zt.stack,digest:zt.digest});if(Oi)throw Oi=!1,_=Pi,Pi=null,_;return xk&1&&_.tag!==0&&Hk(),_r=_.pendingLanes,_r&1?_===zk?yk++:(yk=0,zk=_):yk=0,jg(),null}function Hk(){if(wk!==null){var _=Dc(xk),e=ok.transition,j=C;try{if(ok.transition=null,C=16>_?16:_,wk===null)var Vt=!1;else{if(_=wk,wk=null,xk=0,K&6)throw Error(p$e(331));var zt=K;for(K|=4,V=_.current;V!==null;){var _r=V,_o=_r.child;if(V.flags&16){var ga=_r.deletions;if(ga!==null){for(var _a=0;_a<ga.length;_a++){var _l=ga[_a];for(V=_l;V!==null;){var _d=V;switch(_d.tag){case 0:case 11:case 15:Pj(8,_d,_r)}var _f=_d.child;if(_f!==null)_f.return=_d,V=_f;else for(;V!==null;){_d=V;var _m=_d.sibling,tE=_d.return;if(Sj(_d),_d===_l){V=null;break}if(_m!==null){_m.return=tE,V=_m;break}V=tE}}}var rE=_r.alternate;if(rE!==null){var oE=rE.child;if(oE!==null){rE.child=null;do{var dE=oE.sibling;oE.sibling=null,oE=dE}while(oE!==null)}}V=_r}}if(_r.subtreeFlags&2064&&_o!==null)_o.return=_r,V=_o;else e:for(;V!==null;){if(_r=V,_r.flags&2048)switch(_r.tag){case 0:case 11:case 15:Pj(9,_r,_r.return)}var nE=_r.sibling;if(nE!==null){nE.return=_r.return,V=nE;break e}V=_r.return}}var sE=_.current;for(V=sE;V!==null;){_o=V;var lE=_o.child;if(_o.subtreeFlags&2064&&lE!==null)lE.return=_o,V=lE;else e:for(_o=sE;V!==null;){if(ga=V,ga.flags&2048)try{switch(ga.tag){case 0:case 11:case 15:Qj(9,ga)}}catch(wE){W(ga,ga.return,wE)}if(ga===_o){V=null;break e}var EE=ga.sibling;if(EE!==null){EE.return=ga.return,V=EE;break e}V=ga.return}}if(K=zt,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,_)}catch{}Vt=!0}return Vt}finally{C=j,ok.transition=e}}return!1}function Xk(_,e,j){e=Ji(j,e),e=Ni(_,e,1),_=nh(_,e,1),e=R$1(),_!==null&&(Ac(_,1,e),Dk(_,e))}function W(_,e,j){if(_.tag===3)Xk(_,_,j);else for(;e!==null;){if(e.tag===3){Xk(e,_,j);break}else if(e.tag===1){var Vt=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof Vt.componentDidCatch=="function"&&(Ri===null||!Ri.has(Vt))){_=Ji(j,_),_=Qi(e,_,1),e=nh(e,_,1),_=R$1(),e!==null&&(Ac(e,1,_),Dk(e,_));break}}e=e.return}}function Ti(_,e,j){var Vt=_.pingCache;Vt!==null&&Vt.delete(e),e=R$1(),_.pingedLanes|=_.suspendedLanes&j,Q===_&&(Z&j)===j&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(_,0):rk|=j),Dk(_,e)}function Yk(_,e){e===0&&(_.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var j=R$1();_=ih(_,e),_!==null&&(Ac(_,e,j),Dk(_,j))}function uj(_){var e=_.memoizedState,j=0;e!==null&&(j=e.retryLane),Yk(_,j)}function bk(_,e){var j=0;switch(_.tag){case 13:var Vt=_.stateNode,zt=_.memoizedState;zt!==null&&(j=zt.retryLane);break;case 19:Vt=_.stateNode;break;default:throw Error(p$e(314))}Vt!==null&&Vt.delete(e),Yk(_,j)}var Vk;Vk=function(_,e,j){if(_!==null)if(_.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(_.lanes&j)&&!(e.flags&128))return dh=!1,yj(_,e,j);dh=!!(_.flags&131072)}else dh=!1,I$5&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var Vt=e.type;ij(_,e),_=e.pendingProps;var zt=Yf(e,H$1.current);ch(e,j),zt=Nh(null,e,Vt,_,zt,j);var _r=Sh();return e.flags|=1,typeof zt=="object"&&zt!==null&&typeof zt.render=="function"&&zt.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(Vt)?(_r=!0,cg(e)):_r=!1,e.memoizedState=zt.state!==null&&zt.state!==void 0?zt.state:null,kh(e),zt.updater=Ei,e.stateNode=zt,zt._reactInternals=e,Ii(e,Vt,_,j),e=jj(null,e,Vt,!0,_r,j)):(e.tag=0,I$5&&_r&&vg(e),Xi(null,e,zt,j),e=e.child),e;case 16:Vt=e.elementType;e:{switch(ij(_,e),_=e.pendingProps,zt=Vt._init,Vt=zt(Vt._payload),e.type=Vt,zt=e.tag=Zk(Vt),_=Ci(Vt,_),zt){case 0:e=cj(null,e,Vt,_,j);break e;case 1:e=hj(null,e,Vt,_,j);break e;case 11:e=Yi(null,e,Vt,_,j);break e;case 14:e=$i(null,e,Vt,Ci(Vt.type,_),j);break e}throw Error(p$e(306,Vt,""))}return e;case 0:return Vt=e.type,zt=e.pendingProps,zt=e.elementType===Vt?zt:Ci(Vt,zt),cj(_,e,Vt,zt,j);case 1:return Vt=e.type,zt=e.pendingProps,zt=e.elementType===Vt?zt:Ci(Vt,zt),hj(_,e,Vt,zt,j);case 3:e:{if(kj(e),_===null)throw Error(p$e(387));Vt=e.pendingProps,_r=e.memoizedState,zt=_r.element,lh(_,e),qh(e,Vt,null,j);var _o=e.memoizedState;if(Vt=_o.element,_r.isDehydrated)if(_r={element:Vt,isDehydrated:!1,cache:_o.cache,pendingSuspenseBoundaries:_o.pendingSuspenseBoundaries,transitions:_o.transitions},e.updateQueue.baseState=_r,e.memoizedState=_r,e.flags&256){zt=Ji(Error(p$e(423)),e),e=lj(_,e,Vt,j,zt);break e}else if(Vt!==zt){zt=Ji(Error(p$e(424)),e),e=lj(_,e,Vt,j,zt);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I$5=!0,zg=null,j=Vg(e,null,Vt,j),e.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(Ig(),Vt===zt){e=Zi(_,e,j);break e}Xi(_,e,Vt,j)}e=e.child}return e;case 5:return Ah(e),_===null&&Eg(e),Vt=e.type,zt=e.pendingProps,_r=_!==null?_.memoizedProps:null,_o=zt.children,Ef(Vt,zt)?_o=null:_r!==null&&Ef(Vt,_r)&&(e.flags|=32),gj(_,e),Xi(_,e,_o,j),e.child;case 6:return _===null&&Eg(e),null;case 13:return oj(_,e,j);case 4:return yh(e,e.stateNode.containerInfo),Vt=e.pendingProps,_===null?e.child=Ug(e,null,Vt,j):Xi(_,e,Vt,j),e.child;case 11:return Vt=e.type,zt=e.pendingProps,zt=e.elementType===Vt?zt:Ci(Vt,zt),Yi(_,e,Vt,zt,j);case 7:return Xi(_,e,e.pendingProps,j),e.child;case 8:return Xi(_,e,e.pendingProps.children,j),e.child;case 12:return Xi(_,e,e.pendingProps.children,j),e.child;case 10:e:{if(Vt=e.type._context,zt=e.pendingProps,_r=e.memoizedProps,_o=zt.value,G(Wg,Vt._currentValue),Vt._currentValue=_o,_r!==null)if(He(_r.value,_o)){if(_r.children===zt.children&&!Wf.current){e=Zi(_,e,j);break e}}else for(_r=e.child,_r!==null&&(_r.return=e);_r!==null;){var ga=_r.dependencies;if(ga!==null){_o=_r.child;for(var _a=ga.firstContext;_a!==null;){if(_a.context===Vt){if(_r.tag===1){_a=mh(-1,j&-j),_a.tag=2;var _l=_r.updateQueue;if(_l!==null){_l=_l.shared;var _d=_l.pending;_d===null?_a.next=_a:(_a.next=_d.next,_d.next=_a),_l.pending=_a}}_r.lanes|=j,_a=_r.alternate,_a!==null&&(_a.lanes|=j),bh(_r.return,j,e),ga.lanes|=j;break}_a=_a.next}}else if(_r.tag===10)_o=_r.type===e.type?null:_r.child;else if(_r.tag===18){if(_o=_r.return,_o===null)throw Error(p$e(341));_o.lanes|=j,ga=_o.alternate,ga!==null&&(ga.lanes|=j),bh(_o,j,e),_o=_r.sibling}else _o=_r.child;if(_o!==null)_o.return=_r;else for(_o=_r;_o!==null;){if(_o===e){_o=null;break}if(_r=_o.sibling,_r!==null){_r.return=_o.return,_o=_r;break}_o=_o.return}_r=_o}Xi(_,e,zt.children,j),e=e.child}return e;case 9:return zt=e.type,Vt=e.pendingProps.children,ch(e,j),zt=eh(zt),Vt=Vt(zt),e.flags|=1,Xi(_,e,Vt,j),e.child;case 14:return Vt=e.type,zt=Ci(Vt,e.pendingProps),zt=Ci(Vt.type,zt),$i(_,e,Vt,zt,j);case 15:return bj(_,e,e.type,e.pendingProps,j);case 17:return Vt=e.type,zt=e.pendingProps,zt=e.elementType===Vt?zt:Ci(Vt,zt),ij(_,e),e.tag=1,Zf(Vt)?(_=!0,cg(e)):_=!1,ch(e,j),Gi(e,Vt,zt),Ii(e,Vt,zt,j),jj(null,e,Vt,!0,_,j);case 19:return xj(_,e,j);case 22:return dj(_,e,j)}throw Error(p$e(156,e.tag))};function Fk(_,e){return ac(_,e)}function $k(_,e,j,Vt){this.tag=_,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Vt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(_,e,j,Vt){return new $k(_,e,j,Vt)}function aj(_){return _=_.prototype,!(!_||!_.isReactComponent)}function Zk(_){if(typeof _=="function")return aj(_)?1:0;if(_!=null){if(_=_.$$typeof,_===Da)return 11;if(_===Ga)return 14}return 2}function Pg(_,e){var j=_.alternate;return j===null?(j=Bg(_.tag,e,_.key,_.mode),j.elementType=_.elementType,j.type=_.type,j.stateNode=_.stateNode,j.alternate=_,_.alternate=j):(j.pendingProps=e,j.type=_.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=_.flags&14680064,j.childLanes=_.childLanes,j.lanes=_.lanes,j.child=_.child,j.memoizedProps=_.memoizedProps,j.memoizedState=_.memoizedState,j.updateQueue=_.updateQueue,e=_.dependencies,j.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},j.sibling=_.sibling,j.index=_.index,j.ref=_.ref,j}function Rg(_,e,j,Vt,zt,_r){var _o=2;if(Vt=_,typeof _=="function")aj(_)&&(_o=1);else if(typeof _=="string")_o=5;else e:switch(_){case ya:return Tg(j.children,zt,_r,e);case za:_o=8,zt|=8;break;case Aa:return _=Bg(12,j,e,zt|2),_.elementType=Aa,_.lanes=_r,_;case Ea:return _=Bg(13,j,e,zt),_.elementType=Ea,_.lanes=_r,_;case Fa:return _=Bg(19,j,e,zt),_.elementType=Fa,_.lanes=_r,_;case Ia:return pj(j,zt,_r,e);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case Ba:_o=10;break e;case Ca:_o=9;break e;case Da:_o=11;break e;case Ga:_o=14;break e;case Ha:_o=16,Vt=null;break e}throw Error(p$e(130,_==null?_:typeof _,""))}return e=Bg(_o,j,e,zt),e.elementType=_,e.type=Vt,e.lanes=_r,e}function Tg(_,e,j,Vt){return _=Bg(7,_,Vt,e),_.lanes=j,_}function pj(_,e,j,Vt){return _=Bg(22,_,Vt,e),_.elementType=Ia,_.lanes=j,_.stateNode={isHidden:!1},_}function Qg(_,e,j){return _=Bg(6,_,null,e),_.lanes=j,_}function Sg(_,e,j){return e=Bg(4,_.children!==null?_.children:[],_.key,e),e.lanes=j,e.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},e}function al(_,e,j,Vt,zt){this.tag=e,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=Vt,this.onRecoverableError=zt,this.mutableSourceEagerHydrationData=null}function bl(_,e,j,Vt,zt,_r,_o,ga,_a){return _=new al(_,e,j,ga,_a),e===1?(e=1,_r===!0&&(e|=8)):e=0,_r=Bg(3,null,null,e),_.current=_r,_r.stateNode=_,_r.memoizedState={element:Vt,isDehydrated:j,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(_r),_}function cl(_,e,j){var Vt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:Vt==null?null:""+Vt,children:_,containerInfo:e,implementation:j}}function dl(_){if(!_)return Vf;_=_._reactInternals;e:{if(Vb(_)!==_||_.tag!==1)throw Error(p$e(170));var e=_;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p$e(171))}if(_.tag===1){var j=_.type;if(Zf(j))return bg(_,j,e)}return e}function el(_,e,j,Vt,zt,_r,_o,ga,_a){return _=bl(j,Vt,!0,_,zt,_r,_o,ga,_a),_.context=dl(null),j=_.current,Vt=R$1(),zt=yi(j),_r=mh(Vt,zt),_r.callback=e??null,nh(j,_r,zt),_.current.lanes=zt,Ac(_,zt,Vt),Dk(_,Vt),_}function fl(_,e,j,Vt){var zt=e.current,_r=R$1(),_o=yi(zt);return j=dl(j),e.context===null?e.context=j:e.pendingContext=j,e=mh(_r,_o),e.payload={element:_},Vt=Vt===void 0?null:Vt,Vt!==null&&(e.callback=Vt),_=nh(zt,e,_o),_!==null&&(gi(_,zt,_o,_r),oh(_,zt,_o)),_o}function gl(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function hl(_,e){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var j=_.retryLane;_.retryLane=j!==0&&j<e?j:e}}function il(_,e){hl(_,e),(_=_.alternate)&&hl(_,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(_){console.error(_)};function ll(_){this._internalRoot=_}ml.prototype.render=ll.prototype.render=function(_){var e=this._internalRoot;if(e===null)throw Error(p$e(409));fl(_,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var e=_.containerInfo;Rk(function(){fl(null,_,null,null)}),e[uf]=null}};function ml(_){this._internalRoot=_}ml.prototype.unstable_scheduleHydration=function(_){if(_){var e=Hc();_={blockedOn:null,target:_,priority:e};for(var j=0;j<Qc.length&&e!==0&&e<Qc[j].priority;j++);Qc.splice(j,0,_),j===0&&Vc(_)}};function nl(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function ol(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(_,e,j,Vt,zt){if(zt){if(typeof Vt=="function"){var _r=Vt;Vt=function(){var _l=gl(_o);_r.call(_l)}}var _o=el(e,Vt,_,0,null,!1,!1,"",pl);return _._reactRootContainer=_o,_[uf]=_o.current,sf(_.nodeType===8?_.parentNode:_),Rk(),_o}for(;zt=_.lastChild;)_.removeChild(zt);if(typeof Vt=="function"){var ga=Vt;Vt=function(){var _l=gl(_a);ga.call(_l)}}var _a=bl(_,0,!1,null,null,!1,!1,"",pl);return _._reactRootContainer=_a,_[uf]=_a.current,sf(_.nodeType===8?_.parentNode:_),Rk(function(){fl(e,_a,j,Vt)}),_a}function rl(_,e,j,Vt,zt){var _r=j._reactRootContainer;if(_r){var _o=_r;if(typeof zt=="function"){var ga=zt;zt=function(){var _a=gl(_o);ga.call(_a)}}fl(e,_o,_,zt)}else _o=ql(j,e,_,zt,Vt);return gl(_o)}Ec=function(_){switch(_.tag){case 3:var e=_.stateNode;if(e.current.memoizedState.isDehydrated){var j=tc(e.pendingLanes);j!==0&&(Cc(e,j|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var Vt=ih(_,1);if(Vt!==null){var zt=R$1();gi(Vt,_,1,zt)}}),il(_,1)}};Fc=function(_){if(_.tag===13){var e=ih(_,134217728);if(e!==null){var j=R$1();gi(e,_,134217728,j)}il(_,134217728)}};Gc=function(_){if(_.tag===13){var e=yi(_),j=ih(_,e);if(j!==null){var Vt=R$1();gi(j,_,e,Vt)}il(_,e)}};Hc=function(){return C};Ic=function(_,e){var j=C;try{return C=_,e()}finally{C=j}};yb=function(_,e,j){switch(e){case"input":if(bb(_,j),e=j.name,j.type==="radio"&&e!=null){for(j=_;j.parentNode;)j=j.parentNode;for(j=j.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<j.length;e++){var Vt=j[e];if(Vt!==_&&Vt.form===_.form){var zt=Db(Vt);if(!zt)throw Error(p$e(90));Wa(Vt),bb(Vt,zt)}}}break;case"textarea":ib(_,j);break;case"select":e=j.value,e!=null&&fb(_,!!j.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=Zb(_),_===null?null:_.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(_,e){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p$e(200));return cl(_,e,null,j)};reactDom_production_min.createRoot=function(_,e){if(!nl(_))throw Error(p$e(299));var j=!1,Vt="",zt=kl;return e!=null&&(e.unstable_strictMode===!0&&(j=!0),e.identifierPrefix!==void 0&&(Vt=e.identifierPrefix),e.onRecoverableError!==void 0&&(zt=e.onRecoverableError)),e=bl(_,1,!1,null,null,j,!1,Vt,zt),_[uf]=e.current,sf(_.nodeType===8?_.parentNode:_),new ll(e)};reactDom_production_min.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var e=_._reactInternals;if(e===void 0)throw typeof _.render=="function"?Error(p$e(188)):(_=Object.keys(_).join(","),Error(p$e(268,_)));return _=Zb(e),_=_===null?null:_.stateNode,_};reactDom_production_min.flushSync=function(_){return Rk(_)};reactDom_production_min.hydrate=function(_,e,j){if(!ol(e))throw Error(p$e(200));return rl(null,_,e,!0,j)};reactDom_production_min.hydrateRoot=function(_,e,j){if(!nl(_))throw Error(p$e(405));var Vt=j!=null&&j.hydratedSources||null,zt=!1,_r="",_o=kl;if(j!=null&&(j.unstable_strictMode===!0&&(zt=!0),j.identifierPrefix!==void 0&&(_r=j.identifierPrefix),j.onRecoverableError!==void 0&&(_o=j.onRecoverableError)),e=el(e,null,_,1,j??null,zt,!1,_r,_o),_[uf]=e.current,sf(_),Vt)for(_=0;_<Vt.length;_++)j=Vt[_],zt=j._getVersion,zt=zt(j._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[j,zt]:e.mutableSourceEagerHydrationData.push(j,zt);return new ml(e)};reactDom_production_min.render=function(_,e,j){if(!ol(e))throw Error(p$e(200));return rl(null,_,e,!1,j)};reactDom_production_min.unmountComponentAtNode=function(_){if(!ol(_))throw Error(p$e(40));return _._reactRootContainer?(Rk(function(){rl(null,null,_,!1,function(){_._reactRootContainer=null,_[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(_,e,j,Vt){if(!ol(j))throw Error(p$e(200));if(_==null||_._reactInternals===void 0)throw Error(p$e(38));return rl(_,e,j,!1,Vt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(_){console.error(_)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const index=getDefaultExportFromCjs(reactDomExports),ReactDOM=_mergeNamespaces({__proto__:null,default:index},[reactDomExports]);var m$d=reactDomExports;client.createRoot=m$d.createRoot,client.hydrateRoot=m$d.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(_){for(var e=1;e<arguments.length;e++){var j=arguments[e];for(var Vt in j)Object.prototype.hasOwnProperty.call(j,Vt)&&(_[Vt]=j[Vt])}return _},_extends$4.apply(this,arguments)}var Action;(function(_){_.Pop="POP",_.Push="PUSH",_.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(_){_===void 0&&(_={});function e(Vt,zt){let{pathname:_r,search:_o,hash:ga}=Vt.location;return createLocation("",{pathname:_r,search:_o,hash:ga},zt.state&&zt.state.usr||null,zt.state&&zt.state.key||"default")}function j(Vt,zt){return typeof zt=="string"?zt:createPath(zt)}return getUrlBasedHistory(e,j,null,_)}function invariant(_,e){if(_===!1||_===null||typeof _>"u")throw new Error(e)}function warning(_,e){if(!_){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(_,e){return{usr:_.state,key:_.key,idx:e}}function createLocation(_,e,j,Vt){return j===void 0&&(j=null),_extends$4({pathname:typeof _=="string"?_:_.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:j,key:e&&e.key||Vt||createKey()})}function createPath(_){let{pathname:e="/",search:j="",hash:Vt=""}=_;return j&&j!=="?"&&(e+=j.charAt(0)==="?"?j:"?"+j),Vt&&Vt!=="#"&&(e+=Vt.charAt(0)==="#"?Vt:"#"+Vt),e}function parsePath(_){let e={};if(_){let j=_.indexOf("#");j>=0&&(e.hash=_.substr(j),_=_.substr(0,j));let Vt=_.indexOf("?");Vt>=0&&(e.search=_.substr(Vt),_=_.substr(0,Vt)),_&&(e.pathname=_)}return e}function getUrlBasedHistory(_,e,j,Vt){Vt===void 0&&(Vt={});let{window:zt=document.defaultView,v5Compat:_r=!1}=Vt,_o=zt.history,ga=Action.Pop,_a=null,_l=_d();_l==null&&(_l=0,_o.replaceState(_extends$4({},_o.state,{idx:_l}),""));function _d(){return(_o.state||{idx:null}).idx}function _f(){ga=Action.Pop;let dE=_d(),nE=dE==null?null:dE-_l;_l=dE,_a&&_a({action:ga,location:oE.location,delta:nE})}function _m(dE,nE){ga=Action.Push;let sE=createLocation(oE.location,dE,nE);_l=_d()+1;let lE=getHistoryState(sE,_l),EE=oE.createHref(sE);try{_o.pushState(lE,"",EE)}catch(wE){if(wE instanceof DOMException&&wE.name==="DataCloneError")throw wE;zt.location.assign(EE)}_r&&_a&&_a({action:ga,location:oE.location,delta:1})}function tE(dE,nE){ga=Action.Replace;let sE=createLocation(oE.location,dE,nE);_l=_d();let lE=getHistoryState(sE,_l),EE=oE.createHref(sE);_o.replaceState(lE,"",EE),_r&&_a&&_a({action:ga,location:oE.location,delta:0})}function rE(dE){let nE=zt.location.origin!=="null"?zt.location.origin:zt.location.href,sE=typeof dE=="string"?dE:createPath(dE);return sE=sE.replace(/ $/,"%20"),invariant(nE,"No window.location.(origin|href) available to create URL for href: "+sE),new URL(sE,nE)}let oE={get action(){return ga},get location(){return _(zt,_o)},listen(dE){if(_a)throw new Error("A history only accepts one active listener");return zt.addEventListener(PopStateEventType,_f),_a=dE,()=>{zt.removeEventListener(PopStateEventType,_f),_a=null}},createHref(dE){return e(zt,dE)},createURL:rE,encodeLocation(dE){let nE=rE(dE);return{pathname:nE.pathname,search:nE.search,hash:nE.hash}},push:_m,replace:tE,go(dE){return _o.go(dE)}};return oE}var ResultType;(function(_){_.data="data",_.deferred="deferred",_.redirect="redirect",_.error="error"})(ResultType||(ResultType={}));const immutableRouteKeys=new Set(["lazy","caseSensitive","path","id","index","children"]);function isIndexRoute(_){return _.index===!0}function convertRoutesToDataRoutes(_,e,j,Vt){return j===void 0&&(j=[]),Vt===void 0&&(Vt={}),_.map((zt,_r)=>{let _o=[...j,_r],ga=typeof zt.id=="string"?zt.id:_o.join("-");if(invariant(zt.index!==!0||!zt.children,"Cannot specify children on an index route"),invariant(!Vt[ga],'Found a route id collision on id "'+ga+`".  Route id's must be globally unique within Data Router usages`),isIndexRoute(zt)){let _a=_extends$4({},zt,e(zt),{id:ga});return Vt[ga]=_a,_a}else{let _a=_extends$4({},zt,e(zt),{id:ga,children:void 0});return Vt[ga]=_a,zt.children&&(_a.children=convertRoutesToDataRoutes(zt.children,e,_o,Vt)),_a}})}function matchRoutes(_,e,j){j===void 0&&(j="/");let Vt=typeof e=="string"?parsePath(e):e,zt=stripBasename(Vt.pathname||"/",j);if(zt==null)return null;let _r=flattenRoutes(_);rankRouteBranches(_r);let _o=null;for(let ga=0;_o==null&&ga<_r.length;++ga){let _a=decodePath(zt);_o=matchRouteBranch(_r[ga],_a)}return _o}function convertRouteMatchToUiMatch(_,e){let{route:j,pathname:Vt,params:zt}=_;return{id:j.id,pathname:Vt,params:zt,data:e[j.id],handle:j.handle}}function flattenRoutes(_,e,j,Vt){e===void 0&&(e=[]),j===void 0&&(j=[]),Vt===void 0&&(Vt="");let zt=(_r,_o,ga)=>{let _a={relativePath:ga===void 0?_r.path||"":ga,caseSensitive:_r.caseSensitive===!0,childrenIndex:_o,route:_r};_a.relativePath.startsWith("/")&&(invariant(_a.relativePath.startsWith(Vt),'Absolute route path "'+_a.relativePath+'" nested under path '+('"'+Vt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_a.relativePath=_a.relativePath.slice(Vt.length));let _l=joinPaths([Vt,_a.relativePath]),_d=j.concat(_a);_r.children&&_r.children.length>0&&(invariant(_r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_l+'".')),flattenRoutes(_r.children,e,_d,_l)),!(_r.path==null&&!_r.index)&&e.push({path:_l,score:computeScore(_l,_r.index),routesMeta:_d})};return _.forEach((_r,_o)=>{var ga;if(_r.path===""||!((ga=_r.path)!=null&&ga.includes("?")))zt(_r,_o);else for(let _a of explodeOptionalSegments(_r.path))zt(_r,_o,_a)}),e}function explodeOptionalSegments(_){let e=_.split("/");if(e.length===0)return[];let[j,...Vt]=e,zt=j.endsWith("?"),_r=j.replace(/\?$/,"");if(Vt.length===0)return zt?[_r,""]:[_r];let _o=explodeOptionalSegments(Vt.join("/")),ga=[];return ga.push(..._o.map(_a=>_a===""?_r:[_r,_a].join("/"))),zt&&ga.push(..._o),ga.map(_a=>_.startsWith("/")&&_a===""?"/":_a)}function rankRouteBranches(_){_.sort((e,j)=>e.score!==j.score?j.score-e.score:compareIndexes(e.routesMeta.map(Vt=>Vt.childrenIndex),j.routesMeta.map(Vt=>Vt.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=_=>_==="*";function computeScore(_,e){let j=_.split("/"),Vt=j.length;return j.some(isSplat)&&(Vt+=splatPenalty),e&&(Vt+=indexRouteValue),j.filter(zt=>!isSplat(zt)).reduce((zt,_r)=>zt+(paramRe.test(_r)?dynamicSegmentValue:_r===""?emptySegmentValue:staticSegmentValue),Vt)}function compareIndexes(_,e){return _.length===e.length&&_.slice(0,-1).every((Vt,zt)=>Vt===e[zt])?_[_.length-1]-e[e.length-1]:0}function matchRouteBranch(_,e){let{routesMeta:j}=_,Vt={},zt="/",_r=[];for(let _o=0;_o<j.length;++_o){let ga=j[_o],_a=_o===j.length-1,_l=zt==="/"?e:e.slice(zt.length)||"/",_d=matchPath({path:ga.relativePath,caseSensitive:ga.caseSensitive,end:_a},_l);if(!_d)return null;Object.assign(Vt,_d.params);let _f=ga.route;_r.push({params:Vt,pathname:joinPaths([zt,_d.pathname]),pathnameBase:normalizePathname(joinPaths([zt,_d.pathnameBase])),route:_f}),_d.pathnameBase!=="/"&&(zt=joinPaths([zt,_d.pathnameBase]))}return _r}function matchPath(_,e){typeof _=="string"&&(_={path:_,caseSensitive:!1,end:!0});let[j,Vt]=compilePath(_.path,_.caseSensitive,_.end),zt=e.match(j);if(!zt)return null;let _r=zt[0],_o=_r.replace(/(.)\/+$/,"$1"),ga=zt.slice(1);return{params:Vt.reduce((_l,_d,_f)=>{let{paramName:_m,isOptional:tE}=_d;if(_m==="*"){let oE=ga[_f]||"";_o=_r.slice(0,_r.length-oE.length).replace(/(.)\/+$/,"$1")}const rE=ga[_f];return tE&&!rE?_l[_m]=void 0:_l[_m]=(rE||"").replace(/%2F/g,"/"),_l},{}),pathname:_r,pathnameBase:_o,pattern:_}}function compilePath(_,e,j){e===void 0&&(e=!1),j===void 0&&(j=!0),warning(_==="*"||!_.endsWith("*")||_.endsWith("/*"),'Route path "'+_+'" will be treated as if it were '+('"'+_.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+_.replace(/\*$/,"/*")+'".'));let Vt=[],zt="^"+_.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_o,ga,_a)=>(Vt.push({paramName:ga,isOptional:_a!=null}),_a?"/?([^\\/]+)?":"/([^\\/]+)"));return _.endsWith("*")?(Vt.push({paramName:"*"}),zt+=_==="*"||_==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):j?zt+="\\/*$":_!==""&&_!=="/"&&(zt+="(?:(?=\\/|$))"),[new RegExp(zt,e?void 0:"i"),Vt]}function decodePath(_){try{return _.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,'The URL path "'+_+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),_}}function stripBasename(_,e){if(e==="/")return _;if(!_.toLowerCase().startsWith(e.toLowerCase()))return null;let j=e.endsWith("/")?e.length-1:e.length,Vt=_.charAt(j);return Vt&&Vt!=="/"?null:_.slice(j)||"/"}function resolvePath(_,e){e===void 0&&(e="/");let{pathname:j,search:Vt="",hash:zt=""}=typeof _=="string"?parsePath(_):_;return{pathname:j?j.startsWith("/")?j:resolvePathname(j,e):e,search:normalizeSearch(Vt),hash:normalizeHash(zt)}}function resolvePathname(_,e){let j=e.replace(/\/+$/,"").split("/");return _.split("/").forEach(zt=>{zt===".."?j.length>1&&j.pop():zt!=="."&&j.push(zt)}),j.length>1?j.join("/"):"/"}function getInvalidPathError(_,e,j,Vt){return"Cannot include a '"+_+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(Vt)+"].  Please separate it out to the ")+("`to."+j+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(_){return _.filter((e,j)=>j===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(_,e){let j=getPathContributingMatches(_);return e?j.map((Vt,zt)=>zt===_.length-1?Vt.pathname:Vt.pathnameBase):j.map(Vt=>Vt.pathnameBase)}function resolveTo(_,e,j,Vt){Vt===void 0&&(Vt=!1);let zt;typeof _=="string"?zt=parsePath(_):(zt=_extends$4({},_),invariant(!zt.pathname||!zt.pathname.includes("?"),getInvalidPathError("?","pathname","search",zt)),invariant(!zt.pathname||!zt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",zt)),invariant(!zt.search||!zt.search.includes("#"),getInvalidPathError("#","search","hash",zt)));let _r=_===""||zt.pathname==="",_o=_r?"/":zt.pathname,ga;if(_o==null)ga=j;else{let _f=e.length-1;if(!Vt&&_o.startsWith("..")){let _m=_o.split("/");for(;_m[0]==="..";)_m.shift(),_f-=1;zt.pathname=_m.join("/")}ga=_f>=0?e[_f]:"/"}let _a=resolvePath(zt,ga),_l=_o&&_o!=="/"&&_o.endsWith("/"),_d=(_r||_o===".")&&j.endsWith("/");return!_a.pathname.endsWith("/")&&(_l||_d)&&(_a.pathname+="/"),_a}const joinPaths=_=>_.join("/").replace(/\/\/+/g,"/"),normalizePathname=_=>_.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=_=>!_||_==="?"?"":_.startsWith("?")?_:"?"+_,normalizeHash=_=>!_||_==="#"?"":_.startsWith("#")?_:"#"+_;class ErrorResponseImpl{constructor(e,j,Vt,zt){zt===void 0&&(zt=!1),this.status=e,this.statusText=j||"",this.internal=zt,Vt instanceof Error?(this.data=Vt.toString(),this.error=Vt):this.data=Vt}}function isRouteErrorResponse(_){return _!=null&&typeof _.status=="number"&&typeof _.statusText=="string"&&typeof _.internal=="boolean"&&"data"in _}const validMutationMethodsArr=["post","put","patch","delete"],validMutationMethods=new Set(validMutationMethodsArr),validRequestMethodsArr=["get",...validMutationMethodsArr],validRequestMethods=new Set(validRequestMethodsArr),redirectStatusCodes=new Set([301,302,303,307,308]),redirectPreserveMethodStatusCodes=new Set([307,308]),IDLE_NAVIGATION={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_FETCHER={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_BLOCKER={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ABSOLUTE_URL_REGEX$1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,defaultMapRouteProperties=_=>({hasErrorBoundary:!!_.hasErrorBoundary}),TRANSITIONS_STORAGE_KEY="remix-router-transitions";function createRouter(_){const e=_.window?_.window:typeof window<"u"?window:void 0,j=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",Vt=!j;invariant(_.routes.length>0,"You must provide a non-empty routes array to createRouter");let zt;if(_.mapRouteProperties)zt=_.mapRouteProperties;else if(_.detectErrorBoundary){let YE=_.detectErrorBoundary;zt=_v=>({hasErrorBoundary:YE(_v)})}else zt=defaultMapRouteProperties;let _r={},_o=convertRoutesToDataRoutes(_.routes,zt,void 0,_r),ga,_a=_.basename||"/",_l=_.unstable_dataStrategy||defaultDataStrategy,_d=_extends$4({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,unstable_skipActionErrorRevalidation:!1},_.future),_f=null,_m=new Set,tE=null,rE=null,oE=null,dE=_.hydrationData!=null,nE=matchRoutes(_o,_.history.location,_a),sE=null;if(nE==null){let YE=getInternalRouterError(404,{pathname:_.history.location.pathname}),{matches:_v,route:s_}=getShortCircuitMatches(_o);nE=_v,sE={[s_.id]:YE}}let lE,EE=nE.some(YE=>YE.route.lazy),wE=nE.some(YE=>YE.route.loader);if(EE)lE=!1;else if(!wE)lE=!0;else if(_d.v7_partialHydration){let YE=_.hydrationData?_.hydrationData.loaderData:null,_v=_.hydrationData?_.hydrationData.errors:null,s_=v_=>v_.route.loader?typeof v_.route.loader=="function"&&v_.route.loader.hydrate===!0?!1:YE&&YE[v_.route.id]!==void 0||_v&&_v[v_.route.id]!==void 0:!0;if(_v){let v_=nE.findIndex(A_=>_v[A_.route.id]!==void 0);lE=nE.slice(0,v_+1).every(s_)}else lE=nE.every(s_)}else lE=_.hydrationData!=null;let IE,_E={historyAction:_.history.action,location:_.history.location,matches:nE,initialized:lE,navigation:IDLE_NAVIGATION,restoreScrollPosition:_.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:_.hydrationData&&_.hydrationData.loaderData||{},actionData:_.hydrationData&&_.hydrationData.actionData||null,errors:_.hydrationData&&_.hydrationData.errors||sE,fetchers:new Map,blockers:new Map},kE=Action.Pop,ME=!1,bE,LE=!1,TE=new Map,OE=null,vE=!1,NE=!1,jE=[],UE=[],RE=new Map,FE=0,VE=-1,BE=new Map,qE=new Set,e_=new Map,b_=new Map,m_=new Set,I_=new Map,w0=new Map,yT=!1;function YT(){if(_f=_.history.listen(YE=>{let{action:_v,location:s_,delta:v_}=YE;if(yT){yT=!1;return}warning(w0.size===0||v_!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let A_=qP({currentLocation:_E.location,nextLocation:s_,historyAction:_v});if(A_&&v_!=null){yT=!0,_.history.go(v_*-1),nO(A_,{state:"blocked",location:s_,proceed(){nO(A_,{state:"proceeding",proceed:void 0,reset:void 0,location:s_}),_.history.go(v_)},reset(){let r0=new Map(_E.blockers);r0.set(A_,IDLE_BLOCKER),lS({blockers:r0})}});return}return S_(_v,s_)}),j){restoreAppliedTransitions(e,TE);let YE=()=>persistAppliedTransitions(e,TE);e.addEventListener("pagehide",YE),OE=()=>e.removeEventListener("pagehide",YE)}return _E.initialized||S_(Action.Pop,_E.location,{initialHydration:!0}),IE}function oT(){_f&&_f(),OE&&OE(),_m.clear(),bE&&bE.abort(),_E.fetchers.forEach((YE,_v)=>EI(_v)),_E.blockers.forEach((YE,_v)=>SN(_v))}function LS(YE){return _m.add(YE),()=>_m.delete(YE)}function lS(YE,_v){_v===void 0&&(_v={}),_E=_extends$4({},_E,YE);let s_=[],v_=[];_d.v7_fetcherPersist&&_E.fetchers.forEach((A_,r0)=>{A_.state==="idle"&&(m_.has(r0)?v_.push(r0):s_.push(r0))}),[..._m].forEach(A_=>A_(_E,{deletedFetchers:v_,unstable_viewTransitionOpts:_v.viewTransitionOpts,unstable_flushSync:_v.flushSync===!0})),_d.v7_fetcherPersist&&(s_.forEach(A_=>_E.fetchers.delete(A_)),v_.forEach(A_=>EI(A_)))}function oS(YE,_v,s_){var v_,A_;let{flushSync:r0}=s_===void 0?{}:s_,O_=_E.actionData!=null&&_E.navigation.formMethod!=null&&isMutationMethod(_E.navigation.formMethod)&&_E.navigation.state==="loading"&&((v_=YE.state)==null?void 0:v_._isRedirect)!==!0,N_;_v.actionData?Object.keys(_v.actionData).length>0?N_=_v.actionData:N_=null:O_?N_=_E.actionData:N_=null;let a0=_v.loaderData?mergeLoaderData(_E.loaderData,_v.loaderData,_v.matches||[],_v.errors):_E.loaderData,$_=_E.blockers;$_.size>0&&($_=new Map($_),$_.forEach((Y_,sS)=>$_.set(sS,IDLE_BLOCKER)));let xS=ME===!0||_E.navigation.formMethod!=null&&isMutationMethod(_E.navigation.formMethod)&&((A_=YE.state)==null?void 0:A_._isRedirect)!==!0;ga&&(_o=ga,ga=void 0),vE||kE===Action.Pop||(kE===Action.Push?_.history.push(YE,YE.state):kE===Action.Replace&&_.history.replace(YE,YE.state));let MS;if(kE===Action.Pop){let Y_=TE.get(_E.location.pathname);Y_&&Y_.has(YE.pathname)?MS={currentLocation:_E.location,nextLocation:YE}:TE.has(YE.pathname)&&(MS={currentLocation:YE,nextLocation:_E.location})}else if(LE){let Y_=TE.get(_E.location.pathname);Y_?Y_.add(YE.pathname):(Y_=new Set([YE.pathname]),TE.set(_E.location.pathname,Y_)),MS={currentLocation:_E.location,nextLocation:YE}}lS(_extends$4({},_v,{actionData:N_,loaderData:a0,historyAction:kE,location:YE,initialized:!0,navigation:IDLE_NAVIGATION,revalidation:"idle",restoreScrollPosition:$P(YE,_v.matches||_E.matches),preventScrollReset:xS,blockers:$_}),{viewTransitionOpts:MS,flushSync:r0===!0}),kE=Action.Pop,ME=!1,LE=!1,vE=!1,NE=!1,jE=[],UE=[]}async function q_(YE,_v){if(typeof YE=="number"){_.history.go(YE);return}let s_=normalizeTo(_E.location,_E.matches,_a,_d.v7_prependBasename,YE,_d.v7_relativeSplatPath,_v==null?void 0:_v.fromRouteId,_v==null?void 0:_v.relative),{path:v_,submission:A_,error:r0}=normalizeNavigateOptions(_d.v7_normalizeFormMethod,!1,s_,_v),O_=_E.location,N_=createLocation(_E.location,v_,_v&&_v.state);N_=_extends$4({},N_,_.history.encodeLocation(N_));let a0=_v&&_v.replace!=null?_v.replace:void 0,$_=Action.Push;a0===!0?$_=Action.Replace:a0===!1||A_!=null&&isMutationMethod(A_.formMethod)&&A_.formAction===_E.location.pathname+_E.location.search&&($_=Action.Replace);let xS=_v&&"preventScrollReset"in _v?_v.preventScrollReset===!0:void 0,MS=(_v&&_v.unstable_flushSync)===!0,Y_=qP({currentLocation:O_,nextLocation:N_,historyAction:$_});if(Y_){nO(Y_,{state:"blocked",location:N_,proceed(){nO(Y_,{state:"proceeding",proceed:void 0,reset:void 0,location:N_}),q_(YE,_v)},reset(){let sS=new Map(_E.blockers);sS.set(Y_,IDLE_BLOCKER),lS({blockers:sS})}});return}return await S_($_,N_,{submission:A_,pendingError:r0,preventScrollReset:xS,replace:_v&&_v.replace,enableViewTransition:_v&&_v.unstable_viewTransition,flushSync:MS})}function E0(){if(EN(),lS({revalidation:"loading"}),_E.navigation.state!=="submitting"){if(_E.navigation.state==="idle"){S_(_E.historyAction,_E.location,{startUninterruptedRevalidation:!0});return}S_(kE||_E.historyAction,_E.navigation.location,{overrideNavigation:_E.navigation})}}async function S_(YE,_v,s_){bE&&bE.abort(),bE=null,kE=YE,vE=(s_&&s_.startUninterruptedRevalidation)===!0,WM(_E.location,_E.matches),ME=(s_&&s_.preventScrollReset)===!0,LE=(s_&&s_.enableViewTransition)===!0;let v_=ga||_o,A_=s_&&s_.overrideNavigation,r0=matchRoutes(v_,_v,_a),O_=(s_&&s_.flushSync)===!0;if(!r0){let Y_=getInternalRouterError(404,{pathname:_v.pathname}),{matches:sS,route:NS}=getShortCircuitMatches(v_);BR(),oS(_v,{matches:sS,loaderData:{},errors:{[NS.id]:Y_}},{flushSync:O_});return}if(_E.initialized&&!NE&&isHashChangeOnly(_E.location,_v)&&!(s_&&s_.submission&&isMutationMethod(s_.submission.formMethod))){oS(_v,{matches:r0},{flushSync:O_});return}bE=new AbortController;let N_=createClientSideRequest(_.history,_v,bE.signal,s_&&s_.submission),a0;if(s_&&s_.pendingError)a0=[findNearestBoundary(r0).route.id,{type:ResultType.error,error:s_.pendingError}];else if(s_&&s_.submission&&isMutationMethod(s_.submission.formMethod)){let Y_=await v0(N_,_v,s_.submission,r0,{replace:s_.replace,flushSync:O_});if(Y_.shortCircuited)return;a0=Y_.pendingActionResult,A_=getLoadingNavigation(_v,s_.submission),O_=!1,N_=createClientSideRequest(_.history,N_.url,N_.signal)}let{shortCircuited:$_,loaderData:xS,errors:MS}=await k0(N_,_v,r0,A_,s_&&s_.submission,s_&&s_.fetcherSubmission,s_&&s_.replace,s_&&s_.initialHydration===!0,O_,a0);$_||(bE=null,oS(_v,_extends$4({matches:r0},getActionDataForCommit(a0),{loaderData:xS,errors:MS})))}async function v0(YE,_v,s_,v_,A_){A_===void 0&&(A_={}),EN();let r0=getSubmittingNavigation(_v,s_);lS({navigation:r0},{flushSync:A_.flushSync===!0});let O_,N_=getTargetMatch(v_,_v);if(!N_.route.action&&!N_.route.lazy)O_={type:ResultType.error,error:getInternalRouterError(405,{method:YE.method,pathname:_v.pathname,routeId:N_.route.id})};else if(O_=(await JT("action",YE,[N_],v_))[0],YE.signal.aborted)return{shortCircuited:!0};if(isRedirectResult(O_)){let a0;return A_&&A_.replace!=null?a0=A_.replace:a0=normalizeRedirectLocation(O_.response.headers.get("Location"),new URL(YE.url),_a)===_E.location.pathname+_E.location.search,await yS(YE,O_,{submission:s_,replace:a0}),{shortCircuited:!0}}if(isDeferredResult(O_))throw getInternalRouterError(400,{type:"defer-action"});if(isErrorResult(O_)){let a0=findNearestBoundary(v_,N_.route.id);return(A_&&A_.replace)!==!0&&(kE=Action.Push),{pendingActionResult:[a0.route.id,O_]}}return{pendingActionResult:[N_.route.id,O_]}}async function k0(YE,_v,s_,v_,A_,r0,O_,N_,a0,$_){let xS=v_||getLoadingNavigation(_v,A_),MS=A_||r0||getSubmissionFromNavigation(xS),Y_=ga||_o,[sS,NS]=getMatchesToLoad(_.history,_E,s_,MS,_v,_d.v7_partialHydration&&N_===!0,_d.unstable_skipActionErrorRevalidation,NE,jE,UE,m_,e_,qE,Y_,_a,$_);if(BR(e0=>!(s_&&s_.some(eT=>eT.route.id===e0))||sS&&sS.some(eT=>eT.route.id===e0)),VE=++FE,sS.length===0&&NS.length===0){let e0=yN();return oS(_v,_extends$4({matches:s_,loaderData:{},errors:$_&&isErrorResult($_[1])?{[$_[0]]:$_[1].error}:null},getActionDataForCommit($_),e0?{fetchers:new Map(_E.fetchers)}:{}),{flushSync:a0}),{shortCircuited:!0}}if(!vE&&(!_d.v7_partialHydration||!N_)){NS.forEach(eT=>{let bT=_E.fetchers.get(eT.key),_0=getLoadingFetcher(void 0,bT?bT.data:void 0);_E.fetchers.set(eT.key,_0)});let e0;$_&&!isErrorResult($_[1])?e0={[$_[0]]:$_[1].data}:_E.actionData&&(Object.keys(_E.actionData).length===0?e0=null:e0=_E.actionData),lS(_extends$4({navigation:xS},e0!==void 0?{actionData:e0}:{},NS.length>0?{fetchers:new Map(_E.fetchers)}:{}),{flushSync:a0})}NS.forEach(e0=>{RE.has(e0.key)&&SR(e0.key),e0.controller&&RE.set(e0.key,e0.controller)});let k1=()=>NS.forEach(e0=>SR(e0.key));bE&&bE.signal.addEventListener("abort",k1);let{loaderResults:GR,fetcherResults:D1}=await XT(_E.matches,s_,sS,NS,YE);if(YE.signal.aborted)return{shortCircuited:!0};bE&&bE.signal.removeEventListener("abort",k1),NS.forEach(e0=>RE.delete(e0.key));let p1=findRedirect([...GR,...D1]);if(p1){if(p1.idx>=sS.length){let e0=NS[p1.idx-sS.length].key;qE.add(e0)}return await yS(YE,p1.result,{replace:O_}),{shortCircuited:!0}}let{loaderData:HR,errors:xT}=processLoaderData(_E,s_,sS,GR,$_,NS,D1,I_);I_.forEach((e0,eT)=>{e0.subscribe(bT=>{(bT||e0.done)&&I_.delete(eT)})}),_d.v7_partialHydration&&N_&&_E.errors&&Object.entries(_E.errors).filter(e0=>{let[eT]=e0;return!sS.some(bT=>bT.route.id===eT)}).forEach(e0=>{let[eT,bT]=e0;xT=Object.assign(xT||{},{[eT]:bT})});let TR=yN(),rO=bN(VE),iO=TR||rO||NS.length>0;return _extends$4({loaderData:HR,errors:xT},iO?{fetchers:new Map(_E.fetchers)}:{})}function QS(YE,_v,s_,v_){if(Vt)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");RE.has(YE)&&SR(YE);let A_=(v_&&v_.unstable_flushSync)===!0,r0=ga||_o,O_=normalizeTo(_E.location,_E.matches,_a,_d.v7_prependBasename,s_,_d.v7_relativeSplatPath,_v,v_==null?void 0:v_.relative),N_=matchRoutes(r0,O_,_a);if(!N_){OS(YE,_v,getInternalRouterError(404,{pathname:O_}),{flushSync:A_});return}let{path:a0,submission:$_,error:xS}=normalizeNavigateOptions(_d.v7_normalizeFormMethod,!0,O_,v_);if(xS){OS(YE,_v,xS,{flushSync:A_});return}let MS=getTargetMatch(N_,a0);if(ME=(v_&&v_.preventScrollReset)===!0,$_&&isMutationMethod($_.formMethod)){yR(YE,_v,a0,MS,N_,A_,$_);return}e_.set(YE,{routeId:_v,path:a0}),TS(YE,_v,a0,MS,N_,A_,$_)}async function yR(YE,_v,s_,v_,A_,r0,O_){if(EN(),e_.delete(YE),!v_.route.action&&!v_.route.lazy){let _0=getInternalRouterError(405,{method:O_.formMethod,pathname:s_,routeId:_v});OS(YE,_v,_0,{flushSync:r0});return}let N_=_E.fetchers.get(YE);bR(YE,getSubmittingFetcher(O_,N_),{flushSync:r0});let a0=new AbortController,$_=createClientSideRequest(_.history,s_,a0.signal,O_);RE.set(YE,a0);let xS=FE,Y_=(await JT("action",$_,[v_],A_))[0];if($_.signal.aborted){RE.get(YE)===a0&&RE.delete(YE);return}if(_d.v7_fetcherPersist&&m_.has(YE)){if(isRedirectResult(Y_)||isErrorResult(Y_)){bR(YE,getDoneFetcher(void 0));return}}else{if(isRedirectResult(Y_))if(RE.delete(YE),VE>xS){bR(YE,getDoneFetcher(void 0));return}else return qE.add(YE),bR(YE,getLoadingFetcher(O_)),yS($_,Y_,{fetcherSubmission:O_});if(isErrorResult(Y_)){OS(YE,_v,Y_.error);return}}if(isDeferredResult(Y_))throw getInternalRouterError(400,{type:"defer-action"});let sS=_E.navigation.location||_E.location,NS=createClientSideRequest(_.history,sS,a0.signal),k1=ga||_o,GR=_E.navigation.state!=="idle"?matchRoutes(k1,_E.navigation.location,_a):_E.matches;invariant(GR,"Didn't find any matches after fetcher action");let D1=++FE;BE.set(YE,D1);let p1=getLoadingFetcher(O_,Y_.data);_E.fetchers.set(YE,p1);let[HR,xT]=getMatchesToLoad(_.history,_E,GR,O_,sS,!1,_d.unstable_skipActionErrorRevalidation,NE,jE,UE,m_,e_,qE,k1,_a,[v_.route.id,Y_]);xT.filter(_0=>_0.key!==YE).forEach(_0=>{let vI=_0.key,YP=_E.fetchers.get(vI),zM=getLoadingFetcher(void 0,YP?YP.data:void 0);_E.fetchers.set(vI,zM),RE.has(vI)&&SR(vI),_0.controller&&RE.set(vI,_0.controller)}),lS({fetchers:new Map(_E.fetchers)});let TR=()=>xT.forEach(_0=>SR(_0.key));a0.signal.addEventListener("abort",TR);let{loaderResults:rO,fetcherResults:iO}=await XT(_E.matches,GR,HR,xT,NS);if(a0.signal.aborted)return;a0.signal.removeEventListener("abort",TR),BE.delete(YE),RE.delete(YE),xT.forEach(_0=>RE.delete(_0.key));let e0=findRedirect([...rO,...iO]);if(e0){if(e0.idx>=HR.length){let _0=xT[e0.idx-HR.length].key;qE.add(_0)}return yS(NS,e0.result)}let{loaderData:eT,errors:bT}=processLoaderData(_E,_E.matches,HR,rO,void 0,xT,iO,I_);if(_E.fetchers.has(YE)){let _0=getDoneFetcher(Y_.data);_E.fetchers.set(YE,_0)}bN(D1),_E.navigation.state==="loading"&&D1>VE?(invariant(kE,"Expected pending action"),bE&&bE.abort(),oS(_E.navigation.location,{matches:GR,loaderData:eT,errors:bT,fetchers:new Map(_E.fetchers)})):(lS({errors:bT,loaderData:mergeLoaderData(_E.loaderData,eT,GR,bT),fetchers:new Map(_E.fetchers)}),NE=!1)}async function TS(YE,_v,s_,v_,A_,r0,O_){let N_=_E.fetchers.get(YE);bR(YE,getLoadingFetcher(O_,N_?N_.data:void 0),{flushSync:r0});let a0=new AbortController,$_=createClientSideRequest(_.history,s_,a0.signal);RE.set(YE,a0);let xS=FE,Y_=(await JT("loader",$_,[v_],A_))[0];if(isDeferredResult(Y_)&&(Y_=await resolveDeferredData(Y_,$_.signal,!0)||Y_),RE.get(YE)===a0&&RE.delete(YE),!$_.signal.aborted){if(m_.has(YE)){bR(YE,getDoneFetcher(void 0));return}if(isRedirectResult(Y_))if(VE>xS){bR(YE,getDoneFetcher(void 0));return}else{qE.add(YE),await yS($_,Y_);return}if(isErrorResult(Y_)){OS(YE,_v,Y_.error);return}invariant(!isDeferredResult(Y_),"Unhandled fetcher deferred data"),bR(YE,getDoneFetcher(Y_.data))}}async function yS(YE,_v,s_){let{submission:v_,fetcherSubmission:A_,replace:r0}=s_===void 0?{}:s_;_v.response.headers.has("X-Remix-Revalidate")&&(NE=!0);let O_=_v.response.headers.get("Location");invariant(O_,"Expected a Location header on the redirect Response"),O_=normalizeRedirectLocation(O_,new URL(YE.url),_a);let N_=createLocation(_E.location,O_,{_isRedirect:!0});if(j){let sS=!1;if(_v.response.headers.has("X-Remix-Reload-Document"))sS=!0;else if(ABSOLUTE_URL_REGEX$1.test(O_)){const NS=_.history.createURL(O_);sS=NS.origin!==e.location.origin||stripBasename(NS.pathname,_a)==null}if(sS){r0?e.location.replace(O_):e.location.assign(O_);return}}bE=null;let a0=r0===!0?Action.Replace:Action.Push,{formMethod:$_,formAction:xS,formEncType:MS}=_E.navigation;!v_&&!A_&&$_&&xS&&MS&&(v_=getSubmissionFromNavigation(_E.navigation));let Y_=v_||A_;if(redirectPreserveMethodStatusCodes.has(_v.response.status)&&Y_&&isMutationMethod(Y_.formMethod))await S_(a0,N_,{submission:_extends$4({},Y_,{formAction:O_}),preventScrollReset:ME});else{let sS=getLoadingNavigation(N_,v_);await S_(a0,N_,{overrideNavigation:sS,fetcherSubmission:A_,preventScrollReset:ME})}}async function JT(YE,_v,s_,v_){try{let A_=await callDataStrategyImpl(_l,YE,_v,s_,v_,_r,zt);return await Promise.all(A_.map((r0,O_)=>{if(isRedirectHandlerResult(r0)){let N_=r0.result;return{type:ResultType.redirect,response:normalizeRelativeRoutingRedirectResponse(N_,_v,s_[O_].route.id,v_,_a,_d.v7_relativeSplatPath)}}return convertHandlerResultToDataResult(r0)}))}catch(A_){return s_.map(()=>({type:ResultType.error,error:A_}))}}async function XT(YE,_v,s_,v_,A_){let[r0,...O_]=await Promise.all([s_.length?JT("loader",A_,s_,_v):[],...v_.map(N_=>{if(N_.matches&&N_.match&&N_.controller){let a0=createClientSideRequest(_.history,N_.path,N_.controller.signal);return JT("loader",a0,[N_.match],N_.matches).then($_=>$_[0])}else return Promise.resolve({type:ResultType.error,error:getInternalRouterError(404,{pathname:N_.path})})})]);return await Promise.all([resolveDeferredResults(YE,s_,r0,r0.map(()=>A_.signal),!1,_E.loaderData),resolveDeferredResults(YE,v_.map(N_=>N_.match),O_,v_.map(N_=>N_.controller?N_.controller.signal:null),!0)]),{loaderResults:r0,fetcherResults:O_}}function EN(){NE=!0,jE.push(...BR()),e_.forEach((YE,_v)=>{RE.has(_v)&&(UE.push(_v),SR(_v))})}function bR(YE,_v,s_){s_===void 0&&(s_={}),_E.fetchers.set(YE,_v),lS({fetchers:new Map(_E.fetchers)},{flushSync:(s_&&s_.flushSync)===!0})}function OS(YE,_v,s_,v_){v_===void 0&&(v_={});let A_=findNearestBoundary(_E.matches,_v);EI(YE),lS({errors:{[A_.route.id]:s_},fetchers:new Map(_E.fetchers)},{flushSync:(v_&&v_.flushSync)===!0})}function VR(YE){return _d.v7_fetcherPersist&&(b_.set(YE,(b_.get(YE)||0)+1),m_.has(YE)&&m_.delete(YE)),_E.fetchers.get(YE)||IDLE_FETCHER}function EI(YE){let _v=_E.fetchers.get(YE);RE.has(YE)&&!(_v&&_v.state==="loading"&&BE.has(YE))&&SR(YE),e_.delete(YE),BE.delete(YE),qE.delete(YE),m_.delete(YE),_E.fetchers.delete(YE)}function vN(YE){if(_d.v7_fetcherPersist){let _v=(b_.get(YE)||0)-1;_v<=0?(b_.delete(YE),m_.add(YE)):b_.set(YE,_v)}else EI(YE);lS({fetchers:new Map(_E.fetchers)})}function SR(YE){let _v=RE.get(YE);invariant(_v,"Expected fetch controller: "+YE),_v.abort(),RE.delete(YE)}function _N(YE){for(let _v of YE){let s_=VR(_v),v_=getDoneFetcher(s_.data);_E.fetchers.set(_v,v_)}}function yN(){let YE=[],_v=!1;for(let s_ of qE){let v_=_E.fetchers.get(s_);invariant(v_,"Expected fetcher: "+s_),v_.state==="loading"&&(qE.delete(s_),YE.push(s_),_v=!0)}return _N(YE),_v}function bN(YE){let _v=[];for(let[s_,v_]of BE)if(v_<YE){let A_=_E.fetchers.get(s_);invariant(A_,"Expected fetcher: "+s_),A_.state==="loading"&&(SR(s_),BE.delete(s_),_v.push(s_))}return _N(_v),_v.length>0}function h1(YE,_v){let s_=_E.blockers.get(YE)||IDLE_BLOCKER;return w0.get(YE)!==_v&&w0.set(YE,_v),s_}function SN(YE){_E.blockers.delete(YE),w0.delete(YE)}function nO(YE,_v){let s_=_E.blockers.get(YE)||IDLE_BLOCKER;invariant(s_.state==="unblocked"&&_v.state==="blocked"||s_.state==="blocked"&&_v.state==="blocked"||s_.state==="blocked"&&_v.state==="proceeding"||s_.state==="blocked"&&_v.state==="unblocked"||s_.state==="proceeding"&&_v.state==="unblocked","Invalid blocker state transition: "+s_.state+" -> "+_v.state);let v_=new Map(_E.blockers);v_.set(YE,_v),lS({blockers:v_})}function qP(YE){let{currentLocation:_v,nextLocation:s_,historyAction:v_}=YE;if(w0.size===0)return;w0.size>1&&warning(!1,"A router only supports one blocker at a time");let A_=Array.from(w0.entries()),[r0,O_]=A_[A_.length-1],N_=_E.blockers.get(r0);if(!(N_&&N_.state==="proceeding")&&O_({currentLocation:_v,nextLocation:s_,historyAction:v_}))return r0}function BR(YE){let _v=[];return I_.forEach((s_,v_)=>{(!YE||YE(v_))&&(s_.cancel(),_v.push(v_),I_.delete(v_))}),_v}function zP(YE,_v,s_){if(tE=YE,oE=_v,rE=s_||null,!dE&&_E.navigation===IDLE_NAVIGATION){dE=!0;let v_=$P(_E.location,_E.matches);v_!=null&&lS({restoreScrollPosition:v_})}return()=>{tE=null,oE=null,rE=null}}function KP(YE,_v){return rE&&rE(YE,_v.map(v_=>convertRouteMatchToUiMatch(v_,_E.loaderData)))||YE.key}function WM(YE,_v){if(tE&&oE){let s_=KP(YE,_v);tE[s_]=oE()}}function $P(YE,_v){if(tE){let s_=KP(YE,_v),v_=tE[s_];if(typeof v_=="number")return v_}return null}function qM(YE){_r={},ga=convertRoutesToDataRoutes(YE,zt,void 0,_r)}return IE={get basename(){return _a},get future(){return _d},get state(){return _E},get routes(){return _o},get window(){return e},initialize:YT,subscribe:LS,enableScrollRestoration:zP,navigate:q_,fetch:QS,revalidate:E0,createHref:YE=>_.history.createHref(YE),encodeLocation:YE=>_.history.encodeLocation(YE),getFetcher:VR,deleteFetcher:vN,dispose:oT,getBlocker:h1,deleteBlocker:SN,_internalFetchControllers:RE,_internalActiveDeferreds:I_,_internalSetRoutes:qM},IE}function isSubmissionNavigation(_){return _!=null&&("formData"in _&&_.formData!=null||"body"in _&&_.body!==void 0)}function normalizeTo(_,e,j,Vt,zt,_r,_o,ga){let _a,_l;if(_o){_a=[];for(let _f of e)if(_a.push(_f),_f.route.id===_o){_l=_f;break}}else _a=e,_l=e[e.length-1];let _d=resolveTo(zt||".",getResolveToMatches(_a,_r),stripBasename(_.pathname,j)||_.pathname,ga==="path");return zt==null&&(_d.search=_.search,_d.hash=_.hash),(zt==null||zt===""||zt===".")&&_l&&_l.route.index&&!hasNakedIndexQuery(_d.search)&&(_d.search=_d.search?_d.search.replace(/^\?/,"?index&"):"?index"),Vt&&j!=="/"&&(_d.pathname=_d.pathname==="/"?j:joinPaths([j,_d.pathname])),createPath(_d)}function normalizeNavigateOptions(_,e,j,Vt){if(!Vt||!isSubmissionNavigation(Vt))return{path:j};if(Vt.formMethod&&!isValidMethod(Vt.formMethod))return{path:j,error:getInternalRouterError(405,{method:Vt.formMethod})};let zt=()=>({path:j,error:getInternalRouterError(400,{type:"invalid-body"})}),_r=Vt.formMethod||"get",_o=_?_r.toUpperCase():_r.toLowerCase(),ga=stripHashFromPath(j);if(Vt.body!==void 0){if(Vt.formEncType==="text/plain"){if(!isMutationMethod(_o))return zt();let _m=typeof Vt.body=="string"?Vt.body:Vt.body instanceof FormData||Vt.body instanceof URLSearchParams?Array.from(Vt.body.entries()).reduce((tE,rE)=>{let[oE,dE]=rE;return""+tE+oE+"="+dE+`
`},""):String(Vt.body);return{path:j,submission:{formMethod:_o,formAction:ga,formEncType:Vt.formEncType,formData:void 0,json:void 0,text:_m}}}else if(Vt.formEncType==="application/json"){if(!isMutationMethod(_o))return zt();try{let _m=typeof Vt.body=="string"?JSON.parse(Vt.body):Vt.body;return{path:j,submission:{formMethod:_o,formAction:ga,formEncType:Vt.formEncType,formData:void 0,json:_m,text:void 0}}}catch{return zt()}}}invariant(typeof FormData=="function","FormData is not available in this environment");let _a,_l;if(Vt.formData)_a=convertFormDataToSearchParams(Vt.formData),_l=Vt.formData;else if(Vt.body instanceof FormData)_a=convertFormDataToSearchParams(Vt.body),_l=Vt.body;else if(Vt.body instanceof URLSearchParams)_a=Vt.body,_l=convertSearchParamsToFormData(_a);else if(Vt.body==null)_a=new URLSearchParams,_l=new FormData;else try{_a=new URLSearchParams(Vt.body),_l=convertSearchParamsToFormData(_a)}catch{return zt()}let _d={formMethod:_o,formAction:ga,formEncType:Vt&&Vt.formEncType||"application/x-www-form-urlencoded",formData:_l,json:void 0,text:void 0};if(isMutationMethod(_d.formMethod))return{path:j,submission:_d};let _f=parsePath(j);return e&&_f.search&&hasNakedIndexQuery(_f.search)&&_a.append("index",""),_f.search="?"+_a,{path:createPath(_f),submission:_d}}function getLoaderMatchesUntilBoundary(_,e){let j=_;if(e){let Vt=_.findIndex(zt=>zt.route.id===e);Vt>=0&&(j=_.slice(0,Vt))}return j}function getMatchesToLoad(_,e,j,Vt,zt,_r,_o,ga,_a,_l,_d,_f,_m,tE,rE,oE){let dE=oE?isErrorResult(oE[1])?oE[1].error:oE[1].data:void 0,nE=_.createURL(e.location),sE=_.createURL(zt),lE=oE&&isErrorResult(oE[1])?oE[0]:void 0,EE=lE?getLoaderMatchesUntilBoundary(j,lE):j,wE=oE?oE[1].statusCode:void 0,IE=_o&&wE&&wE>=400,_E=EE.filter((ME,bE)=>{let{route:LE}=ME;if(LE.lazy)return!0;if(LE.loader==null)return!1;if(_r)return typeof LE.loader!="function"||LE.loader.hydrate?!0:e.loaderData[LE.id]===void 0&&(!e.errors||e.errors[LE.id]===void 0);if(isNewLoader(e.loaderData,e.matches[bE],ME)||_a.some(vE=>vE===ME.route.id))return!0;let TE=e.matches[bE],OE=ME;return shouldRevalidateLoader(ME,_extends$4({currentUrl:nE,currentParams:TE.params,nextUrl:sE,nextParams:OE.params},Vt,{actionResult:dE,unstable_actionStatus:wE,defaultShouldRevalidate:IE?!1:ga||nE.pathname+nE.search===sE.pathname+sE.search||nE.search!==sE.search||isNewRouteInstance(TE,OE)}))}),kE=[];return _f.forEach((ME,bE)=>{if(_r||!j.some(NE=>NE.route.id===ME.routeId)||_d.has(bE))return;let LE=matchRoutes(tE,ME.path,rE);if(!LE){kE.push({key:bE,routeId:ME.routeId,path:ME.path,matches:null,match:null,controller:null});return}let TE=e.fetchers.get(bE),OE=getTargetMatch(LE,ME.path),vE=!1;_m.has(bE)?vE=!1:_l.includes(bE)?vE=!0:TE&&TE.state!=="idle"&&TE.data===void 0?vE=ga:vE=shouldRevalidateLoader(OE,_extends$4({currentUrl:nE,currentParams:e.matches[e.matches.length-1].params,nextUrl:sE,nextParams:j[j.length-1].params},Vt,{actionResult:dE,unstable_actionStatus:wE,defaultShouldRevalidate:IE?!1:ga})),vE&&kE.push({key:bE,routeId:ME.routeId,path:ME.path,matches:LE,match:OE,controller:new AbortController})}),[_E,kE]}function isNewLoader(_,e,j){let Vt=!e||j.route.id!==e.route.id,zt=_[j.route.id]===void 0;return Vt||zt}function isNewRouteInstance(_,e){let j=_.route.path;return _.pathname!==e.pathname||j!=null&&j.endsWith("*")&&_.params["*"]!==e.params["*"]}function shouldRevalidateLoader(_,e){if(_.route.shouldRevalidate){let j=_.route.shouldRevalidate(e);if(typeof j=="boolean")return j}return e.defaultShouldRevalidate}async function loadLazyRouteModule(_,e,j){if(!_.lazy)return;let Vt=await _.lazy();if(!_.lazy)return;let zt=j[_.id];invariant(zt,"No route found in manifest");let _r={};for(let _o in Vt){let _a=zt[_o]!==void 0&&_o!=="hasErrorBoundary";warning(!_a,'Route "'+zt.id+'" has a static property "'+_o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+_o+'" will be ignored.')),!_a&&!immutableRouteKeys.has(_o)&&(_r[_o]=Vt[_o])}Object.assign(zt,_r),Object.assign(zt,_extends$4({},e(zt),{lazy:void 0}))}function defaultDataStrategy(_){return Promise.all(_.matches.map(e=>e.resolve()))}async function callDataStrategyImpl(_,e,j,Vt,zt,_r,_o,ga){let _a=Vt.reduce((_f,_m)=>_f.add(_m.route.id),new Set),_l=new Set,_d=await _({matches:zt.map(_f=>{let _m=_a.has(_f.route.id);return _extends$4({},_f,{shouldLoad:_m,resolve:rE=>(_l.add(_f.route.id),_m?callLoaderOrAction(e,j,_f,_r,_o,rE,ga):Promise.resolve({type:ResultType.data,result:void 0}))})}),request:j,params:zt[0].params,context:ga});return zt.forEach(_f=>invariant(_l.has(_f.route.id),'`match.resolve()` was not called for route id "'+_f.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),_d.filter((_f,_m)=>_a.has(zt[_m].route.id))}async function callLoaderOrAction(_,e,j,Vt,zt,_r,_o){let ga,_a,_l=_d=>{let _f,_m=new Promise((oE,dE)=>_f=dE);_a=()=>_f(),e.signal.addEventListener("abort",_a);let tE=oE=>typeof _d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+_+'" [routeId: '+j.route.id+"]"))):_d({request:e,params:j.params,context:_o},...oE!==void 0?[oE]:[]),rE;return _r?rE=_r(oE=>tE(oE)):rE=(async()=>{try{return{type:"data",result:await tE()}}catch(oE){return{type:"error",result:oE}}})(),Promise.race([rE,_m])};try{let _d=j.route[_];if(j.route.lazy)if(_d){let _f,[_m]=await Promise.all([_l(_d).catch(tE=>{_f=tE}),loadLazyRouteModule(j.route,zt,Vt)]);if(_f!==void 0)throw _f;ga=_m}else if(await loadLazyRouteModule(j.route,zt,Vt),_d=j.route[_],_d)ga=await _l(_d);else if(_==="action"){let _f=new URL(e.url),_m=_f.pathname+_f.search;throw getInternalRouterError(405,{method:e.method,pathname:_m,routeId:j.route.id})}else return{type:ResultType.data,result:void 0};else if(_d)ga=await _l(_d);else{let _f=new URL(e.url),_m=_f.pathname+_f.search;throw getInternalRouterError(404,{pathname:_m})}invariant(ga.result!==void 0,"You defined "+(_==="action"?"an action":"a loader")+" for route "+('"'+j.route.id+"\" but didn't return anything from your `"+_+"` ")+"function. Please return a value or `null`.")}catch(_d){return{type:ResultType.error,result:_d}}finally{_a&&e.signal.removeEventListener("abort",_a)}return ga}async function convertHandlerResultToDataResult(_){let{result:e,type:j,status:Vt}=_;if(isResponse$1(e)){let _o;try{let ga=e.headers.get("Content-Type");ga&&/\bapplication\/json\b/.test(ga)?e.body==null?_o=null:_o=await e.json():_o=await e.text()}catch(ga){return{type:ResultType.error,error:ga}}return j===ResultType.error?{type:ResultType.error,error:new ErrorResponseImpl(e.status,e.statusText,_o),statusCode:e.status,headers:e.headers}:{type:ResultType.data,data:_o,statusCode:e.status,headers:e.headers}}if(j===ResultType.error)return{type:ResultType.error,error:e,statusCode:isRouteErrorResponse(e)?e.status:Vt};if(isDeferredData(e)){var zt,_r;return{type:ResultType.deferred,deferredData:e,statusCode:(zt=e.init)==null?void 0:zt.status,headers:((_r=e.init)==null?void 0:_r.headers)&&new Headers(e.init.headers)}}return{type:ResultType.data,data:e,statusCode:Vt}}function normalizeRelativeRoutingRedirectResponse(_,e,j,Vt,zt,_r){let _o=_.headers.get("Location");if(invariant(_o,"Redirects returned/thrown from loaders/actions must have a Location header"),!ABSOLUTE_URL_REGEX$1.test(_o)){let ga=Vt.slice(0,Vt.findIndex(_a=>_a.route.id===j)+1);_o=normalizeTo(new URL(e.url),ga,zt,!0,_o,_r),_.headers.set("Location",_o)}return _}function normalizeRedirectLocation(_,e,j){if(ABSOLUTE_URL_REGEX$1.test(_)){let Vt=_,zt=Vt.startsWith("//")?new URL(e.protocol+Vt):new URL(Vt),_r=stripBasename(zt.pathname,j)!=null;if(zt.origin===e.origin&&_r)return zt.pathname+zt.search+zt.hash}return _}function createClientSideRequest(_,e,j,Vt){let zt=_.createURL(stripHashFromPath(e)).toString(),_r={signal:j};if(Vt&&isMutationMethod(Vt.formMethod)){let{formMethod:_o,formEncType:ga}=Vt;_r.method=_o.toUpperCase(),ga==="application/json"?(_r.headers=new Headers({"Content-Type":ga}),_r.body=JSON.stringify(Vt.json)):ga==="text/plain"?_r.body=Vt.text:ga==="application/x-www-form-urlencoded"&&Vt.formData?_r.body=convertFormDataToSearchParams(Vt.formData):_r.body=Vt.formData}return new Request(zt,_r)}function convertFormDataToSearchParams(_){let e=new URLSearchParams;for(let[j,Vt]of _.entries())e.append(j,typeof Vt=="string"?Vt:Vt.name);return e}function convertSearchParamsToFormData(_){let e=new FormData;for(let[j,Vt]of _.entries())e.append(j,Vt);return e}function processRouteLoaderData(_,e,j,Vt,zt,_r){let _o={},ga=null,_a,_l=!1,_d={},_f=Vt&&isErrorResult(Vt[1])?Vt[1].error:void 0;return j.forEach((_m,tE)=>{let rE=e[tE].route.id;if(invariant(!isRedirectResult(_m),"Cannot handle redirect results in processLoaderData"),isErrorResult(_m)){let oE=_m.error;_f!==void 0&&(oE=_f,_f=void 0),ga=ga||{};{let dE=findNearestBoundary(_,rE);ga[dE.route.id]==null&&(ga[dE.route.id]=oE)}_o[rE]=void 0,_l||(_l=!0,_a=isRouteErrorResponse(_m.error)?_m.error.status:500),_m.headers&&(_d[rE]=_m.headers)}else isDeferredResult(_m)?(zt.set(rE,_m.deferredData),_o[rE]=_m.deferredData.data,_m.statusCode!=null&&_m.statusCode!==200&&!_l&&(_a=_m.statusCode),_m.headers&&(_d[rE]=_m.headers)):(_o[rE]=_m.data,_m.statusCode&&_m.statusCode!==200&&!_l&&(_a=_m.statusCode),_m.headers&&(_d[rE]=_m.headers))}),_f!==void 0&&Vt&&(ga={[Vt[0]]:_f},_o[Vt[0]]=void 0),{loaderData:_o,errors:ga,statusCode:_a||200,loaderHeaders:_d}}function processLoaderData(_,e,j,Vt,zt,_r,_o,ga){let{loaderData:_a,errors:_l}=processRouteLoaderData(e,j,Vt,zt,ga);for(let _d=0;_d<_r.length;_d++){let{key:_f,match:_m,controller:tE}=_r[_d];invariant(_o!==void 0&&_o[_d]!==void 0,"Did not find corresponding fetcher result");let rE=_o[_d];if(!(tE&&tE.signal.aborted))if(isErrorResult(rE)){let oE=findNearestBoundary(_.matches,_m==null?void 0:_m.route.id);_l&&_l[oE.route.id]||(_l=_extends$4({},_l,{[oE.route.id]:rE.error})),_.fetchers.delete(_f)}else if(isRedirectResult(rE))invariant(!1,"Unhandled fetcher revalidation redirect");else if(isDeferredResult(rE))invariant(!1,"Unhandled fetcher deferred data");else{let oE=getDoneFetcher(rE.data);_.fetchers.set(_f,oE)}}return{loaderData:_a,errors:_l}}function mergeLoaderData(_,e,j,Vt){let zt=_extends$4({},e);for(let _r of j){let _o=_r.route.id;if(e.hasOwnProperty(_o)?e[_o]!==void 0&&(zt[_o]=e[_o]):_[_o]!==void 0&&_r.route.loader&&(zt[_o]=_[_o]),Vt&&Vt.hasOwnProperty(_o))break}return zt}function getActionDataForCommit(_){return _?isErrorResult(_[1])?{actionData:{}}:{actionData:{[_[0]]:_[1].data}}:{}}function findNearestBoundary(_,e){return(e?_.slice(0,_.findIndex(Vt=>Vt.route.id===e)+1):[..._]).reverse().find(Vt=>Vt.route.hasErrorBoundary===!0)||_[0]}function getShortCircuitMatches(_){let e=_.length===1?_[0]:_.find(j=>j.index||!j.path||j.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function getInternalRouterError(_,e){let{pathname:j,routeId:Vt,method:zt,type:_r}=e===void 0?{}:e,_o="Unknown Server Error",ga="Unknown @remix-run/router error";return _===400?(_o="Bad Request",zt&&j&&Vt?ga="You made a "+zt+' request to "'+j+'" but '+('did not provide a `loader` for route "'+Vt+'", ')+"so there is no way to handle the request.":_r==="defer-action"?ga="defer() is not supported in actions":_r==="invalid-body"&&(ga="Unable to encode submission body")):_===403?(_o="Forbidden",ga='Route "'+Vt+'" does not match URL "'+j+'"'):_===404?(_o="Not Found",ga='No route matches URL "'+j+'"'):_===405&&(_o="Method Not Allowed",zt&&j&&Vt?ga="You made a "+zt.toUpperCase()+' request to "'+j+'" but '+('did not provide an `action` for route "'+Vt+'", ')+"so there is no way to handle the request.":zt&&(ga='Invalid request method "'+zt.toUpperCase()+'"')),new ErrorResponseImpl(_||500,_o,new Error(ga),!0)}function findRedirect(_){for(let e=_.length-1;e>=0;e--){let j=_[e];if(isRedirectResult(j))return{result:j,idx:e}}}function stripHashFromPath(_){let e=typeof _=="string"?parsePath(_):_;return createPath(_extends$4({},e,{hash:""}))}function isHashChangeOnly(_,e){return _.pathname!==e.pathname||_.search!==e.search?!1:_.hash===""?e.hash!=="":_.hash===e.hash?!0:e.hash!==""}function isRedirectHandlerResult(_){return isResponse$1(_.result)&&redirectStatusCodes.has(_.result.status)}function isDeferredResult(_){return _.type===ResultType.deferred}function isErrorResult(_){return _.type===ResultType.error}function isRedirectResult(_){return(_&&_.type)===ResultType.redirect}function isDeferredData(_){let e=_;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function isResponse$1(_){return _!=null&&typeof _.status=="number"&&typeof _.statusText=="string"&&typeof _.headers=="object"&&typeof _.body<"u"}function isValidMethod(_){return validRequestMethods.has(_.toLowerCase())}function isMutationMethod(_){return validMutationMethods.has(_.toLowerCase())}async function resolveDeferredResults(_,e,j,Vt,zt,_r){for(let _o=0;_o<j.length;_o++){let ga=j[_o],_a=e[_o];if(!_a)continue;let _l=_.find(_f=>_f.route.id===_a.route.id),_d=_l!=null&&!isNewRouteInstance(_l,_a)&&(_r&&_r[_a.route.id])!==void 0;if(isDeferredResult(ga)&&(zt||_d)){let _f=Vt[_o];invariant(_f,"Expected an AbortSignal for revalidating fetcher deferred result"),await resolveDeferredData(ga,_f,zt).then(_m=>{_m&&(j[_o]=_m||j[_o])})}}}async function resolveDeferredData(_,e,j){if(j===void 0&&(j=!1),!await _.deferredData.resolveData(e)){if(j)try{return{type:ResultType.data,data:_.deferredData.unwrappedData}}catch(zt){return{type:ResultType.error,error:zt}}return{type:ResultType.data,data:_.deferredData.data}}}function hasNakedIndexQuery(_){return new URLSearchParams(_).getAll("index").some(e=>e==="")}function getTargetMatch(_,e){let j=typeof e=="string"?parsePath(e).search:e.search;if(_[_.length-1].route.index&&hasNakedIndexQuery(j||""))return _[_.length-1];let Vt=getPathContributingMatches(_);return Vt[Vt.length-1]}function getSubmissionFromNavigation(_){let{formMethod:e,formAction:j,formEncType:Vt,text:zt,formData:_r,json:_o}=_;if(!(!e||!j||!Vt)){if(zt!=null)return{formMethod:e,formAction:j,formEncType:Vt,formData:void 0,json:void 0,text:zt};if(_r!=null)return{formMethod:e,formAction:j,formEncType:Vt,formData:_r,json:void 0,text:void 0};if(_o!==void 0)return{formMethod:e,formAction:j,formEncType:Vt,formData:void 0,json:_o,text:void 0}}}function getLoadingNavigation(_,e){return e?{state:"loading",location:_,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:_,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function getSubmittingNavigation(_,e){return{state:"submitting",location:_,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function getLoadingFetcher(_,e){return _?{state:"loading",formMethod:_.formMethod,formAction:_.formAction,formEncType:_.formEncType,formData:_.formData,json:_.json,text:_.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function getSubmittingFetcher(_,e){return{state:"submitting",formMethod:_.formMethod,formAction:_.formAction,formEncType:_.formEncType,formData:_.formData,json:_.json,text:_.text,data:e?e.data:void 0}}function getDoneFetcher(_){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:_}}function restoreAppliedTransitions(_,e){try{let j=_.sessionStorage.getItem(TRANSITIONS_STORAGE_KEY);if(j){let Vt=JSON.parse(j);for(let[zt,_r]of Object.entries(Vt||{}))_r&&Array.isArray(_r)&&e.set(zt,new Set(_r||[]))}}catch{}}function persistAppliedTransitions(_,e){if(e.size>0){let j={};for(let[Vt,zt]of e)j[Vt]=[...zt];try{_.sessionStorage.setItem(TRANSITIONS_STORAGE_KEY,JSON.stringify(j))}catch(Vt){warning(!1,"Failed to save applied view transitions in sessionStorage ("+Vt+").")}}}/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(_){for(var e=1;e<arguments.length;e++){var j=arguments[e];for(var Vt in j)Object.prototype.hasOwnProperty.call(j,Vt)&&(_[Vt]=j[Vt])}return _},_extends$3.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(_,e){let{relative:j}=e===void 0?{}:e;useInRouterContext()||invariant(!1);let{basename:Vt,navigator:zt}=reactExports.useContext(NavigationContext),{hash:_r,pathname:_o,search:ga}=useResolvedPath(_,{relative:j}),_a=_o;return Vt!=="/"&&(_a=_o==="/"?Vt:joinPaths([Vt,_o])),zt.createHref({pathname:_a,search:ga,hash:_r})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(_){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(_)}function useNavigate(){let{isDataRoute:_}=reactExports.useContext(RouteContext);return _?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let _=reactExports.useContext(DataRouterContext),{basename:e,future:j,navigator:Vt}=reactExports.useContext(NavigationContext),{matches:zt}=reactExports.useContext(RouteContext),{pathname:_r}=useLocation(),_o=JSON.stringify(getResolveToMatches(zt,j.v7_relativeSplatPath)),ga=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{ga.current=!0}),reactExports.useCallback(function(_l,_d){if(_d===void 0&&(_d={}),!ga.current)return;if(typeof _l=="number"){Vt.go(_l);return}let _f=resolveTo(_l,JSON.parse(_o),_r,_d.relative==="path");_==null&&e!=="/"&&(_f.pathname=_f.pathname==="/"?e:joinPaths([e,_f.pathname])),(_d.replace?Vt.replace:Vt.push)(_f,_d.state,_d)},[e,Vt,_o,_r,_])}function useParams(){let{matches:_}=reactExports.useContext(RouteContext),e=_[_.length-1];return e?e.params:{}}function useResolvedPath(_,e){let{relative:j}=e===void 0?{}:e,{future:Vt}=reactExports.useContext(NavigationContext),{matches:zt}=reactExports.useContext(RouteContext),{pathname:_r}=useLocation(),_o=JSON.stringify(getResolveToMatches(zt,Vt.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(_,JSON.parse(_o),_r,j==="path"),[_,_o,_r,j])}function useRoutesImpl(_,e,j,Vt){useInRouterContext()||invariant(!1);let{navigator:zt}=reactExports.useContext(NavigationContext),{matches:_r}=reactExports.useContext(RouteContext),_o=_r[_r.length-1],ga=_o?_o.params:{};_o&&_o.pathname;let _a=_o?_o.pathnameBase:"/";_o&&_o.route;let _l=useLocation(),_d;_d=_l;let _f=_d.pathname||"/",_m=_f;if(_a!=="/"){let oE=_a.replace(/^\//,"").split("/");_m="/"+_f.replace(/^\//,"").split("/").slice(oE.length).join("/")}let tE=matchRoutes(_,{pathname:_m});return _renderMatches(tE&&tE.map(oE=>Object.assign({},oE,{params:Object.assign({},ga,oE.params),pathname:joinPaths([_a,zt.encodeLocation?zt.encodeLocation(oE.pathname).pathname:oE.pathname]),pathnameBase:oE.pathnameBase==="/"?_a:joinPaths([_a,zt.encodeLocation?zt.encodeLocation(oE.pathnameBase).pathname:oE.pathnameBase])})),_r,j,Vt)}function DefaultErrorComponent(){let _=useRouteError(),e=isRouteErrorResponse(_)?_.status+" "+_.statusText:_ instanceof Error?_.message:JSON.stringify(_),j=_ instanceof Error?_.stack:null,zt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),j?reactExports.createElement("pre",{style:zt},j):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,j){return j.location!==e.location||j.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:j.error,location:j.location,revalidation:e.revalidation||j.revalidation}}componentDidCatch(e,j){console.error("React Router caught the following error during render",e,j)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(_){let{routeContext:e,match:j,children:Vt}=_,zt=reactExports.useContext(DataRouterContext);return zt&&zt.static&&zt.staticContext&&(j.route.errorElement||j.route.ErrorBoundary)&&(zt.staticContext._deepestRenderedBoundaryId=j.route.id),reactExports.createElement(RouteContext.Provider,{value:e},Vt)}function _renderMatches(_,e,j,Vt){var zt;if(e===void 0&&(e=[]),j===void 0&&(j=null),Vt===void 0&&(Vt=null),_==null){var _r;if((_r=j)!=null&&_r.errors)_=j.matches;else return null}let _o=_,ga=(zt=j)==null?void 0:zt.errors;if(ga!=null){let _d=_o.findIndex(_f=>_f.route.id&&(ga==null?void 0:ga[_f.route.id])!==void 0);_d>=0||invariant(!1),_o=_o.slice(0,Math.min(_o.length,_d+1))}let _a=!1,_l=-1;if(j&&Vt&&Vt.v7_partialHydration)for(let _d=0;_d<_o.length;_d++){let _f=_o[_d];if((_f.route.HydrateFallback||_f.route.hydrateFallbackElement)&&(_l=_d),_f.route.id){let{loaderData:_m,errors:tE}=j,rE=_f.route.loader&&_m[_f.route.id]===void 0&&(!tE||tE[_f.route.id]===void 0);if(_f.route.lazy||rE){_a=!0,_l>=0?_o=_o.slice(0,_l+1):_o=[_o[0]];break}}}return _o.reduceRight((_d,_f,_m)=>{let tE,rE=!1,oE=null,dE=null;j&&(tE=ga&&_f.route.id?ga[_f.route.id]:void 0,oE=_f.route.errorElement||defaultErrorElement,_a&&(_l<0&&_m===0?(rE=!0,dE=null):_l===_m&&(rE=!0,dE=_f.route.hydrateFallbackElement||null)));let nE=e.concat(_o.slice(0,_m+1)),sE=()=>{let lE;return tE?lE=oE:rE?lE=dE:_f.route.Component?lE=reactExports.createElement(_f.route.Component,null):_f.route.element?lE=_f.route.element:lE=_d,reactExports.createElement(RenderedRoute,{match:_f,routeContext:{outlet:_d,matches:nE,isDataRoute:j!=null},children:lE})};return j&&(_f.route.ErrorBoundary||_f.route.errorElement||_m===0)?reactExports.createElement(RenderErrorBoundary,{location:j.location,revalidation:j.revalidation,component:oE,error:tE,children:sE(),routeContext:{outlet:null,matches:nE,isDataRoute:!0}}):sE()},null)}var DataRouterHook$1=function(_){return _.UseBlocker="useBlocker",_.UseRevalidator="useRevalidator",_.UseNavigateStable="useNavigate",_}(DataRouterHook$1||{}),DataRouterStateHook$1=function(_){return _.UseBlocker="useBlocker",_.UseLoaderData="useLoaderData",_.UseActionData="useActionData",_.UseRouteError="useRouteError",_.UseNavigation="useNavigation",_.UseRouteLoaderData="useRouteLoaderData",_.UseMatches="useMatches",_.UseRevalidator="useRevalidator",_.UseNavigateStable="useNavigate",_.UseRouteId="useRouteId",_}(DataRouterStateHook$1||{});function useDataRouterContext(_){let e=reactExports.useContext(DataRouterContext);return e||invariant(!1),e}function useDataRouterState(_){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(_){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(_){let e=useRouteContext(),j=e.matches[e.matches.length-1];return j.route.id||invariant(!1),j.route.id}function useRouteError(){var _;let e=reactExports.useContext(RouteErrorContext),j=useDataRouterState(DataRouterStateHook$1.UseRouteError),Vt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e!==void 0?e:(_=j.errors)==null?void 0:_[Vt]}function useNavigateStable(){let{router:_}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),e=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),j=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{j.current=!0}),reactExports.useCallback(function(zt,_r){_r===void 0&&(_r={}),j.current&&(typeof zt=="number"?_.navigate(zt):_.navigate(zt,_extends$3({fromRouteId:e},_r)))},[_,e])}function Router(_){let{basename:e="/",children:j=null,location:Vt,navigationType:zt=Action.Pop,navigator:_r,static:_o=!1,future:ga}=_;useInRouterContext()&&invariant(!1);let _a=e.replace(/^\/*/,"/"),_l=reactExports.useMemo(()=>({basename:_a,navigator:_r,static:_o,future:_extends$3({v7_relativeSplatPath:!1},ga)}),[_a,ga,_r,_o]);typeof Vt=="string"&&(Vt=parsePath(Vt));let{pathname:_d="/",search:_f="",hash:_m="",state:tE=null,key:rE="default"}=Vt,oE=reactExports.useMemo(()=>{let dE=stripBasename(_d,_a);return dE==null?null:{location:{pathname:dE,search:_f,hash:_m,state:tE,key:rE},navigationType:zt}},[_a,_d,_f,_m,tE,rE,zt]);return oE==null?null:reactExports.createElement(NavigationContext.Provider,{value:_l},reactExports.createElement(LocationContext.Provider,{children:j,value:oE}))}new Promise(()=>{});function mapRouteProperties(_){let e={hasErrorBoundary:_.ErrorBoundary!=null||_.errorElement!=null};return _.Component&&Object.assign(e,{element:reactExports.createElement(_.Component),Component:void 0}),_.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:reactExports.createElement(_.HydrateFallback),HydrateFallback:void 0}),_.ErrorBoundary&&Object.assign(e,{errorElement:reactExports.createElement(_.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(_){for(var e=1;e<arguments.length;e++){var j=arguments[e];for(var Vt in j)Object.prototype.hasOwnProperty.call(j,Vt)&&(_[Vt]=j[Vt])}return _},_extends$2.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(_,e){if(_==null)return{};var j={},Vt=Object.keys(_),zt,_r;for(_r=0;_r<Vt.length;_r++)zt=Vt[_r],!(e.indexOf(zt)>=0)&&(j[zt]=_[zt]);return j}function isModifiedEvent(_){return!!(_.metaKey||_.altKey||_.ctrlKey||_.shiftKey)}function shouldProcessLinkClick(_,e){return _.button===0&&(!e||e==="_self")&&!isModifiedEvent(_)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}function createBrowserRouter(_,e){return createRouter({basename:void 0,future:_extends$2({},void 0,{v7_prependBasename:!0}),history:createBrowserHistory({window:void 0}),hydrationData:parseHydrationData(),routes:_,mapRouteProperties,unstable_dataStrategy:void 0,window:void 0}).initialize()}function parseHydrationData(){var _;let e=(_=window)==null?void 0:_.__staticRouterHydrationData;return e&&e.errors&&(e=_extends$2({},e,{errors:deserializeErrors(e.errors)})),e}function deserializeErrors(_){if(!_)return null;let e=Object.entries(_),j={};for(let[Vt,zt]of e)if(zt&&zt.__type==="RouteErrorResponse")j[Vt]=new ErrorResponseImpl(zt.status,zt.statusText,zt.data,zt.internal===!0);else if(zt&&zt.__type==="Error"){if(zt.__subType){let _r=window[zt.__subType];if(typeof _r=="function")try{let _o=new _r(zt.message);_o.stack="",j[Vt]=_o}catch{}}if(j[Vt]==null){let _r=new Error(zt.message);_r.stack="",j[Vt]=_r}}else j[Vt]=zt;return j}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),FetchersContext=reactExports.createContext(new Map),START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION],FLUSH_SYNC="flushSync",flushSyncImpl=ReactDOM[FLUSH_SYNC];function startTransitionSafe(_){startTransitionImpl?startTransitionImpl(_):_()}function flushSyncSafe(_){flushSyncImpl?flushSyncImpl(_):_()}class Deferred{constructor(){this.status="pending",this.promise=new Promise((e,j)=>{this.resolve=Vt=>{this.status==="pending"&&(this.status="resolved",e(Vt))},this.reject=Vt=>{this.status==="pending"&&(this.status="rejected",j(Vt))}})}}function RouterProvider(_){let{fallbackElement:e,router:j,future:Vt}=_,[zt,_r]=reactExports.useState(j.state),[_o,ga]=reactExports.useState(),[_a,_l]=reactExports.useState({isTransitioning:!1}),[_d,_f]=reactExports.useState(),[_m,tE]=reactExports.useState(),[rE,oE]=reactExports.useState(),dE=reactExports.useRef(new Map),{v7_startTransition:nE}=Vt||{},sE=reactExports.useCallback(_E=>{nE?startTransitionSafe(_E):_E()},[nE]),lE=reactExports.useCallback((_E,kE)=>{let{deletedFetchers:ME,unstable_flushSync:bE,unstable_viewTransitionOpts:LE}=kE;ME.forEach(OE=>dE.current.delete(OE)),_E.fetchers.forEach((OE,vE)=>{OE.data!==void 0&&dE.current.set(vE,OE.data)});let TE=j.window==null||j.window.document==null||typeof j.window.document.startViewTransition!="function";if(!LE||TE){bE?flushSyncSafe(()=>_r(_E)):sE(()=>_r(_E));return}if(bE){flushSyncSafe(()=>{_m&&(_d&&_d.resolve(),_m.skipTransition()),_l({isTransitioning:!0,flushSync:!0,currentLocation:LE.currentLocation,nextLocation:LE.nextLocation})});let OE=j.window.document.startViewTransition(()=>{flushSyncSafe(()=>_r(_E))});OE.finished.finally(()=>{flushSyncSafe(()=>{_f(void 0),tE(void 0),ga(void 0),_l({isTransitioning:!1})})}),flushSyncSafe(()=>tE(OE));return}_m?(_d&&_d.resolve(),_m.skipTransition(),oE({state:_E,currentLocation:LE.currentLocation,nextLocation:LE.nextLocation})):(ga(_E),_l({isTransitioning:!0,flushSync:!1,currentLocation:LE.currentLocation,nextLocation:LE.nextLocation}))},[j.window,_m,_d,dE,sE]);reactExports.useLayoutEffect(()=>j.subscribe(lE),[j,lE]),reactExports.useEffect(()=>{_a.isTransitioning&&!_a.flushSync&&_f(new Deferred)},[_a]),reactExports.useEffect(()=>{if(_d&&_o&&j.window){let _E=_o,kE=_d.promise,ME=j.window.document.startViewTransition(async()=>{sE(()=>_r(_E)),await kE});ME.finished.finally(()=>{_f(void 0),tE(void 0),ga(void 0),_l({isTransitioning:!1})}),tE(ME)}},[sE,_o,_d,j.window]),reactExports.useEffect(()=>{_d&&_o&&zt.location.key===_o.location.key&&_d.resolve()},[_d,_m,zt.location,_o]),reactExports.useEffect(()=>{!_a.isTransitioning&&rE&&(ga(rE.state),_l({isTransitioning:!0,flushSync:!1,currentLocation:rE.currentLocation,nextLocation:rE.nextLocation}),oE(void 0))},[_a.isTransitioning,rE]),reactExports.useEffect(()=>{},[]);let EE=reactExports.useMemo(()=>({createHref:j.createHref,encodeLocation:j.encodeLocation,go:_E=>j.navigate(_E),push:(_E,kE,ME)=>j.navigate(_E,{state:kE,preventScrollReset:ME==null?void 0:ME.preventScrollReset}),replace:(_E,kE,ME)=>j.navigate(_E,{replace:!0,state:kE,preventScrollReset:ME==null?void 0:ME.preventScrollReset})}),[j]),wE=j.basename||"/",IE=reactExports.useMemo(()=>({router:j,navigator:EE,static:!1,basename:wE}),[j,EE,wE]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(DataRouterContext.Provider,{value:IE},reactExports.createElement(DataRouterStateContext.Provider,{value:zt},reactExports.createElement(FetchersContext.Provider,{value:dE.current},reactExports.createElement(ViewTransitionContext.Provider,{value:_a},reactExports.createElement(Router,{basename:wE,location:zt.location,navigationType:zt.historyAction,navigator:EE,future:{v7_relativeSplatPath:j.future.v7_relativeSplatPath}},zt.initialized||j.future.v7_partialHydration?reactExports.createElement(DataRoutes,{routes:j.routes,future:j.future,state:zt}):e))))),null)}function DataRoutes(_){let{routes:e,future:j,state:Vt}=_;return useRoutesImpl(e,void 0,Vt,j)}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(e,j){let{onClick:Vt,relative:zt,reloadDocument:_r,replace:_o,state:ga,target:_a,to:_l,preventScrollReset:_d,unstable_viewTransition:_f}=e,_m=_objectWithoutPropertiesLoose$1(e,_excluded),{basename:tE}=reactExports.useContext(NavigationContext),rE,oE=!1;if(typeof _l=="string"&&ABSOLUTE_URL_REGEX.test(_l)&&(rE=_l,isBrowser))try{let lE=new URL(window.location.href),EE=_l.startsWith("//")?new URL(lE.protocol+_l):new URL(_l),wE=stripBasename(EE.pathname,tE);EE.origin===lE.origin&&wE!=null?_l=wE+EE.search+EE.hash:oE=!0}catch{}let dE=useHref(_l,{relative:zt}),nE=useLinkClickHandler(_l,{replace:_o,state:ga,target:_a,preventScrollReset:_d,relative:zt,unstable_viewTransition:_f});function sE(lE){Vt&&Vt(lE),lE.defaultPrevented||nE(lE)}return reactExports.createElement("a",_extends$2({},_m,{href:rE||dE,onClick:oE||_r?Vt:sE,ref:j,target:_a}))});var DataRouterHook;(function(_){_.UseScrollRestoration="useScrollRestoration",_.UseSubmit="useSubmit",_.UseSubmitFetcher="useSubmitFetcher",_.UseFetcher="useFetcher",_.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(_){_.UseFetcher="useFetcher",_.UseFetchers="useFetchers",_.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(_,e){let{target:j,replace:Vt,state:zt,preventScrollReset:_r,relative:_o,unstable_viewTransition:ga}=e===void 0?{}:e,_a=useNavigate(),_l=useLocation(),_d=useResolvedPath(_,{relative:_o});return reactExports.useCallback(_f=>{if(shouldProcessLinkClick(_f,j)){_f.preventDefault();let _m=Vt!==void 0?Vt:createPath(_l)===createPath(_d);_a(_,{replace:_m,state:zt,preventScrollReset:_r,relative:_o,unstable_viewTransition:ga})}},[_l,_a,_d,Vt,zt,j,_,_r,_o,ga])}const AuthContext=reactExports.createContext(null),AuthProvider=({children:_})=>{const[e,j]=reactExports.useState(null),Vt=()=>{const _o=localStorage.getItem("@userData");_o&&j(JSON.parse(_o))},zt=_o=>{localStorage.setItem("@userData",JSON.stringify(_o)),j(_o)},_r=()=>{localStorage.removeItem("@userData"),j(null)};return reactExports.useEffect(()=>{Vt()},[]),jsxRuntimeExports.jsx(AuthContext.Provider,{value:{signIn:zt,signOut:_r,user:e,setUser:j},children:_})},useAuth=()=>{const _=reactExports.useContext(AuthContext);if(_===void 0)throw new Error("useAuth tem de ser chamado dentro de AuthProvider");return _},ProtectedRoutes=({children:_})=>{const{user:e}=useAuth(),j=useNavigate();return reactExports.useEffect(()=>{e===null&&j("/signin",{replace:!0})},[j,e]),_},logo="/mocho_web/assets/logo-Vef1Laf9.png",userplaceholderimage="/mocho_web/assets/userplaceholderimage-CU68SPzm.png",t$k=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M112,56V200L40,128Z",opacity:"0.2"}),React.createElement("path",{d:"M216,120H120V56a8,8,0,0,0-13.66-5.66l-72,72a8,8,0,0,0,0,11.32l72,72A8,8,0,0,0,120,200V136h96a8,8,0,0,0,0-16ZM104,180.69,51.31,128,104,75.31Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H120v64a8,8,0,0,1-13.66,5.66l-72-72a8,8,0,0,1,0-11.32l72-72A8,8,0,0,1,120,56v64h96A8,8,0,0,1,224,128Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M222,128a6,6,0,0,1-6,6H54.49l61.75,61.76a6,6,0,1,1-8.48,8.48l-72-72a6,6,0,0,1,0-8.48l72-72a6,6,0,0,1,8.48,8.48L54.49,122H216A6,6,0,0,1,222,128Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M220,128a4,4,0,0,1-4,4H49.66l65.17,65.17a4,4,0,0,1-5.66,5.66l-72-72a4,4,0,0,1,0-5.66l72-72a4,4,0,0,1,5.66,5.66L49.66,124H216A4,4,0,0,1,220,128Z"}))]]),t$j=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M225.29,165.93C216.61,151,212,129.57,212,104a84,84,0,0,0-168,0c0,25.58-4.59,47-13.27,61.93A20.08,20.08,0,0,0,30.66,186,19.77,19.77,0,0,0,48,196H84.18a44,44,0,0,0,87.64,0H208a19.77,19.77,0,0,0,17.31-10A20.08,20.08,0,0,0,225.29,165.93ZM128,212a20,20,0,0,1-19.6-16h39.2A20,20,0,0,1,128,212ZM54.66,172C63.51,154,68,131.14,68,104a60,60,0,0,1,120,0c0,27.13,4.48,50,13.33,68Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,192H48a8,8,0,0,1-6.88-12C47.71,168.6,56,139.81,56,104a72,72,0,0,1,144,0c0,35.82,8.3,64.6,14.9,76A8,8,0,0,1,208,192Z",opacity:"0.2"}),React.createElement("path",{d:"M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M220.07,176.94C214.41,167.2,206,139.73,206,104a78,78,0,1,0-156,0c0,35.74-8.42,63.2-14.08,72.94A14,14,0,0,0,48,198H90.48a38,38,0,0,0,75,0H208a14,14,0,0,0,12.06-21.06ZM128,218a26,26,0,0,1-25.29-20h50.58A26,26,0,0,1,128,218Zm81.71-33a1.9,1.9,0,0,1-1.7,1H48a1.9,1.9,0,0,1-1.7-1,2,2,0,0,1,0-2C53.87,170,62,139.69,62,104a66,66,0,1,1,132,0c0,35.68,8.14,65.95,15.71,79A2,2,0,0,1,209.71,185Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M218.35,178C212.58,168,204,140.13,204,104a76,76,0,1,0-152,0c0,36.13-8.59,64-14.36,73.95A12,12,0,0,0,48,196H92.23a36,36,0,0,0,71.54,0H208A12,12,0,0,0,218.35,178ZM128,220a28,28,0,0,1-27.71-24h55.42A28,28,0,0,1,128,220Zm83.45-34a3.91,3.91,0,0,1-3.44,2H48a3.91,3.91,0,0,1-3.44-2,4,4,0,0,1,0-4C52,169.17,60,139.32,60,104a68,68,0,1,1,136,0c0,35.31,8,65.17,15.44,78A4,4,0,0,1,211.45,186Z"}))]]),t$i=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M120,128a16,16,0,1,1-16-16A16,16,0,0,1,120,128Zm32-16a16,16,0,1,0,16,16A16,16,0,0,0,152,112Zm84,16A108,108,0,0,1,78.77,224.15L46.34,235A20,20,0,0,1,21,209.66l10.81-32.43A108,108,0,1,1,236,128Zm-24,0A84,84,0,1,0,55.27,170.06a12,12,0,0,1,1,9.81l-9.93,29.79,29.79-9.93a12.1,12.1,0,0,1,3.8-.62,12,12,0,0,1,6,1.62A84,84,0,0,0,212,128Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,128A96,96,0,0,1,79.93,211.11h0L42.54,223.58a8,8,0,0,1-10.12-10.12l12.47-37.39h0A96,96,0,1,1,224,128Z",opacity:"0.2"}),React.createElement("path",{d:"M128,24A104,104,0,0,0,36.18,176.88L24.83,210.93a16,16,0,0,0,20.24,20.24l34.05-11.35A104,104,0,1,0,128,24Zm0,192a87.87,87.87,0,0,1-44.06-11.81,8,8,0,0,0-4-1.08,7.85,7.85,0,0,0-2.53.42L40,216,52.47,178.6a8,8,0,0,0-.66-6.54A88,88,0,1,1,128,216Zm12-88a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm-44,0a12,12,0,1,1-12-12A12,12,0,0,1,96,128Zm88,0a12,12,0,1,1-12-12A12,12,0,0,1,184,128Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,24A104,104,0,0,0,36.18,176.88L24.83,210.93a16,16,0,0,0,20.24,20.24l34.05-11.35A104,104,0,1,0,128,24ZM84,140a12,12,0,1,1,12-12A12,12,0,0,1,84,140Zm44,0a12,12,0,1,1,12-12A12,12,0,0,1,128,140Zm44,0a12,12,0,1,1,12-12A12,12,0,0,1,172,140Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M138,128a10,10,0,1,1-10-10A10,10,0,0,1,138,128ZM84,118a10,10,0,1,0,10,10A10,10,0,0,0,84,118Zm88,0a10,10,0,1,0,10,10A10,10,0,0,0,172,118Zm58,10A102,102,0,0,1,79.31,217.65L44.44,229.27a14,14,0,0,1-17.71-17.71l11.62-34.87A102,102,0,1,1,230,128Zm-12,0A90,90,0,1,0,50.08,173.06a6,6,0,0,1,.5,4.91L38.12,215.35a2,2,0,0,0,2.53,2.53L78,205.42a6.2,6.2,0,0,1,1.9-.31,6.09,6.09,0,0,1,3,.81A90,90,0,0,0,218,128Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128ZM84,116a12,12,0,1,0,12,12A12,12,0,0,0,84,116Zm88,0a12,12,0,1,0,12,12A12,12,0,0,0,172,116Zm60,12A104,104,0,0,1,79.12,219.82L45.07,231.17a16,16,0,0,1-20.24-20.24l11.35-34.05A104,104,0,1,1,232,128Zm-16,0A88,88,0,1,0,51.81,172.06a8,8,0,0,1,.66,6.54L40,216,77.4,203.53a7.85,7.85,0,0,1,2.53-.42,8,8,0,0,1,4,1.08A88,88,0,0,0,216,128Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M136,128a8,8,0,1,1-8-8A8,8,0,0,1,136,128Zm-52-8a8,8,0,1,0,8,8A8,8,0,0,0,84,120Zm88,0a8,8,0,1,0,8,8A8,8,0,0,0,172,120Zm56,8A100,100,0,0,1,79.5,215.47l-35.69,11.9a12,12,0,0,1-15.18-15.18l11.9-35.69A100,100,0,1,1,228,128Zm-8,0A92,92,0,1,0,48.35,174.07a4,4,0,0,1,.33,3.27L36.22,214.72a4,4,0,0,0,5.06,5.06l37.38-12.46a3.93,3.93,0,0,1,1.27-.21,4.05,4.05,0,0,1,2,.54A92,92,0,0,0,220,128Z"}))]]),t$h=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51ZM236,128A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z",opacity:"0.2"}),React.createElement("path",{d:"M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm45.66,85.66-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35a8,8,0,0,1,11.32,11.32Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M172.24,99.76a6,6,0,0,1,0,8.48l-56,56a6,6,0,0,1-8.48,0l-24-24a6,6,0,0,1,8.48-8.48L112,151.51l51.76-51.75A6,6,0,0,1,172.24,99.76ZM230,128A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M170.83,101.17a4,4,0,0,1,0,5.66l-56,56a4,4,0,0,1-5.66,0l-24-24a4,4,0,0,1,5.66-5.66L112,154.34l53.17-53.17A4,4,0,0,1,170.83,101.17ZM228,128A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"}))]]),l$9=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M222.14,105.85l-80-80a20,20,0,0,0-28.28,0l-80,80A19.86,19.86,0,0,0,28,120v96a12,12,0,0,0,12,12h64a12,12,0,0,0,12-12V164h24v52a12,12,0,0,0,12,12h64a12,12,0,0,0,12-12V120A19.86,19.86,0,0,0,222.14,105.85ZM204,204H164V152a12,12,0,0,0-12-12H104a12,12,0,0,0-12,12v52H52V121.65l76-76,76,76Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,120v96H152V152H104v64H40V120a8,8,0,0,1,2.34-5.66l80-80a8,8,0,0,1,11.32,0l80,80A8,8,0,0,1,216,120Z",opacity:"0.2"}),React.createElement("path",{d:"M219.31,108.68l-80-80a16,16,0,0,0-22.62,0l-80,80A15.87,15.87,0,0,0,32,120v96a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V160h32v56a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V120A15.87,15.87,0,0,0,219.31,108.68ZM208,208H160V152a8,8,0,0,0-8-8H104a8,8,0,0,0-8,8v56H48V120l80-80,80,80Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,120v96a8,8,0,0,1-8,8H160a8,8,0,0,1-8-8V164a4,4,0,0,0-4-4H108a4,4,0,0,0-4,4v52a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V120a16,16,0,0,1,4.69-11.31l80-80a16,16,0,0,1,22.62,0l80,80A16,16,0,0,1,224,120Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M217.9,110.1l-80-80a14,14,0,0,0-19.8,0l-80,80A13.92,13.92,0,0,0,34,120v96a6,6,0,0,0,6,6h64a6,6,0,0,0,6-6V158h36v58a6,6,0,0,0,6,6h64a6,6,0,0,0,6-6V120A13.92,13.92,0,0,0,217.9,110.1ZM210,210H158V152a6,6,0,0,0-6-6H104a6,6,0,0,0-6,6v58H46V120a2,2,0,0,1,.58-1.42l80-80a2,2,0,0,1,2.84,0l80,80A2,2,0,0,1,210,120Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M219.31,108.68l-80-80a16,16,0,0,0-22.62,0l-80,80A15.87,15.87,0,0,0,32,120v96a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V160h32v56a8,8,0,0,0,8,8h64a8,8,0,0,0,8-8V120A15.87,15.87,0,0,0,219.31,108.68ZM208,208H160V152a8,8,0,0,0-8-8H104a8,8,0,0,0-8,8v56H48V120l80-80,80,80Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216.49,111.51l-80-80a12,12,0,0,0-17,0l-80,80A12,12,0,0,0,36,120v96a4,4,0,0,0,4,4h64a4,4,0,0,0,4-4V156h40v60a4,4,0,0,0,4,4h64a4,4,0,0,0,4-4V120A12,12,0,0,0,216.49,111.51ZM212,212H156V152a4,4,0,0,0-4-4H104a4,4,0,0,0-4,4v60H44V120a4,4,0,0,1,1.17-2.83l80-80a4,4,0,0,1,5.66,0l80,80A4,4,0,0,1,212,120Z"}))]]),l$8=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M144,96a16,16,0,1,1,16,16A16,16,0,0,1,144,96Zm92-40V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56ZM44,60v79.72l33.86-33.86a20,20,0,0,1,28.28,0L147.31,147l17.18-17.17a20,20,0,0,1,28.28,0L212,149.09V60Zm0,136H162.34L92,125.66l-48,48Zm168,0V183l-33.37-33.37L164.28,164l32,32Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,56V178.06l-39.72-39.72a8,8,0,0,0-11.31,0L147.31,164,97.66,114.34a8,8,0,0,0-11.32,0L32,168.69V56a8,8,0,0,1,8-8H216A8,8,0,0,1,224,56Z",opacity:"0.2"}),React.createElement("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,16V158.75l-26.07-26.06a16,16,0,0,0-22.63,0l-20,20-44-44a16,16,0,0,0-22.62,0L40,149.37V56ZM40,172l52-52,80,80H40Zm176,28H194.63l-36-36,20-20L216,181.38V200ZM144,100a12,12,0,1,1,12,12A12,12,0,0,1,144,100Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM156,88a12,12,0,1,1-12,12A12,12,0,0,1,156,88Zm60,112H40V160.69l46.34-46.35a8,8,0,0,1,11.32,0h0L165,181.66a8,8,0,0,0,11.32-11.32l-17.66-17.65L173,138.34a8,8,0,0,1,11.31,0L216,170.07V200Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,42H40A14,14,0,0,0,26,56V200a14,14,0,0,0,14,14H216a14,14,0,0,0,14-14V56A14,14,0,0,0,216,42ZM40,54H216a2,2,0,0,1,2,2V163.57L188.53,134.1a14,14,0,0,0-19.8,0l-21.42,21.42L101.9,110.1a14,14,0,0,0-19.8,0L38,154.2V56A2,2,0,0,1,40,54ZM38,200V171.17l52.58-52.58a2,2,0,0,1,2.84,0L176.83,202H40A2,2,0,0,1,38,200Zm178,2H193.8l-38-38,21.41-21.42a2,2,0,0,1,2.83,0l38,38V200A2,2,0,0,1,216,202ZM146,100a10,10,0,1,1,10,10A10,10,0,0,1,146,100Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,16V158.75l-26.07-26.06a16,16,0,0,0-22.63,0l-20,20-44-44a16,16,0,0,0-22.62,0L40,149.37V56ZM40,172l52-52,80,80H40Zm176,28H194.63l-36-36,20-20L216,181.38V200ZM144,100a12,12,0,1,1,12,12A12,12,0,0,1,144,100Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,44H40A12,12,0,0,0,28,56V200a12,12,0,0,0,12,12H216a12,12,0,0,0,12-12V56A12,12,0,0,0,216,44ZM40,52H216a4,4,0,0,1,4,4V168.4l-32.89-32.89a12,12,0,0,0-17,0l-22.83,22.83-46.82-46.83a12,12,0,0,0-17,0L36,159V56A4,4,0,0,1,40,52ZM36,200V170.34l53.17-53.17a4,4,0,0,1,5.66,0L181.66,204H40A4,4,0,0,1,36,200Zm180,4H193l-40-40,22.83-22.83a4,4,0,0,1,5.66,0L220,179.71V200A4,4,0,0,1,216,204ZM148,100a8,8,0,1,1,8,8A8,8,0,0,1,148,100Z"}))]]),t$g=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M232.49,215.51,185,168a92.12,92.12,0,1,0-17,17l47.53,47.54a12,12,0,0,0,17-17ZM44,112a68,68,0,1,1,68,68A68.07,68.07,0,0,1,44,112Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z",opacity:"0.2"}),React.createElement("path",{d:"M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M168,112a56,56,0,1,1-56-56A56,56,0,0,1,168,112Zm61.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88,88,0,1,1,11.32-11.31l50.06,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M228.24,219.76l-51.38-51.38a86.15,86.15,0,1,0-8.48,8.48l51.38,51.38a6,6,0,0,0,8.48-8.48ZM38,112a74,74,0,1,1,74,74A74.09,74.09,0,0,1,38,112Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M226.83,221.17l-52.7-52.7a84.1,84.1,0,1,0-5.66,5.66l52.7,52.7a4,4,0,0,0,5.66-5.66ZM36,112a76,76,0,1,1,76,76A76.08,76.08,0,0,1,36,112Z"}))]]),t$f=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,180a52.06,52.06,0,0,0,52-52V64A52,52,0,0,0,76,64v64A52.06,52.06,0,0,0,128,180ZM100,64a28,28,0,0,1,56,0v64a28,28,0,0,1-56,0Zm40,155.22V240a12,12,0,0,1-24,0V219.22A92.14,92.14,0,0,1,36,128a12,12,0,0,1,24,0,68,68,0,0,0,136,0,12,12,0,0,1,24,0A92.14,92.14,0,0,1,140,219.22Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M168,64v64a40,40,0,0,1-40,40h0a40,40,0,0,1-40-40V64a40,40,0,0,1,40-40h0A40,40,0,0,1,168,64Z",opacity:"0.2"}),React.createElement("path",{d:"M128,176a48.05,48.05,0,0,0,48-48V64a48,48,0,0,0-96,0v64A48.05,48.05,0,0,0,128,176ZM96,64a32,32,0,0,1,64,0v64a32,32,0,0,1-64,0Zm40,143.6V240a8,8,0,0,1-16,0V207.6A80.11,80.11,0,0,1,48,128a8,8,0,0,1,16,0,64,64,0,0,0,128,0,8,8,0,0,1,16,0A80.11,80.11,0,0,1,136,207.6Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M80,128V64a48,48,0,0,1,96,0v64a48,48,0,0,1-96,0Zm128,0a8,8,0,0,0-16,0,64,64,0,0,1-128,0,8,8,0,0,0-16,0,80.11,80.11,0,0,0,72,79.6V240a8,8,0,0,0,16,0V207.6A80.11,80.11,0,0,0,208,128Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,174a46.06,46.06,0,0,0,46-46V64a46,46,0,0,0-92,0v64A46.06,46.06,0,0,0,128,174ZM94,64a34,34,0,0,1,68,0v64a34,34,0,0,1-68,0Zm40,141.75V240a6,6,0,0,1-12,0V205.75A78.09,78.09,0,0,1,50,128a6,6,0,0,1,12,0,66,66,0,0,0,132,0,6,6,0,0,1,12,0A78.09,78.09,0,0,1,134,205.75Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,176a48.05,48.05,0,0,0,48-48V64a48,48,0,0,0-96,0v64A48.05,48.05,0,0,0,128,176ZM96,64a32,32,0,0,1,64,0v64a32,32,0,0,1-64,0Zm40,143.6V240a8,8,0,0,1-16,0V207.6A80.11,80.11,0,0,1,48,128a8,8,0,0,1,16,0,64,64,0,0,0,128,0,8,8,0,0,1,16,0A80.11,80.11,0,0,1,136,207.6Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,172a44.05,44.05,0,0,0,44-44V64a44,44,0,0,0-88,0v64A44.05,44.05,0,0,0,128,172ZM92,64a36,36,0,0,1,72,0v64a36,36,0,0,1-72,0Zm40,139.89V240a4,4,0,0,1-8,0V203.89A76.09,76.09,0,0,1,52,128a4,4,0,0,1,8,0,68,68,0,0,0,136,0,4,4,0,0,1,8,0A76.09,76.09,0,0,1,132,203.89Z"}))]]),l$7=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M233.86,110.48,65.8,14.58A20,20,0,0,0,37.15,38.64L67.33,128,37.15,217.36A20,20,0,0,0,56,244a20.1,20.1,0,0,0,9.81-2.58l.09-.06,168-96.07a20,20,0,0,0,0-34.81ZM63.19,215.26,88.61,140H144a12,12,0,0,0,0-24H88.61L63.18,40.72l152.76,87.17Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M227.91,134.86,59.93,231a8,8,0,0,1-11.44-9.67L80,128,48.49,34.72a8,8,0,0,1,11.44-9.67l168,95.85A8,8,0,0,1,227.91,134.86Z",opacity:"0.2"}),React.createElement("path",{d:"M231.87,114l-168-95.89A16,16,0,0,0,40.92,37.34L71.55,128,40.92,218.67A16,16,0,0,0,56,240a16.15,16.15,0,0,0,7.93-2.1l167.92-96.05a16,16,0,0,0,.05-27.89ZM56,224a.56.56,0,0,0,0-.12L85.74,136H144a8,8,0,0,0,0-16H85.74L56.06,32.16A.46.46,0,0,0,56,32l168,95.83Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M240,127.89a16,16,0,0,1-8.18,14L63.9,237.9A16.15,16.15,0,0,1,56,240a16,16,0,0,1-15-21.33l27-79.95A4,4,0,0,1,71.72,136H144a8,8,0,0,0,8-8.53,8.19,8.19,0,0,0-8.26-7.47h-72a4,4,0,0,1-3.79-2.72l-27-79.94A16,16,0,0,1,63.84,18.07l168,95.89A16,16,0,0,1,240,127.89Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M230.88,115.69l-168-95.88a14,14,0,0,0-20,16.87L73.66,128,42.81,219.33A14,14,0,0,0,56,238a14.15,14.15,0,0,0,6.93-1.83L230.84,140.1a14,14,0,0,0,0-24.41Zm-5.95,14L57,225.73a2,2,0,0,1-2.86-2.42.42.42,0,0,0,0-.1L84.3,134H144a6,6,0,0,0,0-12H84.3L54.17,32.8a.3.3,0,0,0,0-.1,1.87,1.87,0,0,1,.6-2.2A1.85,1.85,0,0,1,57,30.25l168,95.89a1.93,1.93,0,0,1,1,1.74A2,2,0,0,1,224.93,129.66Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M231.87,114l-168-95.89A16,16,0,0,0,40.92,37.34L71.55,128,40.92,218.67A16,16,0,0,0,56,240a16.15,16.15,0,0,0,7.93-2.1l167.92-96.05a16,16,0,0,0,.05-27.89ZM56,224a.56.56,0,0,0,0-.12L85.74,136H144a8,8,0,0,0,0-16H85.74L56.06,32.16A.46.46,0,0,0,56,32l168,95.83Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M229.89,117.43l-168-95.88A12,12,0,0,0,44.7,36l31.08,92L44.71,220A12,12,0,0,0,56,236a12.13,12.13,0,0,0,5.93-1.57l167.94-96.08a12,12,0,0,0,0-20.92Zm-4,14L58,227.47a4,4,0,0,1-5.72-4.83l0-.07L82.87,132H144a4,4,0,0,0,0-8H82.87L52.26,33.37A3.89,3.89,0,0,1,53.44,29,4.13,4.13,0,0,1,56,28a3.88,3.88,0,0,1,1.93.54l168,95.87a4,4,0,0,1,0,7Z"}))]]),l$6=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M212.48,136.49l-82.06,82a60,60,0,0,1-84.85-84.88l98.16-97.89a40,40,0,0,1,56.56,56.59l-.17.16-95.8,92.22a12,12,0,1,1-16.64-17.3l95.71-92.12a16,16,0,0,0-22.7-22.56L62.53,150.57a36,36,0,0,0,50.93,50.91l82.06-82a12,12,0,0,1,17,17Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M180.75,104.75,204,128l-82.06,81.94a48,48,0,0,1-67.88-67.88L153.37,41.37a32,32,0,0,1,45.26,45.26Z",opacity:"0.2"}),React.createElement("path",{d:"M209.66,122.34a8,8,0,0,1,0,11.32l-82.05,82a56,56,0,0,1-79.2-79.21L147.67,35.73a40,40,0,1,1,56.61,56.55L105,193A24,24,0,1,1,71,159L154.3,74.38A8,8,0,1,1,165.7,85.6L82.39,170.31a8,8,0,1,0,11.27,11.36L192.93,81A24,24,0,1,0,159,47L59.76,147.68a40,40,0,1,0,56.53,56.62l82.06-82A8,8,0,0,1,209.66,122.34Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm37.66,50.34a8,8,0,0,0-11.32,0L87.09,143A24,24,0,1,0,121,177l49.32-50.32a8,8,0,1,1,11.42,11.2l-49.37,50.38a40,40,0,1,1-56.62-56.51L143,63.09A24,24,0,1,1,177,97L109.71,165.6a8,8,0,1,1-11.42-11.2L165.6,85.71a8,8,0,0,0,.06-11.37Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208.25,123.76a6,6,0,0,1,0,8.49l-82.06,82a54,54,0,0,1-76.36-76.39L149.1,37.14a38,38,0,1,1,53.77,53.72L103.59,191.54a22,22,0,1,1-31.15-31.09l83.28-84.67a6,6,0,0,1,8.56,8.42L81,168.91a10,10,0,1,0,14.11,14.18L194.35,82.4a26,26,0,1,0-36.74-36.8L58.33,146.28a42,42,0,1,0,59.37,59.44l82.06-82A6,6,0,0,1,208.25,123.76Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M209.66,122.34a8,8,0,0,1,0,11.32l-82.05,82a56,56,0,0,1-79.2-79.21L147.67,35.73a40,40,0,1,1,56.61,56.55L105,193A24,24,0,1,1,71,159L154.3,74.38A8,8,0,1,1,165.7,85.6L82.39,170.31a8,8,0,1,0,11.27,11.36L192.93,81A24,24,0,1,0,159,47L59.76,147.68a40,40,0,1,0,56.53,56.62l82.06-82A8,8,0,0,1,209.66,122.34Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M206.83,125.17a4,4,0,0,1,0,5.66l-82.06,82a52,52,0,0,1-73.54-73.55L150.52,38.55a36,36,0,1,1,50.94,50.9l-99.3,100.69a20,20,0,1,1-28.3-28.27l83.29-84.68a4,4,0,1,1,5.7,5.61L79.54,167.5a12,12,0,1,0,16.95,17L195.78,83.81A28,28,0,1,0,156.2,44.18L56.91,144.87a44,44,0,1,0,62.21,62.26l82-82A4,4,0,0,1,206.83,125.17Z"}))]]),t$e=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,176H52V52H204ZM76,128a12,12,0,0,1,12-12h28V88a12,12,0,0,1,24,0v28h28a12,12,0,0,1,0,24H140v28a12,12,0,0,1-24,0V140H88A12,12,0,0,1,76,128Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,48V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H208A8,8,0,0,1,216,48Z",opacity:"0.2"}),React.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM168,136H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32a8,8,0,0,1,0,16Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,34H48A14,14,0,0,0,34,48V208a14,14,0,0,0,14,14H208a14,14,0,0,0,14-14V48A14,14,0,0,0,208,34Zm2,174a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V48a2,2,0,0,1,2-2H208a2,2,0,0,1,2,2Zm-36-80a6,6,0,0,1-6,6H134v34a6,6,0,0,1-12,0V134H88a6,6,0,0,1,0-12h34V88a6,6,0,0,1,12,0v34h34A6,6,0,0,1,174,128Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32Zm0,176H48V48H208V208Zm-32-80a8,8,0,0,1-8,8H136v32a8,8,0,0,1-16,0V136H88a8,8,0,0,1,0-16h32V88a8,8,0,0,1,16,0v32h32A8,8,0,0,1,176,128Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36Zm4,172a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V48a4,4,0,0,1,4-4H208a4,4,0,0,1,4,4Zm-40-80a4,4,0,0,1-4,4H132v36a4,4,0,0,1-8,0V132H88a4,4,0,0,1,0-8h36V88a4,4,0,0,1,8,0v36h36A4,4,0,0,1,172,128Z"}))]]),t$d=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M124,216a12,12,0,0,1-12,12H48a12,12,0,0,1-12-12V40A12,12,0,0,1,48,28h64a12,12,0,0,1,0,24H60V204h52A12,12,0,0,1,124,216Zm108.49-96.49-40-40a12,12,0,0,0-17,17L195,116H112a12,12,0,0,0,0,24h83l-19.52,19.51a12,12,0,0,0,17,17l40-40A12,12,0,0,0,232.49,119.51Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M224,56V200a16,16,0,0,1-16,16H48V40H208A16,16,0,0,1,224,56Z",opacity:"0.2"}),React.createElement("path",{d:"M120,216a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h64a8,8,0,0,1,0,16H56V208h56A8,8,0,0,1,120,216Zm109.66-93.66-40-40a8,8,0,0,0-11.32,11.32L204.69,120H112a8,8,0,0,0,0,16h92.69l-26.35,26.34a8,8,0,0,0,11.32,11.32l40-40A8,8,0,0,0,229.66,122.34Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M120,216a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h64a8,8,0,0,1,0,16H56V208h56A8,8,0,0,1,120,216Zm109.66-93.66-40-40A8,8,0,0,0,176,88v32H112a8,8,0,0,0,0,16h64v32a8,8,0,0,0,13.66,5.66l40-40A8,8,0,0,0,229.66,122.34Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M118,216a6,6,0,0,1-6,6H48a6,6,0,0,1-6-6V40a6,6,0,0,1,6-6h64a6,6,0,0,1,0,12H54V210h58A6,6,0,0,1,118,216Zm110.24-92.24-40-40a6,6,0,0,0-8.48,8.48L209.51,122H112a6,6,0,0,0,0,12h97.51l-29.75,29.76a6,6,0,1,0,8.48,8.48l40-40A6,6,0,0,0,228.24,123.76Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M120,216a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h64a8,8,0,0,1,0,16H56V208h56A8,8,0,0,1,120,216Zm109.66-93.66-40-40a8,8,0,0,0-11.32,11.32L204.69,120H112a8,8,0,0,0,0,16h92.69l-26.35,26.34a8,8,0,0,0,11.32,11.32l40-40A8,8,0,0,0,229.66,122.34Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M116,216a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h64a4,4,0,0,1,0,8H52V212h60A4,4,0,0,1,116,216Zm110.83-90.83-40-40a4,4,0,0,0-5.66,5.66L214.34,124H112a4,4,0,0,0,0,8H214.34l-33.17,33.17a4,4,0,0,0,5.66,5.66l40-40A4,4,0,0,0,226.83,125.17Z"}))]]),t$c=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M200,36H56A20,20,0,0,0,36,56V200a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V56A20,20,0,0,0,200,36Zm-4,160H60V60H196Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M208,56V200a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V56a8,8,0,0,1,8-8H200A8,8,0,0,1,208,56Z",opacity:"0.2"}),React.createElement("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M200,42H56A14,14,0,0,0,42,56V200a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V56A14,14,0,0,0,200,42Zm2,158a2,2,0,0,1-2,2H56a2,2,0,0,1-2-2V56a2,2,0,0,1,2-2H200a2,2,0,0,1,2,2Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M200,40H56A16,16,0,0,0,40,56V200a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V56A16,16,0,0,0,200,40Zm0,160H56V56H200V200Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M200,44H56A12,12,0,0,0,44,56V200a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V56A12,12,0,0,0,200,44Zm4,156a4,4,0,0,1-4,4H56a4,4,0,0,1-4-4V56a4,4,0,0,1,4-4H200a4,4,0,0,1,4,4Z"}))]]),t$b=new Map([["bold",React.createElement(React.Fragment,null,React.createElement("path",{d:"M249.45,69.31a12,12,0,0,0-12.51,1L212,88.43V72a20,20,0,0,0-20-20H32A20,20,0,0,0,12,72V184a20,20,0,0,0,20,20H192a20,20,0,0,0,20-20V167.57l24.94,18.14A12,12,0,0,0,256,176V80A12,12,0,0,0,249.45,69.31ZM188,180H36V76H188Zm44-27.57-20-14.54V118.11l20-14.54Z"}))],["duotone",React.createElement(React.Fragment,null,React.createElement("path",{d:"M200,72V184a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H192A8,8,0,0,1,200,72Z",opacity:"0.2"}),React.createElement("path",{d:"M251.77,73a8,8,0,0,0-8.21.39L208,97.05V72a16,16,0,0,0-16-16H32A16,16,0,0,0,16,72V184a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V159l35.56,23.71A8,8,0,0,0,248,184a8,8,0,0,0,8-8V80A8,8,0,0,0,251.77,73ZM192,184H32V72H192V184Zm48-22.95-32-21.33V116.28L240,95Z"}))],["fill",React.createElement(React.Fragment,null,React.createElement("path",{d:"M192,72V184a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V72A16,16,0,0,1,32,56H176A16,16,0,0,1,192,72Zm58,.25a8.23,8.23,0,0,0-6.63,1.22L209.78,95.86A4,4,0,0,0,208,99.19v57.62a4,4,0,0,0,1.78,3.33l33.78,22.52a8,8,0,0,0,8.58.19,8.33,8.33,0,0,0,3.86-7.17V80A8,8,0,0,0,250,72.25Z"}))],["light",React.createElement(React.Fragment,null,React.createElement("path",{d:"M250.83,74.71a6,6,0,0,0-6.16.3L206,100.79V72a14,14,0,0,0-14-14H32A14,14,0,0,0,18,72V184a14,14,0,0,0,14,14H192a14,14,0,0,0,14-14V155.21L244.67,181a6,6,0,0,0,9.33-5V80A6,6,0,0,0,250.83,74.71ZM194,184a2,2,0,0,1-2,2H32a2,2,0,0,1-2-2V72a2,2,0,0,1,2-2H192a2,2,0,0,1,2,2Zm48-19.21-36-24V115.21l36-24Z"}))],["regular",React.createElement(React.Fragment,null,React.createElement("path",{d:"M251.77,73a8,8,0,0,0-8.21.39L208,97.05V72a16,16,0,0,0-16-16H32A16,16,0,0,0,16,72V184a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V159l35.56,23.71A8,8,0,0,0,248,184a8,8,0,0,0,8-8V80A8,8,0,0,0,251.77,73ZM192,184H32V72H192V184Zm48-22.95-32-21.33V116.28L240,95Z"}))],["thin",React.createElement(React.Fragment,null,React.createElement("path",{d:"M249.89,76.47a4,4,0,0,0-4.11.2L204,104.53V72a12,12,0,0,0-12-12H32A12,12,0,0,0,20,72V184a12,12,0,0,0,12,12H192a12,12,0,0,0,12-12V151.47l41.78,27.86A4,4,0,0,0,252,176V80A4,4,0,0,0,249.89,76.47ZM196,184a4,4,0,0,1-4,4H32a4,4,0,0,1-4-4V72a4,4,0,0,1,4-4H192a4,4,0,0,1,4,4Zm48-15.47-40-26.67V114.14l40-26.67Z"}))]]),o$1=reactExports.createContext({color:"currentColor",size:"1em",weight:"regular",mirrored:!1});var y=Object.defineProperty,c$d=Object.getOwnPropertySymbols,f$e=Object.prototype.hasOwnProperty,g$1=Object.prototype.propertyIsEnumerable,d$1=(_,e,j)=>e in _?y(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,l$5=(_,e)=>{for(var j in e||(e={}))f$e.call(e,j)&&d$1(_,j,e[j]);if(c$d)for(var j of c$d(e))g$1.call(e,j)&&d$1(_,j,e[j]);return _},a$c=(_,e)=>{var j={};for(var Vt in _)f$e.call(_,Vt)&&e.indexOf(Vt)<0&&(j[Vt]=_[Vt]);if(_!=null&&c$d)for(var Vt of c$d(_))e.indexOf(Vt)<0&&g$1.call(_,Vt)&&(j[Vt]=_[Vt]);return j};const h$1=reactExports.forwardRef((_,e)=>{const j=_,{alt:Vt,color:zt,size:_r,weight:_o,mirrored:ga,children:_a,weights:_l}=j,_d=a$c(j,["alt","color","size","weight","mirrored","children","weights"]),_f=reactExports.useContext(o$1),{color:_m="currentColor",size:tE,weight:rE="regular",mirrored:oE=!1}=_f,dE=a$c(_f,["color","size","weight","mirrored"]);return React.createElement("svg",l$5(l$5({ref:e,xmlns:"http://www.w3.org/2000/svg",width:_r??tE,height:_r??tE,fill:zt??_m,viewBox:"0 0 256 256",transform:ga||oE?"scale(-1, 1)":void 0},dE),_d),!!Vt&&React.createElement("title",null,Vt),_a,_l.get(_o??rE))});h$1.displayName="IconBase";const b=h$1;var i$f=Object.defineProperty,p$d=Object.defineProperties,s$d=Object.getOwnPropertyDescriptors,t$a=Object.getOwnPropertySymbols,c$c=Object.prototype.hasOwnProperty,w$5=Object.prototype.propertyIsEnumerable,m$c=(_,e,j)=>e in _?i$f(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$b=(_,e)=>{for(var j in e||(e={}))c$c.call(e,j)&&m$c(_,j,e[j]);if(t$a)for(var j of t$a(e))w$5.call(e,j)&&m$c(_,j,e[j]);return _},f$d=(_,e)=>p$d(_,s$d(e));const I$4=reactExports.forwardRef((_,e)=>React.createElement(b,f$d(a$b({ref:e},_),{weights:t$k})));I$4.displayName="ArrowLeft";var f$c=Object.defineProperty,i$e=Object.defineProperties,p$c=Object.getOwnPropertyDescriptors,t$9=Object.getOwnPropertySymbols,s$c=Object.prototype.hasOwnProperty,c$b=Object.prototype.propertyIsEnumerable,m$b=(_,e,j)=>e in _?f$c(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$a=(_,e)=>{for(var j in e||(e={}))s$c.call(e,j)&&m$b(_,j,e[j]);if(t$9)for(var j of t$9(e))c$b.call(e,j)&&m$b(_,j,e[j]);return _},l$4=(_,e)=>i$e(_,p$c(e));const I$3=reactExports.forwardRef((_,e)=>React.createElement(b,l$4(a$a({ref:e},_),{weights:t$j})));I$3.displayName="Bell";var s$b=Object.defineProperty,c$a=Object.defineProperties,f$b=Object.getOwnPropertyDescriptors,r$4=Object.getOwnPropertySymbols,p$b=Object.prototype.hasOwnProperty,l$3=Object.prototype.propertyIsEnumerable,a$9=(_,e,j)=>e in _?s$b(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,m$a=(_,e)=>{for(var j in e||(e={}))p$b.call(e,j)&&a$9(_,j,e[j]);if(r$4)for(var j of r$4(e))l$3.call(e,j)&&a$9(_,j,e[j]);return _},i$d=(_,e)=>c$a(_,f$b(e));const w$4=reactExports.forwardRef((_,e)=>React.createElement(b,i$d(m$a({ref:e},_),{weights:t$i})));w$4.displayName="ChatCircleDots";var i$c=Object.defineProperty,f$a=Object.defineProperties,p$a=Object.getOwnPropertyDescriptors,t$8=Object.getOwnPropertySymbols,s$a=Object.prototype.hasOwnProperty,l$2=Object.prototype.propertyIsEnumerable,c$9=(_,e,j)=>e in _?i$c(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,m$9=(_,e)=>{for(var j in e||(e={}))s$a.call(e,j)&&c$9(_,j,e[j]);if(t$8)for(var j of t$8(e))l$2.call(e,j)&&c$9(_,j,e[j]);return _},a$8=(_,e)=>f$a(_,p$a(e));const k=reactExports.forwardRef((_,e)=>React.createElement(b,a$8(m$9({ref:e},_),{weights:t$h})));k.displayName="CheckCircle";var f$9=Object.defineProperty,i$b=Object.defineProperties,p$9=Object.getOwnPropertyDescriptors,t$7=Object.getOwnPropertySymbols,c$8=Object.prototype.hasOwnProperty,n$5=Object.prototype.propertyIsEnumerable,m$8=(_,e,j)=>e in _?f$9(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$7=(_,e)=>{for(var j in e||(e={}))c$8.call(e,j)&&m$8(_,j,e[j]);if(t$7)for(var j of t$7(e))n$5.call(e,j)&&m$8(_,j,e[j]);return _},s$9=(_,e)=>i$b(_,p$9(e));const H=reactExports.forwardRef((_,e)=>React.createElement(b,s$9(a$7({ref:e},_),{weights:l$9})));H.displayName="House";var i$a=Object.defineProperty,p$8=Object.defineProperties,s$8=Object.getOwnPropertyDescriptors,r$3=Object.getOwnPropertySymbols,c$7=Object.prototype.hasOwnProperty,I$2=Object.prototype.propertyIsEnumerable,a$6=(_,e,j)=>e in _?i$a(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,t$6=(_,e)=>{for(var j in e||(e={}))c$7.call(e,j)&&a$6(_,j,e[j]);if(r$3)for(var j of r$3(e))I$2.call(e,j)&&a$6(_,j,e[j]);return _},f$8=(_,e)=>p$8(_,s$8(e));const w$3=reactExports.forwardRef((_,e)=>React.createElement(b,f$8(t$6({ref:e},_),{weights:l$8})));w$3.displayName="Image";var m$7=Object.defineProperty,f$7=Object.defineProperties,n$4=Object.getOwnPropertyDescriptors,r$2=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,p$7=Object.prototype.propertyIsEnumerable,i$9=(_,e,j)=>e in _?m$7(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,s$7=(_,e)=>{for(var j in e||(e={}))g.call(e,j)&&i$9(_,j,e[j]);if(r$2)for(var j of r$2(e))p$7.call(e,j)&&i$9(_,j,e[j]);return _},t$5=(_,e)=>f$7(_,n$4(e));const w$2=reactExports.forwardRef((_,e)=>React.createElement(b,t$5(s$7({ref:e},_),{weights:t$g})));w$2.displayName="MagnifyingGlass";var p$6=Object.defineProperty,c$6=Object.defineProperties,f$6=Object.getOwnPropertyDescriptors,t$4=Object.getOwnPropertySymbols,n$3=Object.prototype.hasOwnProperty,s$6=Object.prototype.propertyIsEnumerable,m$6=(_,e,j)=>e in _?p$6(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$5=(_,e)=>{for(var j in e||(e={}))n$3.call(e,j)&&m$6(_,j,e[j]);if(t$4)for(var j of t$4(e))s$6.call(e,j)&&m$6(_,j,e[j]);return _},i$8=(_,e)=>c$6(_,f$6(e));const I$1=reactExports.forwardRef((_,e)=>React.createElement(b,i$8(a$5({ref:e},_),{weights:t$f})));I$1.displayName="Microphone";var p$5=Object.defineProperty,f$5=Object.defineProperties,n$2=Object.getOwnPropertyDescriptors,t$3=Object.getOwnPropertySymbols,s$5=Object.prototype.hasOwnProperty,c$5=Object.prototype.propertyIsEnumerable,o=(_,e,j)=>e in _?p$5(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,m$5=(_,e)=>{for(var j in e||(e={}))s$5.call(e,j)&&o(_,j,e[j]);if(t$3)for(var j of t$3(e))c$5.call(e,j)&&o(_,j,e[j]);return _},i$7=(_,e)=>f$5(_,n$2(e));const h=reactExports.forwardRef((_,e)=>React.createElement(b,i$7(m$5({ref:e},_),{weights:l$7})));h.displayName="PaperPlaneRight";var i$6=Object.defineProperty,c$4=Object.defineProperties,f$4=Object.getOwnPropertyDescriptors,a$4=Object.getOwnPropertySymbols,s$4=Object.prototype.hasOwnProperty,l$1=Object.prototype.propertyIsEnumerable,p$4=(_,e,j)=>e in _?i$6(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,t$2=(_,e)=>{for(var j in e||(e={}))s$4.call(e,j)&&p$4(_,j,e[j]);if(a$4)for(var j of a$4(e))l$1.call(e,j)&&p$4(_,j,e[j]);return _},m$4=(_,e)=>c$4(_,f$4(e));const P=reactExports.forwardRef((_,e)=>React.createElement(b,m$4(t$2({ref:e},_),{weights:l$6})));P.displayName="Paperclip";var f$3=Object.defineProperty,i$5=Object.defineProperties,p$3=Object.getOwnPropertyDescriptors,a$3=Object.getOwnPropertySymbols,c$3=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,t$1=(_,e,j)=>e in _?f$3(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,m$3=(_,e)=>{for(var j in e||(e={}))c$3.call(e,j)&&t$1(_,j,e[j]);if(a$3)for(var j of a$3(e))l.call(e,j)&&t$1(_,j,e[j]);return _},s$3=(_,e)=>i$5(_,p$3(e));const w$1=reactExports.forwardRef((_,e)=>React.createElement(b,s$3(m$3({ref:e},_),{weights:t$e})));w$1.displayName="PlusSquare";var f$2=Object.defineProperty,n$1=Object.defineProperties,p$2=Object.getOwnPropertyDescriptors,r$1=Object.getOwnPropertySymbols,s$2=Object.prototype.hasOwnProperty,c$2=Object.prototype.propertyIsEnumerable,m$2=(_,e,j)=>e in _?f$2(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$2=(_,e)=>{for(var j in e||(e={}))s$2.call(e,j)&&m$2(_,j,e[j]);if(r$1)for(var j of r$1(e))c$2.call(e,j)&&m$2(_,j,e[j]);return _},i$4=(_,e)=>n$1(_,p$2(e));const w=reactExports.forwardRef((_,e)=>React.createElement(b,i$4(a$2({ref:e},_),{weights:t$d})));w.displayName="SignOut";var f$1=Object.defineProperty,i$3=Object.defineProperties,s$1=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,c$1=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,m$1=(_,e,j)=>e in _?f$1(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,a$1=(_,e)=>{for(var j in e||(e={}))c$1.call(e,j)&&m$1(_,j,e[j]);if(r)for(var j of r(e))n.call(e,j)&&m$1(_,j,e[j]);return _},p$1=(_,e)=>i$3(_,s$1(e));const R=reactExports.forwardRef((_,e)=>React.createElement(b,p$1(a$1({ref:e},_),{weights:t$c})));R.displayName="Stop";var f=Object.defineProperty,p=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,m=(_,e,j)=>e in _?f(_,e,{enumerable:!0,configurable:!0,writable:!0,value:j}):_[e]=j,t=(_,e)=>{for(var j in e||(e={}))c.call(e,j)&&m(_,j,e[j]);if(a)for(var j of a(e))d.call(e,j)&&m(_,j,e[j]);return _},i$2=(_,e)=>p(_,s(e));const I=reactExports.forwardRef((_,e)=>React.createElement(b,i$2(t({ref:e},_),{weights:t$b})));I.displayName="VideoCamera";const PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(_=>{PACKET_TYPES_REVERSE[PACKET_TYPES[_]]=_});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_&&_.buffer instanceof ArrayBuffer,encodePacket=({type:_,data:e},j,Vt)=>withNativeBlob$1&&e instanceof Blob?j?Vt(e):encodeBlobAsBase64(e,Vt):withNativeArrayBuffer$2&&(e instanceof ArrayBuffer||isView$1(e))?j?Vt(e):encodeBlobAsBase64(new Blob([e]),Vt):Vt(PACKET_TYPES[_]+(e||"")),encodeBlobAsBase64=(_,e)=>{const j=new FileReader;return j.onload=function(){const Vt=j.result.split(",")[1];e("b"+(Vt||""))},j.readAsDataURL(_)};function toArray$1(_){return _ instanceof Uint8Array?_:_ instanceof ArrayBuffer?new Uint8Array(_):new Uint8Array(_.buffer,_.byteOffset,_.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(_,e){if(withNativeBlob$1&&_.data instanceof Blob)return _.data.arrayBuffer().then(toArray$1).then(e);if(withNativeArrayBuffer$2&&(_.data instanceof ArrayBuffer||isView$1(_.data)))return e(toArray$1(_.data));encodePacket(_,!1,j=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),e(TEXT_ENCODER.encode(j))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let _=0;_<chars.length;_++)lookup$1[chars.charCodeAt(_)]=_;const decode$1=_=>{let e=_.length*.75,j=_.length,Vt,zt=0,_r,_o,ga,_a;_[_.length-1]==="="&&(e--,_[_.length-2]==="="&&e--);const _l=new ArrayBuffer(e),_d=new Uint8Array(_l);for(Vt=0;Vt<j;Vt+=4)_r=lookup$1[_.charCodeAt(Vt)],_o=lookup$1[_.charCodeAt(Vt+1)],ga=lookup$1[_.charCodeAt(Vt+2)],_a=lookup$1[_.charCodeAt(Vt+3)],_d[zt++]=_r<<2|_o>>4,_d[zt++]=(_o&15)<<4|ga>>2,_d[zt++]=(ga&3)<<6|_a&63;return _l},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(_,e)=>{if(typeof _!="string")return{type:"message",data:mapBinary(_,e)};const j=_.charAt(0);return j==="b"?{type:"message",data:decodeBase64Packet(_.substring(1),e)}:PACKET_TYPES_REVERSE[j]?_.length>1?{type:PACKET_TYPES_REVERSE[j],data:_.substring(1)}:{type:PACKET_TYPES_REVERSE[j]}:ERROR_PACKET},decodeBase64Packet=(_,e)=>{if(withNativeArrayBuffer$1){const j=decode$1(_);return mapBinary(j,e)}else return{base64:!0,data:_}},mapBinary=(_,e)=>{switch(e){case"blob":return _ instanceof Blob?_:new Blob([_]);case"arraybuffer":default:return _ instanceof ArrayBuffer?_:_.buffer}},SEPARATOR="",encodePayload=(_,e)=>{const j=_.length,Vt=new Array(j);let zt=0;_.forEach((_r,_o)=>{encodePacket(_r,!1,ga=>{Vt[_o]=ga,++zt===j&&e(Vt.join(SEPARATOR))})})},decodePayload=(_,e)=>{const j=_.split(SEPARATOR),Vt=[];for(let zt=0;zt<j.length;zt++){const _r=decodePacket(j[zt],e);if(Vt.push(_r),_r.type==="error")break}return Vt};function createPacketEncoderStream(){return new TransformStream({transform(_,e){encodePacketToBinary(_,j=>{const Vt=j.length;let zt;if(Vt<126)zt=new Uint8Array(1),new DataView(zt.buffer).setUint8(0,Vt);else if(Vt<65536){zt=new Uint8Array(3);const _r=new DataView(zt.buffer);_r.setUint8(0,126),_r.setUint16(1,Vt)}else{zt=new Uint8Array(9);const _r=new DataView(zt.buffer);_r.setUint8(0,127),_r.setBigUint64(1,BigInt(Vt))}_.data&&typeof _.data!="string"&&(zt[0]|=128),e.enqueue(zt),e.enqueue(j)})}})}let TEXT_DECODER;function totalLength(_){return _.reduce((e,j)=>e+j.length,0)}function concatChunks(_,e){if(_[0].length===e)return _.shift();const j=new Uint8Array(e);let Vt=0;for(let zt=0;zt<e;zt++)j[zt]=_[0][Vt++],Vt===_[0].length&&(_.shift(),Vt=0);return _.length&&Vt<_[0].length&&(_[0]=_[0].slice(Vt)),j}function createPacketDecoderStream(_,e){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const j=[];let Vt=0,zt=-1,_r=!1;return new TransformStream({transform(_o,ga){for(j.push(_o);;){if(Vt===0){if(totalLength(j)<1)break;const _a=concatChunks(j,1);_r=(_a[0]&128)===128,zt=_a[0]&127,zt<126?Vt=3:zt===126?Vt=1:Vt=2}else if(Vt===1){if(totalLength(j)<2)break;const _a=concatChunks(j,2);zt=new DataView(_a.buffer,_a.byteOffset,_a.length).getUint16(0),Vt=3}else if(Vt===2){if(totalLength(j)<8)break;const _a=concatChunks(j,8),_l=new DataView(_a.buffer,_a.byteOffset,_a.length),_d=_l.getUint32(0);if(_d>Math.pow(2,21)-1){ga.enqueue(ERROR_PACKET);break}zt=_d*Math.pow(2,32)+_l.getUint32(4),Vt=3}else{if(totalLength(j)<zt)break;const _a=concatChunks(j,zt);ga.enqueue(decodePacket(_r?_a:TEXT_DECODER.decode(_a),e)),Vt=0}if(zt===0||zt>_){ga.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(_){if(_)return mixin(_)}function mixin(_){for(var e in Emitter.prototype)_[e]=Emitter.prototype[e];return _}Emitter.prototype.on=Emitter.prototype.addEventListener=function(_,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+_]=this._callbacks["$"+_]||[]).push(e),this};Emitter.prototype.once=function(_,e){function j(){this.off(_,j),e.apply(this,arguments)}return j.fn=e,this.on(_,j),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(_,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var j=this._callbacks["$"+_];if(!j)return this;if(arguments.length==1)return delete this._callbacks["$"+_],this;for(var Vt,zt=0;zt<j.length;zt++)if(Vt=j[zt],Vt===e||Vt.fn===e){j.splice(zt,1);break}return j.length===0&&delete this._callbacks["$"+_],this};Emitter.prototype.emit=function(_){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),j=this._callbacks["$"+_],Vt=1;Vt<arguments.length;Vt++)e[Vt-1]=arguments[Vt];if(j){j=j.slice(0);for(var Vt=0,zt=j.length;Vt<zt;++Vt)j[Vt].apply(this,e)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(_){return this._callbacks=this._callbacks||{},this._callbacks["$"+_]||[]};Emitter.prototype.hasListeners=function(_){return!!this.listeners(_).length};const globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function pick(_,...e){return e.reduce((j,Vt)=>(_.hasOwnProperty(Vt)&&(j[Vt]=_[Vt]),j),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(_,e){e.useNativeTimers?(_.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),_.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(_.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),_.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(_){return typeof _=="string"?utf8Length(_):Math.ceil((_.byteLength||_.size)*BASE64_OVERHEAD)}function utf8Length(_){let e=0,j=0;for(let Vt=0,zt=_.length;Vt<zt;Vt++)e=_.charCodeAt(Vt),e<128?j+=1:e<2048?j+=2:e<55296||e>=57344?j+=3:(Vt++,j+=4);return j}function encode$3(_){let e="";for(let j in _)_.hasOwnProperty(j)&&(e.length&&(e+="&"),e+=encodeURIComponent(j)+"="+encodeURIComponent(_[j]));return e}function decode(_){let e={},j=_.split("&");for(let Vt=0,zt=j.length;Vt<zt;Vt++){let _r=j[Vt].split("=");e[decodeURIComponent(_r[0])]=decodeURIComponent(_r[1])}return e}class TransportError extends Error{constructor(e,j,Vt){super(e),this.description=j,this.context=Vt,this.type="TransportError"}}class Transport extends Emitter{constructor(e){super(),this.writable=!1,installTimerFunctions(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,j,Vt){return super.emitReserved("error",new TransportError(e,j,Vt)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const j=decodePacket(e,this.socket.binaryType);this.onPacket(j)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,j={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(j)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const j=encode$3(e);return j.length?"?"+j:""}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i$1=0,prev;function encode$2(_){let e="";do e=alphabet[_%length]+e,_=Math.floor(_/length);while(_>0);return e}function yeast(){const _=encode$2(+new Date);return _!==prev?(seed=0,prev=_):_+"."+encode$2(seed++)}for(;i$1<length;i$1++)map[alphabet[i$1]]=i$1;let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const hasCORS=value;function XHR(_){const e=_.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||hasCORS))return new XMLHttpRequest}catch{}if(!e)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function createCookieJar(){}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const Vt=location.protocol==="https:";let zt=location.port;zt||(zt=Vt?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||zt!==e.port}const j=e&&e.forceBase64;this.supportsBinary=hasXHR2&&!j,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const j=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let Vt=0;this.polling&&(Vt++,this.once("pollComplete",function(){--Vt||j()})),this.writable||(Vt++,this.once("drain",function(){--Vt||j()}))}else j()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const j=Vt=>{if(this.readyState==="opening"&&Vt.type==="open"&&this.onOpen(),Vt.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(Vt)};decodePayload(e,this.socket.binaryType).forEach(j),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,encodePayload(e,j=>{this.doWrite(j,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",j=this.query||{};return this.opts.timestampRequests!==!1&&(j[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!j.sid&&(j.b64=1),this.createUri(e,j)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request$1(this.uri(),e)}doWrite(e,j){const Vt=this.request({method:"POST",data:e});Vt.on("success",j),Vt.on("error",(zt,_r)=>{this.onError("xhr post error",zt,_r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(j,Vt)=>{this.onError("xhr poll error",j,Vt)}),this.pollXhr=e}}let Request$1=class BM extends Emitter{constructor(e,j){super(),installTimerFunctions(this,j),this.opts=j,this.method=j.method||"GET",this.uri=e,this.data=j.data!==void 0?j.data:null,this.create()}create(){var e;const j=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");j.xdomain=!!this.opts.xd;const Vt=this.xhr=new XHR(j);try{Vt.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){Vt.setDisableHeaderCheck&&Vt.setDisableHeaderCheck(!0);for(let zt in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(zt)&&Vt.setRequestHeader(zt,this.opts.extraHeaders[zt])}}catch{}if(this.method==="POST")try{Vt.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{Vt.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(Vt),"withCredentials"in Vt&&(Vt.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(Vt.timeout=this.opts.requestTimeout),Vt.onreadystatechange=()=>{var zt;Vt.readyState===3&&((zt=this.opts.cookieJar)===null||zt===void 0||zt.parseCookies(Vt)),Vt.readyState===4&&(Vt.status===200||Vt.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof Vt.status=="number"?Vt.status:0)},0))},Vt.send(this.data)}catch(zt){this.setTimeoutFn(()=>{this.onError(zt)},0);return}typeof document<"u"&&(this.index=BM.requestsCount++,BM.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete BM.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Request$1.requestsCount=0;Request$1.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const _="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(_,unloadHandler,!1)}}function unloadHandler(){for(let _ in Request$1.requests)Request$1.requests.hasOwnProperty(_)&&Request$1.requests[_].abort()}const nextTick$1=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,j)=>j(e,0),WebSocket$1=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),j=this.opts.protocols,Vt=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(Vt.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?j?new WebSocket$1(e,j):new WebSocket$1(e):new WebSocket$1(e,j,Vt)}catch(zt){return this.emitReserved("error",zt)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let j=0;j<e.length;j++){const Vt=e[j],zt=j===e.length-1;encodePacket(Vt,this.supportsBinary,_r=>{const _o={};try{usingBrowserWebSocket&&this.ws.send(_r)}catch{}zt&&nextTick$1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",j=this.query||{};return this.opts.timestampRequests&&(j[this.opts.timestampParam]=yeast()),this.supportsBinary||(j.b64=1),this.createUri(e,j)}check(){return!!WebSocket$1}}class WT extends Transport{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const j=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),Vt=e.readable.pipeThrough(j).getReader(),zt=createPacketEncoderStream();zt.readable.pipeTo(e.writable),this.writer=zt.writable.getWriter();const _r=()=>{Vt.read().then(({done:ga,value:_a})=>{ga||(this.onPacket(_a),_r())}).catch(ga=>{})};_r();const _o={type:"open"};this.query.sid&&(_o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(_o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let j=0;j<e.length;j++){const Vt=e[j],zt=j===e.length-1;this.writer.write(Vt).then(()=>{zt&&nextTick$1(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const transports={websocket:WS,webtransport:WT,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(_){if(_.length>2e3)throw"URI too long";const e=_,j=_.indexOf("["),Vt=_.indexOf("]");j!=-1&&Vt!=-1&&(_=_.substring(0,j)+_.substring(j,Vt).replace(/:/g,";")+_.substring(Vt,_.length));let zt=re.exec(_||""),_r={},_o=14;for(;_o--;)_r[parts[_o]]=zt[_o]||"";return j!=-1&&Vt!=-1&&(_r.source=e,_r.host=_r.host.substring(1,_r.host.length-1).replace(/;/g,":"),_r.authority=_r.authority.replace("[","").replace("]","").replace(/;/g,":"),_r.ipv6uri=!0),_r.pathNames=pathNames(_r,_r.path),_r.queryKey=queryKey(_r,_r.query),_r}function pathNames(_,e){const j=/\/{2,9}/g,Vt=e.replace(j,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&Vt.splice(0,1),e.slice(-1)=="/"&&Vt.splice(Vt.length-1,1),Vt}function queryKey(_,e){const j={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(Vt,zt,_r){zt&&(j[zt]=_r)}),j}let Socket$1=class mN extends Emitter{constructor(e,j={}){super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],e&&typeof e=="object"&&(j=e,e=null),e?(e=parse(e),j.hostname=e.host,j.secure=e.protocol==="https"||e.protocol==="wss",j.port=e.port,e.query&&(j.query=e.query)):j.host&&(j.hostname=parse(j.host).host),installTimerFunctions(this,j),this.secure=j.secure!=null?j.secure:typeof location<"u"&&location.protocol==="https:",j.hostname&&!j.port&&(j.port=this.secure?"443":"80"),this.hostname=j.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=j.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=j.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},j),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const j=Object.assign({},this.opts.query);j.EIO=protocol$1,j.transport=e,this.id&&(j.sid=this.id);const Vt=Object.assign({},this.opts,{query:j,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new transports[e](Vt)}open(){let e;if(this.opts.rememberUpgrade&&mN.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",j=>this.onClose("transport close",j))}probe(e){let j=this.createTransport(e),Vt=!1;mN.priorWebsocketSuccess=!1;const zt=()=>{Vt||(j.send([{type:"ping",data:"probe"}]),j.once("packet",_f=>{if(!Vt)if(_f.type==="pong"&&_f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",j),!j)return;mN.priorWebsocketSuccess=j.name==="websocket",this.transport.pause(()=>{Vt||this.readyState!=="closed"&&(_d(),this.setTransport(j),j.send([{type:"upgrade"}]),this.emitReserved("upgrade",j),j=null,this.upgrading=!1,this.flush())})}else{const _m=new Error("probe error");_m.transport=j.name,this.emitReserved("upgradeError",_m)}}))};function _r(){Vt||(Vt=!0,_d(),j.close(),j=null)}const _o=_f=>{const _m=new Error("probe error: "+_f);_m.transport=j.name,_r(),this.emitReserved("upgradeError",_m)};function ga(){_o("transport closed")}function _a(){_o("socket closed")}function _l(_f){j&&_f.name!==j.name&&_r()}const _d=()=>{j.removeListener("open",zt),j.removeListener("error",_o),j.removeListener("close",ga),this.off("close",_a),this.off("upgrading",_l)};j.once("open",zt),j.once("error",_o),j.once("close",ga),this.once("close",_a),this.once("upgrading",_l),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{Vt||j.open()},200):j.open()}onOpen(){if(this.readyState="open",mN.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const j=this.upgrades.length;for(;e<j;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const j=new Error("server error");j.code=e.data,this.onError(j);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let j=1;for(let Vt=0;Vt<this.writeBuffer.length;Vt++){const zt=this.writeBuffer[Vt].data;if(zt&&(j+=byteLength(zt)),Vt>0&&j>this.maxPayload)return this.writeBuffer.slice(0,Vt);j+=2}return this.writeBuffer}write(e,j,Vt){return this.sendPacket("message",e,j,Vt),this}send(e,j,Vt){return this.sendPacket("message",e,j,Vt),this}sendPacket(e,j,Vt,zt){if(typeof j=="function"&&(zt=j,j=void 0),typeof Vt=="function"&&(zt=Vt,Vt=null),this.readyState==="closing"||this.readyState==="closed")return;Vt=Vt||{},Vt.compress=Vt.compress!==!1;const _r={type:e,data:j,options:Vt};this.emitReserved("packetCreate",_r),this.writeBuffer.push(_r),zt&&this.once("flush",zt),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},j=()=>{this.off("upgrade",j),this.off("upgradeError",j),e()},Vt=()=>{this.once("upgrade",j),this.once("upgradeError",j)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?Vt():e()}):this.upgrading?Vt():e()),this}onError(e){mN.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,j){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,j),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const j=[];let Vt=0;const zt=e.length;for(;Vt<zt;Vt++)~this.transports.indexOf(e[Vt])&&j.push(e[Vt]);return j}};Socket$1.protocol=protocol$1;function url(_,e="",j){let Vt=_;j=j||typeof location<"u"&&location,_==null&&(_=j.protocol+"//"+j.host),typeof _=="string"&&(_.charAt(0)==="/"&&(_.charAt(1)==="/"?_=j.protocol+_:_=j.host+_),/^(https?|wss?):\/\//.test(_)||(typeof j<"u"?_=j.protocol+"//"+_:_="https://"+_),Vt=parse(_)),Vt.port||(/^(http|ws)$/.test(Vt.protocol)?Vt.port="80":/^(http|ws)s$/.test(Vt.protocol)&&(Vt.port="443")),Vt.path=Vt.path||"/";const _r=Vt.host.indexOf(":")!==-1?"["+Vt.host+"]":Vt.host;return Vt.id=Vt.protocol+"://"+_r+":"+Vt.port+e,Vt.href=Vt.protocol+"://"+_r+(j&&j.port===Vt.port?"":":"+Vt.port),Vt}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=_=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(_):_.buffer instanceof ArrayBuffer,toString$1=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString$1.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString$1.call(File)==="[object FileConstructor]";function isBinary(_){return withNativeArrayBuffer&&(_ instanceof ArrayBuffer||isView(_))||withNativeBlob&&_ instanceof Blob||withNativeFile&&_ instanceof File}function hasBinary(_,e){if(!_||typeof _!="object")return!1;if(Array.isArray(_)){for(let j=0,Vt=_.length;j<Vt;j++)if(hasBinary(_[j]))return!0;return!1}if(isBinary(_))return!0;if(_.toJSON&&typeof _.toJSON=="function"&&arguments.length===1)return hasBinary(_.toJSON(),!0);for(const j in _)if(Object.prototype.hasOwnProperty.call(_,j)&&hasBinary(_[j]))return!0;return!1}function deconstructPacket(_){const e=[],j=_.data,Vt=_;return Vt.data=_deconstructPacket(j,e),Vt.attachments=e.length,{packet:Vt,buffers:e}}function _deconstructPacket(_,e){if(!_)return _;if(isBinary(_)){const j={_placeholder:!0,num:e.length};return e.push(_),j}else if(Array.isArray(_)){const j=new Array(_.length);for(let Vt=0;Vt<_.length;Vt++)j[Vt]=_deconstructPacket(_[Vt],e);return j}else if(typeof _=="object"&&!(_ instanceof Date)){const j={};for(const Vt in _)Object.prototype.hasOwnProperty.call(_,Vt)&&(j[Vt]=_deconstructPacket(_[Vt],e));return j}return _}function reconstructPacket(_,e){return _.data=_reconstructPacket(_.data,e),delete _.attachments,_}function _reconstructPacket(_,e){if(!_)return _;if(_&&_._placeholder===!0){if(typeof _.num=="number"&&_.num>=0&&_.num<e.length)return e[_.num];throw new Error("illegal attachments")}else if(Array.isArray(_))for(let j=0;j<_.length;j++)_[j]=_reconstructPacket(_[j],e);else if(typeof _=="object")for(const j in _)Object.prototype.hasOwnProperty.call(_,j)&&(_[j]=_reconstructPacket(_[j],e));return _}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(_){_[_.CONNECT=0]="CONNECT",_[_.DISCONNECT=1]="DISCONNECT",_[_.EVENT=2]="EVENT",_[_.ACK=3]="ACK",_[_.CONNECT_ERROR=4]="CONNECT_ERROR",_[_.BINARY_EVENT=5]="BINARY_EVENT",_[_.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(e){this.replacer=e}encode(e){return(e.type===PacketType.EVENT||e.type===PacketType.ACK)&&hasBinary(e)?this.encodeAsBinary({type:e.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let j=""+e.type;return(e.type===PacketType.BINARY_EVENT||e.type===PacketType.BINARY_ACK)&&(j+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(j+=e.nsp+","),e.id!=null&&(j+=e.id),e.data!=null&&(j+=JSON.stringify(e.data,this.replacer)),j}encodeAsBinary(e){const j=deconstructPacket(e),Vt=this.encodeAsString(j.packet),zt=j.buffers;return zt.unshift(Vt),zt}}function isObject$4(_){return Object.prototype.toString.call(_)==="[object Object]"}class Decoder extends Emitter{constructor(e){super(),this.reviver=e}add(e){let j;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");j=this.decodeString(e);const Vt=j.type===PacketType.BINARY_EVENT;Vt||j.type===PacketType.BINARY_ACK?(j.type=Vt?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(j),j.attachments===0&&super.emitReserved("decoded",j)):super.emitReserved("decoded",j)}else if(isBinary(e)||e.base64)if(this.reconstructor)j=this.reconstructor.takeBinaryData(e),j&&(this.reconstructor=null,super.emitReserved("decoded",j));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let j=0;const Vt={type:Number(e.charAt(0))};if(PacketType[Vt.type]===void 0)throw new Error("unknown packet type "+Vt.type);if(Vt.type===PacketType.BINARY_EVENT||Vt.type===PacketType.BINARY_ACK){const _r=j+1;for(;e.charAt(++j)!=="-"&&j!=e.length;);const _o=e.substring(_r,j);if(_o!=Number(_o)||e.charAt(j)!=="-")throw new Error("Illegal attachments");Vt.attachments=Number(_o)}if(e.charAt(j+1)==="/"){const _r=j+1;for(;++j&&!(e.charAt(j)===","||j===e.length););Vt.nsp=e.substring(_r,j)}else Vt.nsp="/";const zt=e.charAt(j+1);if(zt!==""&&Number(zt)==zt){const _r=j+1;for(;++j;){const _o=e.charAt(j);if(_o==null||Number(_o)!=_o){--j;break}if(j===e.length)break}Vt.id=Number(e.substring(_r,j+1))}if(e.charAt(++j)){const _r=this.tryParse(e.substr(j));if(Decoder.isPayloadValid(Vt.type,_r))Vt.data=_r;else throw new Error("invalid payload")}return Vt}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,j){switch(e){case PacketType.CONNECT:return isObject$4(j);case PacketType.DISCONNECT:return j===void 0;case PacketType.CONNECT_ERROR:return typeof j=="string"||isObject$4(j);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(j)&&(typeof j[0]=="number"||typeof j[0]=="string"&&RESERVED_EVENTS$1.indexOf(j[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(j)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const j=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),j}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(_,e,j){return _.on(e,j),function(){_.off(e,j)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(e,j,Vt){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=j,Vt&&Vt.auth&&(this.auth=Vt.auth),this._opts=Object.assign({},Vt),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[on(e,"open",this.onopen.bind(this)),on(e,"packet",this.onpacket.bind(this)),on(e,"error",this.onerror.bind(this)),on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...j){if(RESERVED_EVENTS.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(j.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(j),this;const Vt={type:PacketType.EVENT,data:j};if(Vt.options={},Vt.options.compress=this.flags.compress!==!1,typeof j[j.length-1]=="function"){const _o=this.ids++,ga=j.pop();this._registerAckCallback(_o,ga),Vt.id=_o}const zt=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!zt||!this.connected)||(this.connected?(this.notifyOutgoingListeners(Vt),this.packet(Vt)):this.sendBuffer.push(Vt)),this.flags={},this}_registerAckCallback(e,j){var Vt;const zt=(Vt=this.flags.timeout)!==null&&Vt!==void 0?Vt:this._opts.ackTimeout;if(zt===void 0){this.acks[e]=j;return}const _r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let ga=0;ga<this.sendBuffer.length;ga++)this.sendBuffer[ga].id===e&&this.sendBuffer.splice(ga,1);j.call(this,new Error("operation has timed out"))},zt),_o=(...ga)=>{this.io.clearTimeoutFn(_r),j.apply(this,ga)};_o.withError=!0,this.acks[e]=_o}emitWithAck(e,...j){return new Promise((Vt,zt)=>{const _r=(_o,ga)=>_o?zt(_o):Vt(ga);_r.withError=!0,j.push(_r),this.emit(e,...j)})}_addToQueue(e){let j;typeof e[e.length-1]=="function"&&(j=e.pop());const Vt={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((zt,..._r)=>Vt!==this._queue[0]?void 0:(zt!==null?Vt.tryCount>this._opts.retries&&(this._queue.shift(),j&&j(zt)):(this._queue.shift(),j&&j(null,..._r)),Vt.pending=!1,this._drainQueue())),this._queue.push(Vt),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const j=this._queue[0];j.pending&&!e||(j.pending=!0,j.tryCount++,this.flags=j.flags,this.emit.apply(this,j.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,j){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,j),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(Vt=>String(Vt.id)===e)){const Vt=this.acks[e];delete this.acks[e],Vt.withError&&Vt.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case PacketType.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(e);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(e);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const Vt=new Error(e.data.message);Vt.data=e.data.data,this.emitReserved("connect_error",Vt);break}}onevent(e){const j=e.data||[];e.id!=null&&j.push(this.ack(e.id)),this.connected?this.emitEvent(j):this.receiveBuffer.push(Object.freeze(j))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const j=this._anyListeners.slice();for(const Vt of j)Vt.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const j=this;let Vt=!1;return function(...zt){Vt||(Vt=!0,j.packet({type:PacketType.ACK,id:e,data:zt}))}}onack(e){const j=this.acks[e.id];typeof j=="function"&&(delete this.acks[e.id],j.withError&&e.data.unshift(null),j.apply(this,e.data))}onconnect(e,j){this.id=e,this.recovered=j&&this._pid===j,this._pid=j,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const j=this._anyListeners;for(let Vt=0;Vt<j.length;Vt++)if(e===j[Vt])return j.splice(Vt,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const j=this._anyOutgoingListeners;for(let Vt=0;Vt<j.length;Vt++)if(e===j[Vt])return j.splice(Vt,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const j=this._anyOutgoingListeners.slice();for(const Vt of j)Vt.apply(this,e.data)}}}function Backoff(_){_=_||{},this.ms=_.min||100,this.max=_.max||1e4,this.factor=_.factor||2,this.jitter=_.jitter>0&&_.jitter<=1?_.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var _=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),j=Math.floor(e*this.jitter*_);_=Math.floor(e*10)&1?_+j:_-j}return Math.min(_,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(_){this.ms=_};Backoff.prototype.setMax=function(_){this.max=_};Backoff.prototype.setJitter=function(_){this.jitter=_};class Manager extends Emitter{constructor(e,j){var Vt;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(j=e,e=void 0),j=j||{},j.path=j.path||"/socket.io",this.opts=j,installTimerFunctions(this,j),this.reconnection(j.reconnection!==!1),this.reconnectionAttempts(j.reconnectionAttempts||1/0),this.reconnectionDelay(j.reconnectionDelay||1e3),this.reconnectionDelayMax(j.reconnectionDelayMax||5e3),this.randomizationFactor((Vt=j.randomizationFactor)!==null&&Vt!==void 0?Vt:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(j.timeout==null?2e4:j.timeout),this._readyState="closed",this.uri=e;const zt=j.parser||parser;this.encoder=new zt.Encoder,this.decoder=new zt.Decoder,this._autoConnect=j.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var j;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(j=this.backoff)===null||j===void 0||j.setMin(e),this)}randomizationFactor(e){var j;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(j=this.backoff)===null||j===void 0||j.setJitter(e),this)}reconnectionDelayMax(e){var j;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(j=this.backoff)===null||j===void 0||j.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const j=this.engine,Vt=this;this._readyState="opening",this.skipReconnect=!1;const zt=on(j,"open",function(){Vt.onopen(),e&&e()}),_r=ga=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",ga),e?e(ga):this.maybeReconnectOnOpen()},_o=on(j,"error",_r);if(this._timeout!==!1){const ga=this._timeout,_a=this.setTimeoutFn(()=>{zt(),_r(new Error("timeout")),j.close()},ga);this.opts.autoUnref&&_a.unref(),this.subs.push(()=>{this.clearTimeoutFn(_a)})}return this.subs.push(zt),this.subs.push(_o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(on(e,"ping",this.onping.bind(this)),on(e,"data",this.ondata.bind(this)),on(e,"error",this.onerror.bind(this)),on(e,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(j){this.onclose("parse error",j)}}ondecoded(e){nextTick$1(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,j){let Vt=this.nsps[e];return Vt?this._autoConnect&&!Vt.active&&Vt.connect():(Vt=new Socket(this,e,j),this.nsps[e]=Vt),Vt}_destroy(e){const j=Object.keys(this.nsps);for(const Vt of j)if(this.nsps[Vt].active)return;this._close()}_packet(e){const j=this.encoder.encode(e);for(let Vt=0;Vt<j.length;Vt++)this.engine.write(j[Vt],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,j){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,j),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const j=this.backoff.duration();this._reconnecting=!0;const Vt=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(zt=>{zt?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",zt)):e.onreconnect()}))},j);this.opts.autoUnref&&Vt.unref(),this.subs.push(()=>{this.clearTimeoutFn(Vt)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const cache={};function lookup(_,e){typeof _=="object"&&(e=_,_=void 0),e=e||{};const j=url(_,e.path||"/socket.io"),Vt=j.source,zt=j.id,_r=j.path,_o=cache[zt]&&_r in cache[zt].nsps,ga=e.forceNew||e["force new connection"]||e.multiplex===!1||_o;let _a;return ga?_a=new Manager(Vt,e):(cache[zt]||(cache[zt]=new Manager(Vt,e)),_a=cache[zt]),j.query&&!e.query&&(e.query=j.queryKey),_a.socket(j.path,e)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});const backend_crud="https://6a41-105-172-231-254.ngrok-free.app/api_quebec_crud/public/",backend_rtc="https://2fac-105-172-231-254.ngrok-free.app",SocketContext=reactExports.createContext(),SocketProvider=({children:_})=>{const{user:e}=useAuth(),[j,Vt]=reactExports.useState(null);return reactExports.useEffect(()=>{if(e!=null&&e.id){const zt=lookup(backend_rtc,{query:{cod_usuario:e==null?void 0:e.id},reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4});Vt(zt)}},[e]),reactExports.useEffect(()=>{j&&j.on("connect",()=>{const zt=e==null?void 0:e.id;j.emit("registerUser",zt)})},[j]),jsxRuntimeExports.jsx(SocketContext.Provider,{value:{socket:j},children:_})};function useSocket(){return reactExports.useContext(SocketContext)}const AppLayout=({children:_,showSearchBar:e,searchBarPlaceHolder:j,onSearch:Vt})=>{const{signOut:zt,user:_r}=useAuth(),[_o,ga]=reactExports.useState(!1),[_a,_l]=reactExports.useState([]),{socket:_d}=useSocket(),[_f,_m]=reactExports.useState(null),[tE,rE]=reactExports.useState(null),oE=useNavigate(),dE=()=>{tE||ga(lE=>!lE)},nE=(lE,EE,wE)=>{_m(wE),_d.emit("request to join meeting",{user:lE,host:EE}),rE("Solicitao enviada. Aguarde que seja aceite")},sE=()=>{oE("/createorjointomeeting/"+_f)};return reactExports.useEffect(()=>{_d.on("new invitation",({channel:lE,appId:EE,token:wE,cod_meeting:IE,user:_E,host:kE})=>{_l(ME=>[...ME,{room:lE,appId:EE,token:wE,cod_meeting:IE,user:_E,host:kE}])}),_d.on("response to join meeting",({feedback:lE})=>{lE==1?(rE(null),sE()):rE("Sua solicitao no foi aprovada!")})},[_f]),jsxRuntimeExports.jsxs("div",{className:"flex h-screen overflow-hidden bg-graywhite-300",children:[jsxRuntimeExports.jsx("nav",{className:"w-20",children:jsxRuntimeExports.jsxs("ul",{className:"w-full justify-center flex flex-col items-center pt-4",children:[jsxRuntimeExports.jsx("li",{className:"mb-4 flex justify-center",children:jsxRuntimeExports.jsx(Link,{to:"/",title:"Incio",children:jsxRuntimeExports.jsx("img",{src:logo,height:55,width:55})})}),jsxRuntimeExports.jsx("li",{className:"mb-4 flex justify-center items-center shadow-lg rounded-full w-14 h-14 hover:bg-primary active:bg-primary",children:jsxRuntimeExports.jsx(Link,{to:"/",title:"Incio",children:jsxRuntimeExports.jsx(H,{size:32,className:"hover:text-white"})})}),jsxRuntimeExports.jsx("li",{className:"mb-4 flex justify-center items-center shadow-lg rounded-full w-14 h-14 hover:bg-primary",children:jsxRuntimeExports.jsx(Link,{to:"/createorjointomeeting",children:jsxRuntimeExports.jsx(I,{size:32,className:"hover:text-white"})})}),jsxRuntimeExports.jsx("li",{className:"mb-4 flex justify-center items-center shadow-lg rounded-full w-14 h-14 hover:bg-primary",children:jsxRuntimeExports.jsx(Link,{to:"/conversations",children:jsxRuntimeExports.jsx(w$4,{size:32,className:"hover:text-white"})})}),jsxRuntimeExports.jsx("li",{className:"mb-4 flex justify-center items-center shadow-lg rounded-full w-14 h-14 hover:bg-primary",children:jsxRuntimeExports.jsx("button",{onClick:zt,children:jsxRuntimeExports.jsx(w,{size:32,className:"hover:text-white"})})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col h-full  bg-white bg-opacity-10 shadow-2xl",children:[jsxRuntimeExports.jsxs("header",{className:"flex justify-between items-center p-4 relative",children:[jsxRuntimeExports.jsx("h1",{className:"font-bold",children:"Mocho"}),e&&jsxRuntimeExports.jsxs("div",{className:"bg-white h-fit p-1 rounded-lg w-96 justify-between md:flex hidden",children:[jsxRuntimeExports.jsx("input",{className:"outline-none",type:"search",name:"search",onChange:Vt,id:"search",placeholder:j}),jsxRuntimeExports.jsx("button",{type:"button",children:jsxRuntimeExports.jsx(w$2,{size:22,className:"hover:text-graywhite-600 text-graywhite-300"})})]}),jsxRuntimeExports.jsxs("div",{className:"relative flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:(_r==null?void 0:_r.nome)+" "+(_r==null?void 0:_r.sobrenome)}),jsxRuntimeExports.jsx("img",{src:userplaceholderimage,alt:"user photo",className:"rounded-full w-10 h-10 object-cover"}),jsxRuntimeExports.jsx("div",{className:"bg-green-500 h-3 w-3 rounded-full absolute top-1 right-8"}),jsxRuntimeExports.jsxs("button",{onClick:dE,className:"relative",children:[jsxRuntimeExports.jsx("h3",{className:"bg-primary text-white justify-center h-5 w-5 flex items-center text-xs p-1 rounded-full absolute -top-1 -right-1",children:_a.length}),jsxRuntimeExports.jsx(I$3,{size:30})]})]}),_o&&jsxRuntimeExports.jsxs("div",{className:"bg-primary h-52 w-96 absolute -bottom-52 rounded-md p-2 z-10 right-0 overflow-auto",children:[jsxRuntimeExports.jsx("p",{className:"text-white mb-4",children:"Notificaes"}),jsxRuntimeExports.jsx("ul",{children:_a.map(lE=>jsxRuntimeExports.jsxs("li",{className:"flex justify-between items-center bg-white p-2 rounded-md mb-2",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[lE.user.nome+" "+lE.user.sobrenome," convidado-o para uma reunio."]}),jsxRuntimeExports.jsx("button",{onClick:()=>nE(_r,lE.user.id,lE.room),className:"bg-green-600 w-24 h-50 rounded-md ml-4 p-2 text-white text-sm",children:"Entrar"})]}))})]}),tE&&jsxRuntimeExports.jsxs("div",{className:"bg-primary h-52 w-96 absolute -bottom-52 rounded-md p-2 z-10 right-0 overflow-auto flex flex-col",children:[jsxRuntimeExports.jsx("button",{className:"text-red-300 text-2xl font-bold text-center self-end pr-2",onClick:()=>rE(null),children:jsxRuntimeExports.jsx("span",{children:"x"})}),jsxRuntimeExports.jsx("p",{className:"text-white text-lg mt-8 font-bold",children:tE})]})]}),_,jsxRuntimeExports.jsx("footer",{children:jsxRuntimeExports.jsx("h1",{className:"font-bold text-center py-2",children:" Todos direitos reservados ao SISM - 2024"})})]})]})};function isObject$3(_){return _!==null&&typeof _=="object"&&"constructor"in _&&_.constructor===Object}function extend$3(_,e){_===void 0&&(_={}),e===void 0&&(e={}),Object.keys(e).forEach(j=>{typeof _[j]>"u"?_[j]=e[j]:isObject$3(e[j])&&isObject$3(_[j])&&Object.keys(e[j]).length>0&&extend$3(_[j],e[j])})}const ssrDocument={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function getDocument(){const _=typeof document<"u"?document:{};return extend$3(_,ssrDocument),_}const ssrWindow={document:ssrDocument,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(_){return typeof setTimeout>"u"?(_(),null):setTimeout(_,0)},cancelAnimationFrame(_){typeof setTimeout>"u"||clearTimeout(_)}};function getWindow(){const _=typeof window<"u"?window:{};return extend$3(_,ssrWindow),_}function classesToTokens(_){return _===void 0&&(_=""),_.trim().split(" ").filter(e=>!!e.trim())}function deleteProps(_){const e=_;Object.keys(e).forEach(j=>{try{e[j]=null}catch{}try{delete e[j]}catch{}})}function nextTick(_,e){return e===void 0&&(e=0),setTimeout(_,e)}function now(){return Date.now()}function getComputedStyle$1(_){const e=getWindow();let j;return e.getComputedStyle&&(j=e.getComputedStyle(_,null)),!j&&_.currentStyle&&(j=_.currentStyle),j||(j=_.style),j}function getTranslate(_,e){e===void 0&&(e="x");const j=getWindow();let Vt,zt,_r;const _o=getComputedStyle$1(_);return j.WebKitCSSMatrix?(zt=_o.transform||_o.webkitTransform,zt.split(",").length>6&&(zt=zt.split(", ").map(ga=>ga.replace(",",".")).join(", ")),_r=new j.WebKitCSSMatrix(zt==="none"?"":zt)):(_r=_o.MozTransform||_o.OTransform||_o.MsTransform||_o.msTransform||_o.transform||_o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),Vt=_r.toString().split(",")),e==="x"&&(j.WebKitCSSMatrix?zt=_r.m41:Vt.length===16?zt=parseFloat(Vt[12]):zt=parseFloat(Vt[4])),e==="y"&&(j.WebKitCSSMatrix?zt=_r.m42:Vt.length===16?zt=parseFloat(Vt[13]):zt=parseFloat(Vt[5])),zt||0}function isObject$2(_){return typeof _=="object"&&_!==null&&_.constructor&&Object.prototype.toString.call(_).slice(8,-1)==="Object"}function isNode(_){return typeof window<"u"&&typeof window.HTMLElement<"u"?_ instanceof HTMLElement:_&&(_.nodeType===1||_.nodeType===11)}function extend$2(){const _=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let j=1;j<arguments.length;j+=1){const Vt=j<0||arguments.length<=j?void 0:arguments[j];if(Vt!=null&&!isNode(Vt)){const zt=Object.keys(Object(Vt)).filter(_r=>e.indexOf(_r)<0);for(let _r=0,_o=zt.length;_r<_o;_r+=1){const ga=zt[_r],_a=Object.getOwnPropertyDescriptor(Vt,ga);_a!==void 0&&_a.enumerable&&(isObject$2(_[ga])&&isObject$2(Vt[ga])?Vt[ga].__swiper__?_[ga]=Vt[ga]:extend$2(_[ga],Vt[ga]):!isObject$2(_[ga])&&isObject$2(Vt[ga])?(_[ga]={},Vt[ga].__swiper__?_[ga]=Vt[ga]:extend$2(_[ga],Vt[ga])):_[ga]=Vt[ga])}}}return _}function setCSSProperty(_,e,j){_.style.setProperty(e,j)}function animateCSSModeScroll(_){let{swiper:e,targetPosition:j,side:Vt}=_;const zt=getWindow(),_r=-e.translate;let _o=null,ga;const _a=e.params.speed;e.wrapperEl.style.scrollSnapType="none",zt.cancelAnimationFrame(e.cssModeFrameID);const _l=j>_r?"next":"prev",_d=(_m,tE)=>_l==="next"&&_m>=tE||_l==="prev"&&_m<=tE,_f=()=>{ga=new Date().getTime(),_o===null&&(_o=ga);const _m=Math.max(Math.min((ga-_o)/_a,1),0),tE=.5-Math.cos(_m*Math.PI)/2;let rE=_r+tE*(j-_r);if(_d(rE,j)&&(rE=j),e.wrapperEl.scrollTo({[Vt]:rE}),_d(rE,j)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[Vt]:rE})}),zt.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=zt.requestAnimationFrame(_f)};_f()}function getSlideTransformEl(_){return _.querySelector(".swiper-slide-transform")||_.shadowRoot&&_.shadowRoot.querySelector(".swiper-slide-transform")||_}function elementChildren(_,e){return e===void 0&&(e=""),[..._.children].filter(j=>j.matches(e))}function showWarning(_){try{console.warn(_);return}catch{}}function createElement(_,e){e===void 0&&(e=[]);const j=document.createElement(_);return j.classList.add(...Array.isArray(e)?e:classesToTokens(e)),j}function elementOffset(_){const e=getWindow(),j=getDocument(),Vt=_.getBoundingClientRect(),zt=j.body,_r=_.clientTop||zt.clientTop||0,_o=_.clientLeft||zt.clientLeft||0,ga=_===e?e.scrollY:_.scrollTop,_a=_===e?e.scrollX:_.scrollLeft;return{top:Vt.top+ga-_r,left:Vt.left+_a-_o}}function elementPrevAll(_,e){const j=[];for(;_.previousElementSibling;){const Vt=_.previousElementSibling;e?Vt.matches(e)&&j.push(Vt):j.push(Vt),_=Vt}return j}function elementNextAll(_,e){const j=[];for(;_.nextElementSibling;){const Vt=_.nextElementSibling;e?Vt.matches(e)&&j.push(Vt):j.push(Vt),_=Vt}return j}function elementStyle(_,e){return getWindow().getComputedStyle(_,null).getPropertyValue(e)}function elementIndex(_){let e=_,j;if(e){for(j=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(j+=1);return j}}function elementParents(_,e){const j=[];let Vt=_.parentElement;for(;Vt;)e?Vt.matches(e)&&j.push(Vt):j.push(Vt),Vt=Vt.parentElement;return j}function elementTransitionEnd(_,e){function j(Vt){Vt.target===_&&(e.call(_,Vt),_.removeEventListener("transitionend",j))}e&&_.addEventListener("transitionend",j)}function elementOuterSize(_,e,j){const Vt=getWindow();return _[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(Vt.getComputedStyle(_,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(Vt.getComputedStyle(_,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom"))}function makeElementsArray(_){return(Array.isArray(_)?_:[_]).filter(e=>!!e)}let support;function calcSupport(){const _=getWindow(),e=getDocument();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in _||_.DocumentTouch&&e instanceof _.DocumentTouch)}}function getSupport(){return support||(support=calcSupport()),support}let deviceCached;function calcDevice(_){let{userAgent:e}=_===void 0?{}:_;const j=getSupport(),Vt=getWindow(),zt=Vt.navigator.platform,_r=e||Vt.navigator.userAgent,_o={ios:!1,android:!1},ga=Vt.screen.width,_a=Vt.screen.height,_l=_r.match(/(Android);?[\s\/]+([\d.]+)?/);let _d=_r.match(/(iPad).*OS\s([\d_]+)/);const _f=_r.match(/(iPod)(.*OS\s([\d_]+))?/),_m=!_d&&_r.match(/(iPhone\sOS|iOS)\s([\d_]+)/),tE=zt==="Win32";let rE=zt==="MacIntel";const oE=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!_d&&rE&&j.touch&&oE.indexOf(`${ga}x${_a}`)>=0&&(_d=_r.match(/(Version)\/([\d.]+)/),_d||(_d=[0,1,"13_0_0"]),rE=!1),_l&&!tE&&(_o.os="android",_o.android=!0),(_d||_m||_f)&&(_o.os="ios",_o.ios=!0),_o}function getDevice(_){return _===void 0&&(_={}),deviceCached||(deviceCached=calcDevice(_)),deviceCached}let browser;function calcBrowser(){const _=getWindow(),e=getDevice();let j=!1;function Vt(){const ga=_.navigator.userAgent.toLowerCase();return ga.indexOf("safari")>=0&&ga.indexOf("chrome")<0&&ga.indexOf("android")<0}if(Vt()){const ga=String(_.navigator.userAgent);if(ga.includes("Version/")){const[_a,_l]=ga.split("Version/")[1].split(" ")[0].split(".").map(_d=>Number(_d));j=_a<16||_a===16&&_l<2}}const zt=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(_.navigator.userAgent),_r=Vt(),_o=_r||zt&&e.ios;return{isSafari:j||_r,needPerspectiveFix:j,need3dFix:_o,isWebView:zt}}function getBrowser(){return browser||(browser=calcBrowser()),browser}function Resize(_){let{swiper:e,on:j,emit:Vt}=_;const zt=getWindow();let _r=null,_o=null;const ga=()=>{!e||e.destroyed||!e.initialized||(Vt("beforeResize"),Vt("resize"))},_a=()=>{!e||e.destroyed||!e.initialized||(_r=new ResizeObserver(_f=>{_o=zt.requestAnimationFrame(()=>{const{width:_m,height:tE}=e;let rE=_m,oE=tE;_f.forEach(dE=>{let{contentBoxSize:nE,contentRect:sE,target:lE}=dE;lE&&lE!==e.el||(rE=sE?sE.width:(nE[0]||nE).inlineSize,oE=sE?sE.height:(nE[0]||nE).blockSize)}),(rE!==_m||oE!==tE)&&ga()})}),_r.observe(e.el))},_l=()=>{_o&&zt.cancelAnimationFrame(_o),_r&&_r.unobserve&&e.el&&(_r.unobserve(e.el),_r=null)},_d=()=>{!e||e.destroyed||!e.initialized||Vt("orientationchange")};j("init",()=>{if(e.params.resizeObserver&&typeof zt.ResizeObserver<"u"){_a();return}zt.addEventListener("resize",ga),zt.addEventListener("orientationchange",_d)}),j("destroy",()=>{_l(),zt.removeEventListener("resize",ga),zt.removeEventListener("orientationchange",_d)})}function Observer(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r=[],_o=getWindow(),ga=function(_d,_f){_f===void 0&&(_f={});const _m=_o.MutationObserver||_o.WebkitMutationObserver,tE=new _m(rE=>{if(e.__preventObserver__)return;if(rE.length===1){zt("observerUpdate",rE[0]);return}const oE=function(){zt("observerUpdate",rE[0])};_o.requestAnimationFrame?_o.requestAnimationFrame(oE):_o.setTimeout(oE,0)});tE.observe(_d,{attributes:typeof _f.attributes>"u"?!0:_f.attributes,childList:typeof _f.childList>"u"?!0:_f.childList,characterData:typeof _f.characterData>"u"?!0:_f.characterData}),_r.push(tE)},_a=()=>{if(e.params.observer){if(e.params.observeParents){const _d=elementParents(e.hostEl);for(let _f=0;_f<_d.length;_f+=1)ga(_d[_f])}ga(e.hostEl,{childList:e.params.observeSlideChildren}),ga(e.wrapperEl,{attributes:!1})}},_l=()=>{_r.forEach(_d=>{_d.disconnect()}),_r.splice(0,_r.length)};j({observer:!1,observeParents:!1,observeSlideChildren:!1}),Vt("init",_a),Vt("destroy",_l)}var eventsEmitter={on(_,e,j){const Vt=this;if(!Vt.eventsListeners||Vt.destroyed||typeof e!="function")return Vt;const zt=j?"unshift":"push";return _.split(" ").forEach(_r=>{Vt.eventsListeners[_r]||(Vt.eventsListeners[_r]=[]),Vt.eventsListeners[_r][zt](e)}),Vt},once(_,e,j){const Vt=this;if(!Vt.eventsListeners||Vt.destroyed||typeof e!="function")return Vt;function zt(){Vt.off(_,zt),zt.__emitterProxy&&delete zt.__emitterProxy;for(var _r=arguments.length,_o=new Array(_r),ga=0;ga<_r;ga++)_o[ga]=arguments[ga];e.apply(Vt,_o)}return zt.__emitterProxy=e,Vt.on(_,zt,j)},onAny(_,e){const j=this;if(!j.eventsListeners||j.destroyed||typeof _!="function")return j;const Vt=e?"unshift":"push";return j.eventsAnyListeners.indexOf(_)<0&&j.eventsAnyListeners[Vt](_),j},offAny(_){const e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;const j=e.eventsAnyListeners.indexOf(_);return j>=0&&e.eventsAnyListeners.splice(j,1),e},off(_,e){const j=this;return!j.eventsListeners||j.destroyed||!j.eventsListeners||_.split(" ").forEach(Vt=>{typeof e>"u"?j.eventsListeners[Vt]=[]:j.eventsListeners[Vt]&&j.eventsListeners[Vt].forEach((zt,_r)=>{(zt===e||zt.__emitterProxy&&zt.__emitterProxy===e)&&j.eventsListeners[Vt].splice(_r,1)})}),j},emit(){const _=this;if(!_.eventsListeners||_.destroyed||!_.eventsListeners)return _;let e,j,Vt;for(var zt=arguments.length,_r=new Array(zt),_o=0;_o<zt;_o++)_r[_o]=arguments[_o];return typeof _r[0]=="string"||Array.isArray(_r[0])?(e=_r[0],j=_r.slice(1,_r.length),Vt=_):(e=_r[0].events,j=_r[0].data,Vt=_r[0].context||_),j.unshift(Vt),(Array.isArray(e)?e:e.split(" ")).forEach(_a=>{_.eventsAnyListeners&&_.eventsAnyListeners.length&&_.eventsAnyListeners.forEach(_l=>{_l.apply(Vt,[_a,...j])}),_.eventsListeners&&_.eventsListeners[_a]&&_.eventsListeners[_a].forEach(_l=>{_l.apply(Vt,j)})}),_}};function updateSize(){const _=this;let e,j;const Vt=_.el;typeof _.params.width<"u"&&_.params.width!==null?e=_.params.width:e=Vt.clientWidth,typeof _.params.height<"u"&&_.params.height!==null?j=_.params.height:j=Vt.clientHeight,!(e===0&&_.isHorizontal()||j===0&&_.isVertical())&&(e=e-parseInt(elementStyle(Vt,"padding-left")||0,10)-parseInt(elementStyle(Vt,"padding-right")||0,10),j=j-parseInt(elementStyle(Vt,"padding-top")||0,10)-parseInt(elementStyle(Vt,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(j)&&(j=0),Object.assign(_,{width:e,height:j,size:_.isHorizontal()?e:j}))}function updateSlides(){const _=this;function e(bE,LE){return parseFloat(bE.getPropertyValue(_.getDirectionLabel(LE))||0)}const j=_.params,{wrapperEl:Vt,slidesEl:zt,size:_r,rtlTranslate:_o,wrongRTL:ga}=_,_a=_.virtual&&j.virtual.enabled,_l=_a?_.virtual.slides.length:_.slides.length,_d=elementChildren(zt,`.${_.params.slideClass}, swiper-slide`),_f=_a?_.virtual.slides.length:_d.length;let _m=[];const tE=[],rE=[];let oE=j.slidesOffsetBefore;typeof oE=="function"&&(oE=j.slidesOffsetBefore.call(_));let dE=j.slidesOffsetAfter;typeof dE=="function"&&(dE=j.slidesOffsetAfter.call(_));const nE=_.snapGrid.length,sE=_.slidesGrid.length;let lE=j.spaceBetween,EE=-oE,wE=0,IE=0;if(typeof _r>"u")return;typeof lE=="string"&&lE.indexOf("%")>=0?lE=parseFloat(lE.replace("%",""))/100*_r:typeof lE=="string"&&(lE=parseFloat(lE)),_.virtualSize=-lE,_d.forEach(bE=>{_o?bE.style.marginLeft="":bE.style.marginRight="",bE.style.marginBottom="",bE.style.marginTop=""}),j.centeredSlides&&j.cssMode&&(setCSSProperty(Vt,"--swiper-centered-offset-before",""),setCSSProperty(Vt,"--swiper-centered-offset-after",""));const _E=j.grid&&j.grid.rows>1&&_.grid;_E?_.grid.initSlides(_d):_.grid&&_.grid.unsetSlides();let kE;const ME=j.slidesPerView==="auto"&&j.breakpoints&&Object.keys(j.breakpoints).filter(bE=>typeof j.breakpoints[bE].slidesPerView<"u").length>0;for(let bE=0;bE<_f;bE+=1){kE=0;let LE;if(_d[bE]&&(LE=_d[bE]),_E&&_.grid.updateSlide(bE,LE,_d),!(_d[bE]&&elementStyle(LE,"display")==="none")){if(j.slidesPerView==="auto"){ME&&(_d[bE].style[_.getDirectionLabel("width")]="");const TE=getComputedStyle(LE),OE=LE.style.transform,vE=LE.style.webkitTransform;if(OE&&(LE.style.transform="none"),vE&&(LE.style.webkitTransform="none"),j.roundLengths)kE=_.isHorizontal()?elementOuterSize(LE,"width"):elementOuterSize(LE,"height");else{const NE=e(TE,"width"),jE=e(TE,"padding-left"),UE=e(TE,"padding-right"),RE=e(TE,"margin-left"),FE=e(TE,"margin-right"),VE=TE.getPropertyValue("box-sizing");if(VE&&VE==="border-box")kE=NE+RE+FE;else{const{clientWidth:BE,offsetWidth:qE}=LE;kE=NE+jE+UE+RE+FE+(qE-BE)}}OE&&(LE.style.transform=OE),vE&&(LE.style.webkitTransform=vE),j.roundLengths&&(kE=Math.floor(kE))}else kE=(_r-(j.slidesPerView-1)*lE)/j.slidesPerView,j.roundLengths&&(kE=Math.floor(kE)),_d[bE]&&(_d[bE].style[_.getDirectionLabel("width")]=`${kE}px`);_d[bE]&&(_d[bE].swiperSlideSize=kE),rE.push(kE),j.centeredSlides?(EE=EE+kE/2+wE/2+lE,wE===0&&bE!==0&&(EE=EE-_r/2-lE),bE===0&&(EE=EE-_r/2-lE),Math.abs(EE)<1/1e3&&(EE=0),j.roundLengths&&(EE=Math.floor(EE)),IE%j.slidesPerGroup===0&&_m.push(EE),tE.push(EE)):(j.roundLengths&&(EE=Math.floor(EE)),(IE-Math.min(_.params.slidesPerGroupSkip,IE))%_.params.slidesPerGroup===0&&_m.push(EE),tE.push(EE),EE=EE+kE+lE),_.virtualSize+=kE+lE,wE=kE,IE+=1}}if(_.virtualSize=Math.max(_.virtualSize,_r)+dE,_o&&ga&&(j.effect==="slide"||j.effect==="coverflow")&&(Vt.style.width=`${_.virtualSize+lE}px`),j.setWrapperSize&&(Vt.style[_.getDirectionLabel("width")]=`${_.virtualSize+lE}px`),_E&&_.grid.updateWrapperSize(kE,_m),!j.centeredSlides){const bE=[];for(let LE=0;LE<_m.length;LE+=1){let TE=_m[LE];j.roundLengths&&(TE=Math.floor(TE)),_m[LE]<=_.virtualSize-_r&&bE.push(TE)}_m=bE,Math.floor(_.virtualSize-_r)-Math.floor(_m[_m.length-1])>1&&_m.push(_.virtualSize-_r)}if(_a&&j.loop){const bE=rE[0]+lE;if(j.slidesPerGroup>1){const LE=Math.ceil((_.virtual.slidesBefore+_.virtual.slidesAfter)/j.slidesPerGroup),TE=bE*j.slidesPerGroup;for(let OE=0;OE<LE;OE+=1)_m.push(_m[_m.length-1]+TE)}for(let LE=0;LE<_.virtual.slidesBefore+_.virtual.slidesAfter;LE+=1)j.slidesPerGroup===1&&_m.push(_m[_m.length-1]+bE),tE.push(tE[tE.length-1]+bE),_.virtualSize+=bE}if(_m.length===0&&(_m=[0]),lE!==0){const bE=_.isHorizontal()&&_o?"marginLeft":_.getDirectionLabel("marginRight");_d.filter((LE,TE)=>!j.cssMode||j.loop?!0:TE!==_d.length-1).forEach(LE=>{LE.style[bE]=`${lE}px`})}if(j.centeredSlides&&j.centeredSlidesBounds){let bE=0;rE.forEach(TE=>{bE+=TE+(lE||0)}),bE-=lE;const LE=bE-_r;_m=_m.map(TE=>TE<=0?-oE:TE>LE?LE+dE:TE)}if(j.centerInsufficientSlides){let bE=0;rE.forEach(TE=>{bE+=TE+(lE||0)}),bE-=lE;const LE=(j.slidesOffsetBefore||0)+(j.slidesOffsetAfter||0);if(bE+LE<_r){const TE=(_r-bE-LE)/2;_m.forEach((OE,vE)=>{_m[vE]=OE-TE}),tE.forEach((OE,vE)=>{tE[vE]=OE+TE})}}if(Object.assign(_,{slides:_d,snapGrid:_m,slidesGrid:tE,slidesSizesGrid:rE}),j.centeredSlides&&j.cssMode&&!j.centeredSlidesBounds){setCSSProperty(Vt,"--swiper-centered-offset-before",`${-_m[0]}px`),setCSSProperty(Vt,"--swiper-centered-offset-after",`${_.size/2-rE[rE.length-1]/2}px`);const bE=-_.snapGrid[0],LE=-_.slidesGrid[0];_.snapGrid=_.snapGrid.map(TE=>TE+bE),_.slidesGrid=_.slidesGrid.map(TE=>TE+LE)}if(_f!==_l&&_.emit("slidesLengthChange"),_m.length!==nE&&(_.params.watchOverflow&&_.checkOverflow(),_.emit("snapGridLengthChange")),tE.length!==sE&&_.emit("slidesGridLengthChange"),j.watchSlidesProgress&&_.updateSlidesOffset(),_.emit("slidesUpdated"),!_a&&!j.cssMode&&(j.effect==="slide"||j.effect==="fade")){const bE=`${j.containerModifierClass}backface-hidden`,LE=_.el.classList.contains(bE);_f<=j.maxBackfaceHiddenSlides?LE||_.el.classList.add(bE):LE&&_.el.classList.remove(bE)}}function updateAutoHeight(_){const e=this,j=[],Vt=e.virtual&&e.params.virtual.enabled;let zt=0,_r;typeof _=="number"?e.setTransition(_):_===!0&&e.setTransition(e.params.speed);const _o=ga=>Vt?e.slides[e.getSlideIndexByData(ga)]:e.slides[ga];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(ga=>{j.push(ga)});else for(_r=0;_r<Math.ceil(e.params.slidesPerView);_r+=1){const ga=e.activeIndex+_r;if(ga>e.slides.length&&!Vt)break;j.push(_o(ga))}else j.push(_o(e.activeIndex));for(_r=0;_r<j.length;_r+=1)if(typeof j[_r]<"u"){const ga=j[_r].offsetHeight;zt=ga>zt?ga:zt}(zt||zt===0)&&(e.wrapperEl.style.height=`${zt}px`)}function updateSlidesOffset(){const _=this,e=_.slides,j=_.isElement?_.isHorizontal()?_.wrapperEl.offsetLeft:_.wrapperEl.offsetTop:0;for(let Vt=0;Vt<e.length;Vt+=1)e[Vt].swiperSlideOffset=(_.isHorizontal()?e[Vt].offsetLeft:e[Vt].offsetTop)-j-_.cssOverflowAdjustment()}const toggleSlideClasses$1=(_,e,j)=>{e&&!_.classList.contains(j)?_.classList.add(j):!e&&_.classList.contains(j)&&_.classList.remove(j)};function updateSlidesProgress(_){_===void 0&&(_=this&&this.translate||0);const e=this,j=e.params,{slides:Vt,rtlTranslate:zt,snapGrid:_r}=e;if(Vt.length===0)return;typeof Vt[0].swiperSlideOffset>"u"&&e.updateSlidesOffset();let _o=-_;zt&&(_o=_),e.visibleSlidesIndexes=[],e.visibleSlides=[];let ga=j.spaceBetween;typeof ga=="string"&&ga.indexOf("%")>=0?ga=parseFloat(ga.replace("%",""))/100*e.size:typeof ga=="string"&&(ga=parseFloat(ga));for(let _a=0;_a<Vt.length;_a+=1){const _l=Vt[_a];let _d=_l.swiperSlideOffset;j.cssMode&&j.centeredSlides&&(_d-=Vt[0].swiperSlideOffset);const _f=(_o+(j.centeredSlides?e.minTranslate():0)-_d)/(_l.swiperSlideSize+ga),_m=(_o-_r[0]+(j.centeredSlides?e.minTranslate():0)-_d)/(_l.swiperSlideSize+ga),tE=-(_o-_d),rE=tE+e.slidesSizesGrid[_a],oE=tE>=0&&tE<=e.size-e.slidesSizesGrid[_a],dE=tE>=0&&tE<e.size-1||rE>1&&rE<=e.size||tE<=0&&rE>=e.size;dE&&(e.visibleSlides.push(_l),e.visibleSlidesIndexes.push(_a)),toggleSlideClasses$1(_l,dE,j.slideVisibleClass),toggleSlideClasses$1(_l,oE,j.slideFullyVisibleClass),_l.progress=zt?-_f:_f,_l.originalProgress=zt?-_m:_m}}function updateProgress(_){const e=this;if(typeof _>"u"){const _d=e.rtlTranslate?-1:1;_=e&&e.translate&&e.translate*_d||0}const j=e.params,Vt=e.maxTranslate()-e.minTranslate();let{progress:zt,isBeginning:_r,isEnd:_o,progressLoop:ga}=e;const _a=_r,_l=_o;if(Vt===0)zt=0,_r=!0,_o=!0;else{zt=(_-e.minTranslate())/Vt;const _d=Math.abs(_-e.minTranslate())<1,_f=Math.abs(_-e.maxTranslate())<1;_r=_d||zt<=0,_o=_f||zt>=1,_d&&(zt=0),_f&&(zt=1)}if(j.loop){const _d=e.getSlideIndexByData(0),_f=e.getSlideIndexByData(e.slides.length-1),_m=e.slidesGrid[_d],tE=e.slidesGrid[_f],rE=e.slidesGrid[e.slidesGrid.length-1],oE=Math.abs(_);oE>=_m?ga=(oE-_m)/rE:ga=(oE+rE-tE)/rE,ga>1&&(ga-=1)}Object.assign(e,{progress:zt,progressLoop:ga,isBeginning:_r,isEnd:_o}),(j.watchSlidesProgress||j.centeredSlides&&j.autoHeight)&&e.updateSlidesProgress(_),_r&&!_a&&e.emit("reachBeginning toEdge"),_o&&!_l&&e.emit("reachEnd toEdge"),(_a&&!_r||_l&&!_o)&&e.emit("fromEdge"),e.emit("progress",zt)}const toggleSlideClasses=(_,e,j)=>{e&&!_.classList.contains(j)?_.classList.add(j):!e&&_.classList.contains(j)&&_.classList.remove(j)};function updateSlidesClasses(){const _=this,{slides:e,params:j,slidesEl:Vt,activeIndex:zt}=_,_r=_.virtual&&j.virtual.enabled,_o=_.grid&&j.grid&&j.grid.rows>1,ga=_f=>elementChildren(Vt,`.${j.slideClass}${_f}, swiper-slide${_f}`)[0];let _a,_l,_d;if(_r)if(j.loop){let _f=zt-_.virtual.slidesBefore;_f<0&&(_f=_.virtual.slides.length+_f),_f>=_.virtual.slides.length&&(_f-=_.virtual.slides.length),_a=ga(`[data-swiper-slide-index="${_f}"]`)}else _a=ga(`[data-swiper-slide-index="${zt}"]`);else _o?(_a=e.filter(_f=>_f.column===zt)[0],_d=e.filter(_f=>_f.column===zt+1)[0],_l=e.filter(_f=>_f.column===zt-1)[0]):_a=e[zt];_a&&(_o||(_d=elementNextAll(_a,`.${j.slideClass}, swiper-slide`)[0],j.loop&&!_d&&(_d=e[0]),_l=elementPrevAll(_a,`.${j.slideClass}, swiper-slide`)[0],j.loop&&!_l===0&&(_l=e[e.length-1]))),e.forEach(_f=>{toggleSlideClasses(_f,_f===_a,j.slideActiveClass),toggleSlideClasses(_f,_f===_d,j.slideNextClass),toggleSlideClasses(_f,_f===_l,j.slidePrevClass)}),_.emitSlidesClasses()}const processLazyPreloader=(_,e)=>{if(!_||_.destroyed||!_.params)return;const j=()=>_.isElement?"swiper-slide":`.${_.params.slideClass}`,Vt=e.closest(j());if(Vt){let zt=Vt.querySelector(`.${_.params.lazyPreloaderClass}`);!zt&&_.isElement&&(Vt.shadowRoot?zt=Vt.shadowRoot.querySelector(`.${_.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{Vt.shadowRoot&&(zt=Vt.shadowRoot.querySelector(`.${_.params.lazyPreloaderClass}`),zt&&zt.remove())})),zt&&zt.remove()}},unlazy=(_,e)=>{if(!_.slides[e])return;const j=_.slides[e].querySelector('[loading="lazy"]');j&&j.removeAttribute("loading")},preload=_=>{if(!_||_.destroyed||!_.params)return;let e=_.params.lazyPreloadPrevNext;const j=_.slides.length;if(!j||!e||e<0)return;e=Math.min(e,j);const Vt=_.params.slidesPerView==="auto"?_.slidesPerViewDynamic():Math.ceil(_.params.slidesPerView),zt=_.activeIndex;if(_.params.grid&&_.params.grid.rows>1){const _o=zt,ga=[_o-e];ga.push(...Array.from({length:e}).map((_a,_l)=>_o+Vt+_l)),_.slides.forEach((_a,_l)=>{ga.includes(_a.column)&&unlazy(_,_l)});return}const _r=zt+Vt-1;if(_.params.rewind||_.params.loop)for(let _o=zt-e;_o<=_r+e;_o+=1){const ga=(_o%j+j)%j;(ga<zt||ga>_r)&&unlazy(_,ga)}else for(let _o=Math.max(zt-e,0);_o<=Math.min(_r+e,j-1);_o+=1)_o!==zt&&(_o>_r||_o<zt)&&unlazy(_,_o)};function getActiveIndexByTranslate(_){const{slidesGrid:e,params:j}=_,Vt=_.rtlTranslate?_.translate:-_.translate;let zt;for(let _r=0;_r<e.length;_r+=1)typeof e[_r+1]<"u"?Vt>=e[_r]&&Vt<e[_r+1]-(e[_r+1]-e[_r])/2?zt=_r:Vt>=e[_r]&&Vt<e[_r+1]&&(zt=_r+1):Vt>=e[_r]&&(zt=_r);return j.normalizeSlideIndex&&(zt<0||typeof zt>"u")&&(zt=0),zt}function updateActiveIndex(_){const e=this,j=e.rtlTranslate?e.translate:-e.translate,{snapGrid:Vt,params:zt,activeIndex:_r,realIndex:_o,snapIndex:ga}=e;let _a=_,_l;const _d=tE=>{let rE=tE-e.virtual.slidesBefore;return rE<0&&(rE=e.virtual.slides.length+rE),rE>=e.virtual.slides.length&&(rE-=e.virtual.slides.length),rE};if(typeof _a>"u"&&(_a=getActiveIndexByTranslate(e)),Vt.indexOf(j)>=0)_l=Vt.indexOf(j);else{const tE=Math.min(zt.slidesPerGroupSkip,_a);_l=tE+Math.floor((_a-tE)/zt.slidesPerGroup)}if(_l>=Vt.length&&(_l=Vt.length-1),_a===_r&&!e.params.loop){_l!==ga&&(e.snapIndex=_l,e.emit("snapIndexChange"));return}if(_a===_r&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=_d(_a);return}const _f=e.grid&&zt.grid&&zt.grid.rows>1;let _m;if(e.virtual&&zt.virtual.enabled&&zt.loop)_m=_d(_a);else if(_f){const tE=e.slides.filter(oE=>oE.column===_a)[0];let rE=parseInt(tE.getAttribute("data-swiper-slide-index"),10);Number.isNaN(rE)&&(rE=Math.max(e.slides.indexOf(tE),0)),_m=Math.floor(rE/zt.grid.rows)}else if(e.slides[_a]){const tE=e.slides[_a].getAttribute("data-swiper-slide-index");tE?_m=parseInt(tE,10):_m=_a}else _m=_a;Object.assign(e,{previousSnapIndex:ga,snapIndex:_l,previousRealIndex:_o,realIndex:_m,previousIndex:_r,activeIndex:_a}),e.initialized&&preload(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(_o!==_m&&e.emit("realIndexChange"),e.emit("slideChange"))}function updateClickedSlide(_,e){const j=this,Vt=j.params;let zt=_.closest(`.${Vt.slideClass}, swiper-slide`);!zt&&j.isElement&&e&&e.length>1&&e.includes(_)&&[...e.slice(e.indexOf(_)+1,e.length)].forEach(ga=>{!zt&&ga.matches&&ga.matches(`.${Vt.slideClass}, swiper-slide`)&&(zt=ga)});let _r=!1,_o;if(zt){for(let ga=0;ga<j.slides.length;ga+=1)if(j.slides[ga]===zt){_r=!0,_o=ga;break}}if(zt&&_r)j.clickedSlide=zt,j.virtual&&j.params.virtual.enabled?j.clickedIndex=parseInt(zt.getAttribute("data-swiper-slide-index"),10):j.clickedIndex=_o;else{j.clickedSlide=void 0,j.clickedIndex=void 0;return}Vt.slideToClickedSlide&&j.clickedIndex!==void 0&&j.clickedIndex!==j.activeIndex&&j.slideToClickedSlide()}var update={updateSize,updateSlides,updateAutoHeight,updateSlidesOffset,updateSlidesProgress,updateProgress,updateSlidesClasses,updateActiveIndex,updateClickedSlide};function getSwiperTranslate(_){_===void 0&&(_=this.isHorizontal()?"x":"y");const e=this,{params:j,rtlTranslate:Vt,translate:zt,wrapperEl:_r}=e;if(j.virtualTranslate)return Vt?-zt:zt;if(j.cssMode)return zt;let _o=getTranslate(_r,_);return _o+=e.cssOverflowAdjustment(),Vt&&(_o=-_o),_o||0}function setTranslate(_,e){const j=this,{rtlTranslate:Vt,params:zt,wrapperEl:_r,progress:_o}=j;let ga=0,_a=0;const _l=0;j.isHorizontal()?ga=Vt?-_:_:_a=_,zt.roundLengths&&(ga=Math.floor(ga),_a=Math.floor(_a)),j.previousTranslate=j.translate,j.translate=j.isHorizontal()?ga:_a,zt.cssMode?_r[j.isHorizontal()?"scrollLeft":"scrollTop"]=j.isHorizontal()?-ga:-_a:zt.virtualTranslate||(j.isHorizontal()?ga-=j.cssOverflowAdjustment():_a-=j.cssOverflowAdjustment(),_r.style.transform=`translate3d(${ga}px, ${_a}px, ${_l}px)`);let _d;const _f=j.maxTranslate()-j.minTranslate();_f===0?_d=0:_d=(_-j.minTranslate())/_f,_d!==_o&&j.updateProgress(_),j.emit("setTranslate",j.translate,e)}function minTranslate(){return-this.snapGrid[0]}function maxTranslate(){return-this.snapGrid[this.snapGrid.length-1]}function translateTo(_,e,j,Vt,zt){_===void 0&&(_=0),e===void 0&&(e=this.params.speed),j===void 0&&(j=!0),Vt===void 0&&(Vt=!0);const _r=this,{params:_o,wrapperEl:ga}=_r;if(_r.animating&&_o.preventInteractionOnTransition)return!1;const _a=_r.minTranslate(),_l=_r.maxTranslate();let _d;if(Vt&&_>_a?_d=_a:Vt&&_<_l?_d=_l:_d=_,_r.updateProgress(_d),_o.cssMode){const _f=_r.isHorizontal();if(e===0)ga[_f?"scrollLeft":"scrollTop"]=-_d;else{if(!_r.support.smoothScroll)return animateCSSModeScroll({swiper:_r,targetPosition:-_d,side:_f?"left":"top"}),!0;ga.scrollTo({[_f?"left":"top"]:-_d,behavior:"smooth"})}return!0}return e===0?(_r.setTransition(0),_r.setTranslate(_d),j&&(_r.emit("beforeTransitionStart",e,zt),_r.emit("transitionEnd"))):(_r.setTransition(e),_r.setTranslate(_d),j&&(_r.emit("beforeTransitionStart",e,zt),_r.emit("transitionStart")),_r.animating||(_r.animating=!0,_r.onTranslateToWrapperTransitionEnd||(_r.onTranslateToWrapperTransitionEnd=function(_m){!_r||_r.destroyed||_m.target===this&&(_r.wrapperEl.removeEventListener("transitionend",_r.onTranslateToWrapperTransitionEnd),_r.onTranslateToWrapperTransitionEnd=null,delete _r.onTranslateToWrapperTransitionEnd,_r.animating=!1,j&&_r.emit("transitionEnd"))}),_r.wrapperEl.addEventListener("transitionend",_r.onTranslateToWrapperTransitionEnd))),!0}var translate={getTranslate:getSwiperTranslate,setTranslate,minTranslate,maxTranslate,translateTo};function setTransition(_,e){const j=this;j.params.cssMode||(j.wrapperEl.style.transitionDuration=`${_}ms`,j.wrapperEl.style.transitionDelay=_===0?"0ms":""),j.emit("setTransition",_,e)}function transitionEmit(_){let{swiper:e,runCallbacks:j,direction:Vt,step:zt}=_;const{activeIndex:_r,previousIndex:_o}=e;let ga=Vt;if(ga||(_r>_o?ga="next":_r<_o?ga="prev":ga="reset"),e.emit(`transition${zt}`),j&&_r!==_o){if(ga==="reset"){e.emit(`slideResetTransition${zt}`);return}e.emit(`slideChangeTransition${zt}`),ga==="next"?e.emit(`slideNextTransition${zt}`):e.emit(`slidePrevTransition${zt}`)}}function transitionStart(_,e){_===void 0&&(_=!0);const j=this,{params:Vt}=j;Vt.cssMode||(Vt.autoHeight&&j.updateAutoHeight(),transitionEmit({swiper:j,runCallbacks:_,direction:e,step:"Start"}))}function transitionEnd(_,e){_===void 0&&(_=!0);const j=this,{params:Vt}=j;j.animating=!1,!Vt.cssMode&&(j.setTransition(0),transitionEmit({swiper:j,runCallbacks:_,direction:e,step:"End"}))}var transition={setTransition,transitionStart,transitionEnd};function slideTo(_,e,j,Vt,zt){_===void 0&&(_=0),j===void 0&&(j=!0),typeof _=="string"&&(_=parseInt(_,10));const _r=this;let _o=_;_o<0&&(_o=0);const{params:ga,snapGrid:_a,slidesGrid:_l,previousIndex:_d,activeIndex:_f,rtlTranslate:_m,wrapperEl:tE,enabled:rE}=_r;if(!rE&&!Vt&&!zt||_r.destroyed||_r.animating&&ga.preventInteractionOnTransition)return!1;typeof e>"u"&&(e=_r.params.speed);const oE=Math.min(_r.params.slidesPerGroupSkip,_o);let dE=oE+Math.floor((_o-oE)/_r.params.slidesPerGroup);dE>=_a.length&&(dE=_a.length-1);const nE=-_a[dE];if(ga.normalizeSlideIndex)for(let lE=0;lE<_l.length;lE+=1){const EE=-Math.floor(nE*100),wE=Math.floor(_l[lE]*100),IE=Math.floor(_l[lE+1]*100);typeof _l[lE+1]<"u"?EE>=wE&&EE<IE-(IE-wE)/2?_o=lE:EE>=wE&&EE<IE&&(_o=lE+1):EE>=wE&&(_o=lE)}if(_r.initialized&&_o!==_f&&(!_r.allowSlideNext&&(_m?nE>_r.translate&&nE>_r.minTranslate():nE<_r.translate&&nE<_r.minTranslate())||!_r.allowSlidePrev&&nE>_r.translate&&nE>_r.maxTranslate()&&(_f||0)!==_o))return!1;_o!==(_d||0)&&j&&_r.emit("beforeSlideChangeStart"),_r.updateProgress(nE);let sE;if(_o>_f?sE="next":_o<_f?sE="prev":sE="reset",_m&&-nE===_r.translate||!_m&&nE===_r.translate)return _r.updateActiveIndex(_o),ga.autoHeight&&_r.updateAutoHeight(),_r.updateSlidesClasses(),ga.effect!=="slide"&&_r.setTranslate(nE),sE!=="reset"&&(_r.transitionStart(j,sE),_r.transitionEnd(j,sE)),!1;if(ga.cssMode){const lE=_r.isHorizontal(),EE=_m?nE:-nE;if(e===0){const wE=_r.virtual&&_r.params.virtual.enabled;wE&&(_r.wrapperEl.style.scrollSnapType="none",_r._immediateVirtual=!0),wE&&!_r._cssModeVirtualInitialSet&&_r.params.initialSlide>0?(_r._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{tE[lE?"scrollLeft":"scrollTop"]=EE})):tE[lE?"scrollLeft":"scrollTop"]=EE,wE&&requestAnimationFrame(()=>{_r.wrapperEl.style.scrollSnapType="",_r._immediateVirtual=!1})}else{if(!_r.support.smoothScroll)return animateCSSModeScroll({swiper:_r,targetPosition:EE,side:lE?"left":"top"}),!0;tE.scrollTo({[lE?"left":"top"]:EE,behavior:"smooth"})}return!0}return _r.setTransition(e),_r.setTranslate(nE),_r.updateActiveIndex(_o),_r.updateSlidesClasses(),_r.emit("beforeTransitionStart",e,Vt),_r.transitionStart(j,sE),e===0?_r.transitionEnd(j,sE):_r.animating||(_r.animating=!0,_r.onSlideToWrapperTransitionEnd||(_r.onSlideToWrapperTransitionEnd=function(EE){!_r||_r.destroyed||EE.target===this&&(_r.wrapperEl.removeEventListener("transitionend",_r.onSlideToWrapperTransitionEnd),_r.onSlideToWrapperTransitionEnd=null,delete _r.onSlideToWrapperTransitionEnd,_r.transitionEnd(j,sE))}),_r.wrapperEl.addEventListener("transitionend",_r.onSlideToWrapperTransitionEnd)),!0}function slideToLoop(_,e,j,Vt){_===void 0&&(_=0),j===void 0&&(j=!0),typeof _=="string"&&(_=parseInt(_,10));const zt=this;if(zt.destroyed)return;typeof e>"u"&&(e=zt.params.speed);const _r=zt.grid&&zt.params.grid&&zt.params.grid.rows>1;let _o=_;if(zt.params.loop)if(zt.virtual&&zt.params.virtual.enabled)_o=_o+zt.virtual.slidesBefore;else{let ga;if(_r){const _m=_o*zt.params.grid.rows;ga=zt.slides.filter(tE=>tE.getAttribute("data-swiper-slide-index")*1===_m)[0].column}else ga=zt.getSlideIndexByData(_o);const _a=_r?Math.ceil(zt.slides.length/zt.params.grid.rows):zt.slides.length,{centeredSlides:_l}=zt.params;let _d=zt.params.slidesPerView;_d==="auto"?_d=zt.slidesPerViewDynamic():(_d=Math.ceil(parseFloat(zt.params.slidesPerView,10)),_l&&_d%2===0&&(_d=_d+1));let _f=_a-ga<_d;if(_l&&(_f=_f||ga<Math.ceil(_d/2)),Vt&&_l&&zt.params.slidesPerView!=="auto"&&!_r&&(_f=!1),_f){const _m=_l?ga<zt.activeIndex?"prev":"next":ga-zt.activeIndex-1<zt.params.slidesPerView?"next":"prev";zt.loopFix({direction:_m,slideTo:!0,activeSlideIndex:_m==="next"?ga+1:ga-_a+1,slideRealIndex:_m==="next"?zt.realIndex:void 0})}if(_r){const _m=_o*zt.params.grid.rows;_o=zt.slides.filter(tE=>tE.getAttribute("data-swiper-slide-index")*1===_m)[0].column}else _o=zt.getSlideIndexByData(_o)}return requestAnimationFrame(()=>{zt.slideTo(_o,e,j,Vt)}),zt}function slideNext(_,e,j){e===void 0&&(e=!0);const Vt=this,{enabled:zt,params:_r,animating:_o}=Vt;if(!zt||Vt.destroyed)return Vt;typeof _>"u"&&(_=Vt.params.speed);let ga=_r.slidesPerGroup;_r.slidesPerView==="auto"&&_r.slidesPerGroup===1&&_r.slidesPerGroupAuto&&(ga=Math.max(Vt.slidesPerViewDynamic("current",!0),1));const _a=Vt.activeIndex<_r.slidesPerGroupSkip?1:ga,_l=Vt.virtual&&_r.virtual.enabled;if(_r.loop){if(_o&&!_l&&_r.loopPreventsSliding)return!1;if(Vt.loopFix({direction:"next"}),Vt._clientLeft=Vt.wrapperEl.clientLeft,Vt.activeIndex===Vt.slides.length-1&&_r.cssMode)return requestAnimationFrame(()=>{Vt.slideTo(Vt.activeIndex+_a,_,e,j)}),!0}return _r.rewind&&Vt.isEnd?Vt.slideTo(0,_,e,j):Vt.slideTo(Vt.activeIndex+_a,_,e,j)}function slidePrev(_,e,j){e===void 0&&(e=!0);const Vt=this,{params:zt,snapGrid:_r,slidesGrid:_o,rtlTranslate:ga,enabled:_a,animating:_l}=Vt;if(!_a||Vt.destroyed)return Vt;typeof _>"u"&&(_=Vt.params.speed);const _d=Vt.virtual&&zt.virtual.enabled;if(zt.loop){if(_l&&!_d&&zt.loopPreventsSliding)return!1;Vt.loopFix({direction:"prev"}),Vt._clientLeft=Vt.wrapperEl.clientLeft}const _f=ga?Vt.translate:-Vt.translate;function _m(nE){return nE<0?-Math.floor(Math.abs(nE)):Math.floor(nE)}const tE=_m(_f),rE=_r.map(nE=>_m(nE));let oE=_r[rE.indexOf(tE)-1];if(typeof oE>"u"&&zt.cssMode){let nE;_r.forEach((sE,lE)=>{tE>=sE&&(nE=lE)}),typeof nE<"u"&&(oE=_r[nE>0?nE-1:nE])}let dE=0;if(typeof oE<"u"&&(dE=_o.indexOf(oE),dE<0&&(dE=Vt.activeIndex-1),zt.slidesPerView==="auto"&&zt.slidesPerGroup===1&&zt.slidesPerGroupAuto&&(dE=dE-Vt.slidesPerViewDynamic("previous",!0)+1,dE=Math.max(dE,0))),zt.rewind&&Vt.isBeginning){const nE=Vt.params.virtual&&Vt.params.virtual.enabled&&Vt.virtual?Vt.virtual.slides.length-1:Vt.slides.length-1;return Vt.slideTo(nE,_,e,j)}else if(zt.loop&&Vt.activeIndex===0&&zt.cssMode)return requestAnimationFrame(()=>{Vt.slideTo(dE,_,e,j)}),!0;return Vt.slideTo(dE,_,e,j)}function slideReset(_,e,j){e===void 0&&(e=!0);const Vt=this;if(!Vt.destroyed)return typeof _>"u"&&(_=Vt.params.speed),Vt.slideTo(Vt.activeIndex,_,e,j)}function slideToClosest(_,e,j,Vt){e===void 0&&(e=!0),Vt===void 0&&(Vt=.5);const zt=this;if(zt.destroyed)return;typeof _>"u"&&(_=zt.params.speed);let _r=zt.activeIndex;const _o=Math.min(zt.params.slidesPerGroupSkip,_r),ga=_o+Math.floor((_r-_o)/zt.params.slidesPerGroup),_a=zt.rtlTranslate?zt.translate:-zt.translate;if(_a>=zt.snapGrid[ga]){const _l=zt.snapGrid[ga],_d=zt.snapGrid[ga+1];_a-_l>(_d-_l)*Vt&&(_r+=zt.params.slidesPerGroup)}else{const _l=zt.snapGrid[ga-1],_d=zt.snapGrid[ga];_a-_l<=(_d-_l)*Vt&&(_r-=zt.params.slidesPerGroup)}return _r=Math.max(_r,0),_r=Math.min(_r,zt.slidesGrid.length-1),zt.slideTo(_r,_,e,j)}function slideToClickedSlide(){const _=this;if(_.destroyed)return;const{params:e,slidesEl:j}=_,Vt=e.slidesPerView==="auto"?_.slidesPerViewDynamic():e.slidesPerView;let zt=_.clickedIndex,_r;const _o=_.isElement?"swiper-slide":`.${e.slideClass}`;if(e.loop){if(_.animating)return;_r=parseInt(_.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?zt<_.loopedSlides-Vt/2||zt>_.slides.length-_.loopedSlides+Vt/2?(_.loopFix(),zt=_.getSlideIndex(elementChildren(j,`${_o}[data-swiper-slide-index="${_r}"]`)[0]),nextTick(()=>{_.slideTo(zt)})):_.slideTo(zt):zt>_.slides.length-Vt?(_.loopFix(),zt=_.getSlideIndex(elementChildren(j,`${_o}[data-swiper-slide-index="${_r}"]`)[0]),nextTick(()=>{_.slideTo(zt)})):_.slideTo(zt)}else _.slideTo(zt)}var slide={slideTo,slideToLoop,slideNext,slidePrev,slideReset,slideToClosest,slideToClickedSlide};function loopCreate(_){const e=this,{params:j,slidesEl:Vt}=e;if(!j.loop||e.virtual&&e.params.virtual.enabled)return;const zt=()=>{elementChildren(Vt,`.${j.slideClass}, swiper-slide`).forEach((_f,_m)=>{_f.setAttribute("data-swiper-slide-index",_m)})},_r=e.grid&&j.grid&&j.grid.rows>1,_o=j.slidesPerGroup*(_r?j.grid.rows:1),ga=e.slides.length%_o!==0,_a=_r&&e.slides.length%j.grid.rows!==0,_l=_d=>{for(let _f=0;_f<_d;_f+=1){const _m=e.isElement?createElement("swiper-slide",[j.slideBlankClass]):createElement("div",[j.slideClass,j.slideBlankClass]);e.slidesEl.append(_m)}};if(ga){if(j.loopAddBlankSlides){const _d=_o-e.slides.length%_o;_l(_d),e.recalcSlides(),e.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");zt()}else if(_a){if(j.loopAddBlankSlides){const _d=j.grid.rows-e.slides.length%j.grid.rows;_l(_d),e.recalcSlides(),e.updateSlides()}else showWarning("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");zt()}else zt();e.loopFix({slideRealIndex:_,direction:j.centeredSlides?void 0:"next"})}function loopFix(_){let{slideRealIndex:e,slideTo:j=!0,direction:Vt,setTranslate:zt,activeSlideIndex:_r,byController:_o,byMousewheel:ga}=_===void 0?{}:_;const _a=this;if(!_a.params.loop)return;_a.emit("beforeLoopFix");const{slides:_l,allowSlidePrev:_d,allowSlideNext:_f,slidesEl:_m,params:tE}=_a,{centeredSlides:rE}=tE;if(_a.allowSlidePrev=!0,_a.allowSlideNext=!0,_a.virtual&&tE.virtual.enabled){j&&(!tE.centeredSlides&&_a.snapIndex===0?_a.slideTo(_a.virtual.slides.length,0,!1,!0):tE.centeredSlides&&_a.snapIndex<tE.slidesPerView?_a.slideTo(_a.virtual.slides.length+_a.snapIndex,0,!1,!0):_a.snapIndex===_a.snapGrid.length-1&&_a.slideTo(_a.virtual.slidesBefore,0,!1,!0)),_a.allowSlidePrev=_d,_a.allowSlideNext=_f,_a.emit("loopFix");return}let oE=tE.slidesPerView;oE==="auto"?oE=_a.slidesPerViewDynamic():(oE=Math.ceil(parseFloat(tE.slidesPerView,10)),rE&&oE%2===0&&(oE=oE+1));const dE=tE.slidesPerGroupAuto?oE:tE.slidesPerGroup;let nE=dE;nE%dE!==0&&(nE+=dE-nE%dE),nE+=tE.loopAdditionalSlides,_a.loopedSlides=nE;const sE=_a.grid&&tE.grid&&tE.grid.rows>1;_l.length<oE+nE?showWarning("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):sE&&tE.grid.fill==="row"&&showWarning("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const lE=[],EE=[];let wE=_a.activeIndex;typeof _r>"u"?_r=_a.getSlideIndex(_l.filter(OE=>OE.classList.contains(tE.slideActiveClass))[0]):wE=_r;const IE=Vt==="next"||!Vt,_E=Vt==="prev"||!Vt;let kE=0,ME=0;const bE=sE?Math.ceil(_l.length/tE.grid.rows):_l.length,TE=(sE?_l[_r].column:_r)+(rE&&typeof zt>"u"?-oE/2+.5:0);if(TE<nE){kE=Math.max(nE-TE,dE);for(let OE=0;OE<nE-TE;OE+=1){const vE=OE-Math.floor(OE/bE)*bE;if(sE){const NE=bE-vE-1;for(let jE=_l.length-1;jE>=0;jE-=1)_l[jE].column===NE&&lE.push(jE)}else lE.push(bE-vE-1)}}else if(TE+oE>bE-nE){ME=Math.max(TE-(bE-nE*2),dE);for(let OE=0;OE<ME;OE+=1){const vE=OE-Math.floor(OE/bE)*bE;sE?_l.forEach((NE,jE)=>{NE.column===vE&&EE.push(jE)}):EE.push(vE)}}if(_a.__preventObserver__=!0,requestAnimationFrame(()=>{_a.__preventObserver__=!1}),_E&&lE.forEach(OE=>{_l[OE].swiperLoopMoveDOM=!0,_m.prepend(_l[OE]),_l[OE].swiperLoopMoveDOM=!1}),IE&&EE.forEach(OE=>{_l[OE].swiperLoopMoveDOM=!0,_m.append(_l[OE]),_l[OE].swiperLoopMoveDOM=!1}),_a.recalcSlides(),tE.slidesPerView==="auto"?_a.updateSlides():sE&&(lE.length>0&&_E||EE.length>0&&IE)&&_a.slides.forEach((OE,vE)=>{_a.grid.updateSlide(vE,OE,_a.slides)}),tE.watchSlidesProgress&&_a.updateSlidesOffset(),j){if(lE.length>0&&_E){if(typeof e>"u"){const OE=_a.slidesGrid[wE],NE=_a.slidesGrid[wE+kE]-OE;ga?_a.setTranslate(_a.translate-NE):(_a.slideTo(wE+Math.ceil(kE),0,!1,!0),zt&&(_a.touchEventsData.startTranslate=_a.touchEventsData.startTranslate-NE,_a.touchEventsData.currentTranslate=_a.touchEventsData.currentTranslate-NE))}else if(zt){const OE=sE?lE.length/tE.grid.rows:lE.length;_a.slideTo(_a.activeIndex+OE,0,!1,!0),_a.touchEventsData.currentTranslate=_a.translate}}else if(EE.length>0&&IE)if(typeof e>"u"){const OE=_a.slidesGrid[wE],NE=_a.slidesGrid[wE-ME]-OE;ga?_a.setTranslate(_a.translate-NE):(_a.slideTo(wE-ME,0,!1,!0),zt&&(_a.touchEventsData.startTranslate=_a.touchEventsData.startTranslate-NE,_a.touchEventsData.currentTranslate=_a.touchEventsData.currentTranslate-NE))}else{const OE=sE?EE.length/tE.grid.rows:EE.length;_a.slideTo(_a.activeIndex-OE,0,!1,!0)}}if(_a.allowSlidePrev=_d,_a.allowSlideNext=_f,_a.controller&&_a.controller.control&&!_o){const OE={slideRealIndex:e,direction:Vt,setTranslate:zt,activeSlideIndex:_r,byController:!0};Array.isArray(_a.controller.control)?_a.controller.control.forEach(vE=>{!vE.destroyed&&vE.params.loop&&vE.loopFix({...OE,slideTo:vE.params.slidesPerView===tE.slidesPerView?j:!1})}):_a.controller.control instanceof _a.constructor&&_a.controller.control.params.loop&&_a.controller.control.loopFix({...OE,slideTo:_a.controller.control.params.slidesPerView===tE.slidesPerView?j:!1})}_a.emit("loopFix")}function loopDestroy(){const _=this,{params:e,slidesEl:j}=_;if(!e.loop||_.virtual&&_.params.virtual.enabled)return;_.recalcSlides();const Vt=[];_.slides.forEach(zt=>{const _r=typeof zt.swiperSlideIndex>"u"?zt.getAttribute("data-swiper-slide-index")*1:zt.swiperSlideIndex;Vt[_r]=zt}),_.slides.forEach(zt=>{zt.removeAttribute("data-swiper-slide-index")}),Vt.forEach(zt=>{j.append(zt)}),_.recalcSlides(),_.slideTo(_.realIndex,0)}var loop={loopCreate,loopFix,loopDestroy};function setGrabCursor(_){const e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;const j=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),j.style.cursor="move",j.style.cursor=_?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function unsetGrabCursor(){const _=this;_.params.watchOverflow&&_.isLocked||_.params.cssMode||(_.isElement&&(_.__preventObserver__=!0),_[_.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",_.isElement&&requestAnimationFrame(()=>{_.__preventObserver__=!1}))}var grabCursor={setGrabCursor,unsetGrabCursor};function closestElement(_,e){e===void 0&&(e=this);function j(Vt){if(!Vt||Vt===getDocument()||Vt===getWindow())return null;Vt.assignedSlot&&(Vt=Vt.assignedSlot);const zt=Vt.closest(_);return!zt&&!Vt.getRootNode?null:zt||j(Vt.getRootNode().host)}return j(e)}function preventEdgeSwipe(_,e,j){const Vt=getWindow(),{params:zt}=_,_r=zt.edgeSwipeDetection,_o=zt.edgeSwipeThreshold;return _r&&(j<=_o||j>=Vt.innerWidth-_o)?_r==="prevent"?(e.preventDefault(),!0):!1:!0}function onTouchStart(_){const e=this,j=getDocument();let Vt=_;Vt.originalEvent&&(Vt=Vt.originalEvent);const zt=e.touchEventsData;if(Vt.type==="pointerdown"){if(zt.pointerId!==null&&zt.pointerId!==Vt.pointerId)return;zt.pointerId=Vt.pointerId}else Vt.type==="touchstart"&&Vt.targetTouches.length===1&&(zt.touchId=Vt.targetTouches[0].identifier);if(Vt.type==="touchstart"){preventEdgeSwipe(e,Vt,Vt.targetTouches[0].pageX);return}const{params:_r,touches:_o,enabled:ga}=e;if(!ga||!_r.simulateTouch&&Vt.pointerType==="mouse"||e.animating&&_r.preventInteractionOnTransition)return;!e.animating&&_r.cssMode&&_r.loop&&e.loopFix();let _a=Vt.target;if(_r.touchEventsTarget==="wrapper"&&!e.wrapperEl.contains(_a)||"which"in Vt&&Vt.which===3||"button"in Vt&&Vt.button>0||zt.isTouched&&zt.isMoved)return;const _l=!!_r.noSwipingClass&&_r.noSwipingClass!=="",_d=Vt.composedPath?Vt.composedPath():Vt.path;_l&&Vt.target&&Vt.target.shadowRoot&&_d&&(_a=_d[0]);const _f=_r.noSwipingSelector?_r.noSwipingSelector:`.${_r.noSwipingClass}`,_m=!!(Vt.target&&Vt.target.shadowRoot);if(_r.noSwiping&&(_m?closestElement(_f,_a):_a.closest(_f))){e.allowClick=!0;return}if(_r.swipeHandler&&!_a.closest(_r.swipeHandler))return;_o.currentX=Vt.pageX,_o.currentY=Vt.pageY;const tE=_o.currentX,rE=_o.currentY;if(!preventEdgeSwipe(e,Vt,tE))return;Object.assign(zt,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),_o.startX=tE,_o.startY=rE,zt.touchStartTime=now(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,_r.threshold>0&&(zt.allowThresholdMove=!1);let oE=!0;_a.matches(zt.focusableElements)&&(oE=!1,_a.nodeName==="SELECT"&&(zt.isTouched=!1)),j.activeElement&&j.activeElement.matches(zt.focusableElements)&&j.activeElement!==_a&&j.activeElement.blur();const dE=oE&&e.allowTouchMove&&_r.touchStartPreventDefault;(_r.touchStartForcePreventDefault||dE)&&!_a.isContentEditable&&Vt.preventDefault(),_r.freeMode&&_r.freeMode.enabled&&e.freeMode&&e.animating&&!_r.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",Vt)}function onTouchMove(_){const e=getDocument(),j=this,Vt=j.touchEventsData,{params:zt,touches:_r,rtlTranslate:_o,enabled:ga}=j;if(!ga||!zt.simulateTouch&&_.pointerType==="mouse")return;let _a=_;if(_a.originalEvent&&(_a=_a.originalEvent),_a.type==="pointermove"&&(Vt.touchId!==null||_a.pointerId!==Vt.pointerId))return;let _l;if(_a.type==="touchmove"){if(_l=[..._a.changedTouches].filter(IE=>IE.identifier===Vt.touchId)[0],!_l||_l.identifier!==Vt.touchId)return}else _l=_a;if(!Vt.isTouched){Vt.startMoving&&Vt.isScrolling&&j.emit("touchMoveOpposite",_a);return}const _d=_l.pageX,_f=_l.pageY;if(_a.preventedByNestedSwiper){_r.startX=_d,_r.startY=_f;return}if(!j.allowTouchMove){_a.target.matches(Vt.focusableElements)||(j.allowClick=!1),Vt.isTouched&&(Object.assign(_r,{startX:_d,startY:_f,currentX:_d,currentY:_f}),Vt.touchStartTime=now());return}if(zt.touchReleaseOnEdges&&!zt.loop){if(j.isVertical()){if(_f<_r.startY&&j.translate<=j.maxTranslate()||_f>_r.startY&&j.translate>=j.minTranslate()){Vt.isTouched=!1,Vt.isMoved=!1;return}}else if(_d<_r.startX&&j.translate<=j.maxTranslate()||_d>_r.startX&&j.translate>=j.minTranslate())return}if(e.activeElement&&_a.target===e.activeElement&&_a.target.matches(Vt.focusableElements)){Vt.isMoved=!0,j.allowClick=!1;return}Vt.allowTouchCallbacks&&j.emit("touchMove",_a),_r.previousX=_r.currentX,_r.previousY=_r.currentY,_r.currentX=_d,_r.currentY=_f;const _m=_r.currentX-_r.startX,tE=_r.currentY-_r.startY;if(j.params.threshold&&Math.sqrt(_m**2+tE**2)<j.params.threshold)return;if(typeof Vt.isScrolling>"u"){let IE;j.isHorizontal()&&_r.currentY===_r.startY||j.isVertical()&&_r.currentX===_r.startX?Vt.isScrolling=!1:_m*_m+tE*tE>=25&&(IE=Math.atan2(Math.abs(tE),Math.abs(_m))*180/Math.PI,Vt.isScrolling=j.isHorizontal()?IE>zt.touchAngle:90-IE>zt.touchAngle)}if(Vt.isScrolling&&j.emit("touchMoveOpposite",_a),typeof Vt.startMoving>"u"&&(_r.currentX!==_r.startX||_r.currentY!==_r.startY)&&(Vt.startMoving=!0),Vt.isScrolling||_a.type==="touchmove"&&Vt.preventTouchMoveFromPointerMove){Vt.isTouched=!1;return}if(!Vt.startMoving)return;j.allowClick=!1,!zt.cssMode&&_a.cancelable&&_a.preventDefault(),zt.touchMoveStopPropagation&&!zt.nested&&_a.stopPropagation();let rE=j.isHorizontal()?_m:tE,oE=j.isHorizontal()?_r.currentX-_r.previousX:_r.currentY-_r.previousY;zt.oneWayMovement&&(rE=Math.abs(rE)*(_o?1:-1),oE=Math.abs(oE)*(_o?1:-1)),_r.diff=rE,rE*=zt.touchRatio,_o&&(rE=-rE,oE=-oE);const dE=j.touchesDirection;j.swipeDirection=rE>0?"prev":"next",j.touchesDirection=oE>0?"prev":"next";const nE=j.params.loop&&!zt.cssMode,sE=j.touchesDirection==="next"&&j.allowSlideNext||j.touchesDirection==="prev"&&j.allowSlidePrev;if(!Vt.isMoved){if(nE&&sE&&j.loopFix({direction:j.swipeDirection}),Vt.startTranslate=j.getTranslate(),j.setTransition(0),j.animating){const IE=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});j.wrapperEl.dispatchEvent(IE)}Vt.allowMomentumBounce=!1,zt.grabCursor&&(j.allowSlideNext===!0||j.allowSlidePrev===!0)&&j.setGrabCursor(!0),j.emit("sliderFirstMove",_a)}let lE;if(new Date().getTime(),Vt.isMoved&&Vt.allowThresholdMove&&dE!==j.touchesDirection&&nE&&sE&&Math.abs(rE)>=1){Object.assign(_r,{startX:_d,startY:_f,currentX:_d,currentY:_f,startTranslate:Vt.currentTranslate}),Vt.loopSwapReset=!0,Vt.startTranslate=Vt.currentTranslate;return}j.emit("sliderMove",_a),Vt.isMoved=!0,Vt.currentTranslate=rE+Vt.startTranslate;let EE=!0,wE=zt.resistanceRatio;if(zt.touchReleaseOnEdges&&(wE=0),rE>0?(nE&&sE&&!lE&&Vt.allowThresholdMove&&Vt.currentTranslate>(zt.centeredSlides?j.minTranslate()-j.slidesSizesGrid[j.activeIndex+1]:j.minTranslate())&&j.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),Vt.currentTranslate>j.minTranslate()&&(EE=!1,zt.resistance&&(Vt.currentTranslate=j.minTranslate()-1+(-j.minTranslate()+Vt.startTranslate+rE)**wE))):rE<0&&(nE&&sE&&!lE&&Vt.allowThresholdMove&&Vt.currentTranslate<(zt.centeredSlides?j.maxTranslate()+j.slidesSizesGrid[j.slidesSizesGrid.length-1]:j.maxTranslate())&&j.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:j.slides.length-(zt.slidesPerView==="auto"?j.slidesPerViewDynamic():Math.ceil(parseFloat(zt.slidesPerView,10)))}),Vt.currentTranslate<j.maxTranslate()&&(EE=!1,zt.resistance&&(Vt.currentTranslate=j.maxTranslate()+1-(j.maxTranslate()-Vt.startTranslate-rE)**wE))),EE&&(_a.preventedByNestedSwiper=!0),!j.allowSlideNext&&j.swipeDirection==="next"&&Vt.currentTranslate<Vt.startTranslate&&(Vt.currentTranslate=Vt.startTranslate),!j.allowSlidePrev&&j.swipeDirection==="prev"&&Vt.currentTranslate>Vt.startTranslate&&(Vt.currentTranslate=Vt.startTranslate),!j.allowSlidePrev&&!j.allowSlideNext&&(Vt.currentTranslate=Vt.startTranslate),zt.threshold>0)if(Math.abs(rE)>zt.threshold||Vt.allowThresholdMove){if(!Vt.allowThresholdMove){Vt.allowThresholdMove=!0,_r.startX=_r.currentX,_r.startY=_r.currentY,Vt.currentTranslate=Vt.startTranslate,_r.diff=j.isHorizontal()?_r.currentX-_r.startX:_r.currentY-_r.startY;return}}else{Vt.currentTranslate=Vt.startTranslate;return}!zt.followFinger||zt.cssMode||((zt.freeMode&&zt.freeMode.enabled&&j.freeMode||zt.watchSlidesProgress)&&(j.updateActiveIndex(),j.updateSlidesClasses()),zt.freeMode&&zt.freeMode.enabled&&j.freeMode&&j.freeMode.onTouchMove(),j.updateProgress(Vt.currentTranslate),j.setTranslate(Vt.currentTranslate))}function onTouchEnd(_){const e=this,j=e.touchEventsData;let Vt=_;Vt.originalEvent&&(Vt=Vt.originalEvent);let zt;if(Vt.type==="touchend"||Vt.type==="touchcancel"){if(zt=[...Vt.changedTouches].filter(wE=>wE.identifier===j.touchId)[0],!zt||zt.identifier!==j.touchId)return}else{if(j.touchId!==null||Vt.pointerId!==j.pointerId)return;zt=Vt}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(Vt.type)&&!(["pointercancel","contextmenu"].includes(Vt.type)&&(e.browser.isSafari||e.browser.isWebView)))return;j.pointerId=null,j.touchId=null;const{params:_o,touches:ga,rtlTranslate:_a,slidesGrid:_l,enabled:_d}=e;if(!_d||!_o.simulateTouch&&Vt.pointerType==="mouse")return;if(j.allowTouchCallbacks&&e.emit("touchEnd",Vt),j.allowTouchCallbacks=!1,!j.isTouched){j.isMoved&&_o.grabCursor&&e.setGrabCursor(!1),j.isMoved=!1,j.startMoving=!1;return}_o.grabCursor&&j.isMoved&&j.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);const _f=now(),_m=_f-j.touchStartTime;if(e.allowClick){const wE=Vt.path||Vt.composedPath&&Vt.composedPath();e.updateClickedSlide(wE&&wE[0]||Vt.target,wE),e.emit("tap click",Vt),_m<300&&_f-j.lastClickTime<300&&e.emit("doubleTap doubleClick",Vt)}if(j.lastClickTime=now(),nextTick(()=>{e.destroyed||(e.allowClick=!0)}),!j.isTouched||!j.isMoved||!e.swipeDirection||ga.diff===0&&!j.loopSwapReset||j.currentTranslate===j.startTranslate&&!j.loopSwapReset){j.isTouched=!1,j.isMoved=!1,j.startMoving=!1;return}j.isTouched=!1,j.isMoved=!1,j.startMoving=!1;let tE;if(_o.followFinger?tE=_a?e.translate:-e.translate:tE=-j.currentTranslate,_o.cssMode)return;if(_o.freeMode&&_o.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:tE});return}const rE=tE>=-e.maxTranslate()&&!e.params.loop;let oE=0,dE=e.slidesSizesGrid[0];for(let wE=0;wE<_l.length;wE+=wE<_o.slidesPerGroupSkip?1:_o.slidesPerGroup){const IE=wE<_o.slidesPerGroupSkip-1?1:_o.slidesPerGroup;typeof _l[wE+IE]<"u"?(rE||tE>=_l[wE]&&tE<_l[wE+IE])&&(oE=wE,dE=_l[wE+IE]-_l[wE]):(rE||tE>=_l[wE])&&(oE=wE,dE=_l[_l.length-1]-_l[_l.length-2])}let nE=null,sE=null;_o.rewind&&(e.isBeginning?sE=_o.virtual&&_o.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(nE=0));const lE=(tE-_l[oE])/dE,EE=oE<_o.slidesPerGroupSkip-1?1:_o.slidesPerGroup;if(_m>_o.longSwipesMs){if(!_o.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(lE>=_o.longSwipesRatio?e.slideTo(_o.rewind&&e.isEnd?nE:oE+EE):e.slideTo(oE)),e.swipeDirection==="prev"&&(lE>1-_o.longSwipesRatio?e.slideTo(oE+EE):sE!==null&&lE<0&&Math.abs(lE)>_o.longSwipesRatio?e.slideTo(sE):e.slideTo(oE))}else{if(!_o.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(Vt.target===e.navigation.nextEl||Vt.target===e.navigation.prevEl)?Vt.target===e.navigation.nextEl?e.slideTo(oE+EE):e.slideTo(oE):(e.swipeDirection==="next"&&e.slideTo(nE!==null?nE:oE+EE),e.swipeDirection==="prev"&&e.slideTo(sE!==null?sE:oE))}}function onResize(){const _=this,{params:e,el:j}=_;if(j&&j.offsetWidth===0)return;e.breakpoints&&_.setBreakpoint();const{allowSlideNext:Vt,allowSlidePrev:zt,snapGrid:_r}=_,_o=_.virtual&&_.params.virtual.enabled;_.allowSlideNext=!0,_.allowSlidePrev=!0,_.updateSize(),_.updateSlides(),_.updateSlidesClasses();const ga=_o&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&_.isEnd&&!_.isBeginning&&!_.params.centeredSlides&&!ga?_.slideTo(_.slides.length-1,0,!1,!0):_.params.loop&&!_o?_.slideToLoop(_.realIndex,0,!1,!0):_.slideTo(_.activeIndex,0,!1,!0),_.autoplay&&_.autoplay.running&&_.autoplay.paused&&(clearTimeout(_.autoplay.resizeTimeout),_.autoplay.resizeTimeout=setTimeout(()=>{_.autoplay&&_.autoplay.running&&_.autoplay.paused&&_.autoplay.resume()},500)),_.allowSlidePrev=zt,_.allowSlideNext=Vt,_.params.watchOverflow&&_r!==_.snapGrid&&_.checkOverflow()}function onClick(_){const e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&_.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(_.stopPropagation(),_.stopImmediatePropagation())))}function onScroll(){const _=this,{wrapperEl:e,rtlTranslate:j,enabled:Vt}=_;if(!Vt)return;_.previousTranslate=_.translate,_.isHorizontal()?_.translate=-e.scrollLeft:_.translate=-e.scrollTop,_.translate===0&&(_.translate=0),_.updateActiveIndex(),_.updateSlidesClasses();let zt;const _r=_.maxTranslate()-_.minTranslate();_r===0?zt=0:zt=(_.translate-_.minTranslate())/_r,zt!==_.progress&&_.updateProgress(j?-_.translate:_.translate),_.emit("setTranslate",_.translate,!1)}function onLoad(_){const e=this;processLazyPreloader(e,_.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function onDocumentTouchStart(){const _=this;_.documentTouchHandlerProceeded||(_.documentTouchHandlerProceeded=!0,_.params.touchReleaseOnEdges&&(_.el.style.touchAction="auto"))}const events=(_,e)=>{const j=getDocument(),{params:Vt,el:zt,wrapperEl:_r,device:_o}=_,ga=!!Vt.nested,_a=e==="on"?"addEventListener":"removeEventListener",_l=e;!zt||typeof zt=="string"||(j[_a]("touchstart",_.onDocumentTouchStart,{passive:!1,capture:ga}),zt[_a]("touchstart",_.onTouchStart,{passive:!1}),zt[_a]("pointerdown",_.onTouchStart,{passive:!1}),j[_a]("touchmove",_.onTouchMove,{passive:!1,capture:ga}),j[_a]("pointermove",_.onTouchMove,{passive:!1,capture:ga}),j[_a]("touchend",_.onTouchEnd,{passive:!0}),j[_a]("pointerup",_.onTouchEnd,{passive:!0}),j[_a]("pointercancel",_.onTouchEnd,{passive:!0}),j[_a]("touchcancel",_.onTouchEnd,{passive:!0}),j[_a]("pointerout",_.onTouchEnd,{passive:!0}),j[_a]("pointerleave",_.onTouchEnd,{passive:!0}),j[_a]("contextmenu",_.onTouchEnd,{passive:!0}),(Vt.preventClicks||Vt.preventClicksPropagation)&&zt[_a]("click",_.onClick,!0),Vt.cssMode&&_r[_a]("scroll",_.onScroll),Vt.updateOnWindowResize?_[_l](_o.ios||_o.android?"resize orientationchange observerUpdate":"resize observerUpdate",onResize,!0):_[_l]("observerUpdate",onResize,!0),zt[_a]("load",_.onLoad,{capture:!0}))};function attachEvents(){const _=this,{params:e}=_;_.onTouchStart=onTouchStart.bind(_),_.onTouchMove=onTouchMove.bind(_),_.onTouchEnd=onTouchEnd.bind(_),_.onDocumentTouchStart=onDocumentTouchStart.bind(_),e.cssMode&&(_.onScroll=onScroll.bind(_)),_.onClick=onClick.bind(_),_.onLoad=onLoad.bind(_),events(_,"on")}function detachEvents(){events(this,"off")}var events$1={attachEvents,detachEvents};const isGridEnabled=(_,e)=>_.grid&&e.grid&&e.grid.rows>1;function setBreakpoint(){const _=this,{realIndex:e,initialized:j,params:Vt,el:zt}=_,_r=Vt.breakpoints;if(!_r||_r&&Object.keys(_r).length===0)return;const _o=_.getBreakpoint(_r,_.params.breakpointsBase,_.el);if(!_o||_.currentBreakpoint===_o)return;const _a=(_o in _r?_r[_o]:void 0)||_.originalParams,_l=isGridEnabled(_,Vt),_d=isGridEnabled(_,_a),_f=_.params.grabCursor,_m=_a.grabCursor,tE=Vt.enabled;_l&&!_d?(zt.classList.remove(`${Vt.containerModifierClass}grid`,`${Vt.containerModifierClass}grid-column`),_.emitContainerClasses()):!_l&&_d&&(zt.classList.add(`${Vt.containerModifierClass}grid`),(_a.grid.fill&&_a.grid.fill==="column"||!_a.grid.fill&&Vt.grid.fill==="column")&&zt.classList.add(`${Vt.containerModifierClass}grid-column`),_.emitContainerClasses()),_f&&!_m?_.unsetGrabCursor():!_f&&_m&&_.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(lE=>{if(typeof _a[lE]>"u")return;const EE=Vt[lE]&&Vt[lE].enabled,wE=_a[lE]&&_a[lE].enabled;EE&&!wE&&_[lE].disable(),!EE&&wE&&_[lE].enable()});const rE=_a.direction&&_a.direction!==Vt.direction,oE=Vt.loop&&(_a.slidesPerView!==Vt.slidesPerView||rE),dE=Vt.loop;rE&&j&&_.changeDirection(),extend$2(_.params,_a);const nE=_.params.enabled,sE=_.params.loop;Object.assign(_,{allowTouchMove:_.params.allowTouchMove,allowSlideNext:_.params.allowSlideNext,allowSlidePrev:_.params.allowSlidePrev}),tE&&!nE?_.disable():!tE&&nE&&_.enable(),_.currentBreakpoint=_o,_.emit("_beforeBreakpoint",_a),j&&(oE?(_.loopDestroy(),_.loopCreate(e),_.updateSlides()):!dE&&sE?(_.loopCreate(e),_.updateSlides()):dE&&!sE&&_.loopDestroy()),_.emit("breakpoint",_a)}function getBreakpoint(_,e,j){if(e===void 0&&(e="window"),!_||e==="container"&&!j)return;let Vt=!1;const zt=getWindow(),_r=e==="window"?zt.innerHeight:j.clientHeight,_o=Object.keys(_).map(ga=>{if(typeof ga=="string"&&ga.indexOf("@")===0){const _a=parseFloat(ga.substr(1));return{value:_r*_a,point:ga}}return{value:ga,point:ga}});_o.sort((ga,_a)=>parseInt(ga.value,10)-parseInt(_a.value,10));for(let ga=0;ga<_o.length;ga+=1){const{point:_a,value:_l}=_o[ga];e==="window"?zt.matchMedia(`(min-width: ${_l}px)`).matches&&(Vt=_a):_l<=j.clientWidth&&(Vt=_a)}return Vt||"max"}var breakpoints={setBreakpoint,getBreakpoint};function prepareClasses(_,e){const j=[];return _.forEach(Vt=>{typeof Vt=="object"?Object.keys(Vt).forEach(zt=>{Vt[zt]&&j.push(e+zt)}):typeof Vt=="string"&&j.push(e+Vt)}),j}function addClasses(){const _=this,{classNames:e,params:j,rtl:Vt,el:zt,device:_r}=_,_o=prepareClasses(["initialized",j.direction,{"free-mode":_.params.freeMode&&j.freeMode.enabled},{autoheight:j.autoHeight},{rtl:Vt},{grid:j.grid&&j.grid.rows>1},{"grid-column":j.grid&&j.grid.rows>1&&j.grid.fill==="column"},{android:_r.android},{ios:_r.ios},{"css-mode":j.cssMode},{centered:j.cssMode&&j.centeredSlides},{"watch-progress":j.watchSlidesProgress}],j.containerModifierClass);e.push(..._o),zt.classList.add(...e),_.emitContainerClasses()}function removeClasses(){const _=this,{el:e,classNames:j}=_;!e||typeof e=="string"||(e.classList.remove(...j),_.emitContainerClasses())}var classes={addClasses,removeClasses};function checkOverflow(){const _=this,{isLocked:e,params:j}=_,{slidesOffsetBefore:Vt}=j;if(Vt){const zt=_.slides.length-1,_r=_.slidesGrid[zt]+_.slidesSizesGrid[zt]+Vt*2;_.isLocked=_.size>_r}else _.isLocked=_.snapGrid.length===1;j.allowSlideNext===!0&&(_.allowSlideNext=!_.isLocked),j.allowSlidePrev===!0&&(_.allowSlidePrev=!_.isLocked),e&&e!==_.isLocked&&(_.isEnd=!1),e!==_.isLocked&&_.emit(_.isLocked?"lock":"unlock")}var checkOverflow$1={checkOverflow},defaults$1={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function moduleExtendParams(_,e){return function(Vt){Vt===void 0&&(Vt={});const zt=Object.keys(Vt)[0],_r=Vt[zt];if(typeof _r!="object"||_r===null){extend$2(e,Vt);return}if(_[zt]===!0&&(_[zt]={enabled:!0}),zt==="navigation"&&_[zt]&&_[zt].enabled&&!_[zt].prevEl&&!_[zt].nextEl&&(_[zt].auto=!0),["pagination","scrollbar"].indexOf(zt)>=0&&_[zt]&&_[zt].enabled&&!_[zt].el&&(_[zt].auto=!0),!(zt in _&&"enabled"in _r)){extend$2(e,Vt);return}typeof _[zt]=="object"&&!("enabled"in _[zt])&&(_[zt].enabled=!0),_[zt]||(_[zt]={enabled:!1}),extend$2(e,Vt)}}const prototypes={eventsEmitter,update,translate,transition,slide,loop,grabCursor,events:events$1,breakpoints,checkOverflow:checkOverflow$1,classes},extendedDefaults={};let Swiper$1=class P1{constructor(){let e,j;for(var Vt=arguments.length,zt=new Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];zt.length===1&&zt[0].constructor&&Object.prototype.toString.call(zt[0]).slice(8,-1)==="Object"?j=zt[0]:[e,j]=zt,j||(j={}),j=extend$2({},j),e&&!j.el&&(j.el=e);const _o=getDocument();if(j.el&&typeof j.el=="string"&&_o.querySelectorAll(j.el).length>1){const _d=[];return _o.querySelectorAll(j.el).forEach(_f=>{const _m=extend$2({},j,{el:_f});_d.push(new P1(_m))}),_d}const ga=this;ga.__swiper__=!0,ga.support=getSupport(),ga.device=getDevice({userAgent:j.userAgent}),ga.browser=getBrowser(),ga.eventsListeners={},ga.eventsAnyListeners=[],ga.modules=[...ga.__modules__],j.modules&&Array.isArray(j.modules)&&ga.modules.push(...j.modules);const _a={};ga.modules.forEach(_d=>{_d({params:j,swiper:ga,extendParams:moduleExtendParams(j,_a),on:ga.on.bind(ga),once:ga.once.bind(ga),off:ga.off.bind(ga),emit:ga.emit.bind(ga)})});const _l=extend$2({},defaults$1,_a);return ga.params=extend$2({},_l,extendedDefaults,j),ga.originalParams=extend$2({},ga.params),ga.passedParams=extend$2({},j),ga.params&&ga.params.on&&Object.keys(ga.params.on).forEach(_d=>{ga.on(_d,ga.params.on[_d])}),ga.params&&ga.params.onAny&&ga.onAny(ga.params.onAny),Object.assign(ga,{enabled:ga.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return ga.params.direction==="horizontal"},isVertical(){return ga.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:ga.params.allowSlideNext,allowSlidePrev:ga.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:ga.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:ga.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),ga.emit("_swiper"),ga.params.init&&ga.init(),ga}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:j,params:Vt}=this,zt=elementChildren(j,`.${Vt.slideClass}, swiper-slide`),_r=elementIndex(zt[0]);return elementIndex(e)-_r}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter(j=>j.getAttribute("data-swiper-slide-index")*1===e)[0])}recalcSlides(){const e=this,{slidesEl:j,params:Vt}=e;e.slides=elementChildren(j,`.${Vt.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,j){const Vt=this;e=Math.min(Math.max(e,0),1);const zt=Vt.minTranslate(),_o=(Vt.maxTranslate()-zt)*e+zt;Vt.translateTo(_o,typeof j>"u"?0:j),Vt.updateActiveIndex(),Vt.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const j=e.el.className.split(" ").filter(Vt=>Vt.indexOf("swiper")===0||Vt.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",j.join(" "))}getSlideClasses(e){const j=this;return j.destroyed?"":e.className.split(" ").filter(Vt=>Vt.indexOf("swiper-slide")===0||Vt.indexOf(j.params.slideClass)===0).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const j=[];e.slides.forEach(Vt=>{const zt=e.getSlideClasses(Vt);j.push({slideEl:Vt,classNames:zt}),e.emit("_slideClass",Vt,zt)}),e.emit("_slideClasses",j)}slidesPerViewDynamic(e,j){e===void 0&&(e="current"),j===void 0&&(j=!1);const Vt=this,{params:zt,slides:_r,slidesGrid:_o,slidesSizesGrid:ga,size:_a,activeIndex:_l}=Vt;let _d=1;if(typeof zt.slidesPerView=="number")return zt.slidesPerView;if(zt.centeredSlides){let _f=_r[_l]?Math.ceil(_r[_l].swiperSlideSize):0,_m;for(let tE=_l+1;tE<_r.length;tE+=1)_r[tE]&&!_m&&(_f+=Math.ceil(_r[tE].swiperSlideSize),_d+=1,_f>_a&&(_m=!0));for(let tE=_l-1;tE>=0;tE-=1)_r[tE]&&!_m&&(_f+=_r[tE].swiperSlideSize,_d+=1,_f>_a&&(_m=!0))}else if(e==="current")for(let _f=_l+1;_f<_r.length;_f+=1)(j?_o[_f]+ga[_f]-_o[_l]<_a:_o[_f]-_o[_l]<_a)&&(_d+=1);else for(let _f=_l-1;_f>=0;_f-=1)_o[_l]-_o[_f]<_a&&(_d+=1);return _d}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:j,params:Vt}=e;Vt.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(_o=>{_o.complete&&processLazyPreloader(e,_o)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function zt(){const _o=e.rtlTranslate?e.translate*-1:e.translate,ga=Math.min(Math.max(_o,e.maxTranslate()),e.minTranslate());e.setTranslate(ga),e.updateActiveIndex(),e.updateSlidesClasses()}let _r;if(Vt.freeMode&&Vt.freeMode.enabled&&!Vt.cssMode)zt(),Vt.autoHeight&&e.updateAutoHeight();else{if((Vt.slidesPerView==="auto"||Vt.slidesPerView>1)&&e.isEnd&&!Vt.centeredSlides){const _o=e.virtual&&Vt.virtual.enabled?e.virtual.slides:e.slides;_r=e.slideTo(_o.length-1,0,!1,!0)}else _r=e.slideTo(e.activeIndex,0,!1,!0);_r||zt()}Vt.watchOverflow&&j!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,j){j===void 0&&(j=!0);const Vt=this,zt=Vt.params.direction;return e||(e=zt==="horizontal"?"vertical":"horizontal"),e===zt||e!=="horizontal"&&e!=="vertical"||(Vt.el.classList.remove(`${Vt.params.containerModifierClass}${zt}`),Vt.el.classList.add(`${Vt.params.containerModifierClass}${e}`),Vt.emitContainerClasses(),Vt.params.direction=e,Vt.slides.forEach(_r=>{e==="vertical"?_r.style.width="":_r.style.height=""}),Vt.emit("changeDirection"),j&&Vt.update()),Vt}changeLanguageDirection(e){const j=this;j.rtl&&e==="rtl"||!j.rtl&&e==="ltr"||(j.rtl=e==="rtl",j.rtlTranslate=j.params.direction==="horizontal"&&j.rtl,j.rtl?(j.el.classList.add(`${j.params.containerModifierClass}rtl`),j.el.dir="rtl"):(j.el.classList.remove(`${j.params.containerModifierClass}rtl`),j.el.dir="ltr"),j.update())}mount(e){const j=this;if(j.mounted)return!0;let Vt=e||j.params.el;if(typeof Vt=="string"&&(Vt=document.querySelector(Vt)),!Vt)return!1;Vt.swiper=j,Vt.parentNode&&Vt.parentNode.host&&Vt.parentNode.host.nodeName===j.params.swiperElementNodeName.toUpperCase()&&(j.isElement=!0);const zt=()=>`.${(j.params.wrapperClass||"").trim().split(" ").join(".")}`;let _o=Vt&&Vt.shadowRoot&&Vt.shadowRoot.querySelector?Vt.shadowRoot.querySelector(zt()):elementChildren(Vt,zt())[0];return!_o&&j.params.createElements&&(_o=createElement("div",j.params.wrapperClass),Vt.append(_o),elementChildren(Vt,`.${j.params.slideClass}`).forEach(ga=>{_o.append(ga)})),Object.assign(j,{el:Vt,wrapperEl:_o,slidesEl:j.isElement&&!Vt.parentNode.host.slideSlots?Vt.parentNode.host:_o,hostEl:j.isElement?Vt.parentNode.host:Vt,mounted:!0,rtl:Vt.dir.toLowerCase()==="rtl"||elementStyle(Vt,"direction")==="rtl",rtlTranslate:j.params.direction==="horizontal"&&(Vt.dir.toLowerCase()==="rtl"||elementStyle(Vt,"direction")==="rtl"),wrongRTL:elementStyle(_o,"display")==="-webkit-box"}),!0}init(e){const j=this;if(j.initialized||j.mount(e)===!1)return j;j.emit("beforeInit"),j.params.breakpoints&&j.setBreakpoint(),j.addClasses(),j.updateSize(),j.updateSlides(),j.params.watchOverflow&&j.checkOverflow(),j.params.grabCursor&&j.enabled&&j.setGrabCursor(),j.params.loop&&j.virtual&&j.params.virtual.enabled?j.slideTo(j.params.initialSlide+j.virtual.slidesBefore,0,j.params.runCallbacksOnInit,!1,!0):j.slideTo(j.params.initialSlide,0,j.params.runCallbacksOnInit,!1,!0),j.params.loop&&j.loopCreate(),j.attachEvents();const zt=[...j.el.querySelectorAll('[loading="lazy"]')];return j.isElement&&zt.push(...j.hostEl.querySelectorAll('[loading="lazy"]')),zt.forEach(_r=>{_r.complete?processLazyPreloader(j,_r):_r.addEventListener("load",_o=>{processLazyPreloader(j,_o.target)})}),preload(j),j.initialized=!0,preload(j),j.emit("init"),j.emit("afterInit"),j}destroy(e,j){e===void 0&&(e=!0),j===void 0&&(j=!0);const Vt=this,{params:zt,el:_r,wrapperEl:_o,slides:ga}=Vt;return typeof Vt.params>"u"||Vt.destroyed||(Vt.emit("beforeDestroy"),Vt.initialized=!1,Vt.detachEvents(),zt.loop&&Vt.loopDestroy(),j&&(Vt.removeClasses(),_r&&typeof _r!="string"&&_r.removeAttribute("style"),_o&&_o.removeAttribute("style"),ga&&ga.length&&ga.forEach(_a=>{_a.classList.remove(zt.slideVisibleClass,zt.slideFullyVisibleClass,zt.slideActiveClass,zt.slideNextClass,zt.slidePrevClass),_a.removeAttribute("style"),_a.removeAttribute("data-swiper-slide-index")})),Vt.emit("destroy"),Object.keys(Vt.eventsListeners).forEach(_a=>{Vt.off(_a)}),e!==!1&&(Vt.el&&typeof Vt.el!="string"&&(Vt.el.swiper=null),deleteProps(Vt)),Vt.destroyed=!0),null}static extendDefaults(e){extend$2(extendedDefaults,e)}static get extendedDefaults(){return extendedDefaults}static get defaults(){return defaults$1}static installModule(e){P1.prototype.__modules__||(P1.prototype.__modules__=[]);const j=P1.prototype.__modules__;typeof e=="function"&&j.indexOf(e)<0&&j.push(e)}static use(e){return Array.isArray(e)?(e.forEach(j=>P1.installModule(j)),P1):(P1.installModule(e),P1)}};Object.keys(prototypes).forEach(_=>{Object.keys(prototypes[_]).forEach(e=>{Swiper$1.prototype[e]=prototypes[_][e]})});Swiper$1.use([Resize,Observer]);const paramsList=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function isObject$1(_){return typeof _=="object"&&_!==null&&_.constructor&&Object.prototype.toString.call(_).slice(8,-1)==="Object"&&!_.__swiper__}function extend$1(_,e){const j=["__proto__","constructor","prototype"];Object.keys(e).filter(Vt=>j.indexOf(Vt)<0).forEach(Vt=>{typeof _[Vt]>"u"?_[Vt]=e[Vt]:isObject$1(e[Vt])&&isObject$1(_[Vt])&&Object.keys(e[Vt]).length>0?e[Vt].__swiper__?_[Vt]=e[Vt]:extend$1(_[Vt],e[Vt]):_[Vt]=e[Vt]})}function needsNavigation(_){return _===void 0&&(_={}),_.navigation&&typeof _.navigation.nextEl>"u"&&typeof _.navigation.prevEl>"u"}function needsPagination(_){return _===void 0&&(_={}),_.pagination&&typeof _.pagination.el>"u"}function needsScrollbar(_){return _===void 0&&(_={}),_.scrollbar&&typeof _.scrollbar.el>"u"}function uniqueClasses(_){_===void 0&&(_="");const e=_.split(" ").map(Vt=>Vt.trim()).filter(Vt=>!!Vt),j=[];return e.forEach(Vt=>{j.indexOf(Vt)<0&&j.push(Vt)}),j.join(" ")}function attrToProp(_){return _===void 0&&(_=""),_.replace(/-[a-z]/g,e=>e.toUpperCase().replace("-",""))}function wrapperClass(_){return _===void 0&&(_=""),_?_.includes("swiper-wrapper")?_:`swiper-wrapper ${_}`:"swiper-wrapper"}function updateSwiper(_){let{swiper:e,slides:j,passedParams:Vt,changedParams:zt,nextEl:_r,prevEl:_o,scrollbarEl:ga,paginationEl:_a}=_;const _l=zt.filter(ME=>ME!=="children"&&ME!=="direction"&&ME!=="wrapperClass"),{params:_d,pagination:_f,navigation:_m,scrollbar:tE,virtual:rE,thumbs:oE}=e;let dE,nE,sE,lE,EE,wE,IE,_E;zt.includes("thumbs")&&Vt.thumbs&&Vt.thumbs.swiper&&_d.thumbs&&!_d.thumbs.swiper&&(dE=!0),zt.includes("controller")&&Vt.controller&&Vt.controller.control&&_d.controller&&!_d.controller.control&&(nE=!0),zt.includes("pagination")&&Vt.pagination&&(Vt.pagination.el||_a)&&(_d.pagination||_d.pagination===!1)&&_f&&!_f.el&&(sE=!0),zt.includes("scrollbar")&&Vt.scrollbar&&(Vt.scrollbar.el||ga)&&(_d.scrollbar||_d.scrollbar===!1)&&tE&&!tE.el&&(lE=!0),zt.includes("navigation")&&Vt.navigation&&(Vt.navigation.prevEl||_o)&&(Vt.navigation.nextEl||_r)&&(_d.navigation||_d.navigation===!1)&&_m&&!_m.prevEl&&!_m.nextEl&&(EE=!0);const kE=ME=>{e[ME]&&(e[ME].destroy(),ME==="navigation"?(e.isElement&&(e[ME].prevEl.remove(),e[ME].nextEl.remove()),_d[ME].prevEl=void 0,_d[ME].nextEl=void 0,e[ME].prevEl=void 0,e[ME].nextEl=void 0):(e.isElement&&e[ME].el.remove(),_d[ME].el=void 0,e[ME].el=void 0))};zt.includes("loop")&&e.isElement&&(_d.loop&&!Vt.loop?wE=!0:!_d.loop&&Vt.loop?IE=!0:_E=!0),_l.forEach(ME=>{if(isObject$1(_d[ME])&&isObject$1(Vt[ME]))Object.assign(_d[ME],Vt[ME]),(ME==="navigation"||ME==="pagination"||ME==="scrollbar")&&"enabled"in Vt[ME]&&!Vt[ME].enabled&&kE(ME);else{const bE=Vt[ME];(bE===!0||bE===!1)&&(ME==="navigation"||ME==="pagination"||ME==="scrollbar")?bE===!1&&kE(ME):_d[ME]=Vt[ME]}}),_l.includes("controller")&&!nE&&e.controller&&e.controller.control&&_d.controller&&_d.controller.control&&(e.controller.control=_d.controller.control),zt.includes("children")&&j&&rE&&_d.virtual.enabled?(rE.slides=j,rE.update(!0)):zt.includes("virtual")&&rE&&_d.virtual.enabled&&(j&&(rE.slides=j),rE.update(!0)),zt.includes("children")&&j&&_d.loop&&(_E=!0),dE&&oE.init()&&oE.update(!0),nE&&(e.controller.control=_d.controller.control),sE&&(e.isElement&&(!_a||typeof _a=="string")&&(_a=document.createElement("div"),_a.classList.add("swiper-pagination"),_a.part.add("pagination"),e.el.appendChild(_a)),_a&&(_d.pagination.el=_a),_f.init(),_f.render(),_f.update()),lE&&(e.isElement&&(!ga||typeof ga=="string")&&(ga=document.createElement("div"),ga.classList.add("swiper-scrollbar"),ga.part.add("scrollbar"),e.el.appendChild(ga)),ga&&(_d.scrollbar.el=ga),tE.init(),tE.updateSize(),tE.setTranslate()),EE&&(e.isElement&&((!_r||typeof _r=="string")&&(_r=document.createElement("div"),_r.classList.add("swiper-button-next"),_r.innerHTML=e.hostEl.constructor.nextButtonSvg,_r.part.add("button-next"),e.el.appendChild(_r)),(!_o||typeof _o=="string")&&(_o=document.createElement("div"),_o.classList.add("swiper-button-prev"),_o.innerHTML=e.hostEl.constructor.prevButtonSvg,_o.part.add("button-prev"),e.el.appendChild(_o))),_r&&(_d.navigation.nextEl=_r),_o&&(_d.navigation.prevEl=_o),_m.init(),_m.update()),zt.includes("allowSlideNext")&&(e.allowSlideNext=Vt.allowSlideNext),zt.includes("allowSlidePrev")&&(e.allowSlidePrev=Vt.allowSlidePrev),zt.includes("direction")&&e.changeDirection(Vt.direction,!1),(wE||_E)&&e.loopDestroy(),(IE||_E)&&e.loopCreate(),e.update()}function getParams$1(_,e){_===void 0&&(_={}),e===void 0&&(e=!0);const j={on:{}},Vt={},zt={};extend$1(j,defaults$1),j._emitClasses=!0,j.init=!1;const _r={},_o=paramsList.map(_a=>_a.replace(/_/,"")),ga=Object.assign({},_);return Object.keys(ga).forEach(_a=>{typeof _[_a]>"u"||(_o.indexOf(_a)>=0?isObject$1(_[_a])?(j[_a]={},zt[_a]={},extend$1(j[_a],_[_a]),extend$1(zt[_a],_[_a])):(j[_a]=_[_a],zt[_a]=_[_a]):_a.search(/on[A-Z]/)===0&&typeof _[_a]=="function"?e?Vt[`${_a[2].toLowerCase()}${_a.substr(3)}`]=_[_a]:j.on[`${_a[2].toLowerCase()}${_a.substr(3)}`]=_[_a]:_r[_a]=_[_a])}),["navigation","pagination","scrollbar"].forEach(_a=>{j[_a]===!0&&(j[_a]={}),j[_a]===!1&&delete j[_a]}),{params:j,passedParams:zt,rest:_r,events:Vt}}function mountSwiper(_,e){let{el:j,nextEl:Vt,prevEl:zt,paginationEl:_r,scrollbarEl:_o,swiper:ga}=_;needsNavigation(e)&&Vt&&zt&&(ga.params.navigation.nextEl=Vt,ga.originalParams.navigation.nextEl=Vt,ga.params.navigation.prevEl=zt,ga.originalParams.navigation.prevEl=zt),needsPagination(e)&&_r&&(ga.params.pagination.el=_r,ga.originalParams.pagination.el=_r),needsScrollbar(e)&&_o&&(ga.params.scrollbar.el=_o,ga.originalParams.scrollbar.el=_o),ga.init(j)}function getChangedParams(_,e,j,Vt,zt){const _r=[];if(!e)return _r;const _o=_a=>{_r.indexOf(_a)<0&&_r.push(_a)};if(j&&Vt){const _a=Vt.map(zt),_l=j.map(zt);_a.join("")!==_l.join("")&&_o("children"),Vt.length!==j.length&&_o("children")}return paramsList.filter(_a=>_a[0]==="_").map(_a=>_a.replace(/_/,"")).forEach(_a=>{if(_a in _&&_a in e)if(isObject$1(_[_a])&&isObject$1(e[_a])){const _l=Object.keys(_[_a]),_d=Object.keys(e[_a]);_l.length!==_d.length?_o(_a):(_l.forEach(_f=>{_[_a][_f]!==e[_a][_f]&&_o(_a)}),_d.forEach(_f=>{_[_a][_f]!==e[_a][_f]&&_o(_a)}))}else _[_a]!==e[_a]&&_o(_a)}),_r}const updateOnVirtualData=_=>{!_||_.destroyed||!_.params.virtual||_.params.virtual&&!_.params.virtual.enabled||(_.updateSlides(),_.updateProgress(),_.updateSlidesClasses(),_.parallax&&_.params.parallax&&_.params.parallax.enabled&&_.parallax.setTranslate())};function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(_){for(var e=1;e<arguments.length;e++){var j=arguments[e];for(var Vt in j)Object.prototype.hasOwnProperty.call(j,Vt)&&(_[Vt]=j[Vt])}return _},_extends$1.apply(this,arguments)}function isChildSwiperSlide(_){return _.type&&_.type.displayName&&_.type.displayName.includes("SwiperSlide")}function processChildren(_){const e=[];return React.Children.toArray(_).forEach(j=>{isChildSwiperSlide(j)?e.push(j):j.props&&j.props.children&&processChildren(j.props.children).forEach(Vt=>e.push(Vt))}),e}function getChildren(_){const e=[],j={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return React.Children.toArray(_).forEach(Vt=>{if(isChildSwiperSlide(Vt))e.push(Vt);else if(Vt.props&&Vt.props.slot&&j[Vt.props.slot])j[Vt.props.slot].push(Vt);else if(Vt.props&&Vt.props.children){const zt=processChildren(Vt.props.children);zt.length>0?zt.forEach(_r=>e.push(_r)):j["container-end"].push(Vt)}else j["container-end"].push(Vt)}),{slides:e,slots:j}}function renderVirtual(_,e,j){if(!j)return null;const Vt=_d=>{let _f=_d;return _d<0?_f=e.length+_d:_f>=e.length&&(_f=_f-e.length),_f},zt=_.isHorizontal()?{[_.rtlTranslate?"right":"left"]:`${j.offset}px`}:{top:`${j.offset}px`},{from:_r,to:_o}=j,ga=_.params.loop?-e.length:0,_a=_.params.loop?e.length*2:e.length,_l=[];for(let _d=ga;_d<_a;_d+=1)_d>=_r&&_d<=_o&&_l.push(e[Vt(_d)]);return _l.map((_d,_f)=>React.cloneElement(_d,{swiper:_,style:zt,key:_d.props.virtualIndex||_d.key||`slide-${_f}`}))}function useIsomorphicLayoutEffect(_,e){return typeof window>"u"?reactExports.useEffect(_,e):reactExports.useLayoutEffect(_,e)}const SwiperSlideContext=reactExports.createContext(null),SwiperContext=reactExports.createContext(null),Swiper=reactExports.forwardRef(function(_,e){let{className:j,tag:Vt="div",wrapperTag:zt="div",children:_r,onSwiper:_o,...ga}=_===void 0?{}:_,_a=!1;const[_l,_d]=reactExports.useState("swiper"),[_f,_m]=reactExports.useState(null),[tE,rE]=reactExports.useState(!1),oE=reactExports.useRef(!1),dE=reactExports.useRef(null),nE=reactExports.useRef(null),sE=reactExports.useRef(null),lE=reactExports.useRef(null),EE=reactExports.useRef(null),wE=reactExports.useRef(null),IE=reactExports.useRef(null),_E=reactExports.useRef(null),{params:kE,passedParams:ME,rest:bE,events:LE}=getParams$1(ga),{slides:TE,slots:OE}=getChildren(_r),vE=()=>{rE(!tE)};Object.assign(kE.on,{_containerClasses(FE,VE){_d(VE)}});const NE=()=>{Object.assign(kE.on,LE),_a=!0;const FE={...kE};if(delete FE.wrapperClass,nE.current=new Swiper$1(FE),nE.current.virtual&&nE.current.params.virtual.enabled){nE.current.virtual.slides=TE;const VE={cache:!1,slides:TE,renderExternal:_m,renderExternalUpdate:!1};extend$1(nE.current.params.virtual,VE),extend$1(nE.current.originalParams.virtual,VE)}};dE.current||NE(),nE.current&&nE.current.on("_beforeBreakpoint",vE);const jE=()=>{_a||!LE||!nE.current||Object.keys(LE).forEach(FE=>{nE.current.on(FE,LE[FE])})},UE=()=>{!LE||!nE.current||Object.keys(LE).forEach(FE=>{nE.current.off(FE,LE[FE])})};reactExports.useEffect(()=>()=>{nE.current&&nE.current.off("_beforeBreakpoint",vE)}),reactExports.useEffect(()=>{!oE.current&&nE.current&&(nE.current.emitSlidesClasses(),oE.current=!0)}),useIsomorphicLayoutEffect(()=>{if(e&&(e.current=dE.current),!!dE.current)return nE.current.destroyed&&NE(),mountSwiper({el:dE.current,nextEl:EE.current,prevEl:wE.current,paginationEl:IE.current,scrollbarEl:_E.current,swiper:nE.current},kE),_o&&!nE.current.destroyed&&_o(nE.current),()=>{nE.current&&!nE.current.destroyed&&nE.current.destroy(!0,!1)}},[]),useIsomorphicLayoutEffect(()=>{jE();const FE=getChangedParams(ME,sE.current,TE,lE.current,VE=>VE.key);return sE.current=ME,lE.current=TE,FE.length&&nE.current&&!nE.current.destroyed&&updateSwiper({swiper:nE.current,slides:TE,passedParams:ME,changedParams:FE,nextEl:EE.current,prevEl:wE.current,scrollbarEl:_E.current,paginationEl:IE.current}),()=>{UE()}}),useIsomorphicLayoutEffect(()=>{updateOnVirtualData(nE.current)},[_f]);function RE(){return kE.virtual?renderVirtual(nE.current,TE,_f):TE.map((FE,VE)=>React.cloneElement(FE,{swiper:nE.current,swiperSlideIndex:VE}))}return React.createElement(Vt,_extends$1({ref:dE,className:uniqueClasses(`${_l}${j?` ${j}`:""}`)},bE),React.createElement(SwiperContext.Provider,{value:nE.current},OE["container-start"],React.createElement(zt,{className:wrapperClass(kE.wrapperClass)},OE["wrapper-start"],RE(),OE["wrapper-end"]),needsNavigation(kE)&&React.createElement(React.Fragment,null,React.createElement("div",{ref:wE,className:"swiper-button-prev"}),React.createElement("div",{ref:EE,className:"swiper-button-next"})),needsScrollbar(kE)&&React.createElement("div",{ref:_E,className:"swiper-scrollbar"}),needsPagination(kE)&&React.createElement("div",{ref:IE,className:"swiper-pagination"}),OE["container-end"]))});Swiper.displayName="Swiper";const SwiperSlide$1=reactExports.forwardRef(function(_,e){let{tag:j="div",children:Vt,className:zt="",swiper:_r,zoom:_o,lazy:ga,virtualIndex:_a,swiperSlideIndex:_l,..._d}=_===void 0?{}:_;const _f=reactExports.useRef(null),[_m,tE]=reactExports.useState("swiper-slide"),[rE,oE]=reactExports.useState(!1);function dE(EE,wE,IE){wE===_f.current&&tE(IE)}useIsomorphicLayoutEffect(()=>{if(typeof _l<"u"&&(_f.current.swiperSlideIndex=_l),e&&(e.current=_f.current),!(!_f.current||!_r)){if(_r.destroyed){_m!=="swiper-slide"&&tE("swiper-slide");return}return _r.on("_slideClass",dE),()=>{_r&&_r.off("_slideClass",dE)}}}),useIsomorphicLayoutEffect(()=>{_r&&_f.current&&!_r.destroyed&&tE(_r.getSlideClasses(_f.current))},[_r]);const nE={isActive:_m.indexOf("swiper-slide-active")>=0,isVisible:_m.indexOf("swiper-slide-visible")>=0,isPrev:_m.indexOf("swiper-slide-prev")>=0,isNext:_m.indexOf("swiper-slide-next")>=0},sE=()=>typeof Vt=="function"?Vt(nE):Vt,lE=()=>{oE(!0)};return React.createElement(j,_extends$1({ref:_f,className:uniqueClasses(`${_m}${zt?` ${zt}`:""}`),"data-swiper-slide-index":_a,onLoad:lE},_d),_o&&React.createElement(SwiperSlideContext.Provider,{value:nE},React.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof _o=="number"?_o:void 0},sE(),ga&&!rE&&React.createElement("div",{className:"swiper-lazy-preloader"}))),!_o&&React.createElement(SwiperSlideContext.Provider,{value:nE},sE(),ga&&!rE&&React.createElement("div",{className:"swiper-lazy-preloader"})))});SwiperSlide$1.displayName="SwiperSlide";const Home=()=>{const[_,e]=reactExports.useState([]),[j,Vt]=reactExports.useState(""),[zt,_r]=reactExports.useState([{name:"Geral",selected:!0},{name:"Comunicao Interna",selected:!1},{name:"Despacho",selected:!1},{name:"Comunicao externa",selected:!1}]),_o=()=>{fetch(`${backend_rtc}/load_feed`,{method:"GET"}).then(function(_d){return _d.json()}).then(function(_d){e(_d.response)}).catch(_d=>alert("Error:",_d))};reactExports.useEffect(()=>{_o()},[]);const ga=_d=>{Vt(_d.target.value)},_a=_d=>{const _f=zt.map(_m=>_m.name==_d?{..._m,selected:!0}:{..._m,selected:!1});Vt(_d),_r(_f)},_l=j===""||j=="Geral"?_:_.filter(_d=>_d.category.toLowerCase()==j.toLowerCase());return jsxRuntimeExports.jsx(AppLayout,{searchBarPlaceHolder:"Buscar notcias",showSearchBar:!0,onSearch:ga,children:jsxRuntimeExports.jsxs("div",{className:"grid overflow-hidden items-start mt-10 2xl:pt-16 pt-2 mx-4",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-row justify-center justify-self-center mt-4 py-2 gap-3 flex-wrap  w-3/4 rounded-tl-md rounded-tr-md bg-white",children:zt.map(({name:_d,selected:_f})=>jsxRuntimeExports.jsx("button",{onClick:()=>_a(_d),className:`p-1 rounded-md ${_f==!0?"text-white bg-primary":"bg-white text-yellow-600"}`,children:_d},_d))}),jsxRuntimeExports.jsx(Swiper,{spaceBetween:50,pagination:!0,navigation:!0,slidesPerView:1,onSlideChange:()=>console.log("slide change"),onSwiper:_d=>console.log(_d),autoplay:!0,className:"2xl:h-[60%] h-[90%] w-3/4",children:_l.map(({createdAt:_d,description:_f,url_external_link:_m,event:tE,id:rE,midia:oE,midia_type:dE})=>jsxRuntimeExports.jsx(SwiperSlide$1,{children:jsxRuntimeExports.jsxs("div",{className:"h-full w-full rounded-bl-md rounded-br-md relative overflow-hidden",children:[_m&&jsxRuntimeExports.jsxs("a",{href:_m,target:"_blank",rel:"noopener noreferrer",children:[dE==1&&jsxRuntimeExports.jsx("img",{src:oE,className:"h-full w-full object-cover"}),jsxRuntimeExports.jsx("p",{className:"absolute bottom-8 right-3 bg-white bg-opacity-60 p-2 rounded-md",children:tE})]}),!_m&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[dE==1&&jsxRuntimeExports.jsx("img",{src:oE,className:"h-full w-full object-cover"}),jsxRuntimeExports.jsx("p",{className:"absolute bottom-8 right-3 bg-white bg-opacity-60 p-2 rounded-md",children:tE})]})]})},rE))})]})})};function bind(_,e){return function(){return _.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(_=>e=>{const j=toString.call(e);return _[j]||(_[j]=j.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=_=>(_=_.toLowerCase(),e=>kindOf(e)===_),typeOfTest=_=>e=>typeof e===_,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(_){return _!==null&&!isUndefined(_)&&_.constructor!==null&&!isUndefined(_.constructor)&&isFunction(_.constructor.isBuffer)&&_.constructor.isBuffer(_)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(_){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(_):e=_&&_.buffer&&isArrayBuffer(_.buffer),e}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=_=>_!==null&&typeof _=="object",isBoolean=_=>_===!0||_===!1,isPlainObject=_=>{if(kindOf(_)!=="object")return!1;const e=getPrototypeOf(_);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in _)&&!(Symbol.iterator in _)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=_=>isObject(_)&&isFunction(_.pipe),isFormData=_=>{let e;return _&&(typeof FormData=="function"&&_ instanceof FormData||isFunction(_.append)&&((e=kindOf(_))==="formdata"||e==="object"&&isFunction(_.toString)&&_.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=_=>_.trim?_.trim():_.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(_,e,{allOwnKeys:j=!1}={}){if(_===null||typeof _>"u")return;let Vt,zt;if(typeof _!="object"&&(_=[_]),isArray(_))for(Vt=0,zt=_.length;Vt<zt;Vt++)e.call(null,_[Vt],Vt,_);else{const _r=j?Object.getOwnPropertyNames(_):Object.keys(_),_o=_r.length;let ga;for(Vt=0;Vt<_o;Vt++)ga=_r[Vt],e.call(null,_[ga],ga,_)}}function findKey(_,e){e=e.toLowerCase();const j=Object.keys(_);let Vt=j.length,zt;for(;Vt-- >0;)if(zt=j[Vt],e===zt.toLowerCase())return zt;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=_=>!isUndefined(_)&&_!==_global;function merge(){const{caseless:_}=isContextDefined(this)&&this||{},e={},j=(Vt,zt)=>{const _r=_&&findKey(e,zt)||zt;isPlainObject(e[_r])&&isPlainObject(Vt)?e[_r]=merge(e[_r],Vt):isPlainObject(Vt)?e[_r]=merge({},Vt):isArray(Vt)?e[_r]=Vt.slice():e[_r]=Vt};for(let Vt=0,zt=arguments.length;Vt<zt;Vt++)arguments[Vt]&&forEach(arguments[Vt],j);return e}const extend=(_,e,j,{allOwnKeys:Vt}={})=>(forEach(e,(zt,_r)=>{j&&isFunction(zt)?_[_r]=bind(zt,j):_[_r]=zt},{allOwnKeys:Vt}),_),stripBOM=_=>(_.charCodeAt(0)===65279&&(_=_.slice(1)),_),inherits=(_,e,j,Vt)=>{_.prototype=Object.create(e.prototype,Vt),_.prototype.constructor=_,Object.defineProperty(_,"super",{value:e.prototype}),j&&Object.assign(_.prototype,j)},toFlatObject=(_,e,j,Vt)=>{let zt,_r,_o;const ga={};if(e=e||{},_==null)return e;do{for(zt=Object.getOwnPropertyNames(_),_r=zt.length;_r-- >0;)_o=zt[_r],(!Vt||Vt(_o,_,e))&&!ga[_o]&&(e[_o]=_[_o],ga[_o]=!0);_=j!==!1&&getPrototypeOf(_)}while(_&&(!j||j(_,e))&&_!==Object.prototype);return e},endsWith=(_,e,j)=>{_=String(_),(j===void 0||j>_.length)&&(j=_.length),j-=e.length;const Vt=_.indexOf(e,j);return Vt!==-1&&Vt===j},toArray=_=>{if(!_)return null;if(isArray(_))return _;let e=_.length;if(!isNumber(e))return null;const j=new Array(e);for(;e-- >0;)j[e]=_[e];return j},isTypedArray=(_=>e=>_&&e instanceof _)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(_,e)=>{const Vt=(_&&_[Symbol.iterator]).call(_);let zt;for(;(zt=Vt.next())&&!zt.done;){const _r=zt.value;e.call(_,_r[0],_r[1])}},matchAll=(_,e)=>{let j;const Vt=[];for(;(j=_.exec(e))!==null;)Vt.push(j);return Vt},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=_=>_.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(j,Vt,zt){return Vt.toUpperCase()+zt}),hasOwnProperty=(({hasOwnProperty:_})=>(e,j)=>_.call(e,j))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(_,e)=>{const j=Object.getOwnPropertyDescriptors(_),Vt={};forEach(j,(zt,_r)=>{let _o;(_o=e(zt,_r,_))!==!1&&(Vt[_r]=_o||zt)}),Object.defineProperties(_,Vt)},freezeMethods=_=>{reduceDescriptors(_,(e,j)=>{if(isFunction(_)&&["arguments","caller","callee"].indexOf(j)!==-1)return!1;const Vt=_[j];if(isFunction(Vt)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+j+"'")})}})},toObjectSet=(_,e)=>{const j={},Vt=zt=>{zt.forEach(_r=>{j[_r]=!0})};return isArray(_)?Vt(_):Vt(String(_).split(e)),j},noop=()=>{},toFiniteNumber=(_,e)=>_!=null&&Number.isFinite(_=+_)?_:e,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(_=16,e=ALPHABET.ALPHA_DIGIT)=>{let j="";const{length:Vt}=e;for(;_--;)j+=e[Math.random()*Vt|0];return j};function isSpecCompliantForm(_){return!!(_&&isFunction(_.append)&&_[Symbol.toStringTag]==="FormData"&&_[Symbol.iterator])}const toJSONObject=_=>{const e=new Array(10),j=(Vt,zt)=>{if(isObject(Vt)){if(e.indexOf(Vt)>=0)return;if(!("toJSON"in Vt)){e[zt]=Vt;const _r=isArray(Vt)?[]:{};return forEach(Vt,(_o,ga)=>{const _a=j(_o,zt+1);!isUndefined(_a)&&(_r[ga]=_a)}),e[zt]=void 0,_r}}return Vt};return j(_,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=_=>_&&(isObject(_)||isFunction(_))&&isFunction(_.then)&&isFunction(_.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(_,e,j,Vt,zt){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=_,this.name="AxiosError",e&&(this.code=e),j&&(this.config=j),Vt&&(this.request=Vt),zt&&(this.response=zt)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(_=>{descriptors[_]={value:_}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(_,e,j,Vt,zt,_r)=>{const _o=Object.create(prototype$1);return utils$1.toFlatObject(_,_o,function(_a){return _a!==Error.prototype},ga=>ga!=="isAxiosError"),AxiosError.call(_o,_.message,e,j,Vt,zt),_o.cause=_,_o.name=_.name,_r&&Object.assign(_o,_r),_o};const httpAdapter=null;function isVisitable(_){return utils$1.isPlainObject(_)||utils$1.isArray(_)}function removeBrackets(_){return utils$1.endsWith(_,"[]")?_.slice(0,-2):_}function renderKey(_,e,j){return _?_.concat(e).map(function(zt,_r){return zt=removeBrackets(zt),!j&&_r?"["+zt+"]":zt}).join(j?".":""):e}function isFlatArray(_){return utils$1.isArray(_)&&!_.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData(_,e,j){if(!utils$1.isObject(_))throw new TypeError("target must be an object");e=e||new FormData,j=utils$1.toFlatObject(j,{metaTokens:!0,dots:!1,indexes:!1},!1,function(oE,dE){return!utils$1.isUndefined(dE[oE])});const Vt=j.metaTokens,zt=j.visitor||_d,_r=j.dots,_o=j.indexes,_a=(j.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(e);if(!utils$1.isFunction(zt))throw new TypeError("visitor must be a function");function _l(rE){if(rE===null)return"";if(utils$1.isDate(rE))return rE.toISOString();if(!_a&&utils$1.isBlob(rE))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(rE)||utils$1.isTypedArray(rE)?_a&&typeof Blob=="function"?new Blob([rE]):Buffer.from(rE):rE}function _d(rE,oE,dE){let nE=rE;if(rE&&!dE&&typeof rE=="object"){if(utils$1.endsWith(oE,"{}"))oE=Vt?oE:oE.slice(0,-2),rE=JSON.stringify(rE);else if(utils$1.isArray(rE)&&isFlatArray(rE)||(utils$1.isFileList(rE)||utils$1.endsWith(oE,"[]"))&&(nE=utils$1.toArray(rE)))return oE=removeBrackets(oE),nE.forEach(function(lE,EE){!(utils$1.isUndefined(lE)||lE===null)&&e.append(_o===!0?renderKey([oE],EE,_r):_o===null?oE:oE+"[]",_l(lE))}),!1}return isVisitable(rE)?!0:(e.append(renderKey(dE,oE,_r),_l(rE)),!1)}const _f=[],_m=Object.assign(predicates,{defaultVisitor:_d,convertValue:_l,isVisitable});function tE(rE,oE){if(!utils$1.isUndefined(rE)){if(_f.indexOf(rE)!==-1)throw Error("Circular reference detected in "+oE.join("."));_f.push(rE),utils$1.forEach(rE,function(nE,sE){(!(utils$1.isUndefined(nE)||nE===null)&&zt.call(e,nE,utils$1.isString(sE)?sE.trim():sE,oE,_m))===!0&&tE(nE,oE?oE.concat(sE):[sE])}),_f.pop()}}if(!utils$1.isObject(_))throw new TypeError("data must be an object");return tE(_),e}function encode$1(_){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(_).replace(/[!'()~]|%20|%00/g,function(Vt){return e[Vt]})}function AxiosURLSearchParams(_,e){this._pairs=[],_&&toFormData(_,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,j){this._pairs.push([e,j])};prototype.toString=function(e){const j=e?function(Vt){return e.call(this,Vt,encode$1)}:encode$1;return this._pairs.map(function(zt){return j(zt[0])+"="+j(zt[1])},"").join("&")};function encode(_){return encodeURIComponent(_).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(_,e,j){if(!e)return _;const Vt=j&&j.encode||encode,zt=j&&j.serialize;let _r;if(zt?_r=zt(e,j):_r=utils$1.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,j).toString(Vt),_r){const _o=_.indexOf("#");_o!==-1&&(_=_.slice(0,_o)),_+=(_.indexOf("?")===-1?"?":"&")+_r}return _}class InterceptorManager{constructor(){this.handlers=[]}use(e,j,Vt){return this.handlers.push({fulfilled:e,rejected:j,synchronous:Vt?Vt.synchronous:!1,runWhen:Vt?Vt.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$1.forEach(this.handlers,function(Vt){Vt!==null&&e(Vt)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(_=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(_)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(_,e){return toFormData(_,new platform.classes.URLSearchParams,Object.assign({visitor:function(j,Vt,zt,_r){return platform.isNode&&utils$1.isBuffer(j)?(this.append(Vt,j.toString("base64")),!1):_r.defaultVisitor.apply(this,arguments)}},e))}function parsePropPath(_){return utils$1.matchAll(/\w+|\[(\w*)]/g,_).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(_){const e={},j=Object.keys(_);let Vt;const zt=j.length;let _r;for(Vt=0;Vt<zt;Vt++)_r=j[Vt],e[_r]=_[_r];return e}function formDataToJSON(_){function e(j,Vt,zt,_r){let _o=j[_r++];if(_o==="__proto__")return!0;const ga=Number.isFinite(+_o),_a=_r>=j.length;return _o=!_o&&utils$1.isArray(zt)?zt.length:_o,_a?(utils$1.hasOwnProp(zt,_o)?zt[_o]=[zt[_o],Vt]:zt[_o]=Vt,!ga):((!zt[_o]||!utils$1.isObject(zt[_o]))&&(zt[_o]=[]),e(j,Vt,zt[_o],_r)&&utils$1.isArray(zt[_o])&&(zt[_o]=arrayToObject(zt[_o])),!ga)}if(utils$1.isFormData(_)&&utils$1.isFunction(_.entries)){const j={};return utils$1.forEachEntry(_,(Vt,zt)=>{e(parsePropPath(Vt),zt,j,0)}),j}return null}function stringifySafely(_,e,j){if(utils$1.isString(_))try{return(e||JSON.parse)(_),utils$1.trim(_)}catch(Vt){if(Vt.name!=="SyntaxError")throw Vt}return(j||JSON.stringify)(_)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,j){const Vt=j.getContentType()||"",zt=Vt.indexOf("application/json")>-1,_r=utils$1.isObject(e);if(_r&&utils$1.isHTMLForm(e)&&(e=new FormData(e)),utils$1.isFormData(e))return zt?JSON.stringify(formDataToJSON(e)):e;if(utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)||utils$1.isReadableStream(e))return e;if(utils$1.isArrayBufferView(e))return e.buffer;if(utils$1.isURLSearchParams(e))return j.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let ga;if(_r){if(Vt.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((ga=utils$1.isFileList(e))||Vt.indexOf("multipart/form-data")>-1){const _a=this.env&&this.env.FormData;return toFormData(ga?{"files[]":e}:e,_a&&new _a,this.formSerializer)}}return _r||zt?(j.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const j=this.transitional||defaults.transitional,Vt=j&&j.forcedJSONParsing,zt=this.responseType==="json";if(utils$1.isResponse(e)||utils$1.isReadableStream(e))return e;if(e&&utils$1.isString(e)&&(Vt&&!this.responseType||zt)){const _o=!(j&&j.silentJSONParsing)&&zt;try{return JSON.parse(e)}catch(ga){if(_o)throw ga.name==="SyntaxError"?AxiosError.from(ga,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):ga}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],_=>{defaults.headers[_]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=_=>{const e={};let j,Vt,zt;return _&&_.split(`
`).forEach(function(_o){zt=_o.indexOf(":"),j=_o.substring(0,zt).trim().toLowerCase(),Vt=_o.substring(zt+1).trim(),!(!j||e[j]&&ignoreDuplicateOf[j])&&(j==="set-cookie"?e[j]?e[j].push(Vt):e[j]=[Vt]:e[j]=e[j]?e[j]+", "+Vt:Vt)}),e},$internals=Symbol("internals");function normalizeHeader(_){return _&&String(_).trim().toLowerCase()}function normalizeValue(_){return _===!1||_==null?_:utils$1.isArray(_)?_.map(normalizeValue):String(_)}function parseTokens(_){const e=Object.create(null),j=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let Vt;for(;Vt=j.exec(_);)e[Vt[1]]=Vt[2];return e}const isValidHeaderName=_=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(_.trim());function matchHeaderValue(_,e,j,Vt,zt){if(utils$1.isFunction(Vt))return Vt.call(this,e,j);if(zt&&(e=j),!!utils$1.isString(e)){if(utils$1.isString(Vt))return e.indexOf(Vt)!==-1;if(utils$1.isRegExp(Vt))return Vt.test(e)}}function formatHeader(_){return _.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,j,Vt)=>j.toUpperCase()+Vt)}function buildAccessors(_,e){const j=utils$1.toCamelCase(" "+e);["get","set","has"].forEach(Vt=>{Object.defineProperty(_,Vt+j,{value:function(zt,_r,_o){return this[Vt].call(this,e,zt,_r,_o)},configurable:!0})})}class AxiosHeaders{constructor(e){e&&this.set(e)}set(e,j,Vt){const zt=this;function _r(ga,_a,_l){const _d=normalizeHeader(_a);if(!_d)throw new Error("header name must be a non-empty string");const _f=utils$1.findKey(zt,_d);(!_f||zt[_f]===void 0||_l===!0||_l===void 0&&zt[_f]!==!1)&&(zt[_f||_a]=normalizeValue(ga))}const _o=(ga,_a)=>utils$1.forEach(ga,(_l,_d)=>_r(_l,_d,_a));if(utils$1.isPlainObject(e)||e instanceof this.constructor)_o(e,j);else if(utils$1.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))_o(parseHeaders(e),j);else if(utils$1.isHeaders(e))for(const[ga,_a]of e.entries())_r(_a,ga,Vt);else e!=null&&_r(j,e,Vt);return this}get(e,j){if(e=normalizeHeader(e),e){const Vt=utils$1.findKey(this,e);if(Vt){const zt=this[Vt];if(!j)return zt;if(j===!0)return parseTokens(zt);if(utils$1.isFunction(j))return j.call(this,zt,Vt);if(utils$1.isRegExp(j))return j.exec(zt);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,j){if(e=normalizeHeader(e),e){const Vt=utils$1.findKey(this,e);return!!(Vt&&this[Vt]!==void 0&&(!j||matchHeaderValue(this,this[Vt],Vt,j)))}return!1}delete(e,j){const Vt=this;let zt=!1;function _r(_o){if(_o=normalizeHeader(_o),_o){const ga=utils$1.findKey(Vt,_o);ga&&(!j||matchHeaderValue(Vt,Vt[ga],ga,j))&&(delete Vt[ga],zt=!0)}}return utils$1.isArray(e)?e.forEach(_r):_r(e),zt}clear(e){const j=Object.keys(this);let Vt=j.length,zt=!1;for(;Vt--;){const _r=j[Vt];(!e||matchHeaderValue(this,this[_r],_r,e,!0))&&(delete this[_r],zt=!0)}return zt}normalize(e){const j=this,Vt={};return utils$1.forEach(this,(zt,_r)=>{const _o=utils$1.findKey(Vt,_r);if(_o){j[_o]=normalizeValue(zt),delete j[_r];return}const ga=e?formatHeader(_r):String(_r).trim();ga!==_r&&delete j[_r],j[ga]=normalizeValue(zt),Vt[ga]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const j=Object.create(null);return utils$1.forEach(this,(Vt,zt)=>{Vt!=null&&Vt!==!1&&(j[zt]=e&&utils$1.isArray(Vt)?Vt.join(", "):Vt)}),j}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,j])=>e+": "+j).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...j){const Vt=new this(e);return j.forEach(zt=>Vt.set(zt)),Vt}static accessor(e){const Vt=(this[$internals]=this[$internals]={accessors:{}}).accessors,zt=this.prototype;function _r(_o){const ga=normalizeHeader(_o);Vt[ga]||(buildAccessors(zt,_o),Vt[ga]=!0)}return utils$1.isArray(e)?e.forEach(_r):_r(e),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:_},e)=>{let j=e[0].toUpperCase()+e.slice(1);return{get:()=>_,set(Vt){this[j]=Vt}}});utils$1.freezeMethods(AxiosHeaders);function transformData(_,e){const j=this||defaults,Vt=e||j,zt=AxiosHeaders.from(Vt.headers);let _r=Vt.data;return utils$1.forEach(_,function(ga){_r=ga.call(j,_r,zt.normalize(),e?e.status:void 0)}),zt.normalize(),_r}function isCancel(_){return!!(_&&_.__CANCEL__)}function CanceledError(_,e,j){AxiosError.call(this,_??"canceled",AxiosError.ERR_CANCELED,e,j),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(_,e,j){const Vt=j.config.validateStatus;!j.status||!Vt||Vt(j.status)?_(j):e(new AxiosError("Request failed with status code "+j.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(j.status/100)-4],j.config,j.request,j))}function parseProtocol(_){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(_);return e&&e[1]||""}function speedometer(_,e){_=_||10;const j=new Array(_),Vt=new Array(_);let zt=0,_r=0,_o;return e=e!==void 0?e:1e3,function(_a){const _l=Date.now(),_d=Vt[_r];_o||(_o=_l),j[zt]=_a,Vt[zt]=_l;let _f=_r,_m=0;for(;_f!==zt;)_m+=j[_f++],_f=_f%_;if(zt=(zt+1)%_,zt===_r&&(_r=(_r+1)%_),_l-_o<e)return;const tE=_d&&_l-_d;return tE?Math.round(_m*1e3/tE):void 0}}function throttle(_,e){let j=0;const Vt=1e3/e;let zt=null;return function(){const _o=this===!0,ga=Date.now();if(_o||ga-j>Vt)return zt&&(clearTimeout(zt),zt=null),j=ga,_.apply(null,arguments);zt||(zt=setTimeout(()=>(zt=null,j=Date.now(),_.apply(null,arguments)),Vt-(ga-j)))}}const progressEventReducer=(_,e,j=3)=>{let Vt=0;const zt=speedometer(50,250);return throttle(_r=>{const _o=_r.loaded,ga=_r.lengthComputable?_r.total:void 0,_a=_o-Vt,_l=zt(_a),_d=_o<=ga;Vt=_o;const _f={loaded:_o,total:ga,progress:ga?_o/ga:void 0,bytes:_a,rate:_l||void 0,estimated:_l&&ga&&_d?(ga-_o)/_l:void 0,event:_r,lengthComputable:ga!=null};_f[e?"download":"upload"]=!0,_(_f)},j)},isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),j=document.createElement("a");let Vt;function zt(_r){let _o=_r;return e&&(j.setAttribute("href",_o),_o=j.href),j.setAttribute("href",_o),{href:j.href,protocol:j.protocol?j.protocol.replace(/:$/,""):"",host:j.host,search:j.search?j.search.replace(/^\?/,""):"",hash:j.hash?j.hash.replace(/^#/,""):"",hostname:j.hostname,port:j.port,pathname:j.pathname.charAt(0)==="/"?j.pathname:"/"+j.pathname}}return Vt=zt(window.location.href),function(_o){const ga=utils$1.isString(_o)?zt(_o):_o;return ga.protocol===Vt.protocol&&ga.host===Vt.host}}():function(){return function(){return!0}}(),cookies=platform.hasStandardBrowserEnv?{write(_,e,j,Vt,zt,_r){const _o=[_+"="+encodeURIComponent(e)];utils$1.isNumber(j)&&_o.push("expires="+new Date(j).toGMTString()),utils$1.isString(Vt)&&_o.push("path="+Vt),utils$1.isString(zt)&&_o.push("domain="+zt),_r===!0&&_o.push("secure"),document.cookie=_o.join("; ")},read(_){const e=document.cookie.match(new RegExp("(^|;\\s*)("+_+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(_){this.write(_,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(_){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(_)}function combineURLs(_,e){return e?_.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):_}function buildFullPath(_,e){return _&&!isAbsoluteURL(e)?combineURLs(_,e):e}const headersToObject=_=>_ instanceof AxiosHeaders?{..._}:_;function mergeConfig(_,e){e=e||{};const j={};function Vt(_l,_d,_f){return utils$1.isPlainObject(_l)&&utils$1.isPlainObject(_d)?utils$1.merge.call({caseless:_f},_l,_d):utils$1.isPlainObject(_d)?utils$1.merge({},_d):utils$1.isArray(_d)?_d.slice():_d}function zt(_l,_d,_f){if(utils$1.isUndefined(_d)){if(!utils$1.isUndefined(_l))return Vt(void 0,_l,_f)}else return Vt(_l,_d,_f)}function _r(_l,_d){if(!utils$1.isUndefined(_d))return Vt(void 0,_d)}function _o(_l,_d){if(utils$1.isUndefined(_d)){if(!utils$1.isUndefined(_l))return Vt(void 0,_l)}else return Vt(void 0,_d)}function ga(_l,_d,_f){if(_f in e)return Vt(_l,_d);if(_f in _)return Vt(void 0,_l)}const _a={url:_r,method:_r,data:_r,baseURL:_o,transformRequest:_o,transformResponse:_o,paramsSerializer:_o,timeout:_o,timeoutMessage:_o,withCredentials:_o,withXSRFToken:_o,adapter:_o,responseType:_o,xsrfCookieName:_o,xsrfHeaderName:_o,onUploadProgress:_o,onDownloadProgress:_o,decompress:_o,maxContentLength:_o,maxBodyLength:_o,beforeRedirect:_o,transport:_o,httpAgent:_o,httpsAgent:_o,cancelToken:_o,socketPath:_o,responseEncoding:_o,validateStatus:ga,headers:(_l,_d)=>zt(headersToObject(_l),headersToObject(_d),!0)};return utils$1.forEach(Object.keys(Object.assign({},_,e)),function(_d){const _f=_a[_d]||zt,_m=_f(_[_d],e[_d],_d);utils$1.isUndefined(_m)&&_f!==ga||(j[_d]=_m)}),j}const resolveConfig=_=>{const e=mergeConfig({},_);let{data:j,withXSRFToken:Vt,xsrfHeaderName:zt,xsrfCookieName:_r,headers:_o,auth:ga}=e;e.headers=_o=AxiosHeaders.from(_o),e.url=buildURL(buildFullPath(e.baseURL,e.url),_.params,_.paramsSerializer),ga&&_o.set("Authorization","Basic "+btoa((ga.username||"")+":"+(ga.password?unescape(encodeURIComponent(ga.password)):"")));let _a;if(utils$1.isFormData(j)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)_o.setContentType(void 0);else if((_a=_o.getContentType())!==!1){const[_l,..._d]=_a?_a.split(";").map(_f=>_f.trim()).filter(Boolean):[];_o.setContentType([_l||"multipart/form-data",..._d].join("; "))}}if(platform.hasStandardBrowserEnv&&(Vt&&utils$1.isFunction(Vt)&&(Vt=Vt(e)),Vt||Vt!==!1&&isURLSameOrigin(e.url))){const _l=zt&&_r&&cookies.read(_r);_l&&_o.set(zt,_l)}return e},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(_){return new Promise(function(j,Vt){const zt=resolveConfig(_);let _r=zt.data;const _o=AxiosHeaders.from(zt.headers).normalize();let{responseType:ga}=zt,_a;function _l(){zt.cancelToken&&zt.cancelToken.unsubscribe(_a),zt.signal&&zt.signal.removeEventListener("abort",_a)}let _d=new XMLHttpRequest;_d.open(zt.method.toUpperCase(),zt.url,!0),_d.timeout=zt.timeout;function _f(){if(!_d)return;const tE=AxiosHeaders.from("getAllResponseHeaders"in _d&&_d.getAllResponseHeaders()),oE={data:!ga||ga==="text"||ga==="json"?_d.responseText:_d.response,status:_d.status,statusText:_d.statusText,headers:tE,config:_,request:_d};settle(function(nE){j(nE),_l()},function(nE){Vt(nE),_l()},oE),_d=null}"onloadend"in _d?_d.onloadend=_f:_d.onreadystatechange=function(){!_d||_d.readyState!==4||_d.status===0&&!(_d.responseURL&&_d.responseURL.indexOf("file:")===0)||setTimeout(_f)},_d.onabort=function(){_d&&(Vt(new AxiosError("Request aborted",AxiosError.ECONNABORTED,zt,_d)),_d=null)},_d.onerror=function(){Vt(new AxiosError("Network Error",AxiosError.ERR_NETWORK,zt,_d)),_d=null},_d.ontimeout=function(){let rE=zt.timeout?"timeout of "+zt.timeout+"ms exceeded":"timeout exceeded";const oE=zt.transitional||transitionalDefaults;zt.timeoutErrorMessage&&(rE=zt.timeoutErrorMessage),Vt(new AxiosError(rE,oE.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,zt,_d)),_d=null},_r===void 0&&_o.setContentType(null),"setRequestHeader"in _d&&utils$1.forEach(_o.toJSON(),function(rE,oE){_d.setRequestHeader(oE,rE)}),utils$1.isUndefined(zt.withCredentials)||(_d.withCredentials=!!zt.withCredentials),ga&&ga!=="json"&&(_d.responseType=zt.responseType),typeof zt.onDownloadProgress=="function"&&_d.addEventListener("progress",progressEventReducer(zt.onDownloadProgress,!0)),typeof zt.onUploadProgress=="function"&&_d.upload&&_d.upload.addEventListener("progress",progressEventReducer(zt.onUploadProgress)),(zt.cancelToken||zt.signal)&&(_a=tE=>{_d&&(Vt(!tE||tE.type?new CanceledError(null,_,_d):tE),_d.abort(),_d=null)},zt.cancelToken&&zt.cancelToken.subscribe(_a),zt.signal&&(zt.signal.aborted?_a():zt.signal.addEventListener("abort",_a)));const _m=parseProtocol(zt.url);if(_m&&platform.protocols.indexOf(_m)===-1){Vt(new AxiosError("Unsupported protocol "+_m+":",AxiosError.ERR_BAD_REQUEST,_));return}_d.send(_r||null)})},composeSignals=(_,e)=>{let j=new AbortController,Vt;const zt=function(_a){if(!Vt){Vt=!0,_o();const _l=_a instanceof Error?_a:this.reason;j.abort(_l instanceof AxiosError?_l:new CanceledError(_l instanceof Error?_l.message:_l))}};let _r=e&&setTimeout(()=>{zt(new AxiosError(`timeout ${e} of ms exceeded`,AxiosError.ETIMEDOUT))},e);const _o=()=>{_&&(_r&&clearTimeout(_r),_r=null,_.forEach(_a=>{_a&&(_a.removeEventListener?_a.removeEventListener("abort",zt):_a.unsubscribe(zt))}),_=null)};_.forEach(_a=>_a&&_a.addEventListener&&_a.addEventListener("abort",zt));const{signal:ga}=j;return ga.unsubscribe=_o,[ga,()=>{_r&&clearTimeout(_r),_r=null}]},streamChunk=function*(_,e){let j=_.byteLength;if(!e||j<e){yield _;return}let Vt=0,zt;for(;Vt<j;)zt=Vt+e,yield _.slice(Vt,zt),Vt=zt},readBytes=async function*(_,e,j){for await(const Vt of _)yield*streamChunk(ArrayBuffer.isView(Vt)?Vt:await j(String(Vt)),e)},trackStream=(_,e,j,Vt,zt)=>{const _r=readBytes(_,e,zt);let _o=0;return new ReadableStream({type:"bytes",async pull(ga){const{done:_a,value:_l}=await _r.next();if(_a){ga.close(),Vt();return}let _d=_l.byteLength;j&&j(_o+=_d),ga.enqueue(new Uint8Array(_l))},cancel(ga){return Vt(ga),_r.return()}},{highWaterMark:2})},fetchProgressDecorator=(_,e)=>{const j=_!=null;return Vt=>setTimeout(()=>e({lengthComputable:j,total:_,loaded:Vt}))},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(_=>e=>_.encode(e))(new TextEncoder):async _=>new Uint8Array(await new Response(_).arrayBuffer())),supportsRequestStream=isReadableStreamSupported&&(()=>{let _=!1;const e=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!e})(),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&!!(()=>{try{return utils$1.isReadableStream(new Response("").body)}catch{}})(),resolvers={stream:supportsResponseStream&&(_=>_.body)};isFetchSupported&&(_=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!resolvers[e]&&(resolvers[e]=utils$1.isFunction(_[e])?j=>j[e]():(j,Vt)=>{throw new AxiosError(`Response type '${e}' is not supported`,AxiosError.ERR_NOT_SUPPORT,Vt)})})})(new Response);const getBodyLength=async _=>{if(_==null)return 0;if(utils$1.isBlob(_))return _.size;if(utils$1.isSpecCompliantForm(_))return(await new Request(_).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(_))return _.byteLength;if(utils$1.isURLSearchParams(_)&&(_=_+""),utils$1.isString(_))return(await encodeText(_)).byteLength},resolveBodyLength=async(_,e)=>{const j=utils$1.toFiniteNumber(_.getContentLength());return j??getBodyLength(e)},fetchAdapter=isFetchSupported&&(async _=>{let{url:e,method:j,data:Vt,signal:zt,cancelToken:_r,timeout:_o,onDownloadProgress:ga,onUploadProgress:_a,responseType:_l,headers:_d,withCredentials:_f="same-origin",fetchOptions:_m}=resolveConfig(_);_l=_l?(_l+"").toLowerCase():"text";let[tE,rE]=zt||_r||_o?composeSignals([zt,_r],_o):[],oE,dE;const nE=()=>{!oE&&setTimeout(()=>{tE&&tE.unsubscribe()}),oE=!0};let sE;try{if(_a&&supportsRequestStream&&j!=="get"&&j!=="head"&&(sE=await resolveBodyLength(_d,Vt))!==0){let IE=new Request(e,{method:"POST",body:Vt,duplex:"half"}),_E;utils$1.isFormData(Vt)&&(_E=IE.headers.get("content-type"))&&_d.setContentType(_E),IE.body&&(Vt=trackStream(IE.body,DEFAULT_CHUNK_SIZE,fetchProgressDecorator(sE,progressEventReducer(_a)),null,encodeText))}utils$1.isString(_f)||(_f=_f?"cors":"omit"),dE=new Request(e,{..._m,signal:tE,method:j.toUpperCase(),headers:_d.normalize().toJSON(),body:Vt,duplex:"half",withCredentials:_f});let lE=await fetch(dE);const EE=supportsResponseStream&&(_l==="stream"||_l==="response");if(supportsResponseStream&&(ga||EE)){const IE={};["status","statusText","headers"].forEach(kE=>{IE[kE]=lE[kE]});const _E=utils$1.toFiniteNumber(lE.headers.get("content-length"));lE=new Response(trackStream(lE.body,DEFAULT_CHUNK_SIZE,ga&&fetchProgressDecorator(_E,progressEventReducer(ga,!0)),EE&&nE,encodeText),IE)}_l=_l||"text";let wE=await resolvers[utils$1.findKey(resolvers,_l)||"text"](lE,_);return!EE&&nE(),rE&&rE(),await new Promise((IE,_E)=>{settle(IE,_E,{data:wE,headers:AxiosHeaders.from(lE.headers),status:lE.status,statusText:lE.statusText,config:_,request:dE})})}catch(lE){throw nE(),lE&&lE.name==="TypeError"&&/fetch/i.test(lE.message)?Object.assign(new AxiosError("Network Error",AxiosError.ERR_NETWORK,_,dE),{cause:lE.cause||lE}):AxiosError.from(lE,lE&&lE.code,_,dE)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(_,e)=>{if(_){try{Object.defineProperty(_,"name",{value:e})}catch{}Object.defineProperty(_,"adapterName",{value:e})}});const renderReason=_=>`- ${_}`,isResolvedHandle=_=>utils$1.isFunction(_)||_===null||_===!1,adapters={getAdapter:_=>{_=utils$1.isArray(_)?_:[_];const{length:e}=_;let j,Vt;const zt={};for(let _r=0;_r<e;_r++){j=_[_r];let _o;if(Vt=j,!isResolvedHandle(j)&&(Vt=knownAdapters[(_o=String(j)).toLowerCase()],Vt===void 0))throw new AxiosError(`Unknown adapter '${_o}'`);if(Vt)break;zt[_o||"#"+_r]=Vt}if(!Vt){const _r=Object.entries(zt).map(([ga,_a])=>`adapter ${ga} `+(_a===!1?"is not supported by the environment":"is not available in the build"));let _o=e?_r.length>1?`since :
`+_r.map(renderReason).join(`
`):" "+renderReason(_r[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+_o,"ERR_NOT_SUPPORT")}return Vt},adapters:knownAdapters};function throwIfCancellationRequested(_){if(_.cancelToken&&_.cancelToken.throwIfRequested(),_.signal&&_.signal.aborted)throw new CanceledError(null,_)}function dispatchRequest(_){return throwIfCancellationRequested(_),_.headers=AxiosHeaders.from(_.headers),_.data=transformData.call(_,_.transformRequest),["post","put","patch"].indexOf(_.method)!==-1&&_.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(_.adapter||defaults.adapter)(_).then(function(Vt){return throwIfCancellationRequested(_),Vt.data=transformData.call(_,_.transformResponse,Vt),Vt.headers=AxiosHeaders.from(Vt.headers),Vt},function(Vt){return isCancel(Vt)||(throwIfCancellationRequested(_),Vt&&Vt.response&&(Vt.response.data=transformData.call(_,_.transformResponse,Vt.response),Vt.response.headers=AxiosHeaders.from(Vt.response.headers))),Promise.reject(Vt)})}const VERSION="1.7.2",validators$1={};["object","boolean","number","function","string","symbol"].forEach((_,e)=>{validators$1[_]=function(Vt){return typeof Vt===_||"a"+(e<1?"n ":" ")+_}});const deprecatedWarnings={};validators$1.transitional=function(e,j,Vt){function zt(_r,_o){return"[Axios v"+VERSION+"] Transitional option '"+_r+"'"+_o+(Vt?". "+Vt:"")}return(_r,_o,ga)=>{if(e===!1)throw new AxiosError(zt(_o," has been removed"+(j?" in "+j:"")),AxiosError.ERR_DEPRECATED);return j&&!deprecatedWarnings[_o]&&(deprecatedWarnings[_o]=!0,console.warn(zt(_o," has been deprecated since v"+j+" and will be removed in the near future"))),e?e(_r,_o,ga):!0}};function assertOptions(_,e,j){if(typeof _!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const Vt=Object.keys(_);let zt=Vt.length;for(;zt-- >0;){const _r=Vt[zt],_o=e[_r];if(_o){const ga=_[_r],_a=ga===void 0||_o(ga,_r,_);if(_a!==!0)throw new AxiosError("option "+_r+" must be "+_a,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(j!==!0)throw new AxiosError("Unknown option "+_r,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(e,j){try{return await this._request(e,j)}catch(Vt){if(Vt instanceof Error){let zt;Error.captureStackTrace?Error.captureStackTrace(zt={}):zt=new Error;const _r=zt.stack?zt.stack.replace(/^.+\n/,""):"";try{Vt.stack?_r&&!String(Vt.stack).endsWith(_r.replace(/^.+\n.+\n/,""))&&(Vt.stack+=`
`+_r):Vt.stack=_r}catch{}}throw Vt}}_request(e,j){typeof e=="string"?(j=j||{},j.url=e):j=e||{},j=mergeConfig(this.defaults,j);const{transitional:Vt,paramsSerializer:zt,headers:_r}=j;Vt!==void 0&&validator.assertOptions(Vt,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),zt!=null&&(utils$1.isFunction(zt)?j.paramsSerializer={serialize:zt}:validator.assertOptions(zt,{encode:validators.function,serialize:validators.function},!0)),j.method=(j.method||this.defaults.method||"get").toLowerCase();let _o=_r&&utils$1.merge(_r.common,_r[j.method]);_r&&utils$1.forEach(["delete","get","head","post","put","patch","common"],rE=>{delete _r[rE]}),j.headers=AxiosHeaders.concat(_o,_r);const ga=[];let _a=!0;this.interceptors.request.forEach(function(oE){typeof oE.runWhen=="function"&&oE.runWhen(j)===!1||(_a=_a&&oE.synchronous,ga.unshift(oE.fulfilled,oE.rejected))});const _l=[];this.interceptors.response.forEach(function(oE){_l.push(oE.fulfilled,oE.rejected)});let _d,_f=0,_m;if(!_a){const rE=[dispatchRequest.bind(this),void 0];for(rE.unshift.apply(rE,ga),rE.push.apply(rE,_l),_m=rE.length,_d=Promise.resolve(j);_f<_m;)_d=_d.then(rE[_f++],rE[_f++]);return _d}_m=ga.length;let tE=j;for(_f=0;_f<_m;){const rE=ga[_f++],oE=ga[_f++];try{tE=rE(tE)}catch(dE){oE.call(this,dE);break}}try{_d=dispatchRequest.call(this,tE)}catch(rE){return Promise.reject(rE)}for(_f=0,_m=_l.length;_f<_m;)_d=_d.then(_l[_f++],_l[_f++]);return _d}getUri(e){e=mergeConfig(this.defaults,e);const j=buildFullPath(e.baseURL,e.url);return buildURL(j,e.params,e.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(e){Axios.prototype[e]=function(j,Vt){return this.request(mergeConfig(Vt||{},{method:e,url:j,data:(Vt||{}).data}))}});utils$1.forEach(["post","put","patch"],function(e){function j(Vt){return function(_r,_o,ga){return this.request(mergeConfig(ga||{},{method:e,headers:Vt?{"Content-Type":"multipart/form-data"}:{},url:_r,data:_o}))}}Axios.prototype[e]=j(),Axios.prototype[e+"Form"]=j(!0)});class CancelToken{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let j;this.promise=new Promise(function(_r){j=_r});const Vt=this;this.promise.then(zt=>{if(!Vt._listeners)return;let _r=Vt._listeners.length;for(;_r-- >0;)Vt._listeners[_r](zt);Vt._listeners=null}),this.promise.then=zt=>{let _r;const _o=new Promise(ga=>{Vt.subscribe(ga),_r=ga}).then(zt);return _o.cancel=function(){Vt.unsubscribe(_r)},_o},e(function(_r,_o,ga){Vt.reason||(Vt.reason=new CanceledError(_r,_o,ga),j(Vt.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const j=this._listeners.indexOf(e);j!==-1&&this._listeners.splice(j,1)}static source(){let e;return{token:new CancelToken(function(zt){e=zt}),cancel:e}}}function spread(_){return function(j){return _.apply(null,j)}}function isAxiosError(_){return utils$1.isObject(_)&&_.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([_,e])=>{HttpStatusCode[e]=_});function createInstance(_){const e=new Axios(_),j=bind(Axios.prototype.request,e);return utils$1.extend(j,Axios.prototype,e,{allOwnKeys:!0}),utils$1.extend(j,e,null,{allOwnKeys:!0}),j.create=function(zt){return createInstance(mergeConfig(_,zt))},j}const axios=createInstance(defaults);axios.Axios=Axios;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders;axios.formToJSON=_=>formDataToJSON(utils$1.isHTMLForm(_)?new FormData(_):_);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode;axios.default=axios;const Login=()=>{const{signIn:_,user:e}=useAuth(),[j,Vt]=reactExports.useState(""),[zt,_r]=reactExports.useState("");reactExports.useState("");const _o=useNavigate(),ga=_a=>{_a.preventDefault(),axios.post(`${backend_crud}login`,{email:j,password:zt},{headers:{"Content-Type":"multipart/form-data"}}).then(function(_l){var _d;(_d=_l.data)!=null&&_d.id?_({nome:_l.data.nome,sobrenome:_l.data.sobrenome,id:_l.data.id,foto:"",refresh_token:_l.data.refresh_token}):alert("Erro a fazer login verifique as tuas credenciais!")}).catch(function(_l){console.log(_l),alert("Erro ao se comunicar com o servidor. Tente novamente!")})};return reactExports.useEffect(()=>{e!==null&&_o("/",{replace:!0})},[_o,e]),jsxRuntimeExports.jsx("div",{className:"flex bg-graywhite-300 h-dvh justify-center items-center",children:jsxRuntimeExports.jsxs("div",{className:"flex w-1/2 bg-white rounded-lg overflow-hidden h-96",children:[jsxRuntimeExports.jsxs("form",{action:"",className:"flex-col flex-1 items-center h-full justify-center p-16",onSubmit:ga,children:[jsxRuntimeExports.jsx("h1",{className:"font-bold text-3xl mb-4",children:"Seja Benvido"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 mb-4",children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",children:"Email"}),jsxRuntimeExports.jsx("input",{type:"email",placeholder:"Insira o teu email",id:"email",name:"email",value:j,onChange:_a=>Vt(_a.target.value),className:"w-full p-1 border-2 border-graywhite-300 rounded-lg",required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("label",{htmlFor:"senha",children:"Senha"}),jsxRuntimeExports.jsx("input",{type:"password",placeholder:"Insira a senha",id:"senha",name:"senha",value:zt,onChange:_a=>_r(_a.target.value),className:"w-full flex-1 p-1 border-2 border-graywhite-300 rounded-lg",required:!0})]}),jsxRuntimeExports.jsx("button",{className:"bg-primary w-full mt-4 p-2 rounded-lg text-white",children:"Login"})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-1 bg-primary h-full rounded-l-3xl p-10 justify-center items-center",children:jsxRuntimeExports.jsx("p",{children:jsxRuntimeExports.jsx("img",{src:logo,height:250,width:250})})})]})})},Register=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h1",{children:"Register Page"})}),Chat=()=>jsxRuntimeExports.jsx("div",{children:"Chat"}),meeting="/mocho_web/assets/meeting-e2-13gVj.png",UsersConversation=({onSelectUser:_,userLoggedIn:e})=>{const[j,Vt]=reactExports.useState(!1),[zt,_r]=reactExports.useState([]),[_o,ga]=reactExports.useState([]),[_a,_l]=reactExports.useState([]),[_d,_f]=reactExports.useState(""),[_m,tE]=reactExports.useState(null),{socket:rE}=useSocket(),oE=reactExports.useRef(zt);reactExports.useEffect(()=>{oE.current=zt},[zt]);const dE=({id:EE,nome:wE,sobrenome:IE,foto:_E})=>{_r(kE=>kE.map(ME=>ME.id===EE?{...ME,unreadMessages:0}:ME)),tE(EE),_({id:EE,nome:wE,sobrenome:IE,foto:_E})},nE=EE=>EE.map(({id:wE,nome:IE,sobrenome:_E,foto:kE,unreadMessages:ME})=>jsxRuntimeExports.jsx("li",{className:"bg-white mb-4 w-full h-fit p-1 rounded-lg flex justify-between items-center border-2",children:jsxRuntimeExports.jsxs("button",{className:"flex gap-2 items-center w-full",onClick:()=>dE({id:wE,nome:IE,sobrenome:_E,foto:kE}),children:[jsxRuntimeExports.jsx("img",{className:"w-10 h-10 rounded-full object-cover",src:userplaceholderimage}),jsxRuntimeExports.jsx("span",{children:IE+" "+_E}),jsxRuntimeExports.jsx("div",{className:"flex-1",children:ME>0&&jsxRuntimeExports.jsx("span",{className:"bg-primary text-white w-7 h-7 rounded-full flex justify-center items-center ml-auto",children:ME})})]})},wE)),sE=EE=>{_f(EE.target.value.toLowerCase())},lE=_d===""?zt:zt.filter(EE=>(EE.nome.toLowerCase()+" "+EE.sobrenome.toLowerCase()).includes(_d));return reactExports.useEffect(()=>{e!=null&&e.id&&(fetch(`${backend_crud}load_conversations?id_user=${e==null?void 0:e.id}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(EE=>EE.json()).then(EE=>{_r(EE),_l(EE)}).catch(EE=>alert("Error:",EE)),fetch(`${backend_crud}load_users_never_talked?id_user=${e==null?void 0:e.id}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(EE=>EE.json()).then(EE=>{ga(EE)}).catch(EE=>alert("Error:",EE)))},[e]),reactExports.useEffect(()=>{const EE=({cod_user_sender:wE,text:IE,image:_E,nome:kE,sobrenome:ME})=>{zt.length?_r(bE=>{const LE=[...bE],TE=LE.findIndex(OE=>OE.id===wE);return wE!=_m&&(TE!==-1?LE[TE].unreadMessages=(LE[TE].unreadMessages||0)+1:LE.push({id:wE,nome:kE,sobrenome:ME,foto:userplaceholderimage,unreadMessages:1})),LE}):_r([{id:wE,nome:kE,sobrenome:ME,foto:userplaceholderimage,unreadMessages:1}])};return rE.on("new user to user message",EE),()=>{rE.off("new user to user message",EE)}},[_m,zt]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-80 h-full bg-white p-4",children:[!j&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h2",{children:"Conversas"}),jsxRuntimeExports.jsxs("button",{className:"text-primary font-bold flex items-center",onClick:()=>{_o.length&&(_r(_o),Vt(!0))},children:[jsxRuntimeExports.jsx(w$1,{size:20}),"Nova Conversa"]})]}),j&&jsxRuntimeExports.jsx("button",{className:"text-primary font-bold flex items-center w-fit",onClick:()=>{_o.length&&(_r(_a),Vt(!1))},children:jsxRuntimeExports.jsx(I$4,{size:32})}),jsxRuntimeExports.jsxs("div",{className:"bg-white h-fit my-4 p-1 rounded-lg flex justify-between",children:[jsxRuntimeExports.jsx("input",{className:"flex-1 outline-none",type:"search",name:"search",id:"search",placeholder:"Buscar usurio",onChange:sE}),jsxRuntimeExports.jsx("button",{type:"button",children:jsxRuntimeExports.jsx(w$2,{size:32,className:"hover:text-graywhite-600 text-graywhite-300"})})]}),jsxRuntimeExports.jsx("ul",{className:"flex flex-col items-center w-full h-full overflow-y-auto mt-3",children:zt.length&&nE(lE)})]})};var AgoraRTC_NProduction={exports:{}};(function(_,e){(function(j,Vt){_.exports=Vt()})(commonjsGlobal,function(){function j($,_e){return _e.forEach(function(_t){_t&&typeof _t!="string"&&!Array.isArray(_t)&&Object.keys(_t).forEach(function(Wt){if(Wt!=="default"&&!(Wt in $)){var _n=Object.getOwnPropertyDescriptor(_t,Wt);Object.defineProperty($,Wt,_n.get?_n:{enumerable:!0,get:function(){return _t[Wt]}})}})}),Object.freeze($)}var Vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function zt($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}var _r=function($){try{return!!$()}catch{return!0}},_o=!_r(function(){var $=(function(){}).bind();return typeof $!="function"||$.hasOwnProperty("prototype")}),ga=_o,_a=Function.prototype,_l=_a.call,_d=ga&&_a.bind.bind(_l,_l),_f=ga?_d:function($){return function(){return _l.apply($,arguments)}},_m=_f({}.isPrototypeOf),tE=function($){return $&&$.Math==Math&&$},rE=tE(typeof globalThis=="object"&&globalThis)||tE(typeof window=="object"&&window)||tE(typeof self=="object"&&self)||tE(typeof Vt=="object"&&Vt)||function(){return this}()||Vt||Function("return this")(),oE=_o,dE=Function.prototype,nE=dE.apply,sE=dE.call,lE=typeof Reflect=="object"&&Reflect.apply||(oE?sE.bind(nE):function(){return sE.apply(nE,arguments)}),EE=_f,wE=EE({}.toString),IE=EE("".slice),_E=function($){return IE(wE($),8,-1)},kE=_E,ME=_f,bE=function($){if(kE($)==="Function")return ME($)},LE=typeof document=="object"&&document.all,TE={all:LE,IS_HTMLDDA:LE===void 0&&LE!==void 0},OE=TE.all,vE=TE.IS_HTMLDDA?function($){return typeof $=="function"||$===OE}:function($){return typeof $=="function"},NE={},jE=!_r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),UE=_o,RE=Function.prototype.call,FE=UE?RE.bind(RE):function(){return RE.apply(RE,arguments)},VE={},BE={}.propertyIsEnumerable,qE=Object.getOwnPropertyDescriptor,e_=qE&&!BE.call({1:2},1);VE.f=e_?function($){var _e=qE(this,$);return!!_e&&_e.enumerable}:BE;var b_,m_,I_=function($,_e){return{enumerable:!(1&$),configurable:!(2&$),writable:!(4&$),value:_e}},w0=_r,yT=_E,YT=Object,oT=_f("".split),LS=w0(function(){return!YT("z").propertyIsEnumerable(0)})?function($){return yT($)=="String"?oT($,""):YT($)}:YT,lS=function($){return $==null},oS=lS,q_=TypeError,E0=function($){if(oS($))throw q_("Can't call method on "+$);return $},S_=LS,v0=E0,k0=function($){return S_(v0($))},QS=vE,yR=TE.all,TS=TE.IS_HTMLDDA?function($){return typeof $=="object"?$!==null:QS($)||$===yR}:function($){return typeof $=="object"?$!==null:QS($)},yS={},JT=yS,XT=rE,EN=vE,bR=function($){return EN($)?$:void 0},OS=function($,_e){return arguments.length<2?bR(JT[$])||bR(XT[$]):JT[$]&&JT[$][_e]||XT[$]&&XT[$][_e]},VR=typeof navigator<"u"&&String(navigator.userAgent)||"",EI=rE,vN=VR,SR=EI.process,_N=EI.Deno,yN=SR&&SR.versions||_N&&_N.version,bN=yN&&yN.v8;bN&&(m_=(b_=bN.split("."))[0]>0&&b_[0]<4?1:+(b_[0]+b_[1])),!m_&&vN&&(!(b_=vN.match(/Edge\/(\d+)/))||b_[1]>=74)&&(b_=vN.match(/Chrome\/(\d+)/))&&(m_=+b_[1]);var h1=m_,SN=h1,nO=_r,qP=rE.String,BR=!!Object.getOwnPropertySymbols&&!nO(function(){var $=Symbol();return!qP($)||!(Object($)instanceof Symbol)||!Symbol.sham&&SN&&SN<41}),zP=BR&&!Symbol.sham&&typeof Symbol.iterator=="symbol",KP=OS,WM=vE,$P=_m,qM=Object,YE=zP?function($){return typeof $=="symbol"}:function($){var _e=KP("Symbol");return WM(_e)&&$P(_e.prototype,qM($))},_v=String,s_=function($){try{return _v($)}catch{return"Object"}},v_=vE,A_=s_,r0=TypeError,O_=function($){if(v_($))return $;throw r0(A_($)+" is not a function")},N_=O_,a0=lS,$_=function($,_e){var _t=$[_e];return a0(_t)?void 0:N_(_t)},xS=FE,MS=vE,Y_=TS,sS=TypeError,NS={exports:{}},k1=rE,GR=Object.defineProperty,D1=function($,_e){try{GR(k1,$,{value:_e,configurable:!0,writable:!0})}catch{k1[$]=_e}return _e},p1="__core-js_shared__",HR=rE[p1]||D1(p1,{}),xT=HR;(NS.exports=function($,_e){return xT[$]||(xT[$]=_e!==void 0?_e:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var TR=NS.exports,rO=E0,iO=Object,e0=function($){return iO(rO($))},eT=e0,bT=_f({}.hasOwnProperty),_0=Object.hasOwn||function($,_e){return bT(eT($),_e)},vI=_f,YP=0,zM=Math.random(),WJ=vI(1 .toString),KM=function($){return"Symbol("+($===void 0?"":$)+")_"+WJ(++YP+zM,36)},qJ=TR,N8=_0,zJ=KM,KJ=BR,$J=zP,oO=rE.Symbol,$M=qJ("wks"),YJ=$J?oO.for||oO:oO&&oO.withoutSetter||zJ,$0=function($){return N8($M,$)||($M[$]=KJ&&N8(oO,$)?oO[$]:YJ("Symbol."+$)),$M[$]},JJ=FE,P8=TS,k8=YE,XJ=$_,ZJ=function($,_e){var _t,Wt;if(MS(_t=$.toString)&&!Y_(Wt=xS(_t,$))||MS(_t=$.valueOf)&&!Y_(Wt=xS(_t,$)))return Wt;throw sS("Can't convert object to primitive value")},QJ=TypeError,eX=$0("toPrimitive"),tX=function($,_e){if(!P8($)||k8($))return $;var _t,Wt=XJ($,eX);if(Wt){if(_t=JJ(Wt,$,_e),!P8(_t)||k8(_t))return _t;throw QJ("Can't convert object to primitive value")}return ZJ($)},nX=YE,JP=function($){var _e=tX($,"string");return nX(_e)?_e:_e+""},D8=TS,YM=rE.document,rX=D8(YM)&&D8(YM.createElement),JM=function($){return rX?YM.createElement($):{}},iX=JM,L8=!jE&&!_r(function(){return Object.defineProperty(iX("div"),"a",{get:function(){return 7}}).a!=7}),oX=jE,sX=FE,aX=VE,cX=I_,lX=k0,uX=JP,dX=_0,hX=L8,x8=Object.getOwnPropertyDescriptor;NE.f=oX?x8:function($,_e){if($=lX($),_e=uX(_e),hX)try{return x8($,_e)}catch{}if(dX($,_e))return cX(!sX(aX.f,$,_e),$[_e])};var pX=_r,fX=vE,mX=/#|\.prototype\./,TN=function($,_e){var _t=EX[gX($)];return _t==_X||_t!=vX&&(fX(_e)?pX(_e):!!_e)},gX=TN.normalize=function($){return String($).replace(mX,".").toLowerCase()},EX=TN.data={},vX=TN.NATIVE="N",_X=TN.POLYFILL="P",M8=TN,yX=O_,bX=_o,SX=bE(bE.bind),L1=function($,_e){return yX($),_e===void 0?$:bX?SX($,_e):function(){return $.apply(_e,arguments)}},ZT={},U8=jE&&_r(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),TX=TS,wX=String,RX=TypeError,sT=function($){if(TX($))return $;throw RX(wX($)+" is not an object")},CX=jE,IX=L8,AX=U8,XP=sT,j8=JP,OX=TypeError,XM=Object.defineProperty,NX=Object.getOwnPropertyDescriptor,ZM="enumerable",QM="configurable",eU="writable";ZT.f=CX?AX?function($,_e,_t){if(XP($),_e=j8(_e),XP(_t),typeof $=="function"&&_e==="prototype"&&"value"in _t&&eU in _t&&!_t[eU]){var Wt=NX($,_e);Wt&&Wt[eU]&&($[_e]=_t.value,_t={configurable:QM in _t?_t[QM]:Wt[QM],enumerable:ZM in _t?_t[ZM]:Wt[ZM],writable:!1})}return XM($,_e,_t)}:XM:function($,_e,_t){if(XP($),_e=j8(_e),XP(_t),IX)try{return XM($,_e,_t)}catch{}if("get"in _t||"set"in _t)throw OX("Accessors not supported");return"value"in _t&&($[_e]=_t.value),$};var PX=ZT,kX=I_,x1=jE?function($,_e,_t){return PX.f($,_e,kX(1,_t))}:function($,_e,_t){return $[_e]=_t,$},ZP=rE,DX=lE,LX=bE,xX=vE,MX=NE.f,UX=M8,sO=yS,jX=L1,aO=x1,F8=_0,FX=function($){var _e=function(_t,Wt,_n){if(this instanceof _e){switch(arguments.length){case 0:return new $;case 1:return new $(_t);case 2:return new $(_t,Wt)}return new $(_t,Wt,_n)}return DX($,this,arguments)};return _e.prototype=$.prototype,_e},y0=function($,_e){var _t,Wt,_n,_i,_s,_c,_u,_h,_p,Qm=$.target,_g=$.global,eE=$.stat,pE=$.proto,aE=_g?ZP:eE?ZP[Qm]:(ZP[Qm]||{}).prototype,cE=_g?sO:sO[Qm]||aO(sO,Qm,{})[Qm],fE=cE.prototype;for(_i in _e)Wt=!(_t=UX(_g?_i:Qm+(eE?".":"#")+_i,$.forced))&&aE&&F8(aE,_i),_c=cE[_i],Wt&&(_u=$.dontCallGetSet?(_p=MX(aE,_i))&&_p.value:aE[_i]),_s=Wt&&_u?_u:_e[_i],Wt&&typeof _c==typeof _s||(_h=$.bind&&Wt?jX(_s,ZP):$.wrap&&Wt?FX(_s):pE&&xX(_s)?LX(_s):_s,($.sham||_s&&_s.sham||_c&&_c.sham)&&aO(_h,"sham",!0),aO(cE,_i,_h),pE&&(F8(sO,_n=Qm+"Prototype")||aO(sO,_n,{}),aO(sO[_n],_i,_s),$.real&&fE&&(_t||!fE[_i])&&aO(fE,_i,_s)))},VX=Math.ceil,BX=Math.floor,GX=Math.trunc||function($){var _e=+$;return(_e>0?BX:VX)(_e)},HX=GX,tU=function($){var _e=+$;return _e!=_e||_e===0?0:HX(_e)},WX=tU,qX=Math.max,zX=Math.min,nU=function($,_e){var _t=WX($);return _t<0?qX(_t+_e,0):zX(_t,_e)},KX=tU,$X=Math.min,V8=function($){return $>0?$X(KX($),9007199254740991):0},YX=V8,f1=function($){return YX($.length)},JX=k0,XX=nU,ZX=f1,B8=function($){return function(_e,_t,Wt){var _n,_i=JX(_e),_s=ZX(_i),_c=XX(Wt,_s);if($&&_t!=_t){for(;_s>_c;)if((_n=_i[_c++])!=_n)return!0}else for(;_s>_c;_c++)if(($||_c in _i)&&_i[_c]===_t)return $||_c||0;return!$&&-1}},rU={includes:B8(!0),indexOf:B8(!1)},QX=rU.includes;y0({target:"Array",proto:!0,forced:_r(function(){return!Array(1).includes()})},{includes:function($){return QX(this,$,arguments.length>1?arguments[1]:void 0)}});var eZ=yS,QT=function($){return eZ[$+"Prototype"]},tZ=QT("Array").includes,nZ=TS,rZ=_E,iZ=$0("match"),G8=function($){var _e;return nZ($)&&((_e=$[iZ])!==void 0?!!_e:rZ($)=="RegExp")},oZ=G8,sZ=TypeError,H8={};H8[$0("toStringTag")]="z";var iU=String(H8)==="[object z]",aZ=iU,cZ=vE,QP=_E,lZ=$0("toStringTag"),uZ=Object,dZ=QP(function(){return arguments}())=="Arguments",WR=aZ?QP:function($){var _e,_t,Wt;return $===void 0?"Undefined":$===null?"Null":typeof(_t=function(_n,_i){try{return _n[_i]}catch{}}(_e=uZ($),lZ))=="string"?_t:dZ?QP(_e):(Wt=QP(_e))=="Object"&&cZ(_e.callee)?"Arguments":Wt},hZ=WR,pZ=String,MT=function($){if(hZ($)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return pZ($)},fZ=$0("match"),mZ=y0,gZ=function($){if(oZ($))throw sZ("The method doesn't accept regular expressions");return $},EZ=E0,W8=MT,vZ=function($){var _e=/./;try{"/./"[$](_e)}catch{try{return _e[fZ]=!1,"/./"[$](_e)}catch{}}return!1},_Z=_f("".indexOf);mZ({target:"String",proto:!0,forced:!vZ("includes")},{includes:function($){return!!~_Z(W8(EZ(this)),W8(gZ($)),arguments.length>1?arguments[1]:void 0)}});var yZ=QT("String").includes,q8=_m,bZ=tZ,SZ=yZ,oU=Array.prototype,sU=String.prototype,TZ=function($){var _e=$.includes;return $===oU||q8(oU,$)&&_e===oU.includes?bZ:typeof $=="string"||$===sU||q8(sU,$)&&_e===sU.includes?SZ:_e},i_=zt(TZ),wZ=O_,RZ=e0,CZ=LS,IZ=f1,AZ=TypeError,z8=function($){return function(_e,_t,Wt,_n){wZ(_t);var _i=RZ(_e),_s=CZ(_i),_c=IZ(_i),_u=$?_c-1:0,_h=$?-1:1;if(Wt<2)for(;;){if(_u in _s){_n=_s[_u],_u+=_h;break}if(_u+=_h,$?_u<0:_c<=_u)throw AZ("Reduce of empty array with no initial value")}for(;$?_u>=0:_c>_u;_u+=_h)_u in _s&&(_n=_t(_n,_s[_u],_u,_i));return _n}},OZ={left:z8(!1),right:z8(!0)},NZ=_r,_k=function($,_e){var _t=[][$];return!!_t&&NZ(function(){_t.call(null,_e||function(){return 1},1)})},wN=typeof process<"u"&&_E(process)=="process",PZ=OZ.left;y0({target:"Array",proto:!0,forced:!wN&&h1>79&&h1<83||!_k("reduce")},{reduce:function($){var _e=arguments.length;return PZ(this,$,_e,_e>1?arguments[1]:void 0)}});var kZ=QT("Array").reduce,DZ=_m,LZ=kZ,aU=Array.prototype,xZ=function($){var _e=$.reduce;return $===aU||DZ(aU,$)&&_e===aU.reduce?LZ:_e},K8=xZ,wR=zt(K8);let $8=!0,Y8=!0;function tD($,_e,_t){const Wt=$.match(_e);return Wt&&Wt.length>=_t&&parseInt(Wt[_t],10)}function _I($,_e,_t){if(!$.RTCPeerConnection)return;const Wt=$.RTCPeerConnection.prototype,_n=Wt.addEventListener;Wt.addEventListener=function(_s,_c){if(_s!==_e)return _n.apply(this,arguments);const _u=_h=>{const _p=_t(_h);_p&&(_c.handleEvent?_c.handleEvent(_p):_c(_p))};return this._eventMap=this._eventMap||{},this._eventMap[_e]||(this._eventMap[_e]=new Map),this._eventMap[_e].set(_c,_u),_n.apply(this,[_s,_u])};const _i=Wt.removeEventListener;Wt.removeEventListener=function(_s,_c){if(_s!==_e||!this._eventMap||!this._eventMap[_e])return _i.apply(this,arguments);if(!this._eventMap[_e].has(_c))return _i.apply(this,arguments);const _u=this._eventMap[_e].get(_c);return this._eventMap[_e].delete(_c),this._eventMap[_e].size===0&&delete this._eventMap[_e],Object.keys(this._eventMap).length===0&&delete this._eventMap,_i.apply(this,[_s,_u])},Object.defineProperty(Wt,"on"+_e,{get(){return this["_on"+_e]},set(_s){this["_on"+_e]&&(this.removeEventListener(_e,this["_on"+_e]),delete this["_on"+_e]),_s&&this.addEventListener(_e,this["_on"+_e]=_s)},enumerable:!0,configurable:!0})}function MZ($){return typeof $!="boolean"?new Error("Argument type: "+typeof $+". Please use a boolean."):($8=$,$?"adapter.js logging disabled":"adapter.js logging enabled")}function UZ($){return typeof $!="boolean"?new Error("Argument type: "+typeof $+". Please use a boolean."):(Y8=!$,"adapter.js deprecation warnings "+($?"disabled":"enabled"))}function J8(){if(typeof window=="object"){if($8)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function cU($,_e){Y8&&console.warn($+" is deprecated, please use "+_e+" instead.")}function X8($){return Object.prototype.toString.call($)==="[object Object]"}function Z8($){var _e;return X8($)?wR(_e=Object.keys($)).call(_e,function(_t,Wt){const _n=X8($[Wt]),_i=_n?Z8($[Wt]):$[Wt],_s=_n&&!Object.keys(_i).length;return _i===void 0||_s?_t:Object.assign(_t,{[Wt]:_i})},{}):$}function lU($,_e,_t){_e&&!_t.has(_e.id)&&(_t.set(_e.id,_e),Object.keys(_e).forEach(Wt=>{Wt.endsWith("Id")?lU($,$.get(_e[Wt]),_t):Wt.endsWith("Ids")&&_e[Wt].forEach(_n=>{lU($,$.get(_n),_t)})}))}function Q8($,_e,_t){const Wt=_t?"outbound-rtp":"inbound-rtp",_n=new Map;if(_e===null)return _n;const _i=[];return $.forEach(_s=>{_s.type==="track"&&_s.trackIdentifier===_e.id&&_i.push(_s)}),_i.forEach(_s=>{$.forEach(_c=>{_c.type===Wt&&_c.trackId===_s.id&&lU($,_c,_n)})}),_n}var jZ=KM,e4=TR("keys"),sD=function($){return e4[$]||(e4[$]=jZ($))},FZ=!_r(function(){function $(){}return $.prototype.constructor=null,Object.getPrototypeOf(new $)!==$.prototype}),VZ=_0,BZ=vE,GZ=e0,HZ=FZ,t4=sD("IE_PROTO"),uU=Object,WZ=uU.prototype,dU=HZ?uU.getPrototypeOf:function($){var _e=GZ($);if(VZ(_e,t4))return _e[t4];var _t=_e.constructor;return BZ(_t)&&_e instanceof _t?_t.prototype:_e instanceof uU?WZ:null},qZ=_f,zZ=O_,KZ=vE,$Z=String,YZ=TypeError,JZ=function($,_e,_t){try{return qZ(zZ(Object.getOwnPropertyDescriptor($,_e)[_t]))}catch{}},XZ=sT,ZZ=function($){if(typeof $=="object"||KZ($))return $;throw YZ("Can't set "+$Z($)+" as a prototype")},QZ=Object.setPrototypeOf||("__proto__"in{}?function(){var $,_e=!1,_t={};try{($=JZ(Object.prototype,"__proto__","set"))(_t,[]),_e=_t instanceof Array}catch{}return function(Wt,_n){return XZ(Wt),ZZ(_n),_e?$(Wt,_n):Wt.__proto__=_n,Wt}}():void 0),uD={},ED={},hU=_0,eQ=k0,tQ=rU.indexOf,nQ=ED,n4=_f([].push),r4=function($,_e){var _t,Wt=eQ($),_n=0,_i=[];for(_t in Wt)!hU(nQ,_t)&&hU(Wt,_t)&&n4(_i,_t);for(;_e.length>_n;)hU(Wt,_t=_e[_n++])&&(~tQ(_i,_t)||n4(_i,_t));return _i},pU=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],rQ=r4,iQ=pU.concat("length","prototype");uD.f=Object.getOwnPropertyNames||function($){return rQ($,iQ)};var RN={};RN.f=Object.getOwnPropertySymbols;var oQ=OS,sQ=uD,aQ=RN,cQ=sT,lQ=_f([].concat),uQ=oQ("Reflect","ownKeys")||function($){var _e=sQ.f(cQ($)),_t=aQ.f;return _t?lQ(_e,_t($)):_e},i4=_0,dQ=uQ,hQ=NE,pQ=ZT,fU={},fQ=r4,mQ=pU,vD=Object.keys||function($){return fQ($,mQ)},gQ=jE,EQ=U8,vQ=ZT,_Q=sT,yQ=k0,bQ=vD;fU.f=gQ&&!EQ?Object.defineProperties:function($,_e){_Q($);for(var _t,Wt=yQ(_e),_n=bQ(_e),_i=_n.length,_s=0;_i>_s;)vQ.f($,_t=_n[_s++],Wt[_t]);return $};var _D,o4=OS("document","documentElement"),SQ=sT,TQ=fU,s4=pU,wQ=ED,RQ=o4,CQ=JM,mU="prototype",gU="script",a4=sD("IE_PROTO"),EU=function(){},c4=function($){return"<"+gU+">"+$+"</"+gU+">"},l4=function($){$.write(c4("")),$.close();var _e=$.parentWindow.Object;return $=null,_e},yD=function(){try{_D=new ActiveXObject("htmlfile")}catch{}var $,_e,_t;yD=typeof document<"u"?document.domain&&_D?l4(_D):(_e=CQ("iframe"),_t="java"+gU+":",_e.style.display="none",RQ.appendChild(_e),_e.src=String(_t),($=_e.contentWindow.document).open(),$.write(c4("document.F=Object")),$.close(),$.F):l4(_D);for(var Wt=s4.length;Wt--;)delete yD[mU][s4[Wt]];return yD()};wQ[a4]=!0;var CN=Object.create||function($,_e){var _t;return $!==null?(EU[mU]=SQ($),_t=new EU,EU[mU]=null,_t[a4]=$):_t=yD(),_e===void 0?_t:TQ.f(_t,_e)},IQ=TS,AQ=x1,u4=Error,OQ=_f("".replace),NQ=String(u4("zxcasd").stack),d4=/\n\s*at [^:]*:[^\n]*/,PQ=d4.test(NQ),kQ=I_,DQ=!_r(function(){var $=Error("a");return!("stack"in $)||(Object.defineProperty($,"stack",kQ(1,7)),$.stack!==7)}),LQ=x1,xQ=function($,_e){if(PQ&&typeof $=="string"&&!u4.prepareStackTrace)for(;_e--;)$=OQ($,d4,"");return $},MQ=DQ,h4=Error.captureStackTrace,yI={},UQ=yI,jQ=$0("iterator"),FQ=Array.prototype,p4=function($){return $!==void 0&&(UQ.Array===$||FQ[jQ]===$)},VQ=WR,f4=$_,BQ=lS,GQ=yI,HQ=$0("iterator"),SD=function($){if(!BQ($))return f4($,HQ)||f4($,"@@iterator")||GQ[VQ($)]},WQ=FE,qQ=O_,zQ=sT,KQ=s_,$Q=SD,YQ=TypeError,vU=function($,_e){var _t=arguments.length<2?$Q($):_e;if(qQ(_t))return zQ(WQ(_t,$));throw YQ(KQ($)+" is not iterable")},JQ=FE,m4=sT,XQ=$_,g4=function($,_e,_t){var Wt,_n;m4($);try{if(!(Wt=XQ($,"return"))){if(_e==="throw")throw _t;return _t}Wt=JQ(Wt,$)}catch(_i){_n=!0,Wt=_i}if(_e==="throw")throw _t;if(_n)throw Wt;return m4(Wt),_t},ZQ=L1,QQ=FE,eee=sT,tee=s_,nee=p4,ree=f1,E4=_m,iee=vU,oee=SD,_4=g4,see=TypeError,TD=function($,_e){this.stopped=$,this.result=_e},y4=TD.prototype,IN=function($,_e,_t){var Wt,_n,_i,_s,_c,_u,_h,_p=_t&&_t.that,Qm=!(!_t||!_t.AS_ENTRIES),_g=!(!_t||!_t.IS_RECORD),eE=!(!_t||!_t.IS_ITERATOR),pE=!(!_t||!_t.INTERRUPTED),aE=ZQ(_e,_p),cE=function(gE){return Wt&&_4(Wt,"normal",gE),new TD(!0,gE)},fE=function(gE){return Qm?(eee(gE),pE?aE(gE[0],gE[1],cE):aE(gE[0],gE[1])):pE?aE(gE,cE):aE(gE)};if(_g)Wt=$.iterator;else if(eE)Wt=$;else{if(!(_n=oee($)))throw see(tee($)+" is not iterable");if(nee(_n)){for(_i=0,_s=ree($);_s>_i;_i++)if((_c=fE($[_i]))&&E4(y4,_c))return _c;return new TD(!1)}Wt=iee($,_n)}for(_u=_g?$.next:Wt.next;!(_h=QQ(_u,Wt)).done;){try{_c=fE(_h.value)}catch(gE){_4(Wt,"throw",gE)}if(typeof _c=="object"&&_c&&E4(y4,_c))return _c}return new TD(!1)},aee=MT,cee=y0,lee=_m,uee=dU,wD=QZ,dee=function($,_e,_t){for(var Wt=dQ(_e),_n=pQ.f,_i=hQ.f,_s=0;_s<Wt.length;_s++){var _c=Wt[_s];i4($,_c)||_t&&i4(_t,_c)||_n($,_c,_i(_e,_c))}},b4=CN,_U=x1,yU=I_,hee=function($,_e){IQ(_e)&&"cause"in _e&&AQ($,"cause",_e.cause)},pee=function($,_e,_t,Wt){MQ&&(h4?h4($,_e):LQ($,"stack",xQ(_t,Wt)))},fee=IN,mee=function($,_e){return $===void 0?arguments.length<2?"":_e:aee($)},gee=$0("toStringTag"),RD=Error,Eee=[].push,cO=function($,_e){var _t,Wt=lee(bU,this);wD?_t=wD(RD(),Wt?uee(this):bU):(_t=Wt?this:b4(bU),_U(_t,gee,"Error")),_e!==void 0&&_U(_t,"message",mee(_e)),pee(_t,cO,_t.stack,1),arguments.length>2&&hee(_t,arguments[2]);var _n=[];return fee($,Eee,{that:_n}),_U(_t,"errors",_n),_t};wD?wD(cO,RD):dee(cO,RD,{name:!0});var bU=cO.prototype=b4(RD.prototype,{constructor:yU(1,cO),message:yU(1,""),name:yU(1,"AggregateError")});cee({global:!0,constructor:!0,arity:2},{AggregateError:cO});var CD,AN,ID,vee=vE,S4=rE.WeakMap,_ee=vee(S4)&&/native code/.test(String(S4)),T4=rE,yee=TS,bee=x1,SU=_0,TU=HR,See=sD,Tee=ED,w4="Object already initialized",wU=T4.TypeError,wee=T4.WeakMap;if(_ee||TU.state){var qR=TU.state||(TU.state=new wee);qR.get=qR.get,qR.has=qR.has,qR.set=qR.set,CD=function($,_e){if(qR.has($))throw wU(w4);return _e.facade=$,qR.set($,_e),_e},AN=function($){return qR.get($)||{}},ID=function($){return qR.has($)}}else{var lO=See("state");Tee[lO]=!0,CD=function($,_e){if(SU($,lO))throw wU(w4);return _e.facade=$,bee($,lO,_e),_e},AN=function($){return SU($,lO)?$[lO]:{}},ID=function($){return SU($,lO)}}var bI,R4,C4,SI={set:CD,get:AN,has:ID,enforce:function($){return ID($)?AN($):CD($,{})},getterFor:function($){return function(_e){var _t;if(!yee(_e)||(_t=AN(_e)).type!==$)throw wU("Incompatible receiver, "+$+" required");return _t}}},RU=jE,Ree=_0,I4=Function.prototype,Cee=RU&&Object.getOwnPropertyDescriptor,CU=Ree(I4,"name"),A4={EXISTS:CU,PROPER:CU&&(function(){}).name==="something",CONFIGURABLE:CU&&(!RU||RU&&Cee(I4,"name").configurable)},Iee=x1,M1=function($,_e,_t,Wt){return Wt&&Wt.enumerable?$[_e]=_t:Iee($,_e,_t),$},Aee=_r,Oee=vE,Nee=TS,Pee=CN,O4=dU,kee=M1,IU=$0("iterator"),N4=!1;[].keys&&("next"in(C4=[].keys())?(R4=O4(O4(C4)))!==Object.prototype&&(bI=R4):N4=!0);var Dee=!Nee(bI)||Aee(function(){var $={};return bI[IU].call($)!==$});Oee((bI=Dee?{}:Pee(bI))[IU])||kee(bI,IU,function(){return this});var P4={IteratorPrototype:bI,BUGGY_SAFARI_ITERATORS:N4},Lee=WR,xee=iU?{}.toString:function(){return"[object "+Lee(this)+"]"},Mee=iU,Uee=ZT.f,jee=x1,Fee=_0,Vee=xee,k4=$0("toStringTag"),U1=function($,_e,_t,Wt){if($){var _n=_t?$:$.prototype;Fee(_n,k4)||Uee(_n,k4,{configurable:!0,value:_e}),Wt&&!Mee&&jee(_n,"toString",Vee)}},Bee=P4.IteratorPrototype,Gee=CN,Hee=I_,Wee=U1,qee=yI,zee=function(){return this},AU=function($,_e,_t,Wt){var _n=_e+" Iterator";return $.prototype=Gee(Bee,{next:Hee(+!Wt,_t)}),Wee($,_n,!1,!0),qee[_n]=zee,$},Kee=y0,$ee=FE,Yee=A4,Jee=AU,Xee=dU,Zee=U1,D4=M1,L4=yI,Qee=P4,ete=Yee.PROPER,AD=Qee.BUGGY_SAFARI_ITERATORS,OU=$0("iterator"),x4="keys",OD="values",M4="entries",tte=function(){return this},U4=function($,_e,_t,Wt,_n,_i,_s){Jee(_t,_e,Wt);var _c,_u,_h,_p=function(fE){if(fE===_n&&aE)return aE;if(!AD&&fE in eE)return eE[fE];switch(fE){case x4:case OD:case M4:return function(){return new _t(this,fE)}}return function(){return new _t(this)}},Qm=_e+" Iterator",_g=!1,eE=$.prototype,pE=eE[OU]||eE["@@iterator"]||_n&&eE[_n],aE=!AD&&pE||_p(_n),cE=_e=="Array"&&eE.entries||pE;if(cE&&(_c=Xee(cE.call(new $)))!==Object.prototype&&_c.next&&(Zee(_c,Qm,!0,!0),L4[Qm]=tte),ete&&_n==OD&&pE&&pE.name!==OD&&(_g=!0,aE=function(){return $ee(pE,this)}),_n)if(_u={values:_p(OD),keys:_i?aE:_p(x4),entries:_p(M4)},_s)for(_h in _u)(AD||_g||!(_h in eE))&&D4(eE,_h,_u[_h]);else Kee({target:_e,proto:!0,forced:AD||_g},_u);return _s&&eE[OU]!==aE&&D4(eE,OU,aE,{name:_n}),L4[_e]=aE,_u},NU=function($,_e){return{value:$,done:_e}},nte=k0,j4=yI,F4=SI;ZT.f;var rte=U4,V4=NU,B4="Array Iterator",ite=F4.set,ote=F4.getterFor(B4);rte(Array,"Array",function($,_e){ite(this,{type:B4,target:nte($),index:0,kind:_e})},function(){var $=ote(this),_e=$.target,_t=$.kind,Wt=$.index++;return!_e||Wt>=_e.length?($.target=void 0,V4(void 0,!0)):V4(_t=="keys"?Wt:_t=="values"?_e[Wt]:[Wt,_e[Wt]],!1)},"values"),j4.Arguments=j4.Array;var ste=ZT,ND=function($,_e,_t){return ste.f($,_e,_t)},ate=OS,cte=ND,lte=jE,G4=$0("species"),ute=_m,dte=TypeError,PU=function($,_e){if(ute(_e,$))return $;throw dte("Incorrect invocation")},hte=vE,kU=HR,pte=_f(Function.toString);hte(kU.inspectSource)||(kU.inspectSource=function($){return pte($)});var H4=kU.inspectSource,fte=_f,mte=_r,W4=vE,gte=WR,Ete=H4,q4=function(){},vte=[],z4=OS("Reflect","construct"),DU=/^\s*(?:class|function)\b/,_te=fte(DU.exec),yte=!DU.exec(q4),ON=function($){if(!W4($))return!1;try{return z4(q4,vte,$),!0}catch{return!1}},K4=function($){if(!W4($))return!1;switch(gte($)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return yte||!!_te(DU,Ete($))}catch{return!0}};K4.sham=!0;var NN,uO,$4,LU,PD=!z4||mte(function(){var $;return ON(ON.call)||!ON(Object)||!ON(function(){$=!0})||$})?K4:ON,bte=PD,Ste=s_,Tte=TypeError,Y4=sT,wte=function($){if(bte($))return $;throw Tte(Ste($)+" is not a constructor")},Rte=lS,Cte=$0("species"),xU=function($,_e){var _t,Wt=Y4($).constructor;return Wt===void 0||Rte(_t=Y4(Wt)[Cte])?_e:wte(_t)},MU=_f([].slice),Ite=TypeError,DD=function($,_e){if($<_e)throw Ite("Not enough arguments");return $},J4=/(?:ipad|iphone|ipod).*applewebkit/i.test(VR),UT=rE,Ate=lE,Ote=L1,X4=vE,Nte=_0,Z4=_r,Q4=o4,Pte=MU,e2=JM,kte=DD,Dte=J4,Lte=wN,UU=UT.setImmediate,jU=UT.clearImmediate,xte=UT.process,FU=UT.Dispatch,Mte=UT.Function,t2=UT.MessageChannel,Ute=UT.String,VU=0,PN={},n2="onreadystatechange";Z4(function(){NN=UT.location});var BU=function($){if(Nte(PN,$)){var _e=PN[$];delete PN[$],_e()}},GU=function($){return function(){BU($)}},r2=function($){BU($.data)},i2=function($){UT.postMessage(Ute($),NN.protocol+"//"+NN.host)};UU&&jU||(UU=function($){kte(arguments.length,1);var _e=X4($)?$:Mte($),_t=Pte(arguments,1);return PN[++VU]=function(){Ate(_e,void 0,_t)},uO(VU),VU},jU=function($){delete PN[$]},Lte?uO=function($){xte.nextTick(GU($))}:FU&&FU.now?uO=function($){FU.now(GU($))}:t2&&!Dte?(LU=($4=new t2).port2,$4.port1.onmessage=r2,uO=Ote(LU.postMessage,LU)):UT.addEventListener&&X4(UT.postMessage)&&!UT.importScripts&&NN&&NN.protocol!=="file:"&&!Z4(i2)?(uO=i2,UT.addEventListener("message",r2,!1)):uO=n2 in e2("script")?function($){Q4.appendChild(e2("script"))[n2]=function(){Q4.removeChild(this),BU($)}}:function($){setTimeout(GU($),0)});var o2={set:UU,clear:jU},s2=function(){this.head=null,this.tail=null};s2.prototype={add:function($){var _e={item:$,next:null},_t=this.tail;_t?_t.next=_e:this.head=_e,this.tail=_e},get:function(){var $=this.head;if($)return(this.head=$.next)===null&&(this.tail=null),$.item}};var dO,HU,WU,qU,a2,c2=s2,jte=/ipad|iphone|ipod/i.test(VR)&&typeof Pebble<"u",Fte=/web0s(?!.*chrome)/i.test(VR),TI=rE,l2=L1,Vte=NE.f,zU=o2.set,Bte=c2,Gte=J4,Hte=jte,Wte=Fte,KU=wN,u2=TI.MutationObserver||TI.WebKitMutationObserver,d2=TI.document,h2=TI.process,LD=TI.Promise,p2=Vte(TI,"queueMicrotask"),$U=p2&&p2.value;if(!$U){var xD=new Bte,MD=function(){var $,_e;for(KU&&($=h2.domain)&&$.exit();_e=xD.get();)try{_e()}catch(_t){throw xD.head&&dO(),_t}$&&$.enter()};Gte||KU||Wte||!u2||!d2?!Hte&&LD&&LD.resolve?((qU=LD.resolve(void 0)).constructor=LD,a2=l2(qU.then,qU),dO=function(){a2(MD)}):KU?dO=function(){h2.nextTick(MD)}:(zU=l2(zU,TI),dO=function(){zU(MD)}):(HU=!0,WU=d2.createTextNode(""),new u2(MD).observe(WU,{characterData:!0}),dO=function(){WU.data=HU=!HU}),$U=function($){xD.head||dO(),xD.add($)}}var qte=$U,hO=function($){try{return{error:!1,value:$()}}catch(_e){return{error:!0,value:_e}}},wI=rE.Promise,f2=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",zte=!f2&&!wN&&typeof window=="object"&&typeof document=="object",Kte=rE,kN=wI,$te=vE,Yte=M8,Jte=H4,Xte=$0,Zte=zte,Qte=f2,YU=h1,m2=kN&&kN.prototype,ene=Xte("species"),g2=!1,E2=$te(Kte.PromiseRejectionEvent),tne=Yte("Promise",function(){var $=Jte(kN),_e=$!==String(kN);if(!_e&&YU===66||!m2.catch||!m2.finally)return!0;if(!YU||YU<51||!/native code/.test($)){var _t=new kN(function(_n){_n(1)}),Wt=function(_n){_n(function(){},function(){})};if((_t.constructor={})[ene]=Wt,!(g2=_t.then(function(){})instanceof Wt))return!0}return!_e&&(Zte||Qte)&&!E2}),DN={CONSTRUCTOR:tne,REJECTION_EVENT:E2,SUBCLASSING:g2},zR={},v2=O_,nne=TypeError,rne=function($){var _e,_t;this.promise=new $(function(Wt,_n){if(_e!==void 0||_t!==void 0)throw nne("Bad Promise constructor");_e=Wt,_t=_n}),this.resolve=v2(_e),this.reject=v2(_t)};zR.f=function($){return new rne($)};var JU,_2,ine=y0,UD=wN,j1=rE,LN=FE,one=M1,sne=U1,ane=function($){var _e=ate($);lte&&_e&&!_e[G4]&&cte(_e,G4,{configurable:!0,get:function(){return this}})},cne=O_,XU=vE,lne=TS,une=PU,dne=xU,y2=o2.set,ZU=qte,hne=function($,_e){try{arguments.length==1?console.error($):console.error($,_e)}catch{}},pne=hO,fne=c2,b2=SI,QU=wI,S2=DN,T2=zR,FD="Promise",w2=S2.CONSTRUCTOR,mne=S2.REJECTION_EVENT,_j=b2.getterFor(FD),gne=b2.set,Ene=QU&&QU.prototype,xN=QU,$j=Ene,R2=j1.TypeError,eF=j1.document,tF=j1.process,nF=T2.f,vne=nF,_ne=!!(eF&&eF.createEvent&&j1.dispatchEvent),C2="unhandledrejection",I2=function($){var _e;return!(!lne($)||!XU(_e=$.then))&&_e},A2=function($,_e){var _t,Wt,_n,_i=_e.value,_s=_e.state==1,_c=_s?$.ok:$.fail,_u=$.resolve,_h=$.reject,_p=$.domain;try{_c?(_s||(_e.rejection===2&&bne(_e),_e.rejection=1),_c===!0?_t=_i:(_p&&_p.enter(),_t=_c(_i),_p&&(_p.exit(),_n=!0)),_t===$.promise?_h(R2("Promise-chain cycle")):(Wt=I2(_t))?LN(Wt,_t,_u,_h):_u(_t)):_h(_i)}catch(Qm){_p&&!_n&&_p.exit(),_h(Qm)}},O2=function($,_e){$.notified||($.notified=!0,ZU(function(){for(var _t,Wt=$.reactions;_t=Wt.get();)A2(_t,$);$.notified=!1,_e&&!$.rejection&&yne($)}))},N2=function($,_e,_t){var Wt,_n;_ne?((Wt=eF.createEvent("Event")).promise=_e,Wt.reason=_t,Wt.initEvent($,!1,!0),j1.dispatchEvent(Wt)):Wt={promise:_e,reason:_t},!mne&&(_n=j1["on"+$])?_n(Wt):$===C2&&hne("Unhandled promise rejection",_t)},yne=function($){LN(y2,j1,function(){var _e,_t=$.facade,Wt=$.value;if(P2($)&&(_e=pne(function(){UD?tF.emit("unhandledRejection",Wt,_t):N2(C2,_t,Wt)}),$.rejection=UD||P2($)?2:1,_e.error))throw _e.value})},P2=function($){return $.rejection!==1&&!$.parent},bne=function($){LN(y2,j1,function(){var _e=$.facade;UD?tF.emit("rejectionHandled",_e):N2("rejectionhandled",_e,$.value)})},pO=function($,_e,_t){return function(Wt){$(_e,Wt,_t)}},fO=function($,_e,_t){$.done||($.done=!0,_t&&($=_t),$.value=_e,$.state=2,O2($,!0))},rF=function($,_e,_t){if(!$.done){$.done=!0,_t&&($=_t);try{if($.facade===_e)throw R2("Promise can't be resolved itself");var Wt=I2(_e);Wt?ZU(function(){var _n={done:!1};try{LN(Wt,_e,pO(rF,_n,$),pO(fO,_n,$))}catch(_i){fO(_n,_i,$)}}):($.value=_e,$.state=1,O2($,!1))}catch(_n){fO({done:!1},_n,$)}}};w2&&($j=(xN=function($){une(this,$j),cne($),LN(JU,this);var _e=_j(this);try{$(pO(rF,_e),pO(fO,_e))}catch(_t){fO(_e,_t)}}).prototype,(JU=function($){gne(this,{type:FD,done:!1,notified:!1,parent:!1,reactions:new fne,rejection:!1,state:0,value:void 0})}).prototype=one($j,"then",function($,_e){var _t=_j(this),Wt=nF(dne(this,xN));return _t.parent=!0,Wt.ok=!XU($)||$,Wt.fail=XU(_e)&&_e,Wt.domain=UD?tF.domain:void 0,_t.state==0?_t.reactions.add(Wt):ZU(function(){A2(Wt,_t)}),Wt.promise}),_2=function(){var $=new JU,_e=_j($);this.promise=$,this.resolve=pO(rF,_e),this.reject=pO(fO,_e)},T2.f=nF=function($){return $===xN||$===void 0?new _2($):vne($)}),ine({global:!0,constructor:!0,wrap:!0,forced:w2},{Promise:xN}),sne(xN,FD,!1,!0),ane(FD);var k2=$0("iterator"),D2=!1;try{var Sne=0,L2={next:function(){return{done:!!Sne++}},return:function(){D2=!0}};L2[k2]=function(){return this},Array.from(L2,function(){throw 2})}catch{}var Tne=wI,wne=function($,_e){if(!D2)return!1;var _t=!1;try{var Wt={};Wt[k2]=function(){return{next:function(){return{done:_t=!0}}}},$(Wt)}catch{}return _t},VD=DN.CONSTRUCTOR||!wne(function($){Tne.all($).then(void 0,function(){})}),Rne=FE,Cne=O_,Ine=zR,Ane=hO,One=IN;y0({target:"Promise",stat:!0,forced:VD},{all:function($){var _e=this,_t=Ine.f(_e),Wt=_t.resolve,_n=_t.reject,_i=Ane(function(){var _s=Cne(_e.resolve),_c=[],_u=0,_h=1;One($,function(_p){var Qm=_u++,_g=!1;_h++,Rne(_s,_e,_p).then(function(eE){_g||(_g=!0,_c[Qm]=eE,--_h||Wt(_c))},_n)}),--_h||Wt(_c)});return _i.error&&_n(_i.value),_t.promise}});var Nne=y0,Pne=DN.CONSTRUCTOR;wI&&wI.prototype,Nne({target:"Promise",proto:!0,forced:Pne,real:!0},{catch:function($){return this.then(void 0,$)}});var kne=FE,Dne=O_,Lne=zR,xne=hO,Mne=IN;y0({target:"Promise",stat:!0,forced:VD},{race:function($){var _e=this,_t=Lne.f(_e),Wt=_t.reject,_n=xne(function(){var _i=Dne(_e.resolve);Mne($,function(_s){kne(_i,_e,_s).then(_t.resolve,Wt)})});return _n.error&&Wt(_n.value),_t.promise}});var Une=FE,jne=zR;y0({target:"Promise",stat:!0,forced:DN.CONSTRUCTOR},{reject:function($){var _e=jne.f(this);return Une(_e.reject,void 0,$),_e.promise}});var Fne=sT,Vne=TS,Bne=zR,x2=function($,_e){if(Fne($),Vne(_e)&&_e.constructor===$)return _e;var _t=Bne.f($);return(0,_t.resolve)(_e),_t.promise},Gne=y0,Hne=wI,Wne=DN.CONSTRUCTOR,qne=x2,zne=OS("Promise"),Kne=!Wne;Gne({target:"Promise",stat:!0,forced:!0},{resolve:function($){return qne(Kne&&this===zne?Hne:this,$)}});var $ne=FE,Yne=O_,Jne=zR,Xne=hO,Zne=IN;y0({target:"Promise",stat:!0,forced:VD},{allSettled:function($){var _e=this,_t=Jne.f(_e),Wt=_t.resolve,_n=_t.reject,_i=Xne(function(){var _s=Yne(_e.resolve),_c=[],_u=0,_h=1;Zne($,function(_p){var Qm=_u++,_g=!1;_h++,$ne(_s,_e,_p).then(function(eE){_g||(_g=!0,_c[Qm]={status:"fulfilled",value:eE},--_h||Wt(_c))},function(eE){_g||(_g=!0,_c[Qm]={status:"rejected",reason:eE},--_h||Wt(_c))})}),--_h||Wt(_c)});return _i.error&&_n(_i.value),_t.promise}});var Qne=FE,ere=O_,tre=OS,nre=zR,rre=hO,ire=IN,M2="No one promise resolved";y0({target:"Promise",stat:!0,forced:VD},{any:function($){var _e=this,_t=tre("AggregateError"),Wt=nre.f(_e),_n=Wt.resolve,_i=Wt.reject,_s=rre(function(){var _c=ere(_e.resolve),_u=[],_h=0,_p=1,Qm=!1;ire($,function(_g){var eE=_h++,pE=!1;_p++,Qne(_c,_e,_g).then(function(aE){pE||Qm||(Qm=!0,_n(aE))},function(aE){pE||Qm||(pE=!0,_u[eE]=aE,--_p||_i(new _t(_u,M2)))})}),--_p||_i(new _t(_u,M2))});return _s.error&&_i(_s.value),Wt.promise}});var ore=y0,iF=wI,sre=_r,are=OS,cre=vE,lre=xU,U2=x2,ure=iF&&iF.prototype;ore({target:"Promise",proto:!0,real:!0,forced:!!iF&&sre(function(){ure.finally.call({then:function(){}},function(){})})},{finally:function($){var _e=lre(this,are("Promise")),_t=cre($);return this.then(_t?function(Wt){return U2(_e,$()).then(function(){return Wt})}:$,_t?function(Wt){return U2(_e,$()).then(function(){throw Wt})}:$)}});var oF=_f,dre=tU,hre=MT,pre=E0,fre=oF("".charAt),j2=oF("".charCodeAt),mre=oF("".slice),F2=function($){return function(_e,_t){var Wt,_n,_i=hre(pre(_e)),_s=dre(_t),_c=_i.length;return _s<0||_s>=_c?$?"":void 0:(Wt=j2(_i,_s))<55296||Wt>56319||_s+1===_c||(_n=j2(_i,_s+1))<56320||_n>57343?$?fre(_i,_s):Wt:$?mre(_i,_s,_s+2):_n-56320+(Wt-55296<<10)+65536}},sF={codeAt:F2(!1),charAt:F2(!0)},gre=sF.charAt,Ere=MT,V2=SI,vre=U4,B2=NU,G2="String Iterator",_re=V2.set,yre=V2.getterFor(G2);vre(String,"String",function($){_re(this,{type:G2,string:Ere($),index:0})},function(){var $,_e=yre(this),_t=_e.string,Wt=_e.index;return Wt>=_t.length?B2(void 0,!0):($=gre(_t,Wt),_e.index+=$.length,B2($,!1))});var bre=yS.Promise,Sre={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Tre=rE,wre=WR,Rre=x1,H2=yI,W2=$0("toStringTag");for(var aF in Sre){var q2=Tre[aF],cF=q2&&q2.prototype;cF&&wre(cF)!==W2&&Rre(cF,W2,aF),H2[aF]=H2.Array}var z2=bre,n_=zt(z2);const K2=J8;function $2($,_e){const _t=$&&$.navigator;if(!_t.mediaDevices)return;const Wt=function(_s){if(typeof _s!="object"||_s.mandatory||_s.optional)return _s;const _c={};return Object.keys(_s).forEach(_u=>{if(_u==="require"||_u==="advanced"||_u==="mediaSource")return;const _h=typeof _s[_u]=="object"?_s[_u]:{ideal:_s[_u]};_h.exact!==void 0&&typeof _h.exact=="number"&&(_h.min=_h.max=_h.exact);const _p=function(Qm,_g){return Qm?Qm+_g.charAt(0).toUpperCase()+_g.slice(1):_g==="deviceId"?"sourceId":_g};if(_h.ideal!==void 0){_c.optional=_c.optional||[];let Qm={};typeof _h.ideal=="number"?(Qm[_p("min",_u)]=_h.ideal,_c.optional.push(Qm),Qm={},Qm[_p("max",_u)]=_h.ideal,_c.optional.push(Qm)):(Qm[_p("",_u)]=_h.ideal,_c.optional.push(Qm))}_h.exact!==void 0&&typeof _h.exact!="number"?(_c.mandatory=_c.mandatory||{},_c.mandatory[_p("",_u)]=_h.exact):["min","max"].forEach(Qm=>{_h[Qm]!==void 0&&(_c.mandatory=_c.mandatory||{},_c.mandatory[_p(Qm,_u)]=_h[Qm])})}),_s.advanced&&(_c.optional=(_c.optional||[]).concat(_s.advanced)),_c},_n=function(_s,_c){if(_e.version>=61)return _c(_s);if((_s=JSON.parse(JSON.stringify(_s)))&&typeof _s.audio=="object"){const _u=function(_h,_p,Qm){_p in _h&&!(Qm in _h)&&(_h[Qm]=_h[_p],delete _h[_p])};_u((_s=JSON.parse(JSON.stringify(_s))).audio,"autoGainControl","googAutoGainControl"),_u(_s.audio,"noiseSuppression","googNoiseSuppression"),_s.audio=Wt(_s.audio)}if(_s&&typeof _s.video=="object"){let _u=_s.video.facingMode;_u=_u&&(typeof _u=="object"?_u:{ideal:_u});const _h=_e.version<66;if(_u&&(_u.exact==="user"||_u.exact==="environment"||_u.ideal==="user"||_u.ideal==="environment")&&(!_t.mediaDevices.getSupportedConstraints||!_t.mediaDevices.getSupportedConstraints().facingMode||_h)){let _p;if(delete _s.video.facingMode,_u.exact==="environment"||_u.ideal==="environment"?_p=["back","rear"]:_u.exact!=="user"&&_u.ideal!=="user"||(_p=["front"]),_p)return _t.mediaDevices.enumerateDevices().then(Qm=>{let _g=(Qm=Qm.filter(eE=>eE.kind==="videoinput")).find(eE=>_p.some(pE=>{var aE;return i_(aE=eE.label.toLowerCase()).call(aE,pE)}));return!_g&&Qm.length&&i_(_p).call(_p,"back")&&(_g=Qm[Qm.length-1]),_g&&(_s.video.deviceId=_u.exact?{exact:_g.deviceId}:{ideal:_g.deviceId}),_s.video=Wt(_s.video),K2("chrome: "+JSON.stringify(_s)),_c(_s)})}_s.video=Wt(_s.video)}return K2("chrome: "+JSON.stringify(_s)),_c(_s)},_i=function(_s){return _e.version>=64?_s:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[_s.name]||_s.name,message:_s.message,constraint:_s.constraint||_s.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(_t.getUserMedia=(function(_s,_c,_u){_n(_s,_h=>{_t.webkitGetUserMedia(_h,_c,_p=>{_u&&_u(_i(_p))})})}).bind(_t),_t.mediaDevices.getUserMedia){const _s=_t.mediaDevices.getUserMedia.bind(_t.mediaDevices);_t.mediaDevices.getUserMedia=function(_c){return _n(_c,_u=>_s(_u).then(_h=>{if(_u.audio&&!_h.getAudioTracks().length||_u.video&&!_h.getVideoTracks().length)throw _h.getTracks().forEach(_p=>{_p.stop()}),new DOMException("","NotFoundError");return _h},_h=>n_.reject(_i(_h))))}}}function Y2($){$.MediaStream=$.MediaStream||$.webkitMediaStream}function J2($){if(typeof $=="object"&&$.RTCPeerConnection&&!("ontrack"in $.RTCPeerConnection.prototype)){Object.defineProperty($.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(_t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=_t)},enumerable:!0,configurable:!0});const _e=$.RTCPeerConnection.prototype.setRemoteDescription;$.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=_t=>{_t.stream.addEventListener("addtrack",Wt=>{let _n;_n=$.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_s=>_s.track&&_s.track.id===Wt.track.id):{track:Wt.track};const _i=new Event("track");_i.track=Wt.track,_i.receiver=_n,_i.transceiver={receiver:_n},_i.streams=[_t.stream],this.dispatchEvent(_i)}),_t.stream.getTracks().forEach(Wt=>{let _n;_n=$.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_s=>_s.track&&_s.track.id===Wt.id):{track:Wt};const _i=new Event("track");_i.track=Wt,_i.receiver=_n,_i.transceiver={receiver:_n},_i.streams=[_t.stream],this.dispatchEvent(_i)})},this.addEventListener("addstream",this._ontrackpoly)),_e.apply(this,arguments)}}else _I($,"track",_e=>(_e.transceiver||Object.defineProperty(_e,"transceiver",{value:{receiver:_e.receiver}}),_e))}function X2($){if(typeof $=="object"&&$.RTCPeerConnection&&!("getSenders"in $.RTCPeerConnection.prototype)&&"createDTMFSender"in $.RTCPeerConnection.prototype){const _e=function(_n,_i){return{track:_i,get dtmf(){return this._dtmf===void 0&&(_i.kind==="audio"?this._dtmf=_n.createDTMFSender(_i):this._dtmf=null),this._dtmf},_pc:_n}};if(!$.RTCPeerConnection.prototype.getSenders){$.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const _n=$.RTCPeerConnection.prototype.addTrack;$.RTCPeerConnection.prototype.addTrack=function(_s,_c){let _u=_n.apply(this,arguments);return _u||(_u=_e(this,_s),this._senders.push(_u)),_u};const _i=$.RTCPeerConnection.prototype.removeTrack;$.RTCPeerConnection.prototype.removeTrack=function(_s){_i.apply(this,arguments);const _c=this._senders.indexOf(_s);_c!==-1&&this._senders.splice(_c,1)}}const _t=$.RTCPeerConnection.prototype.addStream;$.RTCPeerConnection.prototype.addStream=function(_n){this._senders=this._senders||[],_t.apply(this,[_n]),_n.getTracks().forEach(_i=>{this._senders.push(_e(this,_i))})};const Wt=$.RTCPeerConnection.prototype.removeStream;$.RTCPeerConnection.prototype.removeStream=function(_n){this._senders=this._senders||[],Wt.apply(this,[_n]),_n.getTracks().forEach(_i=>{const _s=this._senders.find(_c=>_c.track===_i);_s&&this._senders.splice(this._senders.indexOf(_s),1)})}}else if(typeof $=="object"&&$.RTCPeerConnection&&"getSenders"in $.RTCPeerConnection.prototype&&"createDTMFSender"in $.RTCPeerConnection.prototype&&$.RTCRtpSender&&!("dtmf"in $.RTCRtpSender.prototype)){const _e=$.RTCPeerConnection.prototype.getSenders;$.RTCPeerConnection.prototype.getSenders=function(){const _t=_e.apply(this,[]);return _t.forEach(Wt=>Wt._pc=this),_t},Object.defineProperty($.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Z2($){if(!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection.prototype.getStats;$.RTCPeerConnection.prototype.getStats=function(){const[_t,Wt,_n]=arguments;if(arguments.length>0&&typeof _t=="function")return _e.apply(this,arguments);if(_e.length===0&&(arguments.length===0||typeof _t!="function"))return _e.apply(this,[]);const _i=function(_c){const _u={};return _c.result().forEach(_h=>{const _p={id:_h.id,timestamp:_h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_h.type]||_h.type};_h.names().forEach(Qm=>{_p[Qm]=_h.stat(Qm)}),_u[_p.id]=_p}),_u},_s=function(_c){return new Map(Object.keys(_c).map(_u=>[_u,_c[_u]]))};if(arguments.length>=2){const _c=function(_u){Wt(_s(_i(_u)))};return _e.apply(this,[_c,_t])}return new n_((_c,_u)=>{_e.apply(this,[function(_h){_c(_s(_i(_h)))},_u])}).then(Wt,_n)}}function Q2($){if(!(typeof $=="object"&&$.RTCPeerConnection&&$.RTCRtpSender&&$.RTCRtpReceiver))return;if(!("getStats"in $.RTCRtpSender.prototype)){const _t=$.RTCPeerConnection.prototype.getSenders;_t&&($.RTCPeerConnection.prototype.getSenders=function(){const _n=_t.apply(this,[]);return _n.forEach(_i=>_i._pc=this),_n});const Wt=$.RTCPeerConnection.prototype.addTrack;Wt&&($.RTCPeerConnection.prototype.addTrack=function(){const _n=Wt.apply(this,arguments);return _n._pc=this,_n}),$.RTCRtpSender.prototype.getStats=function(){const _n=this;return this._pc.getStats().then(_i=>Q8(_i,_n.track,!0))}}if(!("getStats"in $.RTCRtpReceiver.prototype)){const _t=$.RTCPeerConnection.prototype.getReceivers;_t&&($.RTCPeerConnection.prototype.getReceivers=function(){const Wt=_t.apply(this,[]);return Wt.forEach(_n=>_n._pc=this),Wt}),_I($,"track",Wt=>(Wt.receiver._pc=Wt.srcElement,Wt)),$.RTCRtpReceiver.prototype.getStats=function(){const Wt=this;return this._pc.getStats().then(_n=>Q8(_n,Wt.track,!1))}}if(!("getStats"in $.RTCRtpSender.prototype)||!("getStats"in $.RTCRtpReceiver.prototype))return;const _e=$.RTCPeerConnection.prototype.getStats;$.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof $.MediaStreamTrack){const _t=arguments[0];let Wt,_n,_i;return this.getSenders().forEach(_s=>{_s.track===_t&&(Wt?_i=!0:Wt=_s)}),this.getReceivers().forEach(_s=>(_s.track===_t&&(_n?_i=!0:_n=_s),_s.track===_t)),_i||Wt&&_n?n_.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):Wt?Wt.getStats():_n?_n.getStats():n_.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return _e.apply(this,arguments)}}function e5($){$.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_i=>this._shimmedLocalStreams[_i][0])};const _e=$.RTCPeerConnection.prototype.addTrack;$.RTCPeerConnection.prototype.addTrack=function(_i,_s){if(!_s)return _e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const _c=_e.apply(this,arguments);return this._shimmedLocalStreams[_s.id]?this._shimmedLocalStreams[_s.id].indexOf(_c)===-1&&this._shimmedLocalStreams[_s.id].push(_c):this._shimmedLocalStreams[_s.id]=[_s,_c],_c};const _t=$.RTCPeerConnection.prototype.addStream;$.RTCPeerConnection.prototype.addStream=function(_i){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_i.getTracks().forEach(_u=>{if(this.getSenders().find(_p=>_p.track===_u))throw new DOMException("Track already exists.","InvalidAccessError")});const _s=this.getSenders();_t.apply(this,arguments);const _c=this.getSenders().filter(_u=>_s.indexOf(_u)===-1);this._shimmedLocalStreams[_i.id]=[_i].concat(_c)};const Wt=$.RTCPeerConnection.prototype.removeStream;$.RTCPeerConnection.prototype.removeStream=function(_i){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_i.id],Wt.apply(this,arguments)};const _n=$.RTCPeerConnection.prototype.removeTrack;$.RTCPeerConnection.prototype.removeTrack=function(_i){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_i&&Object.keys(this._shimmedLocalStreams).forEach(_s=>{const _c=this._shimmedLocalStreams[_s].indexOf(_i);_c!==-1&&this._shimmedLocalStreams[_s].splice(_c,1),this._shimmedLocalStreams[_s].length===1&&delete this._shimmedLocalStreams[_s]}),_n.apply(this,arguments)}}function t5($,_e){if(!$.RTCPeerConnection)return;if($.RTCPeerConnection.prototype.addTrack&&_e.version>=65)return e5($);const _t=$.RTCPeerConnection.prototype.getLocalStreams;$.RTCPeerConnection.prototype.getLocalStreams=function(){const _u=_t.apply(this);return this._reverseStreams=this._reverseStreams||{},_u.map(_h=>this._reverseStreams[_h.id])};const Wt=$.RTCPeerConnection.prototype.addStream;$.RTCPeerConnection.prototype.addStream=function(_u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_u.getTracks().forEach(_h=>{if(this.getSenders().find(Qm=>Qm.track===_h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_u.id]){const _h=new $.MediaStream(_u.getTracks());this._streams[_u.id]=_h,this._reverseStreams[_h.id]=_u,_u=_h}Wt.apply(this,[_u])};const _n=$.RTCPeerConnection.prototype.removeStream;function _i(_u,_h){let _p=_h.sdp;return Object.keys(_u._reverseStreams||[]).forEach(Qm=>{const _g=_u._reverseStreams[Qm],eE=_u._streams[_g.id];_p=_p.replace(new RegExp(eE.id,"g"),_g.id)}),new RTCSessionDescription({type:_h.type,sdp:_p})}$.RTCPeerConnection.prototype.removeStream=function(_u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_n.apply(this,[this._streams[_u.id]||_u]),delete this._reverseStreams[this._streams[_u.id]?this._streams[_u.id].id:_u.id],delete this._streams[_u.id]},$.RTCPeerConnection.prototype.addTrack=function(_u,_h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _p=[].slice.call(arguments,1);if(_p.length!==1||!_p[0].getTracks().find(eE=>eE===_u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(eE=>eE.track===_u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _g=this._streams[_h.id];if(_g)_g.addTrack(_u),n_.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const eE=new $.MediaStream([_u]);this._streams[_h.id]=eE,this._reverseStreams[eE.id]=_h,this.addStream(eE)}return this.getSenders().find(eE=>eE.track===_u)},["createOffer","createAnswer"].forEach(function(_u){const _h=$.RTCPeerConnection.prototype[_u],_p={[_u](){const Qm=arguments;return arguments.length&&typeof arguments[0]=="function"?_h.apply(this,[_g=>{const eE=_i(this,_g);Qm[0].apply(null,[eE])},_g=>{Qm[1]&&Qm[1].apply(null,_g)},arguments[2]]):_h.apply(this,arguments).then(_g=>_i(this,_g))}};$.RTCPeerConnection.prototype[_u]=_p[_u]});const _s=$.RTCPeerConnection.prototype.setLocalDescription;$.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(_u,_h){let _p=_h.sdp;return Object.keys(_u._reverseStreams||[]).forEach(Qm=>{const _g=_u._reverseStreams[Qm],eE=_u._streams[_g.id];_p=_p.replace(new RegExp(_g.id,"g"),eE.id)}),new RTCSessionDescription({type:_h.type,sdp:_p})}(this,arguments[0]),_s.apply(this,arguments)):_s.apply(this,arguments)};const _c=Object.getOwnPropertyDescriptor($.RTCPeerConnection.prototype,"localDescription");Object.defineProperty($.RTCPeerConnection.prototype,"localDescription",{get(){const _u=_c.get.apply(this);return _u.type===""?_u:_i(this,_u)}}),$.RTCPeerConnection.prototype.removeTrack=function(_u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_u._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let _h;this._streams=this._streams||{},Object.keys(this._streams).forEach(_p=>{this._streams[_p].getTracks().find(Qm=>_u.track===Qm)&&(_h=this._streams[_p])}),_h&&(_h.getTracks().length===1?this.removeStream(this._reverseStreams[_h.id]):_h.removeTrack(_u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function lF($,_e){!$.RTCPeerConnection&&$.webkitRTCPeerConnection&&($.RTCPeerConnection=$.webkitRTCPeerConnection),$.RTCPeerConnection&&_e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(_t){const Wt=$.RTCPeerConnection.prototype[_t],_n={[_t](){return arguments[0]=new(_t==="addIceCandidate"?$.RTCIceCandidate:$.RTCSessionDescription)(arguments[0]),Wt.apply(this,arguments)}};$.RTCPeerConnection.prototype[_t]=_n[_t]})}function n5($,_e){_I($,"negotiationneeded",_t=>{const Wt=_t.target;if(!(_e.version<72||Wt.getConfiguration&&Wt.getConfiguration().sdpSemantics==="plan-b")||Wt.signalingState==="stable")return _t})}var r5=Object.freeze({__proto__:null,fixNegotiationNeeded:n5,shimAddTrackRemoveTrack:t5,shimAddTrackRemoveTrackWithNative:e5,shimGetDisplayMedia:function($,_e){$.navigator.mediaDevices&&"getDisplayMedia"in $.navigator.mediaDevices||$.navigator.mediaDevices&&(typeof _e=="function"?$.navigator.mediaDevices.getDisplayMedia=function(_t){return _e(_t).then(Wt=>{const _n=_t.video&&_t.video.width,_i=_t.video&&_t.video.height,_s=_t.video&&_t.video.frameRate;return _t.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:Wt,maxFrameRate:_s||3}},_n&&(_t.video.mandatory.maxWidth=_n),_i&&(_t.video.mandatory.maxHeight=_i),$.navigator.mediaDevices.getUserMedia(_t)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:X2,shimGetStats:Z2,shimGetUserMedia:$2,shimMediaStream:Y2,shimOnTrack:J2,shimPeerConnection:lF,shimSenderReceiverGetStats:Q2});function i5($,_e){const _t=$&&$.navigator,Wt=$&&$.MediaStreamTrack;if(_t.getUserMedia=function(_n,_i,_s){cU("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),_t.mediaDevices.getUserMedia(_n).then(_i,_s)},!(_e.version>55&&"autoGainControl"in _t.mediaDevices.getSupportedConstraints())){const _n=function(_s,_c,_u){_c in _s&&!(_u in _s)&&(_s[_u]=_s[_c],delete _s[_c])},_i=_t.mediaDevices.getUserMedia.bind(_t.mediaDevices);if(_t.mediaDevices.getUserMedia=function(_s){return typeof _s=="object"&&typeof _s.audio=="object"&&(_s=JSON.parse(JSON.stringify(_s)),_n(_s.audio,"autoGainControl","mozAutoGainControl"),_n(_s.audio,"noiseSuppression","mozNoiseSuppression")),_i(_s)},Wt&&Wt.prototype.getSettings){const _s=Wt.prototype.getSettings;Wt.prototype.getSettings=function(){const _c=_s.apply(this,arguments);return _n(_c,"mozAutoGainControl","autoGainControl"),_n(_c,"mozNoiseSuppression","noiseSuppression"),_c}}if(Wt&&Wt.prototype.applyConstraints){const _s=Wt.prototype.applyConstraints;Wt.prototype.applyConstraints=function(_c){return this.kind==="audio"&&typeof _c=="object"&&(_c=JSON.parse(JSON.stringify(_c)),_n(_c,"autoGainControl","mozAutoGainControl"),_n(_c,"noiseSuppression","mozNoiseSuppression")),_s.apply(this,[_c])}}}}function o5($){typeof $=="object"&&$.RTCTrackEvent&&"receiver"in $.RTCTrackEvent.prototype&&!("transceiver"in $.RTCTrackEvent.prototype)&&Object.defineProperty($.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function uF($,_e){if(typeof $!="object"||!$.RTCPeerConnection&&!$.mozRTCPeerConnection)return;!$.RTCPeerConnection&&$.mozRTCPeerConnection&&($.RTCPeerConnection=$.mozRTCPeerConnection),_e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(_n){const _i=$.RTCPeerConnection.prototype[_n],_s={[_n](){return arguments[0]=new(_n==="addIceCandidate"?$.RTCIceCandidate:$.RTCSessionDescription)(arguments[0]),_i.apply(this,arguments)}};$.RTCPeerConnection.prototype[_n]=_s[_n]});const _t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},Wt=$.RTCPeerConnection.prototype.getStats;$.RTCPeerConnection.prototype.getStats=function(){const[_n,_i,_s]=arguments;return Wt.apply(this,[_n||null]).then(_c=>{if(_e.version<53&&!_i)try{_c.forEach(_u=>{_u.type=_t[_u.type]||_u.type})}catch(_u){if(_u.name!=="TypeError")throw _u;_c.forEach((_h,_p)=>{_c.set(_p,Object.assign({},_h,{type:_t[_h.type]||_h.type}))})}return _c}).then(_i,_s)}}function s5($){if(typeof $!="object"||!$.RTCPeerConnection||!$.RTCRtpSender||$.RTCRtpSender&&"getStats"in $.RTCRtpSender.prototype)return;const _e=$.RTCPeerConnection.prototype.getSenders;_e&&($.RTCPeerConnection.prototype.getSenders=function(){const Wt=_e.apply(this,[]);return Wt.forEach(_n=>_n._pc=this),Wt});const _t=$.RTCPeerConnection.prototype.addTrack;_t&&($.RTCPeerConnection.prototype.addTrack=function(){const Wt=_t.apply(this,arguments);return Wt._pc=this,Wt}),$.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):n_.resolve(new Map)}}function a5($){if(typeof $!="object"||!$.RTCPeerConnection||!$.RTCRtpSender||$.RTCRtpSender&&"getStats"in $.RTCRtpReceiver.prototype)return;const _e=$.RTCPeerConnection.prototype.getReceivers;_e&&($.RTCPeerConnection.prototype.getReceivers=function(){const _t=_e.apply(this,[]);return _t.forEach(Wt=>Wt._pc=this),_t}),_I($,"track",_t=>(_t.receiver._pc=_t.srcElement,_t)),$.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function c5($){$.RTCPeerConnection&&!("removeStream"in $.RTCPeerConnection.prototype)&&($.RTCPeerConnection.prototype.removeStream=function(_e){cU("removeStream","removeTrack"),this.getSenders().forEach(_t=>{var Wt;_t.track&&i_(Wt=_e.getTracks()).call(Wt,_t.track)&&this.removeTrack(_t)})})}function l5($){$.DataChannel&&!$.RTCDataChannel&&($.RTCDataChannel=$.DataChannel)}function u5($){if(typeof $!="object"||!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection.prototype.addTransceiver;_e&&($.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let _t=arguments[1]&&arguments[1].sendEncodings;_t===void 0&&(_t=[]),_t=[..._t];const Wt=_t.length>0;Wt&&_t.forEach(_i=>{if("rid"in _i&&!/^[a-z0-9]{0,16}$/i.test(_i.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _i&&!(parseFloat(_i.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _i&&!(parseFloat(_i.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const _n=_e.apply(this,arguments);if(Wt){const{sender:_i}=_n,_s=_i.getParameters();(!("encodings"in _s)||_s.encodings.length===1&&Object.keys(_s.encodings[0]).length===0)&&(_s.encodings=_t,_i.sendEncodings=_t,this.setParametersPromises.push(_i.setParameters(_s).then(()=>{delete _i.sendEncodings}).catch(()=>{delete _i.sendEncodings})))}return _n})}function d5($){if(typeof $!="object"||!$.RTCRtpSender)return;const _e=$.RTCRtpSender.prototype.getParameters;_e&&($.RTCRtpSender.prototype.getParameters=function(){const _t=_e.apply(this,arguments);return"encodings"in _t||(_t.encodings=[].concat(this.sendEncodings||[{}])),_t})}function h5($){if(typeof $!="object"||!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection.prototype.createOffer;$.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?n_.all(this.setParametersPromises).then(()=>_e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):_e.apply(this,arguments)}}function p5($){if(typeof $!="object"||!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection.prototype.createAnswer;$.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?n_.all(this.setParametersPromises).then(()=>_e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):_e.apply(this,arguments)}}var f5=Object.freeze({__proto__:null,shimAddTransceiver:u5,shimCreateAnswer:p5,shimCreateOffer:h5,shimGetDisplayMedia:function($,_e){$.navigator.mediaDevices&&"getDisplayMedia"in $.navigator.mediaDevices||$.navigator.mediaDevices&&($.navigator.mediaDevices.getDisplayMedia=function(_t){if(!_t||!_t.video){const Wt=new DOMException("getDisplayMedia without video constraints is undefined");return Wt.name="NotFoundError",Wt.code=8,n_.reject(Wt)}return _t.video===!0?_t.video={mediaSource:_e}:_t.video.mediaSource=_e,$.navigator.mediaDevices.getUserMedia(_t)})},shimGetParameters:d5,shimGetUserMedia:i5,shimOnTrack:o5,shimPeerConnection:uF,shimRTCDataChannel:l5,shimReceiverGetStats:a5,shimRemoveStream:c5,shimSenderGetStats:s5});function m5($){if(typeof $=="object"&&$.RTCPeerConnection){if("getLocalStreams"in $.RTCPeerConnection.prototype||($.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in $.RTCPeerConnection.prototype)){const _e=$.RTCPeerConnection.prototype.addTrack;$.RTCPeerConnection.prototype.addStream=function(_t){var Wt;this._localStreams||(this._localStreams=[]),i_(Wt=this._localStreams).call(Wt,_t)||this._localStreams.push(_t),_t.getAudioTracks().forEach(_n=>_e.call(this,_n,_t)),_t.getVideoTracks().forEach(_n=>_e.call(this,_n,_t))},$.RTCPeerConnection.prototype.addTrack=function(_t){for(var Wt=arguments.length,_n=new Array(Wt>1?Wt-1:0),_i=1;_i<Wt;_i++)_n[_i-1]=arguments[_i];return _n&&_n.forEach(_s=>{var _c;this._localStreams?i_(_c=this._localStreams).call(_c,_s)||this._localStreams.push(_s):this._localStreams=[_s]}),_e.apply(this,arguments)}}"removeStream"in $.RTCPeerConnection.prototype||($.RTCPeerConnection.prototype.removeStream=function(_e){this._localStreams||(this._localStreams=[]);const _t=this._localStreams.indexOf(_e);if(_t===-1)return;this._localStreams.splice(_t,1);const Wt=_e.getTracks();this.getSenders().forEach(_n=>{i_(Wt).call(Wt,_n.track)&&this.removeTrack(_n)})})}}function g5($){if(typeof $=="object"&&$.RTCPeerConnection&&("getRemoteStreams"in $.RTCPeerConnection.prototype||($.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in $.RTCPeerConnection.prototype))){Object.defineProperty($.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(_t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=_t),this.addEventListener("track",this._onaddstreampoly=Wt=>{Wt.streams.forEach(_n=>{var _i;if(this._remoteStreams||(this._remoteStreams=[]),i_(_i=this._remoteStreams).call(_i,_n))return;this._remoteStreams.push(_n);const _s=new Event("addstream");_s.stream=_n,this.dispatchEvent(_s)})})}});const _e=$.RTCPeerConnection.prototype.setRemoteDescription;$.RTCPeerConnection.prototype.setRemoteDescription=function(){const _t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(Wt){Wt.streams.forEach(_n=>{if(_t._remoteStreams||(_t._remoteStreams=[]),_t._remoteStreams.indexOf(_n)>=0)return;_t._remoteStreams.push(_n);const _i=new Event("addstream");_i.stream=_n,_t.dispatchEvent(_i)})}),_e.apply(_t,arguments)}}}function E5($){if(typeof $!="object"||!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection.prototype,_t=_e.createOffer,Wt=_e.createAnswer,_n=_e.setLocalDescription,_i=_e.setRemoteDescription,_s=_e.addIceCandidate;_e.createOffer=function(_u,_h){const _p=arguments.length>=2?arguments[2]:arguments[0],Qm=_t.apply(this,[_p]);return _h?(Qm.then(_u,_h),n_.resolve()):Qm},_e.createAnswer=function(_u,_h){const _p=arguments.length>=2?arguments[2]:arguments[0],Qm=Wt.apply(this,[_p]);return _h?(Qm.then(_u,_h),n_.resolve()):Qm};let _c=function(_u,_h,_p){const Qm=_n.apply(this,[_u]);return _p?(Qm.then(_h,_p),n_.resolve()):Qm};_e.setLocalDescription=_c,_c=function(_u,_h,_p){const Qm=_i.apply(this,[_u]);return _p?(Qm.then(_h,_p),n_.resolve()):Qm},_e.setRemoteDescription=_c,_c=function(_u,_h,_p){const Qm=_s.apply(this,[_u]);return _p?(Qm.then(_h,_p),n_.resolve()):Qm},_e.addIceCandidate=_c}function v5($){const _e=$&&$.navigator;if(_e.mediaDevices&&_e.mediaDevices.getUserMedia){const _t=_e.mediaDevices,Wt=_t.getUserMedia.bind(_t);_e.mediaDevices.getUserMedia=_n=>Wt(_5(_n))}!_e.getUserMedia&&_e.mediaDevices&&_e.mediaDevices.getUserMedia&&(_e.getUserMedia=(function(_t,Wt,_n){_e.mediaDevices.getUserMedia(_t).then(Wt,_n)}).bind(_e))}function _5($){return $&&$.video!==void 0?Object.assign({},$,{video:Z8($.video)}):$}function y5($){if(!$.RTCPeerConnection)return;const _e=$.RTCPeerConnection;$.RTCPeerConnection=function(_t,Wt){if(_t&&_t.iceServers){const _n=[];for(let _i=0;_i<_t.iceServers.length;_i++){let _s=_t.iceServers[_i];!_s.hasOwnProperty("urls")&&_s.hasOwnProperty("url")?(cU("RTCIceServer.url","RTCIceServer.urls"),_s=JSON.parse(JSON.stringify(_s)),_s.urls=_s.url,delete _s.url,_n.push(_s)):_n.push(_t.iceServers[_i])}_t.iceServers=_n}return new _e(_t,Wt)},$.RTCPeerConnection.prototype=_e.prototype,"generateCertificate"in _e&&Object.defineProperty($.RTCPeerConnection,"generateCertificate",{get:()=>_e.generateCertificate})}function b5($){typeof $=="object"&&$.RTCTrackEvent&&"receiver"in $.RTCTrackEvent.prototype&&!("transceiver"in $.RTCTrackEvent.prototype)&&Object.defineProperty($.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function S5($){const _e=$.RTCPeerConnection.prototype.createOffer;$.RTCPeerConnection.prototype.createOffer=function(_t){if(_t){_t.offerToReceiveAudio!==void 0&&(_t.offerToReceiveAudio=!!_t.offerToReceiveAudio);const Wt=this.getTransceivers().find(_i=>_i.receiver.track.kind==="audio");_t.offerToReceiveAudio===!1&&Wt?Wt.direction==="sendrecv"?Wt.setDirection?Wt.setDirection("sendonly"):Wt.direction="sendonly":Wt.direction==="recvonly"&&(Wt.setDirection?Wt.setDirection("inactive"):Wt.direction="inactive"):_t.offerToReceiveAudio!==!0||Wt||this.addTransceiver("audio",{direction:"recvonly"}),_t.offerToReceiveVideo!==void 0&&(_t.offerToReceiveVideo=!!_t.offerToReceiveVideo);const _n=this.getTransceivers().find(_i=>_i.receiver.track.kind==="video");_t.offerToReceiveVideo===!1&&_n?_n.direction==="sendrecv"?_n.setDirection?_n.setDirection("sendonly"):_n.direction="sendonly":_n.direction==="recvonly"&&(_n.setDirection?_n.setDirection("inactive"):_n.direction="inactive"):_t.offerToReceiveVideo!==!0||_n||this.addTransceiver("video",{direction:"recvonly"})}return _e.apply(this,arguments)}}function T5($){typeof $!="object"||$.AudioContext||($.AudioContext=$.webkitAudioContext)}var w5=Object.freeze({__proto__:null,shimAudioContext:T5,shimCallbacksAPI:E5,shimConstraints:_5,shimCreateOfferLegacy:S5,shimGetUserMedia:v5,shimLocalStreamsAPI:m5,shimRTCIceServerUrls:y5,shimRemoteStreamsAPI:g5,shimTrackEventTransceiver:b5}),R5=`	
\v\f\r \u2028\u2029\uFEFF`,Cre=E0,Ire=MT,dF=R5,C5=_f("".replace),Are=RegExp("^["+dF+"]+"),Ore=RegExp("(^|[^"+dF+"])["+dF+"]+$"),hF=function($){return function(_e){var _t=Ire(Cre(_e));return 1&$&&(_t=C5(_t,Are,"")),2&$&&(_t=C5(_t,Ore,"$1")),_t}},Nre={start:hF(1),end:hF(2),trim:hF(3)},Pre=A4.PROPER,kre=_r,I5=R5,Dre=Nre.trim;y0({target:"String",proto:!0,forced:function($){return kre(function(){return!!I5[$]()||""[$]()!==""||Pre&&I5[$].name!==$})}("trim")},{trim:function(){return Dre(this)}});var Lre=QT("String").trim,xre=_m,Mre=Lre,pF=String.prototype,Ure=function($){var _e=$.trim;return typeof $=="string"||$===pF||xre(pF,$)&&_e===pF.trim?Mre:_e},VS=zt(Ure),A5={exports:{}};(function($){const _e={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};_e.localCName=_e.generateIdentifier(),_e.splitLines=function(_t){return _t.trim().split(`
`).map(Wt=>Wt.trim())},_e.splitSections=function(_t){return _t.split(`
m=`).map((Wt,_n)=>(_n>0?"m="+Wt:Wt).trim()+`\r
`)},_e.getDescription=function(_t){const Wt=_e.splitSections(_t);return Wt&&Wt[0]},_e.getMediaSections=function(_t){const Wt=_e.splitSections(_t);return Wt.shift(),Wt},_e.matchPrefix=function(_t,Wt){return _e.splitLines(_t).filter(_n=>_n.indexOf(Wt)===0)},_e.parseCandidate=function(_t){let Wt;Wt=_t.indexOf("a=candidate:")===0?_t.substring(12).split(" "):_t.substring(10).split(" ");const _n={foundation:Wt[0],component:{1:"rtp",2:"rtcp"}[Wt[1]]||Wt[1],protocol:Wt[2].toLowerCase(),priority:parseInt(Wt[3],10),ip:Wt[4],address:Wt[4],port:parseInt(Wt[5],10),type:Wt[7]};for(let _i=8;_i<Wt.length;_i+=2)switch(Wt[_i]){case"raddr":_n.relatedAddress=Wt[_i+1];break;case"rport":_n.relatedPort=parseInt(Wt[_i+1],10);break;case"tcptype":_n.tcpType=Wt[_i+1];break;case"ufrag":_n.ufrag=Wt[_i+1],_n.usernameFragment=Wt[_i+1];break;default:_n[Wt[_i]]===void 0&&(_n[Wt[_i]]=Wt[_i+1])}return _n},_e.writeCandidate=function(_t){const Wt=[];Wt.push(_t.foundation);const _n=_t.component;_n==="rtp"?Wt.push(1):_n==="rtcp"?Wt.push(2):Wt.push(_n),Wt.push(_t.protocol.toUpperCase()),Wt.push(_t.priority),Wt.push(_t.address||_t.ip),Wt.push(_t.port);const _i=_t.type;return Wt.push("typ"),Wt.push(_i),_i!=="host"&&_t.relatedAddress&&_t.relatedPort&&(Wt.push("raddr"),Wt.push(_t.relatedAddress),Wt.push("rport"),Wt.push(_t.relatedPort)),_t.tcpType&&_t.protocol.toLowerCase()==="tcp"&&(Wt.push("tcptype"),Wt.push(_t.tcpType)),(_t.usernameFragment||_t.ufrag)&&(Wt.push("ufrag"),Wt.push(_t.usernameFragment||_t.ufrag)),"candidate:"+Wt.join(" ")},_e.parseIceOptions=function(_t){return _t.substring(14).split(" ")},_e.parseRtpMap=function(_t){let Wt=_t.substring(9).split(" ");const _n={payloadType:parseInt(Wt.shift(),10)};return Wt=Wt[0].split("/"),_n.name=Wt[0],_n.clockRate=parseInt(Wt[1],10),_n.channels=Wt.length===3?parseInt(Wt[2],10):1,_n.numChannels=_n.channels,_n},_e.writeRtpMap=function(_t){let Wt=_t.payloadType;_t.preferredPayloadType!==void 0&&(Wt=_t.preferredPayloadType);const _n=_t.channels||_t.numChannels||1;return"a=rtpmap:"+Wt+" "+_t.name+"/"+_t.clockRate+(_n!==1?"/"+_n:"")+`\r
`},_e.parseExtmap=function(_t){const Wt=_t.substring(9).split(" ");return{id:parseInt(Wt[0],10),direction:Wt[0].indexOf("/")>0?Wt[0].split("/")[1]:"sendrecv",uri:Wt[1],attributes:Wt.slice(2).join(" ")}},_e.writeExtmap=function(_t){return"a=extmap:"+(_t.id||_t.preferredId)+(_t.direction&&_t.direction!=="sendrecv"?"/"+_t.direction:"")+" "+_t.uri+(_t.attributes?" "+_t.attributes:"")+`\r
`},_e.parseFmtp=function(_t){const Wt={};let _n;const _i=_t.substring(_t.indexOf(" ")+1).split(";");for(let _s=0;_s<_i.length;_s++)_n=_i[_s].trim().split("="),Wt[_n[0].trim()]=_n[1];return Wt},_e.writeFmtp=function(_t){let Wt="",_n=_t.payloadType;if(_t.preferredPayloadType!==void 0&&(_n=_t.preferredPayloadType),_t.parameters&&Object.keys(_t.parameters).length){const _i=[];Object.keys(_t.parameters).forEach(_s=>{_t.parameters[_s]!==void 0?_i.push(_s+"="+_t.parameters[_s]):_i.push(_s)}),Wt+="a=fmtp:"+_n+" "+_i.join(";")+`\r
`}return Wt},_e.parseRtcpFb=function(_t){const Wt=_t.substring(_t.indexOf(" ")+1).split(" ");return{type:Wt.shift(),parameter:Wt.join(" ")}},_e.writeRtcpFb=function(_t){let Wt="",_n=_t.payloadType;return _t.preferredPayloadType!==void 0&&(_n=_t.preferredPayloadType),_t.rtcpFeedback&&_t.rtcpFeedback.length&&_t.rtcpFeedback.forEach(_i=>{Wt+="a=rtcp-fb:"+_n+" "+_i.type+(_i.parameter&&_i.parameter.length?" "+_i.parameter:"")+`\r
`}),Wt},_e.parseSsrcMedia=function(_t){const Wt=_t.indexOf(" "),_n={ssrc:parseInt(_t.substring(7,Wt),10)},_i=_t.indexOf(":",Wt);return _i>-1?(_n.attribute=_t.substring(Wt+1,_i),_n.value=_t.substring(_i+1)):_n.attribute=_t.substring(Wt+1),_n},_e.parseSsrcGroup=function(_t){const Wt=_t.substring(13).split(" ");return{semantics:Wt.shift(),ssrcs:Wt.map(_n=>parseInt(_n,10))}},_e.getMid=function(_t){const Wt=_e.matchPrefix(_t,"a=mid:")[0];if(Wt)return Wt.substring(6)},_e.parseFingerprint=function(_t){const Wt=_t.substring(14).split(" ");return{algorithm:Wt[0].toLowerCase(),value:Wt[1].toUpperCase()}},_e.getDtlsParameters=function(_t,Wt){return{role:"auto",fingerprints:_e.matchPrefix(_t+Wt,"a=fingerprint:").map(_e.parseFingerprint)}},_e.writeDtlsParameters=function(_t,Wt){let _n="a=setup:"+Wt+`\r
`;return _t.fingerprints.forEach(_i=>{_n+="a=fingerprint:"+_i.algorithm+" "+_i.value+`\r
`}),_n},_e.parseCryptoLine=function(_t){const Wt=_t.substring(9).split(" ");return{tag:parseInt(Wt[0],10),cryptoSuite:Wt[1],keyParams:Wt[2],sessionParams:Wt.slice(3)}},_e.writeCryptoLine=function(_t){return"a=crypto:"+_t.tag+" "+_t.cryptoSuite+" "+(typeof _t.keyParams=="object"?_e.writeCryptoKeyParams(_t.keyParams):_t.keyParams)+(_t.sessionParams?" "+_t.sessionParams.join(" "):"")+`\r
`},_e.parseCryptoKeyParams=function(_t){if(_t.indexOf("inline:")!==0)return null;const Wt=_t.substring(7).split("|");return{keyMethod:"inline",keySalt:Wt[0],lifeTime:Wt[1],mkiValue:Wt[2]?Wt[2].split(":")[0]:void 0,mkiLength:Wt[2]?Wt[2].split(":")[1]:void 0}},_e.writeCryptoKeyParams=function(_t){return _t.keyMethod+":"+_t.keySalt+(_t.lifeTime?"|"+_t.lifeTime:"")+(_t.mkiValue&&_t.mkiLength?"|"+_t.mkiValue+":"+_t.mkiLength:"")},_e.getCryptoParameters=function(_t,Wt){return _e.matchPrefix(_t+Wt,"a=crypto:").map(_e.parseCryptoLine)},_e.getIceParameters=function(_t,Wt){const _n=_e.matchPrefix(_t+Wt,"a=ice-ufrag:")[0],_i=_e.matchPrefix(_t+Wt,"a=ice-pwd:")[0];return _n&&_i?{usernameFragment:_n.substring(12),password:_i.substring(10)}:null},_e.writeIceParameters=function(_t){let Wt="a=ice-ufrag:"+_t.usernameFragment+`\r
a=ice-pwd:`+_t.password+`\r
`;return _t.iceLite&&(Wt+=`a=ice-lite\r
`),Wt},_e.parseRtpParameters=function(_t){const Wt={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},_n=_e.splitLines(_t)[0].split(" ");Wt.profile=_n[2];for(let _s=3;_s<_n.length;_s++){const _c=_n[_s],_u=_e.matchPrefix(_t,"a=rtpmap:"+_c+" ")[0];if(_u){const _h=_e.parseRtpMap(_u),_p=_e.matchPrefix(_t,"a=fmtp:"+_c+" ");switch(_h.parameters=_p.length?_e.parseFmtp(_p[0]):{},_h.rtcpFeedback=_e.matchPrefix(_t,"a=rtcp-fb:"+_c+" ").map(_e.parseRtcpFb),Wt.codecs.push(_h),_h.name.toUpperCase()){case"RED":case"ULPFEC":Wt.fecMechanisms.push(_h.name.toUpperCase())}}}_e.matchPrefix(_t,"a=extmap:").forEach(_s=>{Wt.headerExtensions.push(_e.parseExtmap(_s))});const _i=_e.matchPrefix(_t,"a=rtcp-fb:* ").map(_e.parseRtcpFb);return Wt.codecs.forEach(_s=>{_i.forEach(_c=>{_s.rtcpFeedback.find(_u=>_u.type===_c.type&&_u.parameter===_c.parameter)||_s.rtcpFeedback.push(_c)})}),Wt},_e.writeRtpDescription=function(_t,Wt){let _n="";_n+="m="+_t+" ",_n+=Wt.codecs.length>0?"9":"0",_n+=" "+(Wt.profile||"UDP/TLS/RTP/SAVPF")+" ",_n+=Wt.codecs.map(_s=>_s.preferredPayloadType!==void 0?_s.preferredPayloadType:_s.payloadType).join(" ")+`\r
`,_n+=`c=IN IP4 0.0.0.0\r
`,_n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,Wt.codecs.forEach(_s=>{_n+=_e.writeRtpMap(_s),_n+=_e.writeFmtp(_s),_n+=_e.writeRtcpFb(_s)});let _i=0;return Wt.codecs.forEach(_s=>{_s.maxptime>_i&&(_i=_s.maxptime)}),_i>0&&(_n+="a=maxptime:"+_i+`\r
`),Wt.headerExtensions&&Wt.headerExtensions.forEach(_s=>{_n+=_e.writeExtmap(_s)}),_n},_e.parseRtpEncodingParameters=function(_t){const Wt=[],_n=_e.parseRtpParameters(_t),_i=_n.fecMechanisms.indexOf("RED")!==-1,_s=_n.fecMechanisms.indexOf("ULPFEC")!==-1,_c=_e.matchPrefix(_t,"a=ssrc:").map(_g=>_e.parseSsrcMedia(_g)).filter(_g=>_g.attribute==="cname"),_u=_c.length>0&&_c[0].ssrc;let _h;const _p=_e.matchPrefix(_t,"a=ssrc-group:FID").map(_g=>_g.substring(17).split(" ").map(eE=>parseInt(eE,10)));_p.length>0&&_p[0].length>1&&_p[0][0]===_u&&(_h=_p[0][1]),_n.codecs.forEach(_g=>{if(_g.name.toUpperCase()==="RTX"&&_g.parameters.apt){let eE={ssrc:_u,codecPayloadType:parseInt(_g.parameters.apt,10)};_u&&_h&&(eE.rtx={ssrc:_h}),Wt.push(eE),_i&&(eE=JSON.parse(JSON.stringify(eE)),eE.fec={ssrc:_u,mechanism:_s?"red+ulpfec":"red"},Wt.push(eE))}}),Wt.length===0&&_u&&Wt.push({ssrc:_u});let Qm=_e.matchPrefix(_t,"b=");return Qm.length&&(Qm=Qm[0].indexOf("b=TIAS:")===0?parseInt(Qm[0].substring(7),10):Qm[0].indexOf("b=AS:")===0?1e3*parseInt(Qm[0].substring(5),10)*.95-16e3:void 0,Wt.forEach(_g=>{_g.maxBitrate=Qm})),Wt},_e.parseRtcpParameters=function(_t){const Wt={},_n=_e.matchPrefix(_t,"a=ssrc:").map(_c=>_e.parseSsrcMedia(_c)).filter(_c=>_c.attribute==="cname")[0];_n&&(Wt.cname=_n.value,Wt.ssrc=_n.ssrc);const _i=_e.matchPrefix(_t,"a=rtcp-rsize");Wt.reducedSize=_i.length>0,Wt.compound=_i.length===0;const _s=_e.matchPrefix(_t,"a=rtcp-mux");return Wt.mux=_s.length>0,Wt},_e.writeRtcpParameters=function(_t){let Wt="";return _t.reducedSize&&(Wt+=`a=rtcp-rsize\r
`),_t.mux&&(Wt+=`a=rtcp-mux\r
`),_t.ssrc!==void 0&&_t.cname&&(Wt+="a=ssrc:"+_t.ssrc+" cname:"+_t.cname+`\r
`),Wt},_e.parseMsid=function(_t){let Wt;const _n=_e.matchPrefix(_t,"a=msid:");if(_n.length===1)return Wt=_n[0].substring(7).split(" "),{stream:Wt[0],track:Wt[1]};const _i=_e.matchPrefix(_t,"a=ssrc:").map(_s=>_e.parseSsrcMedia(_s)).filter(_s=>_s.attribute==="msid");return _i.length>0?(Wt=_i[0].value.split(" "),{stream:Wt[0],track:Wt[1]}):void 0},_e.parseSctpDescription=function(_t){const Wt=_e.parseMLine(_t),_n=_e.matchPrefix(_t,"a=max-message-size:");let _i;_n.length>0&&(_i=parseInt(_n[0].substring(19),10)),isNaN(_i)&&(_i=65536);const _s=_e.matchPrefix(_t,"a=sctp-port:");if(_s.length>0)return{port:parseInt(_s[0].substring(12),10),protocol:Wt.fmt,maxMessageSize:_i};const _c=_e.matchPrefix(_t,"a=sctpmap:");if(_c.length>0){const _u=_c[0].substring(10).split(" ");return{port:parseInt(_u[0],10),protocol:_u[1],maxMessageSize:_i}}},_e.writeSctpDescription=function(_t,Wt){let _n=[];return _n=_t.protocol!=="DTLS/SCTP"?["m="+_t.kind+" 9 "+_t.protocol+" "+Wt.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+Wt.port+`\r
`]:["m="+_t.kind+" 9 "+_t.protocol+" "+Wt.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+Wt.port+" "+Wt.protocol+` 65535\r
`],Wt.maxMessageSize!==void 0&&_n.push("a=max-message-size:"+Wt.maxMessageSize+`\r
`),_n.join("")},_e.generateSessionId=function(){return Math.random().toString().substr(2,22)},_e.writeSessionBoilerplate=function(_t,Wt,_n){let _i;const _s=Wt!==void 0?Wt:2;return _i=_t||_e.generateSessionId(),`v=0\r
o=`+(_n||"thisisadapterortc")+" "+_i+" "+_s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},_e.getDirection=function(_t,Wt){const _n=_e.splitLines(_t);for(let _i=0;_i<_n.length;_i++)switch(_n[_i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return _n[_i].substring(2)}return Wt?_e.getDirection(Wt):"sendrecv"},_e.getKind=function(_t){return _e.splitLines(_t)[0].split(" ")[0].substring(2)},_e.isRejected=function(_t){return _t.split(" ",2)[1]==="0"},_e.parseMLine=function(_t){const Wt=_e.splitLines(_t)[0].substring(2).split(" ");return{kind:Wt[0],port:parseInt(Wt[1],10),protocol:Wt[2],fmt:Wt.slice(3).join(" ")}},_e.parseOLine=function(_t){const Wt=_e.matchPrefix(_t,"o=")[0].substring(2).split(" ");return{username:Wt[0],sessionId:Wt[1],sessionVersion:parseInt(Wt[2],10),netType:Wt[3],addressType:Wt[4],address:Wt[5]}},_e.isValidSDP=function(_t){if(typeof _t!="string"||_t.length===0)return!1;const Wt=_e.splitLines(_t);for(let _n=0;_n<Wt.length;_n++)if(Wt[_n].length<2||Wt[_n].charAt(1)!=="=")return!1;return!0},$.exports=_e})(A5);var O5=A5.exports,mO=zt(O5),jre=j({__proto__:null,default:mO},[O5]);function BD($){if(!$.RTCIceCandidate||$.RTCIceCandidate&&"foundation"in $.RTCIceCandidate.prototype)return;const _e=$.RTCIceCandidate;$.RTCIceCandidate=function(_t){if(typeof _t=="object"&&_t.candidate&&_t.candidate.indexOf("a=")===0&&((_t=JSON.parse(JSON.stringify(_t))).candidate=_t.candidate.substr(2)),_t.candidate&&_t.candidate.length){const Wt=new _e(_t),_n=mO.parseCandidate(_t.candidate),_i=Object.assign(Wt,_n);return _i.toJSON=function(){return{candidate:_i.candidate,sdpMid:_i.sdpMid,sdpMLineIndex:_i.sdpMLineIndex,usernameFragment:_i.usernameFragment}},_i}return new _e(_t)},$.RTCIceCandidate.prototype=_e.prototype,_I($,"icecandidate",_t=>(_t.candidate&&Object.defineProperty(_t,"candidate",{value:new $.RTCIceCandidate(_t.candidate),writable:"false"}),_t))}function fF($){!$.RTCIceCandidate||$.RTCIceCandidate&&"relayProtocol"in $.RTCIceCandidate.prototype||_I($,"icecandidate",_e=>{if(_e.candidate){const _t=mO.parseCandidate(_e.candidate.candidate);_t.type==="relay"&&(_e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[_t.priority>>24])}return _e})}function GD($,_e){if(!$.RTCPeerConnection)return;"sctp"in $.RTCPeerConnection.prototype||Object.defineProperty($.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const _t=function(_c){if(!_c||!_c.sdp)return!1;const _u=mO.splitSections(_c.sdp);return _u.shift(),_u.some(_h=>{const _p=mO.parseMLine(_h);return _p&&_p.kind==="application"&&_p.protocol.indexOf("SCTP")!==-1})},Wt=function(_c){const _u=_c.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_u===null||_u.length<2)return-1;const _h=parseInt(_u[1],10);return _h!=_h?-1:_h},_n=function(_c){let _u=65536;return _e.browser==="firefox"&&(_u=_e.version<57?_c===-1?16384:2147483637:_e.version<60?_e.version===57?65535:65536:2147483637),_u},_i=function(_c,_u){let _h=65536;_e.browser==="firefox"&&_e.version===57&&(_h=65535);const _p=mO.matchPrefix(_c.sdp,"a=max-message-size:");return _p.length>0?_h=parseInt(_p[0].substr(19),10):_e.browser==="firefox"&&_u!==-1&&(_h=2147483637),_h},_s=$.RTCPeerConnection.prototype.setRemoteDescription;$.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,_e.browser==="chrome"&&_e.version>=76){const{sdpSemantics:_c}=this.getConfiguration();_c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(_t(arguments[0])){const _c=Wt(arguments[0]),_u=_n(_c),_h=_i(arguments[0],_c);let _p;_p=_u===0&&_h===0?Number.POSITIVE_INFINITY:_u===0||_h===0?Math.max(_u,_h):Math.min(_u,_h);const Qm={};Object.defineProperty(Qm,"maxMessageSize",{get:()=>_p}),this._sctp=Qm}return _s.apply(this,arguments)}}function HD($){if(!$.RTCPeerConnection||!("createDataChannel"in $.RTCPeerConnection.prototype))return;function _e(Wt,_n){const _i=Wt.send;Wt.send=function(){const _s=arguments[0],_c=_s.length||_s.size||_s.byteLength;if(Wt.readyState==="open"&&_n.sctp&&_c>_n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+_n.sctp.maxMessageSize+" bytes)");return _i.apply(Wt,arguments)}}const _t=$.RTCPeerConnection.prototype.createDataChannel;$.RTCPeerConnection.prototype.createDataChannel=function(){const Wt=_t.apply(this,arguments);return _e(Wt,this),Wt},_I($,"datachannel",Wt=>(_e(Wt.channel,Wt.target),Wt))}function mF($){if(!$.RTCPeerConnection||"connectionState"in $.RTCPeerConnection.prototype)return;const _e=$.RTCPeerConnection.prototype;Object.defineProperty(_e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(_e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(_t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),_t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=_t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(_t=>{const Wt=_e[_t];_e[_t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=_n=>{const _i=_n.target;if(_i._lastConnectionState!==_i.connectionState){_i._lastConnectionState=_i.connectionState;const _s=new Event("connectionstatechange",_n);_i.dispatchEvent(_s)}return _n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),Wt.apply(this,arguments)}})}function gF($,_e){if(!$.RTCPeerConnection||_e.browser==="chrome"&&_e.version>=71||_e.browser==="safari"&&_e.version>=605)return;const _t=$.RTCPeerConnection.prototype.setRemoteDescription;$.RTCPeerConnection.prototype.setRemoteDescription=function(Wt){if(Wt&&Wt.sdp&&Wt.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const _n=Wt.sdp.split(`
`).filter(_i=>VS(_i).call(_i)!=="a=extmap-allow-mixed").join(`
`);$.RTCSessionDescription&&Wt instanceof $.RTCSessionDescription?arguments[0]=new $.RTCSessionDescription({type:Wt.type,sdp:_n}):Wt.sdp=_n}return _t.apply(this,arguments)}}function WD($,_e){if(!$.RTCPeerConnection||!$.RTCPeerConnection.prototype)return;const _t=$.RTCPeerConnection.prototype.addIceCandidate;_t&&_t.length!==0&&($.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(_e.browser==="chrome"&&_e.version<78||_e.browser==="firefox"&&_e.version<68||_e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?n_.resolve():_t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),n_.resolve())})}function zD($,_e){if(!$.RTCPeerConnection||!$.RTCPeerConnection.prototype)return;const _t=$.RTCPeerConnection.prototype.setLocalDescription;_t&&_t.length!==0&&($.RTCPeerConnection.prototype.setLocalDescription=function(){let Wt=arguments[0]||{};if(typeof Wt!="object"||Wt.type&&Wt.sdp)return _t.apply(this,arguments);if(Wt={type:Wt.type,sdp:Wt.sdp},!Wt.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":Wt.type="offer";break;default:Wt.type="answer"}return Wt.sdp||Wt.type!=="offer"&&Wt.type!=="answer"?_t.apply(this,[Wt]):(Wt.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(_n=>_t.apply(this,[_n]))})}var Fre=Object.freeze({__proto__:null,removeExtmapAllowMixed:gF,shimAddIceCandidateNullOrEmpty:WD,shimConnectionState:mF,shimMaxMessageSize:GD,shimParameterlessSetLocalDescription:zD,shimRTCIceCandidate:BD,shimRTCIceCandidateRelayProtocol:fF,shimSendThrowTypeError:HD});(function(){let{window:$}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const _t=J8,Wt=function(_i){const _s={browser:null,version:null};if(_i===void 0||!_i.navigator)return _s.browser="Not a browser.",_s;const{navigator:_c}=_i;if(_c.mozGetUserMedia)_s.browser="firefox",_s.version=tD(_c.userAgent,/Firefox\/(\d+)\./,1);else if(_c.webkitGetUserMedia||_i.isSecureContext===!1&&_i.webkitRTCPeerConnection)_s.browser="chrome",_s.version=tD(_c.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!_i.RTCPeerConnection||!_c.userAgent.match(/AppleWebKit\/(\d+)\./))return _s.browser="Not a supported browser.",_s;_s.browser="safari",_s.version=tD(_c.userAgent,/AppleWebKit\/(\d+)\./,1),_s.supportsUnifiedPlan=_i.RTCRtpTransceiver&&"currentDirection"in _i.RTCRtpTransceiver.prototype}return _s}($),_n={browserDetails:Wt,commonShim:Fre,extractVersion:tD,disableLog:MZ,disableWarnings:UZ,sdp:jre};switch(Wt.browser){case"chrome":if(!r5||!lF||!_e.shimChrome)return _t("Chrome shim is not included in this adapter release."),_n;if(Wt.version===null)return _t("Chrome shim can not determine version, not shimming."),_n;_t("adapter.js shimming chrome."),_n.browserShim=r5,WD($,Wt),zD($),$2($,Wt),Y2($),lF($,Wt),J2($),t5($,Wt),X2($),Z2($),Q2($),n5($,Wt),BD($),fF($),mF($),GD($,Wt),HD($),gF($,Wt);break;case"firefox":if(!f5||!uF||!_e.shimFirefox)return _t("Firefox shim is not included in this adapter release."),_n;_t("adapter.js shimming firefox."),_n.browserShim=f5,WD($,Wt),zD($),i5($,Wt),uF($,Wt),o5($),c5($),s5($),a5($),l5($),u5($),d5($),h5($),p5($),BD($),mF($),GD($,Wt),HD($);break;case"safari":if(!w5||!_e.shimSafari)return _t("Safari shim is not included in this adapter release."),_n;_t("adapter.js shimming safari."),_n.browserShim=w5,WD($,Wt),zD($),y5($),S5($),E5($),m5($),g5($),b5($),v5($),T5($),BD($),fF($),GD($,Wt),HD($),gF($,Wt);break;default:_t("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Vre=QT("Array").keys,Bre=WR,Gre=_0,Hre=_m,Wre=Vre,EF=Array.prototype,qre={DOMTokenList:!0,NodeList:!0},zre=function($){var _e=$.keys;return $===EF||Hre(EF,$)&&_e===EF.keys||Gre(qre,Bre($))?Wre:_e},ST=zt(zre),N5=s_,Kre=TypeError,$re=JP,Yre=ZT,Jre=I_,KD=function($,_e,_t){var Wt=$re(_e);Wt in $?Yre.f($,Wt,Jre(0,_t)):$[Wt]=_t},P5=nU,Xre=f1,Zre=KD,Qre=Array,eie=Math.max,vF=function($,_e,_t){for(var Wt=Xre($),_n=P5(_e,Wt),_i=P5(_t===void 0?Wt:_t,Wt),_s=Qre(eie(_i-_n,0)),_c=0;_n<_i;_n++,_c++)Zre(_s,_c,$[_n]);return _s.length=_c,_s},k5=vF,tie=Math.floor,_F=function($,_e){var _t=$.length,Wt=tie(_t/2);return _t<8?nie($,_e):rie($,_F(k5($,0,Wt),_e),_F(k5($,Wt),_e),_e)},nie=function($,_e){for(var _t,Wt,_n=$.length,_i=1;_i<_n;){for(Wt=_i,_t=$[_i];Wt&&_e($[Wt-1],_t)>0;)$[Wt]=$[--Wt];Wt!==_i++&&($[Wt]=_t)}return $},rie=function($,_e,_t,Wt){for(var _n=_e.length,_i=_t.length,_s=0,_c=0;_s<_n||_c<_i;)$[_s+_c]=_s<_n&&_c<_i?Wt(_e[_s],_t[_c])<=0?_e[_s++]:_t[_c++]:_s<_n?_e[_s++]:_t[_c++];return $},D5=_F,L5=VR.match(/firefox\/(\d+)/i),iie=!!L5&&+L5[1],oie=/MSIE|Trident/.test(VR),x5=VR.match(/AppleWebKit\/(\d+)\./),sie=!!x5&&+x5[1],aie=y0,M5=_f,cie=O_,lie=e0,U5=f1,uie=function($,_e){if(!delete $[_e])throw Kre("Cannot delete property "+N5(_e)+" of "+N5($))},j5=MT,yF=_r,die=D5,hie=_k,F5=iie,pie=oie,V5=h1,B5=sie,F1=[],G5=M5(F1.sort),fie=M5(F1.push),mie=yF(function(){F1.sort(void 0)}),gie=yF(function(){F1.sort(null)}),Eie=hie("sort"),H5=!yF(function(){if(V5)return V5<70;if(!(F5&&F5>3)){if(pie)return!0;if(B5)return B5<603;var $,_e,_t,Wt,_n="";for($=65;$<76;$++){switch(_e=String.fromCharCode($),$){case 66:case 69:case 70:case 72:_t=3;break;case 68:case 71:_t=4;break;default:_t=2}for(Wt=0;Wt<47;Wt++)F1.push({k:_e+Wt,v:_t})}for(F1.sort(function(_i,_s){return _s.v-_i.v}),Wt=0;Wt<F1.length;Wt++)_e=F1[Wt].k.charAt(0),_n.charAt(_n.length-1)!==_e&&(_n+=_e);return _n!=="DGBEFHACIJK"}});aie({target:"Array",proto:!0,forced:mie||!gie||!Eie||!H5},{sort:function($){$!==void 0&&cie($);var _e=lie(this);if(H5)return $===void 0?G5(_e):G5(_e,$);var _t,Wt,_n=[],_i=U5(_e);for(Wt=0;Wt<_i;Wt++)Wt in _e&&fie(_n,_e[Wt]);for(die(_n,function(_s){return function(_c,_u){return _u===void 0?-1:_c===void 0?1:_s!==void 0?+_s(_c,_u)||0:j5(_c)>j5(_u)?1:-1}}($)),_t=U5(_n),Wt=0;Wt<_t;)_e[Wt]=_n[Wt++];for(;Wt<_i;)uie(_e,Wt++);return _e}});var vie=QT("Array").sort,_ie=_m,yie=vie,bF=Array.prototype,bie=function($){var _e=$.sort;return $===bF||_ie(bF,$)&&_e===bF.sort?yie:_e},MN=zt(bie),SF={exports:{}};(function($,_e){(function(_t,Wt){var _n="function",_i="undefined",_s="object",_c="string",_u="major",_h="model",_p="name",Qm="type",_g="vendor",eE="version",pE="architecture",aE="console",cE="mobile",fE="tablet",gE="smarttv",AE="wearable",PE="embedded",xE="Amazon",GE="Apple",zE="ASUS",KE="BlackBerry",JE="Browser",c_="Chrome",V_="Firefox",Q_="Google",T0="Huawei",Z0="LG",M0="Microsoft",_R="Motorola",$E="Opera",QE="Samsung",d_="Sharp",w_="Sony",X_="Xiaomi",r_="Zebra",uE="Facebook",SE="Chromium OS",CE="Mac OS",ZE=function(z0){for(var tS={},I0=0;I0<z0.length;I0++)tS[z0[I0].toUpperCase()]=z0[I0];return tS},R_=function(z0,tS){return typeof z0===_c&&l0(tS).indexOf(l0(z0))!==-1},l0=function(z0){return z0.toLowerCase()},cS=function(z0,tS){if(typeof z0===_c)return z0=z0.replace(/^\s\s*/,""),typeof tS===_i?z0:z0.substring(0,350)},hT=function(z0,tS){for(var I0,_T,d1,K0,Z_,pT,gI=0;gI<tS.length&&!Z_;){var FR=tS[gI],BJ=tS[gI+1];for(I0=_T=0;I0<FR.length&&!Z_&&FR[I0];)if(Z_=FR[I0++].exec(z0))for(d1=0;d1<BJ.length;d1++)pT=Z_[++_T],typeof(K0=BJ[d1])===_s&&K0.length>0?K0.length===2?typeof K0[1]==_n?this[K0[0]]=K0[1].call(this,pT):this[K0[0]]=K0[1]:K0.length===3?typeof K0[1]!==_n||K0[1].exec&&K0[1].test?this[K0[0]]=pT?pT.replace(K0[1],K0[2]):Wt:this[K0[0]]=pT?K0[1].call(this,pT,K0[2]):Wt:K0.length===4&&(this[K0[0]]=pT?K0[3].call(this,pT.replace(K0[1],K0[2])):Wt):this[K0]=pT||Wt;gI+=2}},N1=function(z0,tS){for(var I0 in tS)if(typeof tS[I0]===_s&&tS[I0].length>0){for(var _T=0;_T<tS[I0].length;_T++)if(R_(tS[I0][_T],z0))return I0==="?"?Wt:I0}else if(R_(tS[I0],z0))return I0==="?"?Wt:I0;return z0},FM={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},VM={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[eE,[_p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[eE,[_p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[_p,eE],[/opios[\/ ]+([\w\.]+)/i],[eE,[_p,$E+" Mini"]],[/\bopr\/([\w\.]+)/i],[eE,[_p,$E]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[_p,eE],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[eE,[_p,"UC"+JE]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[eE,[_p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[eE,[_p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[eE,[_p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[eE,[_p,"IE"]],[/yabrowser\/([\w\.]+)/i],[eE,[_p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[_p,/(.+)/,"$1 Secure "+JE],eE],[/\bfocus\/([\w\.]+)/i],[eE,[_p,V_+" Focus"]],[/\bopt\/([\w\.]+)/i],[eE,[_p,$E+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[eE,[_p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[eE,[_p,"Dolphin"]],[/coast\/([\w\.]+)/i],[eE,[_p,$E+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[eE,[_p,"MIUI "+JE]],[/fxios\/([-\w\.]+)/i],[eE,[_p,V_]],[/\bqihu|(qi?ho?o?|360)browser/i],[[_p,"360 "+JE]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[_p,/(.+)/,"$1 "+JE],eE],[/(comodo_dragon)\/([\w\.]+)/i],[[_p,/_/g," "],eE],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[_p,eE],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[_p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[_p,uE],eE],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[_p,eE],[/\bgsa\/([\w\.]+) .*safari\//i],[eE,[_p,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[eE,[_p,c_+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[_p,c_+" WebView"],eE],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[eE,[_p,"Android "+JE]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[_p,eE],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[eE,[_p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[eE,_p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[_p,[eE,N1,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[_p,eE],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[_p,"Netscape"],eE],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[eE,[_p,V_+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[_p,eE],[/(cobalt)\/([\w\.]+)/i],[_p,[eE,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[pE,"amd64"]],[/(ia32(?=;))/i],[[pE,l0]],[/((?:i[346]|x)86)[;\)]/i],[[pE,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[pE,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[pE,"armhf"]],[/windows (ce|mobile); ppc;/i],[[pE,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[pE,/ower/,"",l0]],[/(sun4\w)[;\)]/i],[[pE,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[pE,l0]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_h,[_g,QE],[Qm,fE]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[_h,[_g,QE],[Qm,cE]],[/\((ip(?:hone|od)[\w ]*);/i],[_h,[_g,GE],[Qm,cE]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_h,[_g,GE],[Qm,fE]],[/(macintosh);/i],[_h,[_g,GE]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_h,[_g,d_],[Qm,cE]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_h,[_g,T0],[Qm,fE]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_h,[_g,T0],[Qm,cE]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[_h,/_/g," "],[_g,X_],[Qm,cE]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_h,/_/g," "],[_g,X_],[Qm,fE]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_h,[_g,"OPPO"],[Qm,cE]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_h,[_g,"Vivo"],[Qm,cE]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[_h,[_g,"Realme"],[Qm,cE]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_h,[_g,_R],[Qm,cE]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_h,[_g,_R],[Qm,fE]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_h,[_g,Z0],[Qm,fE]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_h,[_g,Z0],[Qm,cE]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_h,[_g,"Lenovo"],[Qm,fE]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_h,/_/g," "],[_g,"Nokia"],[Qm,cE]],[/(pixel c)\b/i],[_h,[_g,Q_],[Qm,fE]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_h,[_g,Q_],[Qm,cE]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_h,[_g,w_],[Qm,cE]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_h,"Xperia Tablet"],[_g,w_],[Qm,fE]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_h,[_g,"OnePlus"],[Qm,cE]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_h,[_g,xE],[Qm,fE]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_h,/(.+)/g,"Fire Phone $1"],[_g,xE],[Qm,cE]],[/(playbook);[-\w\),; ]+(rim)/i],[_h,_g,[Qm,fE]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_h,[_g,KE],[Qm,cE]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_h,[_g,zE],[Qm,fE]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_h,[_g,zE],[Qm,cE]],[/(nexus 9)/i],[_h,[_g,"HTC"],[Qm,fE]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[_g,[_h,/_/g," "],[Qm,cE]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_h,[_g,"Acer"],[Qm,fE]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_h,[_g,"Meizu"],[Qm,cE]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[_g,_h,[Qm,cE]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[_g,_h,[Qm,fE]],[/(surface duo)/i],[_h,[_g,M0],[Qm,fE]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_h,[_g,"Fairphone"],[Qm,cE]],[/(u304aa)/i],[_h,[_g,"AT&T"],[Qm,cE]],[/\bsie-(\w*)/i],[_h,[_g,"Siemens"],[Qm,cE]],[/\b(rct\w+) b/i],[_h,[_g,"RCA"],[Qm,fE]],[/\b(venue[\d ]{2,7}) b/i],[_h,[_g,"Dell"],[Qm,fE]],[/\b(q(?:mv|ta)\w+) b/i],[_h,[_g,"Verizon"],[Qm,fE]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_h,[_g,"Barnes & Noble"],[Qm,fE]],[/\b(tm\d{3}\w+) b/i],[_h,[_g,"NuVision"],[Qm,fE]],[/\b(k88) b/i],[_h,[_g,"ZTE"],[Qm,fE]],[/\b(nx\d{3}j) b/i],[_h,[_g,"ZTE"],[Qm,cE]],[/\b(gen\d{3}) b.+49h/i],[_h,[_g,"Swiss"],[Qm,cE]],[/\b(zur\d{3}) b/i],[_h,[_g,"Swiss"],[Qm,fE]],[/\b((zeki)?tb.*\b) b/i],[_h,[_g,"Zeki"],[Qm,fE]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[_g,"Dragon Touch"],_h,[Qm,fE]],[/\b(ns-?\w{0,9}) b/i],[_h,[_g,"Insignia"],[Qm,fE]],[/\b((nxa|next)-?\w{0,9}) b/i],[_h,[_g,"NextBook"],[Qm,fE]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[_g,"Voice"],_h,[Qm,cE]],[/\b(lvtel\-)?(v1[12]) b/i],[[_g,"LvTel"],_h,[Qm,cE]],[/\b(ph-1) /i],[_h,[_g,"Essential"],[Qm,cE]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_h,[_g,"Envizen"],[Qm,fE]],[/\b(trio[-\w\. ]+) b/i],[_h,[_g,"MachSpeed"],[Qm,fE]],[/\btu_(1491) b/i],[_h,[_g,"Rotor"],[Qm,fE]],[/(shield[\w ]+) b/i],[_h,[_g,"Nvidia"],[Qm,fE]],[/(sprint) (\w+)/i],[_g,_h,[Qm,cE]],[/(kin\.[onetw]{3})/i],[[_h,/\./g," "],[_g,M0],[Qm,cE]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_h,[_g,r_],[Qm,fE]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_h,[_g,r_],[Qm,cE]],[/smart-tv.+(samsung)/i],[_g,[Qm,gE]],[/hbbtv.+maple;(\d+)/i],[[_h,/^/,"SmartTV"],[_g,QE],[Qm,gE]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[_g,Z0],[Qm,gE]],[/(apple) ?tv/i],[_g,[_h,GE+" TV"],[Qm,gE]],[/crkey/i],[[_h,c_+"cast"],[_g,Q_],[Qm,gE]],[/droid.+aft(\w)( bui|\))/i],[_h,[_g,xE],[Qm,gE]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_h,[_g,d_],[Qm,gE]],[/(bravia[\w ]+)( bui|\))/i],[_h,[_g,w_],[Qm,gE]],[/(mitv-\w{5}) bui/i],[_h,[_g,X_],[Qm,gE]],[/Hbbtv.*(technisat) (.*);/i],[_g,_h,[Qm,gE]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[_g,cS],[_h,cS],[Qm,gE]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[Qm,gE]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[_g,_h,[Qm,aE]],[/droid.+; (shield) bui/i],[_h,[_g,"Nvidia"],[Qm,aE]],[/(playstation [345portablevi]+)/i],[_h,[_g,w_],[Qm,aE]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_h,[_g,M0],[Qm,aE]],[/((pebble))app/i],[_g,_h,[Qm,AE]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_h,[_g,GE],[Qm,AE]],[/droid.+; (glass) \d/i],[_h,[_g,Q_],[Qm,AE]],[/droid.+; (wt63?0{2,3})\)/i],[_h,[_g,r_],[Qm,AE]],[/(quest( 2| pro)?)/i],[_h,[_g,uE],[Qm,AE]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[_g,[Qm,PE]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[_h,[Qm,cE]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_h,[Qm,fE]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[Qm,fE]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[Qm,cE]],[/(android[-\w\. ]{0,9});.+buil/i],[_h,[_g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[eE,[_p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[eE,[_p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[_p,eE],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[eE,_p]],os:[[/microsoft (windows) (vista|xp)/i],[_p,eE],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[_p,[eE,N1,FM]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[_p,"Windows"],[eE,N1,FM]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[eE,/_/g,"."],[_p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[_p,CE],[eE,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[eE,_p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[_p,eE],[/\(bb(10);/i],[eE,[_p,KE]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[eE,[_p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[eE,[_p,V_+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[eE,[_p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[eE,[_p,"watchOS"]],[/crkey\/([\d\.]+)/i],[eE,[_p,c_+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[_p,SE],eE],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[_p,eE],[/(sunos) ?([\w\.\d]*)/i],[[_p,"Solaris"],eE],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[_p,eE]]},$T=function(z0,tS){if(typeof z0===_s&&(tS=z0,z0=Wt),!(this instanceof $T))return new $T(z0,tS).getResult();var I0=typeof _t!==_i&&_t.navigator?_t.navigator:Wt,_T=z0||(I0&&I0.userAgent?I0.userAgent:""),d1=I0&&I0.userAgentData?I0.userAgentData:Wt,K0=tS?function(Z_,pT){var gI={};for(var FR in Z_)pT[FR]&&pT[FR].length%2==0?gI[FR]=pT[FR].concat(Z_[FR]):gI[FR]=Z_[FR];return gI}(VM,tS):VM;return this.getBrowser=function(){var Z_={};return Z_[_p]=Wt,Z_[eE]=Wt,hT.call(Z_,_T,K0.browser),Z_[_u]=function(pT){return typeof pT===_c?pT.replace(/[^\d\.]/g,"").split(".")[0]:Wt}(Z_[eE]),I0&&I0.brave&&typeof I0.brave.isBrave==_n&&(Z_[_p]="Brave"),Z_},this.getCPU=function(){var Z_={};return Z_[pE]=Wt,hT.call(Z_,_T,K0.cpu),Z_},this.getDevice=function(){var Z_={};return Z_[_g]=Wt,Z_[_h]=Wt,Z_[Qm]=Wt,hT.call(Z_,_T,K0.device),!Z_[Qm]&&d1&&d1.mobile&&(Z_[Qm]=cE),Z_[_h]=="Macintosh"&&I0&&typeof I0.standalone!==_i&&I0.maxTouchPoints&&I0.maxTouchPoints>2&&(Z_[_h]="iPad",Z_[Qm]=fE),Z_},this.getEngine=function(){var Z_={};return Z_[_p]=Wt,Z_[eE]=Wt,hT.call(Z_,_T,K0.engine),Z_},this.getOS=function(){var Z_={};return Z_[_p]=Wt,Z_[eE]=Wt,hT.call(Z_,_T,K0.os),!Z_[_p]&&d1&&d1.platform!="Unknown"&&(Z_[_p]=d1.platform.replace(/chrome os/i,SE).replace(/macos/i,CE)),Z_},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return _T},this.setUA=function(Z_){return _T=typeof Z_===_c&&Z_.length>350?cS(Z_,350):Z_,this},this.setUA(_T),this};$T.VERSION="0.7.34",$T.BROWSER=ZE([_p,eE,_u]),$T.CPU=ZE([pE]),$T.DEVICE=ZE([_h,_g,Qm,aE,cE,gE,fE,AE,PE]),$T.ENGINE=$T.OS=ZE([_p,eE]),$.exports&&(_e=$.exports=$T),_e.UAParser=$T;var mI=typeof _t!==_i&&(_t.jQuery||_t.Zepto);if(mI&&!mI.ua){var fN=new $T;mI.ua=fN.getResult(),mI.ua.get=function(){return fN.getUA()},mI.ua.set=function(z0){fN.setUA(z0);var tS=fN.getResult();for(var I0 in tS)mI.ua[I0]=tS[I0]}}})(typeof window=="object"?window:Vt)})(SF,SF.exports);var Sie=zt(SF.exports),Tie=WR,wie=_0,Rie=lS,Cie=yI,Iie=$0("iterator"),Aie=Object,Oie=function($){if(Rie($))return!1;var _e=Aie($);return _e[Iie]!==void 0||"@@iterator"in _e||wie(Cie,Tie(_e))},Nie=zt(Oie),TF=rE;y0({global:!0,forced:TF.globalThis!==TF},{globalThis:TF});var W5=zt(rE);function q5($,_e){return function(){return $.apply(_e,arguments)}}const{toString:Pie}=Object.prototype,{getPrototypeOf:wF}=Object,$D=(RF=Object.create(null),$=>{const _e=Pie.call($);return RF[_e]||(RF[_e]=_e.slice(8,-1).toLowerCase())});var RF;const KR=$=>($=$.toLowerCase(),_e=>$D(_e)===$),YD=$=>_e=>typeof _e===$,{isArray:gO}=Array,UN=YD("undefined"),z5=KR("ArrayBuffer"),kie=YD("string"),_w=YD("function"),K5=YD("number"),JD=$=>$!==null&&typeof $=="object",XD=$=>{if($D($)!=="object")return!1;const _e=wF($);return!(_e!==null&&_e!==Object.prototype&&Object.getPrototypeOf(_e)!==null||Symbol.toStringTag in $||Nie($))},Die=KR("Date"),Lie=KR("File"),xie=KR("Blob"),Mie=KR("FileList"),Uie=KR("URLSearchParams");function jN($,_e){let _t,Wt,{allOwnKeys:_n=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if($!=null)if(typeof $!="object"&&($=[$]),gO($))for(_t=0,Wt=$.length;_t<Wt;_t++)_e.call(null,$[_t],_t,$);else{const _i=_n?Object.getOwnPropertyNames($):Object.keys($),_s=_i.length;let _c;for(_t=0;_t<_s;_t++)_c=_i[_t],_e.call(null,$[_c],_c,$)}}function $5($,_e){_e=_e.toLowerCase();const _t=Object.keys($);let Wt,_n=_t.length;for(;_n-- >0;)if(Wt=_t[_n],_e===Wt.toLowerCase())return Wt;return null}const Y5=W5!==void 0?W5:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,J5=$=>!UN($)&&$!==Y5,jie=(CF=typeof Uint8Array<"u"&&wF(Uint8Array),$=>CF&&$ instanceof CF);var CF;const Fie=KR("HTMLFormElement"),X5=($=>{let{hasOwnProperty:_e}=$;return(_t,Wt)=>_e.call(_t,Wt)})(Object.prototype),Vie=KR("RegExp"),Z5=($,_e)=>{const _t=Object.getOwnPropertyDescriptors($),Wt={};jN(_t,(_n,_i)=>{let _s;(_s=_e(_n,_i,$))!==!1&&(Wt[_i]=_s||_n)}),Object.defineProperties($,Wt)},IF="abcdefghijklmnopqrstuvwxyz",Q5="0123456789",e3={DIGIT:Q5,ALPHA:IF,ALPHA_DIGIT:IF+IF.toUpperCase()+Q5},Bie=KR("AsyncFunction");var u_={isArray:gO,isArrayBuffer:z5,isBuffer:function($){return $!==null&&!UN($)&&$.constructor!==null&&!UN($.constructor)&&_w($.constructor.isBuffer)&&$.constructor.isBuffer($)},isFormData:$=>{let _e;return $&&(typeof FormData=="function"&&$ instanceof FormData||_w($.append)&&((_e=$D($))==="formdata"||_e==="object"&&_w($.toString)&&$.toString()==="[object FormData]"))},isArrayBufferView:function($){let _e;return _e=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView($):$&&$.buffer&&z5($.buffer),_e},isString:kie,isNumber:K5,isBoolean:$=>$===!0||$===!1,isObject:JD,isPlainObject:XD,isUndefined:UN,isDate:Die,isFile:Lie,isBlob:xie,isRegExp:Vie,isFunction:_w,isStream:$=>JD($)&&_w($.pipe),isURLSearchParams:Uie,isTypedArray:jie,isFileList:Mie,forEach:jN,merge:function $(){const{caseless:_e}=J5(this)&&this||{},_t={},Wt=(_n,_i)=>{const _s=_e&&$5(_t,_i)||_i;XD(_t[_s])&&XD(_n)?_t[_s]=$(_t[_s],_n):XD(_n)?_t[_s]=$({},_n):gO(_n)?_t[_s]=_n.slice():_t[_s]=_n};for(let _n=0,_i=arguments.length;_n<_i;_n++)arguments[_n]&&jN(arguments[_n],Wt);return _t},extend:function($,_e,_t){let{allOwnKeys:Wt}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return jN(_e,(_n,_i)=>{_t&&_w(_n)?$[_i]=q5(_n,_t):$[_i]=_n},{allOwnKeys:Wt}),$},trim:$=>VS($)?VS($).call($):$.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:$=>($.charCodeAt(0)===65279&&($=$.slice(1)),$),inherits:($,_e,_t,Wt)=>{$.prototype=Object.create(_e.prototype,Wt),$.prototype.constructor=$,Object.defineProperty($,"super",{value:_e.prototype}),_t&&Object.assign($.prototype,_t)},toFlatObject:($,_e,_t,Wt)=>{let _n,_i,_s;const _c={};if(_e=_e||{},$==null)return _e;do{for(_n=Object.getOwnPropertyNames($),_i=_n.length;_i-- >0;)_s=_n[_i],Wt&&!Wt(_s,$,_e)||_c[_s]||(_e[_s]=$[_s],_c[_s]=!0);$=_t!==!1&&wF($)}while($&&(!_t||_t($,_e))&&$!==Object.prototype);return _e},kindOf:$D,kindOfTest:KR,endsWith:($,_e,_t)=>{$=String($),(_t===void 0||_t>$.length)&&(_t=$.length),_t-=_e.length;const Wt=$.indexOf(_e,_t);return Wt!==-1&&Wt===_t},toArray:$=>{if(!$)return null;if(gO($))return $;let _e=$.length;if(!K5(_e))return null;const _t=new Array(_e);for(;_e-- >0;)_t[_e]=$[_e];return _t},forEachEntry:($,_e)=>{const _t=($&&$[Symbol.iterator]).call($);let Wt;for(;(Wt=_t.next())&&!Wt.done;){const _n=Wt.value;_e.call($,_n[0],_n[1])}},matchAll:($,_e)=>{let _t;const Wt=[];for(;(_t=$.exec(_e))!==null;)Wt.push(_t);return Wt},isHTMLForm:Fie,hasOwnProperty:X5,hasOwnProp:X5,reduceDescriptors:Z5,freezeMethods:$=>{Z5($,(_e,_t)=>{if(_w($)&&["arguments","caller","callee"].indexOf(_t)!==-1)return!1;const Wt=$[_t];_w(Wt)&&(_e.enumerable=!1,"writable"in _e?_e.writable=!1:_e.set||(_e.set=()=>{throw Error("Can not rewrite read-only method '"+_t+"'")}))})},toObjectSet:($,_e)=>{const _t={},Wt=_n=>{_n.forEach(_i=>{_t[_i]=!0})};return gO($)?Wt($):Wt(String($).split(_e)),_t},toCamelCase:$=>$.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(_e,_t,Wt){return _t.toUpperCase()+Wt}),noop:()=>{},toFiniteNumber:($,_e)=>($=+$,Number.isFinite($)?$:_e),findKey:$5,global:Y5,isContextDefined:J5,ALPHABET:e3,generateString:function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e3.ALPHA_DIGIT,_t="";const{length:Wt}=_e;for(;$--;)_t+=_e[Math.random()*Wt|0];return _t},isSpecCompliantForm:function($){return!!($&&_w($.append)&&$[Symbol.toStringTag]==="FormData"&&$[Symbol.iterator])},toJSONObject:$=>{const _e=new Array(10),_t=(Wt,_n)=>{if(JD(Wt)){if(_e.indexOf(Wt)>=0)return;if(!("toJSON"in Wt)){_e[_n]=Wt;const _i=gO(Wt)?[]:{};return jN(Wt,(_s,_c)=>{const _u=_t(_s,_n+1);!UN(_u)&&(_i[_c]=_u)}),_e[_n]=void 0,_i}}return Wt};return _t($,0)},isAsyncFn:Bie,isThenable:$=>$&&(JD($)||_w($))&&_w($.then)&&_w($.catch)};function D0($,_e,_t,Wt,_n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=$,this.name="AxiosError",_e&&(this.code=_e),_t&&(this.config=_t),Wt&&(this.request=Wt),_n&&(this.response=_n)}u_.inherits(D0,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:u_.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const t3=D0.prototype,n3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach($=>{n3[$]={value:$}}),Object.defineProperties(D0,n3),Object.defineProperty(t3,"isAxiosError",{value:!0}),D0.from=($,_e,_t,Wt,_n,_i)=>{const _s=Object.create(t3);return u_.toFlatObject($,_s,function(_c){return _c!==Error.prototype},_c=>_c!=="isAxiosError"),D0.call(_s,$.message,_e,_t,Wt,_n),_s.cause=$,_s.name=$.name,_i&&Object.assign(_s,_i),_s};function AF($){return u_.isPlainObject($)||u_.isArray($)}function r3($){return u_.endsWith($,"[]")?$.slice(0,-2):$}function i3($,_e,_t){return $?$.concat(_e).map(function(Wt,_n){return Wt=r3(Wt),!_t&&_n?"["+Wt+"]":Wt}).join(_t?".":""):_e}const Gie=u_.toFlatObject(u_,{},null,function($){return/^is[A-Z]/.test($)});function ZD($,_e,_t){if(!u_.isObject($))throw new TypeError("target must be an object");_e=_e||new FormData;const Wt=(_t=u_.toFlatObject(_t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_g,eE){return!u_.isUndefined(eE[_g])})).metaTokens,_n=_t.visitor||_h,_i=_t.dots,_s=_t.indexes,_c=(_t.Blob||typeof Blob<"u"&&Blob)&&u_.isSpecCompliantForm(_e);if(!u_.isFunction(_n))throw new TypeError("visitor must be a function");function _u(_g){if(_g===null)return"";if(u_.isDate(_g))return _g.toISOString();if(!_c&&u_.isBlob(_g))throw new D0("Blob is not supported. Use a Buffer instead.");return u_.isArrayBuffer(_g)||u_.isTypedArray(_g)?_c&&typeof Blob=="function"?new Blob([_g]):Buffer.from(_g):_g}function _h(_g,eE,pE){let aE=_g;if(_g&&!pE&&typeof _g=="object"){if(u_.endsWith(eE,"{}"))eE=Wt?eE:eE.slice(0,-2),_g=JSON.stringify(_g);else if(u_.isArray(_g)&&function(cE){return u_.isArray(cE)&&!cE.some(AF)}(_g)||(u_.isFileList(_g)||u_.endsWith(eE,"[]"))&&(aE=u_.toArray(_g)))return eE=r3(eE),aE.forEach(function(cE,fE){!u_.isUndefined(cE)&&cE!==null&&_e.append(_s===!0?i3([eE],fE,_i):_s===null?eE:eE+"[]",_u(cE))}),!1}return!!AF(_g)||(_e.append(i3(pE,eE,_i),_u(_g)),!1)}const _p=[],Qm=Object.assign(Gie,{defaultVisitor:_h,convertValue:_u,isVisitable:AF});if(!u_.isObject($))throw new TypeError("data must be an object");return function _g(eE,pE){if(!u_.isUndefined(eE)){if(_p.indexOf(eE)!==-1)throw Error("Circular reference detected in "+pE.join("."));_p.push(eE),u_.forEach(eE,function(aE,cE){(!(u_.isUndefined(aE)||aE===null)&&_n.call(_e,aE,u_.isString(cE)?VS(cE).call(cE):cE,pE,Qm))===!0&&_g(aE,pE?pE.concat(cE):[cE])}),_p.pop()}}($),_e}function o3($){const _e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent($).replace(/[!'()~]|%20|%00/g,function(_t){return _e[_t]})}function OF($,_e){this._pairs=[],$&&ZD($,this,_e)}const s3=OF.prototype;function Hie($){return encodeURIComponent($).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function a3($,_e,_t){if(!_e)return $;const Wt=_t&&_t.encode||Hie,_n=_t&&_t.serialize;let _i;if(_i=_n?_n(_e,_t):u_.isURLSearchParams(_e)?_e.toString():new OF(_e,_t).toString(Wt),_i){const _s=$.indexOf("#");_s!==-1&&($=$.slice(0,_s)),$+=($.indexOf("?")===-1?"?":"&")+_i}return $}s3.append=function($,_e){this._pairs.push([$,_e])},s3.toString=function($){const _e=$?function(_t){return $.call(this,_t,o3)}:o3;return this._pairs.map(function(_t){return _e(_t[0])+"="+_e(_t[1])},"").join("&")};var c3=class{constructor(){this.handlers=[]}use($,_e,_t){return this.handlers.push({fulfilled:$,rejected:_e,synchronous:!!_t&&_t.synchronous,runWhen:_t?_t.runWhen:null}),this.handlers.length-1}eject($){this.handlers[$]&&(this.handlers[$]=null)}clear(){this.handlers&&(this.handlers=[])}forEach($){u_.forEach(this.handlers,function(_e){_e!==null&&$(_e)})}},l3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u3={exports:{}},Wie=y0,qie=jE,d3=ZT.f;Wie({target:"Object",stat:!0,forced:Object.defineProperty!==d3,sham:!qie},{defineProperty:d3});var h3=yS.Object,zie=u3.exports=function($,_e,_t){return h3.defineProperty($,_e,_t)};h3.defineProperty.sham&&(zie.sham=!0);var p3=zt(u3.exports),Kie=_E,FN=Array.isArray||function($){return Kie($)=="Array"},$ie=TypeError,f3=FN,Yie=PD,Jie=TS,Xie=$0("species"),m3=Array,Zie=function($){var _e;return f3($)&&(_e=$.constructor,(Yie(_e)&&(_e===m3||f3(_e.prototype))||Jie(_e)&&(_e=_e[Xie])===null)&&(_e=void 0)),_e===void 0?m3:_e},g3=function($,_e){return new(Zie($))(_e===0?0:_e)},Qie=_r,eoe=h1,toe=$0("species"),E3=function($){return eoe>=51||!Qie(function(){var _e=[];return(_e.constructor={})[toe]=function(){return{foo:1}},_e[$](Boolean).foo!==1})},noe=y0,roe=_r,ioe=FN,ooe=TS,soe=e0,aoe=f1,v3=function($){if($>9007199254740991)throw $ie("Maximum allowed index exceeded");return $},_3=KD,coe=g3,loe=E3,uoe=h1,y3=$0("isConcatSpreadable"),doe=uoe>=51||!roe(function(){var $=[];return $[y3]=!1,$.concat()[0]!==$}),hoe=function($){if(!ooe($))return!1;var _e=$[y3];return _e!==void 0?!!_e:ioe($)};noe({target:"Array",proto:!0,arity:1,forced:!doe||!loe("concat")},{concat:function($){var _e,_t,Wt,_n,_i,_s=soe(this),_c=coe(_s,0),_u=0;for(_e=-1,Wt=arguments.length;_e<Wt;_e++)if(hoe(_i=_e===-1?_s:arguments[_e]))for(_n=aoe(_i),v3(_u+_n),_t=0;_t<_n;_t++,_u++)_t in _i&&_3(_c,_u,_i[_t]);else v3(_u+1),_3(_c,_u++,_i);return _c.length=_u,_c}});var b3={},poe=_E,foe=k0,S3=uD.f,moe=vF,T3=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];b3.f=function($){return T3&&poe($)=="Window"?function(_e){try{return S3(_e)}catch{return moe(T3)}}($):S3(foe($))};var EO={},goe=$0;EO.f=goe;var w3=yS,Eoe=_0,voe=EO,_oe=ZT.f,wS=function($){var _e=w3.Symbol||(w3.Symbol={});Eoe(_e,$)||_oe(_e,$,{value:voe.f($)})},yoe=FE,boe=OS,Soe=$0,Toe=M1,R3=function(){var $=boe("Symbol"),_e=$&&$.prototype,_t=_e&&_e.valueOf,Wt=Soe("toPrimitive");_e&&!_e[Wt]&&Toe(_e,Wt,function(_n){return yoe(_t,this)},{arity:1})},woe=L1,Roe=LS,Coe=e0,Ioe=f1,Aoe=g3,C3=_f([].push),V1=function($){var _e=$==1,_t=$==2,Wt=$==3,_n=$==4,_i=$==6,_s=$==7,_c=$==5||_i;return function(_u,_h,_p,Qm){for(var _g,eE,pE=Coe(_u),aE=Roe(pE),cE=woe(_h,_p),fE=Ioe(aE),gE=0,AE=Qm||Aoe,PE=_e?AE(_u,fE):_t||_s?AE(_u,0):void 0;fE>gE;gE++)if((_c||gE in aE)&&(eE=cE(_g=aE[gE],gE,pE),$))if(_e)PE[gE]=eE;else if(eE)switch($){case 3:return!0;case 5:return _g;case 6:return gE;case 2:C3(PE,_g)}else switch($){case 4:return!1;case 7:C3(PE,_g)}return _i?-1:Wt||_n?_n:PE}},I3={forEach:V1(0),map:V1(1),filter:V1(2),some:V1(3),every:V1(4),find:V1(5),findIndex:V1(6),filterReject:V1(7)},QD=y0,NF=rE,PF=FE,Ooe=_f,vO=jE,_O=BR,Noe=_r,zS=_0,Poe=_m,kF=sT,eL=k0,DF=JP,koe=MT,LF=I_,VN=CN,A3=vD,Doe=uD,O3=b3,Loe=RN,N3=NE,P3=ZT,xoe=fU,k3=VE,D3=M1,Moe=ND,xF=TR,L3=ED,x3=KM,Uoe=$0,joe=EO,Foe=wS,Voe=R3,Boe=U1,M3=SI,tL=I3.forEach,TT=sD("hidden"),nL="Symbol",BN="prototype",Goe=M3.set,U3=M3.getterFor(nL),RR=Object[BN],RI=NF.Symbol,rL=RI&&RI[BN],Hoe=NF.TypeError,MF=NF.QObject,j3=N3.f,CI=P3.f,F3=O3.f,Woe=k3.f,V3=Ooe([].push),m1=xF("symbols"),GN=xF("op-symbols"),qoe=xF("wks"),UF=!MF||!MF[BN]||!MF[BN].findChild,jF=vO&&Noe(function(){return VN(CI({},"a",{get:function(){return CI(this,"a",{value:7}).a}})).a!=7})?function($,_e,_t){var Wt=j3(RR,_e);Wt&&delete RR[_e],CI($,_e,_t),Wt&&$!==RR&&CI(RR,_e,Wt)}:CI,FF=function($,_e){var _t=m1[$]=VN(rL);return Goe(_t,{type:nL,tag:$,description:_e}),vO||(_t.description=_e),_t},iL=function($,_e,_t){$===RR&&iL(GN,_e,_t),kF($);var Wt=DF(_e);return kF(_t),zS(m1,Wt)?(_t.enumerable?(zS($,TT)&&$[TT][Wt]&&($[TT][Wt]=!1),_t=VN(_t,{enumerable:LF(0,!1)})):(zS($,TT)||CI($,TT,LF(1,{})),$[TT][Wt]=!0),jF($,Wt,_t)):CI($,Wt,_t)},VF=function($,_e){kF($);var _t=eL(_e),Wt=A3(_t).concat(W3(_t));return tL(Wt,function(_n){vO&&!PF(B3,_t,_n)||iL($,_n,_t[_n])}),$},B3=function($){var _e=DF($),_t=PF(Woe,this,_e);return!(this===RR&&zS(m1,_e)&&!zS(GN,_e))&&(!(_t||!zS(this,_e)||!zS(m1,_e)||zS(this,TT)&&this[TT][_e])||_t)},G3=function($,_e){var _t=eL($),Wt=DF(_e);if(_t!==RR||!zS(m1,Wt)||zS(GN,Wt)){var _n=j3(_t,Wt);return!_n||!zS(m1,Wt)||zS(_t,TT)&&_t[TT][Wt]||(_n.enumerable=!0),_n}},H3=function($){var _e=F3(eL($)),_t=[];return tL(_e,function(Wt){zS(m1,Wt)||zS(L3,Wt)||V3(_t,Wt)}),_t},W3=function($){var _e=$===RR,_t=F3(_e?GN:eL($)),Wt=[];return tL(_t,function(_n){!zS(m1,_n)||_e&&!zS(RR,_n)||V3(Wt,m1[_n])}),Wt};_O||(RI=function(){if(Poe(rL,this))throw Hoe("Symbol is not a constructor");var $=arguments.length&&arguments[0]!==void 0?koe(arguments[0]):void 0,_e=x3($),_t=function(Wt){this===RR&&PF(_t,GN,Wt),zS(this,TT)&&zS(this[TT],_e)&&(this[TT][_e]=!1),jF(this,_e,LF(1,Wt))};return vO&&UF&&jF(RR,_e,{configurable:!0,set:_t}),FF(_e,$)},D3(rL=RI[BN],"toString",function(){return U3(this).tag}),D3(RI,"withoutSetter",function($){return FF(x3($),$)}),k3.f=B3,P3.f=iL,xoe.f=VF,N3.f=G3,Doe.f=O3.f=H3,Loe.f=W3,joe.f=function($){return FF(Uoe($),$)},vO&&Moe(rL,"description",{configurable:!0,get:function(){return U3(this).description}})),QD({global:!0,constructor:!0,wrap:!0,forced:!_O,sham:!_O},{Symbol:RI}),tL(A3(qoe),function($){Foe($)}),QD({target:nL,stat:!0,forced:!_O},{useSetter:function(){UF=!0},useSimple:function(){UF=!1}}),QD({target:"Object",stat:!0,forced:!_O,sham:!vO},{create:function($,_e){return _e===void 0?VN($):VF(VN($),_e)},defineProperty:iL,defineProperties:VF,getOwnPropertyDescriptor:G3}),QD({target:"Object",stat:!0,forced:!_O},{getOwnPropertyNames:H3}),Voe(),Boe(RI,nL),L3[TT]=!0;var q3=BR&&!!Symbol.for&&!!Symbol.keyFor,zoe=y0,Koe=OS,$oe=_0,Yoe=MT,z3=TR,Joe=q3,BF=z3("string-to-symbol-registry"),Xoe=z3("symbol-to-string-registry");zoe({target:"Symbol",stat:!0,forced:!Joe},{for:function($){var _e=Yoe($);if($oe(BF,_e))return BF[_e];var _t=Koe("Symbol")(_e);return BF[_e]=_t,Xoe[_t]=_e,_t}});var Zoe=y0,Qoe=_0,ese=YE,tse=s_,nse=q3,K3=TR("symbol-to-string-registry");Zoe({target:"Symbol",stat:!0,forced:!nse},{keyFor:function($){if(!ese($))throw TypeError(tse($)+" is not a symbol");if(Qoe(K3,$))return K3[$]}});var $3=FN,rse=vE,Y3=_E,ise=MT,J3=_f([].push),ose=y0,X3=OS,Z3=lE,sse=FE,HN=_f,Q3=_r,eG=vE,tG=YE,nG=MU,ase=function($){if(rse($))return $;if($3($)){for(var _e=$.length,_t=[],Wt=0;Wt<_e;Wt++){var _n=$[Wt];typeof _n=="string"?J3(_t,_n):typeof _n!="number"&&Y3(_n)!="Number"&&Y3(_n)!="String"||J3(_t,ise(_n))}var _i=_t.length,_s=!0;return function(_c,_u){if(_s)return _s=!1,_u;if($3(this))return _u;for(var _h=0;_h<_i;_h++)if(_t[_h]===_c)return _u}}},cse=BR,lse=String,B1=X3("JSON","stringify"),oL=HN(/./.exec),rG=HN("".charAt),use=HN("".charCodeAt),dse=HN("".replace),hse=HN(1 .toString),pse=/[\uD800-\uDFFF]/g,iG=/^[\uD800-\uDBFF]$/,oG=/^[\uDC00-\uDFFF]$/,sG=!cse||Q3(function(){var $=X3("Symbol")();return B1([$])!="[null]"||B1({a:$})!="{}"||B1(Object($))!="{}"}),aG=Q3(function(){return B1("\uDF06\uD834")!=='"\\udf06\\ud834"'||B1("\uDEAD")!=='"\\udead"'}),fse=function($,_e){var _t=nG(arguments),Wt=ase(_e);if(eG(Wt)||$!==void 0&&!tG($))return _t[1]=function(_n,_i){if(eG(Wt)&&(_i=sse(Wt,this,lse(_n),_i)),!tG(_i))return _i},Z3(B1,null,_t)},mse=function($,_e,_t){var Wt=rG(_t,_e-1),_n=rG(_t,_e+1);return oL(iG,$)&&!oL(oG,_n)||oL(oG,$)&&!oL(iG,Wt)?"\\u"+hse(use($,0),16):$};B1&&ose({target:"JSON",stat:!0,arity:3,forced:sG||aG},{stringify:function($,_e,_t){var Wt=nG(arguments),_n=Z3(sG?fse:B1,null,Wt);return aG&&typeof _n=="string"?dse(_n,pse,mse):_n}});var cG=RN,gse=e0;y0({target:"Object",stat:!0,forced:!BR||_r(function(){cG.f(1)})},{getOwnPropertySymbols:function($){var _e=cG.f;return _e?_e(gse($)):[]}}),wS("asyncIterator"),wS("hasInstance"),wS("isConcatSpreadable"),wS("iterator"),wS("match"),wS("matchAll"),wS("replace"),wS("search"),wS("species"),wS("split");var Ese=R3;wS("toPrimitive"),Ese();var vse=OS,_se=U1;wS("toStringTag"),_se(vse("Symbol"),"Symbol"),wS("unscopables"),U1(rE.JSON,"JSON",!0);var yse=yS.Symbol,bse=$0,Sse=ZT.f,lG=bse("metadata"),uG=Function.prototype;uG[lG]===void 0&&Sse(uG,lG,{value:null}),wS("dispose"),wS("metadata");var Tse=yse;wS("asyncDispose");var wse=_f,GF=OS("Symbol"),Rse=GF.keyFor,Cse=wse(GF.prototype.valueOf),dG=GF.isRegisteredSymbol||function($){try{return Rse(Cse($))!==void 0}catch{return!1}};y0({target:"Symbol",stat:!0},{isRegisteredSymbol:dG});for(var Ise=TR,hG=OS,Ase=_f,Ose=YE,Nse=$0,sL=hG("Symbol"),pG=sL.isWellKnownSymbol,fG=hG("Object","getOwnPropertyNames"),Pse=Ase(sL.prototype.valueOf),mG=Ise("wks"),HF=0,gG=fG(sL),kse=gG.length;HF<kse;HF++)try{var EG=gG[HF];Ose(sL[EG])&&Nse(EG)}catch{}var vG=function($){if(pG&&pG($))return!0;try{for(var _e=Pse($),_t=0,Wt=fG(mG),_n=Wt.length;_t<_n;_t++)if(mG[Wt[_t]]==_e)return!0}catch{}return!1};y0({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:vG}),wS("matcher"),wS("observable"),y0({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:dG}),y0({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:vG}),wS("metadataKey"),wS("patternMatch"),wS("replaceAll");var yO=zt(Tse),_G=zt(EO.f("iterator"));function WN($){return WN=typeof yO=="function"&&typeof _G=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof yO=="function"&&_e.constructor===yO&&_e!==yO.prototype?"symbol":typeof _e},WN($)}var Dse=zt(EO.f("toPrimitive"));function Lse($){var _e=function(_t,Wt){if(WN(_t)!=="object"||_t===null)return _t;var _n=_t[Dse];if(_n!==void 0){var _i=_n.call(_t,Wt||"default");if(WN(_i)!=="object")return _i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Wt==="string"?String:Number)(_t)}($,"string");return WN(_e)==="symbol"?_e:String(_e)}function hE($,_e,_t){return(_e=Lse(_e))in $?p3($,_e,{value:_t,enumerable:!0,configurable:!0,writable:!0}):$[_e]=_t,$}var xse=_r,Mse=$0("iterator"),WF=!xse(function(){var $=new URL("b?a=1&b=2&c=3","http://a"),_e=$.searchParams,_t=new URLSearchParams("a=1&a=2"),Wt="";return $.pathname="c%20d",_e.forEach(function(_n,_i){_e.delete("b"),Wt+=_i+_n}),_t.delete("a",2),!$.toJSON||!_t.has("a",1)||_t.has("a",2)||!_e.size&&!0||!_e.sort||$.href!=="http://a/c%20d?a=1&c=3"||_e.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!_e[Mse]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||Wt!=="a1c3"||new URL("http://x",void 0).host!=="x"}),Use=M1,qF=y0,bO=rE,aL=FE,$R=_f,SO=jE,yG=WF,bG=M1,jse=ND,Fse=function($,_e,_t){for(var Wt in _e)_t&&_t.unsafe&&$[Wt]?$[Wt]=_e[Wt]:Use($,Wt,_e[Wt],_t);return $},Vse=U1,Bse=AU,zF=SI,SG=PU,KF=vE,Gse=_0,Hse=L1,Wse=WR,qse=sT,TG=TS,fT=MT,zse=CN,wG=I_,$F=vU,Kse=SD,TO=DD,$se=D5,Yse=$0("iterator"),qN="URLSearchParams",RG=qN+"Iterator",CG=zF.set,eR=zF.getterFor(qN),Jse=zF.getterFor(RG),Xse=Object.getOwnPropertyDescriptor,YF=function($){if(!SO)return bO[$];var _e=Xse(bO,$);return _e&&_e.value},IG=YF("fetch"),cL=YF("Request"),zN=YF("Headers"),JF=cL&&cL.prototype,AG=zN&&zN.prototype,Zse=bO.RegExp,Qse=bO.TypeError,OG=bO.decodeURIComponent,eae=bO.encodeURIComponent,tae=$R("".charAt),NG=$R([].join),II=$R([].push),XF=$R("".replace),nae=$R([].shift),PG=$R([].splice),kG=$R("".split),rae=$R("".slice),iae=/\+/g,DG=Array(4),oae=function($){return DG[$-1]||(DG[$-1]=Zse("((?:%[\\da-f]{2}){"+$+"})","gi"))},sae=function($){try{return OG($)}catch{return $}},LG=function($){var _e=XF($,iae," "),_t=4;try{return OG(_e)}catch{for(;_t;)_e=XF(_e,oae(_t--),sae);return _e}},aae=/[!'()~]|%20/g,cae={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},lae=function($){return cae[$]},xG=function($){return XF(eae($),aae,lae)},ZF=Bse(function($,_e){CG(this,{type:RG,iterator:$F(eR($).entries),kind:_e})},"Iterator",function(){var $=Jse(this),_e=$.kind,_t=$.iterator.next(),Wt=_t.value;return _t.done||(_t.value=_e==="keys"?Wt.key:_e==="values"?Wt.value:[Wt.key,Wt.value]),_t},!0),MG=function($){this.entries=[],this.url=null,$!==void 0&&(TG($)?this.parseObject($):this.parseQuery(typeof $=="string"?tae($,0)==="?"?rae($,1):$:fT($)))};MG.prototype={type:qN,bindURL:function($){this.url=$,this.update()},parseObject:function($){var _e,_t,Wt,_n,_i,_s,_c,_u=Kse($);if(_u)for(_t=(_e=$F($,_u)).next;!(Wt=aL(_t,_e)).done;){if(_i=(_n=$F(qse(Wt.value))).next,(_s=aL(_i,_n)).done||(_c=aL(_i,_n)).done||!aL(_i,_n).done)throw Qse("Expected sequence with length 2");II(this.entries,{key:fT(_s.value),value:fT(_c.value)})}else for(var _h in $)Gse($,_h)&&II(this.entries,{key:_h,value:fT($[_h])})},parseQuery:function($){if($)for(var _e,_t,Wt=kG($,"&"),_n=0;_n<Wt.length;)(_e=Wt[_n++]).length&&(_t=kG(_e,"="),II(this.entries,{key:LG(nae(_t)),value:LG(NG(_t,"="))}))},serialize:function(){for(var $,_e=this.entries,_t=[],Wt=0;Wt<_e.length;)$=_e[Wt++],II(_t,xG($.key)+"="+xG($.value));return NG(_t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var lL=function(){SG(this,wO);var $=CG(this,new MG(arguments.length>0?arguments[0]:void 0));SO||(this.size=$.entries.length)},wO=lL.prototype;if(Fse(wO,{append:function($,_e){var _t=eR(this);TO(arguments.length,2),II(_t.entries,{key:fT($),value:fT(_e)}),SO||this.length++,_t.updateURL()},delete:function($){for(var _e=eR(this),_t=TO(arguments.length,1),Wt=_e.entries,_n=fT($),_i=_t<2?void 0:arguments[1],_s=_i===void 0?_i:fT(_i),_c=0;_c<Wt.length;){var _u=Wt[_c];if(_u.key!==_n||_s!==void 0&&_u.value!==_s)_c++;else if(PG(Wt,_c,1),_s!==void 0)break}SO||(this.size=Wt.length),_e.updateURL()},get:function($){var _e=eR(this).entries;TO(arguments.length,1);for(var _t=fT($),Wt=0;Wt<_e.length;Wt++)if(_e[Wt].key===_t)return _e[Wt].value;return null},getAll:function($){var _e=eR(this).entries;TO(arguments.length,1);for(var _t=fT($),Wt=[],_n=0;_n<_e.length;_n++)_e[_n].key===_t&&II(Wt,_e[_n].value);return Wt},has:function($){for(var _e=eR(this).entries,_t=TO(arguments.length,1),Wt=fT($),_n=_t<2?void 0:arguments[1],_i=_n===void 0?_n:fT(_n),_s=0;_s<_e.length;){var _c=_e[_s++];if(_c.key===Wt&&(_i===void 0||_c.value===_i))return!0}return!1},set:function($,_e){var _t=eR(this);TO(arguments.length,1);for(var Wt,_n=_t.entries,_i=!1,_s=fT($),_c=fT(_e),_u=0;_u<_n.length;_u++)(Wt=_n[_u]).key===_s&&(_i?PG(_n,_u--,1):(_i=!0,Wt.value=_c));_i||II(_n,{key:_s,value:_c}),SO||(this.size=_n.length),_t.updateURL()},sort:function(){var $=eR(this);$se($.entries,function(_e,_t){return _e.key>_t.key?1:-1}),$.updateURL()},forEach:function($){for(var _e,_t=eR(this).entries,Wt=Hse($,arguments.length>1?arguments[1]:void 0),_n=0;_n<_t.length;)Wt((_e=_t[_n++]).value,_e.key,this)},keys:function(){return new ZF(this,"keys")},values:function(){return new ZF(this,"values")},entries:function(){return new ZF(this,"entries")}},{enumerable:!0}),bG(wO,Yse,wO.entries,{name:"entries"}),bG(wO,"toString",function(){return eR(this).serialize()},{enumerable:!0}),SO&&jse(wO,"size",{get:function(){return eR(this).entries.length},configurable:!0,enumerable:!0}),Vse(lL,qN),qF({global:!0,constructor:!0,forced:!yG},{URLSearchParams:lL}),!yG&&KF(zN)){var uae=$R(AG.has),dae=$R(AG.set),UG=function($){if(TG($)){var _e,_t=$.body;if(Wse(_t)===qN)return _e=$.headers?new zN($.headers):new zN,uae(_e,"content-type")||dae(_e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),zse($,{body:wG(0,fT(_t)),headers:wG(0,_e)})}return $};if(KF(IG)&&qF({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function($){return IG($,arguments.length>1?UG(arguments[1]):{})}}),KF(cL)){var QF=function($){return SG(this,JF),new cL($,arguments.length>1?UG(arguments[1]):{})};JF.constructor=QF,QF.prototype=JF,qF({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:QF})}}var hae={URLSearchParams:lL,getState:eR},jG=zt(yS.URLSearchParams),pae={isBrowser:!0,classes:{URLSearchParams:jG!==void 0?jG:OF,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const FG=typeof window<"u"&&typeof document<"u",fae=(VG=typeof navigator<"u"&&navigator.product,FG&&["ReactNative","NativeScript","NS"].indexOf(VG)<0);var VG;const mae=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";function BG($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function GG($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?BG(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):BG(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}var YR=GG(GG({},Object.freeze({__proto__:null,hasBrowserEnv:FG,hasStandardBrowserEnv:fae,hasStandardBrowserWebWorkerEnv:mae})),pae),gae=sT,Eae=FE,vae=_0,_ae=_m,yae=function(){var $=gae(this),_e="";return $.hasIndices&&(_e+="d"),$.global&&(_e+="g"),$.ignoreCase&&(_e+="i"),$.multiline&&(_e+="m"),$.dotAll&&(_e+="s"),$.unicode&&(_e+="u"),$.unicodeSets&&(_e+="v"),$.sticky&&(_e+="y"),_e},HG=RegExp.prototype,WG=function($){var _e=$.flags;return _e!==void 0||"flags"in HG||vae($,"flags")||!_ae(HG,$)?_e:Eae(yae,$)},bae=sF.charAt,qG=FE,Sae=sT,Tae=vE,wae=_E,Rae=/./.exec,Cae=TypeError,Iae=y0,zG=FE,KG=bE,Aae=AU,uL=NU,$G=E0,YG=V8,KN=MT,Oae=sT,Nae=lS,Pae=_E,kae=G8,JG=WG,Dae=$_,Lae=_r,xae=xU,Mae=function($,_e,_t){return _e+(_t?bae($,_e).length:1)},Uae=function($,_e){var _t=$.exec;if(Tae(_t)){var Wt=qG(_t,$,_e);return Wt!==null&&Sae(Wt),Wt}if(wae($)==="RegExp")return qG(Rae,$,_e);throw Cae("RegExp#exec called on incompatible receiver")},XG=SI,jae=$0("matchAll"),ZG="RegExp String",QG=ZG+" Iterator",Fae=XG.set,Vae=XG.getterFor(QG),Bae=TypeError,eV=KG("".indexOf),dL=KG("".matchAll),tV=!!dL&&!Lae(function(){dL("a",/./)}),Gae=Aae(function($,_e,_t,Wt){Fae(this,{type:QG,regexp:$,string:_e,global:_t,unicode:Wt,done:!1})},ZG,function(){var $=Vae(this);if($.done)return uL(void 0,!0);var _e=$.regexp,_t=$.string,Wt=Uae(_e,_t);return Wt===null?($.done=!0,uL(void 0,!0)):$.global?(KN(Wt[0])===""&&(_e.lastIndex=Mae(_t,YG(_e.lastIndex),$.unicode)),uL(Wt,!1)):($.done=!0,uL(Wt,!1))}),eH=function($){var _e,_t,Wt,_n=Oae(this),_i=KN($),_s=xae(_n,RegExp),_c=KN(JG(_n));return _e=new _s(_s===RegExp?_n.source:_n,_c),_t=!!~eV(_c,"g"),Wt=!!~eV(_c,"u"),_e.lastIndex=YG(_n.lastIndex),new Gae(_e,_i,_t,Wt)};Iae({target:"String",proto:!0,forced:tV},{matchAll:function($){var _e,_t,Wt,_n,_i=$G(this);if(Nae($)){if(tV)return dL(_i,$)}else{if(kae($)&&(_e=KN($G(JG($))),!~eV(_e,"g")))throw Bae("`.matchAll` does not allow non-global regexes");if(tV)return dL(_i,$);if((Wt=Dae($,jae))===void 0&&Pae($)=="RegExp"&&(Wt=eH),Wt)return zG(Wt,$,_i)}return _t=KN(_i),_n=new RegExp($,"g"),zG(eH,_n,_t)}});var Hae=QT("String").matchAll,Wae=_m,qae=Hae,nV=String.prototype,zae=function($){var _e=$.matchAll;return typeof $=="string"||$===nV||Wae(nV,$)&&_e===nV.matchAll?qae:_e},Kae=zt(zae);function tH($){function _e(_t,Wt,_n,_i){let _s=_t[_i++];if(_s==="__proto__")return!0;const _c=Number.isFinite(+_s),_u=_i>=_t.length;return _s=!_s&&u_.isArray(_n)?_n.length:_s,_u?(u_.hasOwnProp(_n,_s)?_n[_s]=[_n[_s],Wt]:_n[_s]=Wt,!_c):(_n[_s]&&u_.isObject(_n[_s])||(_n[_s]=[]),_e(_t,Wt,_n[_s],_i)&&u_.isArray(_n[_s])&&(_n[_s]=function(_h){const _p={},Qm=Object.keys(_h);let _g;const eE=Qm.length;let pE;for(_g=0;_g<eE;_g++)pE=Qm[_g],_p[pE]=_h[pE];return _p}(_n[_s])),!_c)}if(u_.isFormData($)&&u_.isFunction($.entries)){const _t={};return u_.forEachEntry($,(Wt,_n)=>{_e(function(_i){return Kae(u_).call(u_,/\w+|\[(\w*)]/g,_i).map(_s=>_s[0]==="[]"?"":_s[1]||_s[0])}(Wt),_n,_t,0)}),_t}return null}const rV={transitional:l3,adapter:["xhr","http"],transformRequest:[function($,_e){const _t=_e.getContentType()||"",Wt=_t.indexOf("application/json")>-1,_n=u_.isObject($);if(_n&&u_.isHTMLForm($)&&($=new FormData($)),u_.isFormData($))return Wt?JSON.stringify(tH($)):$;if(u_.isArrayBuffer($)||u_.isBuffer($)||u_.isStream($)||u_.isFile($)||u_.isBlob($))return $;if(u_.isArrayBufferView($))return $.buffer;if(u_.isURLSearchParams($))return _e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),$.toString();let _i;if(_n){if(_t.indexOf("application/x-www-form-urlencoded")>-1)return function(_s,_c){return ZD(_s,new YR.classes.URLSearchParams,Object.assign({visitor:function(_u,_h,_p,Qm){return YR.isNode&&u_.isBuffer(_u)?(this.append(_h,_u.toString("base64")),!1):Qm.defaultVisitor.apply(this,arguments)}},_c))}($,this.formSerializer).toString();if((_i=u_.isFileList($))||_t.indexOf("multipart/form-data")>-1){const _s=this.env&&this.env.FormData;return ZD(_i?{"files[]":$}:$,_s&&new _s,this.formSerializer)}}return _n||Wt?(_e.setContentType("application/json",!1),function(_s,_c,_u){if(u_.isString(_s))try{return(_c||JSON.parse)(_s),VS(u_).call(u_,_s)}catch(_h){if(_h.name!=="SyntaxError")throw _h}return(0,JSON.stringify)(_s)}($)):$}],transformResponse:[function($){const _e=this.transitional||rV.transitional,_t=_e&&_e.forcedJSONParsing,Wt=this.responseType==="json";if($&&u_.isString($)&&(_t&&!this.responseType||Wt)){const _n=!(_e&&_e.silentJSONParsing)&&Wt;try{return JSON.parse($)}catch(_i){if(_n)throw _i.name==="SyntaxError"?D0.from(_i,D0.ERR_BAD_RESPONSE,this,null,this.response):_i}}return $}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:YR.classes.FormData,Blob:YR.classes.Blob},validateStatus:function($){return $>=200&&$<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};u_.forEach(["delete","get","head","post","put","patch"],$=>{rV.headers[$]={}});var iV=rV;const $ae=u_.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),nH=Symbol("internals");function $N($){var _e;return $&&VS(_e=String($)).call(_e).toLowerCase()}function hL($){return $===!1||$==null?$:u_.isArray($)?$.map(hL):String($)}function oV($,_e,_t,Wt,_n){return u_.isFunction(Wt)?Wt.call(this,_e,_t):(_n&&(_e=_t),u_.isString(_e)?u_.isString(Wt)?_e.indexOf(Wt)!==-1:u_.isRegExp(Wt)?Wt.test(_e):void 0:void 0)}class pL{constructor(_e){_e&&this.set(_e)}set(_e,_t,Wt){const _n=this;function _i(_u,_h,_p){const Qm=$N(_h);if(!Qm)throw new Error("header name must be a non-empty string");const _g=u_.findKey(_n,Qm);(!_g||_n[_g]===void 0||_p===!0||_p===void 0&&_n[_g]!==!1)&&(_n[_g||_h]=hL(_u))}const _s=(_u,_h)=>u_.forEach(_u,(_p,Qm)=>_i(_p,Qm,_h));var _c;return u_.isPlainObject(_e)||_e instanceof this.constructor?_s(_e,_t):u_.isString(_e)&&(_e=VS(_e).call(_e))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(VS(_c=_e).call(_c))?_s((_u=>{const _h={};let _p,Qm,_g;return _u&&_u.split(`
`).forEach(function(eE){var pE,aE;_g=eE.indexOf(":"),_p=VS(pE=eE.substring(0,_g)).call(pE).toLowerCase(),Qm=VS(aE=eE.substring(_g+1)).call(aE),!_p||_h[_p]&&$ae[_p]||(_p==="set-cookie"?_h[_p]?_h[_p].push(Qm):_h[_p]=[Qm]:_h[_p]=_h[_p]?_h[_p]+", "+Qm:Qm)}),_h})(_e),_t):_e!=null&&_i(_t,_e,Wt),this}get(_e,_t){if(_e=$N(_e)){const Wt=u_.findKey(this,_e);if(Wt){const _n=this[Wt];if(!_t)return _n;if(_t===!0)return function(_i){const _s=Object.create(null),_c=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _u;for(;_u=_c.exec(_i);)_s[_u[1]]=_u[2];return _s}(_n);if(u_.isFunction(_t))return _t.call(this,_n,Wt);if(u_.isRegExp(_t))return _t.exec(_n);throw new TypeError("parser must be boolean|regexp|function")}}}has(_e,_t){if(_e=$N(_e)){const Wt=u_.findKey(this,_e);return!(!Wt||this[Wt]===void 0||_t&&!oV(0,this[Wt],Wt,_t))}return!1}delete(_e,_t){const Wt=this;let _n=!1;function _i(_s){if(_s=$N(_s)){const _c=u_.findKey(Wt,_s);!_c||_t&&!oV(0,Wt[_c],_c,_t)||(delete Wt[_c],_n=!0)}}return u_.isArray(_e)?_e.forEach(_i):_i(_e),_n}clear(_e){const _t=Object.keys(this);let Wt=_t.length,_n=!1;for(;Wt--;){const _i=_t[Wt];_e&&!oV(0,this[_i],_i,_e,!0)||(delete this[_i],_n=!0)}return _n}normalize(_e){const _t=this,Wt={};return u_.forEach(this,(_n,_i)=>{var _s;const _c=u_.findKey(Wt,_i);if(_c)return _t[_c]=hL(_n),void delete _t[_i];const _u=_e?function(_h){return VS(_h).call(_h).toLowerCase().replace(/([a-z\d])(\w*)/g,(_p,Qm,_g)=>Qm.toUpperCase()+_g)}(_i):VS(_s=String(_i)).call(_s);_u!==_i&&delete _t[_i],_t[_u]=hL(_n),Wt[_u]=!0}),this}concat(){for(var _e=arguments.length,_t=new Array(_e),Wt=0;Wt<_e;Wt++)_t[Wt]=arguments[Wt];return this.constructor.concat(this,..._t)}toJSON(_e){const _t=Object.create(null);return u_.forEach(this,(Wt,_n)=>{Wt!=null&&Wt!==!1&&(_t[_n]=_e&&u_.isArray(Wt)?Wt.join(", "):Wt)}),_t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(_e=>{let[_t,Wt]=_e;return _t+": "+Wt}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(_e){return _e instanceof this?_e:new this(_e)}static concat(_e){const _t=new this(_e);for(var Wt=arguments.length,_n=new Array(Wt>1?Wt-1:0),_i=1;_i<Wt;_i++)_n[_i-1]=arguments[_i];return _n.forEach(_s=>_t.set(_s)),_t}static accessor(_e){const _t=(this[nH]=this[nH]={accessors:{}}).accessors,Wt=this.prototype;function _n(_i){const _s=$N(_i);_t[_s]||(function(_c,_u){const _h=u_.toCamelCase(" "+_u);["get","set","has"].forEach(_p=>{Object.defineProperty(_c,_p+_h,{value:function(Qm,_g,eE){return this[_p].call(this,_u,Qm,_g,eE)},configurable:!0})})}(Wt,_i),_t[_s]=!0)}return u_.isArray(_e)?_e.forEach(_n):_n(_e),this}}pL.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),u_.reduceDescriptors(pL.prototype,($,_e)=>{let{value:_t}=$,Wt=_e[0].toUpperCase()+_e.slice(1);return{get:()=>_t,set(_n){this[Wt]=_n}}}),u_.freezeMethods(pL);var g1=pL;function sV($,_e){const _t=this||iV,Wt=_e||_t,_n=g1.from(Wt.headers);let _i=Wt.data;return u_.forEach($,function(_s){_i=_s.call(_t,_i,_n.normalize(),_e?_e.status:void 0)}),_n.normalize(),_i}function rH($){return!(!$||!$.__CANCEL__)}function YN($,_e,_t){D0.call(this,$??"canceled",D0.ERR_CANCELED,_e,_t),this.name="CanceledError"}u_.inherits(YN,D0,{__CANCEL__:!0});var Yae=YR.hasStandardBrowserEnv?{write($,_e,_t,Wt,_n,_i){const _s=[$+"="+encodeURIComponent(_e)];u_.isNumber(_t)&&_s.push("expires="+new Date(_t).toGMTString()),u_.isString(Wt)&&_s.push("path="+Wt),u_.isString(_n)&&_s.push("domain="+_n),_i===!0&&_s.push("secure"),document.cookie=_s.join("; ")},read($){const _e=document.cookie.match(new RegExp("(^|;\\s*)("+$+")=([^;]*)"));return _e?decodeURIComponent(_e[3]):null},remove($){this.write($,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function iH($,_e){return $&&!function(_t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(_t)}(_e)?function(_t,Wt){return Wt?_t.replace(/\/?\/$/,"")+"/"+Wt.replace(/^\/+/,""):_t}($,_e):_e}var Jae=YR.hasStandardBrowserEnv?function(){const $=/(msie|trident)/i.test(navigator.userAgent),_e=document.createElement("a");let _t;function Wt(_n){let _i=_n;return $&&(_e.setAttribute("href",_i),_i=_e.href),_e.setAttribute("href",_i),{href:_e.href,protocol:_e.protocol?_e.protocol.replace(/:$/,""):"",host:_e.host,search:_e.search?_e.search.replace(/^\?/,""):"",hash:_e.hash?_e.hash.replace(/^#/,""):"",hostname:_e.hostname,port:_e.port,pathname:_e.pathname.charAt(0)==="/"?_e.pathname:"/"+_e.pathname}}return _t=Wt(window.location.href),function(_n){const _i=u_.isString(_n)?Wt(_n):_n;return _i.protocol===_t.protocol&&_i.host===_t.host}}():function(){return!0};function oH($,_e){let _t=0;const Wt=function(_n,_i){_n=_n||10;const _s=new Array(_n),_c=new Array(_n);let _u,_h=0,_p=0;return _i=_i!==void 0?_i:1e3,function(Qm){const _g=Date.now(),eE=_c[_p];_u||(_u=_g),_s[_h]=Qm,_c[_h]=_g;let pE=_p,aE=0;for(;pE!==_h;)aE+=_s[pE++],pE%=_n;if(_h=(_h+1)%_n,_h===_p&&(_p=(_p+1)%_n),_g-_u<_i)return;const cE=eE&&_g-eE;return cE?Math.round(1e3*aE/cE):void 0}}(50,250);return _n=>{const _i=_n.loaded,_s=_n.lengthComputable?_n.total:void 0,_c=_i-_t,_u=Wt(_c);_t=_i;const _h={loaded:_i,total:_s,progress:_s?_i/_s:void 0,bytes:_c,rate:_u||void 0,estimated:_u&&_s&&_i<=_s?(_s-_i)/_u:void 0,event:_n};_h[_e?"download":"upload"]=!0,$(_h)}}var Xae=typeof XMLHttpRequest<"u"&&function($){return new n_(function(_e,_t){let Wt=$.data;const _n=g1.from($.headers).normalize();let _i,_s,{responseType:_c,withXSRFToken:_u}=$;function _h(){$.cancelToken&&$.cancelToken.unsubscribe(_i),$.signal&&$.signal.removeEventListener("abort",_i)}if(u_.isFormData(Wt)){if(YR.hasStandardBrowserEnv||YR.hasStandardBrowserWebWorkerEnv)_n.setContentType(!1);else if((_s=_n.getContentType())!==!1){const[pE,...aE]=_s?_s.split(";").map(cE=>VS(cE).call(cE)).filter(Boolean):[];_n.setContentType([pE||"multipart/form-data",...aE].join("; "))}}let _p=new XMLHttpRequest;if($.auth){const pE=$.auth.username||"",aE=$.auth.password?unescape(encodeURIComponent($.auth.password)):"";_n.set("Authorization","Basic "+btoa(pE+":"+aE))}const Qm=iH($.baseURL,$.url);function _g(){if(!_p)return;const pE=g1.from("getAllResponseHeaders"in _p&&_p.getAllResponseHeaders());(function(aE,cE,fE){const gE=fE.config.validateStatus;fE.status&&gE&&!gE(fE.status)?cE(new D0("Request failed with status code "+fE.status,[D0.ERR_BAD_REQUEST,D0.ERR_BAD_RESPONSE][Math.floor(fE.status/100)-4],fE.config,fE.request,fE)):aE(fE)})(function(aE){_e(aE),_h()},function(aE){_t(aE),_h()},{data:_c&&_c!=="text"&&_c!=="json"?_p.response:_p.responseText,status:_p.status,statusText:_p.statusText,headers:pE,config:$,request:_p}),_p=null}if(_p.open($.method.toUpperCase(),a3(Qm,$.params,$.paramsSerializer),!0),_p.timeout=$.timeout,"onloadend"in _p?_p.onloadend=_g:_p.onreadystatechange=function(){_p&&_p.readyState===4&&(_p.status!==0||_p.responseURL&&_p.responseURL.indexOf("file:")===0)&&setTimeout(_g)},_p.onabort=function(){_p&&(_t(new D0("Request aborted",D0.ECONNABORTED,$,_p)),_p=null)},_p.onerror=function(){_t(new D0("Network Error",D0.ERR_NETWORK,$,_p)),_p=null},_p.ontimeout=function(){let pE=$.timeout?"timeout of "+$.timeout+"ms exceeded":"timeout exceeded";const aE=$.transitional||l3;$.timeoutErrorMessage&&(pE=$.timeoutErrorMessage),_t(new D0(pE,aE.clarifyTimeoutError?D0.ETIMEDOUT:D0.ECONNABORTED,$,_p)),_p=null},YR.hasStandardBrowserEnv&&(_u&&u_.isFunction(_u)&&(_u=_u($)),_u||_u!==!1&&Jae(Qm))){const pE=$.xsrfHeaderName&&$.xsrfCookieName&&Yae.read($.xsrfCookieName);pE&&_n.set($.xsrfHeaderName,pE)}Wt===void 0&&_n.setContentType(null),"setRequestHeader"in _p&&u_.forEach(_n.toJSON(),function(pE,aE){_p.setRequestHeader(aE,pE)}),u_.isUndefined($.withCredentials)||(_p.withCredentials=!!$.withCredentials),_c&&_c!=="json"&&(_p.responseType=$.responseType),typeof $.onDownloadProgress=="function"&&_p.addEventListener("progress",oH($.onDownloadProgress,!0)),typeof $.onUploadProgress=="function"&&_p.upload&&_p.upload.addEventListener("progress",oH($.onUploadProgress)),($.cancelToken||$.signal)&&(_i=pE=>{_p&&(_t(!pE||pE.type?new YN(null,$,_p):pE),_p.abort(),_p=null)},$.cancelToken&&$.cancelToken.subscribe(_i),$.signal&&($.signal.aborted?_i():$.signal.addEventListener("abort",_i)));const eE=function(pE){const aE=/^([-+\w]{1,25})(:?\/\/|:)/.exec(pE);return aE&&aE[1]||""}(Qm);eE&&YR.protocols.indexOf(eE)===-1?_t(new D0("Unsupported protocol "+eE+":",D0.ERR_BAD_REQUEST,$)):_p.send(Wt||null)})};const aV={http:null,xhr:Xae};u_.forEach(aV,($,_e)=>{if($){try{Object.defineProperty($,"name",{value:_e})}catch{}Object.defineProperty($,"adapterName",{value:_e})}});const sH=$=>"- ".concat($),Zae=$=>u_.isFunction($)||$===null||$===!1;var aH={getAdapter:$=>{$=u_.isArray($)?$:[$];const{length:_e}=$;let _t,Wt;const _n={};for(let _i=0;_i<_e;_i++){let _s;if(_t=$[_i],Wt=_t,!Zae(_t)&&(Wt=aV[(_s=String(_t)).toLowerCase()],Wt===void 0))throw new D0("Unknown adapter '".concat(_s,"'"));if(Wt)break;_n[_s||"#"+_i]=Wt}if(!Wt){const _i=Object.entries(_n).map(_s=>{let[_c,_u]=_s;return"adapter ".concat(_c," ")+(_u===!1?"is not supported by the environment":"is not available in the build")});throw new D0("There is no suitable adapter to dispatch the request "+(_e?_i.length>1?`since :
`+_i.map(sH).join(`
`):" "+sH(_i[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return Wt},adapters:aV};function cV($){if($.cancelToken&&$.cancelToken.throwIfRequested(),$.signal&&$.signal.aborted)throw new YN(null,$)}function cH($){return cV($),$.headers=g1.from($.headers),$.data=sV.call($,$.transformRequest),["post","put","patch"].indexOf($.method)!==-1&&$.headers.setContentType("application/x-www-form-urlencoded",!1),aH.getAdapter($.adapter||iV.adapter)($).then(function(_e){return cV($),_e.data=sV.call($,$.transformResponse,_e),_e.headers=g1.from(_e.headers),_e},function(_e){return rH(_e)||(cV($),_e&&_e.response&&(_e.response.data=sV.call($,$.transformResponse,_e.response),_e.response.headers=g1.from(_e.response.headers))),n_.reject(_e)})}function lH($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}const uH=$=>$ instanceof g1?function(_e){for(var _t=1;_t<arguments.length;_t++){var Wt=arguments[_t]!=null?arguments[_t]:{};_t%2?lH(Object(Wt),!0).forEach(function(_n){hE(_e,_n,Wt[_n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_e,Object.getOwnPropertyDescriptors(Wt)):lH(Object(Wt)).forEach(function(_n){Object.defineProperty(_e,_n,Object.getOwnPropertyDescriptor(Wt,_n))})}return _e}({},$):$;function RO($,_e){_e=_e||{};const _t={};function Wt(_h,_p,Qm){return u_.isPlainObject(_h)&&u_.isPlainObject(_p)?u_.merge.call({caseless:Qm},_h,_p):u_.isPlainObject(_p)?u_.merge({},_p):u_.isArray(_p)?_p.slice():_p}function _n(_h,_p,Qm){return u_.isUndefined(_p)?u_.isUndefined(_h)?void 0:Wt(void 0,_h,Qm):Wt(_h,_p,Qm)}function _i(_h,_p){if(!u_.isUndefined(_p))return Wt(void 0,_p)}function _s(_h,_p){return u_.isUndefined(_p)?u_.isUndefined(_h)?void 0:Wt(void 0,_h):Wt(void 0,_p)}function _c(_h,_p,Qm){return Qm in _e?Wt(_h,_p):Qm in $?Wt(void 0,_h):void 0}const _u={url:_i,method:_i,data:_i,baseURL:_s,transformRequest:_s,transformResponse:_s,paramsSerializer:_s,timeout:_s,timeoutMessage:_s,withCredentials:_s,withXSRFToken:_s,adapter:_s,responseType:_s,xsrfCookieName:_s,xsrfHeaderName:_s,onUploadProgress:_s,onDownloadProgress:_s,decompress:_s,maxContentLength:_s,maxBodyLength:_s,beforeRedirect:_s,transport:_s,httpAgent:_s,httpsAgent:_s,cancelToken:_s,socketPath:_s,responseEncoding:_s,validateStatus:_c,headers:(_h,_p)=>_n(uH(_h),uH(_p),!0)};return u_.forEach(Object.keys(Object.assign({},$,_e)),function(_h){const _p=_u[_h]||_n,Qm=_p($[_h],_e[_h],_h);u_.isUndefined(Qm)&&_p!==_c||(_t[_h]=Qm)}),_t}const dH="1.6.8",lV={};["object","boolean","number","function","string","symbol"].forEach(($,_e)=>{lV[$]=function(_t){return typeof _t===$||"a"+(_e<1?"n ":" ")+$}});const hH={};lV.transitional=function($,_e,_t){function Wt(_n,_i){return"[Axios v"+dH+"] Transitional option '"+_n+"'"+_i+(_t?". "+_t:"")}return(_n,_i,_s)=>{if($===!1)throw new D0(Wt(_i," has been removed"+(_e?" in "+_e:"")),D0.ERR_DEPRECATED);return _e&&!hH[_i]&&(hH[_i]=!0,console.warn(Wt(_i," has been deprecated since v"+_e+" and will be removed in the near future"))),!$||$(_n,_i,_s)}};var uV={assertOptions:function($,_e,_t){if(typeof $!="object")throw new D0("options must be an object",D0.ERR_BAD_OPTION_VALUE);const Wt=Object.keys($);let _n=Wt.length;for(;_n-- >0;){const _i=Wt[_n],_s=_e[_i];if(_s){const _c=$[_i],_u=_c===void 0||_s(_c,_i,$);if(_u!==!0)throw new D0("option "+_i+" must be "+_u,D0.ERR_BAD_OPTION_VALUE)}else if(_t!==!0)throw new D0("Unknown option "+_i,D0.ERR_BAD_OPTION)}},validators:lV};const G1=uV.validators;let fL=class{constructor($){this.defaults=$,this.interceptors={request:new c3,response:new c3}}async request($,_e){try{return await this._request($,_e)}catch(_t){if(_t instanceof Error){let Wt;Error.captureStackTrace?Error.captureStackTrace(Wt={}):Wt=new Error;const _n=Wt.stack?Wt.stack.replace(/^.+\n/,""):"";_t.stack?_n&&!String(_t.stack).endsWith(_n.replace(/^.+\n.+\n/,""))&&(_t.stack+=`
`+_n):_t.stack=_n}throw _t}}_request($,_e){typeof $=="string"?(_e=_e||{}).url=$:_e=$||{},_e=RO(this.defaults,_e);const{transitional:_t,paramsSerializer:Wt,headers:_n}=_e;_t!==void 0&&uV.assertOptions(_t,{silentJSONParsing:G1.transitional(G1.boolean),forcedJSONParsing:G1.transitional(G1.boolean),clarifyTimeoutError:G1.transitional(G1.boolean)},!1),Wt!=null&&(u_.isFunction(Wt)?_e.paramsSerializer={serialize:Wt}:uV.assertOptions(Wt,{encode:G1.function,serialize:G1.function},!0)),_e.method=(_e.method||this.defaults.method||"get").toLowerCase();let _i=_n&&u_.merge(_n.common,_n[_e.method]);_n&&u_.forEach(["delete","get","head","post","put","patch","common"],eE=>{delete _n[eE]}),_e.headers=g1.concat(_i,_n);const _s=[];let _c=!0;this.interceptors.request.forEach(function(eE){typeof eE.runWhen=="function"&&eE.runWhen(_e)===!1||(_c=_c&&eE.synchronous,_s.unshift(eE.fulfilled,eE.rejected))});const _u=[];let _h;this.interceptors.response.forEach(function(eE){_u.push(eE.fulfilled,eE.rejected)});let _p,Qm=0;if(!_c){const eE=[cH.bind(this),void 0];for(eE.unshift.apply(eE,_s),eE.push.apply(eE,_u),_p=eE.length,_h=n_.resolve(_e);Qm<_p;)_h=_h.then(eE[Qm++],eE[Qm++]);return _h}_p=_s.length;let _g=_e;for(Qm=0;Qm<_p;){const eE=_s[Qm++],pE=_s[Qm++];try{_g=eE(_g)}catch(aE){pE.call(this,aE);break}}try{_h=cH.call(this,_g)}catch(eE){return n_.reject(eE)}for(Qm=0,_p=_u.length;Qm<_p;)_h=_h.then(_u[Qm++],_u[Qm++]);return _h}getUri($){return a3(iH(($=RO(this.defaults,$)).baseURL,$.url),$.params,$.paramsSerializer)}};u_.forEach(["delete","get","head","options"],function($){fL.prototype[$]=function(_e,_t){return this.request(RO(_t||{},{method:$,url:_e,data:(_t||{}).data}))}}),u_.forEach(["post","put","patch"],function($){function _e(_t){return function(Wt,_n,_i){return this.request(RO(_i||{},{method:$,headers:_t?{"Content-Type":"multipart/form-data"}:{},url:Wt,data:_n}))}}fL.prototype[$]=_e(),fL.prototype[$+"Form"]=_e(!0)});var mL=fL;class dV{constructor(_e){if(typeof _e!="function")throw new TypeError("executor must be a function.");let _t;this.promise=new n_(function(_n){_t=_n});const Wt=this;this.promise.then(_n=>{if(!Wt._listeners)return;let _i=Wt._listeners.length;for(;_i-- >0;)Wt._listeners[_i](_n);Wt._listeners=null}),this.promise.then=_n=>{let _i;const _s=new n_(_c=>{Wt.subscribe(_c),_i=_c}).then(_n);return _s.cancel=function(){Wt.unsubscribe(_i)},_s},_e(function(_n,_i,_s){Wt.reason||(Wt.reason=new YN(_n,_i,_s),_t(Wt.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(_e){this.reason?_e(this.reason):this._listeners?this._listeners.push(_e):this._listeners=[_e]}unsubscribe(_e){if(!this._listeners)return;const _t=this._listeners.indexOf(_e);_t!==-1&&this._listeners.splice(_t,1)}static source(){let _e;return{token:new dV(function(_t){_e=_t}),cancel:_e}}}var Qae=dV;const hV={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hV).forEach($=>{let[_e,_t]=$;hV[_t]=_e});var ece=hV;const US=function $(_e){const _t=new mL(_e),Wt=q5(mL.prototype.request,_t);return u_.extend(Wt,mL.prototype,_t,{allOwnKeys:!0}),u_.extend(Wt,_t,null,{allOwnKeys:!0}),Wt.create=function(_n){return $(RO(_e,_n))},Wt}(iV);US.Axios=mL,US.CanceledError=YN,US.CancelToken=Qae,US.isCancel=rH,US.VERSION=dH,US.toFormData=ZD,US.AxiosError=D0,US.Cancel=US.CanceledError,US.all=function($){return n_.all($)},US.spread=function($){return function(_e){return $.apply(null,_e)}},US.isAxiosError=function($){return u_.isObject($)&&$.isAxiosError===!0},US.mergeConfig=RO,US.AxiosHeaders=g1,US.formToJSON=$=>tH(u_.isHTMLForm($)?new FormData($):$),US.getAdapter=aH.getAdapter,US.HttpStatusCode=ece,US.default=US;var tT=US;const tce=()=>{};function JN(){const $={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:tce};return $.promise=new n_((_e,_t)=>{$.resolve=Wt=>{$.isFinished||($.isResolved=!0,$.isFinished=!0,_e(Wt),$.value=Wt)},$.reject=Wt=>{$.isFinished||($.isRejected=!0,$.isFinished=!0,_t(Wt))}}),$}const gL=new Map,EL=new Map,JR=new Map;let uS=function($){return $.WIN_10="Windows 10",$.WIN_81="Windows 8.1",$.WIN_8="Windows 8",$.WIN_7="Windows 7",$.WIN_VISTA="Windows Vista",$.WIN_SERVER_2003="Windows Server 2003",$.WIN_XP="Windows XP",$.WIN_2000="Windows 2000",$.ANDROID="Android",$.HARMONY_OS="HarmonyOS",$.OPEN_BSD="Open BSD",$.SUN_OS="Sun OS",$.LINUX="Linux",$.IOS="iOS",$.MAC_OS="Mac OS",$.CHROMIUM_OS="Chromium OS",$.QNX="QNX",$.UNIX="UNIX",$.BEOS="BeOS",$.OS_2="OS/2",$.SEARCH_BOT="Search Bot",$}({}),t0=function($){return $.CHROME="Chrome",$.SAFARI="Safari",$.EDGE="Edge",$.FIREFOX="Firefox",$.OPERA="OPR",$.QQ="QQBrowser",$.WECHAT="MicroMessenger",$}({});const pH=new Sie;let CR=pH.getResult(),pV=null;function W_($){if(!pV){CR=pH.getResult();const _e=function(_c){if(_c.engine.name==="Blink"&&_c.browser.name!=="WeChat")return t0.CHROME;switch(_c.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return t0.CHROME;case"Safari":case"Mobile Safari":return t0.SAFARI;case"Edge":return t0.EDGE;case"Firefox":return t0.FIREFOX;case"QQ":case"QQBrowser":return t0.QQ;case"Opera":return t0.OPERA;case"WeChat":return t0.WECHAT;default:return _c.browser.name||""}}(CR),_t=fH(CR),Wt=function(_c){return _c.os.name==="Windows"?_c.os.version?_c.os.name+" "+_c.os.version:_c.os.name:_c.os.name||""}(CR),_n=CR.os.version,_i=fH(CR,!1),_s=CR.device.type;if(!(_e&&_t&&Wt&&_n))return{name:_e,version:_t,os:Wt,osVersion:_n,browserVersion:_i,deviceType:_s};pV={name:_e,version:_t,os:Wt,osVersion:_n,browserVersion:_i,deviceType:_s}}return pV}function fH($){let _e,_t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return _e=$.engine.name==="Blink"?$.engine.version||"":$.browser.version||"",_t?_e.split(".")[0]:_e}function vL(){return W_().os}function mH(){const $=W_();return"".concat($.os," ").concat($.osVersion)}function _L(){const $=W_();return!!(CR.engine.name==="WebKit"&&$.os===uS.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&$.name!==t0.SAFARI||PS()&&$.name!==t0.SAFARI)}function H1(){return W_().name===t0.CHROME}function dS(){return W_().name===t0.SAFARI}function gH(){return W_().name===t0.EDGE}function h0(){return W_().name===t0.FIREFOX}function PS(){return W_().os===uS.IOS}function fV($){const _e=W_();return!(_e.name!==t0.CHROME||!_e.osVersion)&&Number(_e.version)>=$}function EH($){const _e=W_();return!(_e.name!==t0.EDGE||!_e.osVersion)&&Number(_e.version)>=$}function vH($){const _e=W_();return!(_e.name!==t0.SAFARI||!_e.osVersion)&&Number(_e.version)>=$}function _H($,_e,_t){const Wt=W_();if(Wt.os!==uS.IOS||!Wt.osVersion)return!1;const _n=Wt.osVersion.split(".");return _e&&Number(_n[0])===$&&Number(_n[1])<_e||Number(_n[0])<$}function yH($,_e,_t){const Wt=W_();if(Wt.name!==t0.SAFARI||!Wt.osVersion||!Wt.browserVersion)return!1;const _n=Wt.browserVersion.split(".");return _e&&Number(_n[0])===$&&Number(_n[1])<_e||Number(_n[0])<$}function bH($){const _e=W_();return!(_e.name!==t0.OPERA||!_e.osVersion)&&Number(_e.version)>=$}function SH(){const $=W_();return!($.name!==t0.CHROME||!$.osVersion)&&Number($.version)<=90}function TH(){const $=W_();if($.os!==uS.IOS||!$.osVersion)return!1;const _e=$.osVersion.split(".");return Number(_e[0])<14||Number(_e[0])===14&&Number(_e[1])<=6}function CO(){const $=W_();if($.os!==uS.IOS||!$.osVersion)return!1;const _e=$.osVersion.split(".");return Number(_e[0])===15}function mV(){const $=W_();if($.os!==uS.IOS||!$.osVersion)return!1;const _e=$.osVersion.split(".");return Number(_e[0])===16}function wH(){const $=W_();if($.os!==uS.IOS||!$.osVersion)return!1;const _e=$.osVersion.split(".");return Number(_e[0])===15&&Number(_e[1])>=1}function tR(){return dS()&&navigator.maxTouchPoints>0}function RH(){return W_().name===t0.WECHAT}function CH(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function gV(){const $=vL();return function(){const{deviceType:_e}=W_();return _e==="mobile"||_e==="tablet"}()||$===uS.ANDROID||$===uS.IOS||$===uS.HARMONY_OS}function W1(){const $=W_();return $.name!==t0.EDGE&&$.name!==t0.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function yL(){return vL()===uS.ANDROID}function XN(){const $=W_();return yL()&&($.name===t0.CHROME||$.name===t0.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function IH($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function f_($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?IH(Object(_t),!0).forEach(function(Wt){C0($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):IH(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function C0($,_e,_t){return(_e=function(Wt){var _n=function(_i,_s){if(typeof _i!="object"||_i===null)return _i;var _c=_i[Symbol.toPrimitive];if(_c!==void 0){var _u=_c.call(_i,"string");if(typeof _u!="object")return _u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_i)}(Wt);return typeof _n=="symbol"?_n:String(_n)}(_e))in $?Object.defineProperty($,_e,{value:_t,enumerable:!0,configurable:!0,writable:!0}):$[_e]=_t,$}let mE=function($){return $.UNEXPECTED_ERROR="UNEXPECTED_ERROR",$.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",$.TIMEOUT="TIMEOUT",$.INVALID_PARAMS="INVALID_PARAMS",$.NOT_READABLE="NOT_READABLE",$.NOT_SUPPORTED="NOT_SUPPORTED",$.INVALID_OPERATION="INVALID_OPERATION",$.OPERATION_ABORTED="OPERATION_ABORTED",$.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",$.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",$.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",$.DATACHANNEL_FAILED="DATACHANNEL_FAILED",$.NETWORK_ERROR="NETWORK_ERROR",$.NETWORK_TIMEOUT="NETWORK_TIMEOUT",$.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",$.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",$.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",$.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",$.ELECTRON_IS_NULL="ELECTRON_IS_NULL",$.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",$.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",$.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",$.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",$.PERMISSION_DENIED="PERMISSION_DENIED",$.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",$.TRACK_IS_DISABLED="TRACK_IS_DISABLED",$.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",$.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",$.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",$.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",$.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",$.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",$.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",$.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",$.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",$.UID_CONFLICT="UID_CONFLICT",$.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",$.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",$.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",$.INVALID_TRACK="INVALID_TRACK",$.SENDER_NOT_FOUND="SENDER_NOT_FOUND",$.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",$.SET_ANSWER_FAILED="SET_ANSWER_FAILED",$.ICE_FAILED="ICE_FAILED",$.PC_CLOSED="PC_CLOSED",$.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",$.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",$.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",$.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",$.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",$.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",$.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",$.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",$.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",$.INVALID_REMOTE_USER="INVALID_REMOTE_USER",$.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",$.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",$.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",$.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",$.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",$.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",$.WS_ABORT="WS_ABORT",$.WS_DISCONNECT="WS_DISCONNECT",$.WS_ERR="WS_ERR",$.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",$.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",$.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",$.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",$.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",$.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",$.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",$.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",$.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",$.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",$.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",$.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",$.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",$.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",$.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",$.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",$.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",$.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",$.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",$.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",$.INVALID_PLUGIN="INVALID_PLUGIN",$.DISCONNECT_P2P="DISCONNECT_P2P",$.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",$.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",$.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",$.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",$.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",$.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",$.PROHIBITED_OPERATION="PROHIBITED_OPERATION",$.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",$.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",$}({});class HE extends Error{constructor(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",Wt=arguments.length>2?arguments[2]:void 0;super(_t),C0(this,"code",void 0),C0(this,"message",void 0),C0(this,"data",void 0),C0(this,"name","AgoraRTCException"),this.code=_e,this.message="AgoraRTCError ".concat(this.code,": ").concat(_t),this.data=Wt}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",_t=arguments.length>1?arguments[1]:void 0;return _e==="error"&&(_t||console).error(this.toString()),_e==="warning"&&(_t||console).warn(this.toString()),this}throw(_e){throw this.print("error",_e),this}}function E1($,_e){if(typeof $!="boolean")throw new HE(mE.INVALID_PARAMS,"Invalid ".concat(_e,": The value is of the boolean type."))}function aS($,_e,_t){if(!i_(_t).call(_t,$))throw new HE(mE.INVALID_PARAMS,"".concat(_e," can only be set as ").concat(JSON.stringify(_t)))}function u0($,_e){let _t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if($<_t||$>Wt||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(_n){return typeof _n=="number"&&_n%1==0}($))throw new HE(mE.INVALID_PARAMS,"invalid ".concat(_e,": the value range is [").concat(_t,", ").concat(Wt,"]. integer only"))}function EV($,_e){if(typeof $!="number"){if(!($.min||$.max||$.ideal||$.exact))throw new HE(mE.INVALID_PARAMS,"".concat(_e," is not a valid ConstrainLong"));$.min!==void 0&&u0($.min,"".concat(_e,".min"),0,1/0),$.max!==void 0&&u0($.max,"".concat(_e,".max"),1,1/0),$.exact!==void 0&&u0($.exact,"".concat(_e,".exact"),1,1/0),$.ideal!==void 0&&u0($.ideal,"".concat(_e,".ideal"),1,1/0)}else u0($,_e,1,1/0)}function bS($,_e){let _t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,_n=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if($==null)throw new HE(mE.INVALID_PARAMS,"".concat(_e||"param"," cannot be empty"));if(!AH($,_t,Wt,_n))throw new HE(mE.INVALID_PARAMS,"Invalid ".concat(_e||"string param",": Length of the string: [").concat(_t,",").concat(Wt,"].").concat(_n?" ASCII characters only.":""))}function v1($,_e){if(!Array.isArray($))throw new HE(mE.INVALID_PARAMS,"".concat(_e," should be an array"))}function U0($){return $==null}function AH($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,_t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,Wt=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof $=="string"&&$.length<=_t&&$.length>=_e&&(!Wt||function(_n){if(typeof _n!="string")return!1;for(let _i=0;_i<_n.length;_i+=1){const _s=_n.charCodeAt(_i);if(_s<0||_s>255)return!1}return!0}($))}function OH($,_e,_t){if("getBigUint64"in DataView.prototype)return $.getBigUint64(_e,_t);const Wt=$.getUint32(_e,_t),_n=$.getUint32(_e+4,_t),_i=+!!_t,_s=+!_t;return BigInt(Wt*_s+_n*_i)<<BigInt(32)|BigInt(Wt*_i+_n*_s)}function NH($,_e,_t,Wt){if("setBigUint64"in DataView.prototype)return $.setBigUint64(_e,_t,Wt);const _n=Number(_t>>BigInt(32)),_i=Number(_t&BigInt(4294967295));$.setUint32(_e,_n,Wt),$.setUint32(_e+4,_i,Wt)}var ZN=function($){return $.COVERED="COVERED",$.POSITION="POSITION",$.SIZE="SIZE",$.STYLE="STYLE",$}(ZN||{}),vV=function($){return $.UNMOUNTED="UNMOUNTED",$.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",$}(vV||{});const PH=new class{constructor(){C0(this,"_clientSize",null),C0(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),C0(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),C0(this,"getStyle",$=>window.getComputedStyle($,null)),C0(this,"checkCssVisibleProperty",$=>{var _e;let _t=!0;const Wt=this.getStyle($),{display:_n,visibility:_i,opacity:_s,filter:_c}=Wt;return(_n==="none"||i_(_e=["hidden","collapse"]).call(_e,_i)||Number(_s)<.1)&&(_t=!1),!!_t&&(_c&&_c.split(" ").filter(_u=>{var _h;const _p=_u.split("(")[0];return i_(_h=["brightness","blur","opacity"]).call(_h,_p)}).map(_u=>{const[_h,_p]=_u.split(/\(|\)/);return[_h,Number(_p.match(/^[0-9\.]+/))]}).forEach(_u=>{const[_h,_p]=_u;switch(_h){case"brightness":(_p<.1||_p>3)&&(_t=!1);break;case"blur":_p>3&&(_t=!1);break;case"opacity":_p<.1&&(_t=!1)}}),_t)}),C0(this,"checkPropertyUpToAllParentNodes",($,_e)=>{let _t=!0,Wt=!0;const _n=_s=>_e(_s);let _i=$;for(;_i&&Wt;)_n(_i)||(_t=!1,Wt=!1),_i=_i.parentElement,_i||(Wt=!1);return _t}),C0(this,"checkActualCssVisibleIncludeInherit",$=>this.checkPropertyUpToAllParentNodes($,this.checkCssVisibleProperty)),C0(this,"getSizeAboutClient",$=>{const{width:_e,height:_t,left:Wt,right:_n,top:_i,bottom:_s}=$.getBoundingClientRect(),_c=this.getClientWidth(),_u=this.getClientHeight();return{width:_e,height:_t,left:Wt,right:_n,top:_i,bottom:_s,clientWidth:_c,clientHeight:_u,clientMin:Math.min(_c,_u)}}),C0(this,"checkActualSize",()=>{const{width:$,height:_e,clientMin:_t}=this._clientSize;return this.checkSizeIsVisible($,_e,_t)}),C0(this,"elementFromPoint",($,_e)=>document.elementFromPoint?document.elementFromPoint($,_e):null),C0(this,"checkCoverForAPoint",($,_e,_t)=>{const Wt=this.elementFromPoint($,_e);return Wt!==null&&Wt!==_t}),C0(this,"getPointPositionList",()=>{const{width:$,height:_e,left:_t,top:Wt}=this._clientSize,_n=$/6,_i=_e/6,_s=[],_c=10**6;for(let _u=0;_u<5;_u++)for(let _h=0;_h<5;_h++){const _p=(_t*_c+(_u===0?.1:_u===4?(_n*_u*_c-1e5)/_c:_n*_u)*_c)/_c,Qm=(Wt*_c+(_h===0?.1:_h===4?(_i*_h*_c-1e5)/_c:_i*_h)*_c)/_c;_s.push({x:_p,y:Qm})}return[..._s]}),C0(this,"checkElementCover",$=>this.getPointPositionList().map(_e=>this.checkCoverForAPoint(_e.x,_e.y,$)).filter(_e=>!!_e).length>6),C0(this,"checkSizeIsVisible",($,_e,_t)=>($>50||_t/$<=10)&&(_e>50||_t/_e<=10)),C0(this,"checkSizeOfPartInClient",()=>{const{left:$,right:_e,top:_t,bottom:Wt,clientHeight:_n,clientWidth:_i,clientMin:_s}=this._clientSize;let _c,_u,_h,_p;if($<0)_c=0;else{if(!($<_i))return!1;_c=$}if(_e<0)return!1;if(_u=_e<_i?_e:_i,_t<0)_h=0;else{if(!(_t<_n))return!1;_h=_t}if(Wt<0)return!1;_p=Wt<_n?Wt:_n;const Qm=_u-_c,_g=_p-_h;return this.checkSizeIsVisible(Qm,_g,_s)}),C0(this,"returnHiddenResult",$=>(this._clientSize=null,{visible:!1,reason:$})),C0(this,"checkOneElementVisible",$=>{if($ instanceof HTMLElement){if(this.checkElementIsMountedOnDom($)){if(this.checkActualCssVisibleIncludeInherit($)){if(this._clientSize=this.getSizeAboutClient($),this.checkElementCover($))return this.returnHiddenResult(ZN.COVERED);{const _e=this.checkActualSize(),_t=this.checkSizeOfPartInClient();return _e&&!_t?this.returnHiddenResult(ZN.POSITION):_e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(ZN.SIZE)}}return this.returnHiddenResult(ZN.STYLE)}return this.returnHiddenResult(vV.UNMOUNTED)}return this.returnHiddenResult(vV.INVALID_HTML_ELEMENT)}),C0(this,"checkElementIsMountedOnDom",$=>this.checkPropertyUpToAllParentNodes($,_e=>_e.nodeName.toUpperCase()!=="HTML"?_e.parentElement!==null:!!document.documentElement))}};function _V($){return new TextEncoder().encode($)}const kH=function($,_e){const _t=new Uint8Array($.byteLength+_e.byteLength);return _t.set(new Uint8Array($),0),_t.set(new Uint8Array(_e),$.byteLength),_t},yV=async $=>function(_e,_t){let Wt="";return new Uint8Array(_e).forEach(_n=>{Wt+=_n.toString(_t).padStart(2,"0")}),Wt}(await crypto.subtle.digest("SHA-256",_V($)),16);let A0=class{constructor(){C0(this,"_events",{}),C0(this,"addListener",this.on)}getListeners($){return this._events[$]?this._events[$].map(_e=>_e.listener):[]}on($,_e){this._events[$]||(this._events[$]=[]);const _t=this._events[$];this._indexOfListener(_t,_e)===-1&&_t.push({listener:_e,once:!1})}once($,_e){this._events[$]||(this._events[$]=[]);const _t=this._events[$];this._indexOfListener(_t,_e)===-1&&_t.push({listener:_e,once:!0})}off($,_e){if(!this._events[$])return;const _t=this._events[$],Wt=this._indexOfListener(_t,_e);Wt!==-1&&_t.splice(Wt,1),this._events[$].length===0&&delete this._events[$]}removeAllListeners($){$?delete this._events[$]:this._events={}}emit($){this._events[$]||(this._events[$]=[]);const _e=this._events[$].map(_i=>_i);for(var _t=arguments.length,Wt=new Array(_t>1?_t-1:0),_n=1;_n<_t;_n++)Wt[_n-1]=arguments[_n];for(let _i=0;_i<_e.length;_i+=1){const _s=_e[_i];_s.once&&this.off($,_s.listener),_s.listener.apply(this,Wt||[])}}safeEmit($){for(var _e=arguments.length,_t=new Array(_e>1?_e-1:0),Wt=1;Wt<_e;Wt++)_t[Wt-1]=arguments[Wt];[...this._events[$]||[]].forEach(_n=>{_n.once&&this.off($,_n.listener);try{_n.listener.apply(this,_t)}catch(_i){console.error("safeEmit event:".concat($," error ").concat(_i==null?void 0:_i.toString()))}})}_indexOfListener($,_e){let _t=$.length;for(;_t--;)if($[_t].listener===_e)return _t;return-1}},QN=null;function DH(){if(QN)return QN;if(window.electron)return QN=window.electron;if(!window.require)return null;try{return QN=window.require("electron"),QN}catch{return null}}let Q0=function($){return $.CREATE_CLIENT="createClient",$.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",$.SET_AREA="setArea",$.PRELOAD="PRELOAD",$.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",$.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",$.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",$.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",$.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",$.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",$.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",$.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",$.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",$.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",$.START_PROXY_SERVER="Client.startProxyServer",$.STOP_PROXY_SERVER="Client.stopProxyServer",$.SET_PROXY_SERVER="Client.setProxyServer",$.SET_TURN_SERVER="Client.setTurnServer",$.SET_CLIENT_ROLE="Client.setClientRole",$.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",$.ENABLE_DUAL_STREAM="Client.enableDualStream",$.DISABLE_DUAL_STREAM="Client.disableDualStream",$.JOIN="Client.join",$.LEAVE="Client.leave",$.PUBLISH="Client.publish",$.UNPUBLISH="Client.unpublish",$.SUBSCRIBE="Client.subscribe",$.MASS_SUBSCRIBE="Client.massSubscribe",$.MASS_UNSUBSCRIBE="Client.massUnsubscribe",$.UNSUBSCRIBE="Client.unsubscribe",$.RENEW_TOKEN="Client.renewToken",$.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",$.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",$.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",$.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",$.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",$.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",$.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",$.DATACHANNEL_FAILBACK="Client._datachannelFailback",$.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",$.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",$.START_LIVE_STREAMING="Client.startLiveStreaming",$.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",$.STOP_LIVE_STREAMING="Client.stopLiveStreaming",$.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",$.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",$.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",$.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",$.SET_CONFIG_DISTRIBUTE="_configDistribute",$.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",$.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",$.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",$.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",$.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",$.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",$.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",$.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",$.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",$.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",$.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",$.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",$.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",$.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",$.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",$.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",$.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",$.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",$.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",$.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",$.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",$.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",$.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",$.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",$.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",$.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",$.STREAM_TYPE_CHANGE="streamTypeChange",$.CONNECTION_STATE_CHANGE="connectionStateChange",$.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",$.IMAGE_MODERATION_UPLOAD="imageModerationUpload",$}({}),j0=function($){return $.TRACER="tracer",$}({});function LH($){return u0($.timeout,"config.timeout",0,1e5),u0($.timeoutFactor,"config.timeoutFactor",0,100,!1),u0($.maxRetryCount,"config.maxRetryConfig",0,1/0),u0($.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let nce=function($){return $[$.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",$[$.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",$[$.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",$}({}),U_=function($){return $.LEAVE="LEAVE",$.NETWORK_ERROR="NETWORK_ERROR",$.SERVER_ERROR="SERVER_ERROR",$.UID_BANNED="UID_BANNED",$.IP_BANNED="IP_BANNED",$.CHANNEL_BANNED="CHANNEL_BANNED",$.FALLBACK="FALLBACK",$.LICENSE_MISSING="LICENSE_MISSING",$.LICENSE_EXPIRED="LICENSE_EXPIRED",$.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",$.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",$.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",$.LICENSE_ILLEGAL="LICENSE_ILLEGAL",$.TOKEN_EXPIRE="TOKEN_EXPIRE",$}({});function IO($){if(!Array.isArray($)||$.length<1)return!1;try{$.forEach(_e=>{if(!_e.urls)throw Error()})}catch{return!1}return!0}function xH($){return bS($.turnServerURL,"turnServerURL"),bS($.username,"username"),bS($.password,"password"),$.udpport&&u0($.udpport,"udpport",1,99999,!0),$.forceturn&&E1($.forceturn,"forceturn"),$.security&&E1($.security,"security"),$.tcpport&&u0($.tcpport,"tcpport",1,99999,!0),!0}function MH($){return $.level!==void 0&&aS($.level,"level",[1,2,3]),$.delay!==void 0&&u0($.delay,"delay",0,3e3,!0),!0}let j_=function($){return $.CONNECTION_STATE_CHANGE="connection-state-change",$.MEDIA_RECONNECT_START="media-reconnect-start",$.MEDIA_RECONNECT_END="media-reconnect-end",$.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",$.USER_JOINED="user-joined",$.USER_LEAVED="user-left",$.USER_PUBLISHED="user-published",$.USER_UNPUBLISHED="user-unpublished",$.USER_INFO_UPDATED="user-info-updated",$.CLIENT_BANNED="client-banned",$.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",$.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",$.VOLUME_INDICATOR="volume-indicator",$.CRYPT_ERROR="crypt-error",$.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",$.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",$.NETWORK_QUALITY="network-quality",$.STREAM_TYPE_CHANGED="stream-type-changed",$.STREAM_FALLBACK="stream-fallback",$.RECEIVE_METADATA="receive-metadata",$.STREAM_MESSAGE="stream-message",$.LIVE_STREAMING_ERROR="live-streaming-error",$.LIVE_STREAMING_WARNING="live-streaming-warning",$.INJECT_STREAM_STATUS="stream-inject-status",$.EXCEPTION="exception",$.ERROR="error",$.P2P_LOST="p2p_lost",$.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",$.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",$.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",$.PUBLISHED_USER_LIST="published-user-list",$.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",$.CONTENT_INSPECT_ERROR="content-inspect-error",$.CONTENT_INSPECT_RESULT="content-inspect-result",$.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",$}({}),RS=function($){return $.NETWORK_ERROR="NETWORK_ERROR",$.SERVER_ERROR="SERVER_ERROR",$.MULTI_IP="MULTI_IP",$.TIMEOUT="TIMEOUT",$.OFFLINE="OFFLINE",$.LEAVE="LEAVE",$.P2P_FAILED="P2P_FAILED",$.FALLBACK="FALLBACK",$}({}),KS=function($){return $.ONLINE="ONLINE",$.OFFLINE="OFFLINE",$}({}),AI=function($){return $.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",$.ONLINE="ONLINE",$.OFFLINE="OFFLINE",$}({});function _y($,_e){for(var _t=arguments.length,Wt=new Array(_t>2?_t-2:0),_n=2;_n<_t;_n++)Wt[_n-2]=arguments[_n];return $.getListeners(_e).length===0?n_.reject(new HE(mE.UNEXPECTED_ERROR,"can not emit promise")):new n_((_i,_s)=>{$.emit(_e,...Wt,_i,_s)})}function p0($,_e){if($.getListeners(_e).length===0)return n_.resolve();for(var _t=arguments.length,Wt=new Array(_t>2?_t-2:0),_n=2;_n<_t;_n++)Wt[_n-2]=arguments[_n];return _y($,_e,...Wt)}function mT($,_e){if($.getListeners(_e).length===0)return null;for(var _t=arguments.length,Wt=new Array(_t>2?_t-2:0),_n=2;_n<_t;_n++)Wt[_n-2]=arguments[_n];return OI($,_e,...Wt)}function OI($,_e){let _t=null,Wt=null;for(var _n=arguments.length,_i=new Array(_n>2?_n-2:0),_s=2;_s<_n;_s++)_i[_s-2]=arguments[_s];if($.emit(_e,..._i,_c=>{_t=_c},_c=>{Wt=_c}),Wt!==null)throw Wt;if(_t===null)throw new HE(mE.UNEXPECTED_ERROR,"handler is not sync");return _t}const F0=new class extends A0{set networkState($){this.emit(AI.NETWORK_STATE_CHANGE,$,this._networkState),$===KS.ONLINE?this.emit(AI.ONLINE):$===KS.OFFLINE&&(this.onlineWaiter=new n_(_e=>{this.once(AI.ONLINE,()=>{this.onlineWaiter=void 0,_e(KS.ONLINE)})}),this.emit(AI.OFFLINE)),this._networkState=$}get networkState(){return this._networkState}get isOnline(){return this._networkState===KS.ONLINE}constructor(){super(),C0(this,"_moduleName","network-indicator"),C0(this,"_networkState",KS.ONLINE),C0(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=KS.ONLINE}),window.addEventListener("offline",()=>{this.networkState=KS.OFFLINE})}};function bL($,_e){const _t=$.indexOf(_e);_t!==-1&&$.splice(_t,1)}function AO($){const _e=[];return $.forEach(_t=>{_e.indexOf(_t)===-1&&_e.push(_t)}),_e}function SL($){n_!==void 0?n_.resolve().then($):setTimeout($,0)}function b0($){return JSON.parse(JSON.stringify($))}function NI($){try{return b0($)}catch{return $}}const UH={};function q1($,_e){UH[_e]||(UH[_e]=!0,$())}function PI($){const _e=window.atob($),_t=new Uint8Array(new ArrayBuffer(_e.length));for(let Wt=0;Wt<_e.length;Wt+=1)_t[Wt]=_e.charCodeAt(Wt);return _t}function z1($){let _e="";for(let _t=0;_t<$.length;_t+=1)_e+=String.fromCharCode($[_t]);return window.btoa(_e)}function jH($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,_t=new TextEncoder().encode($);if(_t.length>_e)_t=_t.slice(0,_e);else if(_t.length<_e){const Wt=new Uint8Array(_e);Wt.set(_t),_t=Wt}return _t}function FH(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=wR(_e).call(_e,(_s,_c)=>_s+_c.length,0),_n=new Uint8Array(new ArrayBuffer(Wt));let _i=0;return _e.forEach(_s=>{_n.set(_s,_i),_i+=_s.length}),_n}function XR($){return window.TextEncoder?new TextEncoder().encode($).length:$.length}function VH($){let _e=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&$.realFormData&&($=$.realFormData),$.forEach(_t=>{_e+=typeof _t=="string"?XR(_t):_t.size}),_e+138}function rce($){const _e=new HE(mE.TIMEOUT,"timeout");return new n_((_t,Wt)=>{window.setTimeout(()=>Wt(_e),$)})}function hS($){return new n_(_e=>{window.setTimeout(_e,$)})}function f0(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,_e=arguments.length>1?arguments[1]:void 0;const _t=Math.random().toString(16).substr(2,$).toLowerCase();return _t.length===$?"".concat(_e).concat(_t):"".concat(_e).concat(_t)+f0($-_t.length,"")}function eP(){return f0(32,"").toUpperCase()}const TL=()=>{},BH=new class{constructor(){C0(this,"fnMap",new Map)}throttleByKey($,_e,_t,Wt){for(var _n=arguments.length,_i=new Array(_n>4?_n-4:0),_s=4;_s<_n;_s++)_i[_s-4]=arguments[_s];if(this.fnMap.has(_e)){const _c=this.fnMap.get(_e);if(_c.threshold!==_t){_c.fn(..._c.args),clearTimeout(_c.timer);const _u=window.setTimeout(()=>{const _h=this.fnMap.get(_e);_h&&_h.fn(..._h.args),this.fnMap.delete(_e)},_t);this.fnMap.set(_e,{fn:$,threshold:_t,timer:_u,args:_i,skipFn:Wt})}else _c.skipFn&&_c.skipFn(..._c.args),this.fnMap.set(_e,f_(f_({},_c),{},{fn:$,args:_i,skipFn:Wt}))}else{const _c=window.setTimeout(()=>{const _u=this.fnMap.get(_e);_u&&_u.fn(..._u.args),this.fnMap.delete(_e)},_t);this.fnMap.set(_e,{fn:$,threshold:_t,timer:_c,args:_i,skipFn:Wt})}}},GH=BH.throttleByKey.bind(BH);function HH($){return typeof $=="object"&&$!==null&&!($ instanceof RegExp)}function bV($,_e){if(!HH($)||!HH(_e)||Array.isArray($)&&!Array.isArray(_e)||!Array.isArray($)&&Array.isArray(_e))return _e;if(Array.isArray(_e)&&Array.isArray($)){const _t=[...$];for(let Wt=0;Wt<_e.length;Wt++)_t[Wt]=bV($[Wt],_e[Wt]);return _t}{const _t=f_({},$);for(const Wt in _e)Object.prototype.hasOwnProperty.call(_e,Wt)&&(Object.prototype.hasOwnProperty.call($,Wt)?_t[Wt]=bV($[Wt],_e[Wt]):_t[Wt]=_e[Wt]);return _t}}function WH($,_e){let _t=[0];if(_t=new Array(_e).fill(0),$===0)return _t;let Wt=0;for(;$>0&&(_t[Wt]=255&$,$>>=8,Wt++,Wt!==_e););return _t}function SV($){return typeof $=="number"?$:$.exact||$.ideal||$.max||$.min||0}function qH($){const _e="0123456789abcdef";function _t(AE){let PE,xE="";for(PE=0;PE<=3;PE++)xE+=_e.charAt(AE>>8*PE+4&15)+_e.charAt(AE>>8*PE&15);return xE}function Wt(AE,PE){const xE=(65535&AE)+(65535&PE);return(AE>>16)+(PE>>16)+(xE>>16)<<16|65535&xE}function _n(AE,PE,xE,GE,zE,KE){return Wt(function(JE,c_){return JE<<c_|JE>>>32-c_}(Wt(Wt(PE,AE),Wt(GE,KE)),zE),xE)}function _i(AE,PE,xE,GE,zE,KE,JE){return _n(PE&xE|~PE&GE,AE,PE,zE,KE,JE)}function _s(AE,PE,xE,GE,zE,KE,JE){return _n(PE&GE|xE&~GE,AE,PE,zE,KE,JE)}function _c(AE,PE,xE,GE,zE,KE,JE){return _n(PE^xE^GE,AE,PE,zE,KE,JE)}function _u(AE,PE,xE,GE,zE,KE,JE){return _n(xE^(PE|~GE),AE,PE,zE,KE,JE)}const _h=function(AE){let PE;const xE=1+(AE.length+8>>6),GE=new Array(16*xE);for(PE=0;PE<16*xE;PE++)GE[PE]=0;for(PE=0;PE<AE.length;PE++)GE[PE>>2]|=AE.charCodeAt(PE)<<PE%4*8;return GE[PE>>2]|=128<<PE%4*8,GE[16*xE-2]=8*AE.length,GE}($);let _p,Qm,_g,eE,pE,aE=1732584193,cE=-271733879,fE=-1732584194,gE=271733878;for(_p=0;_p<_h.length;_p+=16)Qm=aE,_g=cE,eE=fE,pE=gE,aE=_i(aE,cE,fE,gE,_h[_p+0],7,-680876936),gE=_i(gE,aE,cE,fE,_h[_p+1],12,-389564586),fE=_i(fE,gE,aE,cE,_h[_p+2],17,606105819),cE=_i(cE,fE,gE,aE,_h[_p+3],22,-1044525330),aE=_i(aE,cE,fE,gE,_h[_p+4],7,-176418897),gE=_i(gE,aE,cE,fE,_h[_p+5],12,1200080426),fE=_i(fE,gE,aE,cE,_h[_p+6],17,-1473231341),cE=_i(cE,fE,gE,aE,_h[_p+7],22,-45705983),aE=_i(aE,cE,fE,gE,_h[_p+8],7,1770035416),gE=_i(gE,aE,cE,fE,_h[_p+9],12,-1958414417),fE=_i(fE,gE,aE,cE,_h[_p+10],17,-42063),cE=_i(cE,fE,gE,aE,_h[_p+11],22,-1990404162),aE=_i(aE,cE,fE,gE,_h[_p+12],7,1804603682),gE=_i(gE,aE,cE,fE,_h[_p+13],12,-40341101),fE=_i(fE,gE,aE,cE,_h[_p+14],17,-1502002290),cE=_i(cE,fE,gE,aE,_h[_p+15],22,1236535329),aE=_s(aE,cE,fE,gE,_h[_p+1],5,-165796510),gE=_s(gE,aE,cE,fE,_h[_p+6],9,-1069501632),fE=_s(fE,gE,aE,cE,_h[_p+11],14,643717713),cE=_s(cE,fE,gE,aE,_h[_p+0],20,-373897302),aE=_s(aE,cE,fE,gE,_h[_p+5],5,-701558691),gE=_s(gE,aE,cE,fE,_h[_p+10],9,38016083),fE=_s(fE,gE,aE,cE,_h[_p+15],14,-660478335),cE=_s(cE,fE,gE,aE,_h[_p+4],20,-405537848),aE=_s(aE,cE,fE,gE,_h[_p+9],5,568446438),gE=_s(gE,aE,cE,fE,_h[_p+14],9,-1019803690),fE=_s(fE,gE,aE,cE,_h[_p+3],14,-187363961),cE=_s(cE,fE,gE,aE,_h[_p+8],20,1163531501),aE=_s(aE,cE,fE,gE,_h[_p+13],5,-1444681467),gE=_s(gE,aE,cE,fE,_h[_p+2],9,-51403784),fE=_s(fE,gE,aE,cE,_h[_p+7],14,1735328473),cE=_s(cE,fE,gE,aE,_h[_p+12],20,-1926607734),aE=_c(aE,cE,fE,gE,_h[_p+5],4,-378558),gE=_c(gE,aE,cE,fE,_h[_p+8],11,-2022574463),fE=_c(fE,gE,aE,cE,_h[_p+11],16,1839030562),cE=_c(cE,fE,gE,aE,_h[_p+14],23,-35309556),aE=_c(aE,cE,fE,gE,_h[_p+1],4,-1530992060),gE=_c(gE,aE,cE,fE,_h[_p+4],11,1272893353),fE=_c(fE,gE,aE,cE,_h[_p+7],16,-155497632),cE=_c(cE,fE,gE,aE,_h[_p+10],23,-1094730640),aE=_c(aE,cE,fE,gE,_h[_p+13],4,681279174),gE=_c(gE,aE,cE,fE,_h[_p+0],11,-358537222),fE=_c(fE,gE,aE,cE,_h[_p+3],16,-722521979),cE=_c(cE,fE,gE,aE,_h[_p+6],23,76029189),aE=_c(aE,cE,fE,gE,_h[_p+9],4,-640364487),gE=_c(gE,aE,cE,fE,_h[_p+12],11,-421815835),fE=_c(fE,gE,aE,cE,_h[_p+15],16,530742520),cE=_c(cE,fE,gE,aE,_h[_p+2],23,-995338651),aE=_u(aE,cE,fE,gE,_h[_p+0],6,-198630844),gE=_u(gE,aE,cE,fE,_h[_p+7],10,1126891415),fE=_u(fE,gE,aE,cE,_h[_p+14],15,-1416354905),cE=_u(cE,fE,gE,aE,_h[_p+5],21,-57434055),aE=_u(aE,cE,fE,gE,_h[_p+12],6,1700485571),gE=_u(gE,aE,cE,fE,_h[_p+3],10,-1894986606),fE=_u(fE,gE,aE,cE,_h[_p+10],15,-1051523),cE=_u(cE,fE,gE,aE,_h[_p+1],21,-2054922799),aE=_u(aE,cE,fE,gE,_h[_p+8],6,1873313359),gE=_u(gE,aE,cE,fE,_h[_p+15],10,-30611744),fE=_u(fE,gE,aE,cE,_h[_p+6],15,-1560198380),cE=_u(cE,fE,gE,aE,_h[_p+13],21,1309151649),aE=_u(aE,cE,fE,gE,_h[_p+4],6,-145523070),gE=_u(gE,aE,cE,fE,_h[_p+11],10,-1120210379),fE=_u(fE,gE,aE,cE,_h[_p+2],15,718787259),cE=_u(cE,fE,gE,aE,_h[_p+9],21,-343485551),aE=Wt(aE,Qm),cE=Wt(cE,_g),fE=Wt(fE,eE),gE=Wt(gE,pE);return _t(aE)+_t(cE)+_t(fE)+_t(gE)}let ice=1,wL=console,mS=class{static setLogger($){wL=$}constructor($){C0(this,"lockingPromise",n_.resolve()),C0(this,"locks",0),C0(this,"name",""),C0(this,"lockId",void 0),this.lockId=ice++,$&&(this.name=$),wL.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock($){let _e;this.locks+=1,wL.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof $=="string"?$:""));const _t=new n_(_n=>{_e=()=>{this.locks-=1,wL.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof $=="string"?$:"")),_n()}}),Wt=this.lockingPromise.then(()=>_e);return this.lockingPromise=this.lockingPromise.then(()=>_t),Wt}};function OO($,_e){return function(_t,Wt,_n){const _i=_n.value;if(typeof _i!="function")throw new Error("Cannot use mutex on object property.");return _n.value=async function(){const _s=this[_e];if(!_s)throw new Error("mutex property key ".concat(_e," doesn't exist on ").concat($));const _c=await _s.lock("From ".concat($,".").concat(Wt));try{for(var _u=arguments.length,_h=new Array(_u),_p=0;_p<_u;_p++)_h[_p]=arguments[_p];return await _i.apply(this,_h)}finally{_c()}},_n}}const Y0={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function RL($,_e){const _t=Math.floor(_e.timeout*Math.pow(_e.timeoutFactor,$));return Math.min(_e.maxRetryTimeout,_t)}function IR($,_e,_t,Wt){const _n=Object.assign({},Y0,Wt);let _i=_n.timeout;const _s=async()=>{await function(_h){return new n_(_p=>{window.setTimeout(_p,_h)})}(_i),_i*=_n.timeoutFactor,_i=Math.min(_n.maxRetryTimeout,_i)};let _c=!1;const _u=new n_(async(_h,_p)=>{_e=_e||(()=>!1),_t=_t||(()=>!0);for(let Qm=0;Qm<_n.maxRetryCount;Qm+=1){if(_c)return _p(new HE(mE.OPERATION_ABORTED));try{const _g=await $();if(!_e(_g,Qm)||Qm+1===_n.maxRetryCount)return _h(_g);await _s()}catch(_g){if(!_t(_g,Qm)||Qm+1===_n.maxRetryCount)return _p(_g);await _s()}}});return _u.cancel=()=>_c=!0,_u}class TV{constructor(_e){C0(this,"input",[]),C0(this,"size",void 0),this.size=_e}add(_e){this.input.push(_e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var _e;return this.input.length===0?0:wR(_e=this.input).call(_e,(_t,Wt)=>_t+Wt)/this.input.length}}let CL,IL=0,wV=0;function RV($,_e,_t,Wt){return new n_((_n,_i)=>{_e.responseType=_e.responseType||"json",_e.data&&!_t?(_e.data=JSON.stringify(_e.data),IL+=XR(_e.data)):_t&&(_e.data.size?IL+=_e.data.size:_e.data instanceof FormData?IL+=VH(_e.data):IL+=XR(JSON.stringify(_e.data))),_e.headers=_e.headers||{},_e.headers["Content-Type"]=_e.headers["Content-Type"]||"application/json",_e.method="POST",_e.url=$,tT.request(_e).then(_s=>{typeof _s.data=="string"?wV+=XR(_s.data):_s.data instanceof ArrayBuffer||_s.data instanceof Uint8Array?wV+=_s.data.byteLength:wV+=XR(JSON.stringify(_s.data)),_n(_s.data)}).catch(_s=>{tT.isCancel(_s)?_i(new HE(mE.OPERATION_ABORTED,"cancel token canceled")):_s.code==="ECONNABORTED"?_i(new HE(mE.NETWORK_TIMEOUT,_s.message)):_s.response?_i(new HE(mE.NETWORK_RESPONSE_ERROR,_s.response.status)):_i(new HE(mE.NETWORK_ERROR,_s.message))})})}async function oce($,_e){const _t=new Blob([_e.data],{type:"buffer"});return await RV($,f_(f_({},_e),{},{data:_t,headers:{"Content-Type":"application/octet-stream"}}),!0)}const zH=()=>window.isSecureContext!==void 0,jT=function($){if($.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return $;const _e=$.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(_e&&_e[1]&&_e[2]){const Wt=_e[1],_n=_e[2];return"".concat(Wt,".").concat(_n)}const _t=$.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(_t&&_t[1]&&_t[2]){const Wt=_t[1],_n=_t[2];return"".concat(Wt,".").concat(100*(Number(_n)+1))}return"4.0.0.999"}("4.21.0"),CV=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let kI=function($){return $.Default="default",$.Auto="auto",$.Relay="relay",$.SdRtn="sd-rtn",$}({});const IV={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},AV="v4.21.0-0-g16fdae2c-dirty(6/3/2024, 2:55:18 PM)",nS={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!0,USE_SUB_RTX:!0,USE_XR:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:void 0,ENABLE_CC_FALLBACK:void 0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:IV,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,CUSTOM_ADAPTATION_DEFAULT_MODE:"",ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,ENABLE_PRELOAD:!0};function d0($,_e,_t){var Wt,_n,_i;i_(Wt=Object.keys(nS)).call(Wt,$)&&(!_t&&i_(_n=Object.keys(K1)).call(_n,$)||(nS[$]=_e,$==="ENABLE_VIDEO_SEI"&&_e===!0&&(nS.ENABLE_ENCODED_TRANSFORM=!0),$==="USE_NEW_NETWORK_CONFIG"&&_e&&(_i=!!_e,nS.USE_NEW_NETWORK_CONFIG=_i,_i&&(nS.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],nS.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],nS.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],nS.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],nS.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",nS.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",nS.GATEWAY_DOMAINS=["edge.sd-rtn.com"]))))}function yE($){return nS[$]}const K1={};var x_=function($){return $.SET_SESSION_ID="SET_SESSION_ID",$.SET_P2P_ID="SET_P2P_id",$.SET_DC_ID="SET_DC_id",$.SET_UID="SET_UID",$.SET_INT_UID="SET_INT_UID",$.SET_PUB_ID="SET_PUB_ID",$.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",$.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",$.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",$.AVOID_JOIN_START="AVOID_JOIN_START",$.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",$.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",$.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",$.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",$.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",$.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",$.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",$.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",$.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",$.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",$.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",$.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",$.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",$.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",$.RESET_KEY_METRICS="RESET_KEY_METRICS",$.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",$.SET_USE_P2P="SET_USE_P2P",$.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",$}(x_||{});class sce{constructor(_e,_t,Wt,_n){C0(this,"state",void 0),this.state={codec:_e,audioCodec:_t,mode:Wt,clientId:_n,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1,p2pTransport:kI.Default}}dispatch(_e){this.state=function(_t,Wt){switch(Wt.type){case x_.SET_SESSION_ID:return f_(f_({},_t),{},{sessionId:Wt.sessionId});case x_.SET_P2P_ID:return f_(f_({},_t),{},{p2pId:Wt.p2pId});case x_.SET_UID:return f_(f_({},_t),{},{uid:Wt.uid});case x_.SET_INT_UID:return f_(f_({},_t),{},{intUid:Wt.intUid});case x_.SET_PUB_ID:return f_(f_({},_t),{},{pubId:Wt.pubId});case x_.KEY_METRIC_CLIENT_CREATED:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{clientCreated:Wt.metric})});case x_.KEY_METRIC_JOIN_START:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{joinStart:Wt.metric})});case x_.AVOID_JOIN_START:return f_(f_({},_t),{},{avoidJoinStart:Wt.avoidJoinStart});case x_.KEY_METRIC_JOIN_END:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{joinEnd:Wt.metric})});case x_.KEY_METRIC_REQUEST_AP_START:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{requestAPStart:Wt.metric})});case x_.KEY_METRIC_REQUEST_AP_END:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{requestAPEnd:Wt.metric})});case x_.KEY_METRIC_JOIN_GATEWAY_START:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{joinGatewayStart:Wt.metric})});case x_.KEY_METRIC_JOIN_GATEWAY_END:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{joinGatewayEnd:Wt.metric})});case x_.KEY_METRIC_PEER_CONNECTION_START:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{peerConnectionStart:Wt.metric})});case x_.KEY_METRIC_PEER_CONNECTION_END:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{peerConnectionEnd:Wt.metric})});case x_.KEY_METRIC_DESCRIPTION_START:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{descriptionStart:Wt.metric})});case x_.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{signalChannelOpen:Wt.metric})});case x_.KEY_METRIC_ICE_CONNECTION_END:return f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{iceConnectionEnd:Wt.metric})});case x_.KEY_METRIC_PUBLISH:{const _n=_t.keyMetrics.publish,_i=_n.findIndex(_s=>_s.trackId===Wt.metric.trackId);return _i!==-1?(_n[_i]=f_(f_({},_n[_i]),Wt.metric),f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{publish:[..._n]})})):f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{publish:[..._t.keyMetrics.publish,Wt.metric]})})}case x_.KEY_METRIC_SUBSCRIBE:{const _n=_t.keyMetrics.subscribe,_i=_n.findIndex(_s=>_s.userId===Wt.metric.userId&&_s.type===Wt.metric.type);return _i!==-1?(_n[_i]=f_(f_({},_n[_i]),Wt.metric),f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{subscribe:[..._n]})})):f_(f_({},_t),{},{keyMetrics:f_(f_({},_t.keyMetrics),{},{subscribe:[..._t.keyMetrics.subscribe,Wt.metric]})})}case x_.SET_CLOUD_PROXY_SERVER_MODE:return _t.cloudProxyServerMode=Wt.mode,_t;case x_.RECORD_JOIN_CHANNEL_SERVICE:return typeof Wt.index!="number"?_t.joinChannelServiceRecords=[..._t.joinChannelServiceRecords,Wt.record]:(_t.joinChannelServiceRecords[Wt.index]=f_(f_({},_t.joinChannelServiceRecords[Wt.index]),Wt.record),_t.joinChannelServiceRecords=[..._t.joinChannelServiceRecords]),_t;case x_.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return _t.joinChannelServiceRecords=[],_t;case x_.RESET_KEY_METRICS:return _t.keyMetrics={publish:[],subscribe:[]},_t;case x_.SET_USE_DATACHANNEL:return f_(f_({},_t),{},{useDataChannel:Wt.val});case x_.SET_USE_P2P:return f_(f_({},_t),{},{useP2P:Wt.val});case x_.SET_TRANSPORT_TYPE:return f_(f_({},_t),{},{p2pTransport:Wt.val});default:return _t}}(this.state,_e)}set sessionId(_e){this.dispatch({type:x_.SET_SESSION_ID,sessionId:_e})}get sessionId(){return this.state.sessionId}set codec(_e){this.state.codec=_e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(_e){this.dispatch({type:x_.SET_P2P_ID,p2pId:_e})}get p2pId(){return this.state.p2pId}set dcId(_e){this.dispatch({type:x_.SET_DC_ID,dcId:_e})}get dcId(){return this.state.dcId}set uid(_e){this.dispatch({type:x_.SET_UID,uid:_e})}get uid(){return this.state.uid}set intUid(_e){this.dispatch({type:x_.SET_INT_UID,intUid:_e})}get intUid(){return this.state.intUid}set pubId(_e){this.dispatch({type:x_.SET_PUB_ID,pubId:_e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(_e){this.dispatch({type:x_.SET_CLOUD_PROXY_SERVER_MODE,mode:_e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(_e){this.dispatch({type:x_.SET_USE_DATACHANNEL,val:_e})}get useDataChannel(){return this.state.useDataChannel}set useP2P(_e){this.dispatch({type:x_.SET_USE_P2P,val:_e})}get useP2P(){return this.state.useP2P}set p2pTransport(_e){this.dispatch({type:x_.SET_TRANSPORT_TYPE,val:_e})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:x_.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:x_.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:x_.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:x_.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:x_.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:x_.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:x_.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:x_.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:x_.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:x_.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:x_.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:x_.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(_e,_t,Wt,_n){this.dispatch({type:x_.KEY_METRIC_PUBLISH,metric:f_(f_({trackId:_e,type:_t},Wt&&{publishStart:Wt}),_n&&{publishEnd:_n})})}subscribe(_e,_t,Wt,_n,_i,_s,_c){this.dispatch({type:x_.KEY_METRIC_SUBSCRIBE,metric:f_(f_(f_(f_(f_({userId:_e,type:_t},Wt&&{subscribeStart:Wt}),_n&&{subscribeEnd:_n}),_i&&{firstFrame:_i}),_s&&{streamAdded:_s}),_c&&{firstDecoded:_c})})}massSubscribe(_e,_t,Wt,_n){_e.forEach(_i=>{this.dispatch({type:x_.KEY_METRIC_SUBSCRIBE,metric:f_(f_(f_({userId:_i.userId,type:_i.type},_t&&{subscribeStart:_t}),Wt&&{subscribeEnd:Wt}),_n&&{firstFrame:_n})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(_e,_t){_e.service==="gateway"&&Array.isArray(_e.urls)&&(_e.urls=_e.urls.map(Wt=>Wt.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof _t!="number"?(this.dispatch({type:x_.RECORD_JOIN_CHANNEL_SERVICE,record:f_(f_({},_e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(_t<0||_t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:x_.RECORD_JOIN_CHANNEL_SERVICE,record:_e,index:_t}),_t)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:x_.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:x_.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(_e){this.dispatch({type:x_.AVOID_JOIN_START,avoidJoinStart:_e})}}let NO=function($){return $.h264="h264",$.h265="h265",$.vp8="vp8",$.vp9="vp9",$.av1="av1",$}({});(function($){$.opus="opus",$.pcma="pcma",$.pcmu="pcmu",$.g722="g722"})({});const KH=128,ace=96,$H=1e3,PO=10;let cce=0;function YH($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function P_($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?YH(Object(_t),!0).forEach(function(Wt){G0($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):YH(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function G0($,_e,_t){return(_e=function(Wt){var _n=function(_i,_s){if(typeof _i!="object"||_i===null)return _i;var _c=_i[Symbol.toPrimitive];if(_c!==void 0){var _u=_c.call(_i,"string");if(typeof _u!="object")return _u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_i)}(Wt);return typeof _n=="symbol"?_n:String(_n)}(_e))in $?Object.defineProperty($,_e,{value:_t,enumerable:!0,configurable:!0,writable:!0}):$[_e]=_t,$}const JH=new class extends A0{constructor(){super(...arguments),G0(this,"currentUploadLogID",0)}reportLogUploadError($){const{errorRange:_e}=$;_e[_e.length-1]&&_e[_e.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=_e[_e.length-1],this.emit("REPORT_LOG_UPLOAD",$))}};class lce{constructor(_e){G0(this,"logger",void 0),G0(this,"prefixLists",[]),this.logger=_e}debug(){for(var _e=arguments.length,_t=new Array(_e),Wt=0;Wt<_e;Wt++)_t[Wt]=arguments[Wt];this.logger.debug(...this.prefixLists,..._t)}info(){for(var _e=arguments.length,_t=new Array(_e),Wt=0;Wt<_e;Wt++)_t[Wt]=arguments[Wt];this.logger.info(...this.prefixLists,..._t)}warning(){for(var _e=arguments.length,_t=new Array(_e),Wt=0;Wt<_e;Wt++)_t[Wt]=arguments[Wt];this.logger.warning(...this.prefixLists,..._t)}error(){for(var _e=arguments.length,_t=new Array(_e),Wt=0;Wt<_e;Wt++)_t[Wt]=arguments[Wt];this.logger.error(...this.prefixLists,..._t)}prefix(_e){return this.prefixLists.push(_e),this}popPrefix(){return this.prefixLists.pop(),this}}function OV(){const $=new Date;return $.toTimeString().split(" ")[0]+":"+$.getMilliseconds()}function XH(){const $=new Date,_e=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return _e?(_e==null?void 0:_e[0])+":"+$.getUTCMilliseconds():$.toTimeString().split(" ")[0]+":"+$.getMilliseconds()}const FT={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},AL=Date.now(),tP=$=>{for(const _e in FT)if(Object.prototype.hasOwnProperty.call(FT,_e)&&FT[_e]===$)return _e;return"DEFAULT"},iE=new class{constructor(){G0(this,"proxyServerURL",void 0),G0(this,"logLevel",FT.DEBUG),G0(this,"uploadState","collecting"),G0(this,"uploadLogWaitingList",[]),G0(this,"uploadLogUploadingList",[]),G0(this,"uploadErrorCount",0),G0(this,"currentLogID",0),G0(this,"url",void 0),G0(this,"extLog",($,_e)=>{this.appendLogToWaitingList($,..._e)})}debug(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=[FT.DEBUG].concat(_e);this.log.apply(this,Wt)}info(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=[FT.INFO].concat(_e);this.log.apply(this,Wt)}warning(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=[FT.WARNING].concat(_e);this.log.apply(this,Wt)}warn(){this.warning(...arguments)}error(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=[FT.ERROR].concat(_e);this.log.apply(this,Wt)}upload(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];const Wt=[FT.DEBUG].concat(_e);this.uploadLog.apply(this,Wt)}setLogLevel($){$=Math.min(Math.max(0,$),4),this.logLevel=$}enableLogUpload(){d0("UPLOAD_LOG",!0)}disableLogUpload(){d0("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer($){this.proxyServerURL=$}prefix($){return new lce(this).prefix($)}log(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];if(Date.now()-AL<100)return void setTimeout(()=>{this.log(..._e)},Date.now()-AL);const Wt=Math.max(0,Math.min(4,_e[0]));if(_e[0]=OV()+" Agora-SDK [".concat(tP(Wt),"]:"),this.appendLogToWaitingList(Wt,..._e),Wt<this.logLevel)return;const _n=OV()+" %cAgora-SDK [".concat(tP(Wt),"]:");let _i=[];if(!yE("USE_NEW_LOG"))switch(Wt){case FT.DEBUG:_i=[_n,"color: #64B5F6;"].concat(_e.slice(1)),console.log.apply(console,_i);break;case FT.INFO:_i=[_n,"color: #1E88E5; font-weight: bold;"].concat(_e.slice(1)),console.log.apply(console,_i);break;case FT.WARNING:_i=[_n,"color: #FB8C00; font-weight: bold;"].concat(_e.slice(1)),console.warn.apply(console,_i);break;case FT.ERROR:_i=[_n,"color: #B00020; font-weight: bold;"].concat(_e.slice(1)),console.error.apply(console,_i)}}uploadLog(){for(var $=arguments.length,_e=new Array($),_t=0;_t<$;_t++)_e[_t]=arguments[_t];if(Date.now()-AL<100)return void setTimeout(()=>{this.uploadLog(..._e)},Date.now()-AL);const Wt=Math.max(0,Math.min(4,_e[0]));_e[0]=OV()+" Agora-SDK [".concat(tP(Wt),"]:"),this.appendLogToWaitingList(Wt,..._e)}appendLogToWaitingList($){if(!yE("UPLOAD_LOG"))return;for(var _e=arguments.length,_t=new Array(_e>1?_e-1:0),Wt=1;Wt<_e;Wt++)_t[Wt-1]=arguments[Wt];Array.isArray(_t[0])?_t[0][0]=XH()+" Agora-SDK [".concat(tP($),"]:"):_t[0]=XH()+" Agora-SDK [".concat(tP($),"]:");let _n="";_t.forEach(_i=>{typeof _i=="object"&&(_i=JSON.stringify(_i)),_n+="".concat(_i," ")}),this.uploadLogWaitingList.push({payload_str:_n,log_level:$,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const $=this.uploadLogUploadingList,_e={sdk_version:jT,process_id:yE("PROCESS_ID"),payload:JSON.stringify($)};return IR(async()=>{const _t=await tT.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(yE("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(yE("LOG_UPLOAD_SERVER"),"/upload/v1")),_e,{responseType:"text"});if(_t.data!=="OK"){const Wt=new Error("unexpected upload log response");throw Wt.response=_t,Wt}},()=>(this.uploadLogUploadingList=[],!1),_t=>{const Wt={status:-1,message:_t.message,errorRange:$.map(_n=>_n.log_item_id)};return _t.response?(Wt.status=_t.response.status,Wt.data=_t.response.data,Wt.headers=_t.response.headers):_t.request&&(Wt.status=_t.request.status),JH.reportLogUploadError(Wt),!0},{timeout:yE("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:yE("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,yE("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),yE("UPLOAD_LOG_INTERVAL"))}).catch($=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),yE("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),yE("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var ZH;function uce($){return bS($.reportId,"params.reportId",0,100,!1),bS($.category,"params.category",0,100,!1),bS($.event,"params.event",0,100,!1),bS($.label,"params.label",0,100,!1),u0($.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(ZH={}).FREE="free",ZH.UPLOADING="uploading",function($){$[$.MISC=0]="MISC",$[$.INTERNAL_EVENT=1]="INTERNAL_EVENT",$[$.PUBLIC_EVENT=2]="PUBLIC_EVENT",$[$.WEB_EVENT=3]="WEB_EVENT",$[$.INTERNAL_API=4]="INTERNAL_API",$[$.WEB_API=5]="WEB_API",$[$.PUBLIC_API=6]="PUBLIC_API"}({});const dce={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let gS=function($){return $.PUBLISH="publish",$.SUBSCRIBE="subscribe",$.WS_COMPRESSOR_INIT="ws_compressor_init",$.SESSION_INIT="session_init",$.JOIN_CHOOSE_SERVER="join_choose_server",$.REQ_USER_ACCOUNT="req_user_account",$.JOIN_GATEWAY="join_gateway",$.REJOIN_GATEWAY="rejoin_gateway",$.STREAM_SWITCH="stream_switch",$.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",$.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",$.FIRST_VIDEO_RECEIVED="first_video_received",$.FIRST_AUDIO_RECEIVED="first_audio_received",$.FIRST_VIDEO_DECODE="first_video_decode",$.FIRST_AUDIO_DECODE="first_audio_decode",$.ON_ADD_AUDIO_STREAM="on_add_audio_stream",$.ON_ADD_VIDEO_STREAM="on_add_video_stream",$.ON_UPDATE_STREAM="on_update_stream",$.ON_REMOVE_STREAM="on_remove_stream",$.USER_ANALYTICS="req_user_analytics",$.PC_STATS="pc_stats",$.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",$}({}),L0=function($){return $.SESSION="io.agora.pb.Wrtc.Session",$.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",$.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",$.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",$.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",$.PUBLISH="io.agora.pb.Wrtc.Publish",$.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",$.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",$.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",$.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",$.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",$.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",$.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",$.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",$.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",$.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",$.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",$.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",$.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",$.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",$.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",$.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",$.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",$.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",$.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",$.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",$.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",$.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",$.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",$.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",$.PC_STATS="io.agora.pb.Wrtc.PCStats",$.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",$}({});(function($){$[$.WORKER_EVENT=156]="WORKER_EVENT",$[$.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({}),function($){$[$.SESSION=26]="SESSION",$[$.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",$[$.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",$[$.JOIN_GATEWAY=28]="JOIN_GATEWAY",$[$.PUBLISH=30]="PUBLISH",$[$.SUBSCRIBE=29]="SUBSCRIBE",$[$.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",$[$.STREAM_SWITCH=32]="STREAM_SWITCH",$[$.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",$[$.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",$[$.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",$[$.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",$[$.API_INVOKE=41]="API_INVOKE",$[$.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",$[$.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",$[$.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",$[$.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",$[$.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",$[$.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",$[$.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",$[$.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",$[$.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",$[$.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",$[$.WORKER_EVENT=156]="WORKER_EVENT",$[$.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",$[$.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",$[$.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",$[$.USER_ANALYTICS=1e4]="USER_ANALYTICS",$[$.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}({});class nP{constructor(){G0(this,"baseInfoMap",new Map),G0(this,"proxyServer",void 0),G0(this,"eventUploadTimer",void 0),G0(this,"setSessionIdTimer",void 0),G0(this,"url",void 0),G0(this,"backupUrl",void 0),G0(this,"_appId",void 0),G0(this,"keyEventUploadPendingItems",[]),G0(this,"normalEventUploadPendingItems",[]),G0(this,"apiInvokeUploadPendingItems",[]),G0(this,"apiInvokeCount",0),G0(this,"ltsList",[]),G0(this,"lastSendNormalEventTime",Date.now()),G0(this,"customReportCounterTimer",void 0),G0(this,"customReportCount",0),G0(this,"extApiInvoke",async _e=>{for(const _t of _e){const Wt=P_(P_({},_t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:j0.TRACER});this.sendApiInvoke(Wt)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),yE("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),yE("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(_e){return this.baseInfoMap.get(_e)}adjustSessionStartTime(_e){if(!this.baseInfoMap.has(_e)&&!this.baseInfoMap.get(_e))return void iE.error("adjust session ".concat(_e," start time, sid is not exist or info is undefined"));const _t=this.baseInfoMap.get(_e),Wt=Date.now(),_n=_t.startTime;_t.startTime=Wt,iE.debug("rewrite session ".concat(_e," startTime: ").concat(Wt," , ").concat(Wt-_n,"ms")),this.baseInfoMap.set(_e,_t)}setAppId(_e){this._appId=_e}reportApiInvoke(_e,_t,Wt){_t.timeout=_t.timeout||6e4,_t.reportResult=_t.reportResult===void 0||_t.reportResult;const _n=Date.now();this.apiInvokeCount+=1;const _i=this.apiInvokeCount,_s=()=>({tag:_t.tag,invokeId:_i,sid:_e,name:_t.name,apiInvokeTime:_n,options:_t.options,states:_t.states||null}),_c=!!yE("SHOW_REPORT_INVOKER_LOG");_c&&iE.info("".concat(_t.name," start"),_t.options);let _u=!1;hS(_t.timeout).then(()=>{_u||(this.sendApiInvoke(P_(P_({},_s()),{},{error:mE.API_INVOKE_TIMEOUT,success:!1})),iE.debug("".concat(_t.name," timeout")))});const _h=new HE(mE.UNEXPECTED_ERROR,"".concat(_t.name,": this api invoke is end"));return{onSuccess:_p=>{const Qm=()=>{if(_u)throw _h;return _u=!0,this.sendApiInvoke(P_(P_({},_s()),{},{success:!0},_t.reportResult&&{result:_p})),_c&&iE.info("".concat(_t.name," onSuccess")),_p};return Wt?GH(Qm,_t.name+"Success",Wt,()=>_u=!0):Qm()},onError:_p=>{const Qm=()=>{if(_u)throw _p;_u=!0,this.sendApiInvoke(P_(P_({},_s()),{},{success:!1,error:_p})),_c&&iE.info("".concat(_t.name," onFailure"),_p.toString())};return Wt?GH(Qm,_t.name+"Error",Wt,()=>_u=!0):Qm()}}}sessionInit(_e,_t){if(this.baseInfoMap.has(_e))return;const Wt=Date.now(),_n=this.createBaseInfo(_e,Wt);_n.cname=_t.cname;const _i=Object.assign({},{willUploadConsoleLog:yE("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:CV?"global":"oversea",areas:yE("AREAS")&&yE("AREAS").join(",")},_t.extend),{stringUid:_s,channelProfile:_c,channelMode:_u,isABTestSuccess:_h,lsid:_p,clientRole:Qm}=_t,_g=Date.now(),eE=P_(P_({},_n),{},{eventType:gS.SESSION_INIT,appid:_t.appid,browser:navigator.userAgent,buildFormat:_t.buildFormat,build:AV,lts:_g,elapse:_g-Wt,extend:JSON.stringify(_i),mode:_t.mode,process:yE("PROCESS_ID"),appType:yE("APP_TYPE"),success:!0,version:jT,stringUid:_s,channelProfile:_c,channelMode:_u,isABTestSuccess:_h,lsid:_p,clientType:20,clientRole:Qm,serviceId:yE("PROCESS_ID"),extensionID:yE("PLUGIN_INFO").join(",")||"",preload:_t.preload?1:0});this.send({type:L0.SESSION,data:eE},!0)}joinChooseServer(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.JOIN_CHOOSE_SERVER,lts:_i,eventElapse:_t.elapse||_i-_t.lts,chooseServerAddr:_t.csAddr,errorCode:_t.ec,elapse:_i-Wt.startTime,success:_t.succ,chooseServerAddrList:JSON.stringify(_t.serverList),uid:_t.uid?parseInt(_t.uid):null,cid:_t.cid?parseInt(_t.cid):null,chooseServerIp:_t.csIp||"",opid:_t.opid,unilbsServerIds:_t.unilbsServerIds,extend:_t.extend||void 0,isHttp3:_t.isHttp3});this.send({type:L0.JOIN_CHOOSE_SERVER,data:_s},!0)}reqUserAccount(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.REQ_USER_ACCOUNT,lts:_i,success:_t.success,serverAddress:_t.serverAddr,stringUid:_t.stringUid,uid:_t.uid,errorCode:_t.errorCode,elapse:_t.elapse||_i-Wt.startTime,eventElapse:_i-_t.lts,extend:JSON.stringify(_t.extend)});this.send({type:L0.REQ_USER_ACCOUNT,data:_s},!0)}joinGateway(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info;_t.vid&&(_n.vid=_t.vid),_n.uid=_t.uid,_n.cid=_t.cid;const _i=Date.now(),{firstSuccess:_s,avoidJoinStartTime:_c,isProxy:_u,addr:_h}=_t,_p=_i-(_s&&_c?_c:Wt.startTime),Qm=P_(P_({},_n),{},{eventType:gS.JOIN_GATEWAY,lts:_i,gatewayAddr:_t.addr,success:_t.succ,errorCode:_t.ec,elapse:_p,eventElapse:_i-_t.lts,firstSuccess:_s,signalChannel:_t.signalChannel}),_g=Qm.success?1:0;if(_t.succ&&(Wt.lastJoinSuccessTime=_i),_s)this.send({type:L0.JOIN_GATEWAY,data:Qm},!0);else{let eE;if(_h)if(_u){const aE=_h.match(/h=(\d{1,3}-){3}\d{1,3}/g),cE=_h.match(/p=[0-9]{1,6}/g);eE={isSuccess:_g,gatewayIp:aE&&aE.length?aE[0].split("=")[1].replace(/-/g,"."):"",port:cE&&cE.length?cE[0].split("=")[1]:"",isProxy:_u?1:0}}else{const aE=_h.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),cE=_h.match(/(:|p=)[0-9]{1,6}/g);eE={isSuccess:_g,gatewayIp:aE&&aE.length?aE[0].split("//")[1].replace(/-/g,"."):"",port:cE&&cE.length?cE[0].split(/:|p=/g)[1]:"",isProxy:_u?1:0}}else eE={isSuccess:_g,gatewayIp:"",port:"",isProxy:_u?1:0};delete Qm.success,delete Qm.eventType,delete Qm.firstSuccess,Qm.vid=Number(Qm.vid);const pE=Object.assign({},Qm,eE,{eventType:gS.REJOIN_GATEWAY});this.send({type:L0.RE_JOIN_GATEWAY,data:pE},!0)}}joinChannelTimeout(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Date.now(),_i=P_(P_({},Wt.info),{},{lts:_n,timeout:_t,elapse:_n-Wt.startTime});this.send({type:L0.JOIN_CHANNEL_TIMEOUT,data:_i},!0)}publish(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.PUBLISH,lts:_i,eventElapse:_t.eventElapse,elapse:_i-Wt.startTime,success:_t.succ,errorCode:_t.ec,videoName:_t.videoName,audioName:_t.audioName,screenName:_t.screenName,screenshare:_t.screenshare,audio:_t.audio,video:_t.video,p2pid:_t.p2pid,publishRequestid:_t.publishRequestid});this.send({type:L0.PUBLISH,data:_s},!0)}subscribe(_e,_t,Wt){const _n=this.baseInfoMap.get(_e);if(!_n)return;const _i=_n.info,_s=Date.now(),_c=P_(P_({},_i),{},{eventType:gS.SUBSCRIBE,lts:_s,eventElapse:_t.eventElapse,elapse:_s-_n.startTime,success:_t.succ,errorCode:_t.ec,video:_t.video,audio:_t.audio,subscribeRequestid:_t.subscribeRequestid,p2pid:_t.p2pid},Wt&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof _t.peerid=="string"?_c.peerSuid=_t.peerid:_c.peer=_t.peerid,this.send({type:L0.SUBSCRIBE,data:_c},!0)}wsCompressorInit(_e){var _t;const Wt=[...ST(_t=this.baseInfoMap).call(_t)],_n=Wt.length?Wt[0]:"UnableToGetSid",_i=this.baseInfoMap.get(_n);if(!_i)return;const _s=_i.info,_c=Date.now(),_u=P_(P_({},_s),{},{eventType:gS.WS_COMPRESSOR_INIT,lts:_c,eventElapse:_e.eventElapse,elapse:_c-_i.startTime,status:_e.status?1:2});this.send({type:L0.WS_COMPRESSOR_INIT,data:_u},!0)}firstRemoteVideoDecode(_e,_t,Wt,_n){const _i=this.baseInfoMap.get(_e);if(!_i)return;const _s=_i.info,_c=Date.now(),_u=P_(P_(P_({},_s),_n),{},{elapse:_c-_i.startTime,eventType:_t,lts:_c,firstDecodeFrame:Math.max(_c-_i.startTime,0),apEnd:Math.max(_n.apEnd-_i.startTime,0),apStart:Math.max(_n.apStart-_i.startTime,0),joinGwEnd:Math.max(_n.joinGwEnd-_i.startTime,0),joinGwStart:Math.max(_n.joinGwStart-_i.startTime,0),pcEnd:Math.max(_n.pcEnd-_i.startTime,0),pcStart:Math.max(_n.pcStart-_i.startTime,0),subscriberEnd:Math.max(_n.subscriberEnd-_i.startTime,0),subscriberStart:Math.max(_n.subscriberStart-_i.startTime,0),videoAddNotify:Math.max(_n.videoAddNotify-_i.startTime,0)});this.send({type:Wt,data:_u},!0)}firstRemoteFrame(_e,_t,Wt,_n){const _i=this.baseInfoMap.get(_e);if(!_i)return;const _s=_i.info,_c=Date.now(),_u=P_(P_(P_({},_s),_n),{},{elapse:_c-_i.startTime,eventType:_t,lts:_c});this.send({type:Wt,data:_u},!0)}pcStats(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_(P_({},_n),_t),{},{vid:_n.vid===void 0?0:Number(_n.vid),elapse:_i-Wt.startTime,eventType:gS.PC_STATS,lts:_i});this.send({type:L0.PC_STATS,data:_s},!0)}updateRemoteRTPCapabilities(_e,_t){if(_e){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_(P_({},_n),_t),{},{vid:_n.vid===void 0?0:Number(_n.vid),eventType:gS.UPDATE_REMOTE_RTPCAPABILITIES,lts:_i});this.send({type:L0.UPDATE_REMOTE_RTPCAPABILITIES,data:_s},!0)}}onGatewayStream(_e,_t,Wt,_n){const _i=this.baseInfoMap.get(_e);if(!_i)return;const _s=_i.info,_c=Date.now(),_u=P_(P_(P_({},_s),_n),{},{eventType:_t,lts:_c});this.send({type:Wt,data:_u},!0)}streamSwitch(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.STREAM_SWITCH,lts:_i,isDual:_t.isdual,elapse:_i-Wt.startTime,success:_t.succ});this.send({type:L0.STREAM_SWITCH,data:_s},!0)}requestProxyAppCenter(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.REQUEST_PROXY_APPCENTER,lts:_i,eventElapse:_i-_t.lts,elapse:_i-Wt.startTime,APAddr:_t.APAddr,workerManagerList:_t.workerManagerList,response:_t.response,errorCode:_t.ec,success:_t.succ});this.send({type:L0.REQUEST_PROXY_APPCENTER,data:_s},!0)}requestProxyWorkerManager(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{eventType:gS.REQUEST_PROXY_WORKER_MANAGER,lts:_i,eventElapse:_i-_t.lts,elapse:_i-Wt.startTime,workerManagerAddr:_t.workerManagerAddr,response:_t.response,errorCode:_t.ec,success:_t.succ});this.send({type:L0.REQUEST_PROXY_WORKER_MANAGER,data:_s},!0)}setProxyServer(_e){this.proxyServer=_e,_e?iE.debug("reportProxyServerurl: ".concat(_e)):iE.debug("disable reportProxyServerurl: ".concat(_e))}peerPublishStatus(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_({},_n),{},{subscribeElapse:_t.subscribeElapse,peer:_t.peer,peerPublishDuration:Math.max(_t.audioPublishDuration,_t.videoPublishDuration),audiotag:_t.audioPublishDuration>0?1:-1,videotag:_t.videoPublishDuration>0?1:-1,lts:_i,elapse:_i-Wt.startTime,joinChannelSuccessElapse:_i-(Wt.lastJoinSuccessTime||_i),peerPublishDurationVideo:_t.videoPublishDuration,peerPublishDurationAudio:_t.audioPublishDuration});this.send({type:L0.PEER_PUBLISH_STATUS,data:_s},!0)}workerEvent(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now();(function(_s,_c,_u){const _h=_s[_c];if(!_h||typeof _h!="string")return[_s];_s[_c]="";const _p=XR(JSON.stringify(_s));let Qm=0;const _g=[];let eE=0;for(let pE=0;pE<_h.length;pE++)eE+=_h.charCodeAt(pE)<=127?1:3,eE<=_u-_p||(_g[_g.length]=f_(f_({},_s),{},{[_c]:_h.substring(Qm,pE)}),Qm=pE,eE=_h.charCodeAt(pE)<=127?1:3);return Qm!==_h.length-1&&(_g[_g.length]=f_(f_({},_s),{},{[_c]:_h.substring(Qm)})),_g})(P_(P_(P_({},_n),_t),{},{elapse:_i-Wt.startTime,lts:_i,productType:"WebRTC"}),"payload",1300).forEach(_s=>this.send({type:L0.WORKER_EVENT,data:_s},!0))}apworkerEvent(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_(P_({},_n),_t),{},{elapse:_i-Wt.startTime,lts:_i});this.send({type:L0.AP_WORKER_EVENT,data:_s},!0)}joinWebProxyAP(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_(P_({},_n),_t),{},{elapse:_i-Wt.startTime,lts:_i,extend:_t.extend||void 0});this.send({type:L0.JOIN_WEB_PROXY_AP,data:_s},!0)}WebSocketQuit(_e,_t){const Wt=this.baseInfoMap.get(_e);if(!Wt)return;const _n=Wt.info,_i=Date.now(),_s=P_(P_(P_({},_n),_t),{},{elapse:_i-Wt.startTime,lts:_i});this.send({type:L0.WEBSOCKET_QUIT,data:_s},!0)}async sendCustomReportMessage(_e,_t){if(this.customReportCount+=_t.length,this.customReportCount>yE("CUSTOM_REPORT_LIMIT"))throw new HE(mE.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const Wt=Date.now(),_n=_t.map(_i=>({type:L0.USER_ANALYTICS,data:P_(P_({sid:_e},_i),{},{lts:Wt})}));try{yE("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(_n):await this.postDataToStatsCollector(_n)}catch(_i){throw iE.error("send custom report message failed",_i.toString()),new HE(mE.CUSTOM_REPORT_SEND_FAILED,_i.message)}}sendApiInvoke(_e){const _t=yE("NOT_REPORT_EVENT");if(_e.tag&&i_(_t)&&i_(_t).call(_t,_e.tag))return!1;if(_e.sid===null)return this.apiInvokeUploadPendingItems.push(_e),!1;const Wt=this.baseInfoMap.get(_e.sid);if(!Wt)return this.apiInvokeUploadPendingItems.push(_e),!1;const{cname:_n,uid:_i,cid:_s}=Wt.info;let _c;if(_e.lts=_e.lts||Date.now(),_e.error)if(_e.error instanceof HE){const{code:_h,message:_p}=_e.error;_c=_h||_p||_e.error.toString()}else _c=_e.error.toString();const _u={invokeId:_e.invokeId,sid:_e.sid,cname:_n,cid:_s,uid:_i,lts:_e.lts,success:_e.success,elapse:_e.lts-Wt.startTime,execElapse:_e.lts-_e.apiInvokeTime,apiName:_e.name,options:_e.options?JSON.stringify(_e.options):void 0,execStates:_e.states?JSON.stringify(_e.states):void 0,execResult:_e.result?JSON.stringify(_e.result):void 0,errorCode:_e.error?_c:void 0,errorMsg:_e.error?JSON.stringify(_e.error):void 0};return this.send({type:L0.API_INVOKE,data:_u},!1),!0}appendSessionId(){nP.__CLIENT_LIST__.forEach(_e=>{if(_e._sessionId){const _t=this.apiInvokeUploadPendingItems.length;for(let Wt=0;Wt<_t;Wt++){const _n=this.apiInvokeUploadPendingItems.shift();_n&&(_n.sid=_e._sessionId,this.sendApiInvoke(Object.assign({},_n)))}}})}send(_e,_t){if(_t)return this.keyEventUploadPendingItems.push(_e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(_e),this.normalEventUploadPendingItems.length>yE("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(_e,_t){const Wt=[],_n=[];for(;_e.length;){const _s=_e.shift();Wt.length<20?Wt.push(_s):_n.push(_s)}_e.push(..._n);for(const _s of[...Wt]){var _i;this.ltsList.indexOf(_s.data.lts)!==-1?(_s.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(_s.data.lts)):(this.ltsList.push(_s.data.lts),MN(_i=this.ltsList).call(_i,(_c,_u)=>_c-_u))}return _t||(this.lastSendNormalEventTime=Date.now()),yE("ENABLE_EVENT_REPORT")&&Wt.length&&(yE("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(Wt):this.postDataToStatsCollector(Wt)).catch((_s=>_c=>{yE("EVENT_REPORT_RETRY")&&(_t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(_s):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(_s),this.normalEventUploadPendingItems.length>yE("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-yE("NORMAL_EVENT_QUEUE_CAPACITY")),iE.warning("report: drop normal events"))))})(Wt)),_e}async postDataToStatsCollector2(_e){F0.networkState===KS.OFFLINE&&await n_.race([F0.onlineWaiter,hS(2*Y0.maxRetryTimeout)]);const _t=_i=>{let _s=new Uint8Array;return _i.forEach(_c=>{const _u=_V(JSON.stringify(_c.data)),_h=new ArrayBuffer(5),_p=(_g=>{let eE=0;return Object.entries(L0).forEach(pE=>{let[aE,cE]=pE;cE===_g.type&&(eE=EventNameToID[aE])}),eE})(_c),Qm=new DataView(_h);Qm.setUint16(0,_u.byteLength,!0),Qm.setUint8(2,255&_p),Qm.setUint8(3,_p>>>8&255),Qm.setUint8(4,_p>>>16&255),_s=kH(_s,new Uint8Array(_h)),_s=kH(_s,_u)}),_s},Wt="event";let _n=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(yE("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(Wt):"https://".concat(yE("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(Wt);for(let _i=0;_i<2;_i+=1){_i===1&&(_n=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(yE("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(Wt):"https://".concat(yE("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(Wt));try{await RV(_n,{timeout:1e4,data:_t(_e),headers:P_(P_({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(_s){if(_i===1)throw _s;continue}return}}async postDataToStatsCollector(_e){let _t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const Wt={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:_e.map(_s=>JSON.stringify(_s)),vid:(_s=>{const _c=_s&&_s.data.sid&&this.baseInfoMap.get(_s.data.sid);return _c&&_c.info.vid&&+_c.info.vid||0})(_e[0])};F0.networkState===KS.OFFLINE&&await n_.race([F0.onlineWaiter,hS(2*Y0.maxRetryTimeout)]);const _n=_t?"/events/proto-raws":"/events/messages";let _i=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(yE("EVENT_REPORT_DOMAIN"),"&p=").concat(yE("STATS_COLLECTOR_PORT"),"&d=").concat(_n):"https://".concat(yE("EVENT_REPORT_DOMAIN"),":").concat(yE("STATS_COLLECTOR_PORT")).concat(_n));for(let _s=0;_s<2;_s+=1){_s===1&&(_i=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(yE("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(yE("STATS_COLLECTOR_PORT"),"&d=").concat(_n):"https://".concat(yE("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(yE("STATS_COLLECTOR_PORT")).concat(_n)));try{_t?await oce(_i,{timeout:1e4,data:Wt}):await RV(_i,{timeout:1e4,data:Wt})}catch(_c){if(_s===1)throw _c;continue}return}}createBaseInfo(_e,_t){const Wt=Object.assign({},dce);return Wt.sid=_e,this.baseInfoMap.set(_e,{info:Wt,startTime:_t}),Wt}reportResourceTiming(_e,_t){const Wt=performance.getEntriesByName(_e),_n=Wt[Wt.length-1];_n&&this.reportApiInvoke(_t,{name:"Client.resourceTiming",options:_n,tag:j0.TRACER}).onSuccess()}}function __(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(_e,_t,Wt){const _n=Wt.value;if(typeof _n=="function"){const _i=$.className||_e.__className__||(_e.constructor.name==="AgoraRTCClient"?"Client":_e.constructor.name);Wt.value=function(){for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];let _h=_c;if($.argsMap)try{_h=$.argsMap(this,..._c)}catch(Qm){iE.warning(Qm),_h=[]}try{JSON.stringify(_h)}catch{iE.warning("arguments for method ".concat(_i,".").concat(String(_t)," not serializable for apiInvoke.")),_h=[]}const _p=($.report||p_).reportApiInvoke(this._sessionId||null,{name:"".concat(_i,".").concat(String(_t)),options:_h,tag:j0.TRACER,reportResult:$.reportResult},$.throttleTime);try{const Qm=_n.apply(this,_c);return Qm instanceof n_?Qm.then(_g=>(_p.onSuccess($.reportResult&&_g),_g)).catch(_g=>{throw _p.onError(_g),_g}):(_p.onSuccess($.reportResult&&Qm),Qm)}catch(Qm){throw _p.onError(Qm),Qm}}}return Wt}}G0(nP,"__CLIENT_LIST__",[]);const p_=new nP;JH.on("REPORT_LOG_UPLOAD",$=>{$.networkState=F0.networkState,p_.reportApiInvoke(null,{name:"logUploadError",options:$,tag:j0.TRACER}).onSuccess("logUploadError")});const hce=["CHINA","GLOBAL"],CS=function(){const $="us".concat("erna","me"),_e="pa".concat("sswo","rd"),_t=["t","s","t"];_t.splice(1,0,"e");const Wt=_t.join(""),_n=[];for(let _c=0;_c<6;_c++)_n.push("1");const _i=_n.join(""),_s={};return _s[$]=Wt,_s[_e]=_i,Object.assign(_s,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=CS,CV||(nS.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],nS.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],nS.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],nS.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],nS.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],nS.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],nS.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",nS.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",nS.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",nS.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",nS.AREAS=["NORTH_AMERICA","OVERSEA"]);const QH=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],$1=[];function DI($,_e){return!!_e&&$1.some(_t=>_t.uid===$&&_t.channelName===_e)}nP.__CLIENT_LIST__=$1;var pce=I3.forEach,eW=_k("forEach")?[].forEach:function($){return pce(this,$,arguments.length>1?arguments[1]:void 0)};y0({target:"Array",proto:!0,forced:[].forEach!=eW},{forEach:eW});var fce=QT("Array").forEach,mce=WR,gce=_0,Ece=_m,vce=fce,NV=Array.prototype,_ce={DOMTokenList:!0,NodeList:!0},yce=function($){var _e=$.forEach;return $===NV||Ece(NV,$)&&_e===NV.forEach||gce(_ce,mce($))?vce:_e},bce=zt(yce),Sce=e0,tW=vD;y0({target:"Object",stat:!0,forced:_r(function(){tW(1)})},{keys:function($){return tW(Sce($))}});var nW=zt(yS.Object.keys),Tce=zt(K8),wce=y0,Rce=FN,Cce=_f([].reverse),rW=[1,2];wce({target:"Array",proto:!0,forced:String(rW)===String(rW.reverse())},{reverse:function(){return Rce(this)&&(this.length=this.length),Cce(this)}});var Ice=QT("Array").reverse,Ace=_m,Oce=Ice,PV=Array.prototype,Nce=function($){var _e=$.reverse;return $===PV||Ace(PV,$)&&_e===PV.reverse?Oce:_e},iW=Nce,Pce=zt(iW),kce=y0,oW=FN,Dce=PD,Lce=TS,sW=nU,xce=f1,Mce=k0,Uce=KD,jce=$0,Fce=MU,Vce=E3("slice"),Bce=jce("species"),kV=Array,Gce=Math.max;kce({target:"Array",proto:!0,forced:!Vce},{slice:function($,_e){var _t,Wt,_n,_i=Mce(this),_s=xce(_i),_c=sW($,_s),_u=sW(_e===void 0?_s:_e,_s);if(oW(_i)&&(_t=_i.constructor,(Dce(_t)&&(_t===kV||oW(_t.prototype))||Lce(_t)&&(_t=_t[Bce])===null)&&(_t=void 0),_t===kV||_t===void 0))return Fce(_i,_c,_u);for(Wt=new(_t===void 0?kV:_t)(Gce(_u-_c,0)),_n=0;_c<_u;_c++,_n++)_c in _i&&Uce(Wt,_n,_i[_c]);return Wt.length=_n,Wt}});var Hce=QT("Array").slice,Wce=_m,qce=Hce,DV=Array.prototype,zce=function($){var _e=$.slice;return $===DV||Wce(DV,$)&&_e===DV.slice?qce:_e},Kce=zt(zce);function t_($,_e,_t,Wt,_n){var _i,_s,_c,_u={};return bce(_i=nW(Wt)).call(_i,function(_h){_u[_h]=Wt[_h]}),_u.enumerable=!!_u.enumerable,_u.configurable=!!_u.configurable,("value"in _u||_u.initializer)&&(_u.writable=!0),_u=Tce(_s=Pce(_c=Kce(_t).call(_t)).call(_c)).call(_s,function(_h,_p){return _p($,_e,_h)||_h},_u),_n&&_u.initializer!==void 0&&(_u.value=_u.initializer?_u.initializer.call(_n):void 0,_u.initializer=void 0),_u.initializer===void 0&&(p3($,_e,_u),_u=null),_u}var $ce=QT("Array").values,Yce=WR,Jce=_0,Xce=_m,Zce=$ce,LV=Array.prototype,Qce={DOMTokenList:!0,NodeList:!0},ele=function($){var _e=$.values;return $===LV||Xce(LV,$)&&_e===LV.values||Jce(Qce,Yce($))?Zce:_e},AR=zt(ele);let tle=function($){return $.L1T1="L1T1",$.L1T2="L1T2",$.L1T3="L1T3",$.L2T1_KEY="L2T1_KEY",$.L2T2_KEY="L2T2_KEY",$.L2T3_KEY="L2T3_KEY",$.L3T1_KEY="L3T1_KEY",$.L3T2_KEY="L3T2_KEY",$.L3T3_KEY="L3T3_KEY",$}({}),wT=function($){return $.CERTIFICATE="certificate",$.CODEC="codec",$.CANDIDATE_PAIR="candidate-pair",$.LOCAL_CANDIDATE="local-candidate",$.REMOTE_CANDIDATE="remote-candidate",$.INBOUND="inbound-rtp",$.TRACK="track",$.OUTBOUND="outbound-rtp",$.PC="peer-connection",$.REMOTE_INBOUND="remote-inbound-rtp",$.REMOTE_OUTBOUND="remote-outbound-rtp",$.TRANSPORT="transport",$.CSRC="csrc",$.DATA_CHANNEL="data-channel",$.STREAM="stream",$.SENDER="sender",$.RECEIVER="receiver",$}({}),OL=function($){return $[$.ACCESS_POINT=101]="ACCESS_POINT",$[$.UNILBS=201]="UNILBS",$[$.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",$}({}),xV=function($){return $[$.IIIEGAL_APPID=1]="IIIEGAL_APPID",$[$.IIIEGAL_UID=2]="IIIEGAL_UID",$[$.INTERNAL_ERROR=3]="INTERNAL_ERROR",$}({}),nR=function($){return $[$.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",$[$.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",$[$.INTERNAL_ERROR=8]="INTERNAL_ERROR",$[$.NO_AUTHORIZED=9]="NO_AUTHORIZED",$[$.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",$[$.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",$[$.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",$[$.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",$[$.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",$[$.USER_OVERLOAD=16]="USER_OVERLOAD",$[$.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",$[$.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",$}({}),$S=function($){return $[$.NO_FLAG_SET=100]="NO_FLAG_SET",$[$.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",$[$.INVALID_FALG_SET=102]="INVALID_FALG_SET",$[$.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",$[$.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",$[$.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",$[$.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",$[$.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",$[$.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",$[$.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",$[$.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",$[$.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",$[$.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",$[$.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",$[$.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",$[$.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",$[$.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",$[$.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",$[$.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",$}({}),E_=function($){return $[$.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",$[$.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",$[$.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",$[$.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",$[$.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",$[$.K_TICKET_INVALID=7]="K_TICKET_INVALID",$[$.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",$[$.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",$[$.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",$[$.K_UID_BANNED=14]="K_UID_BANNED",$[$.K_IP_BANNED=15]="K_IP_BANNED",$[$.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",$[$.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",$[$.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",$[$.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",$[$.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",$[$.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",$[$.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",$[$.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",$[$.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",$[$.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",$[$.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",$[$.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",$[$.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",$[$.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",$[$.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",$[$.ERR_INVALID_UID=117]="ERR_INVALID_UID",$[$.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",$[$.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",$[$.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",$[$.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",$[$.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",$[$.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",$[$.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",$[$.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",$[$.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",$[$.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",$[$.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",$[$.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",$[$.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",$[$.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",$[$.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",$[$.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",$[$.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",$[$.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",$[$.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",$[$.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",$[$.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",$[$.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",$[$.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",$[$.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",$[$.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",$[$.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",$[$.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",$[$.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",$[$.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",$[$.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",$[$.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",$[$.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",$[$.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",$[$.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",$[$.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",$[$.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",$[$.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",$}({}),M_=function($){return $.CONNECTING="connecting",$.CONNECTED="connected",$.RECONNECTING="reconnecting",$.CLOSED="closed",$}({}),l_=function($){return $.WS_CONNECTED="ws_connected",$.WS_RECONNECTING="ws_reconnecting",$.WS_CLOSED="ws_closed",$.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",$.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",$.ON_BINARY_DATA="on_binary_data",$.REQUEST_RECOVER="request_recover",$.REQUEST_JOIN_INFO="request_join_info",$.REQUEST_REJOIN_INFO="req_rejoin_info",$.IS_P2P_DISCONNECTED="is_p2p_dis",$.DISCONNECT_P2P="dis_p2p",$.ABORT_P2P_EXECUTION="abort_p2p_execution",$.NEED_RENEW_SESSION="need-sid",$.REPORT_JOIN_GATEWAY="report_join_gateway",$.REQUEST_TIMEOUT="request_timeout",$.REQUEST_SUCCESS="request_success",$.JOIN_RESPONSE="join_response",$.DATACHANNEL_PRECONNECT="datachannel_preconnect",$.DATACHANNEL_CONNECTING="datachannel_connecting",$.DATACHANNEL_FAILBACK="datachannel_failback",$.P2P_CONNECTION="p2p_connection",$.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",$.P2P_SUBSCRIBE="p2p_subscribe",$.P2P_UNSUBSCRIBE="p2p_unsubscribe",$.P2P_EXCHANGE_SDP="p2p_exchange_sdp",$.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",$.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",$}({}),g_=function($){return $.PING="ping",$.PING_BACK="ping_back",$.JOIN="join_v3",$.REJOIN="rejoin_v3",$.LEAVE="leave",$.SET_CLIENT_ROLE="set_client_role",$.PUBLISH="publish",$.PUBLISH_DATASTREAM="publish_datastream",$.UNPUBLISH="unpublish",$.UNPUBLISH_DATASTREAM="unpublish_datastream",$.SUBSCRIBE="subscribe",$.PRE_SUBSCRIBE="pre_subscribe",$.SUBSCRIBE_DATASTREAM="subscribe_datastream",$.SUBSCRIBE_STREAMS="subscribe_streams",$.UNSUBSCRIBE="unsubscribe",$.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",$.UNSUBSCRIBE_STREAMS="unsubscribe_streams",$.SUBSCRIBE_CHANGE="subscribe_change",$.TRAFFIC_STATS="traffic_stats",$.RENEW_TOKEN="renew_token",$.SWITCH_VIDEO_STREAM="switch_video_stream",$.DEFAULT_VIDEO_STREAM="default_video_stream",$.SET_FALLBACK_OPTION="set_fallback_option",$.GATEWAY_INFO="gateway_info",$.CONTROL="control",$.SEND_METADATA="send_metadata",$.DATA_STREAM="data_stream",$.PICK_SVC_LAYER="pick_svc_layer",$.RESTART_ICE="restart_ice",$.CONNECT_PC="connect_pc",$.SET_VIDEO_PROFILE="set_video_profile",$.SET_PARAMETER="set_parameter",$.SET_RTM2_FLAG="set_rtm2_flag",$}({}),LI=function($){return $.WRTC_STATS="wrtc_stats",$.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",$.DENOISER_STATS="denoiser_stats",$.EXTENSION_USAGE_STATS="extension_usage_stats",$}({}),C_=function($){return $.ON_USER_ONLINE="on_user_online",$.ON_USER_OFFLINE="on_user_offline",$.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",$.ON_PUBLISH_STREAM="on_publish_stream",$.ON_UPLINK_STATS="on_uplink_stats",$.ON_P2P_LOST="on_p2p_lost",$.ON_REMOVE_STREAM="on_remove_stream",$.ON_ADD_AUDIO_STREAM="on_add_audio_stream",$.ON_ADD_VIDEO_STREAM="on_add_video_stream",$.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",$.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",$.ON_USER_BANNED="on_user_banned",$.ON_USER_LICENSE_BANNED="on_user_license_banned",$.ON_NOTIFICATION="on_notification",$.ON_CRYPT_ERROR="on_crypt_error",$.MUTE_AUDIO="mute_audio",$.MUTE_VIDEO="mute_video",$.UNMUTE_AUDIO="unmute_audio",$.UNMUTE_VIDEO="unmute_video",$.ON_P2P_OK="on_p2p_ok",$.RECEIVE_METADATA="receive_metadata",$.ON_DATA_STREAM="on_data_stream",$.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",$.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",$.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",$.ENABLE_LOCAL_VIDEO="enable_local_video",$.DISABLE_LOCAL_VIDEO="disable_local_video",$.ENABLE_LOCAL_AUDIO="enable_local_audio",$.DISABLE_LOCAL_AUDIO="disable_local_audio",$.ON_PUBLISHED_USER_LIST="on_published_user_list",$}({}),YS=function($){return $.SEND_ONLY="SEND_ONLY",$.RECEIVE_ONLY="RECEIVE_ONLY",$}({}),T_=function($){return $.CONNECTED="websocket:connected",$.RECONNECTING="websocket:reconnecting",$.WILL_RECONNECT="websocket:will_reconnect",$.CLOSED="websocket:closed",$.FAILED="websocket:failed",$.ON_MESSAGE="websocket:on_message",$.REQUEST_NEW_URLS="websocket:request_new_urls",$.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",$.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",$.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",$}({});class DE extends HE{constructor(_e){super(_e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),hE(this,"name","AgoraRTCException")}print(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(_e,iE)}throw(){super.throw(iE)}}function NL($){if(typeof $!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test($))throw iE.error("Invalid Channel Name ".concat($)),new DE(mE.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function PL($){if(!function(_e){return typeof _e=="number"&&Math.floor(_e)===_e&&0<=_e&&_e<=4294967295}($)&&!AH($,1,255))throw new DE(mE.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");typeof $=="string"&&iE.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let ES=function($){return $.TRANSCODE="mix_streaming",$.RAW="raw_streaming",$.INJECT="inject_streaming",$}({}),kO=function($){return $[$.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",$[$.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",$[$.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",$[$.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",$[$.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",$[$.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",$[$.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",$[$.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",$[$.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",$[$.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",$[$.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN",$}({});const nle={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},MV={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function UV($,_e){bS($.url,"".concat(_e,".url"),1,1e3,!1),U0($.x)||u0($.x,"".concat(_e,".x"),0,1e4),U0($.y)||u0($.y,"".concat(_e,".y"),0,1e4),U0($.width)||u0($.width,"".concat(_e,".width"),0,1e4),U0($.height)||u0($.height,"".concat(_e,".height"),0,1e4),U0($.zOrder)||u0($.zOrder,"".concat(_e,".zOrder"),0,255),U0($.alpha)||u0($.alpha,"".concat(_e,".alpha"),0,1,!1)}const rle={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},ile={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let ZR=function($){return $.WARNING="@live_uap-warning",$.ERROR="@line_uap-error",$.PUBLISH_STREAM_STATUS="@live_uap-publish-status",$.INJECT_STREAM_STATUS="@live_uap-inject-status",$.WORKER_STATUS="@live_uap-worker-status",$.REQUEST_NEW_ADDRESS="@live_uap-request-address",$}({}),kL=function($){return $.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",$}({}),rS=function($){return $[$.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",$[$.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",$[$.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",$[$.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",$[$.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",$[$.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",$[$.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",$[$.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",$[$.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",$[$.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",$[$.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",$[$.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",$[$.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",$[$.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",$[$.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",$[$.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",$[$.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",$[$.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",$[$.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",$[$.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",$[$.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",$}({});function aW($){if(!$.channelName)throw new DE(mE.INVALID_PARAMS,"invalid channelName in info");if(typeof $.uid!="number")throw new DE(mE.INVALID_PARAMS,"invalid uid in info, uid must be a number");return $.token&&bS($.token,"info.token",1,2047),PL($.uid),NL($.channelName),!0}let JS=function($){return $[$.SetSdkProfile=0]="SetSdkProfile",$[$.SetSourceChannel=1]="SetSourceChannel",$[$.SetSourceUserId=2]="SetSourceUserId",$[$.SetDestChannel=3]="SetDestChannel",$[$.StartPacketTransfer=4]="StartPacketTransfer",$[$.StopPacketTransfer=5]="StopPacketTransfer",$[$.UpdateDestChannel=6]="UpdateDestChannel",$[$.Reconnect=7]="Reconnect",$[$.SetVideoProfile=8]="SetVideoProfile",$}({}),_1=function($){return $.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",$.NETWORK_CONNECTED="NETWORK_CONNECTED",$.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",$.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",$.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",$.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",$.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",$.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",$.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",$.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",$}({}),aT=function($){return $.RELAY_STATE_IDLE="RELAY_STATE_IDLE",$.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",$.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",$.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",$}({}),DO=function($){return $.RELAY_OK="RELAY_OK",$.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",$.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",$.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",$}({}),n0=function($){return $.High="high",$.Low="low",$.Audio="audio",$.Screen="screen",$.ScreenLow="screen_low",$}({}),H0=function($){return $.DISCONNECT="disconnect",$.CONNECTION_STATE_CHANGE="connection-state-change",$.NETWORK_QUALITY="network-quality",$.STREAM_TYPE_CHANGE="stream-type-change",$.IS_P2P_DISCONNECTED="is-p2p-dis",$.DISCONNECT_P2P="dis-p2p",$.REQUEST_NEW_GATEWAY_LIST="req-gate-url",$.NEED_RENEW_SESSION="need-sid",$.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",$.JOIN_RESPONSE="join-response",$.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",$.RESET_CONNECTION_EVENTS="reset-connection-events",$.DATACHANNEL_PRECONNECT="datachannel_preconnect",$.DATACHANNEL_FAILBACK="datachannel_failback",$.RESET_SIGNAL="reset-signal",$}({}),rP=function($){return $.P2P_DISCONNECTED="P2P_DISCONNECTED",$.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",$.TIMEOUT="TIMEOUT",$.UNKNOWN_REASON="UNKNOWN_REASON",$}({}),pS=function($){return $[$.Nothing=0]="Nothing",$[$.Audio=1]="Audio",$[$.LwoVideo=2]="LwoVideo",$[$.Video=4]="Video",$[$.Data=8]="Data",$[$.DataStream0=256]="DataStream0",$[$.DataStream1=512]="DataStream1",$[$.DataStream2=1024]="DataStream2",$[$.DataStream3=2048]="DataStream3",$[$.DataStream4=4096]="DataStream4",$[$.DataStream5=8192]="DataStream5",$[$.DataStream6=16384]="DataStream6",$[$.DataStream7=32768]="DataStream7",$}({}),cW=function($){return $[$.websocket=0]="websocket",$[$.datachannel=1]="datachannel",$}({}),J_=function($){return $.CHINA="CHINA",$.ASIA="ASIA",$.NORTH_AMERICA="NORTH_AMERICA",$.EUROPE="EUROPE",$.JAPAN="JAPAN",$.INDIA="INDIA",$.KOREA="KOREA",$.HKMC="HKMC",$.US="US",$.OCEANIA="OCEANIA",$.SOUTH_AMERICA="SOUTH_AMERICA",$.AFRICA="AFRICA",$.OVERSEA="OVERSEA",$.GLOBAL="GLOBAL",$.EXTENSIONS="EXTENSIONS",$}({});const lW=[J_.AFRICA,J_.ASIA,J_.CHINA,J_.EUROPE,J_.GLOBAL,J_.INDIA,J_.JAPAN,J_.NORTH_AMERICA,J_.OCEANIA,J_.OVERSEA,J_.SOUTH_AMERICA];let kS=function($){return $.CHINA="CN",$.ASIA="AS",$.NORTH_AMERICA="NA",$.EUROPE="EU",$.JAPAN="JP",$.INDIA="IN",$.KOREA="KR",$.HKMC="HK",$.US="US",$.OCEANIA="OC",$.SOUTH_AMERICA="SA",$.AFRICA="AF",$.OVERSEA="OVERSEA",$.GLOBAL="GLOBAL",$.EXTENSIONS="GLOBAL",$}({});const DL={CHINA:{},ASIA:{CODE:kS.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:kS.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:kS.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:kS.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:kS.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:kS.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:kS.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:kS.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:kS.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:kS.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:kS.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:kS.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:kS.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};CV&&(DL.CHINA={CODE:kS.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let jV=function($){return $.UPDATE_BITRATE_LIMIT="update_bitrate_limit",$}({});class uW extends A0{constructor(_e,_t){super(),hE(this,"onICEConnectionStateChange",void 0),hE(this,"onConnectionStateChange",void 0),hE(this,"onDTLSTransportStateChange",void 0),hE(this,"onDTLSTransportError",void 0),hE(this,"onICETransportStateChange",void 0),hE(this,"onFirstAudioReceived",void 0),hE(this,"onFirstVideoReceived",void 0),hE(this,"onFirstAudioDecoded",void 0),hE(this,"onFirstVideoDecoded",void 0),hE(this,"onFirstVideoDecodedTimeout",void 0),hE(this,"onSelectedLocalCandidateChanged",void 0),hE(this,"onSelectedRemoteCandidateChanged",void 0),hE(this,"getLocalVideoStats",void 0)}}class LL extends uW{constructor(_e,_t){super(_e,_t),hE(this,"establishPromise",void 0)}}let h_=function($){return $.VIDEO="video",$.AUDIO="audio",$}({}),BS=function($){return $[$.UDP=0]="UDP",$[$.TCP=1]="TCP",$[$.RELAY=2]="RELAY",$}({}),y1=function($){return $[$.FIRST_CONNECTION=0]="FIRST_CONNECTION",$[$.TCP_RESTART=1]="TCP_RESTART",$[$.RELAY_RESTART=2]="RELAY_RESTART",$[$.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",$[$.OLD_RESTART=11]="OLD_RESTART",$[$.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",$}({}),XE=function($){return $.LocalVideoTrack="videoTrack",$.LocalAudioTrack="audioTrack",$.LocalVideoLowTrack="videoLowTrack",$}({}),i0=function($){return $.New="new",$.Connected="connected",$.Reconnecting="reconnecting",$.Disconnected="disconnected",$}({}),y_=function($){return $.StateChange="stateChange",$.IceConnectionStateChange="iceConnectionStateChange",$.RequestMuteLocal="requestMuteLocal",$.RequestUnmuteLocal="requestUnmuteLocal",$.RequestRePublish="requestRePublish",$.RequestRePublishDataChannel="requestRePublishDataChannel",$.RequestReSubscribe="requestReSubscribe",$.RequestUploadStats="requestUploadStats",$.RequestUpload="requestUpload",$.MediaReconnectStart="MediaReconnectStart",$.MediaReconnectEnd="MediaReconnectEnd",$.NeedSignalRTT="NeedSignalRTT",$.RequestRestartICE="RequestRestartIce",$.PeerConnectionStateChange="PeerConnectionStateChange",$.RequestReconnect="RequestReconnect",$.RequestReconnectPC="RequestReconnectPC",$.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",$.P2PLost="P2PLost",$.UpdateVideoEncoder="UpdateVideoEncoder",$.ConnectionTypeChange="ConnectionTypeChange",$.RequestLowStreamParameter="RequestLowStreamParameter",$.QueryClientConnectionState="QueryClientConnectionState",$.LocalCandidate="LocalCandidate",$.RequestP2PMuteLocal="requestP2PMuteLocal",$.RequestP2PUnPublish="RequestP2PUnPublish",$.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",$.RequestP2PMuteRemote="RequestP2PMuteRemote",$.RequestP2PRestartICE="RequestP2PRestartICE",$}({}),rR=function($){return $.CONNECTING="CONNECTING",$.RECONNECTING="RECONNECTING",$.CONNECTED="CONNECTED",$.CLOSED="CLOSED",$}({}),iR=function($){return $[$.CONNECT_AP=0]="CONNECT_AP",$[$.AP_CONNECTED=1]="AP_CONNECTED",$[$.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",$[$.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",$[$.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",$[$.CONNECT_WORKER=5]="CONNECT_WORKER",$[$.WORKER_CONNECTED=6]="WORKER_CONNECTED",$[$.CLOSED=7]="CLOSED",$}({}),vS=function($){return $.CONNECTION_STATE_CHANGE="connection-state-change",$.STATE_CHANGE="state-change",$.INSPECT_RESULT="inspect-result",$.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",$.REQUEST_NEW_WORKER_URL="request-new-worker-url",$}({}),Y1=function($){return $.NETWORK_ERROR="NETWORK_ERROR",$.SERVER_ERROR="SERVER_ERROR",$.MULTI_IP="MULTI_IP",$.TIMEOUT="TIMEOUT",$.OFFLINE="OFFLINE",$.LEAVE="LEAVE",$.P2P_FAILED="P2P_FAILED",$.FALLBACK="FALLBACK",$}({}),_b=function($){return $.CONNECTED="transmitter:connected",$.RECONNECTING="transmitter:reconnecting",$.WILL_RECONNECT="transmitter:will_reconnect",$.CLOSED="transmitter:closed",$.FAILED="transmitter:failed",$.ON_MESSAGE="transmitter:on_message",$.REQUEST_NEW_URLS="transmitter:request_new_urls",$.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",$.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",$.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",$.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",$.FAILBACK="transmitter:failback",$}({}),QR=function($){return $.CAMERA_CHANGED="camera-changed",$.MICROPHONE_CHANGED="microphone-changed",$.PLAYBACK_DEVICE_CHANGED="playback-device-changed",$.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",$.AUTOPLAY_FAILED="autoplay-failed",$.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",$.SECURITY_POLICY_VIOLATION="security-policy-violation",$}({}),VT=function($){return $.CONNECTING="CONNECTING",$.RECONNECTING="RECONNECTING",$.CONNECTED="CONNECTED",$.CLOSED="CLOSED",$}({}),OR=function($){return $.CONNECTION_STATE_CHANGE="connection-state-change",$.STATE_CHANGE="state-change",$.INSPECT_RESULT="inspect-result",$.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",$.REQUEST_NEW_WORKER_URL="request-new-worker-url",$}({}),LO=function($){return $[$.CONNECT_AP=0]="CONNECT_AP",$[$.AP_CONNECTED=1]="AP_CONNECTED",$[$.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",$[$.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",$[$.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",$[$.CONNECT_WORKER=5]="CONNECT_WORKER",$[$.WORKER_CONNECTED=6]="WORKER_CONNECTED",$[$.CLOSED=7]="CLOSED",$}({}),W0=function($){return $.CALL="call",$.CANDIDATE="candidate",$.PUBLISH="publish",$.UNPUBLISH="unpublish",$.CONTROL="control",$.RESTART_ICE="restart_ice",$.ACK="ack",$.RESPONSE="response",$.JOIN="join",$.CHECK="check",$}({}),xO=function($){return $.ABORT="abort",$}({}),J1=function($){return $.MUTE_LOCAL_AUDIO="mute_local_audio",$.MUTE_LOCAL_VIDEO="mute_local_video",$.UNMUTE_LOCAL_AUDIO="unmute_local_audio",$.UNMUTE_LOCAL_VIDEO="unmute_local_video",$}({}),ole=function($){return $.P2P_TOKEN_TIMEOUT="p2p_token_timeout",$.P2P_TOKEN_CHANGED="p2p_token_changed",$}({});const sle={[OL.ACCESS_POINT]:{[$S.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[$S.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[$S.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[$S.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[$S.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[$S.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[$S.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[OL.UNILBS]:{[nR.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[nR.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[nR.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[nR.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[nR.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[nR.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[nR.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[nR.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[nR.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[nR.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[nR.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[nR.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[OL.STRING_UID_ALLOCATOR]:{[xV.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[xV.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[xV.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function MO($){const _e=sle[Math.floor($/1e4)];if(!_e)return{desc:"unknown error",retry:!1};const _t=_e[$%1e4];if(!_t){if(Math.floor($/1e4)===OL.ACCESS_POINT){const Wt=$%1e4;if(Wt.toString()[0]==="1")return{desc:$.toString(),retry:!1};if(Wt.toString()[0]==="2")return{desc:$.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return _t}const ale={[E_.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[E_.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[E_.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[E_.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[E_.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[E_.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[E_.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[E_.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[E_.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[E_.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[E_.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[E_.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[E_.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[E_.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[E_.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[E_.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[E_.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[E_.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[E_.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[E_.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[E_.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[E_.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[E_.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[E_.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[E_.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[E_.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[E_.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[E_.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[E_.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[E_.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[E_.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[E_.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[E_.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[E_.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[E_.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[E_.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[E_.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[E_.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[E_.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[E_.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[E_.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[E_.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[E_.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[E_.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[E_.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[E_.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[E_.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[E_.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[E_.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[E_.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[E_.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[E_.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[E_.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[E_.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[E_.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[E_.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[E_.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[E_.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[E_.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[E_.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[E_.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[E_.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[E_.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function xI($){return ale[$]||{desc:"UNKNOW_ERROR_".concat($),action:"failed"}}function dW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function FV($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?dW(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):dW(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function hW($){return $.every(_e=>_e.readyState===WebSocket.CLOSED||_e.readyState===WebSocket.CLOSING)}function pW($,_e){if(typeof $=="string")return $;const{proxy:_t,host:Wt,port:_n}=$;if(_e){const _i=yE("JOIN_GATEWAY_FALLBACK_PORT")||443;return _i===443?"wss://".concat(Wt,"/ws/?p=").concat(Number(_n)+150):"wss://".concat(Wt,":").concat(_i,"/ws/?p=").concat(Number(_n)+150)}return _t?"wss://".concat(_t,"/ws/?h=").concat(Wt,"&p=").concat(_n):"wss://".concat(Wt,":").concat(_n)}const cle=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,lle=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,ule=/wss:\/\/(.+):([0-9]+)\/?/,dle=/wss:\/\/(.[^\/]+)\/?/;let hle=0;class ple{constructor(_e,_t){hE(this,"id",0),hE(this,"store",void 0),hE(this,"recordIndex",void 0),hE(this,"websockets",[]),hE(this,"try443PortDuration",2e3),hE(this,"forceCloseWSDuration",5e3),hE(this,"try443PortTimeout",null),hE(this,"forceCloseTimeout",null),hE(this,"isTry443PortFailed",!1),hE(this,"isNormalPortFailed",!1),hE(this,"useDoubleDomain",!1),hE(this,"useProxy",!1),hE(this,"startTime",Date.now()),this.id=++hle,this.try443PortDuration=yE("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=_e||5e3,this.store=_t}closeAllWebsockets(){this.websockets.forEach(_e=>{_e.onopen=null,_e.onclose=null,_e.onmessage=null,_e.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var _e;const _t=Date.now()-this.startTime;for(var Wt=arguments.length,_n=new Array(Wt),_i=0;_i<Wt;_i++)_n[_i]=arguments[_i];iE.debug("[choose-best-ws ".concat((_e=this.store)===null||_e===void 0?void 0:_e.clientId," ").concat(this.id,"] ").concat(_t,"ms:"),..._n)}createWebSocket(_e,_t,Wt){this.logger("createWebSocket:",_e,{isTry443Port:_t,hasTimeoutDetection:Wt});const _n=yE("GATEWAY_DOMAINS"),_i=Date.now(),_s=[],_c=_n.find(_p=>{var Qm;return i_(Qm=_e.host).call(Qm,_p)});_c||(this.useDoubleDomain=!1);const _u=[];if(this.useDoubleDomain)_n.forEach(_p=>{_u.push(pW(FV(FV({},_e),{},{host:_e.host.replace(_c,_p)}),_t))});else{const _p=FV({},_e);if(_t&&_c){const Qm=_n.find(_g=>_g!==_c);Qm&&(_p.host=_p.host.replace(_c,Qm))}_u.push(pW(_p,_t))}try{_u.forEach(_p=>{const Qm=new WebSocket(_p);Qm.binaryType="arraybuffer",_s.push(Qm),this.logger("ws is connecting:",Qm.url)})}catch(_p){if(this.logger("ws create failed"),_s.forEach(Qm=>Qm.close()),_s.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(_e,_t,Wt);if(!_t&&Number(_e.port)!==443)return this.createWebSocket(_e,!0,Wt);throw new DE(mE.WS_ERR,"init websocket failed! Error: ".concat(_p.toString()))}const _h=JN();return this.store&&this.store.recordJoinChannelService({urls:_s.map(_p=>_p.url),service:"gateway"},this.recordIndex),_s.forEach(_p=>{_p.onopen=()=>{this.logger("onopen: ws ".concat(_p.url," open cost ").concat(Date.now()-_i,"ms")),this.websockets.forEach(Qm=>{Qm!==_p&&(Qm.onopen=null,Qm.onclose=null,Qm.onmessage=null,Qm.close(),this.logger("close backup websocket: ".concat(Qm.url)))}),this.websockets.length=0,_h.resolve(_p)},_p.onclose=Qm=>{this.logger("onclose: ws ".concat(_p.url," closed cost ").concat(Date.now()-_i,"ms state: ").concat(_p.readyState)),_t?this.isTry443PortFailed=hW(_s):this.isNormalPortFailed=hW(_s),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(_t&&this.isTry443PortFailed||!_t&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(Qm.reason)),_h.reject({code:Qm.code,reason:rP.A_ROUND_WS_FAILED}))},_p.onmessage=Qm=>this.logger("".concat(_p.url," onmessage: ").concat(Qm.data))}),this.websockets.push(..._s),Wt||(()=>{const _p=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",_h.isResolved),this.websockets.forEach(Qm=>Qm.readyState!==WebSocket.OPEN&&Qm.close())};if(_t||this.useProxy)return this.logger("add 5s timeout at ".concat(_t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(_p,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",_h.isResolved),_h.isResolved)return _p();W_().os===uS.MAC_OS&&h0()&&_p(),this.createWebSocket(_e,!0,!0).then(Qm=>_h.resolve(Qm)).catch(Qm=>{this.isNormalPortFailed&&_h.reject(Qm),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(_p,this.forceCloseWSDuration)},this.try443PortDuration)})(),_h.promise}chooseBestWebsocket(_e,_t,Wt,_n){return this.useDoubleDomain=!!_t,typeof _e=="string"&&(_e=function(_i){let _s,_c,_u;return[,_s,_c,_u]=_i.match(cle)||[],_s||([,_c,_u]=_i.match(lle)||[]),_c&&_u||([,_c,_u]=_i.match(ule)||[]),_c&&_u||([,_c]=_i.match(dle)||[]),_c||iE.warning("un-destructible url: ",_i),{proxy:_s,host:_c,port:_u||"443"}}(_e)),this.recordIndex=_n,this.useProxy=!!_e.proxy,Wt&&this.useProxy&&(iE.warn("cannot use 443 only when use proxy"),Wt=!1),this.createWebSocket(_e,!!Wt,!1).finally(()=>this.clearTimeout())}}function fW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}class mW extends A0{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(_e){var _t;i_(_t=["tryNext","recover"]).call(_t,_e)&&this.resetReconnectCount(_e),this._reconnectMode=_e}get state(){return this._state}set state(_e){_e!==this._state&&(this._state=_e,this._state==="reconnecting"?this.emit(T_.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(T_.CONNECTED):this._state==="closed"?this.emit(T_.CLOSED):this._state==="failed"&&this.emit(T_.FAILED))}resetReconnectCount(_e){iE.debug("websocket reset reconnect count, reason: "+_e),this.reconnectCount=0}constructor(_e,_t){let Wt=arguments.length>2&&arguments[2]!==void 0&&arguments[2],_n=arguments.length>3&&arguments[3]!==void 0&&arguments[3],_i=arguments.length>4&&arguments[4]!==void 0&&arguments[4],_s=arguments.length>5?arguments[5]:void 0;super(),hE(this,"connectionID",0),hE(this,"currentURLIndex",0),hE(this,"urls",[]),hE(this,"_reconnectMode","tryNext"),hE(this,"reconnectReason",void 0),hE(this,"_initMutex",new mS("websocket")),hE(this,"name",void 0),hE(this,"_state","closed"),hE(this,"reconnectInterrupter",void 0),hE(this,"websocket",void 0),hE(this,"retryConfig",void 0),hE(this,"reconnectCount",0),hE(this,"forceCloseTimeout",5e3),hE(this,"onlineReconnectListener",void 0),hE(this,"useCompress",void 0),hE(this,"tryDoubleDomain",!1),hE(this,"use443PortOnly",!1),hE(this,"wsInflateLength",0),hE(this,"wsDeflateLength",0),hE(this,"closeEstablishingWs",()=>{}),hE(this,"store",void 0),hE(this,"joinGatewayRecordIndex",void 0),this.store=_s,this.name=_e,this.retryConfig=function(Qm){for(var _g=1;_g<arguments.length;_g++){var eE=arguments[_g]!=null?arguments[_g]:{};_g%2?fW(Object(eE),!0).forEach(function(pE){hE(Qm,pE,eE[pE])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Qm,Object.getOwnPropertyDescriptors(eE)):fW(Object(eE)).forEach(function(pE){Object.defineProperty(Qm,pE,Object.getOwnPropertyDescriptor(eE,pE))})}return Qm}({},_t),this.useCompress=Wt,this.tryDoubleDomain=_n,this.use443PortOnly=_i;const{timeout:_c,timeoutFactor:_u}=_t,_h=Math.max(300,Math.floor(3*_c/5)),_p=Math.max(1.2,Math.floor(8*_u)/10);KS.ONLINE&&(this.retryConfig.timeout=_h,this.retryConfig.timeoutFactor=_p),F0.on(AI.NETWORK_STATE_CHANGE,(Qm,_g)=>{Qm!==_g&&(this.resetReconnectCount("network state change: ".concat(_g," -> ").concat(Qm)),Qm===KS.ONLINE?(this.retryConfig.timeout=_h,this.retryConfig.timeoutFactor=_p):(this.retryConfig.timeout=_c,this.retryConfig.timeoutFactor=_u))})}getConnection(){return this.websocket||void 0}async init(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const Wt=await this._initMutex.lock();this.forceCloseTimeout=_t,this.urls=_e,this.state="connecting";try{const _n=JN(),_i=this.urls[this.currentURLIndex];this.createWebSocketConnection(_i).then(_n.resolve).catch(_n.reject),this.once(T_.CLOSED,()=>{_n.reject(new HE(mE.WS_DISCONNECT))}),this.once(T_.CONNECTED,_n.resolve),await _n.promise}catch{}finally{Wt()}}close(_e,_t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const Wt=this.websocket;_t?setTimeout(()=>Wt.close(),500):Wt.close(),this.websocket=void 0}this.state=_e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(_e,_t){if(!this.websocket)return void iE.warning("[".concat(this.name,"] can not reconnect, no websocket"));_e!==void 0&&(this.reconnectMode=_e),iE.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(_t)]},this.joinGatewayRecordIndex);const Wt=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),Wt&&Wt.bind(this.websocket)({code:9999,reason:_t})}sendMessage(_e){let _t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new HE(mE.WS_ABORT,"websocket is not ready");try{_t||(_e=JSON.stringify(_e)),this.websocket.send(_e)}catch(Wt){throw new HE(mE.WS_ERR,"send websocket message error"+Wt.toString())}}setWsInflateData(_e){this.wsDeflateLength=this.wsDeflateLength+_e.originLength,this.wsInflateLength=this.wsInflateLength+_e.compressedLength}getWsInflateData(){const _e=this.wsInflateLength,_t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:_e,wsDeflateLength:_t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(_e){var _t;const Wt=JN();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const _n=_p=>{var Qm;(Qm=this.store)===null||Qm===void 0||Qm.signalChannelOpen(),iE.debug("[".concat(this.name,"] websocket opened:"),_p),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),Wt.resolve()},_i=async _p=>{var Qm;if(iE.debug("[".concat(this.name,"] websocket close ").concat((Qm=this.websocket)===null||Qm===void 0?void 0:Qm.url,", code: ").concat(_p.code,", reason: ").concat(_p.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)Wt.reject(new HE(mE.WS_DISCONNECT,"websocket close: ".concat(_p.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=_p.reason,this.state="reconnecting");const _g=mT(this,T_.WILL_RECONNECT,this.reconnectMode,_p.reason)||this.reconnectMode,eE=await this.reconnectWithAction(_g);if(this.state==="closed")return void iE.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!eE)return Wt.reject(new HE(mE.WS_DISCONNECT,"websocket reconnect failed: ".concat(_p.code))),this.close(!0);Wt.resolve()}},_s=_p=>{this.emit(T_.ON_MESSAGE,_p)},_c=_p=>{iE.warn("[".concat(this.connectionID,"] ws open error ").concat(_p))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),yE("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(_e=yE("GATEWAY_WSS_ADDRESS")),iE.debug("[".concat(this.name,"] start connect, url:"),_e);const _u=(_t=this.store)===null||_t===void 0?void 0:_t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var _h;const _p=await this.chooseBestWebsocketConnection(_e);this.websocket=_p,_n&&_n(this.websocket.url),this.websocket.onclose=_i,this.websocket.onmessage=_s,this.websocket.onerror=_c,(_h=this.store)===null||_h===void 0||_h.recordJoinChannelService({endTs:Date.now(),status:"success"},_u),this.joinGatewayRecordIndex=_u}catch(_p){const Qm=this.state==="closed",_g=_p instanceof HE,eE=_g&&_p.code===mE.WS_ABORT,pE=_g&&_p.code===mE.WS_ERR,aE=_g?_p.message:_p&&(_p.reason||_p.toString());iE.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(aE)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:eE?"aborted":"error",errors:[_p]},_u),Qm||pE?(Wt.reject(Qm?new HE(mE.WS_DISCONNECT,"websocket is closed: ".concat(aE)):new HE(mE.WS_ERR,"init websocket failed: ".concat(aE))),pE&&iE.error("[".concat(this.name,"] init websocket failed: ").concat(aE))):_i&&_i(_p)}return Wt.promise}async reconnectWithAction(_e){let _t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;iE.warning("[choose-best-ws] action: =>",_e),this.onlineReconnectListener||F0.isOnline||!F0.onlineWaiter||(this.onlineReconnectListener=F0.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let Wt=!0;if(this.reconnectInterrupter=()=>Wt=!1,_t){const _s=RL(this.reconnectCount,this.retryConfig);iE.debug("[".concat(this.name,"] wait ").concat(_s,"ms to reconnect websocket, mode: ").concat(_e)),await n_.race([hS(_s),this.onlineReconnectListener||new n_(()=>{})])}if(this._state==="closed"||!Wt)return!1;this.reconnectCount+=1;const _n=async(_s,_c)=>{this.emit(T_.RECONNECT_CREATE_CONNECTION,_c),await this.createWebSocketConnection(_s)};try{if(_e==="retry")this.emit(T_.RECONNECT_WAITTING_FINISH,_e),await _n(this.urls[this.currentURLIndex],_e);else if(_e==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);iE.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(T_.RECONNECT_WAITTING_FINISH,_e),await _n(this.urls[this.currentURLIndex],_e)}else _e==="recover"&&(iE.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(T_.RECONNECT_WAITTING_FINISH,_e),this.urls=await _y(this,T_.REQUEST_NEW_URLS),this.currentURLIndex=0,await _n(this.urls[this.currentURLIndex],_e))}catch(_s){var _i;iE.error("[".concat(this.name,"] reconnect failed ").concat(_s&&_s.toString()));const _c=_s==null||(_i=_s.data)===null||_i===void 0?void 0:_i.desc;return Array.isArray(_c)&&i_(_c).call(_c,"dynamic key expired")?(this.emit(T_.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(_e,_t)}return!0}}class iP extends mW{constructor(_e,_t){super(_e,_t,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(_e,_t){const Wt=JN(),_n=function(_s,_c){return new ple(_s,_c)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{iE.debug("[choose-best-ws] close establishing websockets"),_n.closeAllWebsockets(),Wt.reject(new HE(mE.WS_ABORT,"choose best websocket aborted"))};const _i=yE("GATEWAY_DOMAINS");return iE.debug("[choose-best-ws] currentDomain: ",_e,", domains: ",_i,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),_n.chooseBestWebsocket(_e,this.tryDoubleDomain,this.use443PortOnly,_t).then(Wt.resolve).catch(Wt.reject),Wt.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class oP extends mW{constructor(_e,_t){super(_e,_t,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(_e,_t){return new n_((Wt,_n)=>{let _i=!1;const _s=[];this.closeEstablishingWs=()=>{iE.debug("[choose-best-ws] close establishing websockets"),_s.forEach(pE=>{pE.onclose=null,pE.onopen=null,pE.onmessage=null,pE.close()}),_n(new HE(mE.WS_ABORT,"choose best websocket aborted"))};const _c=yE("GATEWAY_DOMAINS");let _u;const _h=_e.indexOf("?h="),_p=_c.find(pE=>_h!==-1?i_(_e).call(_e,pE,_h):i_(_e).call(_e,pE));iE.debug("[choose-best-ws] currentDomain: ",_p,", domains: ",_c);let Qm=!this.tryDoubleDomain||!_p;if(!Qm&&_p){var _g;const pE=Date.now();try{_c.forEach(aE=>{const cE=_h===-1?_e.replace(_p,aE):_e.substr(0,_h)+_e.substr(_h).replace(_p,aE),fE=new WebSocket(cE);fE.binaryType="arraybuffer",_s.push(fE),iE.debug("[choose-best-ws] ws is connecting:",fE.url)})}catch{for(iE.debug("[choose-best-ws] ws create failed, fallback to single url"),_s.forEach(cE=>cE.close());_s.length;)_s.pop();Qm=!0}(_g=this.store)===null||_g===void 0||_g.recordJoinChannelService({urls:_s.map(aE=>aE.url),service:"gateway"},_t),_s.forEach(aE=>{aE.onopen=()=>{if(_i)return;const cE=Date.now()-pE;iE.debug("[choose-best-ws] ws open cost ".concat(cE,"ms")),_s.filter(fE=>fE!==aE).forEach(fE=>{iE.debug("[choose-best-ws]close backup websocket: ".concat(fE.url)),fE.close()}),_i=!0,Wt(aE)},aE.onclose=cE=>{_u=cE,!_i&&(_s.find(fE=>!(fE.readyState===WebSocket.CLOSED||fE.readyState===WebSocket.CLOSING))||(iE.debug("[choose-best-ws] all websocket is closed"),_i=!0,_n(_u)))},aE.onmessage=cE=>{iE.debug("[choose-best-ws]".concat(aE.url," onmessage: ").concat(cE.data))}}),hS(this.forceCloseTimeout).then(()=>{_s.forEach(aE=>{aE.readyState!==WebSocket.OPEN&&aE.close()})})}if(Qm){var eE;let pE;iE.debug("[choose-best-ws] use single url: ",_e),(eE=this.store)===null||eE===void 0||eE.recordJoinChannelService({urls:[_e],service:"gateway"},_t);try{pE=new WebSocket(_e),_s.push(pE),pE.binaryType="arraybuffer"}catch(aE){const cE=new HE(mE.WS_ERR,"init websocket failed! Error: ".concat(aE.toString()));return iE.error("[".concat(this.name,"]").concat(cE)),void _n(cE)}pE.onopen=()=>{Wt(pE)},pE.onclose=aE=>{_n(aE)},pE.onmessage=aE=>{iE.debug("[choose-best-ws]".concat(pE.url," onmessage: ").concat(aE.data))},hS(this.forceCloseTimeout).then(()=>{pE&&pE.readyState!==WebSocket.OPEN&&pE.close()})}}).then(Wt=>(this.closeEstablishingWs=void 0,Wt)).catch(Wt=>{throw this.closeEstablishingWs=void 0,Wt})}}class gW extends A0{get connectionState(){return this._connectionState}set connectionState(_e){_e!==this._connectionState&&(this._connectionState=_e,_e===M_.CONNECTED?this.emit(l_.WS_CONNECTED):_e===M_.RECONNECTING?this.emit(l_.WS_RECONNECTING,this._websocketReconnectReason):_e===M_.CLOSED&&this.emit(l_.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(_e,_t){super(),hE(this,"_disconnectedReason",void 0),hE(this,"_websocketReconnectReason",void 0),hE(this,"_connectionState",M_.CLOSED),hE(this,"reconnectToken",void 0),hE(this,"websocket",void 0),hE(this,"openConnectionTime",void 0),hE(this,"clientId",void 0),hE(this,"lastMsgTime",Date.now()),hE(this,"uploadCache",[]),hE(this,"uploadCacheInterval",void 0),hE(this,"rttRolling",new TV(5)),hE(this,"pingpongTimer",void 0),hE(this,"wsInflateDataTimer",void 0),hE(this,"pingpongTimeoutCount",0),hE(this,"joinResponse",void 0),hE(this,"multiIpOption",void 0),hE(this,"initError",void 0),hE(this,"spec",void 0),hE(this,"store",void 0),hE(this,"onWebsocketMessage",Wt=>{if(Wt.data instanceof ArrayBuffer)return void this.emit(l_.ON_BINARY_DATA,Wt.data);const _n=JSON.parse(Wt.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(_n,"_id")){const _i="res-@".concat(_n._id);this.emit(_i,_n._result,_n._message)}else if(Object.prototype.hasOwnProperty.call(_n,"_type")){if(this.emit(_n._type,_n._message),_n._type===C_.ON_NOTIFICATION&&this.handleNotification(_n._message),_n._type===C_.ON_USER_BANNED)switch(_n._message.error_code){case 14:this.close(U_.UID_BANNED);break;case 15:this.close(U_.IP_BANNED);break;case 16:this.close(U_.CHANNEL_BANNED)}if(_n._type===C_.ON_USER_LICENSE_BANNED)switch(_n._message.error_code){case E_.ERR_LICENSE_MISSING:this.close(U_.LICENSE_MISSING);break;case E_.ERR_LICENSE_EXPIRED:this.close(U_.LICENSE_EXPIRED);break;case E_.ERR_LICENSE_MINUTES_EXCEEDED:this.close(U_.LICENSE_MINUTES_EXCEEDED);break;case E_.ERR_LICENSE_PERIOD_INVALID:this.close(U_.LICENSE_PERIOD_INVALID);break;case E_.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(U_.LICENSE_MULTIPLE_SDK_SERVICE);break;case E_.ERR_LICENSE_ILLEGAL:this.close(U_.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=_e.clientId,this.spec=_e,this.store=_t,this.websocket=new iP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,yE("JOIN_GATEWAY_USE_DUAL_DOMAIN"),yE("JOIN_GATEWAY_USE_443PORT_ONLY"),_t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===M_.CONNECTED&&this.reconnect("retry",RS.OFFLINE)})}async request(_e,_t,Wt,_n){const _i=f0(6,""),_s={_id:_i,_type:_e,_message:_t},_c=this.websocket.connectionID,_u=()=>new n_((pE,aE)=>{if(this.connectionState===M_.CONNECTED)return pE();const cE=()=>{this.off(l_.WS_CLOSED,fE),pE()},fE=()=>{this.off(l_.WS_CONNECTED,cE),aE(new DE(mE.WS_ABORT))};this.once(l_.WS_CONNECTED,cE),this.once(l_.WS_CLOSED,fE),_e!==g_.PUBLISH&&_e!==g_.PUBLISH_DATASTREAM&&_e!==g_.SUBSCRIBE&&_e!==g_.SUBSCRIBE_DATASTREAM&&_e!==g_.UNSUBSCRIBE&&_e!==g_.UNSUBSCRIBE_DATASTREAM&&_e!==g_.UNPUBLISH&&_e!==g_.UNPUBLISH_DATASTREAM&&_e!==g_.CONTROL&&_e!==g_.RESTART_ICE||this.once(l_.DISCONNECT_P2P,()=>{aE(new DE(mE.DISCONNECT_P2P))}),_e!==g_.PUBLISH&&_e!==g_.RESTART_ICE||this.once(l_.ABORT_P2P_EXECUTION,()=>{aE(new DE(mE.DISCONNECT_P2P))})});if(this.connectionState!==M_.CONNECTING&&this.connectionState!==M_.RECONNECTING||_e===g_.JOIN||_e===g_.REJOIN||await _u(),this.websocket.sendMessage(_s,!0),_n)return;const _h=new n_((pE,aE)=>{let cE=!1;const fE=(AE,PE)=>{cE=!0,pE({isSuccess:AE==="success",message:PE||{}}),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.emit(l_.REQUEST_SUCCESS,_e,_t)};this.once("res-@".concat(_i),fE);const gE=()=>{aE(new DE(mE.WS_ABORT,"type: ".concat(_e))),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.off("res-@".concat(_i),fE)};this.once(l_.WS_CLOSED,gE),this.once(l_.WS_RECONNECTING,gE),hS(yE("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_c||cE||(iE.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(_e)),this.emit(l_.REQUEST_TIMEOUT,_e,_t))})});let _p=null;try{_p=await _h}catch(pE){if(this.connectionState===M_.CLOSED||_e===g_.LEAVE)throw new DE(mE.WS_ABORT);return!this.spec.forceWaitGatewayResponse||Wt?pE.throw():_e===g_.JOIN||_e===g_.REJOIN?null:(await _u(),await this.request(_e,_t))}if(_p.isSuccess)return _p.message;const Qm=Number(_p.message.error_code||_p.message.code),_g=xI(Qm),eE=new DE(mE.UNEXPECTED_RESPONSE,"".concat(_g.desc,": ").concat(_p.message.error_str),{code:Qm,data:_p.message});return _g.action==="success"?_p.message:(iE.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(_e,", error_code: ").concat(Qm,", message: ").concat(_g.desc,", action: ").concat(_g.action)),Qm===E_.ERR_TOO_MANY_BROADCASTERS?((_e===g_.JOIN||_e===g_.REJOIN)&&(this.initError=eE,this.close()),eE.throw()):_g.action==="failed"?eE.throw():_g.action==="quit"?(this.initError=eE,this.close(),eE.throw()):(Qm===E_.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_p.message.option,iE.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",RS.MULTI_IP)):this.reconnect(_g.action,RS.SERVER_ERROR),_e===g_.JOIN||_e===g_.REJOIN?null:await this.request(_e,_t)))}waitMessage(_e,_t){return new n_(Wt=>{const _n=_i=>{(!_t||_t(_i))&&(this.off(_e,_n),Wt(_i))};this.on(_e,_n)})}uploadWRTCStats(_e){if(!this.store.sessionId)return void iE.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const _t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:_e};this.upload(LI.WRTC_STATS,_t)}upload(_e,_t){const Wt={_type:_e,_message:_t};try{this.websocket.sendMessage(Wt)}catch{const _i=yE("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(Wt),this.uploadCache.length>_i&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==M_.CONNECTED)return;const _s=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_s._type,_s._message)},yE("UPLOAD_CACHE_INTERVAL")||2e3))}}send(_e,_t){const Wt={_type:_e,_message:_t};this.websocket.sendMessage(Wt)}init(_e,_t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new n_((Wt,_n)=>{this.once(l_.WS_CONNECTED,()=>Wt(this.joinResponse)),this.once(l_.WS_CLOSED,()=>_n(this.initError||new DE(mE.WS_ABORT))),this.connectionState=M_.CONNECTING,this.websocket.init(_e).catch(_n),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(_e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=_e||U_.LEAVE,this.connectionState=M_.CLOSED,iE.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),_e===U_.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new iP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,yE("JOIN_GATEWAY_USE_DUAL_DOMAIN"),yE("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(l_.ABORT_P2P_EXECUTION);const _e=await _y(this,l_.REQUEST_JOIN_INFO),_t=await this.request(g_.JOIN,_e);if(!_t)return this.emit(l_.REPORT_JOIN_GATEWAY,rP.TIMEOUT,this.url||""),!1;this.joinResponse=_t,this.emit(l_.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=M_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new DE(mE.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const _e=OI(this,l_.REQUEST_REJOIN_INFO);_e.token=this.reconnectToken;const _t=await this.request(g_.REJOIN,_e);return!!_t&&(this.connectionState=M_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),_t.peers&&_t.peers.forEach(Wt=>{this.emit(C_.ON_USER_ONLINE,{uid:Wt.uid}),Wt.audio&&this.emit(C_.ON_ADD_AUDIO_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id,audio:!0,ssrcId:Wt.audio_ssrc}),Wt.video&&this.emit(C_.ON_ADD_VIDEO_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id,video:!0,ssrcId:Wt.video_ssrc}),Wt.audio_mute?this.emit(C_.MUTE_AUDIO,{uid:Wt.uid}):this.emit(C_.UNMUTE_AUDIO,{uid:Wt.uid}),Wt.video_mute?this.emit(C_.MUTE_VIDEO,{uid:Wt.uid}):this.emit(C_.UNMUTE_VIDEO,{uid:Wt.uid}),Wt.audio_enable_local?this.emit(C_.ENABLE_LOCAL_AUDIO,{uid:Wt.uid}):this.emit(C_.DISABLE_LOCAL_AUDIO,{uid:Wt.uid}),Wt.video_enable_local?this.emit(C_.ENABLE_LOCAL_VIDEO,{uid:Wt.uid}):this.emit(C_.DISABLE_LOCAL_VIDEO,{uid:Wt.uid}),Wt.audio||Wt.video||this.emit(C_.ON_REMOVE_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id})}),!0)}reconnect(_e,_t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(_e,_t)}handleNotification(_e){iE.debug("[".concat(this.clientId,"] receive notification: "),_e);const _t=xI(_e.code);if(_t.action!=="success"){if(_t.action!=="failed")return _t.action==="quit"?(_t.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(U_.UID_BANNED),void this.close()):void this.reconnect(_t.action,RS.SERVER_ERROR);iE.error("[".concat(this.clientId,"] ignore error: "),_t.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const _e=yE("PING_PONG_TIME_OUT"),_t=Date.now();this.pingpongTimeoutCount>=_e&&(iE.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(_t-this.lastMsgTime,"ms")),_t-this.lastMsgTime>yE("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",RS.TIMEOUT):this.request(g_.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const Wt=Date.now()-_t;this.rttRolling.add(Wt),yE("REPORT_STATS")&&this.send(g_.PING_BACK,{pingpongElapse:Wt})}).catch(Wt=>{})}handleWsInflateData(){const{wsInflateLength:_e,wsDeflateLength:_t}=this.websocket.getWsInflateData();_e!==0&&_t!==0&&this.upload(LI.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:_t,ws_inflate_length:_e})}handleWebsocketEvents(){this.websocket.on(T_.RECONNECT_WAITTING_FINISH,_e=>{this.emit(l_.WS_RECONNECT_WAITTING_FINISH,_e)}),this.websocket.on(T_.RECONNECT_CREATE_CONNECTION,_e=>{this.emit(l_.WS_RECONNECT_CREATE_CONNECTION,_e)}),this.websocket.on(T_.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(T_.CLOSED,()=>{this.connectionState=M_.CLOSED}),this.websocket.on(T_.FAILED,()=>{this._disconnectedReason=U_.NETWORK_ERROR,this.connectionState=M_.CLOSED}),this.websocket.on(T_.RECONNECTING,_e=>{this._websocketReconnectReason=_e,this.joinResponse=void 0,this.connectionState===M_.CONNECTED?this.connectionState=M_.RECONNECTING:this.connectionState=M_.CONNECTING}),this.websocket.on(T_.WILL_RECONNECT,(_e,_t,Wt)=>{const _n=OI(this,l_.IS_P2P_DISCONNECTED),_i=_n||_e!=="retry";_n&&_e==="retry"&&(iE.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),_e="tryNext",_t=rP.P2P_DISCONNECTED),_i&&(iE.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(_e)),this.emit(l_.REPORT_JOIN_GATEWAY,_t||rP.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(l_.NEED_RENEW_SESSION,this.websocket.currentURLIndex>=this.websocket.urls.length-1?"recover":_e),this.emit(l_.DISCONNECT_P2P)),Wt(_e)}),this.websocket.on(T_.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(_e=>{iE.warning("[".concat(this.clientId,"] rejoin failed ").concat(_e)),this.reconnect("tryNext",RS.SERVER_ERROR)}):this.join().catch(_e=>{if(this.emit(l_.REPORT_JOIN_GATEWAY,_e.message||_e.code||rP.UNKNOWN_REASON,this.url||""),_e instanceof DE){if(_e.code===mE.UNEXPECTED_RESPONSE&&_e.data.code===E_.ERR_NO_AUTHORIZED)return this.initError=new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,"AgoraRTCError CAN_NOT_GET_GATEWAY_SERVER: dynamic key expired"),iE.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",RS.SERVER_ERROR);iE.error("[".concat(this.clientId,"] join gateway request failed"),_e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",RS.SERVER_ERROR):(this.initError=_e,this.close())}})}),this.websocket.on(T_.REQUEST_NEW_URLS,(_e,_t)=>{_y(this,l_.REQUEST_RECOVER,this.multiIpOption).then(_e).catch(_t)}),this.websocket.on(T_.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(C_.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}let J0=function($){return $[$.CHOOSE_SERVER=11]="CHOOSE_SERVER",$[$.CLOUD_PROXY=18]="CLOUD_PROXY",$[$.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",$[$.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",$}({});function EW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function xL($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?EW(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):EW(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function X1($){return $.match(/^[\.\:\d]+$/)?"".concat($.replace(/[^\d]/g,"-"),".").concat(yE("TURN_DOMAIN")):(iE.info("Unidentified as ip: ".concat($,", use as host")),$)}function VV($,_e){$.addresses||($.addresses=[]);const _t=function(_i,_s){if(yE("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return _i.map(_h=>{let{ip:_p,port:Qm}=_h;return{address:"".concat(_p,":").concat(Qm)}});const _c=yE("GATEWAY_DOMAINS");let _u=_c[1]&&i_(_s).call(_s,_c[1])?1:0;return _i.map(_h=>{let{domain_prefix:_p,port:Qm,ip:_g}=_h;if(_p)return{address:"".concat(_p,".").concat(_c[_u++%_c.length],":").concat(Qm)};const eE=/^[\.\:\d]+$/.test(_g),pE=eE?"".concat(_g.replace(/[^\d]/g,"-"),".").concat(_c[_u++%_c.length],":").concat(Qm):"".concat(_g,":").concat(Qm);return eE||iE.info("Unidentified as ip: ".concat(_g,", use as host")),{ip:_g,port:Qm,address:pE}})}($.addresses,_e),Wt=Array.isArray($.detail)&&$.detail[18];if(Wt&&typeof Wt=="string"){const _i=Wt.split(";");for(let _s=0;_s<_i.length;_s++){var _n;const _c=VS(_n=_i[_s]).call(_n);_t[_s]&&_c&&(_t[_s].ip6=_c)}}return{gatewayAddrs:_t,uid:$.uid,cid:$.cid,cert:$.cert,vid:$.detail&&$.detail[8],uni_lbs_ip:$.detail&&$.detail[1],res:$,csIp:$.detail&&$.detail[502]}}function cT($){return typeof $=="number"?$:$.exact||$.ideal||$.max||$.min||0}function vW($){const _e=$._encoderConfig;if(!_e)return{};const _t={resolution:_e.width&&_e.height?"".concat(cT(_e.width),"x").concat(cT(_e.height)):void 0,maxVideoBW:_e.bitrateMax,minVideoBW:_e.bitrateMin};return typeof _e.frameRate=="number"?(_t.maxFrameRate=_e.frameRate,_t.minFrameRate=_e.frameRate):_e.frameRate&&(_t.maxFrameRate=_e.frameRate.max||_e.frameRate.ideal||_e.frameRate.exact||_e.frameRate.min,_t.minFrameRate=_e.frameRate.min||_e.frameRate.ideal||_e.frameRate.exact||_e.frameRate.max),_t}function _W($){return $>=0&&$<.17?1:$>=.17&&$<.36?2:$>=.36&&$<.59?3:$>=.59&&$<=1?4:$>1?5:0}function sP($,_e){let _t,Wt,_n;switch(_e){case J0.CHOOSE_SERVER:Wt=4096,_n="choose server";break;case J0.CLOUD_PROXY:Wt=1048576,_n="proxy";break;case J0.CLOUD_PROXY_5:Wt=4194304,_n="proxy5";break;case J0.CLOUD_PROXY_FALLBACK:Wt=4194310,_n="proxy fallback";break;default:throw new DE(mE.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:$.detail&&$.detail[502],retry:!1})}if($.response_body.forEach(_i=>{_i.buffer&&_i.buffer.flag===Wt&&(_t={code:_i.buffer.code,addresses:(_i.buffer.edges_services||[]).map(_s=>xL(xL({},_s),{},{ticket:_i.buffer.cert})),server_ts:$.enter_ts,uid:_i.buffer.uid,cid:_i.buffer.cid,cname:_i.buffer.cname,detail:xL(xL({},_i.buffer.detail),$.detail),flag:_i.buffer.flag,opid:$.opid,cert:_i.buffer.cert})}),!_t)throw new DE(mE.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(_n," from multi unilbs response"),{csIp:$.detail&&$.detail[502]});return _t}async function yW($,_e){return await n_.all($.addresses.map(async _t=>({address:X1(_t.ip),tcpport:_t.port,udpport:_t.port,username:_e&&yE("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?_e.toString():CS.username,password:_e&&yE("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await yV(_e.toString()):CS.password})))}function BV($,_e){const _t=_e.getMediaStreamTrack(!0).getSettings(),Wt=_e.videoHeight||_t.height,_n=_e.videoWidth||_t.width;return Wt&&_n?Math.max(Math.min(Wt,_n)/Math.min(cT($.height),cT($.width)),1):(iE.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function Z1($){let{candidateType:_e,relayProtocol:_t,type:Wt,address:_n,port:_i,protocol:_s}=$;return Wt==="local-candidate"?{candidateType:_e,relayProtocol:_t,protocol:_s}:{candidateType:_e,relayProtocol:_t,address:_n,port:_i,protocol:_s}}function bW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}class fle extends A0{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(_e){var _t;i_(_t=["tryNext","recover"]).call(_t,_e)&&this.resetReconnectCount(_e),this._reconnectMode=_e}get state(){return this._state}set state(_e){_e!==this._state&&(this._state=_e,this._state==="reconnecting"?this.emit(_b.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(_b.CONNECTED):this._state==="closed"?this.emit(_b.CLOSED):this._state==="failed"&&this.emit(_b.FAILED))}constructor(_e,_t,Wt,_n){super(),hE(this,"connectionID",0),hE(this,"currentURLIndex",0),hE(this,"reconnectReason",void 0),hE(this,"_reconnectMode","tryNext"),hE(this,"_initMutex",void 0),hE(this,"_name",void 0),hE(this,"_state","closed"),hE(this,"_reconnectInterrupter",void 0),hE(this,"_url",void 0),hE(this,"_retryConfig",void 0),hE(this,"_reconnectCount",0),hE(this,"_forceCloseTimeout",5e3),hE(this,"_onlineReconnectListener",void 0),hE(this,"_closeEstablishingTransmitter",()=>{}),hE(this,"_store",void 0),hE(this,"_joinChannelServiceRecordIndex",void 0),hE(this,"_transmitter",void 0),hE(this,"_useCompress",void 0),hE(this,"_inflateLength",0),hE(this,"_deflateLength",0),this._store=_n,this._name=_e,this._retryConfig=function(_i){for(var _s=1;_s<arguments.length;_s++){var _c=arguments[_s]!=null?arguments[_s]:{};_s%2?bW(Object(_c),!0).forEach(function(_u){hE(_i,_u,_c[_u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_i,Object.getOwnPropertyDescriptors(_c)):bW(Object(_c)).forEach(function(_u){Object.defineProperty(_i,_u,Object.getOwnPropertyDescriptor(_c,_u))})}return _i}({},_t),this._useCompress=Wt}resetReconnectCount(_e){iE.debug("".concat(this._name," reset reconnect count, reason: ").concat(_e)),this._reconnectCount=0}close(_e,_t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const Wt=this._transmitter;_t?setTimeout(()=>Wt.close(),500):Wt.close(),this._transmitter=void 0}this.state=_e?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(_e,_t){if(!this._transmitter)return void iE.warning("[".concat(this._name,"] can not reconnect, no websocket"));var Wt;_e!==void 0&&(this.reconnectMode=_e),iE.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((Wt=this._store)===null||Wt===void 0||Wt.recordJoinChannelService({status:"error",errors:[new Error(_t)]},this._joinChannelServiceRecordIndex));const _n=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),_n&&_n.bind(this._transmitter)({code:9999,reason:_t})}getInflateData(){const _e=this._inflateLength,_t=this._deflateLength;return this.clearInflateData(),{inflateLength:_e,deflateLength:_t}}setInflateData(_e){this._deflateLength=this._deflateLength+_e.originLength,this._inflateLength=this._inflateLength+_e.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}let NR=function($){return $[$.Default=0]="Default",$[$.Ack=1]="Ack",$}({});class mle{constructor(_e,_t,Wt){hE(this,"version",1),hE(this,"initialRTO",void 0),hE(this,"maxBatchAckCount",void 0),hE(this,"maxRTO",void 0),hE(this,"initialRTT",void 0),hE(this,"ID",void 0),hE(this,"rtt",void 0),hE(this,"packetNumber",1),hE(this,"rtoRatioMap",new Map),hE(this,"timeoutMap",new Map),hE(this,"unorderedPacketQueue",[]),hE(this,"batchAckPacketQueue",[]),hE(this,"lastOrderedPacketNumber",0),hE(this,"batchAckTimer",void 0),hE(this,"sendImpl",void 0),hE(this,"receiveImpl",void 0),this.sendImpl=_e,this.receiveImpl=_t,this.ID=f0(7,"transmitter-"),this.initialRTO=(Wt==null?void 0:Wt.initialRTO)!==void 0?Wt.initialRTO:yE("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(Wt==null?void 0:Wt.initialRTT)!==void 0?Wt.initialRTT:yE("TRANSMITTER_INITIAL_RTT"),this.rtt=(Wt==null?void 0:Wt.initialRTT)!==void 0?Wt.initialRTT:yE("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(Wt==null?void 0:Wt.maxBatchAckCount)!==void 0?Wt.maxBatchAckCount:yE("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(Wt==null?void 0:Wt.maxRTO)!==void 0?Wt.maxRTO:yE("TRANSMITTER_MAX_RTO")}packetize(_e,_t){return{type:NR.Default,version:this.version,packetNumber:_t,payload:_e}}serialize(_e){switch(_e.type){case NR.Default:{let _t;typeof _e.payload=="string"?_t=new TextEncoder().encode(_e.payload):_t=_e.payload;const Wt=new ArrayBuffer(_t.length+15),_n=new DataView(Wt);return _n.setUint16(0,_e.version),_n.setUint8(2,_e.type),_n.setUint32(3,_e.packetNumber),NH(_n,7,BigInt(_e.sendTs)),new Uint8Array(_n.buffer).set(_t,15),Wt}case NR.Ack:{const _t=new ArrayBuffer(16),Wt=new DataView(_t);return Wt.setUint16(0,_e.version),Wt.setUint8(2,_e.type),Wt.setUint32(3,_e.maxAckPacketNumber),Wt.setUint8(7,_e.shift),NH(Wt,8,BigInt(_e.ackSendTs)),_t}}}deserialize(_e){const _t=new DataView(_e),Wt=_t.getUint16(0),_n=_t.getUint8(2);switch(_n){case NR.Default:{const _i=_t.getUint32(3),_s=OH(_t,7),_c=_e.slice(15),_u=new TextDecoder().decode(_c);return{version:Wt,type:_n,packetNumber:_i,sendTs:Number(_s),payload:_u}}case NR.Ack:{const _i=_t.getUint32(3),_s=_t.getUint8(7),_c=OH(_t,8);return{version:Wt,type:_n,maxAckPacketNumber:_i,shift:_s,ackSendTs:Number(_c)}}default:throw iE.error("[".concat(this.ID,"] Unrecognized packet type ").concat(_n)),new Error("Unrecognized packet type ".concat(_n))}}sendMessage(_e){const _t=this.packetize(_e,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const Wt=this.calculateRTO(_t),_n=window.setTimeout(()=>{this.resendMessage(_t)},Wt);this.timeoutMap.set(_t.packetNumber,_n),this.sendPacket(_t)}onData(_e){const _t=this.deserialize(_e);_t.type===NR.Default?this.ack(_t):_t.type===NR.Ack&&(this.updateRTT(_t,Math.round(performance.now())),this.clearRTO(_t))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(_e=>{let[_t,Wt]=_e;window.clearTimeout(Wt)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(_e){const _t=this.calculateRTO(_e),Wt=window.setTimeout(()=>{this.resendMessage(_e)},_t);this.timeoutMap.set(_e.packetNumber,Wt),this.sendPacket(_e)}calculateRTO(_e){const _t=this.rtoRatioMap.get(_e.packetNumber);if(_t===void 0)return this.rtoRatioMap.set(_e.packetNumber,1),this.initialRTO;{const Wt=9*this.rtt/8*_t;return this.rtoRatioMap.set(_e.packetNumber,_t+1),Wt>this.maxRTO?this.maxRTO:Wt}}updateRTT(_e,_t){const Wt=_e.ackSendTs;this.rtt=this.rtt*(7/8)+(_t-Wt-this.rtt)/8}ack(_e){if(_e.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(_e):(this.batchAckPacketQueue.push(_e),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(_e.payload);;){const _t=this.unorderedPacketQueue[0];if(!_t){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(_t.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(_e.packetNumber<=this.lastOrderedPacketNumber){const _t={ackSendTs:_e.sendTs,maxAckPacketNumber:_e.packetNumber,shift:0,type:NR.Ack,version:this.version};this.sendPacket(_t)}else if(_e.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[_e.packetNumber-this.lastOrderedPacketNumber-2]=_e;const _t={ackSendTs:_e.sendTs,maxAckPacketNumber:_e.packetNumber,shift:0,type:NR.Ack,version:this.version};this.sendPacket(_t)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const _e={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:NR.Ack,version:this.version};this.sendPacket(_e),this.batchAckPacketQueue=[]}sendPacket(_e){_e.type===NR.Default&&(_e.sendTs=Math.round(performance.now()));const _t=this.serialize(_e);this.sendImpl(_t)}clearRTO(_e){for(let _t=_e.maxAckPacketNumber-_e.shift;_t<=_e.maxAckPacketNumber;_t++){const Wt=this.timeoutMap.get(_t);Wt!==void 0&&window.clearTimeout(Wt),this.timeoutMap.delete(_t),this.rtoRatioMap.delete(_t)}}}class SW extends fle{constructor(_e,_t){super(_e,_t,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),hE(this,"_initMutex",void 0),hE(this,"_reconnectInterrupter",void 0),hE(this,"_url",void 0),hE(this,"_transmitter",void 0),hE(this,"_addresses",void 0),hE(this,"_reliableTransmission",void 0),this._initMutex=new mS("datachannel");const{timeout:Wt,timeoutFactor:_n}=_t,_i=Math.max(300,Math.floor(3*Wt/5)),_s=Math.max(1.2,Math.floor(8*_n)/10);KS.ONLINE&&(this._retryConfig.timeout=_i,this._retryConfig.timeoutFactor=_s),F0.on(AI.NETWORK_STATE_CHANGE,(_c,_u)=>{_c!==_u&&(this.resetReconnectCount("network state change: ".concat(_u," -> ").concat(_c)),_c===KS.ONLINE?(this._retryConfig.timeout=_i,this._retryConfig.timeoutFactor=_s):(this._retryConfig.timeout=Wt,this._retryConfig.timeoutFactor=_n))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=_t;const Wt=(_n,_i)=>{this._addresses=_e,this.currentURLIndex=this._addresses.findIndex(_c=>_c.fingerprint||yE("FINGERPRINT"));const _s=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(_s).then(_n).catch(_i),this.once(_b.CLOSED,()=>_i(new DE(mE.WS_DISCONNECT))),this.once(_b.CONNECTED,()=>_n())};return this._initMutex.lock().then(_n=>new n_((_i,_s)=>{Wt(_i,_s)}).then(()=>{_n()}).catch(()=>{_n()}))}sendMessage(_e){let _t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new DE(mE.WS_ABORT,"datachannel is not ready");try{_t||(_e=JSON.stringify(_e)),this._reliableTransmission.sendMessage(_e)}catch(Wt){throw new DE(mE.WS_ERR,"send datachannel signal message error"+Wt.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(_e){const _t=JSON.stringify(_e);return{compressed:_t,compressedLength:_t.length,origin:_e}}sendMessageWithUint8Array(_e){return{compressed:_e,compressedLength:_e.byteLength,origin:_e}}createTransmitterConnection(_e){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(_e.ip,":").concat(_e.port),new n_((_t,Wt)=>{var _n;const _i=()=>{iE.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),_t()},_s=async _p=>{var Qm;if((Qm=this._closeEstablishingTransmitter)===null||Qm===void 0||Qm.call(this),iE.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(_p.code,", reason: ").concat(_p.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=_p.reason,this.state="reconnecting");const _g=mT(this,_b.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,eE=await this.reconnectWithAction(_g);if(this.state==="closed")return void iE.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!eE)return Wt(new DE(mE.WS_DISCONNECT,"datachannel reconnect failed: ".concat(_p.code))),void this.close(!0);_t()}else Wt(new DE(mE.WS_DISCONNECT,"datachannel close: ".concat(_p.code))),this.close()},_c=_p=>{var Qm;(Qm=this._reliableTransmission)===null||Qm===void 0||Qm.onData(_p.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),iE.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(_e)));const _u=(_n=this._store)===null||_n===void 0?void 0:_n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),_h=Date.now();_y(this,_b.TO_CONNECT_DATACHANNEL,_e).then(_p=>{var Qm,_g;if(!_p)throw new Error("transmissonInfo not exist yet");const{transmitter:eE,close:pE}=_p;this._transmitter=eE,(Qm=this._store)===null||Qm===void 0||Qm.signalChannelOpen();const aE=Date.now()-_h;iE.debug("[choose dc] dc open cost ".concat(aE,"ms")),this._reliableTransmission=new mle(cE=>{var fE;this._transmitter&&this._transmitter.readyState==="open"&&((fE=this._transmitter)===null||fE===void 0||fE.send(cE))},cE=>{typeof cE=="string"&&this.emit(_b.ON_MESSAGE,cE)}),this._closeEstablishingTransmitter=()=>{var cE;(cE=this._reliableTransmission)===null||cE===void 0||cE.close(),this._reliableTransmission=void 0,pE()},_i&&_i(),eE.onclose=_s,eE.onmessage=_c,(_g=this._store)===null||_g===void 0||_g.recordJoinChannelService({endTs:Date.now(),status:"success"},_u),this._joinChannelServiceRecordIndex=_u}).catch(_p=>{var Qm;if((Qm=this._store)===null||Qm===void 0||Qm.recordJoinChannelService({endTs:Date.now(),status:_p instanceof DE&&_p.code===mE.WS_ABORT?"aborted":"error",errors:[_p]},_u),this.state!=="closed"){if(_p instanceof DE&&_p.code===mE.WS_ERR){const _g=new DE(mE.WS_ERR,"init datachannel failed! Error: ".concat(_p.toString()));return iE.error("[".concat(this._name,"]").concat(_g)),void Wt(_g)}_s&&_s(_p)}else Wt(new DE(mE.WS_DISCONNECT,"datachannel is closed: ".concat(_p.toString())))})})}async reconnectWithAction(_e){let _t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||F0.networkState!==KS.OFFLINE||(this._onlineReconnectListener=F0.onlineWaiter&&F0.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let Wt=!0;if(this._reconnectInterrupter=()=>{Wt=!1},_t){const _c=RL(this._reconnectCount,this._retryConfig);iE.debug("[".concat(this._name,"] wait ").concat(_c,"ms to reconnect datachannel, mode: ").concat(_e)),await n_.race([hS(_c),this._onlineReconnectListener||new n_(()=>{})])}if(this.state==="closed"||!Wt)return!1;this._reconnectCount+=1;const _n=async(_c,_u)=>{this.emit(_b.RECONNECT_CREATE_CONNECTION,_u),await this.createTransmitterConnection(_c)};try{if(_e==="retry"){const _c=this._addresses[this.currentURLIndex];this.emit(_b.RECONNECT_WAITTING_FINISH,_e),await _n(_c,_e)}else if(_e==="tryNext"){this.currentURLIndex+=1;for(let _u=this.currentURLIndex;_u<this._addresses.length;_u++){if(this._addresses[_u].fingerprint||yE("FINGERPRINT")){this.currentURLIndex=_u;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return iE.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);iE.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const _c=this._addresses[this.currentURLIndex];this.emit(_b.RECONNECT_WAITTING_FINISH,_e),await _n(_c,_e)}else _e==="recover"&&(iE.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(_b.RECONNECT_WAITTING_FINISH,_e),this.emit(_b.FAILBACK));return!0}catch(_c){var _i,_s;return iE.error("[".concat(this._name,"] reconnect failed"),_c.toString()),_c!=null&&(_i=_c.data)!==null&&_i!==void 0&&_i.desc&&Array.isArray(_c.data.desc)&&_c.data.desc.length&&i_(_s=_c.data.desc).call(_s,"dynamic key expired")?(this.emit(_b.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(_e,_t)}}}class b1 extends A0{get connectionState(){return this._connectionState}set connectionState(_e){_e!==this._connectionState&&(this._connectionState=_e,_e===M_.CONNECTED?this.emit(l_.WS_CONNECTED):_e===M_.RECONNECTING?this.emit(l_.WS_RECONNECTING,this._websocketReconnectReason):_e===M_.CLOSED&&this.emit(l_.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(_e,_t){super(),hE(this,"_disconnectedReason",void 0),hE(this,"_websocketReconnectReason",void 0),hE(this,"_connectionState",M_.CLOSED),hE(this,"reconnectToken",void 0),hE(this,"websocket",void 0),hE(this,"openConnectionTime",void 0),hE(this,"clientId",void 0),hE(this,"lastMsgTime",Date.now()),hE(this,"uploadCache",[]),hE(this,"uploadCacheInterval",void 0),hE(this,"rttRolling",new TV(5)),hE(this,"pingpongTimer",void 0),hE(this,"inflateDataTimer",void 0),hE(this,"pingpongTimeoutCount",0),hE(this,"joinResponse",void 0),hE(this,"multiIpOption",void 0),hE(this,"initError",void 0),hE(this,"spec",void 0),hE(this,"store",void 0),hE(this,"onWebsocketMessage",Wt=>{if(Wt instanceof ArrayBuffer)return void this.emit(l_.ON_BINARY_DATA,Wt);const _n=JSON.parse(Wt);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(_n,"_id")){const _i="res-@".concat(_n._id);this.emit(_i,_n._result,_n._message)}else if(Object.prototype.hasOwnProperty.call(_n,"_type")&&(this.emit(_n._type,_n._message),_n._type===C_.ON_NOTIFICATION&&this.handleNotification(_n._message),_n._type===C_.ON_USER_BANNED))switch(_n._message.error_code){case 14:this.close(U_.UID_BANNED);break;case 15:this.close(U_.IP_BANNED);break;case 16:this.close(U_.CHANNEL_BANNED)}}),this.clientId=_e.clientId,this.spec=_e,this.store=_t,this.websocket=new SW("gateway-".concat(this.clientId),this.spec.retryConfig,!0,_t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===M_.CONNECTED&&this.reconnect("retry",Y1.OFFLINE)})}async request(_e,_t,Wt,_n){const _i=f0(6,""),_s={_id:_i,_type:_e,_message:_t},_c=this.websocket.connectionID,_u=()=>new n_((pE,aE)=>{if(this.connectionState===M_.CONNECTED)return pE();const cE=()=>{this.off(l_.WS_CLOSED,fE),pE()},fE=()=>{this.off(l_.WS_CONNECTED,cE),aE(new DE(mE.WS_ABORT))};this.once(l_.WS_CONNECTED,cE),this.once(l_.WS_CLOSED,fE),_e!==g_.PUBLISH&&_e!==g_.SUBSCRIBE&&_e!==g_.UNSUBSCRIBE&&_e!==g_.UNPUBLISH&&_e!==g_.CONTROL&&_e!==g_.RESTART_ICE||this.once(l_.DISCONNECT_P2P,()=>{aE(new DE(mE.DISCONNECT_P2P))}),_e!==g_.PUBLISH&&_e!==g_.RESTART_ICE||this.once(l_.ABORT_P2P_EXECUTION,()=>{aE(new DE(mE.DISCONNECT_P2P))})});if(this.connectionState!==M_.CONNECTING&&this.connectionState!==M_.RECONNECTING||_e===g_.JOIN||_e===g_.REJOIN||await _u(),_e===g_.LEAVE&&(this.websocket.unbindDcCloseEventListener(),_n=!0),this.websocket.sendMessage(_s,!0,!1),_n)return;const _h=new n_((pE,aE)=>{let cE=!1;const fE=(AE,PE)=>{cE=!0,pE({isSuccess:AE==="success",message:PE||{}}),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.emit(l_.REQUEST_SUCCESS,_e,_t)};this.once("res-@".concat(_i),fE);const gE=()=>{aE(new DE(mE.WS_ABORT,"type: ".concat(_e))),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.off("res-@".concat(_i),fE)};this.once(l_.WS_CLOSED,gE),this.once(l_.WS_RECONNECTING,gE),hS(yE("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_c||cE||(iE.warning("dc request timeout, type: ".concat(_e)),this.emit(l_.REQUEST_TIMEOUT,_e,_t))})});let _p=null;try{_p=await _h}catch(pE){if(this.connectionState===M_.CLOSED||_e===g_.LEAVE)throw new DE(mE.WS_ABORT);return!this.spec.forceWaitGatewayResponse||Wt?pE.throw():_e===g_.JOIN||_e===g_.REJOIN?null:(await _u(),await this.request(_e,_t))}if(_p.isSuccess)return _p.message;const Qm=Number(_p.message.error_code||_p.message.code),_g=xI(Qm),eE=new DE(mE.UNEXPECTED_RESPONSE,"".concat(_g.desc,": ").concat(_p.message.error_str),{code:Qm,data:_p.message});return _g.action==="success"?_p.message:(iE.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(_e,", error_code: ").concat(Qm,", message: ").concat(_g.desc,", action: ").concat(_g.action)),Qm===E_.ERR_TOO_MANY_BROADCASTERS?((_e===g_.JOIN||_e===g_.REJOIN)&&(this.initError=eE,this.close()),eE.throw()):_g.action==="failed"?eE.throw():_g.action==="quit"?(this.initError=eE,this.close(),eE.throw()):(Qm===E_.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_p.message.option,iE.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Y1.MULTI_IP)):this.reconnect(_g.action,Y1.SERVER_ERROR),_e===g_.JOIN||_e===g_.REJOIN?null:await this.request(_e,_t)))}waitMessage(_e,_t){return new n_(Wt=>{const _n=_i=>{(!_t||_t(_i))&&(this.off(_e,_n),Wt(_i))};this.on(_e,_n)})}uploadWRTCStats(_e){if(!this.store.sessionId)return void iE.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const _t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:_e};this.upload(LI.WRTC_STATS,_t)}upload(_e,_t){const Wt={_type:_e,_message:_t};try{this.websocket.sendMessage(Wt)}catch{const _i=yE("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(Wt),this.uploadCache.length>_i&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==M_.CONNECTED)return;const _s=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_s._type,_s._message)},yE("UPLOAD_CACHE_INTERVAL")||2e3))}}send(_e,_t){const Wt={_type:_e,_message:_t};this.websocket.sendMessage(Wt)}init(_e,_t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new n_((Wt,_n)=>{this.once(l_.WS_CONNECTED,()=>Wt(this.joinResponse)),this.once(l_.WS_CLOSED,()=>_n(this.initError||new DE(mE.WS_ABORT))),this.connectionState=M_.CONNECTING,this.websocket.init(_e).catch(_n),this.websocket.once(_b.FAILBACK,()=>{this.openConnectionTime===void 0&&_n(new DE(mE.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{_t&&this.openConnectionTime===void 0&&(iE.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),_n(new DE(mE.INIT_DATACHANNEL_TIMEOUT)))},yE("DC_JOIN_WITH_FAILBACK"))})}close(_e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=_e||U_.LEAVE,this.connectionState=M_.CLOSED,iE.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),_e===U_.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new SW("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(l_.ABORT_P2P_EXECUTION);const _e=await _y(this,l_.DATACHANNEL_CONNECTING),_t=await this.request(g_.JOIN,_e);if(!_t)return this.emit(l_.REPORT_JOIN_GATEWAY,mE.TIMEOUT,this.url||""),!1;this.joinResponse=_t,this.emit(l_.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=M_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new DE(mE.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const _e=OI(this,l_.REQUEST_REJOIN_INFO);_e.token=this.reconnectToken;const _t=await this.request(g_.REJOIN,_e);return!!_t&&(this.connectionState=M_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),_t.peers&&_t.peers.forEach(Wt=>{this.emit(C_.ON_USER_ONLINE,{uid:Wt.uid}),Wt.audio&&this.emit(C_.ON_ADD_AUDIO_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id,audio:!0,ssrcId:Wt.audio_ssrc}),Wt.video&&this.emit(C_.ON_ADD_VIDEO_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id,video:!0,ssrcId:Wt.video_ssrc}),Wt.audio_mute?this.emit(C_.MUTE_AUDIO,{uid:Wt.uid}):this.emit(C_.UNMUTE_AUDIO,{uid:Wt.uid}),Wt.video_mute?this.emit(C_.MUTE_VIDEO,{uid:Wt.uid}):this.emit(C_.UNMUTE_VIDEO,{uid:Wt.uid}),Wt.audio_enable_local?this.emit(C_.ENABLE_LOCAL_AUDIO,{uid:Wt.uid}):this.emit(C_.DISABLE_LOCAL_AUDIO,{uid:Wt.uid}),Wt.video_enable_local?this.emit(C_.ENABLE_LOCAL_VIDEO,{uid:Wt.uid}):this.emit(C_.DISABLE_LOCAL_VIDEO,{uid:Wt.uid}),Wt.audio||Wt.video||this.emit(C_.ON_REMOVE_STREAM,{uid:Wt.uid,uint_id:Wt.uint_id})}),!0)}reconnect(_e,_t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(_e,_t)}handleNotification(_e){iE.debug("[".concat(this.clientId,"] receive notification: "),_e);const _t=xI(_e.code);if(_t.action!=="success"){if(_t.action!=="failed")return _t.action==="quit"?(_t.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(U_.UID_BANNED),void this.close()):void this.reconnect(_t.action,Y1.SERVER_ERROR);iE.error("[".concat(this.clientId,"] ignore error: "),_t.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const _e=yE("PING_PONG_TIME_OUT"),_t=Date.now();this.pingpongTimeoutCount>=_e&&(iE.warning("PINGPONG Timeout. Last Socket Message: ".concat(_t-this.lastMsgTime,"ms")),_t-this.lastMsgTime>yE("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Y1.TIMEOUT):this.request(g_.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const Wt=Date.now()-_t;this.rttRolling.add(Wt),yE("REPORT_STATS")&&this.send(g_.PING_BACK,{pingpongElapse:Wt})}).catch(Wt=>{})}handleInflateData(){const{inflateLength:_e,deflateLength:_t}=this.websocket.getInflateData();_e!==0&&_t!==0&&this.upload(LI.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:_t,ws_inflate_length:_e})}handleWebsocketEvents(){this.websocket.on(_b.RECONNECT_WAITTING_FINISH,_e=>{this.emit(l_.WS_RECONNECT_WAITTING_FINISH,_e)}),this.websocket.on(_b.RECONNECT_CREATE_CONNECTION,_e=>{this.emit(l_.WS_RECONNECT_CREATE_CONNECTION,_e)}),this.websocket.on(_b.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(_b.CLOSED,()=>{this.connectionState=M_.CLOSED}),this.websocket.on(_b.FAILED,()=>{this._disconnectedReason=U_.NETWORK_ERROR,this.connectionState=M_.CLOSED}),this.websocket.on(_b.RECONNECTING,_e=>{this._websocketReconnectReason=_e,this.joinResponse=void 0,this.connectionState===M_.CONNECTED?this.connectionState=M_.RECONNECTING:this.connectionState=M_.CONNECTING}),this.websocket.on(_b.WILL_RECONNECT,(_e,_t)=>{if(OI(this,l_.IS_P2P_DISCONNECTED)&&_e==="retry")return iE.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(l_.NEED_RENEW_SESSION),this.emit(l_.DISCONNECT_P2P),_t("tryNext");_e!=="retry"&&(iE.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(_e)),this.reconnectToken=void 0,this.emit(l_.NEED_RENEW_SESSION),this.emit(l_.DISCONNECT_P2P)),_t(_e)}),this.websocket.on(_b.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(_e=>{iE.warning("[".concat(this.clientId,"] rejoin failed ").concat(_e)),this.reconnect("tryNext",Y1.SERVER_ERROR)}):this.join().catch(_e=>{if(this.emit(l_.REPORT_JOIN_GATEWAY,_e.message||_e.code,this.url||""),_e instanceof DE&&_e.code===mE.UNEXPECTED_RESPONSE&&_e.data.code===E_.ERR_NO_AUTHORIZED)return iE.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Y1.SERVER_ERROR);iE.error("[".concat(this.clientId,"] join gateway request failed"),_e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Y1.SERVER_ERROR):(this.initError=_e,this.close())})}),this.websocket.on(_b.REQUEST_NEW_URLS,(_e,_t)=>{_y(this,l_.REQUEST_RECOVER,this.multiIpOption).then(_e).catch(_t)}),this.websocket.on(_b.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(C_.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(_b.TO_CONNECT_DATACHANNEL,async(_e,_t,Wt)=>_y(this,l_.DATACHANNEL_PRECONNECT,_e).then(_t).catch(Wt)),this.websocket.on(_b.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(l_.DATACHANNEL_FAILBACK)})}}class MI extends A0{constructor(_e,_t){super(),hE(this,"signal",void 0),hE(this,"token",void 0),hE(this,"tokenTimeout",void 0),hE(this,"tokenInterval",void 0),hE(this,"_sequence",0),hE(this,"userMap",new Map),hE(this,"encoder",new TextEncoder),this.signal=_e,this.token=_t;const Wt=()=>{this.signal.connectionState===M_.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(Wt,1e3):this.tokenInterval=window.setTimeout(Wt,3*yE("P2P_TOKEN_INTERVAL"))};Wt()}async send(_e,_t,Wt,_n,_i){var _s,_c,_u;if(this.userMap.size===0)return;const _h=Array.from(AR(_s=this.userMap).call(_s))[0].token;typeof _t!="string"&&(_t=JSON.stringify(_t)),_n=(_c=_n)!==null&&_c!==void 0?_c:f0(6,""),_i=(_u=_i)!==null&&_u!==void 0?_u:this._sequence++;const _p={_id:_n,_type:_e,_seq:_i,_message:_t,token:"".concat(this.token,"_").concat(_h)};yE("SHOW_P2P_LOG")&&iE.debug("send message",_p,"noNeedResponse : ".concat(Wt)),this.splitMessage(JSON.stringify(_p)).forEach(_g=>{this.signal.request(g_.DATA_STREAM,{payload:z1(this.encoder.encode(_g))})});const Qm=new n_((_g,eE)=>{const pE=window.setTimeout(()=>{this.off("res-@".concat(_n,"_ack"),aE),this.off("res-@".concat(_n),fE),this.off(xO.ABORT,cE),iE.debug("[external-signal] request timeout, type: ".concat(_e,", requestId: ").concat(_n)),this.userMap.size===0?eE(new HE(mE.INVALID_REMOTE_USER)):eE(new HE(mE.TIMEOUT))},yE("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),aE=()=>{pE&&window.clearTimeout(pE),this.off(xO.ABORT,cE),Wt&&_g()},cE=()=>{pE&&window.clearTimeout(pE),this.off("res-@".concat(_n,"_ack"),aE),this.off("res-@".concat(_n),fE),eE(new HE(mE.EXTERNAL_SIGNAL_ABORT,"type: ".concat(_e,", requestId: ").concat(_n)))};this.once(xO.ABORT,cE),this.once("res-@".concat(_n,"_ack"),aE);const fE=(AE,PE)=>{gE=!0,pE&&window.clearTimeout(pE),this.off("res-@".concat(_n,"_ack"),aE),this.off(xO.ABORT,cE),AE==="success"?_g(PE):eE(new HE(mE.P2P_MESSAGE_FAILED,"request ".concat(_e," failed, requestId: ").concat(_n)))};let gE=!1;Wt||(this.once("res-@".concat(_n),fE),hS(yE("SIGNAL_REQUEST_TIMEOUT")).then(()=>{gE||iE.warning("external_signal request timeout, type: ".concat(_e,", requestId: ").concat(_n,", ").concat(_p))}))});try{return await Qm}catch(_g){if(_g.code===mE.TIMEOUT)return await this.send(_e,_t,Wt,_n,_i);throw _g}}onMessage(_e){var _t;const{_uid:Wt}=_e;let _n,_i=this.userMap.get(Wt);if(_i)_n=_i.splitMessageMap;else{if(this.userMap.size>0||!("_type"in _e)||_e._type!==W0.CHECK)return;const{token:_h}=_e;_n=new Map,_i={uid:Wt,isStart:!0,token:_h,splitMessageMap:_n,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(Wt,_i),this.signal.emit(C_.ON_USER_ONLINE,{uid:Wt}),this.handleUserOnline()}if("id"in _e&&"total"in _e){var _s;const{id:_h,total:_p}=_e,Qm=(_s=_n.get(_h))!==null&&_s!==void 0?_s:[];if(Qm.push(_e),_n.has(_h)||_n.set(_h,Qm),Qm.length!==_p)return;{const _g=MN(Qm).call(Qm,(eE,pE)=>eE.index-pE.index).map(eE=>eE.payload).join("");_n.delete(_h),(_e=JSON.parse(_g))._uid=Wt}}const{_type:_c,token:_u}=_e;if(i_(_t=[W0.ACK,W0.CHECK]).call(_t,_c))return _c===W0.CHECK&&this.handleCheckToken(_i,_u),void this.receiveMessage(_e);_u==="".concat(_i.token,"_").concat(this.token)?this.handleReceivedMessage(_e):iE.debug('Receive unexpected message", '.concat(_u,", cur_token: ").concat(_i.token,"_").concat(this.token),_e)}check(){const _e={_id:f0(6,""),token:this.token,_type:W0.CHECK};yE("SHOW_P2P_LOG")&&iE.debug("send message",_e),this.signal.request(g_.DATA_STREAM,{payload:z1(this.encoder.encode(JSON.stringify(_e)))})}ack(_e){const _t={_id:_e,_type:W0.ACK,token:this.token};yE("SHOW_P2P_LOG")&&iE.debug("send message",_t),this.signal.request(g_.DATA_STREAM,{payload:z1(this.encoder.encode(JSON.stringify(_t)))})}response(_e,_t,Wt){this.send(W0.RESPONSE,JSON.stringify({success:!Wt,message:_t}),!0,_e)}handleReceivedMessage(_e){const _t=()=>{this.userMap.forEach(_h=>{const{receivedMessagesMap:_p,nextExpectedSequenceNumber:Qm}=_h;for(;_p.has(Qm);){const _g=_p.get(Qm);_p.delete(Qm),this.receiveMessage(_g),_h.nextExpectedSequenceNumber++}})};if(!_e)return void _t();const{_uid:Wt,_seq:_n}=_e,_i=this.userMap.get(Wt),{receivedMessagesMap:_s,isStart:_c,nextExpectedSequenceNumber:_u}=_i;if(_n<_u)return this.ack(_e._id),void iE.debug("[external-signal] receive old message, seq: ".concat(_n,", ").concat(_e._message));_s.set(_n,_e),_c&&_n===_u&&(this.receiveMessage(_e),_s.delete(_u),_i.nextExpectedSequenceNumber++,_t())}receiveMessage(_e){const{_id:_t,_type:Wt,_message:_n,_uid:_i}=_e;if(yE("SHOW_P2P_LOG")&&iE.debug("receive message",_e),_t){let _s;switch(_e._type!==W0.ACK&&(_n&&(_s=JSON.parse(_n)),this.ack(_e._id)),_e._type){case W0.CANDIDATE:case W0.CONTROL:this.signal.emit(Wt,_s,_i);break;case W0.PUBLISH:case W0.UNPUBLISH:case W0.RESTART_ICE:case W0.CALL:_s.uid=_i,_y(this.signal,Wt,_s).then(_c=>{this.response(_e._id,_c)}).catch(()=>{this.response(_e._id,void 0,!0)});break;case W0.ACK:this.getListeners("res-@".concat(_t,"_ack")).length>0&&this.emit("res-@".concat(_t,"_ack"));break;case W0.RESPONSE:{const{success:_c,message:_u}=_s;this.emit("res-@".concat(_t),_c?"success":"failed",_u);break}}}}splitMessage(_e){if(_e.length<MI.MAX_MESSAGE_SIZE)return[_e];const _t=[],{remoteToken:Wt}=JSON.parse(_e),_n=f0(6,"");let _i=0,_s=800;const _c=Math.ceil(_e.length/_s);for(;_e.length>0;){_i++;const _u={id:_n,index:_i,total:_c,payload:_e.slice(0,_s),token:"".concat(this.token,"_").concat(Wt)};JSON.stringify(_u).length>MI.MAX_MESSAGE_SIZE?_s-=50:(_t.push(_u),_e=_e.slice(_s))}return _t.map(_u=>JSON.stringify(_u))}handleCheckToken(_e,_t){return _e.token!==_t?(iE.debug("token changed, from ".concat(_e.token," to ").concat(_t)),this.reset(_e.uid,_t),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{iE.debug("token timeout, ".concat(_t)),this.reset(_e.uid)},yE("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const _e=await _y(this.signal,W0.CALL,void 0),_t=await this.send(W0.CALL,_e);this.signal.emit(l_.P2P_CONNECTION,_t,!0)}async reset(_e,_t){const Wt=this.userMap.get(_e);Wt&&(this.emit(xO.ABORT),this.signal.emit(C_.ON_USER_OFFLINE,{uid:Wt.uid,reason:ole.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),_t||(iE.debug("change local token from ".concat(_t," to ").concat(_t)),this.token=f0(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(xO.ABORT)}}hE(MI,"MAX_SIZE",1),hE(MI,"MAX_MESSAGE_SIZE",1024);class TW extends A0{get connectionState(){return this._connectionState}set connectionState(_e){_e!==this._connectionState&&(this._connectionState=_e,_e===M_.CONNECTED?this.emit(l_.WS_CONNECTED):_e===M_.RECONNECTING?this.emit(l_.WS_RECONNECTING,this._websocketReconnectReason):_e===M_.CLOSED&&this.emit(l_.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(_e,_t){super(),hE(this,"_disconnectedReason",void 0),hE(this,"_websocketReconnectReason",void 0),hE(this,"_connectionState",M_.CLOSED),hE(this,"reconnectToken",void 0),hE(this,"p2pToken",void 0),hE(this,"websocket",void 0),hE(this,"openConnectionTime",void 0),hE(this,"clientId",void 0),hE(this,"lastMsgTime",Date.now()),hE(this,"uploadCache",[]),hE(this,"uploadCacheInterval",void 0),hE(this,"rttRolling",new TV(5)),hE(this,"pingpongTimer",void 0),hE(this,"pingpongTimeoutCount",0),hE(this,"joinResponse",void 0),hE(this,"multiIpOption",void 0),hE(this,"initError",void 0),hE(this,"spec",void 0),hE(this,"store",void 0),hE(this,"_external_signal",void 0),hE(this,"onWebsocketMessage",Wt=>{if(Wt.data instanceof ArrayBuffer)return void this.emit(l_.ON_BINARY_DATA,Wt.data);const _n=JSON.parse(Wt.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(_n,"_id")){const _i="res-@".concat(_n._id);this.emit(_i,_n._result,_n._message)}else if(Object.prototype.hasOwnProperty.call(_n,"_type")){switch(_n._type){case C_.ON_DATA_STREAM:return void this.handleDataStream(_n._message);case C_.MUTE_AUDIO:case C_.MUTE_VIDEO:case C_.ON_P2P_LOST:case C_.ON_USER_ONLINE:return;case C_.ON_USER_OFFLINE:const{uid:_i}=_n._message;return iE.debug("[".concat(this.clientId,"] user-offline uid: ").concat(_i)),void this._external_signal.reset(_i)}if(this.emit(_n._type,_n._message),_n._type===C_.ON_NOTIFICATION&&this.handleNotification(_n._message),_n._type===C_.ON_USER_BANNED)switch(_n._message.error_code){case 14:this.close(U_.UID_BANNED);break;case 15:this.close(U_.IP_BANNED);break;case 16:this.close(U_.CHANNEL_BANNED)}if(_n._type===C_.ON_USER_LICENSE_BANNED)switch(_n._message.error_code){case E_.ERR_LICENSE_MISSING:this.close(U_.LICENSE_MISSING);break;case E_.ERR_LICENSE_EXPIRED:this.close(U_.LICENSE_EXPIRED);break;case E_.ERR_LICENSE_MINUTES_EXCEEDED:this.close(U_.LICENSE_MINUTES_EXCEEDED);break;case E_.ERR_LICENSE_PERIOD_INVALID:this.close(U_.LICENSE_PERIOD_INVALID);break;case E_.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(U_.LICENSE_MULTIPLE_SDK_SERVICE);break;case E_.ERR_LICENSE_ILLEGAL:this.close(U_.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=_e.clientId,this.spec=_e,this.store=_t,this.websocket=new iP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,yE("JOIN_GATEWAY_USE_DUAL_DOMAIN"),yE("JOIN_GATEWAY_USE_443PORT_ONLY"),_t),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===M_.CONNECTED&&this.reconnect("retry",RS.OFFLINE)}),this.p2pToken=f0(6,""),this._external_signal=new MI(this,this.p2pToken)}async request(_e,_t,Wt,_n){const _i=f0(6,""),_s={_id:_i,_type:_e,_message:_t},_c=this.websocket.connectionID,_u=()=>new n_((pE,aE)=>{if(this.connectionState===M_.CONNECTED)return pE();const cE=()=>{this.off(l_.WS_CLOSED,fE),pE()},fE=()=>{this.off(l_.WS_CONNECTED,cE),aE(new HE(mE.WS_ABORT))};this.once(l_.WS_CONNECTED,cE),this.once(l_.WS_CLOSED,fE)});if(this.connectionState!==M_.CONNECTING&&this.connectionState!==M_.RECONNECTING||_e===g_.JOIN||_e===g_.REJOIN||await _u(),this.websocket.sendMessage(_s,!0),_n)return;const _h=new n_((pE,aE)=>{let cE=!1;const fE=(AE,PE)=>{cE=!0,pE({isSuccess:AE==="success",message:PE||{}}),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.emit(l_.REQUEST_SUCCESS,_e,_t)};this.once("res-@".concat(_i),fE);const gE=()=>{aE(new HE(mE.WS_ABORT,"type: ".concat(_e))),this.off(l_.WS_CLOSED,gE),this.off(l_.WS_RECONNECTING,gE),this.off("res-@".concat(_i),fE)};this.once(l_.WS_CLOSED,gE),this.once(l_.WS_RECONNECTING,gE),hS(yE("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==_c||cE||(iE.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(_e)),this.emit(l_.REQUEST_TIMEOUT,_e,_t))})});let _p=null;try{_p=await _h}catch(pE){if(this.connectionState===M_.CLOSED||_e===g_.LEAVE)throw new HE(mE.WS_ABORT);return!this.spec.forceWaitGatewayResponse||Wt?pE.throw():_e===g_.JOIN||_e===g_.REJOIN?null:(await _u(),await this.request(_e,_t))}if(_p.isSuccess)return _p.message;const Qm=Number(_p.message.error_code||_p.message.code),_g=xI(Qm),eE=new HE(mE.UNEXPECTED_RESPONSE,"".concat(_g.desc,": ").concat(_p.message.error_str),{code:Qm,data:_p.message});return _g.action==="success"?_p.message:(iE.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(_e,", error_code: ").concat(Qm,", message: ").concat(_g.desc,", action: ").concat(_g.action)),Qm===E_.ERR_TOO_MANY_BROADCASTERS?((_e===g_.JOIN||_e===g_.REJOIN)&&(this.initError=eE,this.close()),eE.throw()):_g.action==="failed"?eE.throw():_g.action==="quit"?(this.initError=eE,this.close(),eE.throw()):(Qm===E_.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_p.message.option,iE.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",RS.MULTI_IP)):this.reconnect(_g.action,RS.SERVER_ERROR),_e===g_.JOIN||_e===g_.REJOIN?null:await this.request(_e,_t)))}waitMessage(_e,_t){return new n_(Wt=>{const _n=_i=>{(!_t||_t(_i))&&(this.off(_e,_n),Wt(_i))};this.on(_e,_n)})}uploadWRTCStats(_e){if(!this.store.sessionId)return void iE.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const _t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:_e};this.upload(LI.WRTC_STATS,_t)}upload(_e,_t){const Wt={_type:_e,_message:_t};try{this.websocket.sendMessage(Wt)}catch{const _i=yE("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(Wt),this.uploadCache.length>_i&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==M_.CONNECTED)return;const _s=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_s._type,_s._message)},yE("UPLOAD_CACHE_INTERVAL")||2e3))}}send(_e,_t){const Wt={_type:_e,_message:_t};this.websocket.sendMessage(Wt)}async sendExtensionMessage(_e,_t,Wt){return await this._external_signal.send(_e,_t,Wt)}init(_e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new n_((_t,Wt)=>{this.once(l_.WS_CONNECTED,()=>_t(this.joinResponse)),this.once(l_.WS_CLOSED,()=>Wt(this.initError||new HE(mE.WS_ABORT))),this.connectionState=M_.CONNECTING,this.websocket.init(_e).catch(Wt)})}close(_e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=_e||U_.LEAVE,this.connectionState=M_.CLOSED,iE.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),_e===U_.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new iP("gateway-".concat(this.clientId),this.spec.retryConfig,!0,yE("JOIN_GATEWAY_USE_DUAL_DOMAIN"),yE("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents()),this.p2pToken=f0(6,""),this._external_signal.clear(),this._external_signal=new MI(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(l_.ABORT_P2P_EXECUTION);const _e=await _y(this,l_.REQUEST_JOIN_INFO),_t=await this.request(g_.JOIN,_e);if(!_t)return this.emit(l_.REPORT_JOIN_GATEWAY,mE.TIMEOUT,this.url||""),!1;this.joinResponse=_t,this.emit(l_.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=M_.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(_e,_t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(_e,_t)}handleDataStream(_e){try{var _t;const Wt=PI(_e.payload),_n=new TextDecoder().decode(Wt),_i=JSON.parse(_n);"total"in _i&&"id"in _i||i_(_t=Object.values(W0)).call(_t,_i._type)?(_i._uid=_e.uid,this._external_signal.onMessage(_i)):this.emit(C_.ON_DATA_STREAM,_e)}catch{this.emit(C_.ON_DATA_STREAM,_e)}}handleNotification(_e){iE.debug("[".concat(this.clientId,"] receive notification: "),_e);const _t=xI(_e.code);if(_t.action!=="success"){if(_t.action!=="failed")return _t.action==="quit"?(_t.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(U_.UID_BANNED),void this.close()):void this.reconnect(_t.action,RS.SERVER_ERROR);iE.error("[".concat(this.clientId,"] ignore error: "),_t.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const _e=yE("PING_PONG_TIME_OUT"),_t=Date.now();this.pingpongTimeoutCount>=_e&&(iE.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(_t-this.lastMsgTime,"ms")),_t-this.lastMsgTime>yE("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",RS.TIMEOUT):this.request(g_.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const Wt=Date.now()-_t;this.rttRolling.add(Wt),yE("REPORT_STATS")&&this.send(g_.PING_BACK,{pingpongElapse:Wt})}).catch(Wt=>{})}handleWebsocketEvents(){this.websocket.on(T_.RECONNECT_WAITTING_FINISH,_e=>{this.emit(l_.WS_RECONNECT_WAITTING_FINISH,_e)}),this.websocket.on(T_.RECONNECT_CREATE_CONNECTION,_e=>{this.emit(l_.WS_RECONNECT_CREATE_CONNECTION,_e)}),this.websocket.on(T_.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(T_.CLOSED,()=>{this.connectionState=M_.CLOSED}),this.websocket.on(T_.FAILED,()=>{this._disconnectedReason=U_.NETWORK_ERROR,this.connectionState=M_.CLOSED}),this.websocket.on(T_.RECONNECTING,_e=>{this._websocketReconnectReason=_e,this.joinResponse=void 0,this.connectionState===M_.CONNECTED?this.connectionState=M_.RECONNECTING:this.connectionState=M_.CONNECTING}),this.websocket.on(T_.WILL_RECONNECT,(_e,_t,Wt)=>{_e!=="retry"?(iE.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(_e)),this.reconnectToken=void 0,this.emit(l_.NEED_RENEW_SESSION)):iE.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),Wt(_e)}),this.websocket.on(T_.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(_e=>{if(this.emit(l_.REPORT_JOIN_GATEWAY,_e.message||_e.code,this.url||""),_e instanceof HE&&_e.code===mE.UNEXPECTED_RESPONSE&&_e.data.code===E_.ERR_NO_AUTHORIZED)return iE.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",RS.SERVER_ERROR);iE.error("[".concat(this.clientId,"] join gateway request failed"),_e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",RS.SERVER_ERROR):(this.initError=_e,this.close())})}),this.websocket.on(T_.REQUEST_NEW_URLS,(_e,_t)=>{_y(this,l_.REQUEST_RECOVER,this.multiIpOption).then(_e).catch(_t)}),this.websocket.on(T_.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(C_.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function wW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function oR($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?wW(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):wW(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const GV=new Map;class gle extends A0{get state(){return this._state}set state(_e){if(_e===this._state)return;const _t=this._state;this._state=_e,_e==="DISCONNECTED"&&this._disconnectedReason?this.emit(H0.CONNECTION_STATE_CHANGE,_e,_t,this._disconnectedReason):this.emit(H0.CONNECTION_STATE_CHANGE,_e,_t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(_e){iE.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(_e)),this._joinGatewayStartTime=_e}constructor(_e,_t){super(),hE(this,"store",void 0),hE(this,"joinInfo",void 0),hE(this,"key",void 0),hE(this,"ntpOffset",0),hE(this,"signal",void 0),hE(this,"role",void 0),hE(this,"inChannelInfo",{joinAt:null,duration:0}),hE(this,"spec",void 0),hE(this,"_state","DISCONNECTED"),hE(this,"_statsCollector",void 0),hE(this,"_disconnectedReason",void 0),hE(this,"isSignalRecover",!1),hE(this,"hasChangeBGPAddress",!1),hE(this,"trafficStatsInterval",void 0),hE(this,"networkQualityInterval",void 0),hE(this,"_joinGatewayStartTime",0),hE(this,"_signalTimeout",!1),hE(this,"_clientRoleOptions",void 0),hE(this,"_isProactiveJoin",!1),this.store=_e,this.spec=_t,this.signal=this.store.useP2P?new TW(oR(oR({},_t),{},{retryConfig:_t.websocketRetryConfig}),_e):this.store.useDataChannel?new b1(oR(oR({},_t),{},{retryConfig:_t.websocketRetryConfig}),_e):new gW(oR(oR({},_t),{},{retryConfig:_t.websocketRetryConfig}),_e),this._statsCollector=_t.statsCollector,this.role=_t.role||"audience",this._clientRoleOptions=_t.clientRoleOptions,this.handleSignalEvents()}async join(_e,_t,Wt){if(this.signal instanceof b1){let _u=!1;_e.cloudProxyServer!=="disabled"?(iE.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(_e.cloudProxyServer,")")),_u=!0):"".concat(_e.apResponse.cid,"_").concat(_e.apResponse.cert).length>255||"".concat(_e.apResponse.cid,"_").concat(_e.apResponse.cert).length<22?(iE.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),_u=!0):_e.apResponse.addresses.some(_h=>_h.fingerprint)||yE("FINGERPRINT")||(iE.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),_u=!0),_u&&this.resetSignal()}this.store.joinGatewayStart(),_e.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const _n=Date.now();let _i=GV.get(_e.cname);if(_i||(_i=new Map,GV.set(_e.cname,_i)),this._isProactiveJoin=!0,_i.has(_e.uid)){const _u=new DE(mE.UID_CONFLICT);throw p_.joinGateway(_e.sid,{lts:_n,succ:!1,ec:_u.message,addr:null,uid:_e.uid,cid:_e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!_e.proxyServer,signalChannel:this.signal instanceof b1?"1":"0"}),this._isProactiveJoin=!1,_u}_i.set(_e.uid,!0),this.joinInfo=_e,this.key=_t;let _s=0;this.joinGatewayStartTime=_n;const _c=_e.proxyServer;try{let _u;if(iE.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof b1?"datachannel":"websocket"," join uid ").concat(_s)),this.signal instanceof b1)_u=await this.signal.init(_e.apResponse.addresses,Wt);else{const _h=_e.gatewayAddrs.map(_p=>{let{address:Qm}=_p;const[_g,eE]=Qm.split(":"),pE={host:_g,port:eE};return _e.proxyServer&&(pE.proxy=_e.proxyServer),pE});_u=await this.signal.init(_h,Wt)}_s=_u.uid,iE.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof b1?"datachannel":"websocket"," join uid ").concat(_s," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(_u){throw _u&&_u.code===mE.INIT_WEBSOCKET_TIMEOUT?(iE.warning("[".concat(this.store.clientId,"] User join failed"),_u.toString()),_u):_u&&_u.code===mE.INIT_DATACHANNEL_TIMEOUT?(iE.warning("[".concat(this.store.clientId,"] User join datachannel failed"),_u.toString()),this.resetSignal(),_u):(iE.error("[".concat(this.store.clientId,"] User join failed"),_u.toString()),p_.joinGateway(_e.sid,{lts:_n,succ:!1,ec:_u.message,addr:this.signal.url,uid:_e.uid,cid:_e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!_c,signalChannel:this.signal instanceof b1?"1":"0"}),this._isProactiveJoin=!1,_i.delete(_e.uid),this.signal.close(),_u)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),iE.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(_u=>{iE.warning("[".concat(this.store.clientId,"] get traffic stats error"),_u.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(H0.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(H0.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(H0.NETWORK_QUALITY,{uplinkNetworkQuality:_W(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:_W(this._statsCollector.trafficStats.B_dnq)}):this.emit(H0.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),_s}async leave(){let _e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],_t=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){_t!==U_.FALLBACK&&(this.state="DISCONNECTING");try{_e||this.signal.connectionState!==M_.CONNECTED||await function(Wt,_n){return _n===1/0?Wt:n_.race([Wt,rce(_n)])}(this.signal.request(g_.LEAVE,void 0,!0),3e3)}catch(Wt){iE.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),Wt)}this.signal.close(_t),_t!==U_.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(_e,_t,Wt){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const _n={state:"offer",p2p_id:this.store.p2pId,ortc:_t,mode:this.spec.mode,extend:yE("PUB_EXTEND"),twcc:!!yE("PUBLISH_TWCC"),rtx:!!yE("USE_PUB_RTX")};try{return(await this.signal.request(g_.PUBLISH,_n,!0))._message}catch(_i){if(Wt&&_i.data&&_i.data.code===E_.ERR_PUBLISH_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),_i.toString()),await this.tryUnpubBeforeRepub(_e,_t),this.publish(_e,_t,!1);throw _i}}async publishDataChannel(_e,_t,Wt){var _n;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const _i={stream_id:_t.streamId,ordered:_t.ordered?1:0,max_retrans_times:(_n=_t.maxRetransmits)!==null&&_n!==void 0?_n:10,channel_id:_t.channelId,metadata:_t.metadata};try{await this.signal.request(g_.PUBLISH_DATASTREAM,_i,!0)}catch(_s){if(Wt&&_s.data&&_s.data.code===E_.ERR_PUBLISH_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),_s.toString()),await this.tryUnpubDataChannelBeforeRepub(_e,_t),this.publishDataChannel(_e,_t,!1);throw _s}}async unpublish(_e,_t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(g_.UNPUBLISH,{stream_id:_t,ortc:_e},!0)}catch(Wt){iE.warning("[".concat(this.store.clientId,"] unpublish warning: "),Wt)}}async unpublishDataChannel(_e){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await n_.all(_e.map(_t=>this.signal.request(g_.UNPUBLISH_DATASTREAM,{channel_id:_t},!0)))}catch(_t){iE.warning("unpublish datachannels warning: ",_t)}}async presubscribe(_e,_t,Wt){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const _n={stream_id:_e,stream_type:_t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!yE("SUBSCRIBE_TWCC"),rtx:!!yE("USE_SUB_RTX")||void 0,extend:yE("SUB_EXTEND"),svc:Array.isArray(yE("SVC"))&&yE("SVC").length!==0?yE("SVC"):void 0};try{return await this.signal.request(g_.PRE_SUBSCRIBE,_n,!0)}catch(_i){if(Wt&&_i.data&&_i.data.code===E_.ERR_SUBSCRIBE_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),_i.toString()),this.presubscribe(_e,_t,!1);throw _i}}async subscribe(_e,_t,Wt){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const _n={stream_id:_e,stream_type:_t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!yE("SUBSCRIBE_TWCC"),rtx:!!yE("USE_SUB_RTX"),extend:yE("SUB_EXTEND"),ssrcId:_t.ssrcId,svc:Array.isArray(yE("SVC"))&&yE("SVC").length!==0?yE("SVC"):void 0};try{return(await this.signal.request(g_.SUBSCRIBE,_n,!0))._message}catch(_i){if(Wt&&_i.data&&_i.data.code===E_.ERR_SUBSCRIBE_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),_i.toString()),await this.tryUnsubBeforeResub(_e,_t),await this.subscribe(_e,_t,!1);throw _i}}async subscribeDataChannel(_e,_t,Wt){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const _n={uid:_e,stream_id:_t.id,channel_id:_t.datachannelId};try{return void await this.signal.request(g_.SUBSCRIBE_DATASTREAM,_n,!0)}catch(_i){if(Wt&&_i.data&&_i.data.code===E_.ERR_SUBSCRIBE_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),_i.toString()),await this.tryUnsubDataChannelBeforeResub(_e,_t),await this.subscribeDataChannel(_e,_t,!1);throw _i}}async subscribeAll(_e,_t){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const Wt={p2p_id:this.store.p2pId,users:_e,dtx:!1,rtx:!!yE("USE_SUB_RTX"),twcc:!!yE("SUBSCRIBE_TWCC"),svc:Array.isArray(yE("SVC"))&&yE("SVC").length!==0?yE("SVC"):void 0};try{return await this.signal.request(g_.SUBSCRIBE_STREAMS,Wt,!0)}catch(_n){if(_t&&_n.data&&_n.data.code===E_.ERR_SUBSCRIBE_REQUEST_INVALID)return iE.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),_n.toString()),await this.tryMassUnsubBeforeResub(_e),await this.subscribeAll(_e,!1);throw _n}}async setVideoProfile(_e){const _t=function(Wt){if(!(Wt.bitrateMax&&Wt.bitrateMin&&Wt.frameRate&&Wt.height&&Wt.width))return;let _n=Wt.frameRate,_i=Wt.width,_s=Wt.height,_c=!0;return typeof _n!="number"&&(_n=_n.exact||_n.ideal||_n.max||_n.min||0,_n||(_c=!1)),typeof _i!="number"&&(_i=_i.exact||_i.ideal||_i.max||_i.min||0,_i||(_c=!1)),typeof _s!="number"&&(_s=_s.exact||_s.ideal||_s.max||_s.min||0,_n||(_c=!1)),_c?{stream_type:0,width:_i,height:_s,fps:_n,start_bps:1e3*Wt.bitrateMax,min_bps:1e3*Wt.bitrateMin,target_bps:1e3*Wt.bitrateMax}:void 0}(_e);if(_t)return this.signal.request(g_.SET_VIDEO_PROFILE,_t);iE.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(_e,_t){try{await this.signal.request(g_.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:_e,stream_id:_t},!0)}catch(Wt){iE.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),Wt)}}async unsubscribeDataChannel(_e,_t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await n_.all(_e.map(Wt=>this.signal.request(g_.UNSUBSCRIBE_DATASTREAM,{stream_id:Wt,uid:_t},!0)))}catch(Wt){iE.warning("unsubscribeDataChannel warning: ",Wt)}}async massUnsubscribe(_e){try{await this.signal.request(g_.UNSUBSCRIBE_STREAMS,_e,!0)}catch(_t){iE.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),_t)}}async reconnectPC(_e){const{iceParameters:_t,dtlsParameters:Wt,rtpCapabilities:_n}=_e;return{gatewayEstablishParams:await this.signal.request(g_.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:_t,dtlsParameters:Wt,rtpCapabilities:_n}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(g_.GATEWAY_INFO)}async renewToken(_e){await this.signal.request(g_.RENEW_TOKEN,_e),this.key=_e.token}async setClientRole(_e,_t){if(_t&&(this._clientRoleOptions=Object.assign({},_t)),this.state!=="CONNECTED")return void(this.role=_e);let Wt,_n=0;_e==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(Wt=this._clientRoleOptions.delay,_n=1):_n=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:_n=0,await this.signal.request(g_.SET_CLIENT_ROLE,{role:_e,level:_n,delay:Wt,client_ts:Date.now()}),this.role=_e}async setRemoteVideoStreamType(_e,_t){await this.signal.request(g_.SWITCH_VIDEO_STREAM,{stream_id:_e,stream_type:_t})}async setDefaultRemoteVideoStreamType(_e){await this.signal.request(g_.DEFAULT_VIDEO_STREAM,{stream_type:_e})}async setStreamFallbackOption(_e,_t){await this.signal.request(g_.SET_FALLBACK_OPTION,{stream_id:_e,fallback_type:_t})}async pickSVCLayer(_e,_t){await this.signal.request(g_.PICK_SVC_LAYER,{stream_id:_e,spatial_layer:_t.spatialLayer,temporal_layer:_t.temporalLayer})}async setRTM2Flag(_e){await this.signal.request(g_.SET_RTM2_FLAG,{rtm2_flag:_e})}async sendExtensionMessage(_e,_t,Wt){if(this.signal instanceof TW)return this.signal.sendExtensionMessage(_e,_t,Wt)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),oR({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(g_.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const _e=GV.get(this.joinInfo.cname);_e&&_e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const _e=function(_t){let Wt;return Wt=_t.startsWith("dc")?_t.match(/(dc\:\/\/)?([^:]+):(\d+)/):_t.match(/(wss\:\/\/)?([^:]+):(\d+)/),Wt?{username:CS.username,password:CS.password,turnServerURL:Wt[2],tcpport:parseInt(Wt[3])+30,udpport:parseInt(Wt[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],_e&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(oR(oR({},CS),{},{turnServerURL:_e.turnServerURL,tcpport:_e.tcpport,udpport:_e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const _e=await this.signal.request(g_.TRAFFIC_STATS,void 0,!0);_e.timestamp=Date.now(),_e.ntp_offset!=null&&(this.ntpOffset=_e.ntp_offset),_e.peer_delay.forEach(_t=>{const Wt=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(_n=>_n.peer_uid===_t.peer_uid);Wt&&Wt.B_st!==_t.B_st&&SL(()=>{this.emit(H0.STREAM_TYPE_CHANGE,_t.peer_uid,_t.B_st)})}),this._statsCollector.updateTrafficStats(_e)}getJoinMessage(_e){if(!this.joinInfo||!this.key)throw new DE(mE.UNEXPECTED_ERROR,"can not generate join message, no join info");const _t=Object.assign({},this.joinInfo.apResponse);let Wt=yE("REPORT_APP_SCENARIO");if(typeof Wt!="string")try{Wt=JSON.stringify(Wt)}catch{Wt=void 0}Wt&&Wt.length>128&&(Wt=void 0);const _n=oR({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:jT,browser:navigator.userAgent,process_id:yE("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:_t,extend:yE("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:Wt,attributes:{userAttributes:{enablePublishedUserList:yE("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:yE("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof yE("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?yE("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof yE("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?yE("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof yE("ENABLE_USER_LICENSE_CHECK")=="boolean"?yE("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:yE("USE_PUB_RTX")===!0||yE("USE_SUB_RTX")===!0||void 0,disableFEC:yE("DISABLE_FEC"),enableNTPReport:!!yE("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!yE("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof yE("ENABLE_DATASTREAM_2")=="boolean"?yE("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!yE("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof yE("USE_XR")=="boolean"?yE("USE_XR"):void 0,enableLossbasedBwe:typeof yE("ENABLE_LOSSBASED_BWE")=="boolean"?yE("ENABLE_LOSSBASED_BWE"):void 0,enableAutCC:typeof yE("ENABLE_AUT_CC")=="boolean"?yE("ENABLE_AUT_CC"):void 0,enableCCFallback:typeof yE("ENABLE_CC_FALLBACK")=="boolean"?yE("ENABLE_CC_FALLBACK"):void 0}},join_ts:this.joinGatewayStartTime},_e);return this.joinInfo.stringUid&&(_n.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(_n.aes_mode=this.joinInfo.aesmode,yE("ENCRYPT_AES")?(_n.aes_secret=this.joinInfo.aespassword,_n.aes_encrypt=!0):_n.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(_n.aes_salt=this.joinInfo.aessalt)),_t.addresses[this.signal.websocket.currentURLIndex]&&(_n.ap_response.ticket=_t.addresses[this.signal.websocket.currentURLIndex].ticket,delete _t.addresses),this.joinInfo.defaultVideoStream!==void 0&&(_n.default_video_stream=this.joinInfo.defaultVideoStream),_n}getRejoinMessage(){if(!this.joinInfo)throw new DE(mE.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(l_.WS_RECONNECT_WAITTING_FINISH,_e=>{var _t;i_(_t=["tryNext","recover"]).call(_t,_e)&&this.joinInfo&&p_.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(l_.WS_RECONNECT_CREATE_CONNECTION,_e=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(l_.WS_RECONNECTING,_e=>{this.joinInfo&&p_.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:_e||RS.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",p_.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(l_.WS_CLOSED,_e=>{let _t;switch(_e){case U_.LEAVE:_t=RS.LEAVE;break;case U_.UID_BANNED:case U_.IP_BANNED:case U_.CHANNEL_BANNED:case U_.SERVER_ERROR:_t=RS.SERVER_ERROR;break;case U_.FALLBACK:_t=RS.FALLBACK;break;case U_.LICENSE_MISSING:case U_.LICENSE_EXPIRED:case U_.LICENSE_MINUTES_EXCEEDED:case U_.LICENSE_PERIOD_INVALID:case U_.LICENSE_MULTIPLE_SDK_SERVICE:case U_.LICENSE_ILLEGAL:case U_.TOKEN_EXPIRE:_t=_e;break;default:_t=RS.NETWORK_ERROR}iE.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(_t||"undefined -> "+RS.NETWORK_ERROR)),this.joinInfo&&p_.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:_e===U_.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:_t}),this._disconnectedReason=_e,_e!==U_.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(l_.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(iE.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),p_.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof b1?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const _e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!_e)return void iE.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(_e));d0("EVENT_REPORT_DOMAIN",_e[1]),d0("EVENT_REPORT_BACKUP_DOMAIN",_e[1]),d0("LOG_UPLOAD_SERVER","".concat(_e[1],":6444"))}}),this.signal.on(C_.ON_UPLINK_STATS,_e=>{this._statsCollector.updateUplinkStats(_e)}),this.signal.on(l_.REQUEST_RECOVER,(_e,_t,Wt)=>{if(!this.joinInfo)return Wt(new DE(mE.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));_e&&(this.joinInfo.multiIP=_e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,_y(this,H0.REQUEST_NEW_GATEWAY_LIST).then(_t).catch(Wt)}),this.signal.on(l_.REQUEST_JOIN_INFO,async _e=>{var _t;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void _e(this.getJoinMessage({ortc:{}}));const{iceParameters:Wt,dtlsParameters:_n,rtpCapabilities:_i}=await _y(this,H0.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(_t=this.joinInfo)===null||_t===void 0?void 0:_t.turnServer});_e(this.getJoinMessage({ortc:{iceParameters:Wt,dtlsParameters:_n,rtpCapabilities:_i,version:"2"}}))}),this.signal.on(l_.REQUEST_REJOIN_INFO,_e=>{_e(this.getRejoinMessage())}),this.signal.on(l_.REPORT_JOIN_GATEWAY,(_e,_t)=>{this.joinInfo&&(p_.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:_e,addr:_t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof b1?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(l_.IS_P2P_DISCONNECTED,_e=>{_e(OI(this,H0.IS_P2P_DISCONNECTED))}),this.signal.on(l_.DISCONNECT_P2P,()=>{this.emit(H0.DISCONNECT_P2P)}),this.signal.on(l_.NEED_RENEW_SESSION,_e=>{this.emit(H0.NEED_RENEW_SESSION,_e)}),this.signal.on(l_.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(l_.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(l_.JOIN_RESPONSE,_e=>{const _t=this.getCurrentGatewayAddress();this.emit(H0.JOIN_RESPONSE,_e,_t)}),this.signal.on(l_.DATACHANNEL_PRECONNECT,async(_e,_t,Wt)=>{this.updateTurnConfigFromSignal();const _n=this.getCurrentGatewayAddress();return _y(this,H0.DATACHANNEL_PRECONNECT,_e,_n).then(_t).catch(Wt)}),this.signal.on(l_.DATACHANNEL_CONNECTING,async _e=>{const{iceParameters:_t,dtlsParameters:Wt,rtpCapabilities:_n}=await _y(this,H0.REQUEST_DC_CONNECTION_PARAMS);_e(this.getJoinMessage({ortc:{iceParameters:_t,dtlsParameters:Wt,rtpCapabilities:_n,version:"2"}}))}),this.signal.on(l_.DATACHANNEL_FAILBACK,()=>{iE.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(H0.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(_e,_t){try{await this.signal.request(g_.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:_e,ortc:[_t]},!0)}catch(Wt){throw iE.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),Wt),Wt}}async tryUnsubDataChannelBeforeResub(_e,_t){try{await this.signal.request(g_.UNSUBSCRIBE,{stream_id:_t.id},!0)}catch(Wt){throw iE.warning("unsubscribe datachannel warning",Wt),Wt}}async tryUnpubBeforeRepub(_e,_t){try{await this.signal.request(g_.UNPUBLISH,{stream_id:_e,ortc:_t},!0)}catch(Wt){throw iE.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),Wt),Wt}}async tryUnpubDataChannelBeforeRepub(_e,_t){try{await this.signal.request(g_.UNPUBLISH_DATASTREAM,{channnel_id:_t.channelId},!0)}catch(Wt){throw iE.warning("unpublish datastream warning: ",Wt),Wt}}async tryMassUnsubBeforeResub(_e){const _t={users:_e.map(Wt=>({stream_id:Wt.stream_id,stream_type:Wt.stream_type}))};try{await this.signal.request(g_.UNSUBSCRIBE_STREAMS,_t,!0)}catch(Wt){throw iE.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),Wt),Wt}}async muteLocal(_e,_t){const Wt={action:_e.find(_n=>_n.stream_type===n0.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:_e,stream_id:_t};try{await this.signal.request(g_.CONTROL,Wt,!0,!0)}catch(_n){throw iE.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),_n),_n}}async unmuteLocal(_e,_t){const Wt={action:_e.find(_n=>_n.stream_type===n0.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:_e,stream_id:_t};try{await this.signal.request(g_.CONTROL,Wt,!0,!0)}catch(_n){throw iE.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),_n),_n}}async muteRemote(_e,_t){const Wt={action:_e===h_.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:_t};try{await this.signal.request(g_.CONTROL,Wt,!0,!0)}catch(_n){throw iE.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),_n),_n}}async unmuteRemote(_e,_t){const Wt={action:_e===h_.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:_t};try{await this.signal.request(g_.CONTROL,Wt,!0,!0)}catch(_n){throw iE.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),_n),_n}}uploadWRTCStats(_e){this.signal.uploadWRTCStats(_e)}upload(_e,_t){this.signal.upload(_e,_t)}getSignalRTT(){return this.signal.rtt}async restartICE(_e){const _t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:_e};try{return await this.signal.request(g_.RESTART_ICE,_t,!0)}catch(Wt){throw iE.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),Wt),Wt}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,RS.P2P_FAILED)}getCurrentGatewayAddress(){var _e;if(!yE("GATEWAY_WSS_ADDRESS"))return(_e=this.joinInfo)!==null&&_e!==void 0&&_e.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(_e){await this.signal.request(g_.SET_PARAMETER,{enablePublishAudioFilter:_e})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(U_.FALLBACK)),this.store.useDataChannel=!1,this.signal=new gW(oR(oR({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(H0.RESET_SIGNAL,cW.websocket)}}let ML=0,HV=0;function PR($,_e,_t,Wt){return new n_((_n,_i)=>{_e.timeout=_e.timeout||yE("HTTP_CONNECT_TIMEOUT"),_e.responseType=_e.responseType||"json",_e.data&&!_t?(_e.data=JSON.stringify(_e.data),ML+=XR(_e.data)):_t&&(_e.data.size?ML+=_e.data.size:_e.data instanceof FormData?ML+=VH(_e.data):ML+=XR(JSON.stringify(_e.data))),_e.headers=_e.headers||{},_e.headers["Content-Type"]=_e.headers["Content-Type"]||"application/json",_e.method="POST",_e.url=$,tT.request(_e).then(_s=>{typeof _s.data=="string"?HV+=XR(_s.data):_s.data instanceof ArrayBuffer||_s.data instanceof Uint8Array?HV+=_s.data.byteLength:HV+=XR(JSON.stringify(_s.data)),Wt&&_n({data:_s.data,headers:_s.headers}),_n(_s.data)}).catch(_s=>{tT.isCancel(_s)?_i(new DE(mE.OPERATION_ABORTED,"cancel token canceled")):_s.code==="ECONNABORTED"?_i(new DE(mE.NETWORK_TIMEOUT,_s.message)):_s.response?_i(new DE(mE.NETWORK_RESPONSE_ERROR,_s.response.status)):_i(new DE(mE.NETWORK_ERROR,_s.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var $;function _e($E){var QE=0;return function(){return QE<$E.length?{done:!1,value:$E[QE++]}:{done:!0}}}var _t=typeof Object.defineProperties=="function"?Object.defineProperty:function($E,QE,d_){return $E==Array.prototype||$E==Object.prototype||($E[QE]=d_.value),$E},Wt,_n=function($E){$E=[typeof globalThis=="object"&&globalThis,$E,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vt=="object"&&Vt];for(var QE=0;QE<$E.length;++QE){var d_=$E[QE];if(d_&&d_.Math==Math)return d_}throw Error("Cannot find global object")}(this);function _i($E,QE){if(QE)e:{var d_=_n;$E=$E.split(".");for(var w_=0;w_<$E.length-1;w_++){var X_=$E[w_];if(!(X_ in d_))break e;d_=d_[X_]}(QE=QE(w_=d_[$E=$E[$E.length-1]]))!=w_&&QE!=null&&_t(d_,$E,{configurable:!0,writable:!0,value:QE})}}function _s($E){return($E={next:$E})[Symbol.iterator]=function(){return this},$E}function _c($E){var QE=typeof Symbol<"u"&&Symbol.iterator&&$E[Symbol.iterator];return QE?QE.call($E):{next:_e($E)}}if(_i("Symbol",function($E){function QE(X_,r_){this.A=X_,_t(this,"description",{configurable:!0,writable:!0,value:r_})}if($E)return $E;QE.prototype.toString=function(){return this.A};var d_="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",w_=0;return function X_(r_){if(this instanceof X_)throw new TypeError("Symbol is not a constructor");return new QE(d_+(r_||"")+"_"+w_++,r_)}}),_i("Symbol.iterator",function($E){if($E)return $E;$E=Symbol("Symbol.iterator");for(var QE="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),d_=0;d_<QE.length;d_++){var w_=_n[QE[d_]];typeof w_=="function"&&typeof w_.prototype[$E]!="function"&&_t(w_.prototype,$E,{configurable:!0,writable:!0,value:function(){return _s(_e(this))}})}return $E}),typeof Object.setPrototypeOf=="function")Wt=Object.setPrototypeOf;else{var _u;e:{var _h={};try{_h.__proto__={a:!0},_u=_h.a;break e}catch{}_u=!1}Wt=_u?function($E,QE){if($E.__proto__=QE,$E.__proto__!==QE)throw new TypeError($E+" is not extensible");return $E}:null}var _p=Wt;function Qm(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function _g($E){if($E.m)throw new TypeError("Generator is already running");$E.m=!0}function eE($E,QE){return $E.h=3,{value:QE}}function pE($E){this.g=new Qm,this.G=$E}function aE($E,QE,d_,w_){try{var X_=QE.call($E.g.j,d_);if(!(X_ instanceof Object))throw new TypeError("Iterator result "+X_+" is not an object");if(!X_.done)return $E.g.m=!1,X_;var r_=X_.value}catch(uE){return $E.g.j=null,$E.g.s(uE),cE($E)}return $E.g.j=null,w_.call($E.g,r_),cE($E)}function cE($E){for(;$E.g.h;)try{var QE=$E.G($E.g);if(QE)return $E.g.m=!1,{value:QE.value,done:!1}}catch(d_){$E.g.v=void 0,$E.g.s(d_)}if($E.g.m=!1,$E.g.l){if(QE=$E.g.l,$E.g.l=null,QE.F)throw QE.D;return{value:QE.return,done:!0}}return{value:void 0,done:!0}}function fE($E){this.next=function(QE){return $E.o(QE)},this.throw=function(QE){return $E.s(QE)},this.return=function(QE){return function(d_,w_){_g(d_.g);var X_=d_.g.j;return X_?aE(d_,"return"in X_?X_.return:function(r_){return{value:r_,done:!0}},w_,d_.g.return):(d_.g.return(w_),cE(d_))}($E,QE)},this[Symbol.iterator]=function(){return this}}function gE($E,QE){return QE=new fE(new pE(QE)),_p&&$E.prototype&&_p(QE,$E.prototype),QE}if(Qm.prototype.o=function($E){this.v=$E},Qm.prototype.s=function($E){this.l={D:$E,F:!0},this.h=this.C||this.u},Qm.prototype.return=function($E){this.l={return:$E},this.h=this.u},pE.prototype.o=function($E){return _g(this.g),this.g.j?aE(this,this.g.j.next,$E,this.g.o):(this.g.o($E),cE(this))},pE.prototype.s=function($E){return _g(this.g),this.g.j?aE(this,this.g.j.throw,$E,this.g.o):(this.g.s($E),cE(this))},_i("Array.prototype.entries",function($E){return $E||function(){return function(QE,d_){QE instanceof String&&(QE+="");var w_=0,X_=!1,r_={next:function(){if(!X_&&w_<QE.length){var uE=w_++;return{value:d_(uE,QE[uE]),done:!1}}return X_=!0,{done:!0,value:void 0}}};return r_[Symbol.iterator]=function(){return r_},r_}(this,function(QE,d_){return[QE,d_]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var AE=function($E,QE){for(var d_=0;d_<$E.length;d_++)QE($E[d_])},PE=function($E){return $E.replace(/\r?\n|\r/g,`\r
`)},xE=function($E,QE,d_){return QE instanceof Blob?(d_=d_!==void 0?d_+"":typeof QE.name=="string"?QE.name:"blob",QE.name===d_&&Object.prototype.toString.call(QE)!=="[object Blob]"||(QE=new File([QE],d_)),[String($E),QE]):[String($E),String(QE)]},GE=function($E,QE){if($E.length<QE)throw new TypeError(QE+" argument required, but only "+$E.length+" present.")},zE=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,KE=zE.FormData,JE=zE.XMLHttpRequest&&zE.XMLHttpRequest.prototype.send,c_=zE.Request&&zE.fetch,V_=zE.navigator&&zE.navigator.sendBeacon,Q_=zE.Element&&zE.Element.prototype,T0=zE.Symbol&&Symbol.toStringTag;T0&&(Blob.prototype[T0]||(Blob.prototype[T0]="Blob"),"File"in zE&&!File.prototype[T0]&&(File.prototype[T0]="File"));try{new File([],"")}catch{zE.File=function(QE,d_,w_){return QE=new Blob(QE,w_||{}),Object.defineProperties(QE,{name:{value:d_},lastModified:{value:+(w_&&w_.lastModified!==void 0?new Date(w_.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),T0&&Object.defineProperty(QE,T0,{value:"File"}),QE}}var Z0=function($E){return $E.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},M0=function($E){this.i=[];var QE=this;$E&&AE($E.elements,function(d_){if(d_.name&&!d_.disabled&&d_.type!=="submit"&&d_.type!=="button"&&!d_.matches("form fieldset[disabled] *"))if(d_.type==="file"){var w_=d_.files&&d_.files.length?d_.files:[new File([],"",{type:"application/octet-stream"})];AE(w_,function(X_){QE.append(d_.name,X_)})}else d_.type==="select-multiple"||d_.type==="select-one"?AE(d_.options,function(X_){!X_.disabled&&X_.selected&&QE.append(d_.name,X_.value)}):d_.type==="checkbox"||d_.type==="radio"?d_.checked&&QE.append(d_.name,d_.value):(w_=d_.type==="textarea"?PE(d_.value):d_.value,QE.append(d_.name,w_))})};if(($=M0.prototype).append=function($E,QE,d_){GE(arguments,2),this.i.push(xE($E,QE,d_))},$.delete=function($E){GE(arguments,1);var QE=[];$E=String($E),AE(this.i,function(d_){d_[0]!==$E&&QE.push(d_)}),this.i=QE},$.entries=function $E(){var QE,d_=this;return gE($E,function(w_){if(w_.h==1&&(QE=0),w_.h!=3)return QE<d_.i.length?w_=eE(w_,d_.i[QE]):(w_.h=0,w_=void 0),w_;QE++,w_.h=2})},$.forEach=function($E,QE){GE(arguments,1);for(var d_=_c(this),w_=d_.next();!w_.done;w_=d_.next()){var X_=_c(w_.value);w_=X_.next().value,X_=X_.next().value,$E.call(QE,X_,w_,this)}},$.get=function($E){GE(arguments,1);var QE=this.i;$E=String($E);for(var d_=0;d_<QE.length;d_++)if(QE[d_][0]===$E)return QE[d_][1];return null},$.getAll=function($E){GE(arguments,1);var QE=[];return $E=String($E),AE(this.i,function(d_){d_[0]===$E&&QE.push(d_[1])}),QE},$.has=function($E){GE(arguments,1),$E=String($E);for(var QE=0;QE<this.i.length;QE++)if(this.i[QE][0]===$E)return!0;return!1},$.keys=function $E(){var QE,d_,w_,X_,r_=this;return gE($E,function(uE){if(uE.h==1&&(QE=_c(r_),d_=QE.next()),uE.h!=3)return d_.done?void(uE.h=0):(w_=d_.value,X_=_c(w_),eE(uE,X_.next().value));d_=QE.next(),uE.h=2})},$.set=function($E,QE,d_){GE(arguments,2),$E=String($E);var w_=[],X_=xE($E,QE,d_),r_=!0;AE(this.i,function(uE){uE[0]===$E?r_&&(r_=!w_.push(X_)):w_.push(uE)}),r_&&w_.push(X_),this.i=w_},$.values=function $E(){var QE,d_,w_,X_,r_=this;return gE($E,function(uE){if(uE.h==1&&(QE=_c(r_),d_=QE.next()),uE.h!=3)return d_.done?void(uE.h=0):(w_=d_.value,(X_=_c(w_)).next(),eE(uE,X_.next().value));d_=QE.next(),uE.h=2})},M0.prototype._asNative=function(){for(var $E=new KE,QE=_c(this),d_=QE.next();!d_.done;d_=QE.next()){var w_=_c(d_.value);d_=w_.next().value,w_=w_.next().value,$E.append(d_,w_)}return $E},M0.prototype._blob=function(){var $E="----formdata-polyfill-"+Math.random(),QE=[],d_="--"+$E+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(w_,X_){return typeof w_=="string"?QE.push(d_+Z0(PE(X_))+`"\r
\r
`+PE(w_)+`\r
`):QE.push(d_+Z0(PE(X_))+'"; filename="'+Z0(w_.name)+`"\r
Content-Type: `+(w_.type||"application/octet-stream")+`\r
\r
`,w_,`\r
`)}),QE.push("--"+$E+"--"),new Blob(QE,{type:"multipart/form-data; boundary="+$E})},M0.prototype[Symbol.iterator]=function(){return this.entries()},M0.prototype.toString=function(){return"[object FormData]"},Q_&&!Q_.matches&&(Q_.matches=Q_.matchesSelector||Q_.mozMatchesSelector||Q_.msMatchesSelector||Q_.oMatchesSelector||Q_.webkitMatchesSelector||function($E){for(var QE=($E=(this.document||this.ownerDocument).querySelectorAll($E)).length;0<=--QE&&$E.item(QE)!==this;);return-1<QE}),T0&&(M0.prototype[T0]="FormData"),JE){var _R=zE.XMLHttpRequest.prototype.setRequestHeader;zE.XMLHttpRequest.prototype.setRequestHeader=function($E,QE){_R.call(this,$E,QE),$E.toLowerCase()==="content-type"&&(this.B=!0)},zE.XMLHttpRequest.prototype.send=function($E){$E instanceof M0?($E=$E._blob(),this.B||this.setRequestHeader("Content-Type",$E.type),JE.call(this,$E)):JE.call(this,$E)}}c_&&(zE.fetch=function($E,QE){return QE&&QE.body&&QE.body instanceof M0&&(QE.body=QE.body._blob()),c_.call(this,$E,QE)}),V_&&(zE.navigator.sendBeacon=function($E,QE){return QE instanceof M0&&(QE=QE._asNative()),V_.call(this,$E,QE)}),zE.FormData=M0}})();const aP=()=>{const $=yE("AREAS");return $.length===0&&$.push(J_.GLOBAL),wR($).call($,(_e,_t,Wt)=>{const _n=RW(_t);return _n?Wt===0?_n:"".concat(_e,",").concat(_n):_e},"")},RW=$=>$===J_.OVERSEA?"".concat(kS.ASIA,",").concat(kS.EUROPE,",").concat(kS.AFRICA,",").concat(kS.NORTH_AMERICA,",").concat(kS.SOUTH_AMERICA,",").concat(kS.OCEANIA):kS[$],Ele=$=>{const _e={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return $.map(_t=>{const Wt=DL[_t],_n=Object.keys(Wt);_n&&_n.map(_i=>{_i!=="CODE"&&(_e[_i]=_e[_i].concat(Wt[_i]))})}),_e},UL={GLOBAL:{ASIA:[J_.CHINA,J_.JAPAN,J_.INDIA,J_.KOREA,J_.HKMC],EUROPE:[],NORTH_AMERICA:[J_.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},jL=Object.keys(UL[J_.GLOBAL]),WV=[J_.CHINA,J_.NORTH_AMERICA,J_.EUROPE,J_.ASIA,J_.JAPAN,J_.INDIA,J_.OCEANIA,J_.SOUTH_AMERICA,J_.AFRICA,J_.KOREA,J_.HKMC,J_.US],vle=function($,_e){let _t=[];if(i_($).call($,J_.GLOBAL)){const _i=[J_.GLOBAL,J_.OVERSEA],_s=Object.keys(DL);if(_e===J_.GLOBAL)throw new DE(mE.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(_e===J_.CHINA)_t=[J_.OVERSEA];else if(_n=_e,i_(jL).call(jL,_n)){const _c=(Wt=_e,UL[J_.GLOBAL][Wt]||[]),_u=[..._i,_e,..._c];_t=_s.filter(_h=>!i_(_u).call(_u,_h))}else if(function(_c){let _u=!1;return jL.forEach(_h=>{var _p;i_(_p=UL[J_.GLOBAL][_h]).call(_p,_c)&&(_u=!0)}),_u}(_e)){const _c=function(_h){let _p;return jL.forEach(Qm=>{var _g;i_(_g=UL[J_.GLOBAL][Qm]).call(_g,_h)&&(_p=Qm)}),_p}(_e),_u=[..._i,_c,_e];_t=_s.filter(_h=>!i_(_u).call(_u,_h))}else _t=$;_t=function(_c){const _u=[];return WV.forEach(_h=>{i_(_c).call(_c,_h)&&_u.push(_h)}),_u.concat(_c.filter(_h=>!i_(WV).call(WV,_h)))}(_t)}else _t=$;var Wt,_n;return _t};function CW($){var _e,_t;if(!$&&i_(_e=yE("AREAS")).call(_e,J_.EXTENSIONS))return iE.debug("update area from ap : reset"),void qV(hce,!0);if(!i_(_t=yE("AREAS")).call(_t,J_.GLOBAL)||!$)return;let Wt=DL.EXTENSIONS;Wt&&(Wt={CODE:RW(J_.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat($,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat($,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat($,".agora.io")],CDS_AP:["cds-ap-web-1-".concat($,".agora.io"),"cds-ap-web-2-".concat($,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat($,".agora.io"),"sua-ap-web-2-".concat($,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat($,".agora.io"),"uap-ap-web-2-".concat($,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat($,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat($,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat($,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat($,".agora.io")]},iE.debug("update area from ap success: ".concat($,",config is "),Wt),d0("AREAS",[J_.EXTENSIONS],!0),Object.keys(Wt).map(_n=>{_n==="LOG_UPLOAD_SERVER"||_n==="EVENT_REPORT_DOMAIN"||_n==="EVENT_REPORT_BACKUP_DOMAIN"||_n==="PROXY_SERVER_TYPE3"?d0(_n,Wt[_n][0]):d0(_n,Wt[_n])}))}function qV($){let _e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const _t=p_.reportApiInvoke(null,{name:Q0.SET_AREA,options:$,tag:j0.TRACER});try{let Wt=[];if(typeof $=="string"&&(Wt=[$]),Array.isArray($)&&($.forEach(_i=>{if(!i_(lW).call(lW,_i))throw new DE(mE.INVALID_PARAMS,"invalid area code")}),Wt=$),Object.prototype.toString.call($)==="[object Object]"){const{areaCode:_i,excludedArea:_s}=$;if(!_i)throw new DE(mE.INVALID_PARAMS,"area code is needed");let _c=_i;typeof _i=="string"&&(_c=[_i]),Wt=_s?vle(_c,_s):_c}if(!_e){if(K1.AREAS){const _i=new DE(mE.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return _t.onError(_i),void iE.warning("setArea is prohibited because of config-distribute")}if(i_(Wt).call(Wt,J_.GLOBAL)&&yE("AREAS")===J_.EXTENSIONS){const _i=new DE(mE.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return _t.onError(_i),void iE.warning("setArea is prohibited because of ap extensions")}}d0("AREAS",Wt,_e);const _n=Ele(Wt);Object.keys(_n).map(_i=>{_i==="LOG_UPLOAD_SERVER"||_i==="EVENT_REPORT_DOMAIN"||_i==="EVENT_REPORT_BACKUP_DOMAIN"||_i==="PROXY_SERVER_TYPE3"?d0(_i,_n[_i][0]):d0(_i,_n[_i])}),iE.debug("set area success:",Wt.join(","))}catch(Wt){throw _t.onError(Wt),Wt}_t.onSuccess()}function IW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function zV($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?IW(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):IW(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let KV=1;function _le($,_e,_t,Wt,_n){KV+=1;const _i={sid:_t.sid,command:"convergeAllocateEdge",uid:"666",appId:_t.appId,ts:Math.floor(Date.now()/1e3),seq:KV,requestId:KV,version:jT,cname:_t.cname},_s={service_name:_e,json_body:JSON.stringify(_i)};let _c,_u,_h=$[0];return IR(async()=>{_c=Date.now();const _p=await PR(_h,{data:_s,cancelToken:Wt,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_u=Date.now()-_c,_p.code!==0){const eE=new DE(mE.UNEXPECTED_RESPONSE,"live streaming ap error, code"+_p.code,{retry:!0,responseTime:_u});throw iE.error(eE.toString()),eE}const Qm=JSON.parse(_p.json_body);if(Qm.code!==200){const eE=new DE(mE.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(Qm.code,", reason: ").concat(Qm.reason),{code:Qm.code,responseTime:_u});throw iE.error(eE.toString()),eE}if(!Qm.servers||Qm.servers.length===0){const eE=new DE(mE.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:Qm.code,responseTime:_u});throw iE.error(eE.toString()),eE}const _g=function(eE,pE){return{addressList:eE.servers.map(aE=>"wss://".concat(aE.address.replace(/\./g,"-"),".").concat(yE("WORKER_DOMAIN"),":").concat(aE.wss,"?serviceName=").concat(encodeURIComponent(pE))),workerToken:eE.workerToken,vid:eE.vid}}(Qm,_e);return yE("LIVE_STREAMING_ADDRESS")&&(_g.addressList=yE("LIVE_STREAMING_ADDRESS")instanceof Array?yE("LIVE_STREAMING_ADDRESS"):[yE("LIVE_STREAMING_ADDRESS")]),zV(zV({},_g),{},{responseTime:_u})},(_p,Qm)=>(p_.apworkerEvent(_t.sid,{success:!0,sc:200,serviceName:_e,responseDetail:JSON.stringify(_p.addressList),firstSuccess:Qm===0,responseTime:_u,serverIp:$[Qm%$.length]}),!1),(_p,Qm)=>(p_.apworkerEvent(_t.sid,{success:!1,sc:_p.data&&_p.data.code||200,serviceName:_e,responseTime:_u,serverIp:$[Qm%$.length]}),!!(_p.code!==mE.OPERATION_ABORTED&&_p.code!==mE.UNEXPECTED_RESPONSE||_p.data&&_p.data.retry)&&(_h=$[(Qm+1)%$.length],!0)),_n)}let $V=1;function AW($,_e,_t,Wt){let{url:_n,areaCode:_i}=$;const{clientId:_s,sid:_c}=_e,_u=Date.now();let _h;const[_p,Qm]=JV(_e,_i,[J0.CHOOSE_SERVER]);let _g=F0.networkState;return IR(async()=>{_g&&F0.networkState===KS.OFFLINE&&F0.onlineWaiter&&await n_.race([F0.onlineWaiter,hS(Wt&&Wt.maxRetryTimeout||Y0.maxRetryTimeout)]),_g=F0.networkState;const{data:eE,headers:pE}=await PR(_n,{data:_p,cancelToken:_t,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_h=pE.http3==="1"?1:-1,p_.reportResourceTiming(_n,_c),NW(eE,_n,_e,_u,[J0.CHOOSE_SERVER],_h);const aE=sP(eE,J0.CHOOSE_SERVER);return YV(aE),VV(aE,_n)},eE=>(eE&&p_.joinChooseServer(_c,{lts:_u,succ:!0,csAddr:_n,opid:Qm,serverList:eE.gatewayAddrs.map(pE=>pE.address),ec:null,cid:eE.cid.toString(),uid:eE.uid.toString(),csIp:eE.csIp,unilbsServerIds:[J0.CHOOSE_SERVER].toString(),isHttp3:_h}),!1),eE=>eE.code!==mE.OPERATION_ABORTED&&(eE.code===mE.CAN_NOT_GET_GATEWAY_SERVER?eE.data.retry:(p_.joinChooseServer(_c,{lts:_u,succ:!1,csAddr:_n,serverList:null,opid:Qm,ec:eE.code,csIp:eE.data&&eE.data.csIp,unilbsServerIds:[J0.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:_g}),isHttp3:_h}),iE.warning("[".concat(_s||"sid-".concat(_c.slice(0,6)),"] Choose server network error, retry"),eE),!0)),Wt)}function OW($,_e,_t,Wt){let _n,{url:_i,areaCode:_s,serviceIds:_c}=$;const _u=Date.now(),[_h,_p]=JV(_e,_s,_c);let Qm;return IR(async()=>{Qm&&F0.networkState===KS.OFFLINE&&F0.onlineWaiter&&await n_.race([F0.onlineWaiter,hS(Wt&&Wt.maxRetryTimeout||Y0.maxRetryTimeout)]),Qm=F0.networkState;const{data:_g,headers:eE}=await PR(_i,{data:_h,cancelToken:_t,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_n=eE.http3==="1"?1:-1,p_.reportResourceTiming(_i,_e.sid),NW(_g,_i,_e,_u,_c,_n);const pE=sP(_g,J0.CHOOSE_SERVER),aE=sP(_g,_e.cloudProxyServer==="proxy5"?J0.CLOUD_PROXY_5:_e.cloudProxyServer==="proxy3"||_e.cloudProxyServer==="proxy4"?J0.CLOUD_PROXY:J0.CLOUD_PROXY_FALLBACK);return YV(pE),{gatewayInfo:VV(pE,_i),proxyInfo:aE,url:_i}},_g=>(_g.gatewayInfo&&p_.joinChooseServer(_e.sid,{lts:_u,succ:!0,csAddr:_i,serverList:_g.gatewayInfo.gatewayAddrs.map(eE=>eE.address),ec:null,opid:_p,cid:_g.gatewayInfo.cid.toString(),uid:_g.gatewayInfo.uid.toString(),csIp:_g.gatewayInfo.csIp,unilbsServerIds:_c.toString(),isHttp3:_n}),_g.proxyInfo&&p_.joinWebProxyAP(_e.sid,{lts:_u,sucess:1,apServerAddr:_i,turnServerAddrList:_g.proxyInfo.addresses.map(eE=>eE.ip).join(","),errorCode:null,eventType:_e.cloudProxyServer,unilbsServerIds:_c.toString()}),!1),_g=>_g.code!==mE.OPERATION_ABORTED&&(_g.code===mE.CAN_NOT_GET_GATEWAY_SERVER?_g.data.retry:(p_.joinWebProxyAP(_e.sid,{lts:_u,sucess:0,apServerAddr:_i,turnServerAddrList:null,errorCode:_g.code,eventType:_e.cloudProxyServer,unilbsServerIds:_c.toString(),extend:JSON.stringify({networkState:Qm})}),iE.warning("[".concat(_e.clientId,"] multi unilbs network error, retry"),_g),!0)),Wt)}const NW=($,_e,_t,Wt,_n,_i)=>{const{sid:_s,clientId:_c,cloudProxyServer:_u}=_t,_h=[],_p=Qm=>{Qm.flag===4096?p_.joinChooseServer(_s,{lts:Wt,succ:!1,csAddr:_e,opid:$.opid,serverList:null,ec:Qm.error.message,csIp:Qm.error.data&&Qm.error.data.csIp,unilbsServerIds:_n.toString(),isHttp3:_i}):Qm.flag!==1048576&&Qm.flag!==4194304&&Qm.flag!==4194310||p_.joinWebProxyAP(_s,{lts:Wt,sucess:0,apServerAddr:_e,turnServerAddrList:null,errorCode:Qm.error.code,eventType:_u,unilbsServerIds:_n.toString()})};if($.response_body.forEach(Qm=>{const _g=Qm.buffer.code;if(Qm.uri===23&&_g===0&&!Qm.buffer.edges_services)if(Qm.buffer.flag===4194310)iE.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),Qm.buffer.edges_services=[];else{const eE={error:new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:$.detail[502]}),flag:Qm.buffer.flag};_h.push(eE),_p(eE)}if(_g!==0){const eE=MO(_g),pE={error:new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,eE.desc,{desc:eE.desc,retry:eE.retry,csIp:$.detail[502]}),flag:Qm.buffer.flag};Qm.buffer.flag===4194310?iE.warning(pE.error.toString()):_h.push(pE),_p(pE)}}),_h.length)throw iE.warning("[".concat(_c||"sid-".concat(_s.slice(0,6)),"] multi unilbs ").concat(_e," failed, ").concat(_h.map(Qm=>"flag: ".concat(Qm.flag,", message: ").concat(Qm.error.message,", retry: ").concat(Qm.error.data.retry)).join(" | "))),new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,_h.map(Qm=>"flag: ".concat(Qm.flag,", message: ").concat(Qm.error.message)).join(" | "),{retry:!!_h.find(Qm=>Qm.error.data.retry),csIp:$.detail[502],desc:[...new Set(_h.map(Qm=>{var _g;return Qm==null||(_g=Qm.error)===null||_g===void 0||(_g=_g.data)===null||_g===void 0?void 0:_g.desc}).filter(Qm=>!!Qm))]})},YV=$=>{var _e,_t,Wt,_n;if($.addresses&&$.addresses.length===0&&$.code===0)throw new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:$.detail&&$.detail[502]});if(yE("AP_AREA")&&((Wt=$.detail)!==null&&Wt!==void 0&&Wt[23]&&typeof((_n=$.detail)===null||_n===void 0?void 0:_n[23])=="string"?CW($.detail[23].toLowerCase()):CW()),(_e=$.detail)!==null&&_e!==void 0&&_e[19]&&typeof((_t=$.detail)===null||_t===void 0?void 0:_t[19])=="string"){const _s=$.detail[19],_c=_s==null?void 0:_s.split(";");for(let _u=0;_u<_c.length;_u++){var _i;const _h=VS(_i=_c[_u]).call(_i);$.addresses[_u]&&_c&&($.addresses[_u].fingerprint=_h)}}if(yE("GATEWAY_ADDRESS")&&yE("GATEWAY_ADDRESS").length>0){iE.debug("assign gateway address to",yE("GATEWAY_ADDRESS"));const _s=yE("GATEWAY_ADDRESS").map(_c=>{var _u,_h;const _p=(_u=(_h=$.addresses.find(Qm=>Qm.ip===_c.ip&&Qm.port===_c.port))===null||_h===void 0?void 0:_h.fingerprint)!==null&&_u!==void 0?_u:"";return{ip:_c.ip,port:_c.port,ticket:$.addresses[0]&&$.addresses[0].ticket,fingerprint:_p}});$.addresses=_s}},yle=($,_e)=>{if($.response_body&&$.response_body.length){const _t=$.response_body[0];if(_t.buffer.code!==0){const Wt=MO(_t.buffer.code);throw new DE(mE.UPDATE_TICKET_FAILED,"[".concat(_t.buffer.code,"]: ").concat(Wt.desc),{retry:Wt.retry})}return _t.buffer.ticket}throw iE.debug("update ticket request received ap response without response body:",_e),new DE(mE.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},JV=($,_e,_t)=>{const Wt=Math.floor(Math.random()*1e12),_n={appid:$.appId,client_ts:Date.now(),opid:Wt,sid:$.sid,request_bodies:[{uri:22,buffer:{cname:$.cname,detail:zV({6:$.stringUid,11:_e,12:yE("USE_NEW_TOKEN")?"1":void 0,22:_e},$.apRTM?{26:"RTM2"}:{}),key:$.token,service_ids:_t,uid:$.uid||0}}]};_n.request_bodies.forEach(_s=>{$.multiIP&&$.multiIP.gateway_ip&&(_s.buffer.detail[5]=JSON.stringify({vocs_ip:[$.multiIP.uni_lbs_ip],vos_ip:[$.multiIP.gateway_ip]}))});const _i=new FormData;return _i.append("request",JSON.stringify(_n)),[_i,Wt]},ble=($,_e)=>{const _t=Math.floor(Math.random()*1e12),Wt={appid:$.appId,client_ts:Date.now(),opid:_t,sid:$.sid,request_bodies:[{uri:28,buffer:{cname:$.cname,detail:{1:"",6:$.stringUid,12:"1"},token:$.token,service_ids:_e,uid:$.uid||0,edges_services:$.apResponse.addresses.map(_i=>({ip:_i.ip,port:_i.port}))}}]},_n=new FormData;return _n.append("request",JSON.stringify(Wt)),[_n,_t]};let UO=0;function jO($){return n_.all($.map(_e=>_e.then(_t=>{throw _t},_t=>_t))).then(_e=>{throw _e},_e=>_e)}const cP=async $=>{let{fragementLength:_e,referenceList:_t,asyncMapHandler:Wt,allFailedhandler:_n,promisesCollector:_i}=$,_s=0;const _c=_e;let _u,_h=0;const _p=async()=>{const Qm=(()=>{const _g=_s*_c,eE=_g+_c;return _t.slice(_g,eE).map(Wt)})();_i&&_i.push(...Qm);try{_u=await jO(Qm)}catch(_g){if(_h+=_c,_s++,!(_h>=_t.length))return void await _p();_n(_g)}Qm.forEach(_g=>_g.cancel())};return await _p(),_u},PW=async $=>{let{referenceList:_e,asyncMapHandler:_t,closeFn:Wt}=$;const _n=_e.length;let _i=0;const _s=async()=>{const _c=_t(_e.shift());try{return await _c}catch(_u){if(_i++,_i>=_n||Wt!=null&&Wt(_u))throw _u;return _s()}};return _s()};async function XV($,_e,_t,Wt){return{gatewayInfo:await async function(_i,_s,_c,_u){let _h=null;const _p=[],Qm=async()=>{const eE=yE("WEBCS_DOMAIN").slice(0,yE("AJAX_REQUEST_CONCURRENT")).map(cE=>({url:_i.proxyServer?"https://".concat(_i.proxyServer,"/ap/?url=").concat(cE+"/api/v2/transpond/webrtc?v=2"):"https://".concat(cE,"/api/v2/transpond/webrtc?v=2"),areaCode:aP()})),pE=_u.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:eE.map(cE=>cE.url)}),aE=await cP({fragementLength:yE("FRAGEMENT_LENGTH"),referenceList:eE,asyncMapHandler:cE=>(iE.debug("[".concat(_i.clientId,"] Connect to choose_server:"),cE.url),AW(cE,_i,_s,_c)),allFailedhandler:cE=>{throw _u.recordJoinChannelService({endTs:Date.now(),status:"error",errors:cE},pE),cE[0]},promisesCollector:_p});return _u.recordJoinChannelService({endTs:Date.now(),status:"success"},pE),aE},_g=async()=>{if(await hS(1e3),_h!==null)return _h;const eE=yE("WEBCS_DOMAIN_BACKUP_LIST").map(cE=>({url:_i.proxyServer?"https://".concat(_i.proxyServer,"/ap/?url=").concat(cE+"/api/v2/transpond/webrtc?v=2"):"https://".concat(cE,"/api/v2/transpond/webrtc?v=2"),areaCode:aP()})),pE=_u.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:eE.map(cE=>cE.url)}),aE=await cP({fragementLength:yE("FRAGEMENT_LENGTH"),referenceList:eE,asyncMapHandler:cE=>(iE.debug("[".concat(_i.clientId,"] Connect to backup choose_server:"),cE.url),AW(cE,_i,_s,_c)),allFailedhandler:cE=>{throw _u.recordJoinChannelService({endTs:Date.now(),status:"error",errors:cE},pE),cE[0]},promisesCollector:_p});return _u.recordJoinChannelService({endTs:Date.now(),status:"success"},pE),aE};try{return _h=await jO([Qm(),_g()]),_p.length&&_p.forEach(eE=>eE.cancel&&typeof eE.cancel=="function"&&eE.cancel()),_h}catch(eE){throw eE[0]}}($,_e,_t,Wt)}}async function kW($,_e,_t,Wt,_n){const _i=$.cloudProxyServer;if(_i==="disabled"){if($.useLocalAccessPoint)return await XV($,_e,_t,_n);if(yE("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:_g,proxyInfo:eE}=await xW($,_e,_t,_n);if($.turnServer&&$.turnServer.mode!=="auto")return{gatewayInfo:_g};const pE=eE.map(aE=>({turnServerURL:aE.address,tcpport:aE.tcpport||CS.tcpport,udpport:aE.udpport||CS.udpport,username:aE.username||CS.username,password:aE.password||CS.password,forceturn:!1,security:!0}));if(_n.useP2P){var _s;const aE=(_s=$.uid)!==null&&_s!==void 0?_s:_g.uid,cE="glb:".concat(aE.toString()),fE=await yV(cE),gE=eE.map(AE=>({turnServerURL:AE.address,tcpport:AE.tcpport||CS.tcpport,udpport:AE.udpport||CS.udpport,username:cE,password:fE,forceturn:!1,security:!0}));pE.push(...gE)}return $.turnServer={mode:"manual",servers:pE},{gatewayInfo:_g}}return await XV($,_e,_t,_n)}const{proxyInfo:_c,gatewayInfo:_u}=await xW($,_e,_t,_n),_h={gatewayInfo:_u},_p=_c.map(_g=>({turnServerURL:_g.address,tcpport:_i==="proxy3"?void 0:_g.tcpport?_g.tcpport:CS.tcpport,udpport:_i==="proxy4"?void 0:_g.udpport?_g.udpport:CS.udpport,username:_g.username||CS.username,password:_g.password||CS.password,forceturn:_i!=="proxy4",security:_i==="proxy5"}));if(_n.useP2P){var Qm;const _g=(Qm=$.uid)!==null&&Qm!==void 0?Qm:_u.uid,eE="glb:".concat(_g.toString()),pE=await yV(eE),aE=_c.map(cE=>({turnServerURL:cE.address,tcpport:_i==="proxy3"?void 0:cE.tcpport||CS.tcpport,udpport:_i==="proxy4"?void 0:cE.udpport||CS.udpport,username:eE,password:pE,forceturn:_i!=="proxy4",security:_i==="proxy5"}));_p.push(...aE)}return $.turnServer={mode:"manual",servers:_p},iE.debug("[".concat($.clientId,"] set proxy server: ").concat($.proxyServer,", mode: ").concat(_i)),_h}async function DW($,_e,_t,Wt,_n){const _i=yE("ACCOUNT_REGISTER").slice(0,yE("AJAX_REQUEST_CONCURRENT"));let _s=[];_s=_e.proxyServer?_i.map(_u=>"https://".concat(_e.proxyServer,"/ap/?url=").concat(_u+"/api/v1")):_i.map(_u=>"https://".concat(_u,"/api/v1"));const _c=_n==null?void 0:_n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:_s});try{const _u=await async function(_h,_p,Qm,_g,eE){const pE=Date.now(),aE={sid:Qm.sid,opid:10,appid:Qm.appId,string_uid:_p};let cE=_h[0];const fE=await IR(()=>PR(cE+"".concat(cE.indexOf("?")===-1?"?":"&","action=stringuid"),{data:aE,cancelToken:_g,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(gE,AE)=>{if(gE.code===0){if(gE.uid<=0||gE.uid>=Math.pow(2,32))throw iE.error("Invalid Uint Uid ".concat(_p," => ").concat(gE.uid),gE),p_.reqUserAccount(aE.sid,{lts:pE,success:!1,serverAddr:cE,stringUid:aE.string_uid,uid:gE.uid,errorCode:mE.INVALID_UINT_UID_FROM_STRING_UID,extend:aE}),new DE(mE.INVALID_UINT_UID_FROM_STRING_UID);return p_.reqUserAccount(aE.sid,{lts:pE,success:!0,serverAddr:cE,stringUid:aE.string_uid,uid:gE.uid,errorCode:null,extend:aE}),!1}const PE=MO(gE.code);return PE.retry&&(cE=_h[(AE+1)%_h.length]),p_.reqUserAccount(aE.sid,{lts:pE,success:!1,serverAddr:cE,stringUid:aE.string_uid,uid:gE.uid,errorCode:PE.desc,extend:aE}),PE.retry},(gE,AE)=>gE.code!==mE.OPERATION_ABORTED&&(p_.reqUserAccount(aE.sid,{lts:pE,success:!1,serverAddr:cE,stringUid:aE.string_uid,uid:null,errorCode:gE.code,extend:aE}),cE=_h[(AE+1)%_h.length],!0),eE);if(fE.code!==0){const gE=MO(fE.code);throw new DE(mE.UNEXPECTED_RESPONSE,gE.desc)}return fE}(_s,$,_e,_t,Wt);return _n==null||_n.recordJoinChannelService({status:"success",endTs:Date.now()},_c),_u.uid}catch(_u){throw _n==null||_n.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_u]},_c),_u}}async function Sle($,_e,_t){const Wt=yE("ACCOUNT_REGISTER");let _n=[];_n=_e.proxyServer?Wt.map(_i=>"https://".concat(_e.proxyServer,"/ap/?url=").concat(_i+"/api/v1")):Wt.map(_i=>"https://".concat(_i,"/api/v1"));try{return await PW({referenceList:_n,asyncMapHandler:_s=>async function(_c,_u,_h,_p){const Qm=Date.now(),_g={sid:_h.sid,opid:10,appid:_h.appId,string_uid:_u};try{const eE=await PR(_c+"".concat(_c.indexOf("?")===-1?"?":"&","action=stringuid"),{data:_g,cancelToken:_p,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(eE.code!==0){const pE=MO(eE.code);throw new DE(mE.UNEXPECTED_RESPONSE,"preload sua error:".concat(pE.desc),pE)}if(eE.uid<=0||eE.uid>=Math.pow(2,32))throw new DE(mE.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:Qm,url:_c,req:_g,uid:eE.uid,elapse:Date.now()-Qm}}catch(eE){throw eE}}(_s,$,_e,_t),closeFn:_s=>_s.code===mE.OPERATION_ABORTED||_s.code===mE.UNEXPECTED_RESPONSE&&!_s.data.retry})}catch(_i){throw _i}}async function Tle($,_e,_t){const Wt=yE("CDS_AP").slice(0,yE("AJAX_REQUEST_CONCURRENT")).map(_u=>$.proxyServer?"https://".concat($.proxyServer,"/ap/?url=").concat(_u+"/api/v1"):"https://".concat(_u,"/api/v1?action=config")),_n=Wt.map(_u=>function(_h,_p,Qm,_g){const eE=W_(),pE={flag:64,cipher_method:0,features:{device:eE.name,system:eE.os,system_general:navigator.userAgent,vendor:_p.appId,version:jT,cname:_p.cname,sid:_p.sid,session_id:_p.sid,detail:"",proxyServer:_p.proxyServer}};return IR(()=>PR(_h,{data:pE,timeout:1e3,cancelToken:Qm,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,aE=>aE.code!==mE.OPERATION_ABORTED,_g)}(_u,$,_e,_t));let _i=null,_s=null,_c={};try{_i=await jO(_n)}catch(_u){if(_u.code===mE.OPERATION_ABORTED)throw _u;_s=_u}if(_n.forEach(_u=>_u.cancel()),p_.reportApiInvoke($.sid,{name:Q0.REQUEST_CONFIG_DISTRIBUTE,options:{error:_s,res:_i}}).onSuccess(),_i&&_i.test_tags)try{_c=function(_u){if(!_u.test_tags)return{};const _h=_u.test_tags,_p=Object.keys(_h),Qm={};return _p.forEach(_g=>{var eE;const pE=VS(eE=_g.slice(4)).call(eE),aE=JSON.parse(_h[_g])[1];Qm[pE]=aE}),Qm}(_i)}catch{}return _c}async function LW($,_e){const _t=yE("WEBCS_DOMAIN").concat(yE("WEBCS_DOMAIN_BACKUP_LIST")).map(Wt=>({url:"https://".concat(Wt,"/api/v2/transpond/webrtc?v=2"),areaCode:aP(),serviceIds:[J0.CHOOSE_SERVER,J0.CLOUD_PROXY_FALLBACK]}));try{return await PW({referenceList:_t,asyncMapHandler:_n=>async function(_i,_s,_c){let _u,{url:_h,areaCode:_p,serviceIds:Qm}=_i;const _g=Date.now(),[eE,pE]=JV(_s,_p,Qm);let aE=F0.networkState;try{aE&&F0.networkState===KS.OFFLINE&&F0.onlineWaiter&&await n_.race([F0.onlineWaiter,hS(Y0.maxRetryTimeout)]),aE=F0.networkState;const{data:cE,headers:fE}=await PR(_h,{data:eE,cancelToken:_c,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_u=fE.http3==="1"?1:-1,(xE=>{const GE=[];if(xE.response_body.forEach(zE=>{const KE=zE.buffer.code;if(zE.uri===23&&KE===0&&!zE.buffer.edges_services)if(zE.buffer.flag===4194310)zE.buffer.edges_services=[];else{const JE={error:new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:xE.detail[502]}),flag:zE.buffer.flag};GE.push(JE)}if(KE!==0){const JE=MO(KE),c_={error:new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,JE.desc,{desc:JE.desc,retry:JE.retry,csIp:xE.detail[502]}),flag:zE.buffer.flag};zE.buffer.flag===4194310?iE.warning(c_.error.toString()):GE.push(c_)}}),GE.length)throw new DE(mE.CAN_NOT_GET_GATEWAY_SERVER,GE.map(zE=>"flag: ".concat(zE.flag,", message: ").concat(zE.error.message)).join(" | "),{retry:!!GE.find(zE=>zE.error.data.retry),csIp:xE.detail[502],desc:[...new Set(GE.map(zE=>{var KE;return zE==null||(KE=zE.error)===null||KE===void 0||(KE=KE.data)===null||KE===void 0?void 0:KE.desc}).filter(zE=>!!zE))]})})(cE);const AE=sP(cE,J0.CHOOSE_SERVER),PE=sP(cE,J0.CLOUD_PROXY_FALLBACK);return YV(AE),{gatewayInfo:VV(AE,_h),proxyInfo:PE,opid:pE,requestTime:_g,url:_h,isHttp3:_u,elapse:Date.now()-_g}}catch(cE){throw cE}}(_n,$,_e),closeFn:_n=>_n.code===mE.OPERATION_ABORTED||_n.code===mE.CAN_NOT_GET_GATEWAY_SERVER&&!_n.data.retry})}catch(Wt){throw Wt}}async function xW($,_e,_t,Wt){const _n=yE("PROXY_SERVER_TYPE3"),_i=(eE,pE,aE)=>{let cE=aE||_n;return Array.isArray(cE)&&(cE=pE%2==0?_n[1]:_n[0]),"https://".concat(cE,"/ap/?url=").concat(eE)};let _s=null;const _c=[],_u=async()=>{const eE=yE("WEBCS_DOMAIN").slice(0,yE("AJAX_REQUEST_CONCURRENT")).map((cE,fE)=>{let gE;return gE=$.cloudProxyServer==="disabled"&&$.proxyServer?_i("".concat(cE,"/api/v2/transpond/webrtc?v=2"),fE,$.proxyServer):$.cloudProxyServer==="disabled"||$.cloudProxyServer==="fallback"?"https://".concat(cE,"/api/v2/transpond/webrtc?v=2"):_i("".concat(cE,"/api/v2/transpond/webrtc?v=2"),fE),{url:gE,areaCode:aP(),serviceIds:[J0.CHOOSE_SERVER,$.cloudProxyServer==="proxy5"?J0.CLOUD_PROXY_5:$.cloudProxyServer==="proxy3"||$.cloudProxyServer==="proxy4"?J0.CLOUD_PROXY:J0.CLOUD_PROXY_FALLBACK]}}),pE=Wt.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:eE.map(cE=>cE.url)}),aE=await cP({fragementLength:yE("FRAGEMENT_LENGTH"),referenceList:eE,asyncMapHandler:cE=>(iE.debug("[".concat($.clientId,"] Connect to choose_server:"),cE.url),OW(cE,$,_e,_t)),allFailedhandler:cE=>{throw Wt.recordJoinChannelService({endTs:Date.now(),status:"error",errors:cE},pE),cE[0]},promisesCollector:_c});return Wt.recordJoinChannelService({endTs:Date.now(),status:"success"},pE),aE},_h=async()=>{if(await hS(1e3),_s!==null)return _s;const eE=yE("WEBCS_DOMAIN_BACKUP_LIST").map((cE,fE)=>{let gE;return gE=$.cloudProxyServer==="disabled"&&$.proxyServer?_i("".concat(cE,"/api/v2/transpond/webrtc?v=2"),fE,$.proxyServer):$.cloudProxyServer==="disabled"||$.cloudProxyServer==="fallback"?"https://".concat(cE,"/api/v2/transpond/webrtc?v=2"):_i("".concat(cE,"/api/v2/transpond/webrtc?v=2"),fE),{url:gE,areaCode:aP(),serviceIds:[J0.CHOOSE_SERVER,$.cloudProxyServer==="proxy5"?J0.CLOUD_PROXY_5:$.cloudProxyServer==="proxy3"||$.cloudProxyServer==="proxy4"?J0.CLOUD_PROXY:J0.CLOUD_PROXY_FALLBACK]}}),pE=Wt.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:eE.map(cE=>cE.url)}),aE=await cP({fragementLength:yE("FRAGEMENT_LENGTH"),referenceList:eE,asyncMapHandler:cE=>(iE.debug("[".concat($.clientId,"] Connect to backup choose_server:"),cE.url),OW(cE,$,_e,_t)),allFailedhandler:cE=>{throw Wt.recordJoinChannelService({endTs:Date.now(),status:"error",errors:cE},pE),cE[0]},promisesCollector:_c});return Wt.recordJoinChannelService({endTs:Date.now(),status:"success"},pE),aE};let _p,Qm,_g;try{({gatewayInfo:_p,proxyInfo:Qm,url:_g}=await jO([_u(),_h()]))}catch(eE){throw eE[0]}if(_c.length&&_c.forEach(eE=>eE.cancel&&typeof eE.cancel=="function"&&eE.cancel()),!_p||!Qm)throw new DE(mE.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if($.apUrl=_g,$.cloudProxyServer!=="disabled"&&Array.isArray(_n)&&_g){const eE=/^https?:\/\/(.+?)(\/.*)?$/.exec(_g)[1];i_(_n).call(_n,eE)&&($.proxyServer=eE,iE.setProxyServer(eE),p_.setProxyServer(eE))}return _s={gatewayInfo:_p,proxyInfo:await yW(Qm,_p.uid)},_s}async function MW($,_e,_t,Wt){const _n=yE("UAP_AP").slice(0,yE("AJAX_REQUEST_CONCURRENT")).map(_i=>_e.proxyServer?"https://".concat(_e.proxyServer,"/ap/?url=").concat(_i+"/api/v1?action=uap"):"https://".concat(_i,"/api/v1?action=uap"));return await _le(_n,$,_e,_t,Wt)}async function wle($,_e,_t){const Wt=yE("UAP_AP").slice(0,yE("AJAX_REQUEST_CONCURRENT")).map(_i=>$.proxyServer?"https://".concat($.proxyServer,"/ap/?url=").concat(_i+"/api/v1?action=uap"):"https://".concat(_i,"/api/v1?action=uap")),_n=Wt.map(_i=>function(_s,_c,_u,_h){const _p={command:"convergeAllocateEdge",sid:_c.sid,appId:_c.appId,token:_c.token,ts:Date.now(),version:jT,cname:_c.cname,uid:_c.uid.toString(),requestId:$V,seq:$V};$V+=1;const Qm={service_name:"tele_channel",json_body:JSON.stringify(_p)};return IR(async()=>{const _g=await PR(_s,{data:Qm,cancelToken:_u,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(_g.code!==0){const pE=new DE(mE.UNEXPECTED_RESPONSE,"cross channel ap error, code"+_g.code,{retry:!0});throw iE.error(pE.toString()),pE}const eE=JSON.parse(_g.json_body);if(eE.code!==200){const pE=new DE(mE.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(eE.code,", reason: ").concat(eE.reason));throw iE.error(pE.toString()),pE}if(!eE.servers||eE.servers.length===0){const pE=new DE(mE.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw iE.error(pE.toString()),pE}return{vid:eE.vid,workerToken:eE.workerToken,addressList:(yE("CHANNEL_MEDIA_RELAY_SERVERS")||eE.servers).map(pE=>"wss://".concat(pE.address.replace(/\./g,"-"),".").concat(yE("WORKER_DOMAIN"),":").concat(pE.wss))}},void 0,_g=>!!(_g.code!==mE.OPERATION_ABORTED&&_g.code!==mE.UNEXPECTED_RESPONSE||_g.data&&_g.data.retry),_h)}(_i,$,_e,_t));try{const _i=await jO(_n);return _n.forEach(_s=>_s.cancel()),_i}catch(_i){throw _i[0]}}async function Rle($,_e,_t){let Wt=null;const _n=[],_i=async _s=>{const _c=yE(_s?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_u=>$.proxyServer?"https://".concat($.proxyServer,"/ap/?url=").concat(_u+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_u,"/api/v2/transpond/webrtc?v=2"));return _s&&(await hS(1e3),Wt!==null)?Wt:await cP({fragementLength:yE("FRAGEMENT_LENGTH"),referenceList:_c,asyncMapHandler:_u=>(iE.debug("[".concat($.clientId,"] update ticket, Connect to ").concat(_s?"backup":""," choose_server:"),_u),function(_h,_p,Qm,_g){const[eE]=ble(_p,[J0.CHOOSE_SERVER]);let pE=F0.networkState;return IR(async()=>{pE&&F0.networkState===KS.OFFLINE&&F0.onlineWaiter&&await n_.race([F0.onlineWaiter,hS(_g&&_g.maxRetryTimeout||Y0.maxRetryTimeout)]),pE=F0.networkState;const aE=await PR(_h,{data:eE,cancelToken:Qm,headers:{"Content-Type":"multipart/form-data;"}},!0);return yle(aE,_h)},()=>!1,aE=>aE.code!==mE.OPERATION_ABORTED&&(aE.code===mE.UPDATE_TICKET_FAILED?aE.data.retry:(iE.warning("[".concat(_p.clientId,"] update ticket network error, retry"),aE),!0)),_g)}(_u,$,_e,_t)),allFailedhandler:_u=>{throw _u[0]},promisesCollector:_n})};try{return Wt=await jO([_i(!1),_i(!0)]),_n.length&&_n.forEach(_s=>_s.cancel&&typeof _s.cancel=="function"&&_s.cancel()),Wt}catch(_s){throw _s[0]}}function UW($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function jW($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?UW(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):UW(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class Cle extends A0{get isSuccess(){return!!this.configs}constructor(){super(),hE(this,"configs",void 0),hE(this,"joinInfo",void 0),hE(this,"cancelToken",void 0),hE(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),hE(this,"interval",void 0),hE(this,"mutex",new mS("config-distribute")),hE(this,"mutableParamsRead",!1)}startGetConfigDistribute(_e,_t){this.joinInfo=_e,this.cancelToken=_t,this.interval&&this.stopGetConfigDistribute(),yE("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},yE("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,p_.reportApiInvoke(null,{options:void 0,name:Q0.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:j0.TRACER}).onSuccess(JSON.stringify(K1))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void iE.debug("[config-distribute] get config distribute interrupted have no joininfo");let _e;const _t=await this.mutex.lock();try{_e=await Tle(this.joinInfo,this.cancelToken,this.retryConfig),iE.debug("[config-distribute] get config distribute",JSON.stringify(_e)),_e.limit_bitrate&&this.handleBitrateLimit(_e.limit_bitrate),this.cacheGlobalParameterConfig(_e),this.configs=_e}catch(Wt){const _n=new DE(mE.NETWORK_RESPONSE_ERROR,Wt);iE.warning("[config-distribute] ".concat(_n.toString()))}finally{_t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(_e){var _t;(_t=_e)&&_t.uplink&&_t.id&&_t.uplink.max_bitrate!==void 0&&_t.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==_e.id&&this.emit(jV.UPDATE_BITRATE_LIMIT,_e):this.emit(jV.UPDATE_BITRATE_LIMIT,_e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&jW({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(_e){var _t;const Wt=MN(_t=Object.keys(_e).filter(_i=>/^webrtc_ng_global_parameter/.test(_i))).call(_t);for(let _i=0;_i<Wt.length;_i++)for(let _s=Wt.length-1;_s>_i;_s--){const _c=Wt[_s];if(typeof _e[_c].__priority=="number"){const _u=_e[_c].__priority,_h=Wt[_s-1];if(typeof _e[_h].__priority=="number"){if(!(_u>_e[_h].__priority))continue;{const _p=_c;Wt[_s]=Wt[_s-1],Wt[_s-1]=_p}}else{const _p=_c;Wt[_s]=Wt[_s-1],Wt[_s-1]=_p}}}const _n={};Wt.forEach(_i=>{const _s=_e[_i],_c=_s.__expires;Object.keys(_s).forEach(_u=>{_u==="__priority"||_u==="__expires"||Object.prototype.hasOwnProperty.call(_n,_u)||(_n[_u]=jW({value:_s[_u]},_c&&{expires:_c}))})});try{(function(_c){try{const _u=Date.now();Object.keys(_c).forEach(_h=>{switch(_h){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":case"ENABLE_AG_ADAPTATION":case"FORCE_AG_HIGH_FRAMERATE":case"FORCE_SUPPORT_AG_ADAPTATION":case"ENCODER_CONFIG_LIMIT":case"CAMERA_CAPTURE_CONFIG":case"ENABLE_PRELOAD":if(Object.prototype.hasOwnProperty.call(nS,_h)){const{value:_p,expires:Qm}=_c[_h];if(Qm&&Qm<=_u)return;K1[_h]=_p,nS[_h]=_p,iE.debug("Update global parameters from config distribute",_h,_p)}}})}catch(_u){iE.error("Error update config immediately: ".concat(_c),_u.message)}})(_n);const _i=JSON.stringify(_n),_s=window.btoa(_i);window.localStorage.setItem("websdk_ng_global_parameter",_s),iE.debug("Caching global parameters ".concat(_i))}catch(_i){iE.error("Error caching global parameters:",_i.message)}}}var sR,Ile=zt(iW),FW=jE,Ale=_f,Ole=FE,Nle=_r,ZV=vD,Ple=RN,kle=VE,Dle=e0,Lle=LS,FO=Object.assign,VW=Object.defineProperty,xle=Ale([].concat),Mle=!FO||Nle(function(){if(FW&&FO({b:1},FO(VW({},"a",{enumerable:!0,get:function(){VW(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var $={},_e={},_t=Symbol(),Wt="abcdefghijklmnopqrst";return $[_t]=7,Wt.split("").forEach(function(_n){_e[_n]=_n}),FO({},$)[_t]!=7||ZV(FO({},_e)).join("")!=Wt})?function($,_e){for(var _t=Dle($),Wt=arguments.length,_n=1,_i=Ple.f,_s=kle.f;Wt>_n;)for(var _c,_u=Lle(arguments[_n++]),_h=_i?xle(ZV(_u),_i(_u)):ZV(_u),_p=_h.length,Qm=0;_p>Qm;)_c=_h[Qm++],FW&&!Ole(_s,_u,_c)||(_t[_c]=_u[_c]);return _t}:FO,Ule=sT,jle=g4,Fle=L1,Vle=FE,Ble=e0,Gle=function($,_e,_t,Wt){try{return Wt?_e(Ule(_t)[0],_t[1]):_e(_t)}catch(_n){jle($,"throw",_n)}},Hle=p4,Wle=PD,qle=f1,BW=KD,zle=vU,Kle=SD,GW=Array,UI=_f,QV=2147483647,$le=/[^\0-\u007E]/,HW=/[.\u3002\uFF0E\uFF61]/g,WW="Overflow: input needs wider integers to process",qW=RangeError,Yle=UI(HW.exec),VO=Math.floor,e6=String.fromCharCode,zW=UI("".charCodeAt),KW=UI([].join),Q1=UI([].push),Jle=UI("".replace),Xle=UI("".split),Zle=UI("".toLowerCase),$W=function($){return $+22+75*($<26)},Qle=function($,_e,_t){var Wt=0;for($=_t?VO($/700):$>>1,$+=VO($/_e);$>455;)$=VO($/35),Wt+=36;return VO(Wt+36*$/($+38))},eue=function($){var _e=[];$=function(fE){for(var gE=[],AE=0,PE=fE.length;AE<PE;){var xE=zW(fE,AE++);if(xE>=55296&&xE<=56319&&AE<PE){var GE=zW(fE,AE++);(64512&GE)==56320?Q1(gE,((1023&xE)<<10)+(1023&GE)+65536):(Q1(gE,xE),AE--)}else Q1(gE,xE)}return gE}($);var _t,Wt,_n=$.length,_i=128,_s=0,_c=72;for(_t=0;_t<$.length;_t++)(Wt=$[_t])<128&&Q1(_e,e6(Wt));var _u=_e.length,_h=_u;for(_u&&Q1(_e,"-");_h<_n;){var _p=QV;for(_t=0;_t<$.length;_t++)(Wt=$[_t])>=_i&&Wt<_p&&(_p=Wt);var Qm=_h+1;if(_p-_i>VO((QV-_s)/Qm))throw qW(WW);for(_s+=(_p-_i)*Qm,_i=_p,_t=0;_t<$.length;_t++){if((Wt=$[_t])<_i&&++_s>QV)throw qW(WW);if(Wt==_i){for(var _g=_s,eE=36;;){var pE=eE<=_c?1:eE>=_c+26?26:eE-_c;if(_g<pE)break;var aE=_g-pE,cE=36-pE;Q1(_e,e6($W(pE+aE%cE))),_g=VO(aE/cE),eE+=36}Q1(_e,e6($W(_g))),_c=Qle(_s,Qm,_h==_u),_s=0,_h++}}_s++,_i++}return KW(_e,"")},tue=y0,t6=jE,nue=WF,n6=rE,YW=L1,aR=_f,FL=M1,cR=ND,rue=PU,r6=_0,i6=Mle,BO=function($){var _e=Ble($),_t=Wle(this),Wt=arguments.length,_n=Wt>1?arguments[1]:void 0,_i=_n!==void 0;_i&&(_n=Fle(_n,Wt>2?arguments[2]:void 0));var _s,_c,_u,_h,_p,Qm,_g=Kle(_e),eE=0;if(!_g||this===GW&&Hle(_g))for(_s=qle(_e),_c=_t?new this(_s):GW(_s);_s>eE;eE++)Qm=_i?_n(_e[eE],eE):_e[eE],BW(_c,eE,Qm);else for(_p=(_h=zle(_e,_g)).next,_c=_t?new this:[];!(_u=Vle(_p,_h)).done;eE++)Qm=_i?Gle(_h,_n,[_u.value,eE],!0):_u.value,BW(_c,eE,Qm);return _c.length=eE,_c},kR=vF,iue=sF.codeAt,oue=function($){var _e,_t,Wt=[],_n=Xle(Jle(Zle($),HW,"."),".");for(_e=0;_e<_n.length;_e++)_t=_n[_e],Q1(Wt,Yle($le,_t)?"xn--"+eue(_t):_t);return KW(Wt,".")},S1=MT,sue=U1,aue=DD,JW=hae,XW=SI,cue=XW.set,VL=XW.getterFor("URL"),lue=JW.URLSearchParams,uue=JW.getState,lP=n6.URL,o6=n6.TypeError,BL=n6.parseInt,due=Math.floor,ZW=Math.pow,lR=aR("".charAt),DR=aR(/./.exec),uP=aR([].join),hue=aR(1 .toString),pue=aR([].pop),GO=aR([].push),s6=aR("".replace),fue=aR([].shift),mue=aR("".split),dP=aR("".slice),GL=aR("".toLowerCase),gue=aR([].unshift),a6="Invalid scheme",jI="Invalid host",QW="Invalid port",_q=/[a-z]/i,Eue=/[\d+-.a-z]/i,c6=/\d/,vue=/^0x/i,_ue=/^[0-7]+$/,yue=/^\d+$/,_z=/^[\da-f]+$/i,bue=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Sue=/[\0\t\n\r #/:<>?@[\\\]^|]/,Tue=/^[\u0000-\u0020]+/,wue=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Rue=/[\t\n\r]/g,hP=function($){var _e,_t,Wt,_n;if(typeof $=="number"){for(_e=[],_t=0;_t<4;_t++)gue(_e,$%256),$=due($/256);return uP(_e,".")}if(typeof $=="object"){for(_e="",Wt=function(_i){for(var _s=null,_c=1,_u=null,_h=0,_p=0;_p<8;_p++)_i[_p]!==0?(_h>_c&&(_s=_u,_c=_h),_u=null,_h=0):(_u===null&&(_u=_p),++_h);return _h>_c&&(_s=_u,_c=_h),_s}($),_t=0;_t<8;_t++)_n&&$[_t]===0||(_n&&(_n=!1),Wt===_t?(_e+=_t?":":"::",_n=!0):(_e+=hue($[_t],16),_t<7&&(_e+=":")));return"["+_e+"]"}return $},HL={},e7=i6({},HL,{" ":1,'"':1,"<":1,">":1,"`":1}),t7=i6({},e7,{"#":1,"?":1,"{":1,"}":1}),l6=i6({},t7,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),eI=function($,_e){var _t=iue($,0);return _t>32&&_t<127&&!r6(_e,$)?$:encodeURIComponent($)},WL={ftp:21,file:null,http:80,https:443,ws:80,wss:443},pP=function($,_e){var _t;return $.length==2&&DR(_q,lR($,0))&&((_t=lR($,1))==":"||!_e&&_t=="|")},n7=function($){var _e;return $.length>1&&pP(dP($,0,2))&&($.length==2||(_e=lR($,2))==="/"||_e==="\\"||_e==="?"||_e==="#")},Cue=function($){return $==="."||GL($)==="%2e"},u6={},r7={},d6={},i7={},o7={},h6={},s7={},a7={},qL={},zL={},p6={},f6={},m6={},g6={},c7={},E6={},HO={},_C={},l7={},FI={},T1={},v6=function($,_e,_t){var Wt,_n,_i,_s=S1($);if(_e){if(_n=this.parse(_s))throw o6(_n);this.searchParams=null}else{if(_t!==void 0&&(Wt=new v6(_t,!0)),_n=this.parse(_s,null,Wt))throw o6(_n);(_i=uue(new lue)).bindURL(this),this.searchParams=_i}};v6.prototype={type:"URL",parse:function($,_e,_t){var Wt,_n,_i,_s,_c,_u=this,_h=_e||u6,_p=0,Qm="",_g=!1,eE=!1,pE=!1;for($=S1($),_e||(_u.scheme="",_u.username="",_u.password="",_u.host=null,_u.port=null,_u.path=[],_u.query=null,_u.fragment=null,_u.cannotBeABaseURL=!1,$=s6($,Tue,""),$=s6($,wue,"$1")),$=s6($,Rue,""),Wt=BO($);_p<=Wt.length;){switch(_n=Wt[_p],_h){case u6:if(!_n||!DR(_q,_n)){if(_e)return a6;_h=d6;continue}Qm+=GL(_n),_h=r7;break;case r7:if(_n&&(DR(Eue,_n)||_n=="+"||_n=="-"||_n=="."))Qm+=GL(_n);else{if(_n!=":"){if(_e)return a6;Qm="",_h=d6,_p=0;continue}if(_e&&(_u.isSpecial()!=r6(WL,Qm)||Qm=="file"&&(_u.includesCredentials()||_u.port!==null)||_u.scheme=="file"&&!_u.host))return;if(_u.scheme=Qm,_e)return void(_u.isSpecial()&&WL[_u.scheme]==_u.port&&(_u.port=null));Qm="",_u.scheme=="file"?_h=g6:_u.isSpecial()&&_t&&_t.scheme==_u.scheme?_h=i7:_u.isSpecial()?_h=a7:Wt[_p+1]=="/"?(_h=o7,_p++):(_u.cannotBeABaseURL=!0,GO(_u.path,""),_h=l7)}break;case d6:if(!_t||_t.cannotBeABaseURL&&_n!="#")return a6;if(_t.cannotBeABaseURL&&_n=="#"){_u.scheme=_t.scheme,_u.path=kR(_t.path),_u.query=_t.query,_u.fragment="",_u.cannotBeABaseURL=!0,_h=T1;break}_h=_t.scheme=="file"?g6:h6;continue;case i7:if(_n!="/"||Wt[_p+1]!="/"){_h=h6;continue}_h=qL,_p++;break;case o7:if(_n=="/"){_h=zL;break}_h=_C;continue;case h6:if(_u.scheme=_t.scheme,_n==sR)_u.username=_t.username,_u.password=_t.password,_u.host=_t.host,_u.port=_t.port,_u.path=kR(_t.path),_u.query=_t.query;else if(_n=="/"||_n=="\\"&&_u.isSpecial())_h=s7;else if(_n=="?")_u.username=_t.username,_u.password=_t.password,_u.host=_t.host,_u.port=_t.port,_u.path=kR(_t.path),_u.query="",_h=FI;else{if(_n!="#"){_u.username=_t.username,_u.password=_t.password,_u.host=_t.host,_u.port=_t.port,_u.path=kR(_t.path),_u.path.length--,_h=_C;continue}_u.username=_t.username,_u.password=_t.password,_u.host=_t.host,_u.port=_t.port,_u.path=kR(_t.path),_u.query=_t.query,_u.fragment="",_h=T1}break;case s7:if(!_u.isSpecial()||_n!="/"&&_n!="\\"){if(_n!="/"){_u.username=_t.username,_u.password=_t.password,_u.host=_t.host,_u.port=_t.port,_h=_C;continue}_h=zL}else _h=qL;break;case a7:if(_h=qL,_n!="/"||lR(Qm,_p+1)!="/")continue;_p++;break;case qL:if(_n!="/"&&_n!="\\"){_h=zL;continue}break;case zL:if(_n=="@"){_g&&(Qm="%40"+Qm),_g=!0,_i=BO(Qm);for(var aE=0;aE<_i.length;aE++){var cE=_i[aE];if(cE!=":"||pE){var fE=eI(cE,l6);pE?_u.password+=fE:_u.username+=fE}else pE=!0}Qm=""}else if(_n==sR||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&_u.isSpecial()){if(_g&&Qm=="")return"Invalid authority";_p-=BO(Qm).length+1,Qm="",_h=p6}else Qm+=_n;break;case p6:case f6:if(_e&&_u.scheme=="file"){_h=E6;continue}if(_n!=":"||eE){if(_n==sR||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&_u.isSpecial()){if(_u.isSpecial()&&Qm=="")return jI;if(_e&&Qm==""&&(_u.includesCredentials()||_u.port!==null))return;if(_s=_u.parseHost(Qm))return _s;if(Qm="",_h=HO,_e)return;continue}_n=="["?eE=!0:_n=="]"&&(eE=!1),Qm+=_n}else{if(Qm=="")return jI;if(_s=_u.parseHost(Qm))return _s;if(Qm="",_h=m6,_e==f6)return}break;case m6:if(!DR(c6,_n)){if(_n==sR||_n=="/"||_n=="?"||_n=="#"||_n=="\\"&&_u.isSpecial()||_e){if(Qm!=""){var gE=BL(Qm,10);if(gE>65535)return QW;_u.port=_u.isSpecial()&&gE===WL[_u.scheme]?null:gE,Qm=""}if(_e)return;_h=HO;continue}return QW}Qm+=_n;break;case g6:if(_u.scheme="file",_n=="/"||_n=="\\")_h=c7;else{if(!_t||_t.scheme!="file"){_h=_C;continue}if(_n==sR)_u.host=_t.host,_u.path=kR(_t.path),_u.query=_t.query;else if(_n=="?")_u.host=_t.host,_u.path=kR(_t.path),_u.query="",_h=FI;else{if(_n!="#"){n7(uP(kR(Wt,_p),""))||(_u.host=_t.host,_u.path=kR(_t.path),_u.shortenPath()),_h=_C;continue}_u.host=_t.host,_u.path=kR(_t.path),_u.query=_t.query,_u.fragment="",_h=T1}}break;case c7:if(_n=="/"||_n=="\\"){_h=E6;break}_t&&_t.scheme=="file"&&!n7(uP(kR(Wt,_p),""))&&(pP(_t.path[0],!0)?GO(_u.path,_t.path[0]):_u.host=_t.host),_h=_C;continue;case E6:if(_n==sR||_n=="/"||_n=="\\"||_n=="?"||_n=="#"){if(!_e&&pP(Qm))_h=_C;else if(Qm==""){if(_u.host="",_e)return;_h=HO}else{if(_s=_u.parseHost(Qm))return _s;if(_u.host=="localhost"&&(_u.host=""),_e)return;Qm="",_h=HO}continue}Qm+=_n;break;case HO:if(_u.isSpecial()){if(_h=_C,_n!="/"&&_n!="\\")continue}else if(_e||_n!="?")if(_e||_n!="#"){if(_n!=sR&&(_h=_C,_n!="/"))continue}else _u.fragment="",_h=T1;else _u.query="",_h=FI;break;case _C:if(_n==sR||_n=="/"||_n=="\\"&&_u.isSpecial()||!_e&&(_n=="?"||_n=="#")){if((_c=GL(_c=Qm))===".."||_c==="%2e."||_c===".%2e"||_c==="%2e%2e"?(_u.shortenPath(),_n=="/"||_n=="\\"&&_u.isSpecial()||GO(_u.path,"")):Cue(Qm)?_n=="/"||_n=="\\"&&_u.isSpecial()||GO(_u.path,""):(_u.scheme=="file"&&!_u.path.length&&pP(Qm)&&(_u.host&&(_u.host=""),Qm=lR(Qm,0)+":"),GO(_u.path,Qm)),Qm="",_u.scheme=="file"&&(_n==sR||_n=="?"||_n=="#"))for(;_u.path.length>1&&_u.path[0]==="";)fue(_u.path);_n=="?"?(_u.query="",_h=FI):_n=="#"&&(_u.fragment="",_h=T1)}else Qm+=eI(_n,t7);break;case l7:_n=="?"?(_u.query="",_h=FI):_n=="#"?(_u.fragment="",_h=T1):_n!=sR&&(_u.path[0]+=eI(_n,HL));break;case FI:_e||_n!="#"?_n!=sR&&(_n=="'"&&_u.isSpecial()?_u.query+="%27":_u.query+=_n=="#"?"%23":eI(_n,HL)):(_u.fragment="",_h=T1);break;case T1:_n!=sR&&(_u.fragment+=eI(_n,e7))}_p++}},parseHost:function($){var _e,_t,Wt;if(lR($,0)=="["){if(lR($,$.length-1)!="]"||(_e=function(_n){var _i,_s,_c,_u,_h,_p,Qm,_g=[0,0,0,0,0,0,0,0],eE=0,pE=null,aE=0,cE=function(){return lR(_n,aE)};if(cE()==":"){if(lR(_n,1)!=":")return;aE+=2,pE=++eE}for(;cE();){if(eE==8)return;if(cE()!=":"){for(_i=_s=0;_s<4&&DR(_z,cE());)_i=16*_i+BL(cE(),16),aE++,_s++;if(cE()=="."){if(_s==0||(aE-=_s,eE>6))return;for(_c=0;cE();){if(_u=null,_c>0){if(!(cE()=="."&&_c<4))return;aE++}if(!DR(c6,cE()))return;for(;DR(c6,cE());){if(_h=BL(cE(),10),_u===null)_u=_h;else{if(_u==0)return;_u=10*_u+_h}if(_u>255)return;aE++}_g[eE]=256*_g[eE]+_u,++_c!=2&&_c!=4||eE++}if(_c!=4)return;break}if(cE()==":"){if(aE++,!cE())return}else if(cE())return;_g[eE++]=_i}else{if(pE!==null)return;aE++,pE=++eE}}if(pE!==null)for(_p=eE-pE,eE=7;eE!=0&&_p>0;)Qm=_g[eE],_g[eE--]=_g[pE+_p-1],_g[pE+--_p]=Qm;else if(eE!=8)return;return _g}(dP($,1,-1)),!_e))return jI;this.host=_e}else if(this.isSpecial()){if($=oue($),DR(bue,$)||(_e=function(_n){var _i,_s,_c,_u,_h,_p,Qm,_g=mue(_n,".");if(_g.length&&_g[_g.length-1]==""&&_g.length--,(_i=_g.length)>4)return _n;for(_s=[],_c=0;_c<_i;_c++){if((_u=_g[_c])=="")return _n;if(_h=10,_u.length>1&&lR(_u,0)=="0"&&(_h=DR(vue,_u)?16:8,_u=dP(_u,_h==8?1:2)),_u==="")_p=0;else{if(!DR(_h==10?yue:_h==8?_ue:_z,_u))return _n;_p=BL(_u,_h)}GO(_s,_p)}for(_c=0;_c<_i;_c++)if(_p=_s[_c],_c==_i-1){if(_p>=ZW(256,5-_i))return null}else if(_p>255)return null;for(Qm=pue(_s),_c=0;_c<_s.length;_c++)Qm+=_s[_c]*ZW(256,3-_c);return Qm}($),_e===null))return jI;this.host=_e}else{if(DR(Sue,$))return jI;for(_e="",_t=BO($),Wt=0;Wt<_t.length;Wt++)_e+=eI(_t[Wt],HL);this.host=_e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return r6(WL,this.scheme)},shortenPath:function(){var $=this.path,_e=$.length;!_e||this.scheme=="file"&&_e==1&&pP($[0],!0)||$.length--},serialize:function(){var $=this,_e=$.scheme,_t=$.username,Wt=$.password,_n=$.host,_i=$.port,_s=$.path,_c=$.query,_u=$.fragment,_h=_e+":";return _n!==null?(_h+="//",$.includesCredentials()&&(_h+=_t+(Wt?":"+Wt:"")+"@"),_h+=hP(_n),_i!==null&&(_h+=":"+_i)):_e=="file"&&(_h+="//"),_h+=$.cannotBeABaseURL?_s[0]:_s.length?"/"+uP(_s,"/"):"",_c!==null&&(_h+="?"+_c),_u!==null&&(_h+="#"+_u),_h},setHref:function($){var _e=this.parse($);if(_e)throw o6(_e);this.searchParams.update()},getOrigin:function(){var $=this.scheme,_e=this.port;if($=="blob")try{return new WO($.path[0]).origin}catch{return"null"}return $!="file"&&this.isSpecial()?$+"://"+hP(this.host)+(_e!==null?":"+_e:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function($){this.parse(S1($)+":",u6)},getUsername:function(){return this.username},setUsername:function($){var _e=BO(S1($));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var _t=0;_t<_e.length;_t++)this.username+=eI(_e[_t],l6)}},getPassword:function(){return this.password},setPassword:function($){var _e=BO(S1($));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var _t=0;_t<_e.length;_t++)this.password+=eI(_e[_t],l6)}},getHost:function(){var $=this.host,_e=this.port;return $===null?"":_e===null?hP($):hP($)+":"+_e},setHost:function($){this.cannotBeABaseURL||this.parse($,p6)},getHostname:function(){var $=this.host;return $===null?"":hP($)},setHostname:function($){this.cannotBeABaseURL||this.parse($,f6)},getPort:function(){var $=this.port;return $===null?"":S1($)},setPort:function($){this.cannotHaveUsernamePasswordPort()||(($=S1($))==""?this.port=null:this.parse($,m6))},getPathname:function(){var $=this.path;return this.cannotBeABaseURL?$[0]:$.length?"/"+uP($,"/"):""},setPathname:function($){this.cannotBeABaseURL||(this.path=[],this.parse($,HO))},getSearch:function(){var $=this.query;return $?"?"+$:""},setSearch:function($){($=S1($))==""?this.query=null:(lR($,0)=="?"&&($=dP($,1)),this.query="",this.parse($,FI)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var $=this.fragment;return $?"#"+$:""},setHash:function($){($=S1($))!=""?(lR($,0)=="#"&&($=dP($,1)),this.fragment="",this.parse($,T1)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var WO=function($){var _e=rue(this,gT),_t=aue(arguments.length,1)>1?arguments[1]:void 0,Wt=cue(_e,new v6($,!1,_t));t6||(_e.href=Wt.serialize(),_e.origin=Wt.getOrigin(),_e.protocol=Wt.getProtocol(),_e.username=Wt.getUsername(),_e.password=Wt.getPassword(),_e.host=Wt.getHost(),_e.hostname=Wt.getHostname(),_e.port=Wt.getPort(),_e.pathname=Wt.getPathname(),_e.search=Wt.getSearch(),_e.searchParams=Wt.getSearchParams(),_e.hash=Wt.getHash())},gT=WO.prototype,uR=function($,_e){return{get:function(){return VL(this)[$]()},set:_e&&function(_t){return VL(this)[_e](_t)},configurable:!0,enumerable:!0}};if(t6&&(cR(gT,"href",uR("serialize","setHref")),cR(gT,"origin",uR("getOrigin")),cR(gT,"protocol",uR("getProtocol","setProtocol")),cR(gT,"username",uR("getUsername","setUsername")),cR(gT,"password",uR("getPassword","setPassword")),cR(gT,"host",uR("getHost","setHost")),cR(gT,"hostname",uR("getHostname","setHostname")),cR(gT,"port",uR("getPort","setPort")),cR(gT,"pathname",uR("getPathname","setPathname")),cR(gT,"search",uR("getSearch","setSearch")),cR(gT,"searchParams",uR("getSearchParams")),cR(gT,"hash",uR("getHash","setHash"))),FL(gT,"toJSON",function(){return VL(this).serialize()},{enumerable:!0}),FL(gT,"toString",function(){return VL(this).serialize()},{enumerable:!0}),lP){var u7=lP.createObjectURL,d7=lP.revokeObjectURL;u7&&FL(WO,"createObjectURL",YW(u7,lP)),d7&&FL(WO,"revokeObjectURL",YW(d7,lP))}sue(WO,"URL"),tue({global:!0,constructor:!0,forced:!nue,sham:!t6},{URL:WO});var Iue=y0,Aue=_r,Oue=DD,h7=MT,Nue=WF,p7=OS("URL");Iue({target:"URL",stat:!0,forced:!(Nue&&Aue(function(){p7.canParse()}))},{canParse:function($){var _e=Oue(arguments.length,1),_t=h7($),Wt=_e<2||arguments[1]===void 0?void 0:h7(arguments[1]);try{return!!new p7(_t,Wt)}catch{return!1}}});var f7=zt(yS.URL),Pue=_m,kue=WG,m7=RegExp.prototype,Due=function($){return $===m7||Pue(m7,$)?kue($):$.flags},GS=zt(Due);function qO($){let _e=$.length;for(;--_e>=0;)$[_e]=0}const _6=256,g7=286,fP=30,mP=15,y6=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),KL=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Lue=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),E7=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),w1=new Array(576);qO(w1);const gP=new Array(60);qO(gP);const EP=new Array(512);qO(EP);const vP=new Array(256);qO(vP);const b6=new Array(29);qO(b6);const $L=new Array(fP);function S6($,_e,_t,Wt,_n){this.static_tree=$,this.extra_bits=_e,this.extra_base=_t,this.elems=Wt,this.max_length=_n,this.has_stree=$&&$.length}let v7,_7,y7;function T6($,_e){this.dyn_tree=$,this.max_code=0,this.stat_desc=_e}qO($L);const b7=$=>$<256?EP[$]:EP[256+($>>>7)],_P=($,_e)=>{$.pending_buf[$.pending++]=255&_e,$.pending_buf[$.pending++]=_e>>>8&255},RT=($,_e,_t)=>{$.bi_valid>16-_t?($.bi_buf|=_e<<$.bi_valid&65535,_P($,$.bi_buf),$.bi_buf=_e>>16-$.bi_valid,$.bi_valid+=_t-16):($.bi_buf|=_e<<$.bi_valid&65535,$.bi_valid+=_t)},e1=($,_e,_t)=>{RT($,_t[2*_e],_t[2*_e+1])},S7=($,_e)=>{let _t=0;do _t|=1&$,$>>>=1,_t<<=1;while(--_e>0);return _t>>>1},T7=($,_e,_t)=>{const Wt=new Array(16);let _n,_i,_s=0;for(_n=1;_n<=mP;_n++)_s=_s+_t[_n-1]<<1,Wt[_n]=_s;for(_i=0;_i<=_e;_i++){let _c=$[2*_i+1];_c!==0&&($[2*_i]=S7(Wt[_c]++,_c))}},w7=$=>{let _e;for(_e=0;_e<g7;_e++)$.dyn_ltree[2*_e]=0;for(_e=0;_e<fP;_e++)$.dyn_dtree[2*_e]=0;for(_e=0;_e<19;_e++)$.bl_tree[2*_e]=0;$.dyn_ltree[512]=1,$.opt_len=$.static_len=0,$.sym_next=$.matches=0},R7=$=>{$.bi_valid>8?_P($,$.bi_buf):$.bi_valid>0&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0},C7=($,_e,_t,Wt)=>{const _n=2*_e,_i=2*_t;return $[_n]<$[_i]||$[_n]===$[_i]&&Wt[_e]<=Wt[_t]},w6=($,_e,_t)=>{const Wt=$.heap[_t];let _n=_t<<1;for(;_n<=$.heap_len&&(_n<$.heap_len&&C7(_e,$.heap[_n+1],$.heap[_n],$.depth)&&_n++,!C7(_e,Wt,$.heap[_n],$.depth));)$.heap[_t]=$.heap[_n],_t=_n,_n<<=1;$.heap[_t]=Wt},I7=($,_e,_t)=>{let Wt,_n,_i,_s,_c=0;if($.sym_next!==0)do Wt=255&$.pending_buf[$.sym_buf+_c++],Wt+=(255&$.pending_buf[$.sym_buf+_c++])<<8,_n=$.pending_buf[$.sym_buf+_c++],Wt===0?e1($,_n,_e):(_i=vP[_n],e1($,_i+_6+1,_e),_s=y6[_i],_s!==0&&(_n-=b6[_i],RT($,_n,_s)),Wt--,_i=b7(Wt),e1($,_i,_t),_s=KL[_i],_s!==0&&(Wt-=$L[_i],RT($,Wt,_s)));while(_c<$.sym_next);e1($,256,_e)},R6=($,_e)=>{const _t=_e.dyn_tree,Wt=_e.stat_desc.static_tree,_n=_e.stat_desc.has_stree,_i=_e.stat_desc.elems;let _s,_c,_u,_h=-1;for($.heap_len=0,$.heap_max=573,_s=0;_s<_i;_s++)_t[2*_s]!==0?($.heap[++$.heap_len]=_h=_s,$.depth[_s]=0):_t[2*_s+1]=0;for(;$.heap_len<2;)_u=$.heap[++$.heap_len]=_h<2?++_h:0,_t[2*_u]=1,$.depth[_u]=0,$.opt_len--,_n&&($.static_len-=Wt[2*_u+1]);for(_e.max_code=_h,_s=$.heap_len>>1;_s>=1;_s--)w6($,_t,_s);_u=_i;do _s=$.heap[1],$.heap[1]=$.heap[$.heap_len--],w6($,_t,1),_c=$.heap[1],$.heap[--$.heap_max]=_s,$.heap[--$.heap_max]=_c,_t[2*_u]=_t[2*_s]+_t[2*_c],$.depth[_u]=($.depth[_s]>=$.depth[_c]?$.depth[_s]:$.depth[_c])+1,_t[2*_s+1]=_t[2*_c+1]=_u,$.heap[1]=_u++,w6($,_t,1);while($.heap_len>=2);$.heap[--$.heap_max]=$.heap[1],((_p,Qm)=>{const _g=Qm.dyn_tree,eE=Qm.max_code,pE=Qm.stat_desc.static_tree,aE=Qm.stat_desc.has_stree,cE=Qm.stat_desc.extra_bits,fE=Qm.stat_desc.extra_base,gE=Qm.stat_desc.max_length;let AE,PE,xE,GE,zE,KE,JE=0;for(GE=0;GE<=mP;GE++)_p.bl_count[GE]=0;for(_g[2*_p.heap[_p.heap_max]+1]=0,AE=_p.heap_max+1;AE<573;AE++)PE=_p.heap[AE],GE=_g[2*_g[2*PE+1]+1]+1,GE>gE&&(GE=gE,JE++),_g[2*PE+1]=GE,PE>eE||(_p.bl_count[GE]++,zE=0,PE>=fE&&(zE=cE[PE-fE]),KE=_g[2*PE],_p.opt_len+=KE*(GE+zE),aE&&(_p.static_len+=KE*(pE[2*PE+1]+zE)));if(JE!==0){do{for(GE=gE-1;_p.bl_count[GE]===0;)GE--;_p.bl_count[GE]--,_p.bl_count[GE+1]+=2,_p.bl_count[gE]--,JE-=2}while(JE>0);for(GE=gE;GE!==0;GE--)for(PE=_p.bl_count[GE];PE!==0;)xE=_p.heap[--AE],xE>eE||(_g[2*xE+1]!==GE&&(_p.opt_len+=(GE-_g[2*xE+1])*_g[2*xE],_g[2*xE+1]=GE),PE--)}})($,_e),T7(_t,_h,$.bl_count)},A7=($,_e,_t)=>{let Wt,_n,_i=-1,_s=_e[1],_c=0,_u=7,_h=4;for(_s===0&&(_u=138,_h=3),_e[2*(_t+1)+1]=65535,Wt=0;Wt<=_t;Wt++)_n=_s,_s=_e[2*(Wt+1)+1],++_c<_u&&_n===_s||(_c<_h?$.bl_tree[2*_n]+=_c:_n!==0?(_n!==_i&&$.bl_tree[2*_n]++,$.bl_tree[32]++):_c<=10?$.bl_tree[34]++:$.bl_tree[36]++,_c=0,_i=_n,_s===0?(_u=138,_h=3):_n===_s?(_u=6,_h=3):(_u=7,_h=4))},O7=($,_e,_t)=>{let Wt,_n,_i=-1,_s=_e[1],_c=0,_u=7,_h=4;for(_s===0&&(_u=138,_h=3),Wt=0;Wt<=_t;Wt++)if(_n=_s,_s=_e[2*(Wt+1)+1],!(++_c<_u&&_n===_s)){if(_c<_h)do e1($,_n,$.bl_tree);while(--_c!=0);else _n!==0?(_n!==_i&&(e1($,_n,$.bl_tree),_c--),e1($,16,$.bl_tree),RT($,_c-3,2)):_c<=10?(e1($,17,$.bl_tree),RT($,_c-3,3)):(e1($,18,$.bl_tree),RT($,_c-11,7));_c=0,_i=_n,_s===0?(_u=138,_h=3):_n===_s?(_u=6,_h=3):(_u=7,_h=4)}};let N7=!1;const P7=($,_e,_t,Wt)=>{RT($,0+(Wt?1:0),3),R7($),_P($,_t),_P($,~_t),_t&&$.pending_buf.set($.window.subarray(_e,_e+_t),$.pending),$.pending+=_t};var xue=$=>{N7||((()=>{let _e,_t,Wt,_n,_i;const _s=new Array(16);for(Wt=0,_n=0;_n<28;_n++)for(b6[_n]=Wt,_e=0;_e<1<<y6[_n];_e++)vP[Wt++]=_n;for(vP[Wt-1]=_n,_i=0,_n=0;_n<16;_n++)for($L[_n]=_i,_e=0;_e<1<<KL[_n];_e++)EP[_i++]=_n;for(_i>>=7;_n<fP;_n++)for($L[_n]=_i<<7,_e=0;_e<1<<KL[_n]-7;_e++)EP[256+_i++]=_n;for(_t=0;_t<=mP;_t++)_s[_t]=0;for(_e=0;_e<=143;)w1[2*_e+1]=8,_e++,_s[8]++;for(;_e<=255;)w1[2*_e+1]=9,_e++,_s[9]++;for(;_e<=279;)w1[2*_e+1]=7,_e++,_s[7]++;for(;_e<=287;)w1[2*_e+1]=8,_e++,_s[8]++;for(T7(w1,287,_s),_e=0;_e<fP;_e++)gP[2*_e+1]=5,gP[2*_e]=S7(_e,5);v7=new S6(w1,y6,257,g7,mP),_7=new S6(gP,KL,0,fP,mP),y7=new S6(new Array(0),Lue,0,19,7)})(),N7=!0),$.l_desc=new T6($.dyn_ltree,v7),$.d_desc=new T6($.dyn_dtree,_7),$.bl_desc=new T6($.bl_tree,y7),$.bi_buf=0,$.bi_valid=0,w7($)},Mue=($,_e,_t,Wt)=>{let _n,_i,_s=0;$.level>0?($.strm.data_type===2&&($.strm.data_type=(_c=>{let _u,_h=4093624447;for(_u=0;_u<=31;_u++,_h>>>=1)if(1&_h&&_c.dyn_ltree[2*_u]!==0)return 0;if(_c.dyn_ltree[18]!==0||_c.dyn_ltree[20]!==0||_c.dyn_ltree[26]!==0)return 1;for(_u=32;_u<_6;_u++)if(_c.dyn_ltree[2*_u]!==0)return 1;return 0})($)),R6($,$.l_desc),R6($,$.d_desc),_s=(_c=>{let _u;for(A7(_c,_c.dyn_ltree,_c.l_desc.max_code),A7(_c,_c.dyn_dtree,_c.d_desc.max_code),R6(_c,_c.bl_desc),_u=18;_u>=3&&_c.bl_tree[2*E7[_u]+1]===0;_u--);return _c.opt_len+=3*(_u+1)+5+5+4,_u})($),_n=$.opt_len+3+7>>>3,_i=$.static_len+3+7>>>3,_i<=_n&&(_n=_i)):_n=_i=_t+5,_t+4<=_n&&_e!==-1?P7($,_e,_t,Wt):$.strategy===4||_i===_n?(RT($,2+(Wt?1:0),3),I7($,w1,gP)):(RT($,4+(Wt?1:0),3),((_c,_u,_h,_p)=>{let Qm;for(RT(_c,_u-257,5),RT(_c,_h-1,5),RT(_c,_p-4,4),Qm=0;Qm<_p;Qm++)RT(_c,_c.bl_tree[2*E7[Qm]+1],3);O7(_c,_c.dyn_ltree,_u-1),O7(_c,_c.dyn_dtree,_h-1)})($,$.l_desc.max_code+1,$.d_desc.max_code+1,_s+1),I7($,$.dyn_ltree,$.dyn_dtree)),w7($),Wt&&R7($)},Uue=($,_e,_t)=>($.pending_buf[$.sym_buf+$.sym_next++]=_e,$.pending_buf[$.sym_buf+$.sym_next++]=_e>>8,$.pending_buf[$.sym_buf+$.sym_next++]=_t,_e===0?$.dyn_ltree[2*_t]++:($.matches++,_e--,$.dyn_ltree[2*(vP[_t]+_6+1)]++,$.dyn_dtree[2*b7(_e)]++),$.sym_next===$.sym_end),jue=$=>{RT($,2,3),e1($,256,w1),(_e=>{_e.bi_valid===16?(_P(_e,_e.bi_buf),_e.bi_buf=0,_e.bi_valid=0):_e.bi_valid>=8&&(_e.pending_buf[_e.pending++]=255&_e.bi_buf,_e.bi_buf>>=8,_e.bi_valid-=8)})($)},Fue={_tr_init:xue,_tr_stored_block:P7,_tr_flush_block:Mue,_tr_tally:Uue,_tr_align:jue},yP=($,_e,_t,Wt)=>{let _n=65535&$|0,_i=$>>>16&65535|0,_s=0;for(;_t!==0;){_s=_t>2e3?2e3:_t,_t-=_s;do _n=_n+_e[Wt++]|0,_i=_i+_n|0;while(--_s);_n%=65521,_i%=65521}return _n|_i<<16|0};const Vue=new Uint32Array((()=>{let $,_e=[];for(var _t=0;_t<256;_t++){$=_t;for(var Wt=0;Wt<8;Wt++)$=1&$?3988292384^$>>>1:$>>>1;_e[_t]=$}return _e})());var XS=($,_e,_t,Wt)=>{const _n=Vue,_i=Wt+_t;$^=-1;for(let _s=Wt;_s<_i;_s++)$=$>>>8^_n[255&($^_e[_s])];return-1^$},VI={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},zO={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Bue,_tr_stored_block:C6,_tr_flush_block:Gue,_tr_tally:tI,_tr_align:Hue}=Fue,{Z_NO_FLUSH:nI,Z_PARTIAL_FLUSH:Wue,Z_FULL_FLUSH:que,Z_FINISH:dR,Z_BLOCK:k7,Z_OK:nT,Z_STREAM_END:D7,Z_STREAM_ERROR:t1,Z_DATA_ERROR:zue,Z_BUF_ERROR:I6,Z_DEFAULT_COMPRESSION:Kue,Z_FILTERED:$ue,Z_HUFFMAN_ONLY:YL,Z_RLE:Yue,Z_FIXED:Jue,Z_DEFAULT_STRATEGY:Xue,Z_UNKNOWN:Zue,Z_DEFLATED:JL}=zO,A6=286,Que=30,ede=19,tde=2*A6+1,nde=15,BI=258,n1=262,KO=42,GI=113,bP=666,HI=($,_e)=>($.msg=VI[_e],_e),L7=$=>2*$-($>4?9:0),rI=$=>{let _e=$.length;for(;--_e>=0;)$[_e]=0},rde=$=>{let _e,_t,Wt,_n=$.w_size;_e=$.hash_size,Wt=_e;do _t=$.head[--Wt],$.head[Wt]=_t>=_n?_t-_n:0;while(--_e);_e=_n,Wt=_e;do _t=$.prev[--Wt],$.prev[Wt]=_t>=_n?_t-_n:0;while(--_e)};let iI=($,_e,_t)=>(_e<<$.hash_shift^_t)&$.hash_mask;const BT=$=>{const _e=$.state;let _t=_e.pending;_t>$.avail_out&&(_t=$.avail_out),_t!==0&&($.output.set(_e.pending_buf.subarray(_e.pending_out,_e.pending_out+_t),$.next_out),$.next_out+=_t,_e.pending_out+=_t,$.total_out+=_t,$.avail_out-=_t,_e.pending-=_t,_e.pending===0&&(_e.pending_out=0))},GT=($,_e)=>{Gue($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,_e),$.block_start=$.strstart,BT($.strm)},B0=($,_e)=>{$.pending_buf[$.pending++]=_e},SP=($,_e)=>{$.pending_buf[$.pending++]=_e>>>8&255,$.pending_buf[$.pending++]=255&_e},O6=($,_e,_t,Wt)=>{let _n=$.avail_in;return _n>Wt&&(_n=Wt),_n===0?0:($.avail_in-=_n,_e.set($.input.subarray($.next_in,$.next_in+_n),_t),$.state.wrap===1?$.adler=yP($.adler,_e,_n,_t):$.state.wrap===2&&($.adler=XS($.adler,_e,_n,_t)),$.next_in+=_n,$.total_in+=_n,_n)},x7=($,_e)=>{let _t,Wt,_n=$.max_chain_length,_i=$.strstart,_s=$.prev_length,_c=$.nice_match;const _u=$.strstart>$.w_size-n1?$.strstart-($.w_size-n1):0,_h=$.window,_p=$.w_mask,Qm=$.prev,_g=$.strstart+BI;let eE=_h[_i+_s-1],pE=_h[_i+_s];$.prev_length>=$.good_match&&(_n>>=2),_c>$.lookahead&&(_c=$.lookahead);do if(_t=_e,_h[_t+_s]===pE&&_h[_t+_s-1]===eE&&_h[_t]===_h[_i]&&_h[++_t]===_h[_i+1]){_i+=2,_t++;do;while(_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_h[++_i]===_h[++_t]&&_i<_g);if(Wt=BI-(_g-_i),_i=_g-BI,Wt>_s){if($.match_start=_e,_s=Wt,Wt>=_c)break;eE=_h[_i+_s-1],pE=_h[_i+_s]}}while((_e=Qm[_e&_p])>_u&&--_n!=0);return _s<=$.lookahead?_s:$.lookahead},$O=$=>{const _e=$.w_size;let _t,Wt,_n;do{if(Wt=$.window_size-$.lookahead-$.strstart,$.strstart>=_e+(_e-n1)&&($.window.set($.window.subarray(_e,_e+_e-Wt),0),$.match_start-=_e,$.strstart-=_e,$.block_start-=_e,$.insert>$.strstart&&($.insert=$.strstart),rde($),Wt+=_e),$.strm.avail_in===0)break;if(_t=O6($.strm,$.window,$.strstart+$.lookahead,Wt),$.lookahead+=_t,$.lookahead+$.insert>=3)for(_n=$.strstart-$.insert,$.ins_h=$.window[_n],$.ins_h=iI($,$.ins_h,$.window[_n+1]);$.insert&&($.ins_h=iI($,$.ins_h,$.window[_n+3-1]),$.prev[_n&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=_n,_n++,$.insert--,!($.lookahead+$.insert<3)););}while($.lookahead<n1&&$.strm.avail_in!==0)},M7=($,_e)=>{let _t,Wt,_n,_i=$.pending_buf_size-5>$.w_size?$.w_size:$.pending_buf_size-5,_s=0,_c=$.strm.avail_in;do{if(_t=65535,_n=$.bi_valid+42>>3,$.strm.avail_out<_n||(_n=$.strm.avail_out-_n,Wt=$.strstart-$.block_start,_t>Wt+$.strm.avail_in&&(_t=Wt+$.strm.avail_in),_t>_n&&(_t=_n),_t<_i&&(_t===0&&_e!==dR||_e===nI||_t!==Wt+$.strm.avail_in)))break;_s=_e===dR&&_t===Wt+$.strm.avail_in?1:0,C6($,0,0,_s),$.pending_buf[$.pending-4]=_t,$.pending_buf[$.pending-3]=_t>>8,$.pending_buf[$.pending-2]=~_t,$.pending_buf[$.pending-1]=~_t>>8,BT($.strm),Wt&&(Wt>_t&&(Wt=_t),$.strm.output.set($.window.subarray($.block_start,$.block_start+Wt),$.strm.next_out),$.strm.next_out+=Wt,$.strm.avail_out-=Wt,$.strm.total_out+=Wt,$.block_start+=Wt,_t-=Wt),_t&&(O6($.strm,$.strm.output,$.strm.next_out,_t),$.strm.next_out+=_t,$.strm.avail_out-=_t,$.strm.total_out+=_t)}while(_s===0);return _c-=$.strm.avail_in,_c&&(_c>=$.w_size?($.matches=2,$.window.set($.strm.input.subarray($.strm.next_in-$.w_size,$.strm.next_in),0),$.strstart=$.w_size,$.insert=$.strstart):($.window_size-$.strstart<=_c&&($.strstart-=$.w_size,$.window.set($.window.subarray($.w_size,$.w_size+$.strstart),0),$.matches<2&&$.matches++,$.insert>$.strstart&&($.insert=$.strstart)),$.window.set($.strm.input.subarray($.strm.next_in-_c,$.strm.next_in),$.strstart),$.strstart+=_c,$.insert+=_c>$.w_size-$.insert?$.w_size-$.insert:_c),$.block_start=$.strstart),$.high_water<$.strstart&&($.high_water=$.strstart),_s?4:_e!==nI&&_e!==dR&&$.strm.avail_in===0&&$.strstart===$.block_start?2:(_n=$.window_size-$.strstart,$.strm.avail_in>_n&&$.block_start>=$.w_size&&($.block_start-=$.w_size,$.strstart-=$.w_size,$.window.set($.window.subarray($.w_size,$.w_size+$.strstart),0),$.matches<2&&$.matches++,_n+=$.w_size,$.insert>$.strstart&&($.insert=$.strstart)),_n>$.strm.avail_in&&(_n=$.strm.avail_in),_n&&(O6($.strm,$.window,$.strstart,_n),$.strstart+=_n,$.insert+=_n>$.w_size-$.insert?$.w_size-$.insert:_n),$.high_water<$.strstart&&($.high_water=$.strstart),_n=$.bi_valid+42>>3,_n=$.pending_buf_size-_n>65535?65535:$.pending_buf_size-_n,_i=_n>$.w_size?$.w_size:_n,Wt=$.strstart-$.block_start,(Wt>=_i||(Wt||_e===dR)&&_e!==nI&&$.strm.avail_in===0&&Wt<=_n)&&(_t=Wt>_n?_n:Wt,_s=_e===dR&&$.strm.avail_in===0&&_t===Wt?1:0,C6($,$.block_start,_t,_s),$.block_start+=_t,BT($.strm)),_s?3:1)},N6=($,_e)=>{let _t,Wt;for(;;){if($.lookahead<n1){if($O($),$.lookahead<n1&&_e===nI)return 1;if($.lookahead===0)break}if(_t=0,$.lookahead>=3&&($.ins_h=iI($,$.ins_h,$.window[$.strstart+3-1]),_t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),_t!==0&&$.strstart-_t<=$.w_size-n1&&($.match_length=x7($,_t)),$.match_length>=3)if(Wt=tI($,$.strstart-$.match_start,$.match_length-3),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=3){$.match_length--;do $.strstart++,$.ins_h=iI($,$.ins_h,$.window[$.strstart+3-1]),_t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!=0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=iI($,$.ins_h,$.window[$.strstart+1]);else Wt=tI($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(Wt&&(GT($,!1),$.strm.avail_out===0))return 1}return $.insert=$.strstart<2?$.strstart:2,_e===dR?(GT($,!0),$.strm.avail_out===0?3:4):$.sym_next&&(GT($,!1),$.strm.avail_out===0)?1:2},YO=($,_e)=>{let _t,Wt,_n;for(;;){if($.lookahead<n1){if($O($),$.lookahead<n1&&_e===nI)return 1;if($.lookahead===0)break}if(_t=0,$.lookahead>=3&&($.ins_h=iI($,$.ins_h,$.window[$.strstart+3-1]),_t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=2,_t!==0&&$.prev_length<$.max_lazy_match&&$.strstart-_t<=$.w_size-n1&&($.match_length=x7($,_t),$.match_length<=5&&($.strategy===$ue||$.match_length===3&&$.strstart-$.match_start>4096)&&($.match_length=2)),$.prev_length>=3&&$.match_length<=$.prev_length){_n=$.strstart+$.lookahead-3,Wt=tI($,$.strstart-1-$.prev_match,$.prev_length-3),$.lookahead-=$.prev_length-1,$.prev_length-=2;do++$.strstart<=_n&&($.ins_h=iI($,$.ins_h,$.window[$.strstart+3-1]),_t=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart);while(--$.prev_length!=0);if($.match_available=0,$.match_length=2,$.strstart++,Wt&&(GT($,!1),$.strm.avail_out===0))return 1}else if($.match_available){if(Wt=tI($,0,$.window[$.strstart-1]),Wt&&GT($,!1),$.strstart++,$.lookahead--,$.strm.avail_out===0)return 1}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(Wt=tI($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<2?$.strstart:2,_e===dR?(GT($,!0),$.strm.avail_out===0?3:4):$.sym_next&&(GT($,!1),$.strm.avail_out===0)?1:2};function r1($,_e,_t,Wt,_n){this.good_length=$,this.max_lazy=_e,this.nice_length=_t,this.max_chain=Wt,this.func=_n}const TP=[new r1(0,0,0,0,M7),new r1(4,4,8,4,N6),new r1(4,5,16,8,N6),new r1(4,6,32,32,N6),new r1(4,4,16,16,YO),new r1(8,16,32,32,YO),new r1(8,16,128,128,YO),new r1(8,32,128,256,YO),new r1(32,128,258,1024,YO),new r1(32,258,258,4096,YO)];function ide(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=JL,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*tde),this.dyn_dtree=new Uint16Array(2*(2*Que+1)),this.bl_tree=new Uint16Array(2*(2*ede+1)),rI(this.dyn_ltree),rI(this.dyn_dtree),rI(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(nde+1),this.heap=new Uint16Array(2*A6+1),rI(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*A6+1),rI(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const wP=$=>{if(!$)return 1;const _e=$.state;return!_e||_e.strm!==$||_e.status!==KO&&_e.status!==57&&_e.status!==69&&_e.status!==73&&_e.status!==91&&_e.status!==103&&_e.status!==GI&&_e.status!==bP?1:0},U7=$=>{if(wP($))return HI($,t1);$.total_in=$.total_out=0,$.data_type=Zue;const _e=$.state;return _e.pending=0,_e.pending_out=0,_e.wrap<0&&(_e.wrap=-_e.wrap),_e.status=_e.wrap===2?57:_e.wrap?KO:GI,$.adler=_e.wrap===2?0:1,_e.last_flush=-2,Bue(_e),nT},j7=$=>{const _e=U7($);return _e===nT&&(_t=>{_t.window_size=2*_t.w_size,rI(_t.head),_t.max_lazy_match=TP[_t.level].max_lazy,_t.good_match=TP[_t.level].good_length,_t.nice_match=TP[_t.level].nice_length,_t.max_chain_length=TP[_t.level].max_chain,_t.strstart=0,_t.block_start=0,_t.lookahead=0,_t.insert=0,_t.match_length=_t.prev_length=2,_t.match_available=0,_t.ins_h=0})($.state),_e},F7=($,_e,_t,Wt,_n,_i)=>{if(!$)return t1;let _s=1;if(_e===Kue&&(_e=6),Wt<0?(_s=0,Wt=-Wt):Wt>15&&(_s=2,Wt-=16),_n<1||_n>9||_t!==JL||Wt<8||Wt>15||_e<0||_e>9||_i<0||_i>Jue||Wt===8&&_s!==1)return HI($,t1);Wt===8&&(Wt=9);const _c=new ide;return $.state=_c,_c.strm=$,_c.status=KO,_c.wrap=_s,_c.gzhead=null,_c.w_bits=Wt,_c.w_size=1<<_c.w_bits,_c.w_mask=_c.w_size-1,_c.hash_bits=_n+7,_c.hash_size=1<<_c.hash_bits,_c.hash_mask=_c.hash_size-1,_c.hash_shift=~~((_c.hash_bits+3-1)/3),_c.window=new Uint8Array(2*_c.w_size),_c.head=new Uint16Array(_c.hash_size),_c.prev=new Uint16Array(_c.w_size),_c.lit_bufsize=1<<_n+6,_c.pending_buf_size=4*_c.lit_bufsize,_c.pending_buf=new Uint8Array(_c.pending_buf_size),_c.sym_buf=_c.lit_bufsize,_c.sym_end=3*(_c.lit_bufsize-1),_c.level=_e,_c.strategy=_i,_c.method=_t,j7($)};var ode=($,_e)=>{if(wP($)||_e>k7||_e<0)return $?HI($,t1):t1;const _t=$.state;if(!$.output||$.avail_in!==0&&!$.input||_t.status===bP&&_e!==dR)return HI($,$.avail_out===0?I6:t1);const Wt=_t.last_flush;if(_t.last_flush=_e,_t.pending!==0){if(BT($),$.avail_out===0)return _t.last_flush=-1,nT}else if($.avail_in===0&&L7(_e)<=L7(Wt)&&_e!==dR)return HI($,I6);if(_t.status===bP&&$.avail_in!==0)return HI($,I6);if(_t.status===KO&&_t.wrap===0&&(_t.status=GI),_t.status===KO){let _n=JL+(_t.w_bits-8<<4)<<8,_i=-1;if(_i=_t.strategy>=YL||_t.level<2?0:_t.level<6?1:_t.level===6?2:3,_n|=_i<<6,_t.strstart!==0&&(_n|=32),_n+=31-_n%31,SP(_t,_n),_t.strstart!==0&&(SP(_t,$.adler>>>16),SP(_t,65535&$.adler)),$.adler=1,_t.status=GI,BT($),_t.pending!==0)return _t.last_flush=-1,nT}if(_t.status===57){if($.adler=0,B0(_t,31),B0(_t,139),B0(_t,8),_t.gzhead)B0(_t,(_t.gzhead.text?1:0)+(_t.gzhead.hcrc?2:0)+(_t.gzhead.extra?4:0)+(_t.gzhead.name?8:0)+(_t.gzhead.comment?16:0)),B0(_t,255&_t.gzhead.time),B0(_t,_t.gzhead.time>>8&255),B0(_t,_t.gzhead.time>>16&255),B0(_t,_t.gzhead.time>>24&255),B0(_t,_t.level===9?2:_t.strategy>=YL||_t.level<2?4:0),B0(_t,255&_t.gzhead.os),_t.gzhead.extra&&_t.gzhead.extra.length&&(B0(_t,255&_t.gzhead.extra.length),B0(_t,_t.gzhead.extra.length>>8&255)),_t.gzhead.hcrc&&($.adler=XS($.adler,_t.pending_buf,_t.pending,0)),_t.gzindex=0,_t.status=69;else if(B0(_t,0),B0(_t,0),B0(_t,0),B0(_t,0),B0(_t,0),B0(_t,_t.level===9?2:_t.strategy>=YL||_t.level<2?4:0),B0(_t,3),_t.status=GI,BT($),_t.pending!==0)return _t.last_flush=-1,nT}if(_t.status===69){if(_t.gzhead.extra){let _n=_t.pending,_i=(65535&_t.gzhead.extra.length)-_t.gzindex;for(;_t.pending+_i>_t.pending_buf_size;){let _c=_t.pending_buf_size-_t.pending;if(_t.pending_buf.set(_t.gzhead.extra.subarray(_t.gzindex,_t.gzindex+_c),_t.pending),_t.pending=_t.pending_buf_size,_t.gzhead.hcrc&&_t.pending>_n&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_n,_n)),_t.gzindex+=_c,BT($),_t.pending!==0)return _t.last_flush=-1,nT;_n=0,_i-=_c}let _s=new Uint8Array(_t.gzhead.extra);_t.pending_buf.set(_s.subarray(_t.gzindex,_t.gzindex+_i),_t.pending),_t.pending+=_i,_t.gzhead.hcrc&&_t.pending>_n&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_n,_n)),_t.gzindex=0}_t.status=73}if(_t.status===73){if(_t.gzhead.name){let _n,_i=_t.pending;do{if(_t.pending===_t.pending_buf_size){if(_t.gzhead.hcrc&&_t.pending>_i&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_i,_i)),BT($),_t.pending!==0)return _t.last_flush=-1,nT;_i=0}_n=_t.gzindex<_t.gzhead.name.length?255&_t.gzhead.name.charCodeAt(_t.gzindex++):0,B0(_t,_n)}while(_n!==0);_t.gzhead.hcrc&&_t.pending>_i&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_i,_i)),_t.gzindex=0}_t.status=91}if(_t.status===91){if(_t.gzhead.comment){let _n,_i=_t.pending;do{if(_t.pending===_t.pending_buf_size){if(_t.gzhead.hcrc&&_t.pending>_i&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_i,_i)),BT($),_t.pending!==0)return _t.last_flush=-1,nT;_i=0}_n=_t.gzindex<_t.gzhead.comment.length?255&_t.gzhead.comment.charCodeAt(_t.gzindex++):0,B0(_t,_n)}while(_n!==0);_t.gzhead.hcrc&&_t.pending>_i&&($.adler=XS($.adler,_t.pending_buf,_t.pending-_i,_i))}_t.status=103}if(_t.status===103){if(_t.gzhead.hcrc){if(_t.pending+2>_t.pending_buf_size&&(BT($),_t.pending!==0))return _t.last_flush=-1,nT;B0(_t,255&$.adler),B0(_t,$.adler>>8&255),$.adler=0}if(_t.status=GI,BT($),_t.pending!==0)return _t.last_flush=-1,nT}if($.avail_in!==0||_t.lookahead!==0||_e!==nI&&_t.status!==bP){let _n=_t.level===0?M7(_t,_e):_t.strategy===YL?((_i,_s)=>{let _c;for(;;){if(_i.lookahead===0&&($O(_i),_i.lookahead===0)){if(_s===nI)return 1;break}if(_i.match_length=0,_c=tI(_i,0,_i.window[_i.strstart]),_i.lookahead--,_i.strstart++,_c&&(GT(_i,!1),_i.strm.avail_out===0))return 1}return _i.insert=0,_s===dR?(GT(_i,!0),_i.strm.avail_out===0?3:4):_i.sym_next&&(GT(_i,!1),_i.strm.avail_out===0)?1:2})(_t,_e):_t.strategy===Yue?((_i,_s)=>{let _c,_u,_h,_p;const Qm=_i.window;for(;;){if(_i.lookahead<=BI){if($O(_i),_i.lookahead<=BI&&_s===nI)return 1;if(_i.lookahead===0)break}if(_i.match_length=0,_i.lookahead>=3&&_i.strstart>0&&(_h=_i.strstart-1,_u=Qm[_h],_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h])){_p=_i.strstart+BI;do;while(_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_u===Qm[++_h]&&_h<_p);_i.match_length=BI-(_p-_h),_i.match_length>_i.lookahead&&(_i.match_length=_i.lookahead)}if(_i.match_length>=3?(_c=tI(_i,1,_i.match_length-3),_i.lookahead-=_i.match_length,_i.strstart+=_i.match_length,_i.match_length=0):(_c=tI(_i,0,_i.window[_i.strstart]),_i.lookahead--,_i.strstart++),_c&&(GT(_i,!1),_i.strm.avail_out===0))return 1}return _i.insert=0,_s===dR?(GT(_i,!0),_i.strm.avail_out===0?3:4):_i.sym_next&&(GT(_i,!1),_i.strm.avail_out===0)?1:2})(_t,_e):TP[_t.level].func(_t,_e);if(_n!==3&&_n!==4||(_t.status=bP),_n===1||_n===3)return $.avail_out===0&&(_t.last_flush=-1),nT;if(_n===2&&(_e===Wue?Hue(_t):_e!==k7&&(C6(_t,0,0,!1),_e===que&&(rI(_t.head),_t.lookahead===0&&(_t.strstart=0,_t.block_start=0,_t.insert=0))),BT($),$.avail_out===0))return _t.last_flush=-1,nT}return _e!==dR?nT:_t.wrap<=0?D7:(_t.wrap===2?(B0(_t,255&$.adler),B0(_t,$.adler>>8&255),B0(_t,$.adler>>16&255),B0(_t,$.adler>>24&255),B0(_t,255&$.total_in),B0(_t,$.total_in>>8&255),B0(_t,$.total_in>>16&255),B0(_t,$.total_in>>24&255)):(SP(_t,$.adler>>>16),SP(_t,65535&$.adler)),BT($),_t.wrap>0&&(_t.wrap=-_t.wrap),_t.pending!==0?nT:D7)},sde=($,_e)=>{let _t=_e.length;if(wP($))return t1;const Wt=$.state,_n=Wt.wrap;if(_n===2||_n===1&&Wt.status!==KO||Wt.lookahead)return t1;if(_n===1&&($.adler=yP($.adler,_e,_t,0)),Wt.wrap=0,_t>=Wt.w_size){_n===0&&(rI(Wt.head),Wt.strstart=0,Wt.block_start=0,Wt.insert=0);let _u=new Uint8Array(Wt.w_size);_u.set(_e.subarray(_t-Wt.w_size,_t),0),_e=_u,_t=Wt.w_size}const _i=$.avail_in,_s=$.next_in,_c=$.input;for($.avail_in=_t,$.next_in=0,$.input=_e,$O(Wt);Wt.lookahead>=3;){let _u=Wt.strstart,_h=Wt.lookahead-2;do Wt.ins_h=iI(Wt,Wt.ins_h,Wt.window[_u+3-1]),Wt.prev[_u&Wt.w_mask]=Wt.head[Wt.ins_h],Wt.head[Wt.ins_h]=_u,_u++;while(--_h);Wt.strstart=_u,Wt.lookahead=2,$O(Wt)}return Wt.strstart+=Wt.lookahead,Wt.block_start=Wt.strstart,Wt.insert=Wt.lookahead,Wt.lookahead=0,Wt.match_length=Wt.prev_length=2,Wt.match_available=0,$.next_in=_s,$.input=_c,$.avail_in=_i,Wt.wrap=_n,nT},RP={deflateInit:($,_e)=>F7($,_e,JL,15,8,Xue),deflateInit2:F7,deflateReset:j7,deflateResetKeep:U7,deflateSetHeader:($,_e)=>wP($)||$.state.wrap!==2?t1:($.state.gzhead=_e,nT),deflate:ode,deflateEnd:$=>{if(wP($))return t1;const _e=$.state.status;return $.state=null,_e===GI?HI($,zue):nT},deflateSetDictionary:sde,deflateInfo:"pako deflate (from Nodeca project)"};const ade=($,_e)=>Object.prototype.hasOwnProperty.call($,_e);var XL={assign:function($){const _e=Array.prototype.slice.call(arguments,1);for(;_e.length;){const _t=_e.shift();if(_t){if(typeof _t!="object")throw new TypeError(_t+"must be non-object");for(const Wt in _t)ade(_t,Wt)&&($[Wt]=_t[Wt])}}return $},flattenChunks:$=>{let _e=0;for(let Wt=0,_n=$.length;Wt<_n;Wt++)_e+=$[Wt].length;const _t=new Uint8Array(_e);for(let Wt=0,_n=0,_i=$.length;Wt<_i;Wt++){let _s=$[Wt];_t.set(_s,_n),_n+=_s.length}return _t}};let V7=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{V7=!1}const CP=new Uint8Array(256);for(let $=0;$<256;$++)CP[$]=$>=252?6:$>=248?5:$>=240?4:$>=224?3:$>=192?2:1;CP[254]=CP[254]=1;var IP={string2buf:$=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode($);let _e,_t,Wt,_n,_i,_s=$.length,_c=0;for(_n=0;_n<_s;_n++)_t=$.charCodeAt(_n),(64512&_t)==55296&&_n+1<_s&&(Wt=$.charCodeAt(_n+1),(64512&Wt)==56320&&(_t=65536+(_t-55296<<10)+(Wt-56320),_n++)),_c+=_t<128?1:_t<2048?2:_t<65536?3:4;for(_e=new Uint8Array(_c),_i=0,_n=0;_i<_c;_n++)_t=$.charCodeAt(_n),(64512&_t)==55296&&_n+1<_s&&(Wt=$.charCodeAt(_n+1),(64512&Wt)==56320&&(_t=65536+(_t-55296<<10)+(Wt-56320),_n++)),_t<128?_e[_i++]=_t:_t<2048?(_e[_i++]=192|_t>>>6,_e[_i++]=128|63&_t):_t<65536?(_e[_i++]=224|_t>>>12,_e[_i++]=128|_t>>>6&63,_e[_i++]=128|63&_t):(_e[_i++]=240|_t>>>18,_e[_i++]=128|_t>>>12&63,_e[_i++]=128|_t>>>6&63,_e[_i++]=128|63&_t);return _e},buf2string:($,_e)=>{const _t=_e||$.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode($.subarray(0,_e));let Wt,_n;const _i=new Array(2*_t);for(_n=0,Wt=0;Wt<_t;){let _s=$[Wt++];if(_s<128){_i[_n++]=_s;continue}let _c=CP[_s];if(_c>4)_i[_n++]=65533,Wt+=_c-1;else{for(_s&=_c===2?31:_c===3?15:7;_c>1&&Wt<_t;)_s=_s<<6|63&$[Wt++],_c--;_c>1?_i[_n++]=65533:_s<65536?_i[_n++]=_s:(_s-=65536,_i[_n++]=55296|_s>>10&1023,_i[_n++]=56320|1023&_s)}}return((_s,_c)=>{if(_c<65534&&_s.subarray&&V7)return String.fromCharCode.apply(null,_s.length===_c?_s:_s.subarray(0,_c));let _u="";for(let _h=0;_h<_c;_h++)_u+=String.fromCharCode(_s[_h]);return _u})(_i,_n)},utf8border:($,_e)=>{(_e=_e||$.length)>$.length&&(_e=$.length);let _t=_e-1;for(;_t>=0&&(192&$[_t])==128;)_t--;return _t<0||_t===0?_e:_t+CP[$[_t]]>_e?_t:_e}},B7=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const G7=Object.prototype.toString,{Z_NO_FLUSH:cde,Z_SYNC_FLUSH:lde,Z_FULL_FLUSH:ude,Z_FINISH:dde,Z_OK:ZL,Z_STREAM_END:hde,Z_DEFAULT_COMPRESSION:pde,Z_DEFAULT_STRATEGY:fde,Z_DEFLATED:mde}=zO;function AP($){this.options=XL.assign({level:pde,method:mde,chunkSize:16384,windowBits:15,memLevel:8,strategy:fde},$||{});let _e=this.options;_e.raw&&_e.windowBits>0?_e.windowBits=-_e.windowBits:_e.gzip&&_e.windowBits>0&&_e.windowBits<16&&(_e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new B7,this.strm.avail_out=0;let _t=RP.deflateInit2(this.strm,_e.level,_e.method,_e.windowBits,_e.memLevel,_e.strategy);if(_t!==ZL)throw new Error(VI[_t]);if(_e.header&&RP.deflateSetHeader(this.strm,_e.header),_e.dictionary){let Wt;if(Wt=typeof _e.dictionary=="string"?IP.string2buf(_e.dictionary):G7.call(_e.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_e.dictionary):_e.dictionary,_t=RP.deflateSetDictionary(this.strm,Wt),_t!==ZL)throw new Error(VI[_t]);this._dict_set=!0}}function P6($,_e){const _t=new AP(_e);if(_t.push($,!0),_t.err)throw _t.msg||VI[_t.err];return _t.result}AP.prototype.push=function($,_e){const _t=this.strm,Wt=this.options.chunkSize;let _n,_i;if(this.ended)return!1;for(_i=_e===~~_e?_e:_e===!0?dde:cde,typeof $=="string"?_t.input=IP.string2buf($):G7.call($)==="[object ArrayBuffer]"?_t.input=new Uint8Array($):_t.input=$,_t.next_in=0,_t.avail_in=_t.input.length;;)if(_t.avail_out===0&&(_t.output=new Uint8Array(Wt),_t.next_out=0,_t.avail_out=Wt),(_i===lde||_i===ude)&&_t.avail_out<=6)this.onData(_t.output.subarray(0,_t.next_out)),_t.avail_out=0;else{if(_n=RP.deflate(_t,_i),_n===hde)return _t.next_out>0&&this.onData(_t.output.subarray(0,_t.next_out)),_n=RP.deflateEnd(this.strm),this.onEnd(_n),this.ended=!0,_n===ZL;if(_t.avail_out!==0){if(_i>0&&_t.next_out>0)this.onData(_t.output.subarray(0,_t.next_out)),_t.avail_out=0;else if(_t.avail_in===0)break}else this.onData(_t.output)}return!0},AP.prototype.onData=function($){this.chunks.push($)},AP.prototype.onEnd=function($){$===ZL&&(this.result=XL.flattenChunks(this.chunks)),this.chunks=[],this.err=$,this.msg=this.strm.msg};var gde={Deflate:AP,deflate:P6,deflateRaw:function($,_e){return(_e=_e||{}).raw=!0,P6($,_e)},gzip:function($,_e){return(_e=_e||{}).gzip=!0,P6($,_e)},constants:zO};const QL=16209;var Ede=function($,_e){let _t,Wt,_n,_i,_s,_c,_u,_h,_p,Qm,_g,eE,pE,aE,cE,fE,gE,AE,PE,xE,GE,zE,KE,JE;const c_=$.state;_t=$.next_in,KE=$.input,Wt=_t+($.avail_in-5),_n=$.next_out,JE=$.output,_i=_n-(_e-$.avail_out),_s=_n+($.avail_out-257),_c=c_.dmax,_u=c_.wsize,_h=c_.whave,_p=c_.wnext,Qm=c_.window,_g=c_.hold,eE=c_.bits,pE=c_.lencode,aE=c_.distcode,cE=(1<<c_.lenbits)-1,fE=(1<<c_.distbits)-1;e:do{eE<15&&(_g+=KE[_t++]<<eE,eE+=8,_g+=KE[_t++]<<eE,eE+=8),gE=pE[_g&cE];t:for(;;){if(AE=gE>>>24,_g>>>=AE,eE-=AE,AE=gE>>>16&255,AE===0)JE[_n++]=65535&gE;else{if(!(16&AE)){if(!(64&AE)){gE=pE[(65535&gE)+(_g&(1<<AE)-1)];continue t}if(32&AE){c_.mode=16191;break e}$.msg="invalid literal/length code",c_.mode=QL;break e}PE=65535&gE,AE&=15,AE&&(eE<AE&&(_g+=KE[_t++]<<eE,eE+=8),PE+=_g&(1<<AE)-1,_g>>>=AE,eE-=AE),eE<15&&(_g+=KE[_t++]<<eE,eE+=8,_g+=KE[_t++]<<eE,eE+=8),gE=aE[_g&fE];n:for(;;){if(AE=gE>>>24,_g>>>=AE,eE-=AE,AE=gE>>>16&255,!(16&AE)){if(!(64&AE)){gE=aE[(65535&gE)+(_g&(1<<AE)-1)];continue n}$.msg="invalid distance code",c_.mode=QL;break e}if(xE=65535&gE,AE&=15,eE<AE&&(_g+=KE[_t++]<<eE,eE+=8,eE<AE&&(_g+=KE[_t++]<<eE,eE+=8)),xE+=_g&(1<<AE)-1,xE>_c){$.msg="invalid distance too far back",c_.mode=QL;break e}if(_g>>>=AE,eE-=AE,AE=_n-_i,xE>AE){if(AE=xE-AE,AE>_h&&c_.sane){$.msg="invalid distance too far back",c_.mode=QL;break e}if(GE=0,zE=Qm,_p===0){if(GE+=_u-AE,AE<PE){PE-=AE;do JE[_n++]=Qm[GE++];while(--AE);GE=_n-xE,zE=JE}}else if(_p<AE){if(GE+=_u+_p-AE,AE-=_p,AE<PE){PE-=AE;do JE[_n++]=Qm[GE++];while(--AE);if(GE=0,_p<PE){AE=_p,PE-=AE;do JE[_n++]=Qm[GE++];while(--AE);GE=_n-xE,zE=JE}}}else if(GE+=_p-AE,AE<PE){PE-=AE;do JE[_n++]=Qm[GE++];while(--AE);GE=_n-xE,zE=JE}for(;PE>2;)JE[_n++]=zE[GE++],JE[_n++]=zE[GE++],JE[_n++]=zE[GE++],PE-=3;PE&&(JE[_n++]=zE[GE++],PE>1&&(JE[_n++]=zE[GE++]))}else{GE=_n-xE;do JE[_n++]=JE[GE++],JE[_n++]=JE[GE++],JE[_n++]=JE[GE++],PE-=3;while(PE>2);PE&&(JE[_n++]=JE[GE++],PE>1&&(JE[_n++]=JE[GE++]))}break}}break}}while(_t<Wt&&_n<_s);PE=eE>>3,_t-=PE,eE-=PE<<3,_g&=(1<<eE)-1,$.next_in=_t,$.next_out=_n,$.avail_in=_t<Wt?Wt-_t+5:5-(_t-Wt),$.avail_out=_n<_s?_s-_n+257:257-(_n-_s),c_.hold=_g,c_.bits=eE};const _x=15,vde=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_de=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yde=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bde=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var OP=($,_e,_t,Wt,_n,_i,_s,_c)=>{const _u=_c.bits;let _h,_p,Qm,_g,eE,pE,aE=0,cE=0,fE=0,gE=0,AE=0,PE=0,xE=0,GE=0,zE=0,KE=0,JE=null;const c_=new Uint16Array(16),V_=new Uint16Array(16);let Q_,T0,Z0,M0=null;for(aE=0;aE<=_x;aE++)c_[aE]=0;for(cE=0;cE<Wt;cE++)c_[_e[_t+cE]]++;for(AE=_u,gE=_x;gE>=1&&c_[gE]===0;gE--);if(AE>gE&&(AE=gE),gE===0)return _n[_i++]=20971520,_n[_i++]=20971520,_c.bits=1,0;for(fE=1;fE<gE&&c_[fE]===0;fE++);for(AE<fE&&(AE=fE),GE=1,aE=1;aE<=_x;aE++)if(GE<<=1,GE-=c_[aE],GE<0)return-1;if(GE>0&&($===0||gE!==1))return-1;for(V_[1]=0,aE=1;aE<_x;aE++)V_[aE+1]=V_[aE]+c_[aE];for(cE=0;cE<Wt;cE++)_e[_t+cE]!==0&&(_s[V_[_e[_t+cE]]++]=cE);if($===0?(JE=M0=_s,pE=20):$===1?(JE=vde,M0=_de,pE=257):(JE=yde,M0=bde,pE=0),KE=0,cE=0,aE=fE,eE=_i,PE=AE,xE=0,Qm=-1,zE=1<<AE,_g=zE-1,$===1&&zE>852||$===2&&zE>592)return 1;for(;;){Q_=aE-xE,_s[cE]+1<pE?(T0=0,Z0=_s[cE]):_s[cE]>=pE?(T0=M0[_s[cE]-pE],Z0=JE[_s[cE]-pE]):(T0=96,Z0=0),_h=1<<aE-xE,_p=1<<PE,fE=_p;do _p-=_h,_n[eE+(KE>>xE)+_p]=Q_<<24|T0<<16|Z0|0;while(_p!==0);for(_h=1<<aE-1;KE&_h;)_h>>=1;if(_h!==0?(KE&=_h-1,KE+=_h):KE=0,cE++,--c_[aE]==0){if(aE===gE)break;aE=_e[_t+_s[cE]]}if(aE>AE&&(KE&_g)!==Qm){for(xE===0&&(xE=AE),eE+=fE,PE=aE-xE,GE=1<<PE;PE+xE<gE&&(GE-=c_[PE+xE],!(GE<=0));)PE++,GE<<=1;if(zE+=1<<PE,$===1&&zE>852||$===2&&zE>592)return 1;Qm=KE&_g,_n[Qm]=AE<<24|PE<<16|eE-_i|0}}return KE!==0&&(_n[eE+KE]=aE-xE<<24|64<<16|0),_c.bits=AE,0};const{Z_FINISH:H7,Z_BLOCK:Sde,Z_TREES:eM,Z_OK:WI,Z_STREAM_END:Tde,Z_NEED_DICT:wde,Z_STREAM_ERROR:hR,Z_DATA_ERROR:W7,Z_MEM_ERROR:q7,Z_BUF_ERROR:Rde,Z_DEFLATED:z7}=zO,tM=16180,nM=16190,R1=16191,k6=16192,D6=16194,rM=16199,iM=16200,L6=16206,_S=16209,K7=$=>($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24);function Cde(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const qI=$=>{if(!$)return 1;const _e=$.state;return!_e||_e.strm!==$||_e.mode<tM||_e.mode>16211?1:0},$7=$=>{if(qI($))return hR;const _e=$.state;return $.total_in=$.total_out=_e.total=0,$.msg="",_e.wrap&&($.adler=1&_e.wrap),_e.mode=tM,_e.last=0,_e.havedict=0,_e.flags=-1,_e.dmax=32768,_e.head=null,_e.hold=0,_e.bits=0,_e.lencode=_e.lendyn=new Int32Array(852),_e.distcode=_e.distdyn=new Int32Array(592),_e.sane=1,_e.back=-1,WI},Y7=$=>{if(qI($))return hR;const _e=$.state;return _e.wsize=0,_e.whave=0,_e.wnext=0,$7($)},J7=($,_e)=>{let _t;if(qI($))return hR;const Wt=$.state;return _e<0?(_t=0,_e=-_e):(_t=5+(_e>>4),_e<48&&(_e&=15)),_e&&(_e<8||_e>15)?hR:(Wt.window!==null&&Wt.wbits!==_e&&(Wt.window=null),Wt.wrap=_t,Wt.wbits=_e,Y7($))},X7=($,_e)=>{if(!$)return hR;const _t=new Cde;$.state=_t,_t.strm=$,_t.window=null,_t.mode=tM;const Wt=J7($,_e);return Wt!==WI&&($.state=null),Wt};let x6,M6,Z7=!0;const Ide=$=>{if(Z7){x6=new Int32Array(512),M6=new Int32Array(32);let _e=0;for(;_e<144;)$.lens[_e++]=8;for(;_e<256;)$.lens[_e++]=9;for(;_e<280;)$.lens[_e++]=7;for(;_e<288;)$.lens[_e++]=8;for(OP(1,$.lens,0,288,x6,0,$.work,{bits:9}),_e=0;_e<32;)$.lens[_e++]=5;OP(2,$.lens,0,32,M6,0,$.work,{bits:5}),Z7=!1}$.lencode=x6,$.lenbits=9,$.distcode=M6,$.distbits=5},Q7=($,_e,_t,Wt)=>{let _n;const _i=$.state;return _i.window===null&&(_i.wsize=1<<_i.wbits,_i.wnext=0,_i.whave=0,_i.window=new Uint8Array(_i.wsize)),Wt>=_i.wsize?(_i.window.set(_e.subarray(_t-_i.wsize,_t),0),_i.wnext=0,_i.whave=_i.wsize):(_n=_i.wsize-_i.wnext,_n>Wt&&(_n=Wt),_i.window.set(_e.subarray(_t-Wt,_t-Wt+_n),_i.wnext),(Wt-=_n)?(_i.window.set(_e.subarray(_t-Wt,_t),0),_i.wnext=Wt,_i.whave=_i.wsize):(_i.wnext+=_n,_i.wnext===_i.wsize&&(_i.wnext=0),_i.whave<_i.wsize&&(_i.whave+=_n))),0};var Ade=($,_e)=>{let _t,Wt,_n,_i,_s,_c,_u,_h,_p,Qm,_g,eE,pE,aE,cE,fE,gE,AE,PE,xE,GE,zE,KE=0;const JE=new Uint8Array(4);let c_,V_;const Q_=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(qI($)||!$.output||!$.input&&$.avail_in!==0)return hR;_t=$.state,_t.mode===R1&&(_t.mode=k6),_s=$.next_out,_n=$.output,_u=$.avail_out,_i=$.next_in,Wt=$.input,_c=$.avail_in,_h=_t.hold,_p=_t.bits,Qm=_c,_g=_u,zE=WI;e:for(;;)switch(_t.mode){case tM:if(_t.wrap===0){_t.mode=k6;break}for(;_p<16;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(2&_t.wrap&&_h===35615){_t.wbits===0&&(_t.wbits=15),_t.check=0,JE[0]=255&_h,JE[1]=_h>>>8&255,_t.check=XS(_t.check,JE,2,0),_h=0,_p=0,_t.mode=16181;break}if(_t.head&&(_t.head.done=!1),!(1&_t.wrap)||(((255&_h)<<8)+(_h>>8))%31){$.msg="incorrect header check",_t.mode=_S;break}if((15&_h)!==z7){$.msg="unknown compression method",_t.mode=_S;break}if(_h>>>=4,_p-=4,GE=8+(15&_h),_t.wbits===0&&(_t.wbits=GE),GE>15||GE>_t.wbits){$.msg="invalid window size",_t.mode=_S;break}_t.dmax=1<<_t.wbits,_t.flags=0,$.adler=_t.check=1,_t.mode=512&_h?16189:R1,_h=0,_p=0;break;case 16181:for(;_p<16;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(_t.flags=_h,(255&GS(_t))!==z7){$.msg="unknown compression method",_t.mode=_S;break}if(57344&GS(_t)){$.msg="unknown header flags set",_t.mode=_S;break}_t.head&&(_t.head.text=_h>>8&1),512&GS(_t)&&4&_t.wrap&&(JE[0]=255&_h,JE[1]=_h>>>8&255,_t.check=XS(_t.check,JE,2,0)),_h=0,_p=0,_t.mode=16182;case 16182:for(;_p<32;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.head&&(_t.head.time=_h),512&GS(_t)&&4&_t.wrap&&(JE[0]=255&_h,JE[1]=_h>>>8&255,JE[2]=_h>>>16&255,JE[3]=_h>>>24&255,_t.check=XS(_t.check,JE,4,0)),_h=0,_p=0,_t.mode=16183;case 16183:for(;_p<16;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.head&&(_t.head.xflags=255&_h,_t.head.os=_h>>8),512&GS(_t)&&4&_t.wrap&&(JE[0]=255&_h,JE[1]=_h>>>8&255,_t.check=XS(_t.check,JE,2,0)),_h=0,_p=0,_t.mode=16184;case 16184:if(1024&GS(_t)){for(;_p<16;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.length=_h,_t.head&&(_t.head.extra_len=_h),512&GS(_t)&&4&_t.wrap&&(JE[0]=255&_h,JE[1]=_h>>>8&255,_t.check=XS(_t.check,JE,2,0)),_h=0,_p=0}else _t.head&&(_t.head.extra=null);_t.mode=16185;case 16185:if(1024&GS(_t)&&(eE=_t.length,eE>_c&&(eE=_c),eE&&(_t.head&&(GE=_t.head.extra_len-_t.length,_t.head.extra||(_t.head.extra=new Uint8Array(_t.head.extra_len)),_t.head.extra.set(Wt.subarray(_i,_i+eE),GE)),512&GS(_t)&&4&_t.wrap&&(_t.check=XS(_t.check,Wt,eE,_i)),_c-=eE,_i+=eE,_t.length-=eE),_t.length))break e;_t.length=0,_t.mode=16186;case 16186:if(2048&GS(_t)){if(_c===0)break e;eE=0;do GE=Wt[_i+eE++],_t.head&&GE&&_t.length<65536&&(_t.head.name+=String.fromCharCode(GE));while(GE&&eE<_c);if(512&GS(_t)&&4&_t.wrap&&(_t.check=XS(_t.check,Wt,eE,_i)),_c-=eE,_i+=eE,GE)break e}else _t.head&&(_t.head.name=null);_t.length=0,_t.mode=16187;case 16187:if(4096&GS(_t)){if(_c===0)break e;eE=0;do GE=Wt[_i+eE++],_t.head&&GE&&_t.length<65536&&(_t.head.comment+=String.fromCharCode(GE));while(GE&&eE<_c);if(512&GS(_t)&&4&_t.wrap&&(_t.check=XS(_t.check,Wt,eE,_i)),_c-=eE,_i+=eE,GE)break e}else _t.head&&(_t.head.comment=null);_t.mode=16188;case 16188:if(512&GS(_t)){for(;_p<16;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(4&_t.wrap&&_h!==(65535&_t.check)){$.msg="header crc mismatch",_t.mode=_S;break}_h=0,_p=0}_t.head&&(_t.head.hcrc=GS(_t)>>9&1,_t.head.done=!0),$.adler=_t.check=0,_t.mode=R1;break;case 16189:for(;_p<32;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}$.adler=_t.check=K7(_h),_h=0,_p=0,_t.mode=nM;case nM:if(_t.havedict===0)return $.next_out=_s,$.avail_out=_u,$.next_in=_i,$.avail_in=_c,_t.hold=_h,_t.bits=_p,wde;$.adler=_t.check=1,_t.mode=R1;case R1:if(_e===Sde||_e===eM)break e;case k6:if(_t.last){_h>>>=7&_p,_p-=7&_p,_t.mode=L6;break}for(;_p<3;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}switch(_t.last=1&_h,_h>>>=1,_p-=1,3&_h){case 0:_t.mode=16193;break;case 1:if(Ide(_t),_t.mode=rM,_e===eM){_h>>>=2,_p-=2;break e}break;case 2:_t.mode=16196;break;case 3:$.msg="invalid block type",_t.mode=_S}_h>>>=2,_p-=2;break;case 16193:for(_h>>>=7&_p,_p-=7&_p;_p<32;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if((65535&_h)!=(_h>>>16^65535)){$.msg="invalid stored block lengths",_t.mode=_S;break}if(_t.length=65535&_h,_h=0,_p=0,_t.mode=D6,_e===eM)break e;case D6:_t.mode=16195;case 16195:if(eE=_t.length,eE){if(eE>_c&&(eE=_c),eE>_u&&(eE=_u),eE===0)break e;_n.set(Wt.subarray(_i,_i+eE),_s),_c-=eE,_i+=eE,_u-=eE,_s+=eE,_t.length-=eE;break}_t.mode=R1;break;case 16196:for(;_p<14;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(_t.nlen=257+(31&_h),_h>>>=5,_p-=5,_t.ndist=1+(31&_h),_h>>>=5,_p-=5,_t.ncode=4+(15&_h),_h>>>=4,_p-=4,_t.nlen>286||_t.ndist>30){$.msg="too many length or distance symbols",_t.mode=_S;break}_t.have=0,_t.mode=16197;case 16197:for(;_t.have<_t.ncode;){for(;_p<3;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.lens[Q_[_t.have++]]=7&_h,_h>>>=3,_p-=3}for(;_t.have<19;)_t.lens[Q_[_t.have++]]=0;if(_t.lencode=_t.lendyn,_t.lenbits=7,c_={bits:_t.lenbits},zE=OP(0,_t.lens,0,19,_t.lencode,0,_t.work,c_),_t.lenbits=c_.bits,zE){$.msg="invalid code lengths set",_t.mode=_S;break}_t.have=0,_t.mode=16198;case 16198:for(;_t.have<_t.nlen+_t.ndist;){for(;KE=_t.lencode[_h&(1<<_t.lenbits)-1],cE=KE>>>24,fE=KE>>>16&255,gE=65535&KE,!(cE<=_p);){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(gE<16)_h>>>=cE,_p-=cE,_t.lens[_t.have++]=gE;else{if(gE===16){for(V_=cE+2;_p<V_;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(_h>>>=cE,_p-=cE,_t.have===0){$.msg="invalid bit length repeat",_t.mode=_S;break}GE=_t.lens[_t.have-1],eE=3+(3&_h),_h>>>=2,_p-=2}else if(gE===17){for(V_=cE+3;_p<V_;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_h>>>=cE,_p-=cE,GE=0,eE=3+(7&_h),_h>>>=3,_p-=3}else{for(V_=cE+7;_p<V_;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_h>>>=cE,_p-=cE,GE=0,eE=11+(127&_h),_h>>>=7,_p-=7}if(_t.have+eE>_t.nlen+_t.ndist){$.msg="invalid bit length repeat",_t.mode=_S;break}for(;eE--;)_t.lens[_t.have++]=GE}}if(_t.mode===_S)break;if(_t.lens[256]===0){$.msg="invalid code -- missing end-of-block",_t.mode=_S;break}if(_t.lenbits=9,c_={bits:_t.lenbits},zE=OP(1,_t.lens,0,_t.nlen,_t.lencode,0,_t.work,c_),_t.lenbits=c_.bits,zE){$.msg="invalid literal/lengths set",_t.mode=_S;break}if(_t.distbits=6,_t.distcode=_t.distdyn,c_={bits:_t.distbits},zE=OP(2,_t.lens,_t.nlen,_t.ndist,_t.distcode,0,_t.work,c_),_t.distbits=c_.bits,zE){$.msg="invalid distances set",_t.mode=_S;break}if(_t.mode=rM,_e===eM)break e;case rM:_t.mode=iM;case iM:if(_c>=6&&_u>=258){$.next_out=_s,$.avail_out=_u,$.next_in=_i,$.avail_in=_c,_t.hold=_h,_t.bits=_p,Ede($,_g),_s=$.next_out,_n=$.output,_u=$.avail_out,_i=$.next_in,Wt=$.input,_c=$.avail_in,_h=_t.hold,_p=_t.bits,_t.mode===R1&&(_t.back=-1);break}for(_t.back=0;KE=_t.lencode[_h&(1<<_t.lenbits)-1],cE=KE>>>24,fE=KE>>>16&255,gE=65535&KE,!(cE<=_p);){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(fE&&!(240&fE)){for(AE=cE,PE=fE,xE=gE;KE=_t.lencode[xE+((_h&(1<<AE+PE)-1)>>AE)],cE=KE>>>24,fE=KE>>>16&255,gE=65535&KE,!(AE+cE<=_p);){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_h>>>=AE,_p-=AE,_t.back+=AE}if(_h>>>=cE,_p-=cE,_t.back+=cE,_t.length=gE,fE===0){_t.mode=16205;break}if(32&fE){_t.back=-1,_t.mode=R1;break}if(64&fE){$.msg="invalid literal/length code",_t.mode=_S;break}_t.extra=15&fE,_t.mode=16201;case 16201:if(_t.extra){for(V_=_t.extra;_p<V_;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.length+=_h&(1<<_t.extra)-1,_h>>>=_t.extra,_p-=_t.extra,_t.back+=_t.extra}_t.was=_t.length,_t.mode=16202;case 16202:for(;KE=_t.distcode[_h&(1<<_t.distbits)-1],cE=KE>>>24,fE=KE>>>16&255,gE=65535&KE,!(cE<=_p);){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(!(240&fE)){for(AE=cE,PE=fE,xE=gE;KE=_t.distcode[xE+((_h&(1<<AE+PE)-1)>>AE)],cE=KE>>>24,fE=KE>>>16&255,gE=65535&KE,!(AE+cE<=_p);){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_h>>>=AE,_p-=AE,_t.back+=AE}if(_h>>>=cE,_p-=cE,_t.back+=cE,64&fE){$.msg="invalid distance code",_t.mode=_S;break}_t.offset=gE,_t.extra=15&fE,_t.mode=16203;case 16203:if(_t.extra){for(V_=_t.extra;_p<V_;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}_t.offset+=_h&(1<<_t.extra)-1,_h>>>=_t.extra,_p-=_t.extra,_t.back+=_t.extra}if(_t.offset>_t.dmax){$.msg="invalid distance too far back",_t.mode=_S;break}_t.mode=16204;case 16204:if(_u===0)break e;if(eE=_g-_u,_t.offset>eE){if(eE=_t.offset-eE,eE>_t.whave&&_t.sane){$.msg="invalid distance too far back",_t.mode=_S;break}eE>_t.wnext?(eE-=_t.wnext,pE=_t.wsize-eE):pE=_t.wnext-eE,eE>_t.length&&(eE=_t.length),aE=_t.window}else aE=_n,pE=_s-_t.offset,eE=_t.length;eE>_u&&(eE=_u),_u-=eE,_t.length-=eE;do _n[_s++]=aE[pE++];while(--eE);_t.length===0&&(_t.mode=iM);break;case 16205:if(_u===0)break e;_n[_s++]=_t.length,_u--,_t.mode=iM;break;case L6:if(_t.wrap){for(;_p<32;){if(_c===0)break e;_c--,_h|=Wt[_i++]<<_p,_p+=8}if(_g-=_u,$.total_out+=_g,_t.total+=_g,4&_t.wrap&&_g&&($.adler=_t.check=GS(_t)?XS(_t.check,_n,_g,_s-_g):yP(_t.check,_n,_g,_s-_g)),_g=_u,4&_t.wrap&&(GS(_t)?_h:K7(_h))!==_t.check){$.msg="incorrect data check",_t.mode=_S;break}_h=0,_p=0}_t.mode=16207;case 16207:if(_t.wrap&&GS(_t)){for(;_p<32;){if(_c===0)break e;_c--,_h+=Wt[_i++]<<_p,_p+=8}if(4&_t.wrap&&_h!==(4294967295&_t.total)){$.msg="incorrect length check",_t.mode=_S;break}_h=0,_p=0}_t.mode=16208;case 16208:zE=Tde;break e;case _S:zE=W7;break e;case 16210:return q7;default:return hR}return $.next_out=_s,$.avail_out=_u,$.next_in=_i,$.avail_in=_c,_t.hold=_h,_t.bits=_p,(_t.wsize||_g!==$.avail_out&&_t.mode<_S&&(_t.mode<L6||_e!==H7))&&Q7($,$.output,$.next_out,_g-$.avail_out),Qm-=$.avail_in,_g-=$.avail_out,$.total_in+=Qm,$.total_out+=_g,_t.total+=_g,4&_t.wrap&&_g&&($.adler=_t.check=GS(_t)?XS(_t.check,_n,_g,$.next_out-_g):yP(_t.check,_n,_g,$.next_out-_g)),$.data_type=_t.bits+(_t.last?64:0)+(_t.mode===R1?128:0)+(_t.mode===rM||_t.mode===D6?256:0),(Qm===0&&_g===0||_e===H7)&&zE===WI&&(zE=Rde),zE},C1={inflateReset:Y7,inflateReset2:J7,inflateResetKeep:$7,inflateInit:$=>X7($,15),inflateInit2:X7,inflate:Ade,inflateEnd:$=>{if(qI($))return hR;let _e=$.state;return _e.window&&(_e.window=null),$.state=null,WI},inflateGetHeader:($,_e)=>{if(qI($))return hR;const _t=$.state;return 2&_t.wrap?(_t.head=_e,_e.done=!1,WI):hR},inflateSetDictionary:($,_e)=>{const _t=_e.length;let Wt,_n,_i;return qI($)?hR:(Wt=$.state,Wt.wrap!==0&&Wt.mode!==nM?hR:Wt.mode===nM&&(_n=1,_n=yP(_n,_e,_t,0),_n!==Wt.check)?W7:(_i=Q7($,_e,_t,_t),_i?(Wt.mode=16210,q7):(Wt.havedict=1,WI)))},inflateInfo:"pako inflate (from Nodeca project)"},Ode=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const eK=Object.prototype.toString,{Z_NO_FLUSH:Nde,Z_FINISH:Pde,Z_OK:NP,Z_STREAM_END:U6,Z_NEED_DICT:j6,Z_STREAM_ERROR:kde,Z_DATA_ERROR:tK,Z_MEM_ERROR:Dde}=zO;function PP($){this.options=XL.assign({chunkSize:65536,windowBits:15,to:""},$||{});const _e=this.options;_e.raw&&_e.windowBits>=0&&_e.windowBits<16&&(_e.windowBits=-_e.windowBits,_e.windowBits===0&&(_e.windowBits=-15)),!(_e.windowBits>=0&&_e.windowBits<16)||$&&$.windowBits||(_e.windowBits+=32),_e.windowBits>15&&_e.windowBits<48&&!(15&_e.windowBits)&&(_e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new B7,this.strm.avail_out=0;let _t=C1.inflateInit2(this.strm,_e.windowBits);if(_t!==NP)throw new Error(VI[_t]);if(this.header=new Ode,C1.inflateGetHeader(this.strm,this.header),_e.dictionary&&(typeof _e.dictionary=="string"?_e.dictionary=IP.string2buf(_e.dictionary):eK.call(_e.dictionary)==="[object ArrayBuffer]"&&(_e.dictionary=new Uint8Array(_e.dictionary)),_e.raw&&(_t=C1.inflateSetDictionary(this.strm,_e.dictionary),_t!==NP)))throw new Error(VI[_t])}function F6($,_e){const _t=new PP(_e);if(_t.push($),_t.err)throw _t.msg||VI[_t.err];return _t.result}PP.prototype.push=function($,_e){const _t=this.strm,Wt=this.options.chunkSize,_n=this.options.dictionary;let _i,_s,_c;if(this.ended)return!1;for(_s=_e===~~_e?_e:_e===!0?Pde:Nde,eK.call($)==="[object ArrayBuffer]"?_t.input=new Uint8Array($):_t.input=$,_t.next_in=0,_t.avail_in=_t.input.length;;){for(_t.avail_out===0&&(_t.output=new Uint8Array(Wt),_t.next_out=0,_t.avail_out=Wt),_i=C1.inflate(_t,_s),_i===j6&&_n&&(_i=C1.inflateSetDictionary(_t,_n),_i===NP?_i=C1.inflate(_t,_s):_i===tK&&(_i=j6));_t.avail_in>0&&_i===U6&&_t.state.wrap>0&&$[_t.next_in]!==0;)C1.inflateReset(_t),_i=C1.inflate(_t,_s);switch(_i){case kde:case tK:case j6:case Dde:return this.onEnd(_i),this.ended=!0,!1}if(_c=_t.avail_out,_t.next_out&&(_t.avail_out===0||_i===U6))if(this.options.to==="string"){let _u=IP.utf8border(_t.output,_t.next_out),_h=_t.next_out-_u,_p=IP.buf2string(_t.output,_u);_t.next_out=_h,_t.avail_out=Wt-_h,_h&&_t.output.set(_t.output.subarray(_u,_u+_h),0),this.onData(_p)}else this.onData(_t.output.length===_t.next_out?_t.output:_t.output.subarray(0,_t.next_out));if(_i!==NP||_c!==0){if(_i===U6)return _i=C1.inflateEnd(this.strm),this.onEnd(_i),this.ended=!0,!0;if(_t.avail_in===0)break}}return!0},PP.prototype.onData=function($){this.chunks.push($)},PP.prototype.onEnd=function($){$===NP&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=XL.flattenChunks(this.chunks)),this.chunks=[],this.err=$,this.msg=this.strm.msg};var Lde={Inflate:PP,inflate:F6,inflateRaw:function($,_e){return(_e=_e||{}).raw=!0,F6($,_e)},ungzip:F6,constants:zO};const{Deflate:ope,deflate:xde,deflateRaw:spe,gzip:ape}=gde,{Inflate:cpe,inflate:Mde,inflateRaw:lpe,ungzip:upe}=Lde;var Ude=xde,jde=Mde;const IS={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function B_(){return IS}function nK(){return"setSinkId"in HTMLAudioElement.prototype&&(!yE("RESTRICTION_SET_PLAYBACK_DEVICE")||(H1()||gH())&&!gV())}let SS=function($){return $.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",$.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",$.IOS_INTERRUPTION_START="ios-interruption-start",$.IOS_INTERRUPTION_END="ios-interruption-end",$.STATE_CHANGE="state-change",$}({});function JO($,_e,_t){return{sampleRate:$,stereo:_e,bitrate:_t}}function H_($,_e,_t,Wt,_n){return{width:$,height:_e,frameRate:_t,bitrateMin:Wt,bitrateMax:_n}}function pR($,_e,_t,Wt,_n){return{width:{max:$},height:{max:_e},frameRate:_t,bitrateMin:Wt,bitrateMax:_n}}function V6($,_e){return{numSpatialLayers:$,numTemporalLayers:_e}}const Fde={"90p":H_(160,90),"90p_1":H_(160,90),"120p":H_(160,120,15,30,65),"120p_1":H_(160,120,15,30,65),"120p_3":H_(120,120,15,30,50),"120p_4":H_(212,120),"180p":H_(320,180,15,30,140),"180p_1":H_(320,180,15,30,140),"180p_3":H_(180,180,15,30,100),"180p_4":H_(240,180,15,30,120),"240p":H_(320,240,15,40,200),"240p_1":H_(320,240,15,40,200),"240p_3":H_(240,240,15,40,140),"240p_4":H_(424,240,15,40,220),"360p":H_(640,360,15,80,400),"360p_1":H_(640,360,15,80,400),"360p_3":H_(360,360,15,80,260),"360p_4":H_(640,360,30,80,600),"360p_6":H_(360,360,30,80,400),"360p_7":H_(480,360,15,80,320),"360p_8":H_(480,360,30,80,490),"360p_9":H_(640,360,15,80,800),"360p_10":H_(640,360,24,80,800),"360p_11":H_(640,360,24,80,1e3),"480p":H_(640,480,15,100,500),"480p_1":H_(640,480,15,100,500),"480p_2":H_(640,480,30,100,1e3),"480p_3":H_(480,480,15,100,400),"480p_4":H_(640,480,30,100,750),"480p_6":H_(480,480,30,100,600),"480p_8":H_(848,480,15,100,610),"480p_9":H_(848,480,30,100,930),"480p_10":H_(640,480,10,100,400),"720p":H_(1280,720,15,120,1130),"720p_auto":H_(1280,720,30,900,3e3),"720p_1":H_(1280,720,15,120,1130),"720p_2":H_(1280,720,30,120,2e3),"720p_3":H_(1280,720,30,120,1710),"720p_5":H_(960,720,15,120,910),"720p_6":H_(960,720,30,120,1380),"1080p":H_(1920,1080,15,120,2080),"1080p_1":H_(1920,1080,15,120,2080),"1080p_2":H_(1920,1080,30,120,3e3),"1080p_3":H_(1920,1080,30,120,3150),"1080p_5":H_(1920,1080,60,120,4780),"1440p":H_(2560,1440,30,120,4850),"1440p_1":H_(2560,1440,30,120,4850),"1440p_2":H_(2560,1440,60,120,7350),"4k":H_(3840,2160,30,120,8910),"4k_1":H_(3840,2160,30,120,8910),"4k_3":H_(3840,2160,60,120,13500)},oM=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],Vde={"480p":pR(640,480,5),"480p_1":pR(640,480,5),"480p_2":pR(640,480,30),"480p_3":pR(640,480,15),"720p":pR(1280,720,5),"720p_auto":H_(1280,720,30,900,3e3),"720p_1":pR(1280,720,5),"720p_2":pR(1280,720,30),"720p_3":pR(1280,720,15),"1080p":pR(1920,1080,5),"1080p_1":pR(1920,1080,5),"1080p_2":pR(1920,1080,30),"1080p_3":pR(1920,1080,15)},Bde={"1SL1TL":V6(1,1),"3SL3TL":V6(3,3),"2SL3TL":V6(2,3)};function i1($){return $||($="480p_1"),typeof $=="string"?Object.assign({},Fde[$]):$}function B6($){return typeof $=="string"?Object.assign({},Vde[$]):$}function sM($){return typeof $=="string"?Object.assign({},Bde[$]):$}const Gde={speech_low_quality:JO(16e3,!1),speech_standard:JO(32e3,!1,18),music_standard:JO(48e3,!1),standard_stereo:JO(48e3,!0,56),high_quality:JO(48e3,!1,128),high_quality_stereo:JO(48e3,!0,192)};function aM($){return typeof $=="string"?Object.assign({},Gde[$]):$}const XO=[];function rK($){return aS($,"mediaSource",["screen","window","application"]),!0}let a_=function($){return $.NEED_RENEGOTIATE="@need_renegotiate",$.NEED_REPLACE_TRACK="@need_replace_track",$.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",$.NEED_CLOSE="@need_close",$.NEED_ENABLE_TRACK="@need_enable_track",$.NEED_DISABLE_TRACK="@need_disable_track",$.NEED_SESSION_ID="@need_sid",$.SET_OPTIMIZATION_MODE="@set_optimization_mode",$.GET_STATS="@get_stats",$.GET_RTC_STATS="@get_rtc_stats",$.GET_LOW_VIDEO_TRACK="@get_low_video_track",$.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",$.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",$.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",$.NEED_MUTE_TRACK="@need_mute_track",$.NEED_UNMUTE_TRACK="@need_unmute_track",$}({}),S0=function($){return $.SCREEN_TRACK="screen_track",$.CUSTOM_TRACK="custome_track",$.LOW_STREAM="low_stream",$}({}),ZO=function($){return $[$.HIGH_STREAM=0]="HIGH_STREAM",$[$.LOW_STREAM=1]="LOW_STREAM",$}({}),Hde=function($){return $[$.HIGH_STREAM=0]="HIGH_STREAM",$[$.LOW_STREAM=1]="LOW_STREAM",$}({}),Wde=function($){return $[$.DISABLE=0]="DISABLE",$[$.LOW_STREAM=1]="LOW_STREAM",$[$.AUDIO_ONLY=2]="AUDIO_ONLY",$}({}),zI=function($){return $.TRANSCEIVER_UPDATED="transceiver-updated",$.SEI_TO_SEND="sei-to-send",$.SEI_RECEIVED="sei-received",$.TRACK_UPDATED="track-updated",$}({}),QO=function($){return $.SOURCE_STATE_CHANGE="source-state-change",$.TRACK_ENDED="track-ended",$.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",$.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",$.CLOSED="closed",$}({}),eN=function($){return $.FIRST_FRAME_DECODED="first-frame-decoded",$.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",$.VIDEO_STATE_CHANGED="video-state-changed",$}({}),CT=function($){return $.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",$.RECEIVE_TRACK_BUFFER="receive_track_buffer",$.ON_AUDIO_BUFFER="on_audio_buffer",$.UPDATE_SOURCE="update_source",$}({});(function($){$.UPDATE_TRACK_SOURCE="update-track-source"})({});const G6={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},H6={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},iK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},qde={uplinkNetworkQuality:0,downlinkNetworkQuality:0},oK={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let ZS=function($){return $.ON_TRACK="on_track",$.ON_NODE="on_node",$}({}),IT=function($){return $.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",$.REQUEST_CONSTRAINTS="request_constraints",$}({}),kP=function($){return $.IDLE="IDLE",$.INITING="INITING",$.INITEND="INITEND",$}({}),KI=function($){return $.STATE_CHANGE="state_change",$.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",$.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",$.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",$}({}),HS=function($){return $.NONE="none",$.INIT="init",$.CANPLAY="canplay",$.PLAYING="playing",$.PAUSED="paused",$.SUSPEND="suspend",$.STALLED="stalled",$.WAITING="waiting",$.ERROR="error",$.DESTROYED="destroyed",$.ABORT="abort",$.ENDED="ended",$.EMPTIED="emptied",$.LOADEDDATA="loadeddata",$}({}),o1=function($){return $[$.VideoStateStopped=0]="VideoStateStopped",$[$.VideoStateStarting=1]="VideoStateStarting",$[$.VideoStateDecoding=2]="VideoStateDecoding",$[$.VideoStateFrozen=3]="VideoStateFrozen",$}({});const W6={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let cM=function($){return $.OPEN="open",$.MESSAGE="message",$.CLOSE="close",$.CLOSING="closing",$.ERROR="error",$}({});function sK($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function O0($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?sK(Object(_t),!0).forEach(function(Wt){WE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):sK(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function WE($,_e,_t){return(_e=function(Wt){var _n=function(_i,_s){if(typeof _i!="object"||_i===null)return _i;var _c=_i[Symbol.toPrimitive];if(_c!==void 0){var _u=_c.call(_i,"string");if(typeof _u!="object")return _u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_i)}(Wt);return typeof _n=="symbol"?_n:String(_n)}(_e))in $?Object.defineProperty($,_e,{value:_t,enumerable:!0,configurable:!0,writable:!0}):$[_e]=_t,$}function G_($,_e,_t,Wt,_n){var _i,_s,_c={};return Object.keys(Wt).forEach(function(_u){_c[_u]=Wt[_u]}),_c.enumerable=!!_c.enumerable,_c.configurable=!!_c.configurable,("value"in _c||_c.initializer)&&(_c.writable=!0),_c=wR(_i=Ile(_s=_t.slice()).call(_s)).call(_i,function(_u,_h){return _h($,_e,_u)||_u},_c),_n&&_c.initializer!==void 0&&(_c.value=_c.initializer?_c.initializer.call(_n):void 0,_c.initializer=void 0),_c.initializer===void 0&&(Object.defineProperty($,_e,_c),_c=null),_c}class aK extends A0{set _mediaStreamTrack(_e){_e!==this.mediaStreamTrack&&(this.safeEmit(zI.TRACK_UPDATED,_e),this.mediaStreamTrack=_e)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(_e,_t){super(),WE(this,"trackMediaType",void 0),WE(this,"_ID",void 0),WE(this,"_rtpTransceiver",void 0),WE(this,"_lowRtpTransceiver",void 0),WE(this,"_hints",[]),WE(this,"_isClosed",!1),WE(this,"_originMediaStreamTrack",void 0),WE(this,"mediaStreamTrack",void 0),WE(this,"_external",{}),this._ID=_t||f0(8,"track-"),this._originMediaStreamTrack=_e,this.mediaStreamTrack=_e,function(Wt){i_(XO).call(XO,Wt)||XO.push(Wt)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(_e){return _e||q1(()=>{var _t;p_.reportApiInvoke(null,{name:Q0.GET_MEDIA_STREAM_TRACK,options:[],tag:j0.TRACER}).onSuccess(((_t=this._mediaStreamTrack)===null||_t===void 0?void 0:_t.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(_e){return _e===ZO.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(_e){const _t=XO.indexOf(_e);_t!==-1&&XO.splice(_t,1)}(this),this.emit(QO.CLOSED),this.removeAllListeners(zI.SEI_RECEIVED)}_updateRtpTransceiver(_e,_t){if(_t===ZO.LOW_STREAM){if(this._lowRtpTransceiver===_e)return;this._lowRtpTransceiver=_e}else{if(this._rtpTransceiver===_e)return;this._rtpTransceiver=_e}this.emit(zI.TRANSCEIVER_UPDATED,_e,_t)}}class tN extends aK{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(_e,_t){super(_e,_t),WE(this,"_enabled",!0),WE(this,"_muted",!1),WE(this,"_isExternalTrack",!1),WE(this,"_isClosed",!1),WE(this,"_enabledMutex",void 0),WE(this,"processor",void 0),WE(this,"_processorContext",void 0),WE(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new mS("".concat(this.getTrackId())),_e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var _e,_t;return(_e=(_t=this._originMediaStreamTrack)===null||_t===void 0?void 0:_t.label)!==null&&_e!==void 0?_e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,iE.debug("[".concat(this.getTrackId(),"] close")),this.emit(a_.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(_e,_t){let Wt=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=Wt,_e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),_t&&this._originMediaStreamTrack.stop()),_e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=_e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await p0(this,a_.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){iE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(QO.TRACK_ENDED)}stateCheck(_e,_t){if(iE.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(_e,": ").concat(_t,"]")),E1(_t,_e),this._enabled&&this._muted&&_e==="enabled"&&_t===!1)throw new HE(mE.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",iE);if(!this._enabled&&!this._muted&&_e==="muted"&&_t===!0)throw new HE(mE.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",iE)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():n_.resolve([])}}const cK=window.AudioContext||window.webkitAudioContext;let AT=null;const c0=new class extends A0{constructor(){super(...arguments),WE(this,"prevState",void 0),WE(this,"curState",void 0),WE(this,"currentTime",void 0),WE(this,"currentTimeStuckAt",void 0),WE(this,"interruptDetectorTrack",void 0),WE(this,"onLocalAudioTrackMute",()=>{iE.info("ios15-interruption-start"),this.emit(SS.IOS_15_16_INTERRUPTION_START)}),WE(this,"onLocalAudioTrackUnmute",async()=>{iE.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?iE.info("ios15-interruption-end-canceled"):(AT&&await AT.suspend(),this.emit(SS.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack($){iE.debug("webaudio bindInterruptDetectorTrack ".concat($.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=$,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack($){iE.debug("webaudio unbindInterruptDetectorTrack ".concat($.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===$&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function nN(){if(!AT){if(function(){if(!cK)return void iE.error("your browser is not support web audio");iE.info("create audio context");const $=O0({},yE("WEBAUDIO_INIT_OPTIONS"));iE.debug("audio context init option:",JSON.stringify($)),AT=new cK($),c0.curState=AT.state,AT.onstatechange=()=>{c0.prevState=c0.curState,c0.curState=AT?AT.state:void 0;const{prevState:_e,curState:_t}=c0,Wt=_t==="running",_n=_t==="interrupted",_i=_e==="running",_s=_e==="suspended",_c=_e==="interrupted",_u=W_().osVersion;(PS()||tR())&&_i&&_n&&(iE.info("ios".concat(_u,"-interruption-start")),c0.emit(SS.IOS_INTERRUPTION_START)),(PS()||tR())&&(_s||_c)&&Wt&&(iE.info("ios".concat(_u,"-interruption-end")),c0.emit(SS.IOS_INTERRUPTION_END)),_e!==_t&&c0.emit(SS.STATE_CHANGE,_t,_e)},setInterval(()=>{var _e;const _t=(_e=AT)===null||_e===void 0?void 0:_e.currentTime;c0.currentTime!==_t?(c0.currentTimeStuckAt&&(iE.debug("AudioContext current time resume at ".concat(_t)),c0.currentTimeStuckAt=void 0),c0.currentTime=_t):(_t!==c0.currentTimeStuckAt&&(p_.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:_t},tag:j0.TRACER}).onSuccess(),iE.warning("AudioContext current time stuck at ".concat(_t))),c0.currentTimeStuckAt=_t)},5e3),async function(_e){const _t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let Wt,_n=!1,_i=!1,_s=!1;function _c(aE){_e.state==="running"?_u(!1):PS()||tR()?_e.state==="suspended"&&(_u(!0),aE&&_e.resume().then(_h,_h)):_e.state!=="closed"&&(_u(!0),aE&&_e.resume().then(_h,_h))}function _u(aE){if(_n!==aE){_n=aE;for(let cE=0,fE=_t;cE<fE.length;cE+=1){const gE=fE[cE];aE?window.addEventListener(gE,_p,{capture:!0,passive:!0}):window.removeEventListener(gE,_p,{capture:!0,passive:!0})}}}function _h(){_c(!1)}function _p(){_c(!0)}function Qm(aE){if(!_s)if(Wt.paused)if(aE){let cE;_g(!1),_s=!0;try{cE=Wt.play(),cE?cE.then(eE,eE):(Wt.addEventListener("playing",eE),Wt.addEventListener("abort",eE),Wt.addEventListener("error",eE))}catch{eE()}}else _g(!0);else _g(!1)}function _g(aE){if(_i!==aE){_i=aE;for(let cE=0,fE=_t;cE<fE.length;cE++){const gE=fE[cE];aE?window.addEventListener(gE,pE,{capture:!0,passive:!0}):window.removeEventListener(gE,pE,{capture:!0,passive:!0})}}}function eE(){Wt.removeEventListener("playing",eE),Wt.removeEventListener("abort",eE),Wt.removeEventListener("error",eE),_s=!1,Qm(!1)}function pE(){Qm(!0)}if(PS()){const aE=_e.createMediaStreamDestination(),cE=document.createElement("div");cE.innerHTML="<audio x-webkit-airplay='deny'></audio>",Wt=cE.children.item(0),Wt.controls=!1,Wt.disableRemotePlayback=!0,Wt.preload="auto",Wt.srcObject=aE.stream,Qm(!0)}c0.on(SS.STATE_CHANGE,function(){_c(!0)}),_c(!1)}(AT)}(),!AT)throw new HE(mE.NOT_SUPPORTED,"can not create audio context");return AT}return AT}function $I($){if(function(){if(q6!==null)return q6;const Wt=nN(),_n=Wt.createBufferSource(),_i=Wt.createGain(),_s=Wt.createGain();_n.connect(_i),_n.connect(_s),_n.disconnect(_i);let _c=!1;try{_n.disconnect(_i)}catch{_c=!0}return _n.disconnect(),q6=_c,_c}())return;const _e=$.connect,_t=$.disconnect;$.connect=(Wt,_n,_i)=>{var _s;return $._inputNodes||($._inputNodes=[]),i_(_s=$._inputNodes).call(_s,Wt)||(Wt instanceof AudioNode?($._inputNodes.push(Wt),_e.call($,Wt,_n,_i)):_e.call($,Wt,_n)),$},$.disconnect=(Wt,_n,_i)=>{_t.call($),Wt?bL($._inputNodes,Wt):$._inputNodes=[];for(const _s of $._inputNodes)_e.call($,_s)}}let q6=null;function z6($,_e){let _t=!1;const Wt=1/_e;if(yE("DISABLE_WEBAUDIO")){const _n=window.setInterval(()=>{_t?window.clearInterval(_n):$(performance.now()/1e3)},1e3*Wt)}else{const _n=nN();let _i=_n.createGain();_i.gain.value=0,_i.connect(_n.destination);const _s=()=>{if(_t)return void(_i=null);const _c=_n.createOscillator();_c.onended=_s,_c.connect(_i),_c.start(0),_c.stop(_n.currentTime+Wt),$(_n.currentTime)};_s()}return()=>{_t=!0}}class lK{constructor(){WE(this,"context",void 0),WE(this,"analyserNode",void 0),WE(this,"sourceNode",void 0),this.context=nN(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(_e){if(_e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=_e,_e==null||_e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||PS()||tR()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const _e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(_e);else{const Wt=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(Wt);for(let _n=0;_n<_e.length;++_n)_e[_n]=Wt[_n]/128-1}const _t=wR(_e).call(_e,(Wt,_n)=>Wt+_n*_n,0)/_e.length;return Math.max(10*Math.log10(_t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var _e,_t;(_e=this.sourceNode)===null||_e===void 0||_e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(_t=this.sourceNode)===null||_t===void 0||_t.connect(this.analyserNode)}catch{iE.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class uK extends A0{get processSourceNode(){return this.sourceNode}set processedNode(_e){var _t;if(!this.isDestroyed&&this._processedNode!==_e){try{var Wt;(Wt=this.sourceNode)===null||Wt===void 0||Wt.disconnect(this.outputNode)}catch{}(_t=this._processedNode)===null||_t===void 0||_t.disconnect(),this._processedNode=_e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),WE(this,"outputNode",void 0),WE(this,"outputTrack",void 0),WE(this,"isPlayed",!1),WE(this,"sourceNode",void 0),WE(this,"context",void 0),WE(this,"audioBufferNode",void 0),WE(this,"destNode",void 0),WE(this,"audioOutputLevel",0),WE(this,"volumeLevelAnalyser",void 0),WE(this,"_processedNode",void 0),WE(this,"playNode",void 0),WE(this,"isDestroyed",!1),WE(this,"onNoAudioInput",void 0),WE(this,"isNoAudioInput",!1),WE(this,"_noAudioInputCount",0),this.context=nN(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),$I(this.outputNode),this.volumeLevelAnalyser=new lK}startGetAudioBuffer(_e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(_e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=_t=>{this.emit(CT.ON_AUDIO_BUFFER,function(Wt){for(let _n=0;_n<Wt.outputBuffer.numberOfChannels;_n+=1){const _i=Wt.outputBuffer.getChannelData(_n);for(let _s=0;_s<_i.length;_s+=1)_i[_s]=0}return Wt.inputBuffer}(_t))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!B_().webAudioMediaStreamDest)throw new HE(mE.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(_e){this.context.state!=="running"&&SL(()=>{c0.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=_e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(_e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;PS()||tR()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const _t=this.volumeLevelAnalyser.getAnalyserNode();let Wt;_t.getFloatTimeDomainData?(Wt=new Float32Array(_t.fftSize),_t.getFloatTimeDomainData(Wt)):(Wt=new Uint8Array(_t.fftSize),_t.getByteTimeDomainData(Wt));let _n=!1;for(let _i=0;_i<Wt.length;_i++)Wt[_i]!==0&&(_n=!0);return _n?(this.isNoAudioInput=!1,!0):(await hS(200),await this.checkHasAudioInput(_e?_e+1:1)&&_n)}getAudioVolume(){return this.outputNode.gain.value}setVolume(_e){this.outputNode.gain.setValueAtTime(_e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var _e,_t;(_e=this.processedNode)===null||_e===void 0||_e.disconnect(),(_t=this.sourceNode)===null||_t===void 0||_t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var _e;this.processedNode?(_e=this.processedNode)===null||_e===void 0||_e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class dK extends uK{get isFreeze(){return!1}constructor(_e,_t,Wt){var _n;if(super(),WE(this,"sourceNode",void 0),WE(this,"track",void 0),WE(this,"clonedTrack",void 0),WE(this,"audioElement",void 0),WE(this,"isCurrentTrackCloned",!1),WE(this,"isRemoteTrack",!1),WE(this,"originVolumeLevelAnalyser",void 0),WE(this,"rebuildWebAudio",async()=>{if(iE.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void iE.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>iE.info("resume success")),iE.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const _c=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?_c.stop():this.isCurrentTrackCloned=!0;const _u=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_u),$I(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const _h=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(_h,this.context.currentTime),$I(this.outputNode),this.emit(CT.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_u,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),_e.kind!=="audio")throw new HE(mE.UNEXPECTED_ERROR);this.track=_e;const _i=new MediaStream([this.track]);if(this.isRemoteTrack=!!_t,this.sourceNode=this.context.createMediaStreamSource(_i),$I(this.sourceNode),Wt){const _c=Wt.clone();_c.enabled=!0,this.clonedTrack=_c,iE.debug("create an unmuted track ".concat(_c.id," from the original track ").concat(Wt.id," to get the volume"));const _u=this.context.createMediaStreamSource(new MediaStream([_c]));$I(_u),this.originVolumeLevelAnalyser=new lK,this.originVolumeLevelAnalyser.updateSource(_u)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=_i;const _s=W_();_t&&_s.os===uS.IOS&&Number((_n=_s.osVersion)===null||_n===void 0?void 0:_n.split(".")[0])<15&&(c0.on(SS.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(_c=>{_c||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(_e){this.sourceNode.disconnect(),this.track=_e,this.isCurrentTrackCloned=!1;const _t=new MediaStream([_e]);this.sourceNode=this.context.createMediaStreamSource(_t),$I(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(CT.UPDATE_SOURCE),this.audioElement.srcObject=_t}destroy(){var _e;this.audioElement.srcObject=null,this.audioElement.remove(),c0.off("state-change",this.rebuildWebAudio),(_e=this.originVolumeLevelAnalyser)===null||_e===void 0||_e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(_e){return this.context.createMediaStreamSource(new MediaStream([_e]))}updateOriginTrack(_e){const _t=_e.clone();_t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=_t),iE.debug("create an unmuted track ".concat(_t.id," from the original track ").concat(_e.id," to get the volume"));const Wt=this.context.createMediaStreamSource(new MediaStream([_t]));$I(Wt),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(Wt)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function hK($,_e,_t){const Wt=(_i,_s)=>_i?typeof _i!="number"?_i.max||_i.exact||_i.ideal||_i.min||_s:_i:_s,_n={audio:!!_t&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:$,maxHeight:Wt(_e.height,1080),maxWidth:Wt(_e.width,1920)}}};return _e.frameRate&&typeof _e.frameRate!="number"?(_n.video.mandatory.maxFrameRate=_e.frameRate.max,_n.video.mandatory.minFrameRate=_e.frameRate.min):typeof _e.frameRate=="number"&&(_n.video.mandatory.maxFrameRate=_e.frameRate),await navigator.mediaDevices.getUserMedia(_n)}async function zde($,_e){const _t=await pK($.mediaSource),{sourceId:Wt,audio:_n}=await function(_i){let _s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new n_((_c,_u)=>{const _h=document.createElement("div");_h.innerText="share screen",_h.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const _p=document.createElement("div");_p.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const Qm=document.createElement("div");Qm.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",Qm.setAttribute("style","height: 12%;");const _g=document.createElement("div");_g.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const eE=document.createElement("div");eE.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const pE=document.createElement("button");pE.innerHTML="cancel",pE.setAttribute("style","width: 85px;"),pE.onclick=()=>{document.body.removeChild(fE);const gE=new Error("NotAllowedError");gE.name="NotAllowedError",_u(gE)};let aE=_s;const cE=document.createElement("div");if(_s){const gE=document.createElement("input");gE.setAttribute("type","checkbox");const AE=document.createElement("span");gE.setAttribute("style","margin-right: 6px;"),AE.innerText="Share audio",gE.checked=aE,gE.onchange=()=>{aE=gE.checked},cE.appendChild(gE),cE.appendChild(AE)}eE.appendChild(cE),eE.appendChild(pE),_p.appendChild(Qm),_p.appendChild(_g),_p.appendChild(eE);const fE=document.createElement("div");fE.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),fE.appendChild(_h),fE.appendChild(_p),document.body.appendChild(fE),_i.map(gE=>{if(gE.id){const AE=document.createElement("div");AE.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let PE=gE.thumbnail;try{const{width:xE}=PE.getSize();xE>1920&&(PE=PE.resize({width:1920}))}catch(xE){throw xE&&xE.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),xE}AE.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+PE.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+gE.name.replace(/[\u00A0-\u9999<>\&]/g,function(xE){return"&#"+xE.charCodeAt(0)+";"})+"</span>",AE.onclick=()=>{document.body.removeChild(fE),_c({sourceId:gE.id,audio:aE})},_g.appendChild(AE)}})})}(_t,_e);return await hK(Wt,$,_n)}async function pK($){let _e=["window","screen"];$!=="application"&&$!=="window"||(_e=["window"]),$==="screen"&&(_e=["screen"]);const _t=DH();if(!_t)throw console.error("failed to fetch electron, please mount it to window"),new HE(mE.ELECTRON_IS_NULL);let Wt=null;try{var _n;Wt=((_n=_t.desktopCapturer)===null||_n===void 0?void 0:_n.getSources({types:_e}))||_t.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:_e})}catch{Wt=null}Wt&&Wt.then||(Wt=new n_((_i,_s)=>{_t.desktopCapturer.getSources({types:_e},(_c,_u)=>{_c?_s(_c):_i(_u)})}));try{return await Wt}catch(_i){throw new HE(mE.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,_i.toString())}}const K6=new mS("safari");let fK=!1,mK=!1;async function OT($,_e){let _t=0,Wt=null;for(;_t<2;)try{Wt=await Kde($,_e,_t>0);break}catch(_n){if(_n instanceof HE)throw iE.error("[".concat(_e,"] ").concat(_n.toString())),_n;const _i=lM(_n.name||_n.code||_n,_n.message);if(_i.code===mE.MEDIA_OPTION_INVALID){iE.debug("[".concat(_e,"] detect media option invalid, retry")),_t+=1,await hS(500);continue}throw iE.error("[".concat(_e,"] ").concat(_i.toString())),_i}if(!Wt)throw new HE(mE.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return Wt}async function Kde($,_e,_t){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new HE(mE.NOT_SUPPORTED,"can not find getUserMedia");_t&&($.video&&(delete $.video.width,delete $.video.height),$.screen&&(delete $.screen.width,delete $.screen.height));const Wt=B_(),_n=new MediaStream;if($.audioSource&&_n.addTrack($.audioSource),$.videoSource&&_n.addTrack($.videoSource),!$.audio&&!$.video&&!$.screen)return iE.debug("Using Video Source/ Audio Source"),_n;if($.screen)if(DH())$.screen.sourceId?rN(_n,await hK($.screen.sourceId,$.screen,$.screenAudio)):rN(_n,await zde($.screen,$.screenAudio));else if(H1()&&$.screen.extensionId&&$.screen.mandatory){if(!Wt.getStreamFromExtension)throw new HE(mE.NOT_SUPPORTED,"This browser does not support screen sharing");iE.debug("[".concat(_e,'] Screen access on chrome stable, looking for extension"'));const _g=await(_s=$.screen.extensionId,_c=_e,new n_((eE,pE)=>{try{chrome.runtime.sendMessage(_s,{getStream:!0},aE=>{if(!aE||!aE.streamId)return iE.error("[".concat(_c,"] No response from Chrome Plugin. Plugin not installed properly"),aE),void pE(new HE(mE.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));eE(aE.streamId)})}catch(aE){iE.error("[".concat(_c,"] AgoraRTC screensharing plugin is not accessible(").concat(_s,")"),aE.toString()),pE(new HE(mE.CHROME_PLUGIN_NOT_INSTALL))}}));$.screen.mandatory.chromeMediaSourceId=_g,rN(_n,await navigator.mediaDevices.getUserMedia({video:{mandatory:$.screen.mandatory}}))}else if(Wt.getDisplayMedia){var _i;$.screen.mediaSource&&rK($.screen.mediaSource);const _g={width:$.screen.width,height:$.screen.height,frameRate:$.screen.frameRate,displaySurface:(_i=$.screen.displaySurface)!==null&&_i!==void 0?_i:$.screen.mediaSource==="screen"?"monitor":$.screen.mediaSource},{selfBrowserSurface:eE,surfaceSwitching:pE,systemAudio:aE}=$.screen,cE={selfBrowserSurface:eE,surfaceSwitching:pE,systemAudio:aE};!eE&&delete cE.selfBrowserSurface,!pE&&delete cE.surfaceSwitching,!aE&&delete cE.systemAudio,iE.debug("[".concat(_e,"] getDisplayMedia:"),JSON.stringify({video:_g,audio:!!$.screenAudio,controls:cE})),rN(_n,await navigator.mediaDevices.getDisplayMedia(O0({video:_g,audio:!!$.screenAudio},cE)))}else{if(!h0())throw iE.error("[".concat(_e,"] This browser does not support screenSharing")),new HE(mE.NOT_SUPPORTED,"This browser does not support screen sharing");{$.screen.mediaSource&&rK($.screen.mediaSource);const _g={video:{mediaSource:$.screen.mediaSource,width:$.screen.width,height:$.screen.height,frameRate:$.screen.frameRate}};iE.debug("[".concat(_e,"] getUserMedia: ").concat(JSON.stringify(_g))),rN(_n,await navigator.mediaDevices.getUserMedia(_g))}}var _s,_c;if(!$.video&&!$.audio)return _n;let _u={video:$.video,audio:$.audio},_h=yE("MEDIA_DEVICE_CONSTRAINTS");if(_h)try{typeof _h=="string"&&(_h=JSON.parse(_h)),_u=bV(_u,_h)}catch{}iE.debug("[".concat(_e,"] GetUserMedia"),JSON.stringify(_u)),W_();let _p,Qm=null;(dS()||PS()||_L())&&(Qm=await K6.lock());try{_p=await navigator.mediaDevices.getUserMedia(_u)}catch(_g){throw Qm&&Qm(),_g}return _u.audio&&(fK=!0),_u.video&&(mK=!0),rN(_n,_p),Qm&&Qm(),_n}function lM($,_e){switch($){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new HE(mE.MEDIA_OPTION_INVALID,"".concat($,": ").concat(_e));case"NotFoundError":case"DevicesNotFoundError":return new HE(mE.DEVICE_NOT_FOUND,"".concat($,": ").concat(_e));case"NotSupportedError":return new HE(mE.NOT_SUPPORTED,"".concat($,": ").concat(_e));case"NotReadableError":return new HE(mE.NOT_READABLE,"".concat($,": ").concat(_e));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new HE(mE.PERMISSION_DENIED,"".concat($,": ").concat(_e));case"ConstraintNotSatisfiedError":return new HE(mE.CONSTRAINT_NOT_SATISFIED,"".concat($,": ").concat(_e));default:return iE.error("getUserMedia unexpected error",$),new HE(mE.UNEXPECTED_ERROR,"".concat($,": ").concat(_e))}}function rN($,_e){const _t=$.getVideoTracks()[0],Wt=$.getAudioTracks()[0],_n=_e.getVideoTracks()[0],_i=_e.getAudioTracks()[0];_i&&(Wt&&$.removeTrack(Wt),$.addTrack(_i)),_n&&(_t&&$.removeTrack(_t),$.addTrack(_n))}const NT=new class extends A0{get state(){return this._state}set state($){$!==this._state&&(this.emit(KI.STATE_CHANGE,$),this._state=$)}constructor(){super(),WE(this,"_state",kP.IDLE),WE(this,"isAccessMicrophonePermission",!1),WE(this,"isAccessCameraPermission",!1),WE(this,"lastAccessMicrophonePermission",!1),WE(this,"lastAccessCameraPermission",!1),WE(this,"checkdeviceMatched",!1),WE(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(yE("ENUMERATE_DEVICES_INTERVAL")||(yL()||vL()===uS.HARMONY_OS)&&W1())&&this.updateDevicesInfo()},yE("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch($=>iE.error($.toString()))}async enumerateDevices($,_e){let _t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new HE(mE.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const Wt=await navigator.mediaDevices.enumerateDevices(),_n=this.checkMediaDeviceInfoIsOk(Wt);let _i=!this.isAccessMicrophonePermission&&$,_s=!this.isAccessCameraPermission&&_e;_n.audio&&(_i=!1),_n.video&&(_s=!1);let _c=null,_u=null,_h=null;if(!_t&&(_i||_s)){if(K6.isLocked&&(iE.debug("[device manager] wait GUM lock"),(await K6.lock())(),iE.debug("[device manager] GUM unlock")),fK&&(_i=!1,this.isAccessMicrophonePermission=!0),mK&&(_s=!1,this.isAccessCameraPermission=!0),iE.debug("[device manager] check media device permissions",$,_e,_i,_s),_i&&_s){try{_h=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(_p){const Qm=lM(_p.name||_p.code||_p,_p.message);if(Qm.code===mE.PERMISSION_DENIED)throw Qm;iE.warning("getUserMedia failed in getDevices",Qm)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(_i){try{_c=await navigator.mediaDevices.getUserMedia({audio:$})}catch(_p){const Qm=lM(_p.name||_p.code||_p,_p.message);if(Qm.code===mE.PERMISSION_DENIED)throw Qm;iE.warning("getUserMedia failed in getDevices",Qm)}this.isAccessMicrophonePermission=!0}else if(_s){try{_u=await navigator.mediaDevices.getUserMedia({video:_e})}catch(_p){const Qm=lM(_p.name||_p.code||_p,_p.message);if(Qm.code===mE.PERMISSION_DENIED)throw Qm;iE.warning("getUserMedia failed in getDevices",Qm)}this.isAccessCameraPermission=!0}iE.debug("[device manager] mic permission",$,"cam permission",_e)}try{const _p=await navigator.mediaDevices.enumerateDevices();return _c&&_c.getTracks().forEach(Qm=>Qm.stop()),_u&&_u.getTracks().forEach(Qm=>Qm.stop()),_h&&_h.getTracks().forEach(Qm=>Qm.stop()),_c=null,_u=null,_h=null,_p}catch(_p){return _c&&_c.getTracks().forEach(Qm=>Qm.stop()),_u&&_u.getTracks().forEach(Qm=>Qm.stop()),_h&&_h.getTracks().forEach(Qm=>Qm.stop()),_c=null,_u=null,_h=null,new HE(mE.ENUMERATE_DEVICES_FAILED,_p.toString()).throw()}}async getRecordingDevices(){let $=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,$)).filter(_e=>_e.kind==="audioinput")}async getCamerasDevices(){let $=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,$)).filter(_e=>_e.kind==="videoinput")}async getSpeakers(){let $=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,$)).filter(_e=>_e.kind==="audiooutput")}searchDeviceIdByName($){let _e=null;return this.deviceInfoMap.forEach(_t=>{_t.device.label===$&&(_e=_t.device.deviceId)}),_e}async getDeviceById($){const _e=(await this.enumerateDevices(!0,!0,!0)).find(_t=>_t.deviceId===$);if(!_e)throw new HE(mE.DEVICE_NOT_FOUND,"deviceId: ".concat($));return _e}async init(){this.state=kP.INITING;try{await this.updateDevicesInfo(),this.state=kP.INITEND}catch($){throw iE.warning("Device Detection functionality cannot start properly.",$.toString()),this.state=kP.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new HE(mE.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),$}}async updateDevicesInfo(){const $=await this.enumerateDevices(!0,!0,!0),_e=Date.now(),_t=[];if($[0]&&$[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const _n=$.find(_s=>_s.kind==="audioinput"&&_s.deviceId==="default"),_i=$.find(_s=>_s.kind==="audiooutput"&&_s.deviceId==="default");_n&&_i?_i.groupId===_n.groupId?iE.debug("[device-check] default input ".concat(_n.label," and output ").concat(_i.label," is the same group")):iE.warning("[device-check] default input ".concat(_n.label," and output ").concat(_i.label," is not the same group")):iE.debug("[device-check] default input or output not found")}const Wt=this.checkMediaDeviceInfoIsOk($);if($.forEach(_n=>{if(!_n.deviceId)return;const _i=this.deviceInfoMap.get("".concat(_n.kind,"_").concat(_n.deviceId));if((_i?_i.state:"INACTIVE")!=="ACTIVE"){const _s={initAt:_e,updateAt:_e,device:_n,state:"ACTIVE"};this.deviceInfoMap.set("".concat(_n.kind,"_").concat(_n.deviceId),_s),_t.push(_s)}_i&&(_i.updateAt=_e)}),this.deviceInfoMap.forEach((_n,_i)=>{_n.state==="ACTIVE"&&_n.updateAt!==_e&&(_n.state="INACTIVE",_t.push(_n))}),this.state!==kP.INITEND)return Wt.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(Wt.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));_t.forEach(_n=>{switch(_n.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(KI.RECORDING_DEVICE_CHANGED,_n);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(KI.CAMERA_DEVICE_CHANGED,_n);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(KI.PLAYOUT_DEVICE_CHANGED,_n)}}),Wt.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),Wt.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk($){const _e=$.filter(_n=>_n.kind==="audioinput"),_t=$.filter(_n=>_n.kind==="videoinput"),Wt={audio:!1,video:!1};for(const _n of _e)if(_n.label&&_n.deviceId){Wt.audio=!0;break}for(const _n of _t)if(_n.label&&_n.deviceId){Wt.video=!0;break}return Wt}};let $6=!1;const PT=new class extends A0{constructor(){super(...arguments),WE(this,"onAutoplayFailed",void 0),WE(this,"onAudioAutoplayFailed",void 0)}};function gK(){if(W_(),!$6){const $=_e=>{_e.preventDefault(),$6=!1,XN()?document.body.removeEventListener("click",$,!0):(document.body.removeEventListener("touchstart",$,!0),document.body.removeEventListener("mousedown",$,!0))};$6=!0,XN()?document.body.addEventListener("click",$,!0):(document.body.addEventListener("touchstart",$,!0),document.body.addEventListener("mousedown",$,!0)),iE.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),PT.onAutoplayFailed?PT.onAutoplayFailed():PT.onAudioAutoplayFailed?iE.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):iE.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),PT.emit("autoplay-failed")}}function EK($,_e,_t,Wt){if(!$)return;const _n=p_.getBaseInfoBySessionId($);if(!_n)return;const _i=_n.info,_s=Date.now(),_c=O0(O0({},_i),{},{vid:_i.vid===void 0?0:Number(_i.vid),lts:_s,elapse:_s-_n.startTime,cbRegistered:PT.onAutoplayFailed||PT.onAudioAutoplayFailed?1:-1,errorMsg:_t,mediaType:_e,trackId:Wt,extend:void 0});p_.send({type:L0.AUTOPLAY_FAILED,data:_c},!0)}const $de=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],rT=new class{constructor(){WE(this,"onAutoplayFailed",void 0),WE(this,"elementMap",new Map),WE(this,"elementStateMap",new Map),WE(this,"elementsNeedToResume",[]),WE(this,"sinkIdMap",new Map),WE(this,"autoResumeAfterInterruption",$=>{Array.from(this.elementMap.entries()).forEach(_e=>{let[_t,Wt]=_e;const _n=this.elementStateMap.get(_t),_i=Wt.srcObject.getAudioTracks()[0],_s=_i&&_i.readyState;if(iE.debug("resume after interrupted, ele: ".concat(_n," audio: ").concat(_s," ").concat($)),_s==="live"){if($)return Wt.pause(),void Wt.play();if(c0.curState==="running")return CO()?(Wt.pause(),void Wt.play()):void(_n&&_n==="paused"&&Wt.play())}})}),WE(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach($=>{let[_e,_t]=$;const Wt=_t.srcObject.getAudioTracks()[0];Wt&&Wt.readyState==="live"&&(iE.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),_t.pause(),_t.play())})}),this.autoResumeAudioElement(),c0.on(SS.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),c0.on(SS.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),c0.on(SS.STATE_CHANGE,()=>{PS()&&c0.prevState==="suspended"&&c0.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID($,_e){const _t=this.elementMap.get($);if(this.sinkIdMap.set($,_e),_t)try{await _t.setSinkId(_e)}catch(Wt){throw new HE(mE.PERMISSION_DENIED,"can not set sink id: "+Wt.toString())}}play($,_e,_t,Wt){if(this.elementMap.has(_e))return;const _n=document.createElement("audio");_n.autoplay=!0,_n.srcObject=new MediaStream([$]),this.bindAudioElementEvents(_e,_n),this.elementMap.set(_e,_n),this.elementStateMap.set(_e,HS.INIT),this.setVolume(_e,_t);const _i=this.sinkIdMap.get(_e);if(_i)try{_n.setSinkId(_i).catch(_c=>{iE.warning("[".concat(_e,"] set sink id failed"),_c.toString())})}catch(_c){iE.warning("[".concat(_e,"] set sink id failed"),_c.toString())}const _s=_n.play();_s&&_s.then&&_s.catch(_c=>{Wt&&EK(Wt,"audio",_c.message,_e),iE.warning("audio element play warning",_c.toString()),this.elementMap.has(_e)&&_c.name==="NotAllowedError"&&(iE.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(_n),SL(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),gK()}))})}updateTrack($,_e){const _t=this.elementMap.get($);_t&&(_t.srcObject=new MediaStream([_e]))}isPlaying($){return this.elementMap.has($)&&this.elementStateMap.get($)==="playing"}setVolume($,_e){const _t=this.elementMap.get($);_t&&(_e=Math.max(0,Math.min(100,_e)),_t.volume=_e/100)}stop($){const _e=this.elementMap.get($);if(this.sinkIdMap.delete($),!_e)return;const _t=this.elementsNeedToResume.indexOf(_e);this.elementsNeedToResume.splice(_t,1),_e.srcObject=null,_e.remove(),this.elementMap.delete($),this.elementStateMap.delete($)}bindAudioElementEvents($,_e){$de.forEach(_t=>{_e.addEventListener(_t,Wt=>{const _n=this.elementStateMap.get($),_i=Wt.type==="pause"?"paused":Wt.type;if(iE.debug("[".concat($,"] audio-element-status change ").concat(_n," => ").concat(_i)),Wt.type==="error"){const _s=_e==null?void 0:_e.error;_s&&iE.error("[".concat($,"] media error, code: ").concat(_s.code,", message: ").concat(_s.message))}this.elementStateMap.set($,_i)})})}getPlayerState($){return this.elementStateMap.get($)||"uninit"}autoResumeAudioElement(){const $=()=>{this.elementsNeedToResume.forEach(_e=>{_e.play().then(_t=>{iE.debug("Auto resume audio element success")}).catch(_t=>{iE.warning("Auto resume audio element failed!",_t)})}),this.elementsNeedToResume=[]};new n_(_e=>{document.body?_e():window.addEventListener("load",()=>_e())}).then(()=>{XN()?document.body.addEventListener("click",$,!0):(document.body.addEventListener("touchstart",$,!0),document.body.addEventListener("mousedown",$,!0))})}};function q0(){return function($,_e,_t){const Wt=_t.value;return typeof Wt=="function"&&(_t.value=function(){this._isClosed&&new HE(mE.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",iE);for(var _n=arguments.length,_i=new Array(_n),_s=0;_s<_n;_s++)_i[_s]=arguments[_s];const _c=Wt.apply(this,_i);return _c instanceof n_?new n_((_u,_h)=>{_c.then(_u).catch(_h)}):_c}),_t}}class vK extends A0{constructor(_e){super(),WE(this,"name","VideoProcessorDestination"),WE(this,"ID","0"),WE(this,"_source",void 0),WE(this,"videoContext",void 0),WE(this,"inputTrack",void 0),this.videoContext=_e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new HE(mE.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new HE(mE.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(_e){if(_e.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);_e.track&&_e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=_e.track,this.emit(ZS.ON_TRACK,_e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(ZS.ON_TRACK,void 0)}}class _K extends A0{set chained(_e){this._chained=_e}get chained(){return this._chained}constructor(_e,_t){super(),WE(this,"constraintsMap",new Map),WE(this,"statsRegistry",[]),WE(this,"usageRegistry",[]),WE(this,"trackId",void 0),WE(this,"direction",void 0),WE(this,"_chained",!1),this.trackId=_e,this.direction=_t}async getConstraints(){return await _y(this,IT.REQUEST_CONSTRAINTS)}async requestApplyConstraints(_e,_t){var Wt;return iE.info("processor ".concat(_t.name," requestApplyConstraints for ").concat(this.trackId)),_e&&this.constraintsMap.set(_t,_e),p0(this,IT.REQUEST_UPDATE_CONSTRAINTS,Array.from(AR(Wt=this.constraintsMap).call(Wt)))}async requestRevertConstraints(_e){var _t;if(this.constraintsMap.has(_e))return iE.info("processor ".concat(_e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(_e),p0(this,IT.REQUEST_UPDATE_CONSTRAINTS,Array.from(AR(_t=this.constraintsMap).call(_t)))}registerStats(_e,_t,Wt){this.statsRegistry.find(_n=>_n.processorID===_e.ID&&_n.processorName===_e.name&&_n.type===_t)||this.statsRegistry.push({processorName:_e.name,processorID:_e.ID,type:_t,cb:Wt})}unregisterStats(_e,_t){const Wt=this.statsRegistry.findIndex(_n=>_n.processorID===_e.ID&&_n.processorName===_e.name&&_n.type===_t);Wt!==-1&&this.statsRegistry.splice(Wt,1)}gatherStats(){const _e=[];for(const{processorID:_t,processorName:Wt,type:_n,cb:_i}of this.statsRegistry)try{const _s=_i();_e.push({processorID:_t,processorName:Wt,type:_n,stats:_s})}catch(_s){iE.error(new HE(mE.UNEXPECTED_ERROR,_s.message))}return _e}registerUsage(_e,_t){this.usageRegistry.find(Wt=>Wt.processorID===_e.ID&&Wt.processorName===_e.name)||this.usageRegistry.push({processorID:_e.ID,processorName:_e.name,cb:_t})}unregisterUsage(_e){const _t=this.usageRegistry.findIndex(Wt=>Wt.processorID===_e.ID&&Wt.processorName===_e.name);_t!==-1&&this.usageRegistry.splice(_t,1)}async gatherUsage(){const _e=[];if(!this.chained)return[];for(const{cb:_t}of this.usageRegistry)try{let Wt=_t();Wt instanceof n_&&(Wt=await Wt),_e.push(O0(O0({},Wt),{},{direction:this.direction}))}catch(Wt){iE.error("gather extension usage error",Wt)}return _e}getDirection(){return this.direction}}class yK extends A0{constructor(_e){super(),WE(this,"name","AudioProcessorDestination"),WE(this,"ID","0"),WE(this,"inputTrack",void 0),WE(this,"inputNode",void 0),WE(this,"audioProcessorContext",void 0),WE(this,"_source",void 0),this.audioProcessorContext=_e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new HE(mE.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new HE(mE.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(ZS.ON_TRACK,void 0),this.emit(ZS.ON_NODE,void 0)}updateInput(_e){if(_e.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);_e.track&&this.inputTrack!==_e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=_e.track,this.emit(ZS.ON_TRACK,this.inputTrack)),_e.node&&this.inputNode!==_e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=_e.node,this.emit(ZS.ON_NODE,this.inputNode))}}class bK extends A0{set chained(_e){this._chained=_e}get chained(){return this._chained}constructor(_e,_t,Wt){super(),WE(this,"constraintsMap",new Map),WE(this,"statsRegistry",[]),WE(this,"audioContext",void 0),WE(this,"trackId",void 0),WE(this,"direction",void 0),WE(this,"usageRegistry",[]),WE(this,"_chained",!1),this.audioContext=_e,this.trackId=_t,this.direction=Wt}async getConstraints(){return _y(this,IT.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(_e,_t){var Wt;return iE.info("processor ".concat(_t.name," requestApplyConstraints for ").concat(this.trackId)),_e&&this.constraintsMap.set(_t,_e),p0(this,IT.REQUEST_UPDATE_CONSTRAINTS,Array.from(AR(Wt=this.constraintsMap).call(Wt)))}async requestRevertConstraints(_e){var _t;if(this.constraintsMap.has(_e))return this.constraintsMap.delete(_e),p0(this,IT.REQUEST_UPDATE_CONSTRAINTS,Array.from(AR(_t=this.constraintsMap).call(_t)))}registerStats(_e,_t,Wt){this.statsRegistry.find(_n=>_n.processorID===_e.ID&&_n.processorName===_e.name&&_n.type===_t)||this.statsRegistry.push({processorName:_e.name,processorID:_e.ID,type:_t,cb:Wt})}unregisterStats(_e,_t){const Wt=this.statsRegistry.findIndex(_n=>_n.processorID===_e.ID&&_n.processorName===_e.name&&_n.type===_t);Wt!==-1&&this.statsRegistry.splice(Wt,1)}gatherStats(){const _e=[];for(const{processorID:_t,processorName:Wt,type:_n,cb:_i}of this.statsRegistry)try{const _s=_i();_e.push({processorID:_t,processorName:Wt,type:_n,stats:_s})}catch(_s){iE.error(new HE(mE.UNEXPECTED_ERROR,_s.message))}return _e}registerUsage(_e,_t){this.usageRegistry.find(Wt=>Wt.processorID===_e.ID&&Wt.processorName===_e.name)||this.usageRegistry.push({processorID:_e.ID,processorName:_e.name,cb:_t})}unregisterUsage(_e){const _t=this.usageRegistry.findIndex(Wt=>Wt.processorID===_e.ID&&Wt.processorName===_e.name);_t!==-1&&this.usageRegistry.splice(_t,1)}async gatherUsage(){const _e=[];if(!this.chained)return[];for(const{cb:_t}of this.usageRegistry)try{let Wt=_t();Wt instanceof n_&&(Wt=await Wt),_e.push(O0(O0({},Wt),{},{direction:this.direction}))}catch(Wt){iE.error("gather extension usage error",Wt)}return _e}getDirection(){return this.direction}}class Y6 extends A0{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),WE(this,"context",void 0),WE(this,"processSourceNode",void 0),WE(this,"outputTrack",void 0),WE(this,"processedNode",void 0),WE(this,"clonedTrack",void 0),WE(this,"outputNode",void 0),this.outputNode=new Yde}setVolume(){}createOutputTrack(){throw new HE(mE.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Yde{disconnect(){}connect(){}}function SK($){return new n_((_e,_t)=>{let Wt=!1;const _n=document.createElement("video");_n.setAttribute("autoplay",""),_n.setAttribute("muted",""),_n.muted=!0,_n.autoplay=!0,_n.setAttribute("playsinline",""),_n.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(_n);const _i=PS()?"canplay":"playing";_n.addEventListener(_i,()=>{const _s=_n.videoWidth,_c=_n.videoHeight;!_s&&h0()||(Wt=!0,_n.srcObject=null,_n.remove(),_e([_s,_c]))}),_n.srcObject=new MediaStream([$]),_n.play().catch(TL),setTimeout(()=>{Wt||(_n.srcObject=null,_n.remove(),_e([_n.videoWidth,_n.videoHeight]))},4e3)})}function uM($){const _e={};$.facingMode&&(_e.facingMode=$.facingMode),$.cameraId&&(_e.deviceId={exact:$.cameraId});const _t=i1($.encoderConfig);return _t.width!=null&&(_e.width=_t.width),_t.height!=null&&(_e.height=_t.height),!CH()&&_t.frameRate&&(_e.frameRate=_t.frameRate),gH()&&typeof _e.frameRate=="object"&&(_e.frameRate.max=60),h0()&&(_e.frameRate={ideal:30,max:30}),_e}function TK($){const _e={};if(CH()||($.AGC!==void 0&&(_e.autoGainControl=$.AGC),$.AEC!==void 0&&(_e.echoCancellation=$.AEC),$.ANS!==void 0&&(_e.noiseSuppression=$.ANS,H1()&&$.ANS&&(_e.googHighpassFilter=$.ANS))),$.encoderConfig){const _t=aM($.encoderConfig);_e.channelCount=_t.stereo?2:1,_e.sampleRate=_t.sampleRate,_e.sampleSize=_t.sampleSize}return $.microphoneId&&(_e.deviceId={exact:$.microphoneId}),yL()&&(_e.sampleRate=void 0),_e}const Jde=$=>{const _e=$._encoderConfig;if(!_e)return;const{frameRate:_t,width:Wt,height:_n}=$.getMediaStreamTrackSettings();let{frameRate:_i=_t,width:_s=Wt,height:_c=_n}=_e;if(!_i||!_s||!_c)return;_s=SV(_s),_c=SV(_c),_i=SV(_i);const{max:_u,min:_h}=function(eE,pE,aE){const cE=200*Math.pow(aE/15,.6)*Math.pow(eE*pE/640/360,.75);return{min:Math.floor(cE),max:Math.floor(4*cE)}}(_s,_c,_i),{bitrateMax:_p,bitrateMin:Qm}=_e||{};_p||iE.debug("calculate bitrate: [w: ".concat(_s,", h: ").concat(_c,", fps: ").concat(_i,"] => [brMax: ").concat(_p,", brMin: ").concat(Qm,"]"));const{maxFramerate:_g}=yE("ENCODER_CONFIG_LIMIT");return _g&&typeof _g=="number"&&(_i=Math.min(_i,_g)),{frameRate:_i,bitrateMax:_p||_u,bitrateMin:Qm||_h,scaleResolutionDownBy:1,scale:0}},wK=async($,_e,_t)=>await(async(Wt,_n,_i)=>{const _s=function(_h){const _p=[];for(let Qm=0;Qm<_h.length;Qm+=2)_p.push(parseInt(_h.slice(Qm,Qm+2),16));return Uint8Array.from(_p)}(qH(""+_n+_i)).slice(0,16),_c=_s.slice(0,12),_u=await window.crypto.subtle.importKey("raw",_s,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:_c},_u,Wt))})($.buffer,_e,_t),J6=$=>{const _e=document.createElement("canvas");return _e.width=2,_e.height=2,new n_((_t,Wt)=>{_e.toBlob(async _n=>{if(_e.remove(),_n){const _i=await RK(_n);_t({buffer:_i,width:_e.width,height:_e.height})}else Wt(new HE(mE.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},$,1)})},RK=async $=>{const _e=await $.arrayBuffer();return new Uint8Array(_e)};var CK,IK,AK,OK,NK,PK,kK,DK,LK,xK,MK,UK,jK,FK,VK,BK,GK,HK,x0,WK,qK,zK,KK,$K,YK,s1,JK,XK,ZK,QK,e$,t$,n$,r$,i$,o$,s$,a$,c$,AS;let V0=(CK=__({argsMap:($,_e)=>[$.getTrackId(),_e],throttleTime:300}),IK=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),AK=q0(),OK=OO("LocalAudioTrack","_enabledMutex"),NK=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),PK=q0(),kK=OO("LocalAudioTrack","_enabledMutex"),DK=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),LK=q0(),xK=q0(),MK=q0(),UK=__({argsMap:$=>[$.getTrackId()]}),jK=q0(),FK=__({argsMap:$=>[$.getTrackId()]}),VK=q0(),BK=__({argsMap:$=>[$.getTrackId()]}),GK=__({argsMap:($,_e)=>[$.getTrackId(),_e.name]}),HK=__({argsMap:$=>[$.getTrackId()]}),G_((x0=class extends tN{get _source(){return this.initWebAudio()}set _source($){this._trackSource=$}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?rT.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor($,_e,_t,Wt){super($,_t),WE(this,"trackMediaType","audio"),WE(this,"_encoderConfig",void 0),WE(this,"_trackSource",void 0),WE(this,"_enabled",!0),WE(this,"_volume",100),WE(this,"_useAudioElement",!0),WE(this,"_bypassWebAudio",!1),WE(this,"processor",void 0),WE(this,"_processorContext",void 0),WE(this,"_processorDestination",void 0),WE(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=_e,this._getOriginVolumeLevel=!!Wt,this._trackSource=new Y6,yE("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),yE("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),dS()&&!AT?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume($){u0($,"volume",0,1e3),this._volume=$,this._source.setVolume($/100),this._useAudioElement&&rT.setVolume(this.getTrackId(),$);try{if(this._bypassWebAudio)return void iE.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const _e=this._source.createOutputTrack();this._mediaStreamTrack!==_e&&(this._mediaStreamTrack=_e,p0(this,a_.NEED_REPLACE_TRACK,this).then(()=>{iE.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(_t=>{iE.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),_t)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice($){if(!this._useAudioElement||!nK())throw new HE(mE.NOT_SUPPORTED,"your browser does not support setting the audio output device");await rT.setSinkID(this.getTrackId(),$)}async setEnabled($,_e,_t){return this._setEnabled($,_e,_t)}async _setEnabled($,_e,_t){if(!_t){if($===this._enabled)return;this.stateCheck("enabled",$)}if(iE.info("[".concat(this.getTrackId(),"] start setEnabled"),$),$){this._originMediaStreamTrack.enabled=!0;try{_t||(this._enabled=!0),await p0(this,a_.NEED_ENABLE_TRACK,this),iE.info("[".concat(this.getTrackId(),"] setEnabled to ").concat($," success"))}catch(Wt){throw _t||(this._enabled=!1),iE.error("[".concat(this.getTrackId(),"] setEnabled to true error"),Wt.toString()),Wt}}else{this._originMediaStreamTrack.enabled=!1,_t||(this._enabled=!1);try{await p0(this,a_.NEED_DISABLE_TRACK,this)}catch(Wt){throw _t||(this._enabled=!0),iE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),Wt.toString()),Wt}}}async setMuted($){$!==this._muted&&(this.stateCheck("muted",$),this._muted=$,this._originMediaStreamTrack.enabled=!$,iE.debug("[".concat(this.getTrackId(),"] start set muted: ").concat($)),$?await p0(this,a_.NEED_MUTE_TRACK,this):await p0(this,a_.NEED_UNMUTE_TRACK,this))}getStats(){return q1(()=>{iE.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),mT(this,a_.GET_STATS)||O0({},G6)}setAudioFrameCallback($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!$)return this._source.removeAllListeners(CT.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(_e),this._source.removeAllListeners(CT.ON_AUDIO_BUFFER),this._source.on(CT.ON_AUDIO_BUFFER,_t=>$(_t))}play(){iE.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(iE.debug("[".concat(this.getTrackId(),"] start audio playback in element")),rT.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){iE.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?rT.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let $=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];iE.debug("[".concat(this.getTrackId(),"] update player source track")),$&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&rT.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack($,_e){this._originMediaStreamTrack!==$&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),_e&&this._originMediaStreamTrack.stop()),$.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=$,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:$,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await p0(this,a_.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack($))}renewMediaStreamTrack($){return n_.resolve(void 0)}pipe($){if(this._bypassWebAudio)throw new HE(mE.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===$)return $;if($._source)throw new HE(mE.INVALID_OPERATION,"Processor ".concat($.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=$,this.processor._source=this,$.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),$}unpipe(){var $;if(!this.processor)return;const _e=this.processor;($=this._source.processSourceNode)===null||$===void 0||$.disconnect(),this.processor._source=!1,this.processor=void 0,_e.reset()}bindProcessorDestinationEvents($){$.on(ZS.ON_TRACK,async _e=>{_e?_e!==this._mediaStreamTrack&&(this._mediaStreamTrack=_e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(_e),await p0(this,a_.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await p0(this,a_.NEED_REPLACE_TRACK,this))}),$.on(ZS.ON_NODE,_e=>{this._source.processedNode=_e})}unbindProcessorDestinationEvents($){$.removeAllListeners(ZS.ON_TRACK),$.removeAllListeners(ZS.ON_NODE)}bindProcessorContextEvents($){$.on(IT.REQUEST_CONSTRAINTS,async _e=>{_e(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents($){$.removeAllListeners(IT.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof Y6&&(this._trackSource=new dK(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const $=new bK(this._source.context,this.getTrackId(),"local"),_e=new yK($);return this._processorContext=$,this._processorDestination=_e,this.bindProcessorContextEvents($),this.bindProcessorDestinationEvents(_e),this._source.on(CT.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:$})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(rT.stop(this.getTrackId()),this._source.play()),p0(this,a_.NEED_REPLACE_MIXING_TRACK,this).then(()=>{iE.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(_t=>{iE.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),_t)})),{processorContext:$,processorDestination:_e}}}).prototype,"setVolume",[CK],Object.getOwnPropertyDescriptor(x0.prototype,"setVolume"),x0.prototype),G_(x0.prototype,"setPlaybackDevice",[IK,AK],Object.getOwnPropertyDescriptor(x0.prototype,"setPlaybackDevice"),x0.prototype),G_(x0.prototype,"setEnabled",[OK,NK,PK],Object.getOwnPropertyDescriptor(x0.prototype,"setEnabled"),x0.prototype),G_(x0.prototype,"setMuted",[kK,DK,LK],Object.getOwnPropertyDescriptor(x0.prototype,"setMuted"),x0.prototype),G_(x0.prototype,"getStats",[xK],Object.getOwnPropertyDescriptor(x0.prototype,"getStats"),x0.prototype),G_(x0.prototype,"setAudioFrameCallback",[MK],Object.getOwnPropertyDescriptor(x0.prototype,"setAudioFrameCallback"),x0.prototype),G_(x0.prototype,"play",[UK,jK],Object.getOwnPropertyDescriptor(x0.prototype,"play"),x0.prototype),G_(x0.prototype,"stop",[FK,VK],Object.getOwnPropertyDescriptor(x0.prototype,"stop"),x0.prototype),G_(x0.prototype,"close",[BK],Object.getOwnPropertyDescriptor(x0.prototype,"close"),x0.prototype),G_(x0.prototype,"pipe",[GK],Object.getOwnPropertyDescriptor(x0.prototype,"pipe"),x0.prototype),G_(x0.prototype,"unpipe",[HK],Object.getOwnPropertyDescriptor(x0.prototype,"unpipe"),x0.prototype),x0),dM=(WK=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),qK=q0(),zK=OO("MicrophoneAudioTrack","_enabledMutex"),KK=__({argsMap:($,_e,_t)=>[$.getTrackId(),_e,_t]}),$K=q0(),YK=__({argsMap:$=>[$.getTrackId()]}),G_((s1=class extends V0{get __className__(){return"MicrophoneAudioTrack"}constructor($,_e,_t,Wt){super($,_e.encoderConfig?aM(_e.encoderConfig):{},Wt,yE("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),WE(this,"_config",void 0),WE(this,"_deviceName","default"),WE(this,"_constraints",void 0),WE(this,"_originalConstraints",void 0),WE(this,"_enabled",!0),this._config=_e,this._constraints=_t,this._originalConstraints=_t,this._deviceName=$.label,typeof _e.bypassWebAudio=="boolean"&&(this._bypassWebAudio=_e.bypassWebAudio),(CO()||mV())&&c0.bindInterruptDetectorTrack(this)}async setDevice($){if(iE.info("[".concat(this.getTrackId(),"] start set device to ").concat($)),this._enabled)try{const _e=await NT.getDeviceById($),_t={};_t.audio=O0({},this._constraints),_t.audio.deviceId={exact:$},this._originMediaStreamTrack.stop();let Wt=null;try{Wt=await OT(_t,this.getTrackId())}catch(_n){throw iE.error("[".concat(this.getTrackId(),"] setDevice failed"),_n.toString()),Wt=await OT({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(Wt.getAudioTracks()[0],!1),_n}await this._updateOriginMediaStreamTrack(Wt.getAudioTracks()[0],!1),this._deviceName=_e.label,this._config.microphoneId=$,this._constraints.deviceId={exact:$}}catch(_e){throw iE.error("[".concat(this.getTrackId(),"] setDevice error"),_e.toString()),_e}else try{const _e=await NT.getDeviceById($);this._deviceName=_e.label,this._config.microphoneId=$,this._constraints.deviceId={exact:$}}catch(_e){throw iE.error("[".concat(this.getTrackId(),"] setDevice error"),_e.toString()),_e}iE.info("[".concat(this.getTrackId(),"] set device to ").concat($," success"))}async setEnabled($,_e,_t){if(_e)return iE.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled($);if(!_t){if($===this._enabled)return;this.stateCheck("enabled",$)}if(iE.info("[".concat(this.getTrackId(),"] start setEnabled"),$),yE("AUTO_RESET_AUDIO_ROUTE")&&(PS()||tR())){const _s=navigator.audioSession;_s&&($||(_s.type="playback"),_s.type="auto")}if(!$){var Wt;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(Wt=this._source.clonedTrack)===null||Wt===void 0||Wt.stop(),_t||(this._enabled=!1);try{await p0(this,a_.NEED_DISABLE_TRACK,this)}catch(_s){throw iE.error("[".concat(this.getTrackId(),"] setEnabled false failed"),_s.toString()),_s}return}const _n=O0({},this._constraints),_i=NT.searchDeviceIdByName(this._deviceName);_i&&!_n.deviceId&&(_n.deviceId=_i);try{_t||(this._enabled=!0);const _s=await OT({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(_s.getAudioTracks()[0],!1),await p0(this,a_.NEED_ENABLE_TRACK,this)}catch(_s){throw _t||(this._enabled=!1),iE.error("[".concat(this.getTrackId(),"] setEnabled true failed"),_s.toString()),_s}iE.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(CO()||mV())&&c0.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((PS()||tR())&&this._enabled&&!this._isClosed&&c0.duringInterruption){const $=async()=>{c0.off(SS.IOS_INTERRUPTION_END,$),this._enabled&&!this._isClosed&&(iE.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};c0.on(SS.IOS_INTERRUPTION_END,$)}else iE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(QO.TRACK_ENDED)}async renewMediaStreamTrack($){const _e=$||this._constraints,_t=NT.searchDeviceIdByName(this._deviceName);if(_t&&!_e.deviceId&&(_e.deviceId=_t),this._constraints=_e,this._enabled){this._originMediaStreamTrack.stop();const Wt=await OT({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(Wt.getAudioTracks()[0],!0)}}bindProcessorContextEvents($){super.bindProcessorContextEvents($),$.on(IT.REQUEST_UPDATE_CONSTRAINTS,async(_e,_t,Wt)=>{try{const _n=Object.assign({},this._originalConstraints,..._e);await this.renewMediaStreamTrack(_n),_t()}catch(_n){Wt(_n)}})}unbindProcessorContextEvents($){super.unbindProcessorContextEvents($),$.removeAllListeners(IT.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[WK,qK],Object.getOwnPropertyDescriptor(s1.prototype,"setDevice"),s1.prototype),G_(s1.prototype,"setEnabled",[zK,KK,$K],Object.getOwnPropertyDescriptor(s1.prototype,"setEnabled"),s1.prototype),G_(s1.prototype,"close",[YK],Object.getOwnPropertyDescriptor(s1.prototype,"close"),s1.prototype),s1),Xde=(JK=__({argsMap:($,_e)=>[$.getTrackId(),_e,$.duration]}),XK=q0(),ZK=__({argsMap:$=>[$.getTrackId()]}),QK=q0(),e$=__({argsMap:$=>[$.getTrackId()]}),t$=q0(),n$=__({argsMap:$=>[$.getTrackId()]}),r$=q0(),i$=__({argsMap:$=>[$.getTrackId()]}),o$=q0(),s$=__({argsMap:$=>[$.getTrackId()]}),a$=__({argsMap:$=>[$.getTrackId()]}),c$=q0(),G_((AS=class extends V0{get __className__(){return"BufferSourceAudioTrack"}constructor($,_e,_t,Wt){super(_e.createOutputTrack(),_t,Wt),WE(this,"source",void 0),WE(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=$,this._bufferSource=_e,this._bufferSource.on(CT.AUDIO_SOURCE_STATE_CHANGE,_n=>{this.safeEmit(QO.SOURCE_STATE_CHANGE,_n)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer($){$&&this._bufferSource.updateOptions($),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer($){this._bufferSource.seekAudioBuffer($)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed($){u0($,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed($)}}).prototype,"startProcessAudioBuffer",[JK,XK],Object.getOwnPropertyDescriptor(AS.prototype,"startProcessAudioBuffer"),AS.prototype),G_(AS.prototype,"pauseProcessAudioBuffer",[ZK,QK],Object.getOwnPropertyDescriptor(AS.prototype,"pauseProcessAudioBuffer"),AS.prototype),G_(AS.prototype,"seekAudioBuffer",[e$,t$],Object.getOwnPropertyDescriptor(AS.prototype,"seekAudioBuffer"),AS.prototype),G_(AS.prototype,"resumeProcessAudioBuffer",[n$,r$],Object.getOwnPropertyDescriptor(AS.prototype,"resumeProcessAudioBuffer"),AS.prototype),G_(AS.prototype,"stopProcessAudioBuffer",[i$,o$],Object.getOwnPropertyDescriptor(AS.prototype,"stopProcessAudioBuffer"),AS.prototype),G_(AS.prototype,"close",[s$],Object.getOwnPropertyDescriptor(AS.prototype,"close"),AS.prototype),G_(AS.prototype,"setAudioBufferPlaybackSpeed",[a$,c$],Object.getOwnPropertyDescriptor(AS.prototype,"setAudioBufferPlaybackSpeed"),AS.prototype),AS);class iS extends V0{get __className__(){return"MixingAudioTrack"}get isActive(){for(const _e of this.trackList)if(_e._enabled&&!_e._isClosed&&!_e.muted)return!0;return!1}constructor(){const _e=nN().createMediaStreamDestination();super(_e.stream.getAudioTracks()[0],void 0,f0(8,"track-mix-")),WE(this,"trackList",void 0),WE(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=_e,this.trackList=[]}hasAudioTrack(_e){return this.trackList.indexOf(_e)!==-1}addAudioTrack(_e){this.trackList.indexOf(_e)===-1?(iE.debug("add ".concat(_e.getTrackId()," to mixing track")),_e._source.outputNode.connect(this.destNode),this.trackList.push(_e),this.updateEncoderConfig()):iE.debug("track ".concat(_e.getTrackId()," is already added"))}removeAudioTrack(_e){if(this.trackList.indexOf(_e)!==-1){iE.debug("remove ".concat(_e.getTrackId()," from mixing track"));try{_e._source.outputNode.disconnect(this.destNode)}catch{}bL(this.trackList,_e),this.updateEncoderConfig()}}updateEncoderConfig(){const _e={};this.trackList.forEach(_t=>{_t._encoderConfig&&((_t._encoderConfig.bitrate||0)>(_e.bitrate||0)&&(_e.bitrate=_t._encoderConfig.bitrate),(_t._encoderConfig.sampleRate||0)>(_e.sampleRate||0)&&(_e.sampleRate=_t._encoderConfig.sampleRate),(_t._encoderConfig.sampleSize||0)>(_e.sampleSize||0)&&(_e.sampleSize=_t._encoderConfig.sampleSize),_t._encoderConfig.stereo&&(_e.stereo=!0))}),this._encoderConfig=_e}_updateRtpTransceiver(_e){this._rtpTransceiver!==_e&&(this._rtpTransceiver=_e,this.trackList.forEach(_t=>{_t instanceof iS?_t.emit(zI.TRANSCEIVER_UPDATED,_e):_t._updateRtpTransceiver(_e)}))}}class Zde extends uK{set currentState(_e){_e!==this._currentState&&(this._currentState=_e,this.safeEmit(CT.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),WE(this,"audioBuffer",void 0),WE(this,"sourceNode",void 0),WE(this,"startPlayTime",0),WE(this,"startPlayOffset",0),WE(this,"pausePlayTime",0),WE(this,"options",void 0),WE(this,"currentLoopCount",0),WE(this,"currentPlaybackSpeed",100),WE(this,"_currentState","stopped"),this.audioBuffer=_e,this.options=_t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(_e){this.currentState==="stopped"?(this.options=_e,this.startPlayOffset=this.options.startPlayTime||0):iE.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(_e){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=_e,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=_e))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(_e){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=_e/100),this.currentPlaybackSpeed=_e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const _e=this.context.createBufferSource();return _e.buffer=this.audioBuffer,_e.loop=!!this.options.loop,_e.connect(this.outputNode),_e.playbackRate.value=this.currentPlaybackSpeed/100,_e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const l$=new Map;class X6{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const _e=this.renderStats.curTs-this.renderStats.lastTs,_t=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/_e;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,_t}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(_e){_e!==this._videoElementStatus&&(iE.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(_e)),this._videoElementStatus=_e)}get videoState(){return this._videoState}set videoState(_e){var _t;_e!==this._videoState&&(this._videoState=_e,(_t=this.onVideoStateChanged)===null||_t===void 0||_t.call(this,this.videoState))}constructor(_e){WE(this,"trackId",void 0),WE(this,"config",void 0),WE(this,"onFirstVideoFrameDecoded",void 0),WE(this,"onVideoStateChanged",void 0),WE(this,"freezeTimeCounterList",[]),WE(this,"renderFreezeAccTime",0),WE(this,"isKeepLastFrame",!1),WE(this,"timeUpdatedCount",0),WE(this,"freezeTime",0),WE(this,"playbackTime",0),WE(this,"lastTimeUpdatedTime",0),WE(this,"autoplayFailed",!1),WE(this,"videoTrack",void 0),WE(this,"videoElement",void 0),WE(this,"cacheVideoElement",void 0),WE(this,"renderStats",void 0),WE(this,"_videoState",o1.VideoStateStopped),WE(this,"videoElementCheckInterval",void 0),WE(this,"videoElementFreezeTimeout",void 0),WE(this,"_videoElementStatus",HS.NONE),WE(this,"isGettingVideoDimensions",!1),WE(this,"startGetVideoDimensions",()=>{const _t=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return iE.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(_t,500)};!this.isGettingVideoDimensions&&_t()}),WE(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&c0.curState==="running"&&(iE.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(mH())),wH()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),WE(this,"handleVideoEvents",_t=>{switch(_t.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=HS.PLAYING;break;case"loadeddata":if(this.videoState=o1.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=HS.CANPLAY;break;case"stalled":this.videoElementStatus=HS.STALLED;break;case"suspend":this.videoElementStatus=HS.SUSPEND;break;case"pause":this.videoElementStatus=HS.PAUSED,PS()||tR()||dS()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(iE.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=HS.WAITING;break;case"abort":this.videoElementStatus=HS.ABORT;break;case"ended":this.videoElementStatus=HS.ENDED;break;case"emptied":this.videoElementStatus=HS.EMPTIED;break;case"error":{const Wt=this.videoElement.error;Wt?(this.videoElementStatus=HS.ERROR,iE.error("[".concat(this.trackId,"] media error: ").concat(Wt.message," (").concat(Wt.code,")"))):iE.debug("[".concat(this.trackId,"] media not been an error."));break}case"timeupdate":{const Wt=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=Wt);const _n=Wt-this.lastTimeUpdatedTime,_i=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=Wt,I1.lastVisibleTime<I1.lastHiddenTime||_i<I1.lastHiddenTime||_i<I1.lastVisibleTime)return;for(_n>yE("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=_n),this.playbackTime+=_n;this.playbackTime>=6e3;){this.playbackTime-=6e3;const _s=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(_s),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),WE(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(iE.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(mH())),wH()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=_e.trackId,this.config=_e,_e.element instanceof HTMLVideoElement?this.videoElement=_e.element:this.videoElement=document.createElement("video"),c0.on(SS.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),c0.on(SS.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var _e;return(_e=this.videoElement.parentElement)!==null&&_e!==void 0?_e:void 0}updateConfig(_e){this.config=_e,this.trackId=_e.trackId,_e.element!==this.videoElement&&(this.destroy(),this.videoElement=_e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(_e){this.videoTrack!==_e&&(this.videoTrack=_e,this.initVideoElement())}play(_e){const _t=this.videoElement.play();_t&&_t.catch&&_t.catch(_n=>{_e&&EK(_e,"video",_n.message,this.trackId),_n.name==="NotAllowedError"?(iE.warning("detected video element autoplay failed",_n),this.autoplayFailed=!0,this.handleAutoPlayFailed()):iE.warning("[".concat(this.trackId,"] play warning: "),_n)});const Wt=W_();if((Wt.name==="Safari"&&Number(Wt.version)===15||CO())&&_t&&_t.then){const _n=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};_t.then(_n).catch(_n)}}getCurrentFrame(){const _e=document.createElement("canvas");_e.width=this.videoElement.videoWidth,_e.height=this.videoElement.videoHeight;const _t=_e.getContext("2d");if(!_t)return iE.error("create canvas context failed!"),new ImageData(2,2);_t.drawImage(this.videoElement,0,0,_e.width,_e.height);const Wt=_t.getImageData(0,0,_e.width,_e.height);return _e.remove(),Wt}async getCurrentFrameToUint8Array(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const Wt=document.createElement("canvas");Wt.width=this.videoElement.videoWidth,Wt.height=this.videoElement.videoHeight;const _n=Wt.getContext("2d");return _n?(_n.drawImage(this.videoElement,0,0,Wt.width,Wt.height),new n_((_i,_s)=>{Wt.toBlob(async _c=>{if(Wt.remove(),_c){const _u=await RK(_c);_i({buffer:_u,width:Wt.width,height:Wt.height})}else _s(new HE(mE.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},_e,_t<0?.1:_t>1?1:_t)})):await J6(_e)}destroy(){this.renderStats=void 0,c0.off(SS.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),c0.off(SS.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=o1.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=HS.INIT,!this.videoElementCheckInterval&&(u$.forEach(_i=>{this.videoElement.addEventListener(_i,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(_i){return _i!==document.body&&document.body.contains(_i)})(this.videoElement)||(this.videoElementStatus=HS.DESTROYED)},1e3),yE("ENABLE_VIDEO_FRAME_CALLBACK"))){var _e,_t;let _i;const _s=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",_s),this.videoElementFreezeTimeout=window.setTimeout(_c,yE("VIDEO_FREEZE_DURATION")))},_c=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===o1.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=o1.VideoStateFrozen:document.addEventListener("visibilitychange",_s))},_u=(_h,_p)=>{if(this.videoElementStatus===HS.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=_p.mediaTime):this.renderStats={lastTs:_p.mediaTime,curTs:_p.mediaTime,lastRenderNum:0,renderNum:0},_i){const eE=_p.presentationTime-_i.presentationTime;this.videoState===o1.VideoStateStarting&&(this.videoState=o1.VideoStateDecoding),this.videoState===o1.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(_c,yE("VIDEO_FREEZE_DURATION"))),eE<yE("VIDEO_FREEZE_DURATION")&&this.videoState===o1.VideoStateFrozen&&(this.videoState=o1.VideoStateDecoding),eE>yE("VIDEO_FREEZE_DURATION")&&I1.lastVisibleTime>=I1.lastHiddenTime&&_i.timestamp>I1.lastVisibleTime&&_i.timestamp>I1.lastHiddenTime&&(this.renderFreezeAccTime+=eE)}_i=O0(O0({},_p),{},{timestamp:_h})}var Qm,_g;yE("ENABLE_VIDEO_FRAME_CALLBACK")&&((Qm=(_g=this.videoElement).requestVideoFrameCallback)===null||Qm===void 0||Qm.call(_g,_u))};(_e=(_t=this.videoElement).requestVideoFrameCallback)===null||_e===void 0||_e.call(_t,_u)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),yL()&&!yE("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const Wt=W_();Wt.name==="Safari"&&Number(Wt.version)===15||CO()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,h0()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,h0()&&this.videoElement.load());const _n=this.videoElement.play();_n!==void 0&&_n.catch(_i=>{iE.debug("[".concat(this.trackId,"] playback interrupted"),_i.toString())})}resetVideoElement(){u$.forEach(_e=>{this.videoElement&&this.videoElement.removeEventListener(_e,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=HS.NONE}handleAutoPlayFailed(){const _e=_t=>{_t.preventDefault(),this.videoElement.play().then(()=>{iE.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(Wt=>{iE.error(Wt)}),this.autoplayFailed=!1,XN()?document.body.removeEventListener("click",_e,!0):(document.body.removeEventListener("touchstart",_e,!0),document.body.removeEventListener("mousedown",_e,!0))};XN()?document.body.addEventListener("click",_e,!0):(document.body.addEventListener("touchstart",_e,!0),document.body.addEventListener("mousedown",_e,!0)),gK()}}const u$=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class d$ extends X6{constructor(_e){super(_e),WE(this,"container",void 0),WE(this,"slot",void 0),this.slot=_e.element,this.updateConfig(_e)}updateConfig(_e){this.config=_e,this.trackId=_e.trackId;const _t=_e.element;_t!==this.slot&&(this.destroy(),this.slot=_t),this.createElements()}updateVideoTrack(_e){this.videoTrack!==_e&&(this.videoTrack=_e,this.createElements())}play(_e){var _t;(_t=this.container)!==null&&_t!==void 0&&_t.contains(this.videoElement)&&super.play(_e)}getCurrentFrame(){var _e;return(_e=this.container)!==null&&_e!==void 0&&_e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(_e){var _t;let Wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(_t=this.container)!==null&&_t!==void 0&&_t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(_e,Wt):await J6(_e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",yE("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var _e;!this.container||(_e=this.container)!==null&&_e!==void 0&&_e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var _e;if((_e=this.container)!==null&&_e!==void 0&&_e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var _e;(_e=this.container)!==null&&_e!==void 0&&_e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var h$,p$,f$,m$,g$,E$,v$,_$,y$,b$,S$,T$,w$,R$,C$,I$,A$,O$,N$,P$,k$,D$,L$,x$,M$,F_,U$,j$,F$,V$,B$,G$,H$,W$,kT;let m0=(h$=__({argsMap:($,_e,_t)=>[$.getTrackId(),typeof _e=="string"?_e:_e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",_t]}),p$=q0(),f$=__({argsMap:$=>[$.getTrackId()]}),m$=OO("LocalVideoTrack","_enabledMutex"),g$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),E$=q0(),v$=OO("LocalVideoTrack","_enabledMutex"),_$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),y$=q0(),b$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),S$=q0(),T$=q0(),w$=__({argsMap:($,_e,_t)=>[$.getTrackId(),_e,_t]}),R$=q0(),C$=q0(),I$=q0(),A$=q0(),O$=q0(),N$=q0(),P$=q0(),k$=__({argsMap:($,_e)=>[$.getTrackId(),_e.name]}),D$=__({argsMap:$=>[$.getTrackId()]}),L$=__({argsMap:$=>[$.getTrackId()]}),x$=__({argsMap:($,_e,_t)=>[$.getTrackId(),_e.label,_t]}),M$=__(),F_=class GJ extends tN{get videoHeight(){if(dS()){const{height:_e}=this._mediaStreamTrack.getSettings();return this._videoHeight=_e,this._videoHeight}return this._videoHeight}get videoWidth(){if(dS()){const{width:_e}=this._mediaStreamTrack.getSettings();return this._videoWidth=_e,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==HS.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(_e){this._processorContext=_e}get __className__(){return"LocalVideoTrack"}constructor(_e,_t,Wt,_n,_i,_s){if(super(_e,_i),WE(this,"trackMediaType","video"),WE(this,"_player",void 0),WE(this,"isUseScaleResolutionDownBy",!1),WE(this,"_videoVisibleTimer",null),WE(this,"_statsTimer",null),WE(this,"_previousVideoVisibleStatus",void 0),WE(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),WE(this,"_encoderConfig",void 0),WE(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),WE(this,"_optimizationMode",void 0),WE(this,"_videoHeight",void 0),WE(this,"_videoWidth",void 0),WE(this,"_forceBitrateLimit",void 0),WE(this,"_enabled",!0),WE(this,"_processorDestination",void 0),WE(this,"_processorContext",void 0),dS()){const{width:_c,height:_u}=_e.getSettings();this._videoWidth=_c,this._videoHeight=_u}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=_t,this._scalabilityMode=Wt,this._optimizationMode=_n,this._hints=_s||[],this._hints.indexOf(S0.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(_c,_u,_h){const _p=W_();return!(_p.name!==_c||!_p.osVersion)&&Number(_p.version)===_u}(t0.CHROME,115)&&vL().indexOf("Windows")!==-1){const _c=function(_u,_h){if("VideoFrame"in window&&"TransformStream"in window&&B_().supportWebRTCInsertableStream){const _p=new MediaStreamTrackProcessor(_u),Qm=new MediaStreamTrackGenerator({kind:"video"});let _g,eE,pE=Date.now();const aE=()=>{cE&&(clearInterval(cE),cE=void 0),_g&&(_g.close(),_g=void 0),_u.stop(),eE=void 0,Qm.removeEventListener("ended",aE)};let cE=window.setInterval(()=>{if(eE&&_g&&Date.now()-pE>1e3)try{Qm.readyState==="live"?eE.enqueue(_g.clone()):aE()}catch{aE()}},1e3);const fE=new TransformStream({transform:(gE,AE)=>{Qm.readyState==="live"?(eE=AE,pE=Date.now(),_g===void 0?(_g=gE,AE.enqueue(gE.clone())):(AE.enqueue(_g),_g=gE)):gE.close()}});return Qm.addEventListener("ended",aE),_p.readable.pipeThrough(fE).pipeTo(Qm.writable),Qm}}(_e);_c&&(iE.info("local screen video track begin to inject frame"),this._mediaStreamTrack=_c)}_t&&this._hints.indexOf(S0.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(_t),this._processorContext=new _K(this.getTrackId(),"local"),this._processorDestination=new vK(this.processorContext),this.bindProcessorDestinationEvents()}play(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof _e=="string"){const _n=document.getElementById(_e);_n?_e=_n:(iE.warning("[".concat(this.getTrackId(),'] can not find "#').concat(_e,'" element, use document.body')),_e=document.body)}iE.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(_e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(_t));const Wt=O0(O0(O0({},this._getDefaultPlayerConfig()),_t),{},{trackId:this.getTrackId(),element:_e});this._player?this._player.updateConfig(Wt):(_e instanceof HTMLVideoElement?this._player=new X6(Wt):this._player=new d$(Wt),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const _n=this.getVideoElementVisibleStatus();this.safeEmit(QO.VIDEO_ELEMENT_VISIBLE_STATUS,_n)}catch{}},yE("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,iE.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(_e,_t){if(!_t){if(_e===this._enabled)return;this.stateCheck("enabled",_e)}if(iE.info("[".concat(this.getTrackId(),"] start setEnabled"),_e),!_e){this._originMediaStreamTrack.enabled=!1;try{await p0(this,a_.NEED_DISABLE_TRACK,this)}catch(Wt){throw iE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),Wt.toString()),Wt}return _t||(this._enabled=!1),void iE.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await p0(this,a_.NEED_ENABLE_TRACK,this)}catch(Wt){throw iE.error("[".concat(this.getTrackId(),"] setEnabled to true error"),Wt.toString()),Wt}iE.info("[".concat(this.getTrackId(),"] setEnabled to true success")),_t||(this._enabled=!0)}async setMuted(_e){_e!==this._muted&&(this.stateCheck("muted",_e),this._muted=_e,this._originMediaStreamTrack.enabled=!_e,iE.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(_e)),_e?await p0(this,a_.NEED_MUTE_TRACK,this):await p0(this,a_.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(_e,_t){if(!this._enabled)throw new HE(mE.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(_e==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),_e=i1(_e),this._forceBitrateLimit&&(_e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:_e.bitrateMax,_e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:_e.bitrateMin),_e.width||_e.height||_e.frameRate){const Wt=uM({encoderConfig:_e});(dS()||PS()||tR())&&(Wt.deviceId=void 0),iE.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(_e),JSON.stringify(Wt));try{await this._originMediaStreamTrack.applyConstraints(Wt),this.updateMediaStreamTrackResolution()}catch(_n){const _i=new HE(mE.UNEXPECTED_ERROR,_n.toString());throw iE.error("[".concat(this.getTrackId(),"] applyConstraints error"),_i.toString()),_i}}this._encoderConfig=_e,this._hints.indexOf(S0.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await p0(this,a_.NEED_UPDATE_VIDEO_ENCODER,this)}catch(Wt){return Wt.throw(iE)}}getStats(){return q1(()=>{iE.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),mT(this,a_.GET_STATS)||O0({},H6)}async setBeautyEffect(_e){iE.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(_e,_t):await J6(_e)}async setBitrateLimit(_e){if(iE.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(_e))),_e){this._forceBitrateLimit=_e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<_e.max_bitrate?this._encoderConfig.bitrateMax:_e.max_bitrate:this._encoderConfig.bitrateMax=_e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=_e.min_bitrate);try{await p0(this,a_.NEED_UPDATE_VIDEO_ENCODER,this)}catch(_t){return _t.throw(iE)}}}async setOptimizationMode(_e){if(_e!=="motion"&&_e!=="detail"&&_e!=="balanced")return void iE.error(mE.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const _t=this._optimizationMode;try{this._optimizationMode=_e,await p0(this,a_.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(Wt){throw this._optimizationMode=_t,iE.error("[".concat(this.getTrackId(),"] set optimization mode failed"),Wt.toString()),Wt}iE.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(_e,")"))}setScalabiltyMode(_e){if(_e.numSpatialLayers===1&&_e.numTemporalLayers!==1)return iE.error(mE.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=_e,iE.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(_e,")"))}updateMediaStreamTrackResolution(){SK(this._originMediaStreamTrack).then(_e=>{let[_t,Wt]=_e;this._videoHeight=Wt,this._videoWidth=_t}).catch(TL)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(_e){if(!this._enabled)throw new HE(mE.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");iE.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(_e)),_e=i1(_e),this._forceBitrateLimit&&(_e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:_e.bitrateMax,_e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:_e.bitrateMin),this._encoderConfig=_e,this._hints.indexOf(S0.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await p0(this,a_.NEED_UPDATE_VIDEO_ENCODER,this)}catch(_t){return _t.throw(iE)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:_e,height:_t,frameRate:Wt}=this.getMediaStreamTrackSettings();if(!_e||!_t||!Wt)return;const{bitrateMax:_n,bitrateMin:_i}=this._encoderConfig;if(_i==null||_n==null){const{max:_s,min:_c}=function(_u,_h,_p,Qm,_g){const eE=yE("BITRATE_ADAPTER_TYPE");if(eE==="DEFAULT_BITRATE")return{min:Qm,max:_g};if(_g===void 0){var pE;const cE=Math.floor(200*Math.pow(_p/15,.6)*Math.pow(_u*_h/640/360,.75));_g=eE==="STANDARD_BITRATE"?4*cE:2*cE,Qm=(pE=Qm)!==null&&pE!==void 0?pE:cE}else{var aE;Qm=(aE=Qm)!==null&&aE!==void 0?aE:Math.floor(_g/10)}return{min:Qm,max:_g}}(_e,_t,Wt,_i,_n);this._encoderConfig.bitrateMin=_c,this._encoderConfig.bitrateMax=_s,iE.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(_e,", h: ").concat(_t,", fps: ").concat(Wt,"] => [brMax: ").concat(_s,", brMin: ").concat(_c,"]"))}}getVideoElementVisibleStatus(){try{var _e,_t;const Wt=this==null||(_e=this._player)===null||_e===void 0?void 0:_e.getContainerElement(),_n={track:this,element:this==null||(_t=this._player)===null||_t===void 0?void 0:_t.getVideoElement(),slot:Wt==null?void 0:Wt.parentElement},{element:_i,slot:_s}=_n;if(this.isPlaying&&_i instanceof HTMLVideoElement&&_s instanceof HTMLElement){const _c=PH.checkOneElementVisible(_i),_u=Object.assign({},_c);if(_u.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_u.visible;const _h=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_u.visible?_h.onSuccess("Video is visible"):_h.onSuccess("Invisible because of ".concat(_u.reason))}return _u}return}catch(Wt){throw new HE(mE.GET_VIDEO_ELEMENT_VISIBLE_ERROR,Wt.message)}}async renewMediaStreamTrack(_e){}pipe(_e){if(this.processor===_e)return _e;if(_e._source)throw new HE(mE.INVALID_OPERATION,"Processor ".concat(_e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=_e,this.processor._source=this,_e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),_e}unpipe(){if(!this.processor)return;const _e=this.processor;this.processor._source=void 0,this.processor=void 0,_e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(_e){let _t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],Wt=this._encoderConfig;_e&&(Wt=O0(O0({},Wt),i1(_e))),Wt=NI(Wt);const _n=f0(8,"track-video-cloned-"),_i=new GJ(_t?this._mediaStreamTrack.clone():this._mediaStreamTrack,Wt,NI(this._scalabilityMode),this._optimizationMode,_n,NI(this._hints));return _e&&Wt&&_i.setEncoderConfiguration(Wt),iE.debug("clone video track from ".concat(this.getTrackId()," to ").concat(_n,", clone ").concat(_t)),_i}async replaceTrack(_e,_t){if(!(_e instanceof MediaStreamTrack))throw new HE(mE.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(_e.kind!=="video")throw new HE(mE.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(_e,_t,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!dS()&&!PS())return;this._statsTimer&&window.clearInterval(this._statsTimer);let _e=2,_t=oM[_e],Wt=-1,_n=Date.now();const _i=_s=>{_s>2||_s<0||(_n=Date.now(),_t=oM[_s],this.setSenderConfiguration(_t))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const _s=this.getStats(),_c=mT(this,a_.GET_RTC_STATS);if(_s.sendPackets>0&&_c){Wt===-1&&(Wt=Date.now());const _u=Date.now();if(_u-Wt<1e3||_u-_n<yE("PROFILE_SWITCH_INTERVAL"))return;const _h=_s.sendFrameRate,_p=.6*_t.frameRate,Qm=.9*_t.frameRate;typeof _h=="number"&&_h>0&&_h<_p?_e>0&&(_e--,_i(_e),iE.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(_h,", switchProfile to ").concat(_e))):_c.OutgoingAvailableBandwidth<_t.bitrateMin?_e>0&&(_e--,_i(_e),iE.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(_c.OutgoingAvailableBandwidth,", bitrateMin ").concat(_t.bitrateMin,", switchProfile to ").concat(_e))):typeof _h=="number"&&_h>Qm&&_e<oM.length-1&&_c.OutgoingAvailableBandwidth>1.2*oM[_e+1].bitrateMin&&(_e++,_i(_e),iE.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(_h,", OutgoingAvailableBandwidth ").concat(_c.OutgoingAvailableBandwidth,", switchProfile to ").concat(_e)))}},yE("CHECK_LOCAL_STATS_INTERVAL"))}sendSeiData(_e){if(q1(()=>{p_.reportApiInvoke(null,{name:Q0.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:j0.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!yE("ENABLE_VIDEO_SEI")||!yE("ENABLE_ENCODED_TRANSFORM"))return void iE.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(_e instanceof Uint8Array==0)return new HE(mE.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const _t=this.getRTCRtpTransceiver();if(!_t)return void iE.warning("Video track is not published, SEI can not be send");const Wt=_t.sender.getParameters();if(Wt.codecs.length===0)return;const _n=Wt.codecs[0].mimeType.toLocaleLowerCase();_n==="video/h264"?this.safeEmit("sei-to-send",_e):iE.warning("SEI is not supported by ".concat(_n))}bindProcessorDestinationEvents(){this.processorDestination.on(ZS.ON_TRACK,async _e=>{_e?_e!==this._mediaStreamTrack&&(this._mediaStreamTrack=_e,this._updatePlayerSource(),await p0(this,a_.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await p0(this,a_.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ZS.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(IT.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(IT.REQUEST_CONSTRAINTS)}},G_(F_.prototype,"play",[h$,p$],Object.getOwnPropertyDescriptor(F_.prototype,"play"),F_.prototype),G_(F_.prototype,"stop",[f$],Object.getOwnPropertyDescriptor(F_.prototype,"stop"),F_.prototype),G_(F_.prototype,"setEnabled",[m$,g$,E$],Object.getOwnPropertyDescriptor(F_.prototype,"setEnabled"),F_.prototype),G_(F_.prototype,"setMuted",[v$,_$,y$],Object.getOwnPropertyDescriptor(F_.prototype,"setMuted"),F_.prototype),G_(F_.prototype,"setEncoderConfiguration",[b$,S$],Object.getOwnPropertyDescriptor(F_.prototype,"setEncoderConfiguration"),F_.prototype),G_(F_.prototype,"getStats",[T$],Object.getOwnPropertyDescriptor(F_.prototype,"getStats"),F_.prototype),G_(F_.prototype,"setBeautyEffect",[w$,R$],Object.getOwnPropertyDescriptor(F_.prototype,"setBeautyEffect"),F_.prototype),G_(F_.prototype,"getCurrentFrameData",[C$],Object.getOwnPropertyDescriptor(F_.prototype,"getCurrentFrameData"),F_.prototype),G_(F_.prototype,"getCurrentFrameImage",[I$],Object.getOwnPropertyDescriptor(F_.prototype,"getCurrentFrameImage"),F_.prototype),G_(F_.prototype,"setBitrateLimit",[A$],Object.getOwnPropertyDescriptor(F_.prototype,"setBitrateLimit"),F_.prototype),G_(F_.prototype,"setOptimizationMode",[O$],Object.getOwnPropertyDescriptor(F_.prototype,"setOptimizationMode"),F_.prototype),G_(F_.prototype,"setScalabiltyMode",[N$],Object.getOwnPropertyDescriptor(F_.prototype,"setScalabiltyMode"),F_.prototype),G_(F_.prototype,"updateMediaStreamTrackResolution",[P$],Object.getOwnPropertyDescriptor(F_.prototype,"updateMediaStreamTrackResolution"),F_.prototype),G_(F_.prototype,"pipe",[k$],Object.getOwnPropertyDescriptor(F_.prototype,"pipe"),F_.prototype),G_(F_.prototype,"unpipe",[D$],Object.getOwnPropertyDescriptor(F_.prototype,"unpipe"),F_.prototype),G_(F_.prototype,"close",[L$],Object.getOwnPropertyDescriptor(F_.prototype,"close"),F_.prototype),G_(F_.prototype,"replaceTrack",[x$],Object.getOwnPropertyDescriptor(F_.prototype,"replaceTrack"),F_.prototype),G_(F_.prototype,"startMonitorStats",[M$],Object.getOwnPropertyDescriptor(F_.prototype,"startMonitorStats"),F_.prototype),F_),Z6=(U$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),j$=q0(),F$=OO("CameraVideoTrack","_enabledMutex"),V$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),B$=q0(),G$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),H$=q0(),W$=__({argsMap:$=>[$.getTrackId()]}),kT=class HJ extends m0{get __className__(){return"CameraVideoTrack"}constructor(_e,_t,Wt,_n,_i,_s){super(_e,i1(_t.encoderConfig),_n,_i,_s),WE(this,"_config",void 0),WE(this,"_originalConstraints",void 0),WE(this,"_constraints",void 0),WE(this,"_enabled",!0),WE(this,"_deviceName","default"),WE(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(CO()||mV())&&!function(){const _c=W_();if(_c.os!==uS.IOS||!_c.osVersion)return!1;const _u=_c.osVersion.split(".");return Number(_u[0])===15&&Number(_u[1])>=2}()&&RH()&&this._enabled&&!this._isClosed&&(iE.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=_t,this._originalConstraints=Wt,this._constraints=Wt,this._deviceName=_e.label,this._encoderConfig=i1(this._config.encoderConfig),c0.on(SS.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),c0.on(SS.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(_e){return typeof _e=="string"?this._setDeviceById(_e):_e.deviceId?this._setDeviceById(_e.deviceId):_e.facingMode?this._setDeviceByFacingModel(_e.facingMode):void 0}async _setDeviceById(_e){if(iE.info("[".concat(this.getTrackId(),"] set device to ").concat(_e)),this._enabled)try{const _t=await NT.getDeviceById(_e),Wt={};Wt.video=O0({},this._constraints),Wt.video.deviceId={exact:_e},Wt.video.facingMode=void 0,this._originMediaStreamTrack.stop();let _n=null;try{_n=await OT(Wt,this.getTrackId())}catch(_i){throw iE.error("[".concat(this.getTrackId(),"] setDevice failed"),_i.toString()),_n=await OT({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(_n.getVideoTracks()[0],!1),_i}await this._updateOriginMediaStreamTrack(_n.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=_t.label,this._config.cameraId=_e,this._constraints.deviceId={exact:_e}}catch(_t){throw iE.error("[".concat(this.getTrackId(),"] setDevice error"),_t.toString()),_t}else try{const _t=await NT.getDeviceById(_e);this._deviceName=_t.label,this._config.cameraId=_e,this._constraints.deviceId={exact:_e}}catch(_t){throw iE.error("[".concat(this.getTrackId(),"] setDevice error"),_t.toString()),_t}iE.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(_e){iE.info("[".concat(this.getTrackId(),"] set facingMode ").concat(_e));const _t={video:O0(O0({},this._constraints),{},{deviceId:void 0,facingMode:{exact:_e}})};if(this._enabled){this._originMediaStreamTrack.stop();let Wt=null;try{Wt=await OT(_t,this.getTrackId())}catch(_n){throw iE.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),_n.toString()),Wt=await OT({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(Wt.getVideoTracks()[0],!1),_n}await this._updateOriginMediaStreamTrack(Wt.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=_e,this._config.cameraId=void 0,this._constraints=O0({},_t.video),iE.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(_e,_t){if(!_t){if(_e===this._enabled)return;this.stateCheck("enabled",_e)}if(iE.info("[".concat(this.getTrackId(),"] start setEnabled"),_e),_e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const Wt=await OT({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(Wt.getVideoTracks()[0],!1)}await p0(this,a_.NEED_ENABLE_TRACK,this)}catch(Wt){throw iE.error("[".concat(this.getTrackId(),"] setEnabled true error"),Wt.toString()),Wt}this.updateMediaStreamTrackResolution(),iE.info("[".concat(this.getTrackId(),"] setEnabled to true success")),_t||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),_t||(this._enabled=!1);try{await p0(this,a_.NEED_DISABLE_TRACK,this)}catch(Wt){throw iE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),Wt.toString()),Wt}iE.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(_e,_t){if(!this._enabled)throw new HE(mE.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");_e==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),_e=i1(_e),this._forceBitrateLimit&&(_e.bitrateMax=this._forceBitrateLimit.max_bitrate||_e.bitrateMax,_e.bitrateMin=this._forceBitrateLimit.min_bitrate||_e.bitrateMin);const Wt=b0(this._config);Wt.encoderConfig=_e;const _n=uM(Wt);(dS()||PS()||tR())&&(_n.deviceId=void 0),iE.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(_e),JSON.stringify(_n));try{await this._originMediaStreamTrack.applyConstraints(_n),this.updateMediaStreamTrackResolution()}catch(_i){const _s=new HE(mE.UNEXPECTED_ERROR,_i.toString());throw iE.error("[".concat(this.getTrackId(),"] applyConstraints error"),_s.toString()),_s}this._config=Wt,this._constraints=_n,this._originalConstraints=_n,this._encoderConfig=_e,this._hints.indexOf(S0.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await p0(this,a_.NEED_UPDATE_VIDEO_ENCODER,this)}catch(_i){return _i.throw(iE)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((PS()||tR())&&this._enabled&&!this._isClosed&&c0.duringInterruption){const _e=async()=>{c0.off(SS.IOS_INTERRUPTION_END,_e),this._enabled&&!this._isClosed&&(iE.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};c0.on(SS.IOS_INTERRUPTION_END,_e)}else iE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(QO.TRACK_ENDED)}async renewMediaStreamTrack(_e){const _t=_e||this._constraints,Wt=NT.searchDeviceIdByName(this._deviceName);if(Wt&&!_t.deviceId&&(_t.deviceId={exact:Wt}),this._enabled){const _n=await OT({video:_t},this.getTrackId());this._constraints=_t,await this._updateOriginMediaStreamTrack(_n.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),c0.off(SS.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),c0.off(SS.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(_e){let _t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],Wt=this._encoderConfig;_e&&(Wt=O0(O0({},Wt),i1(_e))),Wt=NI(Wt);const _n=f0(8,"track-cam-cloned-"),_i=new HJ(_t?this._mediaStreamTrack.clone():this._mediaStreamTrack,NI(O0(O0({},this._config),{},{encoderConfig:Wt})),NI(this._constraints),NI(this._scalabilityMode),this._optimizationMode,_n);return _e&&Wt&&_i.setEncoderConfiguration(Wt),iE.debug("clone track from ".concat(this.getTrackId()," to ").concat(_n,", clone ").concat(_t)),_i}bindProcessorContextEvents(){this.processorContext.on(IT.REQUEST_UPDATE_CONSTRAINTS,async(_e,_t,Wt)=>{try{const _n=Object.assign({},this._originalConstraints,..._e);await this.renewMediaStreamTrack(_n),_t()}catch(_n){Wt(_n)}}),this.processorContext.on(IT.REQUEST_CONSTRAINTS,async _e=>{_e(this._originMediaStreamTrack.getSettings())})}},G_(kT.prototype,"setDevice",[U$,j$],Object.getOwnPropertyDescriptor(kT.prototype,"setDevice"),kT.prototype),G_(kT.prototype,"setEnabled",[F$,V$,B$],Object.getOwnPropertyDescriptor(kT.prototype,"setEnabled"),kT.prototype),G_(kT.prototype,"setEncoderConfiguration",[G$,H$],Object.getOwnPropertyDescriptor(kT.prototype,"setEncoderConfiguration"),kT.prototype),G_(kT.prototype,"close",[W$],Object.getOwnPropertyDescriptor(kT.prototype,"close"),kT.prototype),kT);function Q6($,_e,_t,Wt){_t.optimizationMode&&(Wt&&Wt.width&&Wt.height?(_t.encoderConfig=O0(O0({},Wt),{},{bitrateMin:Wt.bitrateMin,bitrateMax:Wt.bitrateMax}),_t.optimizationMode!=="motion"&&_t.optimizationMode!=="detail"||(_e.contentHint=_t.optimizationMode,_e.contentHint===_t.optimizationMode?iE.debug("[".concat($,"] set content hint to"),_t.optimizationMode):iE.debug("[".concat($,"] set content hint failed")))):iE.warning("[".concat($,"] can not apply optimization mode bitrate config, no encoderConfig")))}var q$,z$,K$,$$,HT,Y$,J$,X$,Z$,Q$,e9,qS;class t9 extends aK{getUserId(){return this._userId}constructor(_e,_t,Wt,_n){super(_e,"track-".concat(_e.kind,"-").concat(_t,"-").concat(_n.clientId,"_").concat(f0(5,""))),WE(this,"_userId",void 0),WE(this,"_uintId",void 0),WE(this,"_isDestroyed",!1),WE(this,"store",void 0),WE(this,"processor",void 0),WE(this,"processorContext",void 0),this._userId=_t,this._uintId=Wt,this.store=_n}_updateOriginMediaStreamTrack(_e){this._originMediaStreamTrack=_e,this._mediaStreamTrack=_e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,iE.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let iN=(q$=__({argsMap:($,_e,_t)=>[$.getTrackId(),typeof _e=="string"?_e:_e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",_t]}),z$=__({argsMap:$=>[$.getTrackId()]}),K$=__({argsMap:($,_e)=>[$.getTrackId(),_e.name]}),$$=__({argsMap:$=>[$.getTrackId()]}),G_((HT=class extends t9{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==HS.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor($,_e,_t,Wt){super($,_e,_t,Wt),WE(this,"_videoVisibleTimer",null),WE(this,"_previousVideoVisibleStatus",void 0),WE(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),WE(this,"trackMediaType","video"),WE(this,"_videoWidth",void 0),WE(this,"_videoHeight",void 0),WE(this,"_player",void 0),WE(this,"processorDestination",void 0),WE(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new _K(this.getTrackId(),"remote"),this.processorDestination=new vK(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return q1(()=>{iE.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),mT(this,a_.GET_STATS)||O0({},oK)}play($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof $=="string"){const Wt=document.getElementById($);Wt?$=Wt:(iE.warning("[".concat(this.getTrackId(),'] can not find "#').concat($,'" element, use document.body')),$=document.body)}iE.debug("[".concat(this.getTrackId(),"] start video playback in ").concat($ instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(_e));const _t=O0(O0({fit:"cover"},_e),{},{trackId:this.getTrackId(),element:$});this._player?this._player.updateConfig(_t):($ instanceof HTMLVideoElement?this._player=new X6(_t):this._player=new d$(_t),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(eN.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=Wt=>{this.safeEmit(eN.VIDEO_STATE_CHANGED,Wt)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const Wt=this.getVideoElementVisibleStatus();this.safeEmit(eN.VIDEO_ELEMENT_VISIBLE_STATUS,Wt)}catch{}},yE("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,iE.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){SK(this._originMediaStreamTrack).then($=>{let[_e,_t]=$;this._videoHeight=_t,this._videoWidth=_e}).catch(TL)}_updatePlayerSource(){iE.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var $,_e;const _t=this==null||($=this._player)===null||$===void 0?void 0:$.getContainerElement(),Wt={track:this,element:this==null||(_e=this._player)===null||_e===void 0?void 0:_e.getVideoElement(),slot:_t==null?void 0:_t.parentElement},{element:_n,slot:_i}=Wt;if(this.isPlaying&&_n instanceof HTMLVideoElement&&_i instanceof HTMLElement){const _s=PH.checkOneElementVisible(_n),_c=Object.assign({},_s);if(_c.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_c.visible;const _u=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_c.visible?_u.onSuccess("Video is visible"):_u.onSuccess("Invisible because of ".concat(_c.reason))}return _c}return}catch(_t){throw new HE(mE.GET_VIDEO_ELEMENT_VISIBLE_ERROR,_t.message)}}pipe($){if(this.processor===$)return $;if($._source)throw new HE(mE.INVALID_OPERATION,"Processor ".concat($.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=$,this.processor._source=this,$.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),$}unpipe(){if(!this.processor)return;const $=this.processor;this.processor._source=void 0,this.processor=void 0,$.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ZS.ON_TRACK,async $=>{$?$!==this._mediaStreamTrack&&(this._mediaStreamTrack=$,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ZS.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei($){this.emit(zI.SEI_RECEIVED,$)}}).prototype,"play",[q$],Object.getOwnPropertyDescriptor(HT.prototype,"play"),HT.prototype),G_(HT.prototype,"stop",[z$],Object.getOwnPropertyDescriptor(HT.prototype,"stop"),HT.prototype),G_(HT.prototype,"pipe",[K$],Object.getOwnPropertyDescriptor(HT.prototype,"pipe"),HT.prototype),G_(HT.prototype,"unpipe",[$$],Object.getOwnPropertyDescriptor(HT.prototype,"unpipe"),HT.prototype),HT),oN=(Y$=__({argsMap:($,_e)=>[$.getTrackId(),_e],throttleTime:300}),J$=__({argsMap:($,_e)=>[$.getTrackId(),_e]}),X$=__({argsMap:$=>[$.getTrackId()]}),Z$=__({argsMap:$=>[$.getTrackId()]}),Q$=__({argsMap:($,_e)=>[$.getTrackId(),_e.name]}),e9=__({argsMap:$=>[$.getTrackId()]}),G_((qS=class extends t9{get isPlaying(){return this._useAudioElement?rT.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor($,_e,_t,Wt){super($,_e,_t,Wt),WE(this,"trackMediaType","audio"),WE(this,"_source",void 0),WE(this,"_useAudioElement",!0),WE(this,"_volume",100),WE(this,"processorContext",void 0),WE(this,"processorDestination",void 0),WE(this,"_played",!1),WE(this,"_bypassWebAudio",!1),yE("DISABLE_WEBAUDIO")?(this._source=new Y6,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new dK($,!0),yE("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(CT.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(eN.FIRST_FRAME_DECODED)}),this.processorContext=new bK(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new yK(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(CT.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!$)return this._source.removeAllListeners(CT.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(_e),this._source.removeAllListeners(CT.ON_AUDIO_BUFFER),this._source.on(CT.ON_AUDIO_BUFFER,_t=>$(_t))}setVolume($){this._volume=$,this._useAudioElement?rT.setVolume(this.getTrackId(),$):this._source.setVolume($/100)}async setPlaybackDevice($){if(!this._useAudioElement||!nK())throw new HE(mE.NOT_SUPPORTED,"your browser does not support setting the audio output device");await rT.setSinkID(this.getTrackId(),$)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return q1(()=>{iE.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),mT(this,a_.GET_STATS)||O0({},iK)}play(){iE.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(iE.debug("[".concat(this.getTrackId(),"] use audio element to play")),rT.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){iE.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?rT.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let $=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];iE.debug("[".concat(this.getTrackId(),"] update player source track")),$&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&rT.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe($){if(this._bypassWebAudio)throw new HE(mE.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===$)return $;if($._source)throw new HE(mE.INVALID_OPERATION,"Processor ".concat($.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=$,this.processor._source=this,$.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),$}unpipe(){var $;if(this._bypassWebAudio)throw new HE(mE.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const _e=this.processor;($=this._source.processSourceNode)===null||$===void 0||$.disconnect(),this.processor._source=!1,this.processor=void 0,_e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(ZS.ON_TRACK,async $=>{$?$!==this._mediaStreamTrack&&(this._mediaStreamTrack=$,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode($)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(ZS.ON_NODE,$=>{this._source.processedNode=$;const _e=!$;this._useAudioElement!==_e&&(this._played?(this.stop(),this._useAudioElement=_e,this.play()):this._useAudioElement=_e)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(ZS.ON_TRACK),this.processorDestination.removeAllListeners(ZS.ON_NODE)}}).prototype,"setVolume",[Y$],Object.getOwnPropertyDescriptor(qS.prototype,"setVolume"),qS.prototype),G_(qS.prototype,"setPlaybackDevice",[J$],Object.getOwnPropertyDescriptor(qS.prototype,"setPlaybackDevice"),qS.prototype),G_(qS.prototype,"play",[X$],Object.getOwnPropertyDescriptor(qS.prototype,"play"),qS.prototype),G_(qS.prototype,"stop",[Z$],Object.getOwnPropertyDescriptor(qS.prototype,"stop"),qS.prototype),G_(qS.prototype,"pipe",[Q$],Object.getOwnPropertyDescriptor(qS.prototype,"pipe"),qS.prototype),G_(qS.prototype,"unpipe",[e9],Object.getOwnPropertyDescriptor(qS.prototype,"unpipe"),qS.prototype),qS);const I1=new class extends A0{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),WE(this,"_lastHiddenTime",0),WE(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),iE.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};var n9=function($){return $[$.ONE_BYTE=0]="ONE_BYTE",$[$.TWO_BYTE=1]="TWO_BYTE",$}(n9||{});class Qde{constructor(){WE(this,"_sequence",0),WE(this,"_startTime",Date.now()),WE(this,"isUseOneByte",!0)}get startTime(){const _e=Date.now()-this._startTime;return _e<Math.pow(2,16)?_e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(_e){const _t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:_e};if(_e.byteLength>128){const _c=new Uint8Array(4);_c.set([1,0,0,0]);const _u={id:0,length:4,data:_c.buffer},_h={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[_u]};_t.commonPacketHeader.extension=1,_t.extension=_h,_t.payload=this.compress(_e),_t.commonPacketHeader.length=8+(_t.extension.length+2)+_t.payload.byteLength}else _t.commonPacketHeader.length=8+_t.payload.byteLength;yE("SHOW_DATASTREAM2_LOG")&&iE.debug("send data header: ".concat(JSON.stringify(_t.commonPacketHeader)));const Wt=new ArrayBuffer(_t.commonPacketHeader.length),_n=new Uint8Array(Wt),_i=new DataView(Wt);let _s=0;if(_i.setUint16(_s,_t.commonPacketHeader.extension<<15|_t.commonPacketHeader.reserved<<14|_t.commonPacketHeader.length,!0),_s+=2,_i.setUint32(_s,_t.commonPacketHeader.sequence,!0),_s+=4,_i.setUint16(_s,_t.commonStreamHeader,!0),_s+=2,_t.extension){const _c=this.serializeExtension(_t.extension);_n.set(new Uint8Array(_c),_s),_s+=_c.byteLength}if(_n.set(new Uint8Array(_t.payload),_s),_s+=_t.payload.byteLength,_s!==_t.commonPacketHeader.length)throw Error("serialize error!");return Wt}deserialize(_e){if(_e.byteLength<4)return new ArrayBuffer(0);const _t=new DataView(_e);let Wt=0;const _n=_t.getUint16(Wt,!0);Wt+=2;const _i={length:16383&_n,reserved:(16384&_n)>>14,extension:(32768&_n)>>15,sequence:_t.getUint16(Wt+2,!0)<<16|_t.getUint16(Wt,!0)};let _s,_c;if(Wt+=4,yE("SHOW_DATASTREAM2_LOG")&&iE.debug("receive data header: ".concat(JSON.stringify(_i))),_t.getUint16(Wt,!0),Wt+=2,_i.extension){_c=this.deserializeExtension(_e.slice(Wt)),Wt+=2+_c.length,_s=_e.slice(Wt);let _u=!1;if(_c.datas.length>0){const _h=_c.datas.find(_p=>_p.id===0);_h&&(_u=(1&new DataView(_h.data).getUint32(0,!0))==1)}_s=_u?this.decompress(_s):_s}else _s=_e.slice(8);return _s}serializeExtension(_e){const{profile:_t,length:Wt,datas:_n}=_e,_i=new ArrayBuffer(Wt+2),_s=new Uint8Array(_i),_c=new DataView(_i);let _u=0;if(_c.setUint8(_u++,_t),_c.setUint8(_u++,Wt),_n.forEach(_h=>{_t?(_c.setUint8(_u++,_h.id),_c.setUint8(_u++,_h.length),_s.set(new Uint8Array(_h.data),_u),_u+=_h.data.byteLength):(_c.setUint8(_u++,_h.id|_h.length<<4),_s.set(new Uint8Array(_h.data),_u),_u+=_h.data.byteLength)}),_u!==Wt+2)throw Error("serialize extension error, is ".concat(_u,"!==").concat(Wt+2));return _i}deserializeExtension(_e){const _t=new DataView(_e);let Wt=0;const _n=_t.getUint8(Wt);Wt++;const _i=_t.getUint8(Wt);Wt++;const _s=_n===n9.TWO_BYTE,_c=[],_u=new DataView(_e,2);let _h=0;for(;_h<_i;){let _p=0,Qm=0,_g=new ArrayBuffer(0);_s?(_p=_u.getUint8(_h),_h++,Qm=_u.getUint8(_h),_h++):(_p=15&_u.getUint8(_h),Qm=_u.getUint8(_h)>>4,_h++),Qm>0&&(_g=_u.buffer.slice(_h+2,_h+2+Qm),_h+=_g.byteLength),_c.push({id:_p,length:Qm,data:_g})}if(_h!==_i)throw Error("parse error");return{profile:_n,length:_i,datas:_c}}decompress(_e){return jde(new Uint8Array(_e))}compress(_e){return Ude(new Uint8Array(_e))}}class r9 extends A0{constructor(_e,_t){super(),WE(this,"_version",1),WE(this,"_type",3),WE(this,"_config",void 0),WE(this,"_originDataChannel",void 0),WE(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),WE(this,"_dataStreamPacketHandler",void 0),WE(this,"_datachannelEventMap",new Map),this._config=_e,_t&&(this._originDataChannel=_t,this._bandDataChannelEvents(_t)),this._initPacketHeader(),this._dataStreamPacketHandler=new Qde}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return yE("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var _e,_t;return(_e=(_t=this._originDataChannel)===null||_t===void 0?void 0:_t.readyState)!==null&&_e!==void 0?_e:"connecting"}get _originDataChannelId(){var _e,_t;return(_e=(_t=this._originDataChannel)===null||_t===void 0?void 0:_t.id)!==null&&_e!==void 0?_e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new n_((_e,_t)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&_e();const Wt=setTimeout(()=>{var _n;_t(new HE(mE.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((_n=this._originDataChannel)===null||_n===void 0?void 0:_n.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(Wt),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),_e()},this._originDataChannel.onerror=()=>{throw clearTimeout(Wt),new HE(mE.DATACHANNEL_CONNECTION_TIMEOUT)}}else _t(new HE(mE.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(_e){this._originDataChannel=_e,this._bandDataChannelEvents(_e)}_initPacketHeader(){const _e=new DataView(this._dataStreamPacketHeader);_e.setUint16(0,this._version),_e.setUint8(2,this._type),_e.setUint8(3,this._config.id)}_bandDataChannelEvents(_e){this._unbindDataChannelEvents(_e),[cM.OPEN,cM.CLOSE,cM.ERROR].forEach(_t=>{const Wt=()=>{this.emit(_t)};this._datachannelEventMap.set(_t,Wt),_e.addEventListener(_t,Wt)})}_unbindDataChannelEvents(_e){Array.from(this._datachannelEventMap.entries()).forEach(_t=>{let[Wt,_n]=_t;_e.removeEventListener(Wt,_n)}),this._datachannelEventMap.clear()}}class ehe extends r9{constructor(_e){super(_e),WE(this,"_messageListener",void 0),this._messageListener=_t=>{if(_t.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const Wt=_t.data.slice(0,this._dataStreamPacketHeader.byteLength),_n=new DataView(Wt).getUint8(3);if(_n!==this.id)return void(yE("SHOW_DATASTREAM2_LOG")&&iE.debug("invalid datachannel id: ".concat(_n," !== ").concat(this.id)));let _i=_t.data.slice(this._dataStreamPacketHeader.byteLength);_i=this._dataStreamPacketHandler.deserialize(_i),this.emit(cM.MESSAGE,_i)}}_updateOriginDataChannel(_e){super._updateOriginDataChannel(_e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class i9 extends r9{send(_e){if(this._originDataChannel){let _t=_e;_t=this._dataStreamPacketHandler.serialize(_e);const Wt=new Uint8Array(this._dataStreamPacketHeader.byteLength+_t.byteLength);Wt.set(new Uint8Array(this._dataStreamPacketHeader),0),Wt.set(new Uint8Array(_t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(Wt.buffer)}}}function hM(){const $=new Blob([atob("ZnVuY3Rpb24gZShlKXtjb25zdCB0PW5ldyBEYXRhVmlldyhlLmRhdGEpO2lmKDA9PT10LmdldFVpbnQ4KDApJiYwPT09dC5nZXRVaW50OCgxKSYmMD09PXQuZ2V0VWludDgoMikmJjE9PT10LmdldFVpbnQ4KDMpJiY2PT09dC5nZXRVaW50OCg0KSl7bGV0IG49NixyPTAsbz0wO2Zvcig7MjU1PT09KG89dC5nZXRVaW50OChuKyspKTspcis9MjU1O3IrPW87Y29uc3QgYT1mdW5jdGlvbihlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLG89W10sYT0wO2Zvcig7YTxuOylhKzM8biYmMD09PXJbYV0mJjA9PT1yW2ErMV0mJjM9PT1yW2ErMl0mJigwPT09clthKzNdfHwxPT09clthKzNdfHwyPT09clthKzNdfHwzPT09clthKzNdKT8oby5wdXNoKHJbYV0sclthKzFdLHJbYSszXSksYSs9NCk6KG8ucHVzaChyW2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShvKX0oZS5kYXRhLG4scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGEpfXJldHVybiBudWxsfWZ1bmN0aW9uIHQoZSx0KXtjb25zdCBuPWZ1bmN0aW9uKGUpe2NvbnN0IHQ9ZS5sZW5ndGg7bGV0IG49W10scj0wO2Zvcig7cjx0OylyKzI8dCYmMD09PWVbcl0mJjA9PT1lW3IrMV0mJigwPT09ZVtyKzJdfHwxPT09ZVtyKzJdfHwyPT09ZVtyKzJdfHwzPT09ZVtyKzJdKT8obi5wdXNoKGVbcl0sZVtyKzFdLDMsZVtyKzJdKSxyKz0zKToobi5wdXNoKGVbcl0pLHIrKyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KG4pfSh0KSxyPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihyLzI1NSksYT1yJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK3IrZS5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBpPTA7Zm9yKDtpPG87KXNbNitpXT0yNTUsaSsrO3JldHVybiBzWzYraV09YSxpKysscy5zZXQobiw2K2kpLHMuc2V0KG5ldyBVaW50OEFycmF5KGUpLDYraStyKSxzLmJ1ZmZlcn1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlNhZmFyaSIpPi0xJiYtMT09PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiQ2hyb21lIikmJihzZWxmLm9ucnRjdHJhbnNmb3JtPW49Pntjb25zdCByPW4udHJhbnNmb3JtZXI7bGV0IG89W107ci5vcHRpb25zLnBvcnQub25tZXNzYWdlPWU9PntlLmRhdGEuc2VpJiZvLnB1c2goZS5kYXRhLnNlaSl9LHNlbGYucG9zdE1lc3NhZ2UoInN0YXJ0ZWQiKTtjb25zdCBhPXIucmVhZGFibGUuZ2V0UmVhZGVyKCkscz1yLndyaXRhYmxlLmdldFdyaXRlcigpOyJyeCI9PT1yLm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2EucmVhZCgpLnRoZW4oKHI9PntpZighci5kb25lKXtpZihyLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7YS5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1vLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>f7.revokeObjectURL($),0),new Worker(f7.createObjectURL($))}const pM=new Map,fM=new Map,mM=new Map;async function the($,_e){if(!B_().supportWebRTCEncodedTransform)return void iE.warning("browser not support video encoded transform");if(mM.has($)||!$.track)return;const _t={track:$.track};if(H1()){if(!$.createEncodedStreams)return void iE.warning("browser not support createEncodedStreams() API");let _n=null;try{_n=$.createEncodedStreams()}catch(_c){return void iE.error("create video-encoded-streams error",_c&&_c.message)}let _i=[];_e.on("sei-to-send",_c=>{_i.push(_c)});const _s=new TransformStream({transform(_c,_u){_t.controller||(_t.controller=_u),$.track&&$.track.id!==_t.track.id&&(iE.debug("video track changed: ".concat(_t.track.id," => ").concat($.track.id)),_t.track.removeEventListener("ended",Wt),_t.track=$.track,_t.track.addEventListener("ended",Wt));const _h=_i.shift();_h&&(_c.data=function(_p,Qm){const _g=function(gE){const AE=gE.length;let PE=[],xE=0;for(;xE<AE;)xE+2<AE&&gE[xE]===0&&gE[xE+1]===0&&(gE[xE+2]===0||gE[xE+2]===1||gE[xE+2]===2||gE[xE+2]===3)?(PE.push(gE[xE],gE[xE+1],3,gE[xE+2]),xE+=3):(PE.push(gE[xE]),xE++);return new Uint8Array(PE)}(Qm),eE=_g.length,pE=Math.floor(eE/255),aE=eE%255,cE=new Uint8Array(6+pE+1+eE+_p.byteLength);cE[0]=0,cE[1]=0,cE[2]=0,cE[3]=1,cE[4]=6,cE[5]=101;let fE=0;for(;fE<pE;)cE[6+fE]=255,fE++;return cE[6+fE]=aE,fE++,cE.set(_g,6+fE),cE.set(new Uint8Array(_p),6+fE+eE),cE.buffer}(_c.data,_h)),_u.enqueue(_c)}});_n.readable.pipeThrough(_s).pipeTo(_n.writable)}else{if(!dS())return;{if(typeof RTCRtpScriptTransform>"u")return void iE.warning("browser not support RTCRtpScriptTransform");const _n=hM(),_i=new MessageChannel;await new n_(_c=>_n.onmessage=_u=>{_u.data==="registered"&&_c(void 0)});const _s=new RTCRtpScriptTransform(_n,{name:"tx",port:_i.port2},[_i.port2]);$.transform=_s,await new n_(_c=>_n.onmessage=_u=>{_u.data==="started"&&_c(void 0)}),_e.on("sei-to-send",_c=>{_i.port1.postMessage({sei:_c})}),_i.port1.onmessage=_c=>{var _u;_c.data.transformed&&$.track&&((_u=$.track)===null||_u===void 0?void 0:_u.id)!==_t.track.id&&(iE.debug("video track changed: ".concat(_t.track.id," => ").concat($.track.id)),_t.track.removeEventListener("ended",Wt),_t.track=$.track,_t.track.addEventListener("ended",Wt))},_t.worker=_n}}function Wt(){if($.track){if(this.id!==$.track.id)return;$.track.removeEventListener("ended",Wt)}const _n=mM.get($);if(_n){mM.delete($);try{var _i,_s;(_i=_n.controller)===null||_i===void 0||_i.terminate(),(_s=_n.worker)===null||_s===void 0||_s.terminate()}catch(_c){iE.warning(_c&&_c.message)}}}mM.set($,_t),$.track.addEventListener("ended",Wt)}const DP=new Map;async function nhe($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!B_().supportWebRTCEncodedTransform)return void iE.warning("browser not support video encoded transform");if(!$.track)return;if(DP.has($)){const _n=DP.get($);return void(_n&&(_n.onSei=_e.onSei))}const _t={track:$.track,onSei:_e.onSei};if(H1()){if(!$.createEncodedStreams)return void iE.warning("browser not support createEncodedStreams() API");let _n=null;try{_n=$.createEncodedStreams()}catch(_s){return void iE.error("create video-encoded-streams error",_s&&_s.message)}const _i=new TransformStream({transform(_s,_c){_t.controller||(_t.controller=_c),$.track&&$.track.id!==_t.track.id&&(iE.debug("video track changed: ".concat(_t.track.id," => ").concat($.track.id)),_t.track.removeEventListener("ended",Wt),_t.track=$.track,_t.track.addEventListener("ended",Wt));const _u=function(_h){const _p=new DataView(_h.data);if(_p.getUint8(0)===0&&_p.getUint8(1)===0&&_p.getUint8(2)===0&&_p.getUint8(3)===1&&_p.getUint8(4)===6){let Qm=6,_g=0,eE=0;for(;(eE=_p.getUint8(Qm++))===255;)_g+=255;_g+=eE;const pE=function(aE,cE,fE){let gE=new Uint8Array(aE,cE,fE),AE=[],PE=0;for(;PE<fE;)PE+3<fE&&gE[PE]===0&&gE[PE+1]===0&&gE[PE+2]===3&&(gE[PE+3]===0||gE[PE+3]===1||gE[PE+3]===2||gE[PE+3]===3)?(AE.push(gE[PE],gE[PE+1],gE[PE+3]),PE+=4):(AE.push(gE[PE]),PE++);return new Uint8Array(AE)}(_h.data,Qm,_g);return new Uint8Array(pE)}return null}(_s);_u&&_t.onSei&&_t.onSei(_u),_c.enqueue(_s)}});_n.readable.pipeThrough(_i).pipeTo(_n.writable)}else if(dS()){if(typeof RTCRtpScriptTransform>"u")return void iE.warning("browser not support RTCRtpScriptTransform");const _n=hM(),_i=new MessageChannel;await new n_(_c=>_n.onmessage=_u=>{_u.data==="registered"&&_c(void 0)});const _s=new RTCRtpScriptTransform(_n,{name:"rx",port:_i.port2},[_i.port2]);$.transform=_s,await new n_(_c=>_n.onmessage=_u=>{_u.data==="started"&&_c(void 0)}),_i.port1.onmessage=_c=>{var _u;_c.data.transformed&&$.track&&((_u=$.track)===null||_u===void 0?void 0:_u.id)!==_t.track.id?(iE.debug("video track changed: ".concat(_t.track.id," => ").concat($.track.id)),_t.track.removeEventListener("ended",Wt),_t.track=$.track,_t.track.addEventListener("ended",Wt)):_c.data.sei&&_t.onSei&&_t.onSei(_c.data.sei)},_t.worker=_n}function Wt(){if($.track){if(this.id!==$.track.id)return;$.track.removeEventListener("ended",Wt)}(function(_n){const _i=DP.get(_n);if(_i){DP.delete(_n);try{var _s,_c;(_s=_i.controller)===null||_s===void 0||_s.terminate(),(_c=_i.worker)===null||_c===void 0||_c.terminate()}catch(_u){iE.warning(_u&&_u.message)}}})($)}DP.set($,_t),$.track.addEventListener("ended",Wt)}(function(){const $=W_();IS.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),IS.getStreamFromExtension=$.name===t0.CHROME&&Number($.version)>34,IS.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const _e=new RTCPeerConnection;let _t=!1;try{_e.addTransceiver("audio"),_t=!0}catch{}return _e.close(),_t}(),IS.supportMinBitrate=$.name===t0.CHROME||$.name===t0.EDGE,IS.supportSetRtpSenderParameters=function(){const _e=W_();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!W1()||!(!dS()&&!_L())||_e.name===t0.FIREFOX&&Number(_e.version)>=64)}(),$.name===t0.SAFARI&&(Number($.version)>=14?IS.supportDualStream=!0:IS.supportDualStream=!1),IS.webAudioMediaStreamDest=function(){const _e=W_();return!(_e.name===t0.SAFARI&&Number(_e.version)<12)}(),IS.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",IS.supportWebGL=typeof WebGLRenderingContext<"u",IS.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,W1()||(IS.webAudioWithAEC=!0),IS.supportShareAudio=function(){const _e=W_();return(_e.os===uS.WIN_10||_e.os===uS.WIN_81||_e.os===uS.WIN_7||_e.os===uS.LINUX||_e.os===uS.MAC_OS||_e.os===uS.CHROMIUM_OS)&&_e.name===t0.CHROME&&Number(_e.version)>=74}(),IS.supportDataChannel=!!(fV(76)||function(_e){const _t=W_();return!(_t.name!==t0.FIREFOX||!_t.osVersion)&&Number(_t.version)>=_e}(68)||vH(14)),IS.supportPCSetConfiguration=function(){const _e=window.RTCPeerConnection;return!h0()&&!!_e&&_e.prototype.setConfiguration instanceof Function}(),IS.supportWebRTCEncodedTransform=function(){const _e=W_();return _e.name==="Chrome"&&Number(_e.version)>=86||_e.name==="Safari"&&Number(_e.version)>=15}(),IS.supportWebRTCInsertableStream=function(){const _e=W_();return(_e.name===t0.CHROME||_e.name===t0.EDGE)&&Number(_e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),IS.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,IS.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,SL(()=>{IS.supportDualStreamEncoding=function(){const _e=W_();return!!yE("DISABLE_WEBAUDIO")||_e.name==="Safari"&&Number(_e.version)>=14||!!(_e.name==="Chrome"&&/Windows/i.test(_e.os||"")&&Number(_e.version)>=100&&yE("CHROME_DUAL_STREAM_USE_ENCODING"))}(),iE.info("browser compatibility",JSON.stringify(IS),JSON.stringify($))})})();class rhe extends A0{constructor(){super(...arguments),hE(this,"resultStorage",new Map)}setLocalAudioStats(_e,_t,Wt){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",_e,this.checkAudioInputLevel(Wt,_t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",_e,this.checkSendAudioBitrate(Wt,_t))}setLocalVideoStats(_e,_t,Wt){this.record("SEND_VIDEO_BITRATE_TOO_LOW",_e,this.checkSendVideoBitrate(Wt,_t)),this.record("FRAMERATE_INPUT_TOO_LOW",_e,this.checkFramerateInput(Wt,_t)),this.record("FRAMERATE_SENT_TOO_LOW",_e,this.checkFramerateSent(Wt))}setRemoteAudioStats(_e,_t){const Wt=_e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",Wt,this.checkAudioOutputLevel(_t))}setRemoteVideoStats(_e,_t){const Wt=_e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",Wt,this.checkVideoDecode(_t))}record(_e,_t,Wt){if(yE("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(_e)||this.resultStorage.set(_e,{result:[],isPrevNormal:!0});const _n=this.resultStorage.get(_e);if(_n&&(_n.result.push(Wt),_n.result.length>=5)){var _i;const _s=i_(_i=_n.result).call(_i,!0);_n.isPrevNormal&&!_s&&this.emit("exception",o9[_e],_e,_t),!_n.isPrevNormal&&_s&&this.emit("exception",o9[_e]+2e3,_e+"_RECOVER",_t),_n.isPrevNormal=_s,_n.result=[]}}checkAudioOutputLevel(_e){return!(_e.receiveBitrate>0&&_e.receiveLevel===0)}checkAudioInputLevel(_e,_t){return _t instanceof iS&&!_t.isActive||!!_t.muted||_e.sendVolumeLevel!==0}checkFramerateInput(_e,_t){let Wt=null;_t._encoderConfig&&_t._encoderConfig.frameRate&&(Wt=cT(_t._encoderConfig.frameRate));const _n=_e.captureFrameRate;return!Wt||!_n||!(Wt>10&&_n<5||Wt<10&&Wt>=5&&_n<=1)}checkFramerateSent(_e){return!(_e.captureFrameRate&&_e.sendFrameRate&&_e.captureFrameRate>5&&_e.sendFrameRate<=1)}checkSendVideoBitrate(_e,_t){return!!_t.muted||_e.sendBitrate!==0}checkSendAudioBitrate(_e,_t){return _t instanceof iS&&!_t.isActive||!!_t.muted||_e.sendBitrate!==0}checkVideoDecode(_e){return _e.receiveBitrate===0||_e.decodeFrameRate!==0}}const o9={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},DS=new class{markSubscribeStart($,_e){performance.mark("agora-web-sdk/".concat($,"/subscribe-").concat(_e))}markPublishStart($,_e){performance.mark("agora-web-sdk/".concat($,"/publish-").concat(_e))}measureFromSubscribeStart($,_e){const _t=performance.getEntriesByName("agora-web-sdk/".concat($,"/subscribe-").concat(_e));if(_t.length>0){const Wt=_t[_t.length-1];return Math.round(performance.now()-Wt.startTime)}return 0}measureFromPublishStart($,_e){const _t=performance.getEntriesByName("agora-web-sdk/".concat($,"/publish-").concat(_e));if(_t.length>0){const Wt=_t[_t.length-1];return Math.round(performance.now()-Wt.startTime)}return 0}};function _B($,_e){this.v=$,this.k=_e}function k_($){return new _B($,0)}var ihe=z2,ohe=zR;y0({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var $=ohe.f(this);return{promise:$.promise,resolve:$.resolve,reject:$.reject}}});var she=zR,ahe=hO;y0({target:"Promise",stat:!0,forced:!0},{try:function($){var _e=she.f(this),_t=ahe($);return(_t.error?_e.reject:_e.resolve)(_t.value),_e.promise}});var e8=zt(ihe),s9=EO.f("asyncIterator"),che=zt(s9);function LP($){var _e,_t;function Wt(_i,_s){try{var _c=$[_i](_s),_u=_c.value,_h=_u instanceof _B;e8.resolve(_h?_u.v:_u).then(function(_p){if(_h){var Qm=_i==="return"?"return":"next";if(!_u.k||_p.done)return Wt(Qm,_p);_p=$[Qm](_p).value}_n(_c.done?"return":"normal",_p)},function(_p){Wt("throw",_p)})}catch(_p){_n("throw",_p)}}function _n(_i,_s){switch(_i){case"return":_e.resolve({value:_s,done:!0});break;case"throw":_e.reject(_s);break;default:_e.resolve({value:_s,done:!1})}(_e=_e.next)?Wt(_e.key,_e.arg):_t=null}this._invoke=function(_i,_s){return new e8(function(_c,_u){var _h={key:_i,arg:_s,resolve:_c,reject:_u,next:null};_t?_t=_t.next=_h:(_e=_t=_h,Wt(_i,_s))})},typeof $.return!="function"&&(this.return=void 0)}function ET($){return function(){return new LP($.apply(this,arguments))}}LP.prototype[typeof yO=="function"&&che||"@@asyncIterator"]=function(){return this},LP.prototype.next=function($){return this._invoke("next",$)},LP.prototype.throw=function($){return this._invoke("throw",$)},LP.prototype.return=function($){return this._invoke("return",$)};var a9=zt(yS.Object.getOwnPropertySymbols),lhe=y0,uhe=rU.indexOf,dhe=_k,t8=bE([].indexOf),c9=!!t8&&1/t8([1],1,-0)<0;lhe({target:"Array",proto:!0,forced:c9||!dhe("indexOf")},{indexOf:function($){var _e=arguments.length>1?arguments[1]:void 0;return c9?t8(this,$,_e)||0:uhe(this,$,_e)}});var hhe=QT("Array").indexOf,phe=_m,fhe=hhe,n8=Array.prototype,mhe=function($){var _e=$.indexOf;return $===n8||phe(n8,$)&&_e===n8.indexOf?fhe:_e},l9=zt(mhe);function ghe($,_e){if($==null)return{};var _t,Wt,_n=function(_s,_c){if(_s==null)return{};var _u,_h,_p={},Qm=nW(_s);for(_h=0;_h<Qm.length;_h++)_u=Qm[_h],l9(_c).call(_c,_u)>=0||(_p[_u]=_s[_u]);return _p}($,_e);if(a9){var _i=a9($);for(Wt=0;Wt<_i.length;Wt++)_t=_i[Wt],l9(_e).call(_e,_t)>=0||Object.prototype.propertyIsEnumerable.call($,_t)&&(_n[_t]=$[_t])}return _n}var u9={exports:{}};(function($,_e){$.exports=(()=>{var _t={8:(_i,_s,_c)=>{_c.r(_s),_c.d(_s,{Parser:()=>V_,Printer:()=>_R,parse:()=>w_,print:()=>X_});const _u=`
`,_h="".concat("\r").concat(_u),_p=" ";let Qm;function _g(r_){return r_>="0"&&r_<="9"}function eE(r_){return r_>="!"&&r_<="~"}function pE(r_){return eE(r_)||r_>=""&&r_<=""}function aE(r_){return r_==="!"||r_>="#"&&r_<="'"||r_>="*"&&r_<="+"||r_>="-"&&r_<="."||r_>="0"&&r_<="9"||r_>="A"&&r_<="Z"||r_>="^"&&r_<="~"}function cE(r_){return r_>="1"&&r_<="9"}function fE(r_){return r_>="A"&&r_<="Z"||r_>="a"&&r_<="z"}function gE(r_){return r_==="d"||r_==="h"||r_==="m"||r_==="s"}function AE(r_){return r_>""&&r_<"	"||r_>"\v"&&r_<"\f"||r_>""&&r_<""}function PE(r_){return fE(r_)||_g(r_)||r_==="+"||r_==="/"}function xE(r_){return _g(r_)||fE(r_)||r_==="+"||r_==="/"||r_==="-"||r_==="_"}function GE(r_){return fE(r_)||_g(r_)||r_==="+"||r_==="/"}function zE(r_,uE){var SE=Object.keys(r_);if(Object.getOwnPropertySymbols){var CE=Object.getOwnPropertySymbols(r_);uE&&(CE=CE.filter(function(ZE){return Object.getOwnPropertyDescriptor(r_,ZE).enumerable})),SE.push.apply(SE,CE)}return SE}function KE(r_){for(var uE=1;uE<arguments.length;uE++){var SE=arguments[uE]!=null?arguments[uE]:{};uE%2?zE(Object(SE),!0).forEach(function(CE){JE(r_,CE,SE[CE])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r_,Object.getOwnPropertyDescriptors(SE)):zE(Object(SE)).forEach(function(CE){Object.defineProperty(r_,CE,Object.getOwnPropertyDescriptor(SE,CE))})}return r_}function JE(r_,uE,SE){return uE in r_?Object.defineProperty(r_,uE,{value:SE,enumerable:!0,configurable:!0,writable:!0}):r_[uE]=SE,r_}(function(r_){r_.VERSION="v",r_.ORIGIN="o",r_.SESSION_NAME="s",r_.INFORMATION="i",r_.URI="u",r_.EMAIL="e",r_.PHONE="p",r_.CONNECTION="c",r_.BANDWIDTH="b",r_.TIME="t",r_.REPEAT="r",r_.ZONE_ADJUSTMENTS="z",r_.KEY="k",r_.ATTRIBUTE="a",r_.MEDIA="m"})(Qm||(Qm={}));class c_{consumeText(uE,SE){let CE=SE;for(;CE<uE.length;){const ZE=uE[CE];if(ZE==="\0"||ZE==="\r"||ZE===_u)break;CE+=1}if(CE-SE==0)throw new Error("Invalid text, at ".concat(uE));return CE}consumeUnicastAddress(uE,SE,CE){return this.consumeTill(uE,SE,_p)}consumeOneOrMore(uE,SE,CE){let ZE=SE;for(;CE(uE[ZE]);)ZE++;if(ZE-SE==0)throw new Error("Invalid rule at ".concat(SE,"."));return ZE}consumeSpace(uE,SE){if(uE[SE]===_p)return SE+1;throw new Error("Invalid space at ".concat(SE,"."))}consumeIP4Address(uE,SE){let CE=SE;for(let ZE=0;ZE<4;ZE++)if(CE=this.consumeDecimalUChar(uE,CE),ZE!==3){if(uE[CE]!==".")throw new Error("Invalid IP4 address.");CE++}return CE}consumeDecimalUChar(uE,SE){let CE=SE;for(let R_=0;R_<3&&_g(uE[CE]);R_++,CE++);if(CE-SE==0)throw new Error("Invalid decimal uchar.");const ZE=parseInt(uE.slice(SE,CE));if(ZE>=0&&ZE<=255)return CE;throw new Error("Invalid decimal uchar")}consumeIP6Address(uE,SE){let CE=this.consumeHexpart(uE,SE);return uE[CE]===":"&&(CE+=1,CE=this.consumeIP4Address(uE,CE)),CE}consumeHexpart(uE,SE){let CE=SE;if(uE[CE]===":"&&uE[CE+1]===":"){CE+=2;try{CE=this.consumeHexseq(uE,CE)}catch{}return CE}if(CE=this.consumeHexseq(uE,CE),uE[CE]===":"&&uE[CE+1]===":"){CE+=2;try{CE=this.consumeHexseq(uE,CE)}catch{}return CE}return CE}consumeHexseq(uE,SE){let CE=SE;for(;CE=this.consumeHex4(uE,CE),uE[CE]===":"&&uE[CE+1]!==":";)CE+=1;return CE}consumeHex4(uE,SE){let CE=0;for(;CE<4;CE++)if(!((ZE=uE[SE+CE])>="0"&&ZE<="9"||ZE>="a"&&ZE<="f"||ZE>="A"&&ZE<="F")){if(CE===0)throw new Error("Invalid hex 4");break}var ZE;return SE+CE}consumeFQDN(uE,SE){let CE=SE;for(;_g(uE[CE])||fE(uE[CE])||uE[CE]==="-"||uE[CE]===".";)CE+=1;if(CE-SE<4)throw new Error("Invalid FQDN");return CE}consumeExtnAddr(uE,SE){return this.consumeOneOrMore(uE,SE,pE)}consumeMulticastAddress(uE,SE,CE){switch(CE){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(uE,SE);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(uE,SE);default:try{return this.consumeFQDN(uE,SE)}catch{return this.consumeExtnAddr(uE,SE)}}}consumeIP6MulticastAddress(uE,SE){const CE=this.consumeHexpart(uE,SE);return uE[CE]==="/"?this.consumeInteger(uE,CE+1):CE}consumeIP4MulticastAddress(uE,SE){let CE=SE+3;const ZE=uE.slice(SE,CE),R_=parseInt(ZE);if(R_<224||R_>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let l0=0;l0<3;l0++){if(uE[CE]!==".")throw new Error("Invalid IP4 multicast address.");CE+=1,CE=this.consumeDecimalUChar(uE,CE)}return uE[CE]==="/"&&(CE+=1),CE=this.consumeTTL(uE,CE),uE[CE]==="/"&&(CE=this.consumeInteger(uE,CE)),CE}consumeInteger(uE,SE){if(!cE(uE[SE]))throw new Error("Invalid integer.");for(SE+=1;_g(uE[SE]);)SE+=1;return SE}consumeTTL(uE,SE){if(uE[SE]==="0")return SE+1;if(!cE(uE[SE]))throw new Error("Invalid TTL.");SE+=1;for(let CE=0;CE<2&&_g(uE[SE]);CE++)SE+=1;return SE}consumeToken(uE,SE){return this.consumeOneOrMore(uE,SE,aE)}consumeTime(uE,SE){let CE=SE;if(uE[CE]==="0")return CE+1;for(cE(uE[CE])&&(CE+=1);_g(uE[CE]);)CE++;if(CE-SE<10)throw new Error("Invalid time");return CE}consumeAddress(uE,SE){return this.consumeTill(uE,SE,_p)}consumeTypedTime(uE,SE){let CE=SE;return CE=this.consumeOneOrMore(uE,CE,_g),gE(uE[CE])?CE+1:CE}consumeRepeatInterval(uE,SE){if(!cE(uE[SE]))throw new Error("Invalid repeat interval");for(SE+=1;_g(uE[SE]);)SE+=1;return gE(uE[SE])&&(SE+=1),SE}consumePort(uE,SE){return this.consumeOneOrMore(uE,SE,_g)}consume(uE,SE,CE){for(let ZE=0;ZE<CE.length;ZE++){if(SE+ZE>=uE.length)throw new Error("consume exceeding value length");if(uE[SE+ZE]!==CE[ZE])throw new Error("consume ".concat(CE," failed at ").concat(ZE))}return SE+CE.length}consumeTill(uE,SE,CE){let ZE=SE;for(;ZE<uE.length&&(typeof CE!="string"||uE[ZE]!==CE)&&(typeof CE!="function"||!CE(uE[ZE]));)ZE++;return ZE}}class V_ extends c_{constructor(){super(),JE(this,"records",[]),JE(this,"currentLine",0)}parse(uE){const SE=this.probeEOL(uE);this.records=uE.split(SE).filter(tS=>!!VS(tS).call(tS)).map(this.parseLine),this.currentLine=0;const CE=this.parseVersion(),ZE=this.parseOrigin(),R_=this.parseSessionName(),l0=this.parseInformation(),cS=this.parseUri(),hT=this.parseEmail(),N1=this.parsePhone(),FM=this.parseConnection(),VM=this.parseBandWidth(),$T=this.parseTimeFields(),mI=this.parseKey(),fN=this.parseSessionAttribute(),z0=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:CE,origin:ZE,sessionName:R_,information:l0,uri:cS,emails:hT,phones:N1,connection:FM,bandwidths:VM,timeFields:$T,key:mI,attributes:fN,mediaDescriptions:z0}}getCurrentRecord(){const uE=this.records[this.currentLine];if(!uE)throw new Error("Record doesn't exit.");return uE}probeEOL(uE){for(let SE=0;SE<uE.length;SE++)if(uE[SE]===_u)return uE[SE-1]==="\r"?_h:_u;throw new Error("Invalid newline character.")}parseLine(uE,SE){if(uE.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const CE=uE[0];if(uE[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:CE,value:uE.slice(2),line:SE,cur:0}}parseSessionAttribute(){const uE=new T0;for(;this.currentLine<this.records.length;){const SE=this.getCurrentRecord();if(SE.type!==Qm.ATTRIBUTE)break;const CE={attField:this.extractOneOrMore(SE,ZE=>aE(ZE)&&ZE!==":"),_cur:0};SE.value[SE.cur]===":"&&(SE.cur+=1,CE.attValue=this.extractOneOrMore(SE,AE)),uE.parse(CE),this.currentLine++}return uE.digest()}parseMediaAttributes(uE){const SE=new Z0(uE);for(;this.currentLine<this.records.length;){const CE=this.getCurrentRecord();if(CE.type!==Qm.ATTRIBUTE)break;const ZE={attField:this.extractOneOrMore(CE,R_=>aE(R_)&&R_!==":"),_cur:0};CE.value[CE.cur]===":"&&(CE.cur+=1,ZE.attValue=this.extractOneOrMore(CE,AE)),SE.parse(ZE),this.currentLine++}return SE.digest()}parseKey(){const uE=this.getCurrentRecord();if(uE.type===Qm.KEY){if(uE.value==="prompt"||uE.value==="clear:"||uE.value==="base64:"||uE.value==="uri:")return uE.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const uE=this.getCurrentRecord();if(uE.type===Qm.ZONE_ADJUSTMENTS){const SE=[];for(;;)try{const CE=this.extract(uE,this.consumeTime);this.consumeSpaceForRecord(uE);let ZE=!1;uE.value[uE.cur]==="-"&&(ZE=!0,uE.cur+=1);const R_=this.extract(uE,this.consumeTypedTime);SE.push({time:CE,typedTime:R_,back:ZE})}catch{break}if(SE.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,SE}return[]}parseRepeat(){const uE=[];for(;;){const SE=this.getCurrentRecord();if(SE.type!==Qm.REPEAT)break;{const CE=this.extract(SE,this.consumeRepeatInterval),ZE=this.parseTypedTime(SE);uE.push({repeatInterval:CE,typedTimes:ZE}),this.currentLine++}}return uE}parseTypedTime(uE){const SE=[];for(;;)try{this.consumeSpaceForRecord(uE),SE.push(this.extract(uE,this.consumeTypedTime))}catch{break}if(SE.length===0)throw new Error("Invalid typed time.");return SE}parseTime(){const uE=this.getCurrentRecord(),SE=this.extract(uE,this.consumeTime);this.consumeSpaceForRecord(uE);const CE=this.extract(uE,this.consumeTime);return this.currentLine++,{startTime:SE,stopTime:CE}}parseBandWidth(){const uE=[];for(;this.currentLine<this.records.length;){const SE=this.getCurrentRecord();if(SE.type!==Qm.BANDWIDTH)break;{const CE=this.extractOneOrMore(SE,aE);if(SE.value[SE.cur]!==":")throw new Error("Invalid bandwidth field.");SE.cur++;const ZE=this.extractOneOrMore(SE,_g);uE.push({bwtype:CE,bandwidth:ZE}),this.currentLine++}}return uE}parseVersion(){const uE=this.getCurrentRecord();if(uE.type!==Qm.VERSION)throw new Error("first sdp record must be version");const SE=uE.value.slice(0,this.consumeOneOrMore(uE.value,0,_g));if(SE.length!==uE.value.length)throw new Error('invalid proto version, "v='.concat(uE.value,'"'));return this.currentLine++,SE}parseOrigin(){const uE=this.getCurrentRecord();if(uE.type!==Qm.ORIGIN)throw new Error("second line of sdp must be origin");const SE=this.extractOneOrMore(uE,pE);this.consumeSpaceForRecord(uE);const CE=this.extractOneOrMore(uE,_g);this.consumeSpaceForRecord(uE);const ZE=this.extractOneOrMore(uE,_g);this.consumeSpaceForRecord(uE);const R_=this.extractOneOrMore(uE,aE);this.consumeSpaceForRecord(uE);const l0=this.extractOneOrMore(uE,aE);this.consumeSpaceForRecord(uE);const cS=this.extract(uE,this.consumeUnicastAddress);return this.currentLine++,{username:SE,sessId:CE,sessVersion:ZE,nettype:R_,addrtype:l0,unicastAddress:cS}}parseSessionName(){const uE=this.getCurrentRecord();if(uE.type===Qm.SESSION_NAME){const SE=this.extract(uE,this.consumeText);return this.currentLine++,SE}}parseInformation(){const uE=this.getCurrentRecord();if(uE.type!==Qm.INFORMATION)return;const SE=this.extract(uE,this.consumeText);return this.currentLine++,SE}parseUri(){const uE=this.getCurrentRecord();if(uE.type===Qm.URI)return this.currentLine++,uE.value}parseEmail(){const uE=[];for(;;){const SE=this.getCurrentRecord();if(SE.type!==Qm.EMAIL)break;uE.push(SE.value),this.currentLine++}return uE}parsePhone(){const uE=[];for(;;){const SE=this.getCurrentRecord();if(SE.type!==Qm.PHONE)break;uE.push(SE.value),this.currentLine++}return uE}parseConnection(){const uE=this.getCurrentRecord();if(uE.type===Qm.CONNECTION){const SE=this.extractOneOrMore(uE,aE);this.consumeSpaceForRecord(uE);const CE=this.extractOneOrMore(uE,aE);this.consumeSpaceForRecord(uE);const ZE=this.extract(uE,this.consumeAddress);return this.currentLine++,{nettype:SE,addrtype:CE,address:ZE}}}parseMedia(){const uE=this.getCurrentRecord(),SE=this.extract(uE,this.consumeToken);this.consumeSpaceForRecord(uE);let CE=this.extract(uE,this.consumePort);uE.value[uE.cur]==="/"&&(uE.cur+=1,CE+=this.extract(uE,this.consumeInteger)),this.consumeSpaceForRecord(uE);const ZE=[];for(ZE.push(this.extract(uE,this.consumeToken));uE.value[uE.cur]==="/";)uE.cur+=1,ZE.push(this.extract(uE,this.consumeToken));if(ZE.length===0)throw new Error("Invalid proto");const R_=this.parseFmt(uE);return this.currentLine++,{mediaType:SE,port:CE,protos:ZE,fmts:R_}}parseTimeFields(){const uE=[];for(;this.getCurrentRecord().type===Qm.TIME;){const SE=this.parseTime(),CE=this.parseRepeat(),ZE=this.parseZone();uE.push({time:SE,repeats:CE,zones:ZE})}return uE}parseMediaDescription(){const uE=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===Qm.MEDIA;){const SE=this.parseMedia(),CE=this.parseInformation(),ZE=this.parseConnections(),R_=this.parseBandWidth(),l0=this.parseKey(),cS=this.parseMediaAttributes(SE);uE.push({media:SE,information:CE,connections:ZE,bandwidths:R_,key:l0,attributes:cS})}return uE}parseConnections(){const uE=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===Qm.CONNECTION;)uE.push(this.parseConnection());return uE}parseFmt(uE){const SE=[];for(;;)try{this.consumeSpaceForRecord(uE),SE.push(this.extract(uE,this.consumeToken))}catch{break}if(SE.length===0)throw new Error("Invalid fmts");return SE}extract(uE,SE){for(var CE=arguments.length,ZE=new Array(CE>2?CE-2:0),R_=2;R_<CE;R_++)ZE[R_-2]=arguments[R_];const l0=SE.call(this,uE.value,uE.cur,...ZE),cS=uE.value.slice(uE.cur,l0);return uE.cur=l0,cS}extractOneOrMore(uE,SE){const CE=this.consumeOneOrMore(uE.value,uE.cur,SE),ZE=uE.value.slice(uE.cur,CE);return uE.cur=CE,ZE}consumeSpaceForRecord(uE){if(uE.value[uE.cur]!==_p)throw new Error("Invalid space at ".concat(uE.cur,"."));uE.cur+=1}}class Q_ extends c_{constructor(){super(...arguments),JE(this,"attributes",void 0),JE(this,"digested",!1)}extractOneOrMore(uE,SE,CE){const ZE=this.consumeOneOrMore(uE.attValue,uE._cur,SE),R_=uE.attValue.slice(uE._cur,ZE),[l0,cS]=CE||[];if(typeof l0=="number"&&R_.length<l0)throw new Error("error in length, should be more or equal than ".concat(l0," characters."));if(typeof cS=="number"&&R_.length>cS)throw new Error("error in length, should be less or equal than ".concat(cS," characters."));return uE._cur=ZE,R_}consumeAttributeSpace(uE){if(uE.attValue[uE._cur]!==_p)throw new Error("Invalid space at ".concat(uE._cur,"."));uE._cur+=1}extract(uE,SE){if(!uE.attValue)throw new Error("Nothing to extract from attValue.");for(var CE=arguments.length,ZE=new Array(CE>2?CE-2:0),R_=2;R_<CE;R_++)ZE[R_-2]=arguments[R_];const l0=SE.call(this,uE.attValue,uE._cur,...ZE),cS=uE.attValue.slice(uE._cur,l0);return uE._cur=l0,cS}atEnd(uE){if(!uE.attValue)throw new Error;return uE._cur>=uE.attValue.length}peekChar(uE){if(!uE.attValue)throw new Error;return uE.attValue[uE._cur]}peek(uE,SE){if(!uE.attValue)throw new Error;for(let CE=0;CE<SE.length;CE++)if(SE[CE]!==uE.attValue[uE._cur+CE])return!1;return!0}parseIceUfrag(uE){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(uE,PE,[4,256])}parseIcePwd(uE){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(uE,PE,[22,256])}parseIceOptions(uE){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const SE=[];for(;!this.atEnd(uE);){SE.push(this.extractOneOrMore(uE,PE));try{this.consumeAttributeSpace(uE)}catch(CE){if(this.atEnd(uE))break;throw CE}}this.attributes.iceOptions=SE}parseFingerprint(uE){const SE=this.extract(uE,this.consumeToken);this.consumeAttributeSpace(uE);const CE=this.extract(uE,this.consumeTill);this.attributes.fingerprints.push({hashFunction:SE,fingerprint:CE})}parseExtmap(uE){const SE=this.extractOneOrMore(uE,_g);let CE;this.peekChar(uE)==="/"&&(this.extract(uE,this.consume,"/"),CE=this.extract(uE,this.consumeToken)),this.consumeAttributeSpace(uE);const ZE=this.extract(uE,this.consumeTill,_p),R_=KE(KE({entry:parseInt(SE,10)},CE&&{direction:CE}),{},{extensionName:ZE});this.peekChar(uE)===_p&&(this.consumeAttributeSpace(uE),R_.extensionAttributes=this.extract(uE,this.consumeTill)),this.attributes.extmaps.push(R_)}parseSetup(uE){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const SE=this.extract(uE,this.consumeTill);if(SE!=="active"&&SE!=="passive"&&SE!=="actpass"&&SE!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=SE}}class T0 extends Q_{constructor(){super(...arguments),JE(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(uE){if(this.digested)throw new Error("already digested");try{switch(uE.attField){case"group":this.parseGroup(uE);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(uE);break;case"ice-pwd":this.parseIcePwd(uE);break;case"ice-options":this.parseIceOptions(uE);break;case"fingerprint":this.parseFingerprint(uE);break;case"setup":this.parseSetup(uE);break;case"tls-id":this.parseTlsId(uE);break;case"identity":this.parseIdentity(uE);break;case"extmap":this.parseExtmap(uE);break;case"msid-semantic":this.parseMsidSemantic(uE);break;default:uE.ignored=!0,this.attributes.unrecognized.push(uE)}}catch(SE){throw console.error("parsing session attribute ".concat(uE.attField,' error, "a=').concat(uE.attField,":").concat(uE.attValue,'"')),SE}if(!uE.ignored&&uE.attValue&&!this.atEnd(uE))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(uE){const SE=this.extract(uE,this.consumeToken),CE=[];for(;!this.atEnd(uE)&&this.peekChar(uE)===_p;)this.consumeAttributeSpace(uE),CE.push(this.extract(uE,this.consumeToken));this.attributes.groups.push({semantic:SE,identificationTag:CE})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(uE){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(uE,xE)}parseIdentity(uE){const SE=this.extractOneOrMore(uE,GE),CE=[];for(;!this.atEnd(uE)&&this.peekChar(uE)===_p;){this.consumeAttributeSpace(uE);const ZE=this.extract(uE,this.consumeToken);this.extract(uE,this.consume,"=");const R_=this.extractOneOrMore(uE,l0=>l0!==_p&&AE(l0));CE.push({name:ZE,value:R_})}this.attributes.identities.push({assertionValue:SE,extensions:CE})}parseMsidSemantic(uE){this.peekChar(uE)===_p&&this.consumeAttributeSpace(uE);const SE={semantic:this.extract(uE,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(uE)}catch{break}if(this.peekChar(uE)==="*"){this.extract(uE,this.consume,"*"),SE.applyForAll=!0;break}{const CE=this.extract(uE,this.consumeTill,_p);SE.identifierList.push(CE)}}this.attributes.msidSemantic=SE}}class Z0 extends Q_{constructor(uE){super(),JE(this,"attributes",void 0),uE.protos.indexOf("RTP")!==-1||uE.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(uE){if(this.digested)throw new Error("already digested");try{switch(uE.attField){case"extmap":this.parseExtmap(uE);break;case"setup":this.parseSetup(uE);break;case"ice-ufrag":this.parseIceUfrag(uE);break;case"ice-pwd":this.parseIcePwd(uE);break;case"ice-options":this.parseIceOptions(uE);break;case"candidate":this.parseCandidate(uE);break;case"remote-candidate":this.parseRemoteCandidate(uE);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(uE);break;case"rtpmap":this.parseRtpmap(uE);break;case"ptime":this.parsePtime(uE);break;case"maxptime":this.parseMaxPtime(uE);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(uE);break;case"ssrc":this.parseSSRC(uE);break;case"fmtp":this.parseFmtp(uE);break;case"rtcp-fb":this.parseRtcpFb(uE);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(uE);break;case"mid":this.parseMid(uE);break;case"msid":this.parseMsid(uE);break;case"imageattr":this.parseImageAttr(uE);break;case"rid":this.parseRid(uE);break;case"simulcast":this.parseSimulcast(uE);break;case"sctp-port":this.parseSctpPort(uE);break;case"max-message-size":this.parseMaxMessageSize(uE);break;case"ssrc-group":this.parseSSRCGroup(uE);break;default:uE.ignored=!0,this.attributes.unrecognized.push(uE)}}catch(SE){throw console.error("parsing media attribute ".concat(uE.attField,' error, "a=').concat(uE.attField,":").concat(uE.attValue,'"')),SE}if(!uE.ignored&&uE.attValue&&!this.atEnd(uE))throw new Error("attribute parsing error")}parseCandidate(uE){const SE=this.extractOneOrMore(uE,PE,[1,32]);this.consumeAttributeSpace(uE);const CE=this.extractOneOrMore(uE,_g,[1,5]);this.consumeAttributeSpace(uE);const ZE=this.extract(uE,this.consumeToken);this.consumeAttributeSpace(uE);const R_=this.extractOneOrMore(uE,_g,[1,10]);this.consumeAttributeSpace(uE);const l0=this.extract(uE,this.consumeAddress);this.consumeAttributeSpace(uE);const cS=this.extract(uE,this.consumePort);this.consumeAttributeSpace(uE),this.extract(uE,this.consume,"typ"),this.consumeAttributeSpace(uE);const hT={foundation:SE,componentId:CE,transport:ZE,priority:R_,connectionAddress:l0,port:cS,type:this.extract(uE,this.consumeToken),extension:{}};for(this.peek(uE," raddr")&&(this.extract(uE,this.consume," raddr"),this.consumeAttributeSpace(uE),hT.relAddr=this.extract(uE,this.consumeAddress)),this.peek(uE," rport")&&(this.extract(uE,this.consume," rport"),this.consumeAttributeSpace(uE),hT.relPort=this.extract(uE,this.consumePort));this.peekChar(uE)===_p;){this.consumeAttributeSpace(uE);const N1=this.extract(uE,this.consumeToken);this.consumeAttributeSpace(uE),hT.extension[N1]=this.extractOneOrMore(uE,eE)}this.attributes.candidates.push(hT)}parseRemoteCandidate(uE){const SE=[];for(;;){const CE=this.extractOneOrMore(uE,_g,[1,5]);this.consumeAttributeSpace(uE);const ZE=this.extract(uE,this.consumeAddress);this.consumeAttributeSpace(uE);const R_=this.extract(uE,this.consumePort);SE.push({componentId:CE,connectionAddress:ZE,port:R_});try{this.consumeAttributeSpace(uE)}catch{break}}this.attributes.remoteCandidatesList.push(SE)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(uE){const SE=this.extract(uE,this.consumeToken);this.consumeAttributeSpace(uE);const CE=this.extract(uE,this.consumeTill,"/");this.extract(uE,this.consume,"/");const ZE={encodingName:CE,clockRate:this.extractOneOrMore(uE,_g)};this.atEnd(uE)||this.peekChar(uE)!=="/"||(this.extract(uE,this.consume,"/"),ZE.encodingParameters=parseInt(this.extract(uE,this.consumeTill),10));const R_=this.attributes.payloads.find(l0=>l0.payloadType===parseInt(SE,10));R_?R_.rtpMap=ZE:this.attributes.payloads.push({payloadType:parseInt(SE,10),rtpMap:ZE,rtcpFeedbacks:[]})}parsePtime(uE){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(uE,this.consumeTill)}parseMaxPtime(uE){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(uE,this.consumeTill)}parseDirection(uE){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=uE.attField}parseSSRC(uE){const SE=this.extractOneOrMore(uE,_g);this.consumeAttributeSpace(uE);const CE=this.extract(uE,this.consumeTill,":");let ZE;this.peekChar(uE)===":"&&(this.extract(uE,this.consume,":"),ZE=this.extract(uE,this.consumeTill));const R_=this.attributes.ssrcs.find(l0=>l0.ssrcId===parseInt(SE,10));R_?R_.attributes[CE]=ZE:this.attributes.ssrcs.push({ssrcId:parseInt(SE,10),attributes:{[CE]:ZE}})}parseFmtp(uE){const SE=this.extract(uE,this.consumeTill,_p);this.consumeAttributeSpace(uE);const CE=this.extract(uE,this.consumeTill),ZE={};CE.split(";").forEach(l0=>{let[cS,hT]=l0.split("=");cS=VS(cS).call(cS);const N1=typeof hT=="string"?VS(hT).call(hT):null;typeof cS=="string"&&cS.length>0&&(ZE[cS]=N1)});const R_=this.attributes.payloads.find(l0=>l0.payloadType===parseInt(SE,10));R_?R_.fmtp={parameters:ZE}:this.attributes.payloads.push({payloadType:parseInt(SE,10),rtcpFeedbacks:[],fmtp:{parameters:ZE}})}parseFmtParameters(uE){const SE={},CE=this.extract(uE,this.consumeTill,"=");uE._cur++;const ZE=this.extract(uE,this.consumeTill,";");for(SE[CE]=ZE;uE.attValue[uE._cur]===";";){const R_=this.extract(uE,this.consumeTill,"=");uE._cur++;const l0=this.extract(uE,this.consumeTill,";");SE[R_]=l0}return SE}parseRtcpFb(uE){let SE="";SE=this.peekChar(uE)==="*"?this.extract(uE,this.consume,"*"):this.extract(uE,this.consumeTill,_p),this.consumeAttributeSpace(uE);const CE=this.extract(uE,this.consumeTill,_p);let ZE;if(CE==="trr-int")ZE={type:CE,interval:this.extract(uE,this.consumeTill)};else{const R_={type:CE};this.peekChar(uE)===_p&&(this.consumeAttributeSpace(uE),R_.parameter=this.extract(uE,this.consumeToken),this.peekChar(uE)===_p&&(R_.additional=this.extract(uE,this.consumeTill))),ZE=R_}if(SE==="*")this.attributes.rtcpFeedbackWildcards.push(ZE);else{const R_=this.attributes.payloads.find(l0=>l0.payloadType===parseInt(SE,10));R_?R_.rtcpFeedbacks.push(ZE):this.attributes.payloads.push({payloadType:parseInt(SE,10),rtcpFeedbacks:[ZE]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(uE){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const SE={port:this.extract(uE,this.consumePort)};this.peekChar(uE)===_p&&(this.consumeAttributeSpace(uE),SE.netType=this.extractOneOrMore(uE,aE),this.consumeAttributeSpace(uE),SE.addressType=this.extractOneOrMore(uE,aE),this.consumeAttributeSpace(uE),SE.address=this.extract(uE,this.consumeAddress)),this.attributes.rtcp=SE}parseMsid(uE){const SE={id:this.extractOneOrMore(uE,aE,[1,64])};this.peekChar(uE)===_p&&(this.consumeAttributeSpace(uE),SE.appdata=this.extractOneOrMore(uE,aE,[1,64])),this.attributes.msids.push(SE)}parseImageAttr(uE){this.attributes.imageattr.push(uE.attValue)}parseRid(uE){const SE=this.extractOneOrMore(uE,ZE=>fE(ZE)||_g(ZE)||ZE==="_"||ZE==="-");this.consumeAttributeSpace(uE);const CE={id:SE,direction:this.extract(uE,this.consumeToken),params:[]};if(this.peekChar(uE)===_p){if(this.consumeAttributeSpace(uE),this.peek(uE,"pt=")){this.extract(uE,this.consume,"pt=");const ZE=[];for(;;){const R_=this.extract(uE,this.consumeToken);ZE.push(R_);try{this.extract(uE,this.consume,",")}catch{break}}CE.payloads=ZE,this.peekChar(uE)===_p&&this.extract(uE,this.consume,_p)}for(;;){const ZE=this.extract(uE,this.consumeToken);switch(ZE){case"depend":{const R_={type:ZE,rids:this.extract(uE,this.consume,"=").split(",")};CE.params.push(R_);break}default:{const R_={type:ZE};this.peekChar(uE)==="="&&(this.extract(uE,this.consume,"="),R_.val=this.extract(uE,this.consumeTill,";")),CE.params.push(R_)}}try{this.extract(uE,this.consume,";")}catch{break}}}this.attributes.rids.push(CE)}parseSimulcast(uE){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=uE.attValue,this.extract(uE,this.consumeTill)}parseSctpPort(uE){this.attributes.sctpPort=this.extractOneOrMore(uE,_g,[1,5])}parseMaxMessageSize(uE){this.attributes.maxMessageSize=this.extractOneOrMore(uE,_g,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(uE){this.attributes.mid=this.extract(uE,this.consumeToken)}parseSSRCGroup(uE){const SE=this.extract(uE,this.consumeToken),CE=[];for(;;)try{this.consumeAttributeSpace(uE);const ZE=this.extract(uE,this.consumeInteger);CE.push(parseInt(ZE,10))}catch{break}this.attributes.ssrcGroups.push({semantic:SE,ssrcIds:CE})}}function M0(r_,uE,SE){return uE in r_?Object.defineProperty(r_,uE,{value:SE,enumerable:!0,configurable:!0,writable:!0}):r_[uE]=SE,r_}class _R{constructor(){M0(this,"eol",_h)}print(uE,SE){let CE="";return SE&&(this.eol=SE),CE+=this.printVersion(uE.version),CE+=this.printOrigin(uE.origin),CE+=this.printSessionName(uE.sessionName),CE+=this.printInformation(uE.information),CE+=this.printUri(uE.uri),CE+=this.printEmail(uE.emails),CE+=this.printPhone(uE.phones),CE+=this.printConnection(uE.connection),CE+=this.printBandwidth(uE.bandwidths),CE+=this.printTimeFields(uE.timeFields),CE+=this.printKey(uE.key),CE+=this.printSessionAttributes(uE.attributes),CE+=this.printMediaDescription(uE.mediaDescriptions),CE}printVersion(uE){return"v=".concat(uE).concat(this.eol)}printOrigin(uE){return"o=".concat(uE.username," ").concat(uE.sessId," ").concat(uE.sessVersion," ").concat(uE.nettype," ").concat(uE.addrtype," ").concat(uE.unicastAddress).concat(this.eol)}printSessionName(uE){return uE?"s=".concat(uE).concat(this.eol):""}printInformation(uE){return uE?"i=".concat(uE).concat(this.eol):""}printUri(uE){return uE?"u=".concat(uE).concat(this.eol):""}printEmail(uE){let SE="";for(const CE of uE)SE+="e=".concat(CE).concat(this.eol);return SE}printPhone(uE){let SE="";for(const CE of uE)SE+="e=".concat(CE).concat(this.eol);return SE}printConnection(uE){return uE?"c=".concat(uE.nettype," ").concat(uE.addrtype," ").concat(uE.address).concat(this.eol):""}printBandwidth(uE){let SE="";for(const CE of uE)SE+="b=".concat(CE.bwtype,":").concat(CE.bandwidth).concat(this.eol);return SE}printTimeFields(uE){let SE="";for(const CE of uE){SE+="t=".concat(CE.time.startTime," ").concat(CE.time.startTime).concat(this.eol);for(const ZE of CE.repeats)SE+="r=".concat(ZE.repeatInterval," ").concat(ZE.typedTimes.join(" ")).concat(this.eol);CE.zoneAdjustments&&(SE+="z=",SE+="z=".concat(CE.zoneAdjustments.map(ZE=>"".concat(ZE.time," ").concat(ZE.back?"-":""," ").concat(ZE.typedTime)).join(" ")).concat(this.eol),SE+=this.eol)}return SE}printKey(uE){return uE?"k=".concat(uE).concat(this.eol):""}printAttributes(uE){let SE="";for(const CE of uE)SE+="a=".concat(CE.attField).concat(CE.attValue?":".concat(CE.attValue):"").concat(this.eol);return SE}printMediaDescription(uE){let SE="";for(const CE of uE)SE+=this.printMedia(CE.media),SE+=this.printInformation(CE.information),SE+=this.printConnections(CE.connections),SE+=this.printBandwidth(CE.bandwidths),SE+=this.printKey(CE.key),SE+=this.printMediaAttributes(CE);return SE}printConnections(uE){let SE="";for(const CE of uE)SE+=this.printConnection(CE);return SE}printMedia(uE){return"m=".concat(uE.mediaType," ").concat(uE.port," ").concat(uE.protos.join("/")," ").concat(uE.fmts.join(" ")).concat(this.eol)}printSessionAttributes(uE){return new QE(this.eol).print(uE)}printMediaAttributes(uE){return new d_(this.eol).print(uE)}}class $E{constructor(uE){M0(this,"eol",void 0),this.eol=uE}printIceUfrag(uE){return uE===void 0?"":"a=ice-ufrag:".concat(uE).concat(this.eol)}printIcePwd(uE){return uE===void 0?"":"a=ice-pwd:".concat(uE).concat(this.eol)}printIceOptions(uE){return uE===void 0?"":"a=ice-options:".concat(uE.join(_p)).concat(this.eol)}printFingerprints(uE){return uE.length>0?uE.map(SE=>"a=fingerprint:".concat(SE.hashFunction).concat(_p).concat(SE.fingerprint)).join(this.eol)+this.eol:""}printExtmap(uE){return uE.map(SE=>"a=extmap:".concat(SE.entry).concat(SE.direction?"/".concat(SE.direction):"").concat(_p).concat(SE.extensionName).concat(SE.extensionAttributes?"".concat(_p).concat(SE.extensionAttributes):"").concat(this.eol)).join("")}printSetup(uE){return uE===void 0?"":"a=setup:".concat(uE).concat(this.eol)}printUnrecognized(uE){return uE.map(SE=>"a=".concat(SE.attField).concat(SE.attValue?":".concat(SE.attValue):"").concat(this.eol)).join("")}}class QE extends $E{print(uE){let SE="";return SE+=this.printGroups(uE.groups),SE+=this.printMsidSemantic(uE.msidSemantic),SE+=this.printIceLite(uE.iceLite),SE+=this.printIceUfrag(uE.iceUfrag),SE+=this.printIcePwd(uE.icePwd),SE+=this.printIceOptions(uE.iceOptions),SE+=this.printFingerprints(uE.fingerprints),SE+=this.printSetup(uE.setup),SE+=this.printTlsId(uE.tlsId),SE+=this.printIdentity(uE.identities),SE+=this.printExtmap(uE.extmaps),SE+=this.printUnrecognized(uE.unrecognized),SE}printGroups(uE){let SE="";return uE.length>0&&(SE+=uE.map(CE=>"a=group:".concat(CE.semantic).concat(CE.identificationTag.map(ZE=>"".concat(_p).concat(ZE)).join("")).concat(this.eol)).join("")),SE}printIceLite(uE){return uE===void 0?"":"a=ice-lite"+this.eol}printTlsId(uE){return uE?"a=tls-id:".concat(uE).concat(this.eol):""}printIdentity(uE){return uE.length===0?"":uE.map(SE=>"a=identity:".concat(SE.assertionValue).concat(SE.extensions.map(CE=>"".concat(_p).concat(CE.name).concat(CE.value?"=".concat(CE.value):"")))).join(this.eol)+this.eol}printMsidSemantic(uE){if(!uE)return"";let SE="a=msid-semantic:".concat(uE.semantic);return uE.applyForAll?SE+="".concat(_p,"*"):uE.identifierList.length>0&&(SE+=uE.identifierList.map(CE=>"".concat(_p).concat(CE))),SE+this.eol}}class d_ extends $E{print(uE){const SE=uE.attributes;let CE="";return CE+=this.printRTCP(SE.rtcp),CE+=this.printIceUfrag(SE.iceUfrag),CE+=this.printIcePwd(SE.icePwd),CE+=this.printIceOptions(SE.iceOptions),CE+=this.printCandidates(SE.candidates),CE+=this.printRemoteCandidatesList(SE.remoteCandidatesList),CE+=this.printEndOfCandidates(SE.endOfCandidates),CE+=this.printFingerprints(SE.fingerprints),CE+=this.printSetup(SE.setup),CE+=this.printMid(SE.mid),CE+=this.printExtmap(SE.extmaps),CE+=this.printRTPRelated(SE),CE+=this.printPtime(SE.ptime),CE+=this.printMaxPtime(SE.maxPtime),CE+=this.printDirection(SE.direction),CE+=this.printSSRCGroups(SE.ssrcGroups),CE+=this.printSSRC(SE.ssrcs),CE+=this.printRTCPMux(SE.rtcpMux),CE+=this.printRTCPMuxOnly(SE.rtcpMuxOnly),CE+=this.printRTCPRsize(SE.rtcpRsize),CE+=this.printMSId(SE.msids),CE+=this.printImageattr(SE.imageattr),CE+=this.printRid(SE.rids),CE+=this.printSimulcast(SE.simulcast),CE+=this.printSCTPPort(SE.sctpPort),CE+=this.printMaxMessageSize(SE.maxMessageSize),CE+=this.printUnrecognized(SE.unrecognized),CE}printCandidates(uE){return uE.map(SE=>"a=candidate:".concat(SE.foundation).concat(_p).concat(SE.componentId).concat(_p).concat(SE.transport).concat(_p).concat(SE.priority).concat(_p).concat(SE.connectionAddress).concat(_p).concat(SE.port).concat(_p,"typ").concat(_p).concat(SE.type).concat(SE.relAddr?"".concat(_p,"raddr").concat(_p).concat(SE.relAddr):"").concat(SE.relPort?"".concat(_p,"rport").concat(_p).concat(SE.relPort):"").concat(Object.keys(SE.extension).map(CE=>"".concat(_p).concat(CE).concat(_p).concat(SE.extension[CE])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(uE){return uE.map(SE=>"a=remote-candidates:".concat(SE.join(_p)).concat(this.eol)).join("")}printEndOfCandidates(uE){return uE===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(uE){if(!uE.payloads)return"";const SE=uE.payloads;let CE="";CE+=uE.rtcpFeedbackWildcards.map(ZE=>this.printRTCPFeedback("*",ZE)).join("");for(const ZE of SE)CE+=this.printRtpMap(ZE.payloadType,ZE.rtpMap),CE+=this.printFmtp(ZE.payloadType,ZE.fmtp),CE+=ZE.rtcpFeedbacks.map(R_=>this.printRTCPFeedback(ZE.payloadType,R_)).join("");return CE}printFmtp(uE,SE){if(!SE)return"";const CE=Object.keys(SE.parameters);return CE.length===1&&SE.parameters[CE[0]]===null?"a=fmtp:".concat(uE).concat(_p).concat(CE[0]).concat(this.eol):"a=fmtp:".concat(uE).concat(_p).concat(Object.keys(SE.parameters).map(ZE=>"".concat(ZE,"=").concat(SE.parameters[ZE])).join(";")).concat(this.eol)}printRtpMap(uE,SE){return SE?"a=rtpmap:".concat(uE).concat(_p).concat(SE.encodingName,"/").concat(SE.clockRate).concat(SE.encodingParameters?"/".concat(SE.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(uE,SE){let CE="a=rtcp-fb:".concat(uE).concat(_p),ZE=SE;return ZE.type==="trr-int"?CE+="ttr-int".concat(_p).concat(ZE.interval):(CE+="".concat(ZE.type),ZE.parameter&&(CE+="".concat(_p).concat(ZE.parameter),ZE.additional&&(CE+="".concat(_p).concat(ZE.additional)))),CE+this.eol}printPtime(uE){return uE===void 0?"":"a=ptime:".concat(uE).concat(this.eol)}printMaxPtime(uE){return uE===void 0?"":"a=maxptime:".concat(uE).concat(this.eol)}printDirection(uE){return uE===void 0?"":"a=".concat(uE).concat(this.eol)}printSSRC(uE){return uE.map(SE=>Object.keys(SE.attributes).map(CE=>"a=ssrc:".concat(SE.ssrcId.toString(10)).concat(_p).concat(CE).concat(SE.attributes[CE]?":".concat(SE.attributes[CE]):"").concat(this.eol)).join("")).join("")}printRTCPMux(uE){return uE===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(uE){return uE===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(uE){return uE===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(uE){if(uE===void 0)return"";let SE="a=rtcp:".concat(uE.port);return uE.netType&&(SE+="".concat(_p).concat(uE.netType)),uE.addressType&&(SE+="".concat(_p).concat(uE.addressType)),uE.address&&(SE+="".concat(_p).concat(uE.address)),SE+this.eol}printMSId(uE){return uE.map(SE=>"a=msid:".concat(SE.id).concat(SE.appdata?"".concat(_p).concat(SE.appdata):"").concat(this.eol)).join("")}printImageattr(uE){return uE.map(SE=>"a=imageattr:".concat(SE).concat(this.eol)).join("")}printRid(uE){return uE.map(SE=>{let CE="a=rid:".concat(SE.id).concat(_p).concat(SE.direction);return SE.payloads&&(CE+="".concat(_p,"pt=").concat(SE.payloads.join(","))),SE.params.length>0&&(CE+="".concat(_p).concat(SE.params.map(ZE=>ZE.type==="depend"?"depend=".concat(ZE.rids.join(",")):"".concat(ZE.type,"=").concat(ZE.val)).join(";"))),CE+this.eol}).join("")}printSimulcast(uE){return uE===void 0?"":"a=simulcast:".concat(uE).concat(this.eol)}printSCTPPort(uE){return uE===void 0?"":"a=sctp-port:".concat(uE).concat(this.eol)}printMaxMessageSize(uE){return uE===void 0?"":"a=max-message-size:".concat(uE).concat(this.eol)}printMid(uE){return uE===void 0?"":"a=mid:".concat(uE).concat(this.eol)}printSSRCGroups(uE){return uE.map(SE=>"a=ssrc-group:".concat(SE.semantic).concat(SE.ssrcIds.map(CE=>"".concat(_p).concat(CE.toString(10))).join("")).concat(this.eol)).join("")}}function w_(r_){return new V_().parse(r_)}function X_(r_,uE){return new _R().print(r_,uE)}}},Wt={};function _n(_i){if(Wt[_i])return Wt[_i].exports;var _s=Wt[_i]={exports:{}};return _t[_i](_s,_s.exports,_n),_s.exports}return _n.d=(_i,_s)=>{for(var _c in _s)_n.o(_s,_c)&&!_n.o(_i,_c)&&Object.defineProperty(_i,_c,{enumerable:!0,get:_s[_c]})},_n.o=(_i,_s)=>Object.prototype.hasOwnProperty.call(_i,_s),_n.r=_i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_i,"__esModule",{value:!0})},_n(8)})()})(u9);var N0=u9.exports;function fR($){if(Array.isArray($))return $.map(_t=>_t);if(!d9($))return $;const _e={};for(const _t in $){const Wt=$[_t];d9(Wt)||Array.isArray(Wt)?_e[_t]=fR(Wt):_e[_t]=Wt}return _e}function d9($){return!(typeof $!="object"||Array.isArray($)||!$)}class r8{constructor(_e){hE(this,"input",[]),hE(this,"size",void 0),this.size=_e}add(_e){this.input.push(_e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const a1={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},xP={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:a1,remoteCandidate:a1}},h9={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0},p9={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},f9={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},m9={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function g9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function E9($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?g9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):g9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class i8{constructor(_e,_t){hE(this,"onFirstVideoReceived",void 0),hE(this,"onFirstVideoDecoded",void 0),hE(this,"onFirstAudioReceived",void 0),hE(this,"onFirstVideoDecodedTimeout",void 0),hE(this,"onFirstAudioDecoded",void 0),hE(this,"onSelectedLocalCandidateChanged",void 0),hE(this,"onSelectedRemoteCandidateChanged",void 0),hE(this,"videoIsReady",!1),hE(this,"videoIsReady2",{}),hE(this,"pc",void 0),hE(this,"options",void 0),hE(this,"intervalTimer",void 0),hE(this,"stats",fR(xP)),hE(this,"isFirstVideoReceived",{}),hE(this,"isFirstVideoDecoded",{}),hE(this,"isFirstAudioReceived",{}),hE(this,"isFirstAudioDecoded",{}),hE(this,"isFirstVideoDecodedTimeout",{}),hE(this,"lossRateWindowStats",[]),this.pc=_e,this.options=_t,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new n_(_e=>{_e({local:E9({},a1),remote:E9({},a1)})})}setVideoIsReady(_e){this.videoIsReady=_e}setVideoIsReady2(_e,_t){this.videoIsReady2[_e]=_t}getVideoIsReady(_e){return this.videoIsReady2[_e]||!1}setIsFirstAudioDecoded(_e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(_e){this.lossRateWindowStats.push(_e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const _t=this.lossRateWindowStats.length,Wt=["videoSend","audioSend","videoRecv","audioRecv"];let _n=0,_i=0,_s=0,_c=0;for(const _u of Wt)_e[_u].forEach((_h,_p)=>{if(!this.lossRateWindowStats[_t-1][_u][_p]||!this.lossRateWindowStats[0][_u][_p])return;const Qm=this.lossRateWindowStats[_t-1][_u][_p].packets-this.lossRateWindowStats[0][_u][_p].packets,_g=this.lossRateWindowStats[_t-1][_u][_p].packetsLost-this.lossRateWindowStats[0][_u][_p].packetsLost;_u==="videoSend"||_u==="audioSend"?(_n+=Qm,_s+=_g):(_i+=Qm,_c+=_g),Number.isNaN(Qm)||Number.isNaN(Qm)?_h.packetLostRate=0:_h.packetLostRate=Qm<=0||_g<=0?0:_g/(Qm+_g)});_e.sendPacketLossRate=_n<=0||_s<=0?0:_s/(_n+_s),_e.recvPacketLossRate=_i<=0||_c<=0?0:_c/(_i+_c)}}function v9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function Ehe($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?v9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):v9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class vhe extends i8{constructor(){super(...arguments),hE(this,"_stats",xP),hE(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const _e=await this._getStats(),_t=this.statsResponsesToObjects(_e);this._stats=fR(xP);const Wt=_t.filter(_i=>_i.type==="ssrc");this.processSSRCStats(Wt);const _n=_t.find(_i=>_i.type==="VideoBwe");_n&&this.processBandwidthStats(_n),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(_e){this._stats.bitrate={actualEncoded:Number(_e.googActualEncBitrate),targetEncoded:Number(_e.googTargetEncBitrate),retransmit:Number(_e.googRetransmitBitrate),transmit:Number(_e.googTransmitBitrate)},this._stats.sendBandwidth=Number(_e.googAvailableSendBandwidth)}processSSRCStats(_e){_e.forEach(_t=>{var Wt;const _n=i_(Wt=_t.id).call(Wt,"send");switch("".concat(_t.mediaType,"_").concat(_n?"send":"recv")){case"video_send":{const _i=fR(p9);_i.codec=_t.googCodecName,_i.adaptionChangeReason="none",_t.googCpuLimitedResolution&&(_i.adaptionChangeReason="cpu"),_t.googBandwidthLimitedResolution&&(_i.adaptionChangeReason="bandwidth"),_i.avgEncodeMs=Number(_t.googAvgEncodeMs),_i.inputFrame={width:Number(_t.googFrameWidthInput)||Number(_t.googFrameWidthSent),height:Number(_t.googFrameHeightInput)||Number(_t.googFrameHeightSent),frameRate:Number(_t.googFrameRateInput)},_i.sentFrame={width:Number(_t.googFrameWidthSent),height:Number(_t.googFrameHeightSent),frameRate:Number(_t.googFrameRateInput)},_i.firsCount=Number(_t.googFirReceived),_i.nacksCount=Number(_t.googNacksReceived),_i.plisCount=Number(_t.googPlisReceived),_i.frameCount=Number(_t.framesEncoded),_i.bytes=Number(_t.bytesSent),_i.packets=Number(_t.packetsSent),_i.packetsLost=Number(_t.packetsLost),_i.ssrc=Number(_t.ssrc),_i.rttMs=Number(_t.googRtt||0),this._stats.videoSend.push(_i),this._stats.rtt=_i.rttMs;break}case"video_recv":{const _i=fR(h9),_s=this.lastDecodeVideoReceiverStats.get(Number(_t.ssrc));if(_i.codec=_t.googCodecName,_i.targetDelayMs=Number(_t.googTargetDelayMs),_i.renderDelayMs=Number(_t.googRenderDelayMs),_i.currentDelayMs=Number(_t.googCurrentDelayMs),_i.minPlayoutDelayMs=Number(_t.googMinPlayoutDelayMs),_i.decodeMs=Number(_t.googDecodeMs),_i.maxDecodeMs=Number(_t.googMaxDecodeMs),_i.receivedFrame={width:Number(_t.googFrameWidthReceived),height:Number(_t.googFrameHeightReceived),frameRate:Number(_t.googFrameRateReceived)},_i.decodedFrame={width:Number(_t.googFrameWidthReceived),height:Number(_t.googFrameHeightReceived),frameRate:Number(_t.googFrameRateDecoded)},_i.decodeFrameRate=Number(_t.googFrameRateDecoded),_i.outputFrame={width:Number(_t.googFrameWidthReceived),height:Number(_t.googFrameHeightReceived),frameRate:Number(_t.googFrameRateOutput)},_i.jitterBufferMs=Number(_t.googJitterBufferMs),_i.firsCount=Number(_t.googFirsSent),_i.nacksCount=Number(_t.googNacksSent),_i.plisCount=Number(_t.googPlisSent),_i.framesDecodeCount=Number(_t.framesDecoded),_i.bytes=Number(_t.bytesReceived),_i.packets=Number(_t.packetsReceived),_i.packetsLost=Number(_t.packetsLost),_i.ssrc=Number(_t.ssrc),_i.packets>0&&!this.isFirstVideoReceived[_i.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(_i.ssrc),this.isFirstVideoReceived[_i.ssrc]=!0),_i.framesDecodeCount>0&&!this.isFirstVideoDecoded[_i.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(_i.ssrc,_i.decodedFrame.width,_i.decodedFrame.height),this.isFirstVideoDecoded[_i.ssrc]=!0),_s){const _c=_s.stats,_u=Date.now()-_s.lts;_i.framesDecodeFreezeTime=_c.framesDecodeFreezeTime,_i.framesDecodeInterval=_c.framesDecodeInterval,_i.framesDecodeCount>_c.framesDecodeCount&&this.isFirstVideoDecoded[_i.ssrc]?(_s.lts=Date.now(),_i.framesDecodeInterval=_u,_i.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(_t.ssrc,10))?_i.framesDecodeFreezeTime+=_i.framesDecodeInterval:this.setVideoIsReady2(parseInt(_t.ssrc,10),!0))):_i.framesDecodeCount<_s.stats.framesDecodeCount&&(_i.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(_i.ssrc,{stats:Ehe({},_i),lts:Date.now()}),this._stats.videoRecv.push(_i);break}case"audio_recv":{const _i=fR(m9);_i.codec=_t.googCodecName,_i.outputLevel=Math.abs(Number(_t.audioOutputLevel))/32767,_i.decodingCNG=Number(_t.googDecodingCNG),_i.decodingCTN=Number(_t.googDecodingCTN),_i.decodingCTSG=Number(_t.googDecodingCTSG),_i.decodingNormal=Number(_t.googDecodingNormal),_i.decodingPLC=Number(_t.googDecodingPLC),_i.decodingPLCCNG=Number(_t.googDecodingPLCCNG),_i.expandRate=Number(_t.googExpandRate),_i.accelerateRate=Number(_t.googAccelerateRate),_i.preemptiveExpandRate=Number(_t.googPreemptiveExpandRate),_i.secondaryDecodedRate=Number(_t.googSecondaryDecodedRate),_i.speechExpandRate=Number(_t.googSpeechExpandRate),_i.preferredJitterBufferMs=Number(_t.googPreferredJitterBufferMs),_i.jitterBufferMs=Number(_t.googJitterBufferMs),_i.jitterMs=Number(_t.googJitterReceived),_i.bytes=Number(_t.bytesReceived),_i.packets=Number(_t.packetsReceived),_i.packetsLost=Number(_t.packetsLost),_i.ssrc=Number(_t.ssrc),_i.receivedFrames=Number(_t.googDecodingCTN)||Number(_t.packetsReceived),_i.droppedFrames=Number(_t.googDecodingPLC)+Number(_t.googDecodingPLCCNG)||Number(_t.packetsLost),_i.receivedFrames>0&&!this.isFirstAudioReceived[_i.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(_i.ssrc),this.isFirstAudioReceived[_i.ssrc]=!0),_i.decodingNormal>0&&!this.isFirstAudioDecoded[_i.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(_i.ssrc),this.isFirstAudioDecoded[_i.ssrc]=!0),this._stats.audioRecv.push(_i);break}case"audio_send":{const _i=fR(f9);_i.codec=_t.googCodecName,_i.inputLevel=Math.abs(Number(_t.audioInputLevel))/32767,_i.aecReturnLoss=Number(_t.googEchoCancellationReturnLoss||0),_i.aecReturnLossEnhancement=Number(_t.googEchoCancellationReturnLossEnhancement||0),_i.residualEchoLikelihood=Number(_t.googResidualEchoLikelihood||0),_i.residualEchoLikelihoodRecentMax=Number(_t.googResidualEchoLikelihoodRecentMax||0),_i.bytes=Number(_t.bytesSent),_i.packets=Number(_t.packetsSent),_i.packetsLost=Number(_t.packetsLost),_i.ssrc=Number(_t.ssrc),_i.rttMs=Number(_t.googRtt||0),this._stats.rtt=_i.rttMs,this._stats.audioSend.push(_i);break}}})}_getStats(){return new n_((_e,_t)=>{this.pc.getStats(_e,_t)})}statsResponsesToObjects(_e){const _t=[];return _e.result().forEach(Wt=>{const _n={id:Wt.id,timestamp:Wt.timestamp.valueOf().toString(),type:Wt.type};Wt.names().forEach(_i=>{_n[_i]=Wt.stat(_i)}),_t.push(_n)}),_t}}function _9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function YI($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?_9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):_9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class y9 extends i8{constructor(){super(...arguments),hE(this,"_stats",xP),hE(this,"report",void 0),hE(this,"lastDecodeVideoReceiverStats",new Map),hE(this,"lastVideoFramesRecv",new Map),hE(this,"lastVideoFramesSent",new Map),hE(this,"lastVideoFramesDecode",new Map),hE(this,"lastVideoFramesOutput",new Map),hE(this,"lastVideoJBDelay",new Map),hE(this,"lastAudioJBDelay",new Map),hE(this,"mediaBytesSent",new Map),hE(this,"mediaBytesRetransmit",new Map),hE(this,"mediaBytesTargetEncode",new Map),hE(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=fR(xP),this.report.forEach(_e=>{switch(_e.type){case wT.OUTBOUND:case wT.INBOUND:{const _t=_e.mediaType||_e.kind,Wt=!_t&&"frameWidth"in _e,_n=!_t&&!("frameWidth"in _e);_e.type===wT.OUTBOUND?_t==="audio"||_n?this.processAudioOutboundStats(_e):(_t==="video"||Wt)&&this.processVideoOutboundStats(_e):_e.type===wT.INBOUND&&(_t==="audio"||_n?this.processAudioInboundStats(_e):(_t==="video"||Wt)&&this.processVideoInboundStats(_e));break}case wT.TRANSPORT:{const _t=this.report.get(_e.selectedCandidatePairId);_t&&this.processCandidatePairStats(_t);break}case wT.CANDIDATE_PAIR:_e.selected&&this.processCandidatePairStats(_e)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const _e=await this.pc.getStats(),_t={local:YI({},a1),remote:YI({},a1)};return _e.forEach(Wt=>{let _n;if(Wt.type===wT.TRANSPORT&&(_n=_e.get(Wt.selectedCandidatePairId)),Wt.type===wT.CANDIDATE_PAIR&&Wt.selected&&(_n=Wt),_n){const _i=(_s,_c)=>{_s.type=_c.type,_s.id=_c.id,_c.address&&(_s.address=_c.address),_c.candidateType&&(_s.candidateType=_c.candidateType),_c.port&&(_s.port=_c.port),_c.priority&&(_s.priority=_c.priority),_c.protocol&&(_s.protocol=_c.protocol),_c.relayProtocol&&(_s.relayProtocol=_c.relayProtocol)};if(_n.localCandidateId){const _s=_e.get(_n.localCandidateId);_s&&_i(_t.local,_s)}if(_n.remoteCandidateId){const _s=_e.get(_n.remoteCandidateId);_s&&_i(_t.remote,_s)}}}),_t}processCandidatePairStats(_e){if(this._stats.sendBandwidth=_e.availableOutgoingBitrate||0,_e.currentRoundTripTime&&(this._stats.rtt=1e3*_e.currentRoundTripTime),this._stats.videoSend.forEach(_t=>{_e.currentRoundTripTime&&(_t.rttMs=1e3*_e.currentRoundTripTime)}),this._stats.audioSend.forEach(_t=>{_e.currentRoundTripTime&&(_t.rttMs=1e3*_e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=_e.id,_e.localCandidateId){const _t=this.report.get(_e.localCandidateId);_t&&this.processCandidateStats(_t)}if(_e.remoteCandidateId){const _t=this.report.get(_e.remoteCandidateId);_t&&this.processCandidateStats(_t)}}processCandidateStats(_e){let _t;_e.type===wT.LOCAL_CANDIDATE&&(_t=this._stats.selectedCandidatePair.localCandidate),_e.type===wT.REMOTE_CANDIDATE&&(_t=this._stats.selectedCandidatePair.remoteCandidate),_t&&(_t.type=_e.type,_t.id=_e.id,_e.address&&(_t.address=_e.address),_e.candidateType&&(_t.candidateType=_e.candidateType),_e.port&&(_t.port=_e.port),_e.priority&&(_t.priority=_e.priority),_e.protocol&&(_t.protocol=_e.protocol),_e.relayProtocol&&(_t.relayProtocol=_e.relayProtocol),_e.type===wT.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==_t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(YI({},_t),YI({},this.stats.selectedCandidatePair.localCandidate)),_e.type===wT.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==_t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(YI({},_t),YI({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(_e){let _t=this._stats.audioRecv.find(Wt=>Wt.ssrc===_e.ssrc);_t||(_t=fR(m9),this._stats.audioRecv.push(_t)),_t.ssrc=_e.ssrc,_t.packets=_e.packetsReceived,_t.packetsLost=_e.packetsLost,_t.bytes=_e.bytesReceived,_t.jitterMs=1e3*_e.jitter,this.processAudioTrackReceiverStats(_e,_e.trackId,_t),_e.codecId&&(_t.codec=this.getCodecFromCodecStats(_e.codecId)),_t.receivedFrames||(_t.receivedFrames=_e.packetsReceived),_t.droppedFrames||(_t.droppedFrames=_e.packetsLost),_t.receivedFrames>0&&!this.isFirstAudioReceived[_t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(_t.ssrc),this.isFirstAudioReceived[_t.ssrc]=!0),_t.outputLevel&&_t.outputLevel>0&&!this.isFirstAudioDecoded[_t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(_t.ssrc),this.isFirstAudioDecoded[_t.ssrc]=!0),typeof _e.concealedSamples=="number"&&(_t.concealedSamples=_e.concealedSamples)}processVideoInboundStats(_e){let _t=this._stats.videoRecv.find(_c=>_c.ssrc===_e.ssrc);_t||(_t=fR(h9),this._stats.videoRecv.push(_t)),_t.ssrc=_e.ssrc,_t.packets=_e.packetsReceived,_t.packetsLost=_e.packetsLost,_t.bytes=_e.bytesReceived,_t.firsCount=_e.firCount,_t.nacksCount=_e.nackCount,_t.plisCount=_e.pliCount,_t.framesDecodeCount=_e.framesDecoded,_t.framesDroppedCount=_e.framesDropped,_t.totalInterFrameDelay=_e.totalInterFrameDelay,_t.totalSquaredInterFrameDelay=_e.totalSquaredInterFrameDelay,_t.totalFreezesDuration=_e.totalFreezesDuration;const Wt=this.lastDecodeVideoReceiverStats.get(_t.ssrc),_n=this.lastVideoFramesDecode.get(_t.ssrc),_i=this.lastVideoFramesOutput.get(_t.ssrc),_s=Date.now();if(_t.framesDecodeCount>0&&!this.isFirstVideoDecoded[_t.ssrc]){const _c=_t.decodedFrame?_t.decodedFrame.width:0,_u=_t.decodedFrame?_t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(_t.ssrc,_c,_u),this.isFirstVideoDecoded[_t.ssrc]=!0}if(Wt){const _c=Wt.stats,_u=_s-Wt.lts;_t.framesDecodeFreezeTime=_c.framesDecodeFreezeTime,_t.framesDecodeInterval=_c.framesDecodeInterval,!this.isFirstVideoDecoded[_t.ssrc]&&_u>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[_t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(_t.ssrc),this.isFirstVideoDecodedTimeout[_t.ssrc]=!0),_t.framesDecodeCount>_c.framesDecodeCount&&this.isFirstVideoDecoded[_t.ssrc]?(Wt.lts=Date.now(),_t.framesDecodeInterval=_u,_t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(_e.ssrc))?_t.framesDecodeFreezeTime+=_t.framesDecodeInterval:this.setVideoIsReady2(parseInt(_e.ssrc,10),!0))):_t.framesDecodeCount<_c.framesDecodeCount&&(_t.framesDecodeInterval=0),_e.framesDecoded&&_e.qpSum&&(Wt.stats.framesDecodeCount>_e.framesDecoded?_t.qpSumPerFrame=_e.qpSum/_e.framesDecoded:_t.qpSumPerFrame=(_e.qpSum-Wt.qpSum)/(_e.framesDecoded-Wt.stats.framesDecodeCount))}_n&&_s-_n.lts>=800?(_t.decodeFrameRate=Math.round((_t.framesDecodeCount-_n.count)/((_s-_n.lts)/1e3)),this.lastVideoFramesDecode.set(_t.ssrc,{count:_t.framesDecodeCount,lts:_s,rate:_t.decodeFrameRate})):_n?_t.decodeFrameRate=_n.rate:this.lastVideoFramesDecode.set(_t.ssrc,{count:_t.framesDecodeCount,lts:_s,rate:0}),_t.framesDroppedCount&&_e.framesReceived&&(_i&&_s-_i.lts>=800?(_t.outputFrameRate=Math.round((_e.framesReceived-_t.framesDroppedCount-_i.count)/((_s-_i.lts)/1e3)),this.lastVideoFramesOutput.set(_t.ssrc,{count:_e.framesReceived-_t.framesDroppedCount,lts:_s,rate:Math.max(_t.outputFrameRate,0)})):_i?_t.outputFrameRate=_i.rate:this.lastVideoFramesOutput.set(_t.ssrc,{count:_e.framesReceived-_t.framesDroppedCount,lts:_s,rate:0})),_e.totalDecodeTime&&(_t.decodeMs=1e3*_e.totalDecodeTime),this.processVideoTrackReceiverStats(_e,_e.trackId,_t),_e.codecId&&(_t.codec=this.getCodecFromCodecStats(_e.codecId)),_e.framerateMean&&(_t.framesRateFirefox=_e.framerateMean),_t.packets>0&&!this.isFirstVideoReceived[_t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(_t.ssrc),this.isFirstVideoReceived[_t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(_t.ssrc,{stats:YI({},_t),lts:Wt?Wt.lts:Date.now(),qpSum:_e.qpSum})}processVideoOutboundStats(_e){let _t=this._stats.videoSend.find(_n=>_n.ssrc===_e.ssrc);_t||(_t=fR(p9),this._stats.videoSend.push(_t));const Wt=this.mediaBytesSent.get(_e.ssrc);if(Wt)Wt.add(_e.bytesSent);else{const _n=new r8(10);_n.add(_e.bytesSent),this.mediaBytesSent.set(_e.ssrc,_n)}if(_e.retransmittedBytesSent!==void 0){const _n=this.mediaBytesRetransmit.get(_e.ssrc);if(_n)_n.add(_e.retransmittedBytesSent);else{const _i=new r8(10);_i.add(_e.retransmittedBytesSent),this.mediaBytesRetransmit.set(_e.ssrc,_i)}}if(_e.totalEncodedBytesTarget){const _n=this.mediaBytesTargetEncode.get(_e.ssrc);if(_n)_n.add(_e.totalEncodedBytesTarget);else{const _i=new r8(10);_i.add(_e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(_e.ssrc,_i)}}if(_t.ssrc=_e.ssrc,_t.bytes=_e.bytesSent,_t.packets=_e.packetsSent,_t.firsCount=_e.firCount,_t.nacksCount=_e.nackCount,_t.plisCount=_e.pliCount,_t.frameCount=_e.framesEncoded,_t.adaptionChangeReason=_e.qualityLimitationReason,_t.scalabilityMode=_e.scalabilityMode,_e.totalEncodeTime&&_e.framesEncoded){const _n=this.lastEncoderMs.get(_e.ssrc);if(!_n||_n.lastFrameCount>_e.framesEncoded)_t.avgEncodeMs=1e3*_e.totalEncodeTime/_e.framesEncoded;else{const _i=_e.framesEncoded-_n.lastFrameCount,_s=_e.totalEncodeTime-_n.lastEncoderTime;_t.avgEncodeMs=1e3*_s/_i}}if(_e.framesEncoded&&_e.qpSum){const _n=this.lastEncoderMs.get(_e.ssrc);!_n||_n.lastFrameCount>_e.framesEncoded?_t.qpSumPerFrame=_e.qpSum/_e.framesEncoded:_t.qpSumPerFrame=(_e.qpSum-_n.lastQpSum)/(_e.framesEncoded-_n.lastFrameCount)}if(this.lastEncoderMs.set(_e.ssrc,{lastFrameCount:_e.framesEncoded,lastEncoderTime:_e.totalEncodeTime,lastQpSum:_e.qpSum,lts:Date.now()}),_e.codecId&&(_t.codec=this.getCodecFromCodecStats(_e.codecId)),_e.mediaSourceId&&this.processVideoMediaSource(_e.mediaSourceId,_t),this.processVideoTrackSenderStats(_e,_e.trackId,_t),_e.remoteId)this.processRemoteInboundStats(_e.remoteId,_t);else{const _n=this.findRemoteStatsId(_e.ssrc,wT.REMOTE_INBOUND);_n&&this.processRemoteInboundStats(_n,_t)}}processAudioOutboundStats(_e){let _t=this._stats.audioSend.find(Wt=>Wt.ssrc===_e.ssrc);if(_t||(_t=fR(f9),this._stats.audioSend.push(_t)),_t.ssrc=_e.ssrc,_t.packets=_e.packetsSent,_t.bytes=_e.bytesSent,_e.mediaSourceId&&this.processAudioMediaSource(_e.mediaSourceId,_t),_e.codecId&&(_t.codec=this.getCodecFromCodecStats(_e.codecId)),this.processAudioTrackSenderStats(_e,_e.trackId,_t),_e.remoteId)this.processRemoteInboundStats(_e.remoteId,_t);else{const Wt=this.findRemoteStatsId(_e.ssrc,wT.REMOTE_INBOUND);Wt&&this.processRemoteInboundStats(Wt,_t)}}findRemoteStatsId(_e,_t){var Wt;const _n=Array.from(AR(Wt=this.report).call(Wt)).find(_i=>_i.type===_t&&_i.ssrc===_e);return _n?_n.id:null}processVideoMediaSource(_e,_t){const Wt=this.report.get(_e);Wt&&Wt.width&&Wt.height&&Wt.framesPerSecond&&(_t.inputFrame={width:Wt.width,height:Wt.height,frameRate:Wt.framesPerSecond})}processAudioMediaSource(_e,_t){const Wt=this.report.get(_e);Wt&&(_t.inputLevel=Wt.audioLevel)}processVideoTrackSenderStats(_e,_t,Wt){var _n,_i,_s,_c;const _u=_t?this.report.get(_t):void 0,_h=(_n=_u==null?void 0:_u.framesSent)!==null&&_n!==void 0?_n:_e.framesSent;if(typeof _h!="number")return;let _p=(_i=_u==null?void 0:_u.frameWidth)!==null&&_i!==void 0?_i:_e.frameWidth,Qm=(_s=_u==null?void 0:_u.frameHeight)!==null&&_s!==void 0?_s:_e.frameHeight,_g=(_c=_u==null?void 0:_u.framesPerSecond)!==null&&_c!==void 0?_c:_e.framesPerSecond;if(typeof _p=="number"&&typeof Qm=="number"||(_p=0,Qm=0),_g==null){const eE=Date.now(),pE=this.lastVideoFramesSent.get(Wt.ssrc);pE&&eE-pE.lts>=800?(_g=Math.round((_h-pE.count)/((eE-pE.lts)/1e3)),this.lastVideoFramesSent.set(Wt.ssrc,{count:_h,lts:eE,rate:_g})):pE?_g=pE.rate:this.lastVideoFramesSent.set(Wt.ssrc,{count:_h,lts:eE,rate:0})}Wt.sentFrame={width:_p,height:Qm,frameRate:Math.max(0,_g)}}processVideoTrackReceiverStats(_e,_t,Wt){var _n,_i,_s,_c,_u;const _h=_t?this.report.get(_t):void 0,_p=(_n=_h==null?void 0:_h.framesReceived)!==null&&_n!==void 0?_n:_e.framesReceived,Qm=(_i=_h==null?void 0:_h.frameWidth)!==null&&_i!==void 0?_i:_e.frameWidth,_g=(_s=_h==null?void 0:_h.frameHeight)!==null&&_s!==void 0?_s:_e.frameHeight,eE=(_c=_h==null?void 0:_h.jitterBufferDelay)!==null&&_c!==void 0?_c:_e.jitterBufferDelay,pE=(_u=_h==null?void 0:_h.jitterBufferEmittedCount)!==null&&_u!==void 0?_u:_e.jitterBufferEmittedCount;if(typeof _p=="number"){const aE=this.lastVideoFramesRecv.get(Wt.ssrc),cE=Date.now();Wt.framesReceivedCount=_p;let fE=0;aE&&cE-aE.lts>=800?(fE=Math.round((_p-aE.count)/((cE-aE.lts)/1e3)),this.lastVideoFramesRecv.set(Wt.ssrc,{count:_p,lts:cE,rate:fE})):aE?fE=aE.rate:this.lastVideoFramesRecv.set(Wt.ssrc,{count:_p,lts:cE,rate:0}),Wt.receivedFrame={width:Qm||0,height:_g||0,frameRate:fE||0},Wt.decodedFrame={width:Qm||0,height:_g||0,frameRate:Wt.decodeFrameRate||0},Wt.outputFrame={width:Qm||0,height:_g||0,frameRate:Wt.outputFrameRate||Wt.decodeFrameRate||0}}if(eE&&pE){const aE=this.lastVideoJBDelay.get(Wt.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let cE=aE.jitterBufferMs;const fE=pE-aE.jitterBufferEmittedCount;fE>0&&(cE=1e3*(eE-aE.jitterBufferDelay)/fE),Wt.jitterBufferMs=cE,Wt.currentDelayMs=Math.round(cE),this.lastVideoJBDelay.set(Wt.ssrc,{jitterBufferDelay:eE,jitterBufferEmittedCount:pE,jitterBufferMs:Wt.currentDelayMs})}}processAudioTrackSenderStats(_e,_t,Wt){var _n,_i,_s,_c;const _u=_t?this.report.get(_t):void 0,_h=(_n=(_i=_u==null?void 0:_u.echoReturnLoss)!==null&&_i!==void 0?_i:_e.echoReturnLoss)!==null&&_n!==void 0?_n:0,_p=(_s=(_c=_u==null?void 0:_u.echoReturnLossEnhancement)!==null&&_c!==void 0?_c:_e.echoReturnLossEnhancement)!==null&&_s!==void 0?_s:0;Wt.aecReturnLoss=_h,Wt.aecReturnLossEnhancement=_p}processAudioTrackReceiverStats(_e,_t,Wt){var _n,_i,_s,_c,_u,_h,_p;const Qm=_t?this.report.get(_t):void 0,_g=(_n=Qm==null?void 0:Qm.removedSamplesForAcceleration)!==null&&_n!==void 0?_n:_e.removedSamplesForAcceleration,eE=(_i=Qm==null?void 0:Qm.totalSamplesReceived)!==null&&_i!==void 0?_i:_e.totalSamplesReceived,pE=(_s=Qm==null?void 0:Qm.jitterBufferDelay)!==null&&_s!==void 0?_s:_e.jitterBufferDelay,aE=(_c=Qm==null?void 0:Qm.jitterBufferEmittedCount)!==null&&_c!==void 0?_c:_e.jitterBufferEmittedCount,cE=(_u=Qm==null?void 0:Qm.audioLevel)!==null&&_u!==void 0?_u:_e==null?void 0:_e.audioLevel,fE=(_h=Qm==null?void 0:Qm.totalSamplesDuration)!==null&&_h!==void 0?_h:_e==null?void 0:_e.totalSamplesDuration,gE=(_p=Qm==null?void 0:Qm.concealedSamples)!==null&&_p!==void 0?_p:_e.concealedSamples;if(_g&&eE&&(Wt.accelerateRate=_g/eE),pE&&aE){const PE=this.lastAudioJBDelay.get(Wt.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let xE=PE.jitterBufferMs;const GE=aE-PE.jitterBufferEmittedCount;GE>0&&(xE=1e3*(pE-PE.jitterBufferDelay)/GE),Wt.jitterBufferMs=Math.round(xE),this.lastAudioJBDelay.set(Wt.ssrc,{jitterBufferDelay:pE,jitterBufferEmittedCount:aE,jitterBufferMs:Wt.jitterBufferMs})}Wt.outputLevel=cE;let AE=1920;fE&&eE&&(AE=eE/fE/50,Wt.receivedFrames=Math.round(eE/AE)),gE&&(Wt.droppedFrames=Math.round(gE/AE))}processRemoteInboundStats(_e,_t){const Wt=this.report.get(_e);Wt&&(_t.packetsLost=Wt.packetsLost,Wt.roundTripTime&&(_t.rttMs=1e3*Wt.roundTripTime),Wt.jitter&&(_t.jitterMs=1e3*Wt.jitter),Wt.timestamp&&(_t.timestamp=Wt.timestamp))}getCodecFromCodecStats(_e){const _t=this.report.get(_e);if(!_t)return"";const Wt=_t.mimeType.match(/\/(.*)$/);return Wt&&Wt[1]?Wt[1]:""}updateSendBitrate(){let _e=0,_t=null,Wt=null;this.mediaBytesSent.forEach(_i=>{_e+=_i.diffMean()}),this.mediaBytesRetransmit.forEach(_i=>{_t=_t===null?_i.diffMean():_t+_i.diffMean()}),this.mediaBytesTargetEncode.forEach(_i=>{Wt=Wt===null?_i.diffMean():Wt+_i.diffMean()});const _n=_t!==null?_e-_t:_e;this._stats.bitrate={actualEncoded:8*_n/(this.options.updateInterval/1e3),transmit:8*_e/(this.options.updateInterval/1e3)},_t!==null&&(this._stats.bitrate.retransmit=8*_t/(this.options.updateInterval/1e3)),Wt!==null&&(this._stats.bitrate.targetEncoded=8*Wt/(this.options.updateInterval/1e3))}}class _he extends i8{updateStats(){return n_.resolve()}}function gM($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,_t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,Wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,_n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const _i=function(){const _s=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return _s&&_s[0]?Number(_s[0].split("/")[1]):null}();return _i?_i<76?new vhe($,{updateInterval:_e,lossRateInterval:_t,freezeRateLimit:Wt,firstVideoDecodedTimeout:_n}):new y9($,{updateInterval:_e,lossRateInterval:_t,freezeRateLimit:Wt,firstVideoDecodedTimeout:_n}):function(_s){return!!window.RTCStatsReport&&_s.getStats()instanceof n_}($)?new y9($,{updateInterval:_e,lossRateInterval:_t,freezeRateLimit:Wt,firstVideoDecodedTimeout:_n}):new _he($,{updateInterval:_e,lossRateInterval:_t,freezeRateLimit:Wt,firstVideoDecodedTimeout:_n})}function b9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function S9($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?b9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):b9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function MP($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Wt=arguments.length>3?arguments[3]:void 0;const{filterRTX:_n,filterVideoFec:_i,filterAudioFec:_s,filterAudioCodec:_c,filterVideoCodec:_u}=_e,{useXR:_h}=_t;let _p=[],Qm=[],_g=[],eE=[],pE=!1,aE=!1;if(N0.parse($).mediaDescriptions.forEach(fE=>{Wt&&Wt!==fE.attributes.direction||(fE.media.mediaType!=="video"||pE||(Qm=fE.attributes.payloads,eE=fE.attributes.extmaps,pE=!0),fE.media.mediaType!=="audio"||aE||(_p=fE.attributes.payloads,_g=fE.attributes.extmaps,aE=!0))}),!eE||Qm.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!_g||_p.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(Qm.forEach(fE=>{var gE;(gE=fE.rtpMap)!==null&&gE!==void 0&&gE.clockRate&&(fE.rtpMap.clockRate=parseInt(fE.rtpMap.clockRate)),_h&&fE.rtcpFeedbacks.push({type:"rrtr"})}),_p.forEach(fE=>{var gE;(gE=fE.rtpMap)!==null&&gE!==void 0&&gE.clockRate&&(fE.rtpMap.clockRate=parseInt(fE.rtpMap.clockRate)),_h&&fE.rtcpFeedbacks.push({type:"rrtr"})}),_n&&(_p=_p.filter(fE=>{var gE;return((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLowerCase())!=="rtx"}),Qm=Qm.filter(fE=>{var gE;return((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLowerCase())!=="rtx"})),_i&&(Qm=Qm.filter(fE=>{var gE;return!/(red)|(ulpfec)|(flexfec)/i.test(((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName)||"")})),_s&&(_p=_p.filter(fE=>{var gE;return!/(red)|(ulpfec)|(flexfec)/i.test(((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName)||"")})),_c&&(_c==null?void 0:_c.length)>0&&(_p=_p.filter(fE=>{var gE;return i_(_c).call(_c,((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLowerCase())||"")})),_u&&(_u==null?void 0:_u.length)>0){const fE=Qm.filter(gE=>{var AE;return i_(_u).call(_u,((AE=gE.rtpMap)===null||AE===void 0?void 0:AE.encodingName.toLowerCase())||"")});Qm=fE.concat(_n?[]:l8(fE,Qm))}const cE=yE("UNSUPPORTED_VIDEO_CODEC");return cE&&cE.length>0&&(Qm=Qm.filter(fE=>!(fE.rtpMap&&i_(cE).call(cE,fE.rtpMap.encodingName.toLowerCase())))),{audioCodecs:_p,videoCodecs:Qm,audioExtensions:_g,videoExtensions:eE}}function LR($){const _e=N0.parse($);let _t,Wt;for(const _n of _e.mediaDescriptions){if(!_t){const _i=_n.attributes.iceUfrag,_s=_n.attributes.icePwd;if(!_i||!_s)throw new Error("Cannot get iceUfrag or icePwd from SDP.");_t={iceUfrag:_i,icePwd:_s}}if(!Wt){const _i=_n.attributes.fingerprints;_i.length>0&&(Wt={fingerprints:_i})}}if(!Wt&&_e.attributes.fingerprints.length>0&&(Wt={fingerprints:_e.attributes.fingerprints}),!Wt||!_t)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:_t,dtlsParameters:Wt}}function o8($,_e){const _t=[],Wt=$.attributes.ssrcGroups.filter(_s=>_s.semantic==="FID"),_n=$.attributes.ssrcGroups.find(_s=>_s.semantic==="SIM"),_i=$.attributes.ssrcs;if(_n)_n.ssrcIds.forEach(_s=>{var _c;const _u=(_c=Wt.find(_h=>_h.ssrcIds[0]===_s))===null||_c===void 0?void 0:_c.ssrcIds[1];_t.push({ssrcId:_s,rtx:_e?_u:void 0})});else if(Wt.length>0){const _s=Wt[0].ssrcIds[0],_c=Wt[0].ssrcIds[1];_t.push({ssrcId:_s,rtx:_e?_c:void 0})}else{if(_i.length===0)throw new Error("No ssrcs found on local media description.");_t.push({ssrcId:_i[0].ssrcId})}return _t}function T9($,_e){const{cname:_t}=$;let Wt;_e&&_e.ip&&typeof _e.port=="number"?(Wt=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_e.ip,port:_e.port.toString(),type:"host",extension:{}}],iE.debug("Using remote candidate from AP ".concat(_e.ip,":").concat(_e.port)),_e.ip6&&(Wt.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_e.ip6,port:_e.port.toString(),type:"host",extension:{}}),iE.debug("Using IPV6 remote candidate from AP ".concat(_e.ip6,":").concat(_e.port)))):Wt=$.iceParameters.candidates.map(_c=>({foundation:_c.foundation,componentId:"1",transport:_c.protocol,priority:_c.priority.toString(),connectionAddress:_c.ip,port:_c.port.toString(),type:_c.type,extension:{}}));const _n={fingerprints:$.dtlsParameters.fingerprints.map(_c=>({hashFunction:_c.algorithm,fingerprint:_c.fingerprint}))},_i={iceUfrag:$.iceParameters.iceUfrag,icePwd:$.iceParameters.icePwd};let _s;switch($.dtlsParameters.role){case"server":_s="passive";break;case"client":_s="active";break;case"auto":_s="actpass"}return{dtlsParameters:_n,iceParameters:_i,candidates:Wt,rtpCapabilities:aN($.rtpCapabilities),setup:_s,cname:_t}}function DT($,_e,_t){const Wt=[],_n=[];return $.forEach(_i=>{let{ssrcId:_s,rtx:_c}=_i;const _u=f0(8,"track-"),_h={ssrcId:_s,attributes:S9({label:_u,mslabel:_t=_t||f0(10,""),msid:"".concat(_t," ").concat(_u)},_e&&{cname:_e})};if(Wt.push(_h),_c!==void 0){const _p={ssrcId:_c,attributes:S9({label:_u,mslabel:_t,msid:"".concat(_t," ").concat(_u)},_e&&{cname:_e})};Wt.push(_p),_n.push({semantic:"FID",ssrcIds:[_s,_c]})}}),$.length>1&&_n.push({semantic:"SIM",ssrcIds:$.map(_i=>{let{ssrcId:_s}=_i;return _s})}),{ssrcs:Wt,ssrcGroups:_n}}function oI($,_e){_e instanceof V0&&$.attributes.payloads.forEach(_t=>{var Wt;const _n=(Wt=_t.rtpMap)===null||Wt===void 0?void 0:Wt.encodingName.toLowerCase();if(!_n||["opus","pcmu","pcma","g722"].indexOf(_n)===-1)return;_t.fmtp||(_t.fmtp={parameters:{}}),_t.fmtp.parameters.minptime="10",_t.fmtp.parameters.useinbandfec="1";const _i=_e._encoderConfig;_i&&_n!=="pcmu"&&_n!=="pcma"&&_n!=="g722"&&(_i.bitrate&&!h0()&&(_t.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*_i.bitrate))),_i.sampleRate&&(_t.fmtp.parameters.maxplaybackrate="".concat(_i.sampleRate),_t.fmtp.parameters["sprop-maxcapturerate"]="".concat(_i.sampleRate)),_i.stereo&&(_t.fmtp.parameters.stereo="1",_t.fmtp.parameters["sprop-stereo"]="1"))})}function EM($){const _e=$.attributes.unrecognized.findIndex(_t=>_t.attField==="x-google-flag"&&_t.attValue==="conference");_e!==-1&&$.attributes.unrecognized.splice(_e,1)}function vM($,_e){var _t;if(!(_e instanceof m0&&_e._encoderConfig&&_e._hints.indexOf(S0.SCREEN_TRACK)===-1))return;const Wt=_e._encoderConfig;B_().supportMinBitrate&&Wt.bitrateMin&&$.attributes.payloads.forEach(_n=>{var _i,_s;i_(_i=["h264","h265","vp8","vp9","av1"]).call(_i,((_s=_n.rtpMap)===null||_s===void 0?void 0:_s.encodingName.toLowerCase())||"")&&(_n.fmtp||(_n.fmtp={parameters:{}}),_n.fmtp.parameters["x-google-min-bitrate"]="".concat(Wt.bitrateMin))}),B_().supportMinBitrate&&!i_(_t=_e._hints).call(_t,S0.LOW_STREAM)&&Wt.bitrateMax&&$.attributes.payloads.forEach(_n=>{var _i,_s;i_(_i=["h264","h265","vp8","vp9","av1"]).call(_i,((_s=_n.rtpMap)===null||_s===void 0?void 0:_s.encodingName.toLowerCase())||"")&&(_n.fmtp||(_n.fmtp={parameters:{}}),_n.fmtp.parameters["x-google-start-bitrate"]="".concat(yE("X_GOOGLE_START_BITRATE")||Math.floor(Wt.bitrateMax)))})}function s8($){if($.media.mediaType!=="video")return;const _e=W_();if(_e.name!==t0.SAFARI&&_e.os!==uS.IOS)return;const _t=$.attributes.extmaps.findIndex(Wt=>/video-orientation/g.test(Wt.extensionName));_t!==-1&&$.attributes.extmaps.splice(_t,1)}function sN($,_e,_t){if(!_e)return;let Wt,_n;if($.media.mediaType==="video"?(Wt=_t.videoExtensions,_n=_t.videoCodecs):(Wt=_t.audioExtensions,_n=_t.audioCodecs),_e.twcc===!0){const _i=Wt.find(_s=>_s.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_i&&($.attributes.extmaps.find(_c=>_c.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||$.attributes.extmaps.push({entry:_i.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(_c,_u){return _u.filter(_h=>!!_c.find(_p=>_p.payloadType===_h.payloadType&&!!_p.rtcpFeedbacks.find(Qm=>Qm.type==="transport-cc")))}(_n,$.attributes.payloads).forEach(_c=>{_c.rtcpFeedbacks.find(_u=>_u.type==="transport-cc")||_c.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(_e.twcc===!1){const _i=$.attributes.extmaps.findIndex(_s=>_s.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_i!==-1&&$.attributes.extmaps.splice(_i,1),$.attributes.payloads.forEach(_s=>{const _c=_s.rtcpFeedbacks.findIndex(_u=>_u.type==="transport-cc");_c!==-1&&_s.rtcpFeedbacks.splice(_c,1)})}if(_e.remb===!0){const _i=Wt.find(_s=>_s.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_i&&($.attributes.extmaps.find(_c=>_c.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||$.attributes.extmaps.push({entry:_i.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(_c,_u){return _u.filter(_h=>!!_c.find(_p=>_p.payloadType===_h.payloadType&&!!_p.rtcpFeedbacks.find(Qm=>Qm.type==="goog-remb")))}(_n,$.attributes.payloads).forEach(_c=>{_c.rtcpFeedbacks.find(_u=>_u.type==="goog-remb")||_c.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(_e.remb===!1){const _i=$.attributes.extmaps.findIndex(_s=>_s.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_i!==-1&&$.attributes.extmaps.splice(_i,1),$.attributes.payloads.forEach(_s=>{const _c=_s.rtcpFeedbacks.findIndex(_u=>_u.type==="goog-remb");_c!==-1&&_s.rtcpFeedbacks.splice(_c,1)})}}function a8($,_e,_t){if(h0()||$.media.mediaType!=="video"||!(_e instanceof m0)||_t!=="vp9"&&_t!=="vp8"||_t==="vp8"&&!yE("SIMULCAST")||_e._scalabilityMode===void 0||_e._scalabilityMode.numSpatialLayers<=1)return;const Wt=_t==="vp8"?2:_e._scalabilityMode.numSpatialLayers,_n=$.attributes.ssrcs[0],_i=$.attributes.ssrcGroups.find(_c=>_c.semantic==="FID"&&_c.ssrcIds[0]===_n.ssrcId),_s={semantic:"SIM",ssrcIds:[_n.ssrcId]};for(let _c=1;_c<Wt;_c++)$.attributes.ssrcs.push({ssrcId:_n.ssrcId+_c,attributes:b0(_n.attributes)}),_s.ssrcIds.push(_n.ssrcId+_c),_i&&($.attributes.ssrcs.push({ssrcId:_i.ssrcIds[1]+_c,attributes:b0(_n.attributes)}),$.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[_n.ssrcId+_c,_i.ssrcIds[1]+_c]}));$.attributes.ssrcGroups.unshift(_s)}async function c8(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const _t=new RTCPeerConnection;_t.addTransceiver("video",{direction:"sendonly"}),_t.addTransceiver("audio",{direction:"sendonly"}),_t.addTransceiver("video",{direction:"recvonly"}),_t.addTransceiver("audio",{direction:"recvonly"});const Wt=(await _t.createOffer()).sdp,{send:_n,recv:_i,sendrecv:_s}=function(){let _c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_h=arguments.length>2?arguments[2]:void 0;const _p=MP(_h,_c,_u,"sendonly"),Qm=MP(_h,_c,_u,"recvonly"),_g={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},eE={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},pE={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(mR(_p,Qm,"videoExtensions",_g,eE,pE),mR(_p,Qm,"videoCodecs",_g,eE,pE),mR(_p,Qm,"audioExtensions",_g,eE,pE),mR(_p,Qm,"audioCodecs",_g,eE,pE),yE("RAISE_H264_BASELINE_PRIORITY")){const aE=pE.videoCodecs.findIndex(cE=>{var fE,gE;return((fE=cE.rtpMap)===null||fE===void 0?void 0:fE.encodingName.toLocaleLowerCase())==="h264"&&((gE=cE.fmtp)===null||gE===void 0?void 0:gE.parameters["profile-level-id"])==="42001f"});if(aE!==-1){const cE=pE.videoCodecs.findIndex(fE=>{var gE;return((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLocaleLowerCase())==="h264"});if(cE<aE){iE.debug("raising H264 baseline profile priority");const fE=pE.videoCodecs[aE];pE.videoCodecs.splice(aE,1),pE.videoCodecs.splice(cE,0,fE)}cE!==-1&&(eE.videoCodecs=eE.videoCodecs.filter(fE=>{var gE,AE;return!(((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLocaleLowerCase())==="h264"&&((AE=fE.fmtp)===null||AE===void 0?void 0:AE.parameters["profile-level-id"])!=="42001f")})),cE!==-1&&yE("FILTER_SEND_H264_BASELINE")&&(_g.videoCodecs=_g.videoCodecs.filter(fE=>{var gE,AE;return!(((gE=fE.rtpMap)===null||gE===void 0?void 0:gE.encodingName.toLocaleLowerCase())==="h264"&&((AE=fE.fmtp)===null||AE===void 0?void 0:AE.parameters["profile-level-id"])!=="42001f")}))}}return{send:_g,recv:eE,sendrecv:pE}}($,_e,Wt);try{_t.close()}catch{}return{send:_n,recv:_i,sendrecv:_s}}function w9(){const $={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},_e=MP(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),_t={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},Wt={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(mR($,_e,"videoExtensions",_t,Wt,_n),mR($,_e,"videoCodecs",_t,Wt,_n),mR($,_e,"audioExtensions",_t,Wt,_n),mR($,_e,"audioCodecs",_t,Wt,_n),yE("RAISE_H264_BASELINE_PRIORITY")){const _i=_n.videoCodecs.findIndex(_s=>_s.rtpMap&&_s.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&_s.fmtp&&_s.fmtp.parameters["profile-level-id"]==="42001f");if(_i!==-1){const _s=_n.videoCodecs.findIndex(_c=>_c.rtpMap&&_c.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(_s<_i){iE.debug("raising H264 baseline profile priority");const _c=_n.videoCodecs[_i];_n.videoCodecs.splice(_i,1),_n.videoCodecs.splice(_s,0,_c)}_s!==-1&&(Wt.videoCodecs=Wt.videoCodecs.filter(_c=>!(_c.rtpMap&&_c.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&_c.fmtp&&_c.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:_t,recv:Wt,sendrecv:_n}}function mR($,_e,_t,Wt,_n,_i){if(_t==="videoExtensions"||_t==="audioExtensions"){const _s=[];return $[_t].forEach(_c=>{_e[_t].some((_u,_h)=>{if(_c.entry===_u.entry&&_c.extensionName===_u.extensionName)return _s.push(_h),!0})?_i[_t].push(_c):Wt[_t].push(_c)}),void _e[_t].forEach((_c,_u)=>{_s.indexOf(_u)===-1&&_n[_t].push(_c)})}if(_t==="videoCodecs"||_t==="audioCodecs"){const _s=[];return $[_t].forEach(_c=>{_e[_t].some((_u,_h)=>{if(_c.payloadType===_u.payloadType&&JSON.stringify(_c)===JSON.stringify(_u))return _s.push(_h),!0})?_i[_t].push(_c):Wt[_t].push(_c)}),void _e[_t].forEach((_c,_u)=>{_s.indexOf(_u)===-1&&_n[_t].push(_c)})}}function aN($){const{send:_e,recv:_t,sendrecv:Wt}=$;if(!Wt){if(!_e||!_t)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:_e,recv:_t}}let _n,_i;return _e?(_n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_n.audioCodecs=[..._e.audioCodecs,...Wt.audioCodecs],_n.videoCodecs=[..._e.videoCodecs,...Wt.videoCodecs],_n.audioExtensions=[..._e.audioExtensions,...Wt.audioExtensions],_n.videoExtensions=[..._e.videoExtensions,...Wt.videoExtensions]):_n=Wt,_t?(_i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_i.audioCodecs=[..._t.audioCodecs,...Wt.audioCodecs],_i.videoCodecs=[..._t.videoCodecs,...Wt.videoCodecs],_i.audioExtensions=[..._t.audioExtensions,...Wt.audioExtensions],_i.videoExtensions=[..._t.videoExtensions,...Wt.videoExtensions]):_i=Wt,{send:_n,recv:_i}}function xR($){$.media.mediaType==="audio"&&$.attributes.payloads.filter(_e=>{var _t;return((_t=_e.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())==="opus"}).forEach(_e=>{_e.fmtp||(_e.fmtp={parameters:{}}),_e.fmtp.parameters.stereo="1",_e.fmtp.parameters["sprop-stereo"]="1"})}function _M($){$.mediaDescriptions.forEach(_e=>{_e.media.mediaType!=="video"&&_e.media.mediaType!=="audio"||_e.attributes.payloads.forEach(_t=>{_t.rtcpFeedbacks.findIndex(Wt=>Wt.type==="rrtr")===-1&&_t.rtcpFeedbacks.push({type:"rrtr"})})})}function JI($,_e,_t,Wt){let _n=[];if($===h_.VIDEO){if(yE("H264_PROFILE_LEVEL_ID")&&Wt==="h264"&&(_n=_e.videoCodecs.filter(_i=>{var _s;return i_(_s=_i.rtpMap&&_i.rtpMap.encodingName.toLowerCase()||"").call(_s,Wt)&&_i&&_i.fmtp&&_i.fmtp.parameters["profile-level-id"]===yE("H264_PROFILE_LEVEL_ID")})),!Array.isArray(_n)||_n.length===0){let _i=[];const _s=[],_c=[],_u=[];if(_t.videoCodecs.forEach(_h=>{const _p=_h.rtpMap&&_h.rtpMap.encodingName.toLowerCase()||"";i_(_p).call(_p,Wt)?_i.push(_h):i_(_p).call(_p,"vp9")?_s.push(_h):i_(_p).call(_p,"vp8")?_c.push(_h):i_(_p).call(_p,"h264")&&_u.push(_h)}),_i.length===0){let _h="";_s.length!==0?(_i=_s,_h="vp9"):_c.length!==0?(_i=_c,_h="vp8"):_u.length!==0&&(_i=_u,_h="h264"),iE.warning("codec ".concat(Wt," not included in rtpCapabilities, fallback to default payloads: ").concat(_h))}_i.length!==0&&(_n=_e.videoCodecs.filter(_h=>_i.some(_p=>_p.payloadType===_h.payloadType)))}if(_n.length===0&&(iE.warning("codec ".concat(Wt," not included in rtpCapabilities, fallback to default payloads: ").concat(_e.videoCodecs[0].rtpMap&&_e.videoCodecs[0].rtpMap.encodingName)),_n=_e.videoCodecs),yE("USE_PUB_RTX")||yE("USE_SUB_RTX")){const _i=l8(_n,_e.videoCodecs);_n=[..._n,..._i]}}else _n=_e.audioCodecs.filter(_i=>{var _s;return i_(_s=_i.rtpMap&&_i.rtpMap.encodingName.toLowerCase()||"").call(_s,Wt)}),_n.length===0&&(iE.warning("codec ".concat(Wt," not included in rtpCapabilities, fallback to opus")),_n=_e.audioCodecs.filter(_i=>{var _s;return i_(_s=_i.rtpMap&&_i.rtpMap.encodingName.toLowerCase()||"").call(_s,"opus")}));return _n}function l8($,_e){const _t=$.map(Wt=>Wt.payloadType.toString());return _e.filter(Wt=>Wt.rtpMap&&Wt.rtpMap.encodingName==="rtx"&&Wt.fmtp&&Wt.fmtp.parameters.apt&&i_(_t).call(_t,Wt.fmtp&&Wt.fmtp.parameters.apt))}let R9=class{get localCapabilities(){return b0(this._localCapabilities)}get rtpCapabilities(){return b0(this._rtpCapabilities)}get candidates(){return b0(this._candidates)}get iceParameters(){return b0(this._iceParameters)}get dtlsParameters(){return b0(this._dtlsParameters)}constructor($){hE(this,"sessionDesc",void 0),hE(this,"_localCapabilities",void 0),hE(this,"_rtpCapabilities",void 0),hE(this,"_candidates",void 0),hE(this,"_iceParameters",void 0),hE(this,"_dtlsParameters",void 0),hE(this,"setup",void 0),hE(this,"currentMidIndex",void 0),hE(this,"cname","o/i14u9pJrxRKAsu"),hE(this,"firefoxSsrcMidMap",new Map),$=b0($);const{remoteIceParameters:_e,remoteDtlsParameters:_t,candidates:Wt,remoteRTPCapabilities:_n,localCapabilities:_i,direction:_s,setup:_c,videoCodec:_u,audioCodec:_h}=$;let _p;this.setup=_c,_p=_s===YS.RECEIVE_ONLY?N0.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):N0.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=_n,this._candidates=Wt,this._iceParameters=_e,this._dtlsParameters=_t,this._localCapabilities=_i;const Qm=_s===YS.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,_g=_s===YS.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,eE=_s===YS.RECEIVE_ONLY?_n.send.videoCodecs:JI(h_.VIDEO,Qm,_g,_u),pE=_s===YS.RECEIVE_ONLY?_n.send.audioCodecs:JI(h_.AUDIO,Qm,_g,_h);for(const aE of _p.mediaDescriptions)aE.attributes.iceUfrag=_e.iceUfrag,aE.attributes.icePwd=_e.icePwd,aE.attributes.fingerprints=_t.fingerprints,aE.attributes.candidates=Wt,aE.attributes.setup=this.setup,aE.media.mediaType==="application"&&(aE.attributes.sctpPort="5000"),aE.media.mediaType==="video"&&(aE.media.fmts=eE.map(cE=>cE.payloadType.toString(10)),aE.attributes.payloads=eE,aE.attributes.extmaps=Qm.videoExtensions),aE.media.mediaType==="audio"&&(aE.media.fmts=pE.map(cE=>cE.payloadType.toString(10)),aE.attributes.payloads=pE,aE.attributes.extmaps=Qm.audioExtensions,xR(aE));this.sessionDesc=_p,this.currentMidIndex=_p.mediaDescriptions.length-1}toString(){return N0.print(this.sessionDesc)}hasMid($){return Array.isArray($)?$.every(_e=>this.hasMid(_e)):this.sessionDesc.mediaDescriptions.some(_e=>_e.attributes.mid===$)}send($,_e,_t,Wt,_n){_t=_t.replace(/ /g,"-");const{ssrcs:_i,ssrcGroups:_s}=DT(_e,this.cname,yE("SYNC_GROUP")?_t:void 0),_c=this.findPreloadMediaDesc(_i);if(_c){if(h0()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_c.attributes.mid),_n&&(_n.twcc||_n.remb)){const _u=this.sessionDesc.mediaDescriptions.indexOf(_c);return this.sessionDesc.mediaDescriptions[_u]=this.mungSendMediaDesc(_c,_n),{mid:_c.attributes.mid,needExchangeSDP:!0}}return{mid:_c.attributes.mid,needExchangeSDP:!1}}{const _u=this.findAvailableMediaIndex($,_i,Wt);let _h;return _u===-1?(_h=this.createOrRecycleSendMedia($,_i,_s,"sendonly",Wt,_n),this.updateBundleMids()):(_h=b0(this.sessionDesc.mediaDescriptions[_u]),_h.attributes.direction="sendonly",_h.attributes.ssrcs=_i,_h.attributes.ssrcGroups=_s,this.sessionDesc.mediaDescriptions[_u]=this.mungSendMediaDesc(_h,_n)),h0()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_h.attributes.mid),{needExchangeSDP:!0,mid:_h.attributes.mid}}}stopSending($){const _e=this.sessionDesc.mediaDescriptions.filter(_t=>_t.attributes.mid&&$.indexOf(_t.attributes.mid)!==-1);if(_e.length!==$.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");_e.forEach(_t=>{_t.attributes.ssrcs=[]}),this.updateBundleMids()}receive($,_e,_t){const Wt=[];return $.forEach(_n=>{const _i=_n._mediaStreamTrack.kind,_s=this.findAvailableRecvMediaIndex(_i);let _c,_u=!1;_s===-1?(_u=!0,_c=this.createOrRecycleRecvMedia(_n,[],"recvonly",_e,_t),this.updateBundleMids()):(_c=b0(this.sessionDesc.mediaDescriptions[_s]),_c.attributes.direction="recvonly"),Wt.push({mid:_c.attributes.mid,needCreateTransceiver:_u})}),Wt}stopReceiving($){const _e=this.sessionDesc.mediaDescriptions.filter(_t=>$.indexOf(_t.attributes.mid)!==-1);if(_e.length!==$.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");_e.forEach(_t=>{_t.media.port="0",_t.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate($){const{foundation:_e,protocol:_t,address:Wt,port:_n,type:_i,relatedAddress:_s,relatedPort:_c,priority:_u}=new RTCIceCandidate($),_h={foundation:_e??"",componentId:"1",transport:_t??"",priority:_u?_u+"":"",connectionAddress:Wt??"",port:_n?_n+"":"",type:_i?_i+"":"",relAddr:_s??"",relPort:_c?_c+"":"",extension:{}};this.candidates.some(_p=>_p.priority===_h.priority&&_p.connectionAddress===_h.connectionAddress&&_p.port===_h.port)||(this._candidates.push(_h),this.sessionDesc.mediaDescriptions.forEach(_p=>{_p.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia($,_e,_t,Wt,_n){const _i=$._mediaStreamTrack.kind,_s=this.rtpCapabilities.recv,_c=JI(_i,_s,this.localCapabilities.send,_i===h_.AUDIO?_n:Wt),_u=_i===h_.VIDEO?_s.videoExtensions:_s.audioExtensions,_h="".concat(++this.currentMidIndex);let _p={media:{mediaType:_i,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:_c.map(_g=>_g.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_u,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_e,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:_t,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_h)}};_p=this.mungRecvMediaDsec(_p,$);const Qm=this.findFirstClosedMedia(_i);if(Qm){const _g=this.sessionDesc.mediaDescriptions.indexOf(Qm);this.sessionDesc.mediaDescriptions[_g]=_p}else this.sessionDesc.mediaDescriptions.push(_p);return _p}muteRemote($){const _e=this.sessionDesc.mediaDescriptions.filter(_t=>i_($).call($,_t.attributes.mid||""));if(_e.length!==$.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");_e.forEach(_t=>{_t.attributes.direction="inactive"})}unmuteRemote($){const _e=this.sessionDesc.mediaDescriptions.filter(_t=>i_($).call($,_t.attributes.mid||""));if(_e.length!==$.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");_e.forEach(_t=>{_t.attributes.direction="recvonly"})}findAvailableMediaIndex($,_e,_t){return this.sessionDesc.mediaDescriptions.findIndex(Wt=>{const _n=Wt.media.mediaType===$&&Wt.media.port!=="0"&&(Wt.attributes.direction==="sendonly"||Wt.attributes.direction==="sendrecv")&&Wt.attributes.ssrcs.length===0;if(h0()){if(_n){const _i=this.firefoxSsrcMidMap.get(_e[0].ssrcId);return!(_i||Wt.attributes.mid!=="0"&&Wt.attributes.mid!=="1")||!(!_i||_i!==Wt.attributes.mid)}return!1}return _n&&Wt.attributes.mid===_t})}findAvailableRecvMediaIndex($){return this.sessionDesc.mediaDescriptions.findIndex(_e=>{const _t=_e.media.mediaType===$&&_e.media.port!=="0"&&(_e.attributes.direction==="recvonly"||_e.attributes.direction==="sendrecv");return _e.attributes.mid!=="0"&&_e.attributes.mid!=="1"&&_t})}predictReceivingMids($){const _e=[];for(let _t=0;_t<$;_t++)_e.push((this.currentMidIndex+_t+1).toString(10));return _e}restartICE($){$=b0($),this._iceParameters=$,this.sessionDesc.mediaDescriptions.forEach(_e=>{_e.attributes.iceUfrag=$.iceUfrag,_e.attributes.icePwd=$.icePwd})}createOrRecycleSendMedia($,_e,_t,Wt,_n,_i){const _s=this.rtpCapabilities.send,_c=$===h_.VIDEO?_s.videoCodecs:_s.audioCodecs,_u=$===h_.VIDEO?_s.videoExtensions:_s.audioExtensions;h0()&&(_n="".concat(++this.currentMidIndex));let _h={media:{mediaType:$,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:_c.map(Qm=>Qm.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_u,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_e,ssrcGroups:_t,rtcpFeedbackWildcards:[],payloads:_c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:Wt,rtcpMux:!0,rtcpRsize:!0,mid:_n}};_h=this.mungSendMediaDesc(_h,_i);const _p=this.findFirstClosedMedia($);if(_p){const Qm=this.sessionDesc.mediaDescriptions.indexOf(_p);this.sessionDesc.mediaDescriptions[Qm]=_h}else this.sessionDesc.mediaDescriptions.push(_h);return _h}mungRecvMediaDsec($,_e,_t){const Wt=b0($);return EM(Wt),oI(Wt,_e),vM(Wt,_e),s8(Wt),sN(Wt,_t,this.localCapabilities.send),Wt}mungSendMediaDesc($,_e){const _t=b0($);return sN(_t,_e,this.localCapabilities.recv),xR(_t),_t}updateRecvMedia($,_e){const _t=this.sessionDesc.mediaDescriptions.findIndex(Wt=>Wt.attributes.mid===$);if(_t!==-1){const Wt=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[_t],_e);this.sessionDesc.mediaDescriptions[_t]=Wt}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter($=>$.media.port!=="0").map($=>$.attributes.mid)}findPreloadMediaDesc($){return this.sessionDesc.mediaDescriptions.find(_e=>{var _t;return((_t=_e.attributes)===null||_t===void 0||(_t=_t.ssrcs[0])===null||_t===void 0?void 0:_t.ssrcId)===$[0].ssrcId})}findFirstClosedMedia($){return this.sessionDesc.mediaDescriptions.find(_e=>h0()?_e.media.port==="0"&&_e.media.mediaType===$:_e.media.port==="0")}};const yhe=["sdp"];var R0;function C9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function sI($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?C9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):C9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let I9=(R0=class gN extends uW{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var _e,_t;return(_e=(_t=this.peerConnection.getReceivers()[0])===null||_t===void 0||(_t=_t.transport)===null||_t===void 0?void 0:_t.state)!==null&&_e!==void 0?_e:null}get localCodecs(){return[]}set isInRestartIce(_e){this._isInRestartIce=_e}get isInRestartIce(){return this._isInRestartIce}constructor(_e,_t,Wt){super(_e,_t),hE(this,"direction",void 0),hE(this,"name",void 0),hE(this,"store",void 0),hE(this,"spec",void 0),hE(this,"peerConnection",void 0),hE(this,"initialOffer",void 0),hE(this,"transport",void 0),hE(this,"statsFilter",void 0),hE(this,"localCandidateCount",0),hE(this,"_isInRestartIce",!1),hE(this,"mutex",new mS("P2PConnection-mutex")),hE(this,"onLocalCandidate",void 0),hE(this,"remoteSDP",void 0),hE(this,"pendingCandidates",[]),hE(this,"localCapabilities",void 0),hE(this,"isReady",!1),hE(this,"restartCnt",0),hE(this,"curTurnServerIndex",0),this.store=_t,this.spec=_e,this.peerConnection=new RTCPeerConnection(gN.resolvePCConfiguration(_e,_t.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=Wt??YS.SEND_ONLY,this.name=this.direction===YS.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=gM(this.peerConnection,yE("STATS_UPDATE_INTERVAL"),void 0,h0()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(_e){try{const _t=await c8();if(this.localCapabilities=aN(_t),_e){const{sdp:Wt}=_e,_n=ghe(_e,yhe),_i=function(){const _p={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},Qm=MP(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),_g={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},eE={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},pE={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(mR(Qm,_p,"videoExtensions",_g,eE,pE),mR(Qm,_p,"videoCodecs",_g,eE,pE),mR(Qm,_p,"audioExtensions",_g,eE,pE),mR(Qm,_p,"audioCodecs",_g,eE,pE),yE("RAISE_H264_BASELINE_PRIORITY")){const aE=pE.videoCodecs.findIndex(cE=>cE.rtpMap&&cE.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&cE.fmtp&&cE.fmtp.parameters["profile-level-id"]==="42001f");if(aE!==-1){const cE=pE.videoCodecs.findIndex(fE=>fE.rtpMap&&fE.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(cE<aE){iE.debug("raising H264 baseline profile priority");const fE=pE.videoCodecs[aE];pE.videoCodecs.splice(aE,1),pE.videoCodecs.splice(cE,0,fE)}cE!==-1&&yE("FILTER_SEND_H264_BASELINE")&&(_g.videoCodecs=_g.videoCodecs.filter(fE=>!(fE.rtpMap&&fE.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&fE.fmtp&&fE.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:_g,recv:eE,sendrecv:pE}}({},{},Wt);this.remoteSDP=new R9({remoteIceParameters:_n.iceParameters,remoteDtlsParameters:_n.dtlsParameters,candidates:[],remoteRTPCapabilities:_i,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const _s=await this.peerConnection.createAnswer();if(!_s.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const _c=LR(_s.sdp);await this.peerConnection.setLocalDescription(_s);const _u=await w9({},{},_s.sdp);this.localCapabilities=aN(_u);const _h=this.peerConnection.getTransceivers()[0];return _h!=null&&_h.receiver&&_h.receiver.transport&&this.tryBindTransportEvents(_h.receiver.transport),sI(sI({},_c),{},{sdp:_s.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const Wt=await this.peerConnection.createOffer();if(!Wt.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const _n=LR(Wt.sdp);return this.initialOffer=Wt,sI(sI({},_n),{},{sdp:Wt.sdp})}}catch(_t){throw new HE(mE.GET_LOCAL_CONNECTION_PARAMS_FAILED,_t.toString())}}async connect(_e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:_t,iceParameters:Wt,dtlsParameters:_n}=_e,_i=await w9({},{},_t);this.remoteSDP=new R9({remoteIceParameters:Wt,remoteDtlsParameters:_n,candidates:[],remoteRTPCapabilities:_i,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const _s=this.peerConnection.getTransceivers()[0];_s!=null&&_s.sender&&_s.sender.transport&&this.tryBindTransportEvents(_s.sender.transport)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_t.toString()))}}async addRemoteCandidate(_e){try{_e&&this.pendingCandidates.push(_e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(_t=>{this.peerConnection.addIceCandidate(_t)}),this.pendingCandidates=[])}catch(_t){throw new HE(mE.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(_t.toString()))}}send(_e,_t,Wt){var _n=this;return ET(function*(){const _i=yield k_(_n.mutex.lock("From P2PConnection.send"));try{if(!_n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _s=[],_c=_n.remoteSDP.receive(_e,_t,Wt);_e.forEach((cE,fE)=>{if(_c[fE].needCreateTransceiver){const gE=_n.peerConnection.addTransceiver(cE._mediaStreamTrack,{direction:"sendonly"});_s.push(gE),cE._updateRtpTransceiver(gE)}else{const gE=_n.peerConnection.getTransceivers().find(AE=>AE.mid===_c[fE].mid);if(!gE)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(_c[fE].mid));_s.push(gE),cE._updateRtpTransceiver(gE)}}),h0()&&yE("SIMULCAST")===!0&&(yield k_(_n.applySimulcastForFirefox(_s,_e)));const _u=_c.map(cE=>cE.mid),_h=yield k_(_n.peerConnection.createOffer()),_p=_n.mungSendOfferSDP(_h.sdp,_e,_u),Qm=N0.parse(_p),_g=_u.map(cE=>{const fE=Qm.mediaDescriptions.find(gE=>gE.attributes.mid===cE);if(!fE)throw new Error("Cannot extract ssrc from mediaDescription.");return o8(fE,yE("USE_PUB_RTX"))}),eE=_s.map((cE,fE)=>{const gE=_u[fE];return{localSSRC:_g[fE],id:gE}});yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_p}));try{yield eE}catch(cE){const fE=_n.remoteSDP.toString();throw yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_p})),yield k_(_n.peerConnection.setRemoteDescription({type:"answer",sdp:fE})),yield k_(_n.stopSending(_u,!0)),cE}yield k_(_n.applySimulcastEncodings(_s,_e)),yield k_(_n.applySendEncodings(_s,_e));const pE=_n.remoteSDP.toString(),aE=_n.logSDPExchange(_p,"offer","local","send");return aE==null||aE(pE),yield k_(_n.setRemoteDescription({type:"answer",sdp:pE})),_s.map((cE,fE)=>{const gE=_u[fE];return{localSSRC:_g[fE],id:gE}})}catch(_s){throw _s instanceof HE?_s:new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_s.toString()))}finally{_i()}})()}async stopSending(_e,_t){const Wt=_t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const _n=this.peerConnection.getTransceivers().filter(_u=>_e.indexOf(_u.mid)!==-1);if(_n.length!==_e.length)throw new Error("Transceivers' length (".concat(_n.length,") doesn't match mids' length (").concat(_e.length,") when trying to call P2PConnection.stopSending."));_n.map(_u=>{var _h;_u.direction="inactive",(_h=_u.stop)===null||_h===void 0||_h.call(_u)});const _i=await this.peerConnection.createOffer(),_s=this.logSDPExchange(_i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_i),this.remoteSDP.stopReceiving(_e);const _c=this.remoteSDP.toString();_s==null||_s(_c),await this.setRemoteDescription({type:"answer",sdp:_c})}catch(_n){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(_n.toString()))}finally{Wt&&Wt()}}async receive(_e,_t,Wt,_n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(_e," before remoteSDP created."));const{mid:_i,needExchangeSDP:_s}=this.remoteSDP.send(_e,_t,Wt,_n);if(_s){const _u=this.remoteSDP.toString(),_h=this.logSDPExchange(_u,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:_u});const _p=await this.peerConnection.createAnswer(),Qm=this.mungReceiveAnswerSDP(_p.sdp,_i,_e);_h==null||_h(Qm||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:Qm}),iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," by exchanging SDP."))}else iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," no need to exchange SDP."));const _c=this.peerConnection.getTransceivers().find(_u=>_u.mid===_i);if(!_c||_c.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_c.receiver.track,mid:_c.mid,transceiver:_c}}catch(_i){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async mockReceive(_e,_t,Wt,_n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(_e," before remoteSDP created."));const{mid:_i,needExchangeSDP:_s}=this.remoteSDP.send(_e,_t,Wt,_n);if(_s){const _c=this.remoteSDP.toString(),_u=this.logSDPExchange(_c,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:_c});const _h=await this.peerConnection.createAnswer(),_p=this.mungReceiveAnswerSDP(_h.sdp,_i,_e);_u==null||_u(_p||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:_p}),iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," by exchanging SDP."))}else iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," no need to exchange SDP."))}catch(_i){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async stopReceiving(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(_t.toString()))}}async restartICE(_e){try{if(this.store.p2pTransport===kI.Auto&&(this.store.p2pTransport=kI.SdRtn,B_().supportPCSetConfiguration&&this.peerConnection.setConfiguration(gN.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,B_().supportPCSetConfiguration&&this.peerConnection.setConfiguration(gN.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!_e){this.restartCnt++,this.isReady=!1;const _t=await this.peerConnection.createOffer({iceRestart:!0});if(!_t.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:Wt}=LR(_t.sdp);return this.store.descriptionStart(),this.direction===YS.SEND_ONLY&&await this.peerConnection.setLocalDescription(_t),Wt}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(_e),this.store.descriptionStart(),this.direction===YS.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const _t=await this.peerConnection.createAnswer();if(!_t.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:Wt}=LR(_t.sdp);return await this.peerConnection.setLocalDescription(_t),Wt}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(_t.toString()))}}close(){var _e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(_e){return this.statsFilter.getVideoIsReady(_e)}async updateEncoderConfig(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const Wt=await this.peerConnection.createOffer(),_n=this.mungSendOfferSDP(Wt.sdp,[_t],[_e]);this.remoteSDP.updateRecvMedia(_e,_t);const _i=this.remoteSDP.toString(),_s=this.logSDPExchange(_n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:_n}),_s==null||_s(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(Wt){throw new HE(mE.EXCHANGE_SDP_FAILED,Wt.toString())}}async updateSendParameters(_e,_t){const Wt=this.peerConnection.getTransceivers().filter(_n=>_n.mid===_e);Wt.length===1&&(this.isVP8Simulcast(_t)?h0()||await this.applySimulcastEncodings(Wt,[_t]):await this.applySendEncodings(Wt,[_t]))}setStatsRemoteVideoIsReady(_e,_t){this.statsFilter.setVideoIsReady2(_e,_t)}async replaceTrack(_e,_t){const Wt=this.peerConnection.getTransceivers().find(_n=>_n.mid===_t);Wt&&await Wt.sender.replaceTrack(_e._mediaStreamTrack)}async getSelectedCandidatePair(){const _e=this.peerConnection.getReceivers();if(_e.length>0&&_e[0].transport&&_e[0].transport.iceTransport&&_e[0].transport.iceTransport.getSelectedCandidatePair&&_e[0].transport.iceTransport.getSelectedCandidatePair()){const _t=_e[0].transport.iceTransport,{local:Wt,remote:_n}=_t.getSelectedCandidatePair();return{local:sI(sI({},a1),{},{candidateType:Wt.type,protocol:Wt.protocol,address:Wt.address,port:Wt.port}),remote:sI(sI({},a1),{},{candidateType:_n.type,protocol:_n.protocol,address:_n.address,port:_n.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var _e,_t;i_(_e=["connected","completed"]).call(_e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(_t=this.onICEConnectionStateChange)===null||_t===void 0||_t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var _e;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=_e=>{if(_e.candidate){var _t;_e.candidate.candidate&&((_t=this.onLocalCandidate)===null||_t===void 0||_t.call(this,_e.candidate.toJSON())),this.localCandidateCount+=1}else iE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(_e,_t){let Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const _n={iceServers:[]};var _i;return _e.iceServers?_n.iceServers=_e.iceServers:_e.turnServer&&_e.turnServer.mode!=="off"&&(IO(_e.turnServer.servers)?_n.iceServers=_e.turnServer.servers:(_n.iceServers&&_n.iceServers.push(...gN.turnServerConfigToIceServers(_e.turnServer.servers,_t,Wt)),yE("USE_TURN_SERVER_OF_GATEWAY")&&_n.iceServers&&_e.turnServer.serversFromGateway&&_n.iceServers.push(...gN.turnServerConfigToIceServers(_e.turnServer.serversFromGateway,_t,Wt)),i_(_i=[kI.Relay,kI.SdRtn]).call(_i,_t)&&(_n.iceTransportPolicy="relay"),yE("FORCE_TURN_TCP")?_n.iceTransportPolicy="relay":_e.turnServer.servers.concat(_e.turnServer.serversFromGateway||[]).forEach(_s=>{_s.forceturn&&(_n.iceTransportPolicy="relay")}))),yE("ENABLE_ENCODED_TRANSFORM")&&B_().supportWebRTCEncodedTransform&&(_n.encodedInsertableStreams=!0),iE.debug("P2PConnection p2pTransport is ".concat(_t)),_n}static turnServerConfigToIceServers(_e,_t){let Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const _n=[],_i=_e.filter(_c=>_c.tcpport);iE.debug("P2PConnection turnServers is ".concat(_i,", current index is ").concat(Wt));const _s=_i.length>Wt?_i[Wt]:_i[0];switch(_t){case kI.SdRtn:const _c=_e.filter(_h=>{var _p;return i_(_p=_h.username).call(_p,"glb:")&&_h.turnServerURL==_h.turnServerURL}),_u=_c.length>Wt?_c[Wt]:_c[0];_u&&(_n.push({username:_u.username,credential:_u.password,credentialType:"password",urls:"turn:".concat(X1(_u.turnServerURL),":").concat(_u.tcpport,"?transport=udp")}),_n.push({username:_u.username,credential:_u.password,credentialType:"password",urls:"turns:".concat(X1(_u.turnServerURL),":").concat(_u.tcpport,"?transport=tcp")}));break;case kI.Relay:_s&&(_n.push({username:_s.username,credential:_s.password,credentialType:"password",urls:"turn:".concat(_s.turnServerURL,":").concat(_s.tcpport,"?transport=udp")}),_n.push({username:_s.username,credential:_s.password,credentialType:"password",urls:"turns:".concat(X1(_s.turnServerURL),":").concat(_s.tcpport,"?transport=tcp")}));break;default:_s&&(_n.push({username:_s.username,credential:_s.password,credentialType:"password",urls:"turn:".concat(_s.turnServerURL,":").concat(_s.tcpport,"?transport=udp")}),_n.push({username:_s.username,credential:_s.password,credentialType:"password",urls:"turns:".concat(X1(_s.turnServerURL),":").concat(_s.tcpport,"?transport=tcp")}),_n.push({username:_s.username,credential:_s.password,credentialType:"password",urls:"stun:".concat(_s.turnServerURL,":").concat(_s.tcpport)}))}return _n}tryBindTransportEvents(_e){if(_e){this.transport=_e,_e.onstatechange=()=>{var Wt;_e!=null&&_e.state&&((Wt=this.onDTLSTransportStateChange)===null||Wt===void 0||Wt.call(this,_e.state))},_e.onerror=Wt=>{var _n;(_n=this.onDTLSTransportError)===null||_n===void 0||_n.call(this,"error"in Wt?Wt.error:Wt)};const _t=_e.iceTransport;_t&&(_t.onstatechange=()=>{const Wt=_e==null?void 0:_e.iceTransport.state;var _n;Wt&&((_n=this.onICETransportStateChange)===null||_n===void 0||_n.call(this,Wt))},_t.getSelectedCandidatePair&&(_t.onselectedcandidatepairchange=()=>{if(_t.getSelectedCandidatePair()){const{local:Wt,remote:_n}=_t.getSelectedCandidatePair();iE.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:Wt.type,protocol:Wt.protocol}),", remote ").concat(JSON.stringify({candidateType:_n.type,protocol:_n.protocol,address:_n.address,port:_n.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(_e,_t){var Wt;if(_t||(_t=this.peerConnection.getSenders().find(_p=>_p.track===_e._mediaStreamTrack)),!_t)return iE.warn("[".concat(_e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(_e))return iE.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!B_().supportSetRtpSenderParameters)return iE.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const _n={},_i={};switch(_e._optimizationMode){case"motion":_n.degradationPreference="maintain-framerate";break;case"detail":_n.degradationPreference="maintain-resolution";break;default:_n.degradationPreference="balanced"}if(_e._encoderConfig){var _s;const{bitrateMax:_p,frameRate:Qm,scaleResolutionDownBy:_g}=_e._encoderConfig;_p&&(_i.maxBitrate=1e3*_p),i_(_s=_e._hints).call(_s,S0.LOW_STREAM)&&(Qm&&(_i.maxFramerate=cT(Qm)),_g&&_g>=1&&(_i.scaleResolutionDownBy=_g))}if(yE("DSCP_TYPE")&&W1()){var _c;const _p=yE("DSCP_TYPE");i_(_c=["very-low","low","medium","high"]).call(_c,_p)&&(_i.networkPriority=_p)}const _u=_t.getParameters(),_h=(Wt=_u.encodings)===null||Wt===void 0?void 0:Wt[0];h0()&&!_h&&(_n.encodings=[_i]),_h&&Object.assign(_h,_i),Object.assign(_u,_n),iE.debug("[".concat(_e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_u.encodings))),await _t.setParameters(_u)}async applySendEncodings(_e,_t){try{if(!B_().supportSetRtpSenderParameters||_e.length!==_t.length)return;for(let Wt=0;Wt<_e.length;Wt++){const _n=_e[Wt],_i=_t[Wt];_i instanceof m0&&!this.isVP8Simulcast(_i)&&await this.updateRtpSenderEncodings(_i,_n.sender)}}catch{iE.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(_e,_t,Wt){const _n=N0.parse(_e);return _t.forEach((_i,_s)=>{const _c=Wt[_s],_u=_n.mediaDescriptions.find(_h=>_h.attributes.mid===_c);_u&&(oI(_u,_i),a8(_u,_i,this.store.codec))}),N0.print(_n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=_e=>{var _t;(_t=this.onFirstAudioReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoReceived=_e=>{var _t;(_t=this.onFirstVideoReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstAudioDecoded=_e=>{var _t;(_t=this.onFirstAudioDecoded)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoDecoded=(_e,_t,Wt)=>{var _n;(_n=this.onFirstVideoDecoded)===null||_n===void 0||_n.call(this,_e,_t,Wt)},this.statsFilter.onSelectedLocalCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedLocalCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onSelectedRemoteCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedRemoteCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onFirstVideoDecodedTimeout=_e=>{var _t;(_t=this.onFirstVideoDecodedTimeout)===null||_t===void 0||_t.call(this,_e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(_e,_t){if(_e.length===_t.length)for(let _u=0;_u<_e.length;_u++){var Wt,_n,_i,_s,_c;const _h=_e[_u],_p=_t[_u];if(_p instanceof m0&&!i_(Wt=_p._hints).call(Wt,S0.LOW_STREAM)&&(_n=_p._encoderConfig)!==null&&_n!==void 0&&_n.bitrateMax&&((_i=_p._encoderConfig)===null||_i===void 0?void 0:_i.bitrateMax)>200&&(_s=_p._scalabilityMode)!==null&&_s!==void 0&&_s.numSpatialLayers&&((_c=_p._scalabilityMode)===null||_c===void 0?void 0:_c.numSpatialLayers)>1&&this.store.codec==="vp8"){const Qm={},_g={high:1e3*(_p._encoderConfig.bitrateMax-50),medium:5e4};Qm.encodings=[{rid:"m",active:!0,maxBitrate:_g.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:_g.high}];const eE=_h.sender.getParameters();await _h.sender.setParameters(Object.assign(eE,Qm))}}}async applySimulcastEncodings(_e,_t){if(!h0()&&_e.length===_t.length)for(let Wt=0;Wt<_e.length;Wt++){const _n=_t[Wt];if(_n instanceof m0&&this.isVP8Simulcast(_n)){const _i=_e[Wt],_s={},_c={high:1e3*(_n._encoderConfig.bitrateMax-50),medium:5e4};_s.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_c.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_c.medium,scaleResolutionDownBy:4}];const _u=_i.sender.getParameters();await _i.sender.setParameters(Object.assign(_u,_s))}}}isVP8Simulcast(_e){var _t,Wt,_n,_i,_s;return!!(_e instanceof m0&&yE("SIMULCAST")&&this.store.codec==="vp8"&&!i_(_t=_e._hints).call(_t,S0.LOW_STREAM)&&(Wt=_e._encoderConfig)!==null&&Wt!==void 0&&Wt.bitrateMax&&((_n=_e._encoderConfig)===null||_n===void 0?void 0:_n.bitrateMax)>200&&(_i=_e._scalabilityMode)!==null&&_i!==void 0&&_i.numSpatialLayers&&((_s=_e._scalabilityMode)===null||_s===void 0?void 0:_s.numSpatialLayers)>1)}logSDPExchange(_e,_t,Wt,_n){if(yE("SDP_LOGGING"))return iE.upload("[".concat(this.store.clientId,"] exchanging ").concat(Wt," ").concat(_t," SDP during P2PConnection.").concat(_n,`
`),_e),_t==="offer"?_i=>{this.logSDPExchange(_i,"answer",Wt==="local"?"remote":"local",_n)}:void 0}async muteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(_s=>{_s.direction="inactive"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.muteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(_t.toString()))}}async unmuteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(async _s=>{_s.direction="sendonly"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.unmuteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(_t.toString()))}}async getRemoteSSRC(_e,_t){var Wt,_n;if(_t=(Wt=_t)!==null&&Wt!==void 0?Wt:(_n=this.currentRemoteDescription)===null||_n===void 0?void 0:_n.sdp){var _i;const _s=(_i=N0.parse(_t).mediaDescriptions.find(_c=>_c.attributes.mid===_e))===null||_i===void 0?void 0:_i.attributes.ssrcs;return _s==null?void 0:_s[0].ssrcId}}async setRemoteDescription(_e){var _t;await this.peerConnection.setRemoteDescription(_e),i_(_t=["connected","completed"]).call(_t,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(_e,_t,Wt){const _n=N0.parse(_e),_i=_n.mediaDescriptions.find(_s=>_s.attributes.mid===_t);return _i&&Wt===h_.AUDIO&&_i.media.mediaType==="audio"&&xR(_i),N0.print(_n)}},t_(R0.prototype,"establish",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"establish"),R0.prototype),t_(R0.prototype,"connect",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"connect"),R0.prototype),t_(R0.prototype,"receive",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"receive"),R0.prototype),t_(R0.prototype,"mockReceive",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"mockReceive"),R0.prototype),t_(R0.prototype,"stopReceiving",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"stopReceiving"),R0.prototype),t_(R0.prototype,"restartICE",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"restartICE"),R0.prototype),t_(R0.prototype,"close",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"close"),R0.prototype),t_(R0.prototype,"updateEncoderConfig",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"updateEncoderConfig"),R0.prototype),t_(R0.prototype,"updateSendParameters",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"updateSendParameters"),R0.prototype),t_(R0.prototype,"replaceTrack",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"replaceTrack"),R0.prototype),t_(R0.prototype,"muteLocal",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"muteLocal"),R0.prototype),t_(R0.prototype,"unmuteLocal",[gR],Object.getOwnPropertyDescriptor(R0.prototype,"unmuteLocal"),R0.prototype),R0);function gR($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("From P2PConnection.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}function u8($,_e){let _t=document.createElement("video"),Wt=document.createElement("canvas");_t.setAttribute("style","display:none"),Wt.setAttribute("style","display:none"),_t.setAttribute("muted",""),_t.muted=!0,_t.setAttribute("autoplay",""),_t.autoplay=!0,_t.setAttribute("playsinline",""),Wt.width=cT(_e.width),Wt.height=cT(_e.height);const _n=cT(_e.framerate||15);document.body.append(_t),document.body.append(Wt);let _i=$._mediaStreamTrack;_t.srcObject=new MediaStream([_i]),_t.play();const _s=Wt.getContext("2d");if(!_s)throw new DE(mE.UNEXPECTED_ERROR,"can not get canvas context");const _c=B_(),_u=Wt.captureStream(_c.supportRequestFrame?0:_n).getVideoTracks()[0];_u.canvas||(_u.canvas=Wt),Wt.startCapture=()=>{if(!_t)return Wt.stopCapture&&Wt.stopCapture();if(_t.paused&&_t.play(),_t.videoHeight>2&&_t.videoWidth>2){const _p=_t.videoWidth,Qm=_t.videoHeight/_p,_g=Wt.width*Qm;Math.abs(_g-Wt.height)>=2&&(iE.debug("adjust low stream resolution","".concat(Wt.width,"x").concat(Wt.height," -> ").concat(Wt.width,"x").concat(_g)),Wt.height=_g)}_s.drawImage(_t,0,0,Wt.width,Wt.height),_u.requestFrame&&_u.requestFrame(),_i!==$._mediaStreamTrack&&(_i=$._mediaStreamTrack,_t.srcObject=new MediaStream([_i]))},Wt.stopCapture=z6(()=>Wt.startCapture&&Wt.startCapture(),_n);const _h=_u.stop;return _u.stop=()=>{_h.call(_u),_t&&(_t.remove(),_t.srcObject=null,_t=null),Wt&&(Wt.width=0,Wt.remove(),Wt.stopCapture&&Wt.stopCapture(),Wt.startCapture=void 0,Wt.stopCapture=void 0,Wt=null),iE.debug("clean low stream renderer")},_u}var yM=function($){return $[$.HEIGHT=2033]="HEIGHT",$[$.FRAME_RATE=2034]="FRAME_RATE",$[$.WIDTH=2035]="WIDTH",$}(yM||{}),fS=function($){return $[$.FRAME_RATE=2002]="FRAME_RATE",$[$.WIDTH=2003]="WIDTH",$[$.HEIGHT=2004]="HEIGHT",$[$.PACKAGE_LOST=2005]="PACKAGE_LOST",$[$.AVG_ENCODE=2007]="AVG_ENCODE",$[$.NACKS=2009]="NACKS",$[$.PLIS=2010]="PLIS",$[$.FIRS=2011]="FIRS",$[$.BITRATE=2012]="BITRATE",$[$.PACKAGE_RATE=2031]="PACKAGE_RATE",$[$.ADAPTATION=2032]="ADAPTATION",$[$.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",$[$.BANDWIDTH=2061]="BANDWIDTH",$[$.RETRANSMIT=2062]="RETRANSMIT",$[$.TARGET_ENCODED=2064]="TARGET_ENCODED",$[$.TRANSMIT=2066]="TRANSMIT",$[$.FREEZE=2082]="FREEZE",$[$.DISABLED=2095]="DISABLED",$[$.PLAYER_STATUS=2128]="PLAYER_STATUS",$[$.QP_SUM=2143]="QP_SUM",$}(fS||{}),XI=function($){return $[$.BITRATE=2069]="BITRATE",$[$.PACKAGE_LOST=2070]="PACKAGE_LOST",$[$.PACKAGE_RATE=2071]="PACKAGE_RATE",$[$.HEIGHT=2073]="HEIGHT",$[$.FRAME_RATE=2075]="FRAME_RATE",$[$.WIDTH=2077]="WIDTH",$}(XI||{}),jS=function($){return $[$.JITTER=-1]="JITTER",$[$.PACKAGE_LOST=2014]="PACKAGE_LOST",$[$.WIDTH=2018]="WIDTH",$[$.HEIGHT=2019]="HEIGHT",$[$.FRAME_RATE=2020]="FRAME_RATE",$[$.JITTER_BUFFER=2023]="JITTER_BUFFER",$[$.CURRENT_DELAY=2024]="CURRENT_DELAY",$[$.NACKS=2026]="NACKS",$[$.PLIS=2027]="PLIS",$[$.FIRS=2028]="FIRS",$[$.BITRATE=2029]="BITRATE",$[$.PACKAGE_RATE=2078]="PACKAGE_RATE",$[$.FREEZE=2084]="FREEZE",$[$.DISABLED=2101]="DISABLED",$[$.PLAYER_STATUS=2129]="PLAYER_STATUS",$[$.QP_SUM=2144]="QP_SUM",$[$.I_FRAME_DELAY=2149]="I_FRAME_DELAY",$}(jS||{}),ZI=function($){return $[$.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",$[$.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",$[$.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",$[$.FREEZE_TIME=2109]="FREEZE_TIME",$[$.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",$[$.FREEZE_DURATION=2156]="FREEZE_DURATION",$}(ZI||{}),A9=function($){return $[$.PCM_LEVEL=2104]="PCM_LEVEL",$}(A9||{}),aI=function($){return $[$.PACKAGE_LOST=-1]="PACKAGE_LOST",$[$.LEVEL=2038]="LEVEL",$[$.BITRATE=2039]="BITRATE",$[$.PACKAGE_RATE=2040]="PACKAGE_RATE",$[$.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",$[$.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",$[$.FREEZE=2081]="FREEZE",$[$.DISABLED=2096]="DISABLED",$}(aI||{}),ER=function($){return $[$.BITRATE=2044]="BITRATE",$[$.PACKAGE_LOST=2045]="PACKAGE_LOST",$[$.PACKAGE_RATE=2046]="PACKAGE_RATE",$[$.CURRENT_DELAY=2047]="CURRENT_DELAY",$[$.JITTER_BUFFER=2054]="JITTER_BUFFER",$[$.JITTER=2055]="JITTER",$[$.FREEZE=2083]="FREEZE",$[$.DISABLED=2102]="DISABLED",$[$.PCM_LEVEL=2105]="PCM_LEVEL",$[$.PLAYER_STATUS=2130]="PLAYER_STATUS",$[$.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",$}(ER||{}),O9=function($){return $[$.FREEZE_TIME=-1]="FREEZE_TIME",$[$.LEVEL=2043]="LEVEL",$}(O9||{}),qT=function($){return $[$.RTT=2006]="RTT",$[$.CONN_TYPE=801]="CONN_TYPE",$}(qT||{});const A1=1e3,QI=3;function L_($,_e,_t){_t!=null&&Number.isFinite(_t)&&($[_e]=Math.round(Math.max(0,_t)))}function N9($){const _e={[qT.CONN_TYPE]:0,[qT.RTT]:$.rtt};switch($.selectedCandidatePair.localCandidate.candidateType){case"relay":{const _t=$.selectedCandidatePair.localCandidate.relayProtocol;_t==="udp"&&(_e[qT.CONN_TYPE]=1),_t==="tcp"&&(_e[qT.CONN_TYPE]=3),_t==="tls"&&(_e[qT.CONN_TYPE]=4);break}case"srflx":_e[qT.CONN_TYPE]=2}return _e}function P9($){let _e=0;switch($){case"none":_e=0;break;case"cpu":_e=1;break;case"bandwidth":_e=2;break;case"other":_e=3}return _e}class k9 extends A0{constructor(_e){super(),hE(this,"store",void 0),hE(this,"uploadWRTCStatsTimer",void 0),hE(this,"uploadOutboundDenoiserStatsTimer",void 0),hE(this,"uploadExtStatsTimer",void 0),hE(this,"uploadExtUsageStatsTimer",void 0),hE(this,"uploadInboundExtStatsTimer",void 0),hE(this,"requestStats",void 0),hE(this,"requestTransportStats",void 0),hE(this,"requestLocalMedia",void 0),hE(this,"requestRemoteMedia",void 0),hE(this,"requestAllTracks",void 0),hE(this,"requestVideoIsReady",void 0),hE(this,"requestUploadStats",void 0),hE(this,"requestUpload",void 0),hE(this,"uploadOutboundStarted",!1),hE(this,"uploadInboundStarted",!1),hE(this,"uploadTransportStarted",!1),hE(this,"uploadExtensionUsageStarted",!1),hE(this,"lastRecvStats",void 0),hE(this,"lastSendStats",void 0),hE(this,"lastFullRecvStats",void 0),hE(this,"lastFullSendStats",void 0),hE(this,"needUploadRenderFreezeTime",!0),this.store=_e}uploadWRTCStats(_e){if(!this.requestStats||!this.requestUploadStats)return;let _t,Wt;if(this.uploadTransportStarted&&(_t=this.requestStats(),this.store.useP2P&&(Wt=this.requestStats(!0))),!_t&&this.uploadOutboundStarted&&(_t=this.requestStats()),!Wt&&this.uploadInboundStarted&&(Wt=this.requestStats(!0)),_t||Wt){const _n={};if(this.uploadTransportStarted&&_t){const _i=this.getTransportStats(_t,Wt,_e);_i&&(_n.misc=[_i])}if(this.uploadOutboundStarted&&_t){const _i=this.getOutboundStats(_t,_e?this.lastSendStats:this.lastFullSendStats,_e);_i&&(_n.outbound=[_i])}if(this.uploadInboundStarted&&Wt){const _i=this.getInboundStats(Wt,_e?this.lastRecvStats:this.lastFullRecvStats,_e);_i&&(_n.inbound=_i)}this.requestUploadStats(_n)}this.lastRecvStats=Wt,this.lastSendStats=_t,_e||(this.lastFullRecvStats=Wt,this.lastFullSendStats=_t)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let _e=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(_e!==QI),++_e===QI+1&&(_e=1)},A1)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(_e,_t,Wt){if(!this.requestStats)return;if(Wt)return _e.rtt==null?void 0:{addition:{[qT.RTT]:_e.rtt,[qT.CONN_TYPE]:void 0}};const _n=N9(_e);if(this.store.useP2P){if(_t){const _i=N9(_t);_n[qT.CONN_TYPE]+=_i[qT.CONN_TYPE]<<3}_n[qT.CONN_TYPE]+=110}else _n[qT.CONN_TYPE]+=100;return{addition:_n}}getOutboundStats(_e,_t,Wt){if(!this.requestUploadStats||!this.requestLocalMedia)return;const _n=this.requestLocalMedia();if(!_n||_n.length===0)return;let _i,_s,_c;return _n.forEach(_u=>{let[_h,{track:_p,ssrcs:Qm}]=_u;switch(_h){case XE.LocalVideoLowTrack:case XE.LocalVideoTrack:if(_h===XE.LocalVideoTrack){const _g=function(aE,cE,fE,gE,AE){const PE=cE.videoSend.find(c_=>c_.ssrc===aE);if(!PE)return;const xE={},{sentFrame:GE,inputFrame:zE}=PE;if(zE&&GE){const c_=zE.frameRate,V_=GE.frameRate;xE[fS.FREEZE]=function(Q_,T0){let Z0=!0;return Z0=!(Q_<=5)&&(Q_<=10?T0<3:Q_<=20?T0<4:T0<5),Z0}(c_,V_)?1:0}if(L_(xE,fS.QP_SUM,PE.qpSumPerFrame),AE)return xE;switch(GE&&(L_(xE,fS.HEIGHT,GE.height),L_(xE,fS.WIDTH,GE.width),L_(xE,fS.FRAME_RATE,GE.frameRate)),xE[fS.DISABLED]=gE._originMediaStreamTrack&&!gE._originMediaStreamTrack.enabled||gE._mediaStreamTrack&&!gE._mediaStreamTrack.enabled?1:0,PE.adaptionChangeReason){case"none":xE[fS.ADAPTATION]=0;break;case"cpu":xE[fS.ADAPTATION]=1;break;case"bandwidth":xE[fS.ADAPTATION]=2;break;case"other":xE[fS.ADAPTATION]=3}let KE=0;PE.adaptionChangeReason&&(KE+=P9(PE.adaptionChangeReason)),cE.qualityLimitationReason&&(KE+=P9(cE.qualityLimitationReason)<<3),xE[fS.ADAPTATION]=KE,xE[fS.PLAYER_STATUS]=W6[gE._player?gE._player.videoElementStatus:"uninit"],L_(xE,fS.NACKS,PE.nacksCount),L_(xE,fS.PLIS,PE.plisCount),L_(xE,fS.FIRS,PE.firsCount),L_(xE,fS.AVG_ENCODE,PE.avgEncodeMs);const JE=fE&&fE.videoSend.find(c_=>c_.ssrc===aE);if(JE){let c_=AE?A1:A1*QI;JE.timestamp&&PE.timestamp&&(c_=PE.timestamp-JE.timestamp),JE.packets!=null&&PE.packets!=null&&L_(xE,fS.PACKAGE_RATE,1e3*(PE.packets-JE.packets)/c_),PE.packetsLost!=null&&JE.packetsLost!=null&&L_(xE,fS.PACKAGE_LOST,PE.packetsLost-JE.packetsLost),JE.bytes!=null&&PE.bytes!=null&&L_(xE,fS.BITRATE,8*(PE.bytes-JE.bytes)/c_)}return xE}(Qm[0].ssrcId,_e,_t,_p,Wt),eE=Wt?null:function(aE,cE,fE){const gE=cE.videoSend.find(KE=>KE.ssrc===aE);if(!gE)return null;const AE={},PE=gE.inputFrame,xE=PE&&PE.height||fE&&fE.videoHeight||0,GE=PE&&PE.width||fE&&fE.videoWidth||0,zE=PE&&PE.frameRate||0;return L_(AE,yM.HEIGHT,xE),L_(AE,yM.WIDTH,GE),L_(AE,yM.FRAME_RATE,zE),AE}(Qm[0].ssrcId,_e,_p),pE=Wt?null:function(aE){const cE={};return L_(cE,fS.RETRANSMIT,aE.bitrate.retransmit),L_(cE,fS.TARGET_ENCODED,aE.bitrate.targetEncoded),L_(cE,fS.ACTUAL_ENCODED,aE.bitrate.actualEncoded),L_(cE,fS.TRANSMIT,aE.bitrate.transmit),L_(cE,fS.BANDWIDTH,aE.sendBandwidth),cE}(_e);_s=Object.assign({},_g,eE,pE)}else _c=Wt?void 0:function(_g,eE,pE){const aE=eE.videoSend.find(gE=>gE.ssrc===_g);if(!aE)return;const cE={},fE=aE.sentFrame;if(fE&&(L_(cE,XI.HEIGHT,fE.height),L_(cE,XI.WIDTH,fE.width),L_(cE,XI.FRAME_RATE,fE.frameRate)),pE){const gE=pE.videoSend.find(AE=>AE.ssrc===_g);if(gE){let AE=A1*QI;gE.timestamp&&aE.timestamp&&(AE=aE.timestamp-gE.timestamp),gE.packets!=null&&aE.packets!=null&&L_(cE,XI.PACKAGE_RATE,1e3*(aE.packets-gE.packets)/AE),aE.packetsLost!=null&&gE.packetsLost!=null&&L_(cE,XI.PACKAGE_LOST,aE.packetsLost-gE.packetsLost),gE.bytes!=null&&aE.bytes!=null&&L_(cE,XI.BITRATE,8*(aE.bytes-gE.bytes)/AE)}}return cE}(Qm[0].ssrcId,_e,_t);break;case XE.LocalAudioTrack:_i=Wt?void 0:function(_g,eE,pE,aE){const cE=eE.audioSend.find(xE=>xE.ssrc===_g);if(!cE)return;const fE={};fE[aI.DISABLED]=aE._originMediaStreamTrack&&!aE._originMediaStreamTrack.enabled||aE._mediaStreamTrack&&!aE._mediaStreamTrack.enabled?1:0;const gE=100*aE._source.getAccurateVolumeLevel(),AE=cE.inputLevel;if(AE!=null){const xE=Math.ceil(50*Math.log10(100*AE+1));L_(fE,aI.LEVEL,xE)}L_(fE,A9.PCM_LEVEL,gE),L_(fE,aI.AEC_RETURN_LOSS,cE.aecReturnLoss),L_(fE,aI.AEC_RETURN_LOSS_ENH,cE.aecReturnLossEnhancement),fE[aI.FREEZE]=0;const PE=pE&&pE.audioSend.find(xE=>xE.ssrc===_g);if(PE){let xE=A1*QI;PE.timestamp&&cE.timestamp&&(xE=cE.timestamp-PE.timestamp),PE.bytes!=null&&cE.bytes!=null&&L_(fE,aI.BITRATE,8*(cE.bytes-PE.bytes)/xE),PE.packets!=null&&cE.packets!=null&&L_(fE,aI.PACKAGE_RATE,1e3*(cE.packets-PE.packets)/xE)}return fE}(Qm[0].ssrcId,_e,_t,_p)}}),{high:_s,low:_c,audio:_i}}getInboundStats(_e,_t,Wt){if(!this.requestRemoteMedia)return;const _n=this.requestRemoteMedia()||[],_i=[];return _n.forEach(_s=>{let[_c,_u]=_s;const _h={peer:_c.uid};if(_u.has(h_.VIDEO)&&_c.videoTrack){const _p=_c._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(_c._videoSSRC)||!1,Qm=_c.videoTrack?function(_g,eE,pE,aE,cE,fE,gE){var AE;const PE=eE.videoRecv.find(V_=>V_.ssrc===_g);if(!PE)return;const xE={},{receivedFrame:GE,outputFrame:zE,decodeFrameRate:KE}=PE,JE=pE&&pE.videoRecv.find(V_=>V_.ssrc===_g);if(xE[jS.FREEZE]=cE&&UP.isRemoteVideoFreeze(aE,PE,JE)?1:0,L_(xE,ZI.FRAME_RATE_DECODE,KE),L_(xE,jS.QP_SUM,PE.qpSumPerFrame),PE.framesRateFirefox&&L_(xE,jS.FRAME_RATE,PE.framesRateFirefox),GE&&L_(xE,jS.FRAME_RATE,GE.frameRate),JE){const V_=eE.timestamp-pE.timestamp||(gE?A1:QI*A1);PE.packetsLost!=null&&JE.packetsLost!=null&&L_(xE,jS.PACKAGE_LOST,PE.packetsLost-JE.packetsLost),JE.bytes!=null&&PE.bytes!=null&&L_(xE,jS.BITRATE,8*(PE.bytes-JE.bytes)/V_),JE.packets!=null&&PE.packets!=null&&L_(xE,jS.PACKAGE_RATE,1e3*(PE.packets-JE.packets)/V_)}if(gE)return xE;GE?(L_(xE,jS.HEIGHT,GE.height),L_(xE,jS.WIDTH,GE.width)):aE&&(L_(xE,jS.HEIGHT,aE._videoHeight||0),L_(xE,jS.WIDTH,aE._videoWidth||0)),zE&&L_(xE,ZI.FRAME_RATE_OUTPUT,zE.frameRate);const c_=(AE=aE._player)===null||AE===void 0?void 0:AE.rendFrameRate.toFixed(0);if(c_&&L_(xE,ZI.FRAME_RATE_RENDER,+c_),L_(xE,jS.JITTER_BUFFER,PE.jitterBufferMs),L_(xE,jS.CURRENT_DELAY,PE.currentDelayMs),L_(xE,jS.FIRS,PE.firsCount),L_(xE,jS.NACKS,PE.nacksCount),L_(xE,jS.PLIS,PE.plisCount),aE){xE[jS.DISABLED]=aE._originMediaStreamTrack.enabled&&aE._mediaStreamTrack.enabled?0:1;const V_=aE._player;if(V_){const{freezeTimeCounterList:Q_,renderFreezeAccTime:T0,videoElementStatus:Z0}=V_;if(Q_&&Q_.length>0&&L_(xE,ZI.FREEZE_TIME,Q_.splice(0,1)[0]),fE&&I1.visibility==="visible"&&Z0===HS.PLAYING&&B_().supportRequestVideoFrameCallback){const M0=Math.min(6e3,T0);V_.renderFreezeAccTime=Math.max(0,T0-M0),L_(xE,ZI.FREEZE_TIME_RENDER,M0)}if(typeof PE.totalFreezesDuration=="number"){const M0=JE&&JE.totalFreezesDuration?PE.totalFreezesDuration-JE.totalFreezesDuration:PE.totalFreezesDuration;L_(xE,ZI.FREEZE_DURATION,1e3*M0)}}}if(xE[jS.PLAYER_STATUS]=W6[aE._player?aE._player.videoElementStatus:"uninit"],JE&&PE.totalInterFrameDelay!==void 0&&PE.totalSquaredInterFrameDelay!==void 0&&JE.totalInterFrameDelay!==void 0&&JE.totalSquaredInterFrameDelay!==void 0){const V_=PE.totalInterFrameDelay-JE.totalInterFrameDelay,Q_=PE.totalSquaredInterFrameDelay-JE.totalSquaredInterFrameDelay,T0=PE.framesDecodeCount-JE.framesDecodeCount,Z0=V_/T0*1e3,M0=Math.round(1e3*Math.sqrt((Q_-Math.pow(V_,2)/T0)/T0));!isNaN(M0)&&Z0+M0>Math.max(3*Z0,Z0+150)&&(xE[jS.I_FRAME_DELAY]=M0)}return xE}(_c._videoSSRC,_e,_t,_c.videoTrack,_p===!0,this.needUploadRenderFreezeTime,Wt):void 0;Qm&&(_h.video=Qm)}if(_u.has(h_.AUDIO)&&_c.audioTrack){const _p=_c.audioTrack?function(Qm,_g,eE,pE,aE){const cE=_g.audioRecv.find(JE=>JE.ssrc===Qm);if(!cE)return;const fE={},gE=eE&&eE.audioRecv.find(JE=>JE.ssrc===Qm),{receivedFrames:AE,droppedFrames:PE}=cE;var xE,GE;if(L_(fE,ER.JITTER,cE.jitterMs),AE!=null&&PE!=null&&(fE[ER.FREEZE]=(GE=PE,(xE=AE)===0||100*GE/xE>20?1:0)),gE){const JE=_g.timestamp-eE.timestamp||(aE?A1:A1*QI);cE.packets!=null&&gE.packets!=null&&L_(fE,ER.PACKAGE_RATE,1e3*(cE.packets-gE.packets)/JE),gE.bytes!=null&&cE.bytes!=null&&L_(fE,ER.BITRATE,8*(cE.bytes-gE.bytes)/JE),cE.packetsLost!=null&&gE.packetsLost!=null&&L_(fE,ER.PACKAGE_LOST,cE.packetsLost-gE.packetsLost)}if(aE)return fE;const zE=100*pE._source.getAccurateVolumeLevel(),KE=cE.outputLevel;if(KE!=null){const JE=Math.ceil(50*Math.log10(100*KE+1));L_(fE,O9.LEVEL,JE)}if(L_(fE,ER.PCM_LEVEL,zE),pE&&(fE[ER.DISABLED]=pE._originMediaStreamTrack.enabled&&pE._mediaStreamTrack.enabled?0:1),L_(fE,ER.JITTER_BUFFER,cE.jitterBufferMs),L_(fE,ER.CURRENT_DELAY,cE.jitterBufferMs),fE[ER.PLAYER_STATUS]=W6[rT.getPlayerState(pE.getTrackId())],gE){const JE=cE.concealedSamples-gE.concealedSamples;JE>0&&L_(fE,ER.CONCEALED_SAMPLES,JE)}return fE}(_c._audioSSRC,_e,_t,_c.audioTrack,Wt):void 0;_p&&(_h.audio=_p)}(_h.video||_h.audio)&&_i.push(_h)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,_i}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const _e=(this.requestAllTracks()||[]).find(_t=>_t instanceof dM);if(_e&&_e._external.getDenoiserStats){const _t=_e._external.getDenoiserStats();_t&&this.requestUpload(LI.DENOISER_STATS,_t)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(_e=>{_e.getProcessorStats().forEach(_t=>{this.requestUpload&&this.requestUpload(_t.type,_t.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(_e=>{let[_t,Wt]=_e;Wt.has(h_.VIDEO)&&_t.videoTrack&&_t.videoTrack.getProcessorStats().forEach(_n=>{this.requestUpload&&this.requestUpload(_n.type,_n.stats)}),Wt.has(h_.AUDIO)&&_t.audioTrack&&_t.audioTrack.getProcessorStats().forEach(_n=>{this.requestUpload&&this.requestUpload(_n.type,_n.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const _e=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const _t=Date.now(),Wt={connectionInterval:yE("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:_t};let _n=[];const _i=this.requestAllTracks&&this.requestAllTracks()||[];for(const _h of _i)!_h.muted&&_h.enabled&&(_n=_n.concat(await _h.getProcessorUsage()));const _s=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[_h,_p]of _s)_p.has(h_.VIDEO)&&_h.videoTrack&&(_n=_n.concat(await _h.videoTrack.getProcessorUsage())),_p.has(h_.AUDIO)&&_h.audioTrack&&(_n=_n.concat(await _h.audioTrack.getProcessorUsage()));if(_n.length===0)return;Wt.details=function(_h,_p){const Qm={};for(const{id:aE,value:cE,level:fE,direction:gE}of _h){var _g;const AE=(_g=_p.get(aE))!==null&&_g!==void 0?_g:0,PE=cE===2?AE+yE("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:AE;var eE,pE;_p.set(aE,PE),Qm[aE]?(cE===2&&(Qm[aE].value=cE),fE>Qm[aE].level&&(Qm[aE].level=fE),gE==="remote"&&(Qm[aE].remoteUidCount+=1),Qm[aE].totalTs=(eE=_p.get(aE))!==null&&eE!==void 0?eE:0):Qm[aE]={value:cE,level:fE,remoteUidCount:gE==="local"?0:1,totalTs:(pE=_p.get(aE))!==null&&pE!==void 0?pE:0}}return Object.keys(Qm).map(aE=>{const{level:cE,value:fE,totalTs:gE}=Qm[aE];return{id:aE,level:cE,value:fE,totalTs:gE}})}(_n,_e);const _c=Date.now(),_u=_c>_t?_c:_t+1;this.requestUpload&&this.requestUpload(LI.EXTENSION_USAGE_STATS,{usageStats:Wt,sendTs:_u})},yE("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class cI{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(_e,_t){hE(this,"uid",void 0),hE(this,"_uintid",void 0),hE(this,"_trust_in_room_",!0),hE(this,"_trust_audio_enabled_state_",!0),hE(this,"_trust_video_enabled_state_",!0),hE(this,"_trust_audio_mute_state_",!0),hE(this,"_trust_video_mute_state_",!0),hE(this,"_audio_muted_",!1),hE(this,"_video_muted_",!1),hE(this,"_audio_enabled_",!0),hE(this,"_video_enabled_",!0),hE(this,"_audio_added_",!1),hE(this,"_video_added_",!1),hE(this,"_is_pre_created",!1),hE(this,"_video_pre_subscribed",!1),hE(this,"_audio_pre_subscribed",!1),hE(this,"_trust_video_stream_added_state_",!0),hE(this,"_trust_audio_stream_added_state_",!0),hE(this,"_audioTrack",void 0),hE(this,"_videoTrack",void 0),hE(this,"_dataChannels",[]),hE(this,"_audioSSRC",void 0),hE(this,"_videoSSRC",void 0),hE(this,"_audioOrtc",void 0),hE(this,"_videoOrtc",void 0),hE(this,"_cname",void 0),hE(this,"_rtxSsrcId",void 0),hE(this,"_videoMid",void 0),hE(this,"_audioMid",void 0),this.uid=_e,this._uintid=_t}}let MR=function($){return $.SEND_ONLY="SEND_ONLY",$.RECEIVE_ONLY="RECEIVE_ONLY",$}({});function bhe($,_e){var _t;let Wt;switch(_e){case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoTrack:Wt=i_(_t=$._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return Wt}function d8($){const _e=B_();if($.some(_t=>_t._bypassWebAudio))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!_e.webAudioMediaStreamDest)throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function h8($,_e){d8($);const _t=new iS;return $.forEach(Wt=>_t.addAudioTrack(Wt)),_t}var D9,L9,x9,M9,U9,j9,F9,V9,B9,G9,H9,P0;function W9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function bM($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?W9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):W9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let vT=(D9=UR(MR.SEND_ONLY),L9=UR(MR.SEND_ONLY),x9=UR(),M9=UR(MR.RECEIVE_ONLY),U9=UR(MR.RECEIVE_ONLY),j9=UR(MR.RECEIVE_ONLY),F9=UR(MR.RECEIVE_ONLY),V9=UR(MR.RECEIVE_ONLY),B9=UR(MR.RECEIVE_ONLY),G9=UR(),H9=UR(MR.RECEIVE_ONLY),P0=class extends A0{get state(){return this._state}set state($){const _e=this._state;this._state=$,this.emit(y_.StateChange,_e,this._state)}constructor($,_e){super(),hE(this,"store",void 0),hE(this,"statsUploader",void 0),hE(this,"sendConnection",void 0),hE(this,"recvConnection",void 0),hE(this,"localTrackMap",new Map),hE(this,"remoteUserMap",new Map),hE(this,"localDataChannels",[]),hE(this,"pendingLocalTracks",[]),hE(this,"pendingRemoteTracks",[]),hE(this,"statsCollector",void 0),hE(this,"dtlsFailedCount",0),hE(this,"sendMutex",new mS("P2PChannel2-send-mutex")),hE(this,"recvMutex",new mS("P2PChannel2-recv-mutex")),hE(this,"_state",i0.Disconnected),hE(this,"_restartStates",["disconnected","failed"]),hE(this,"reconnectInterval",void 0),hE(this,"uploadUnplinkStarted",!1),hE(this,"uploadDownlinkStarted",!1),hE(this,"uplinkStateUploadInterval",void 0),hE(this,"downlinkStatsUploadInterval",void 0),hE(this,"handleMuteLocalTrack",async(_t,Wt,_n)=>{const _i=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==i0.Connected)return void _n(new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const _u=this.filterTobeMutedTracks(_t);if(_u.length===0)return void Wt();const _h=_u.find(eE=>eE[0]==="videoLowTrack");_h&&_h[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(_u.map(eE=>{let[,{id:pE}]=eE;return pE}));let _p=!1;var _s,_c;_t.trackMediaType==="video"?_p=!((_s=this.localTrackMap.get(XE.LocalAudioTrack))===null||_s===void 0||!_s.track._muted):_p=((_c=this.localTrackMap.get(XE.LocalVideoTrack))===null||_c===void 0?void 0:_c.id)===void 0;const Qm=this.createMuteMessage(_u);await p0(this,y_.RequestMuteLocal,Qm);const _g=_t.trackMediaType==="video"?J1.MUTE_LOCAL_VIDEO:J1.MUTE_LOCAL_AUDIO;await p0(this,y_.RequestP2PMuteLocal,{action:_g,message:Qm,isMuteAll:_p}),Wt()}catch(_u){_n(_u)}finally{_i()}}),hE(this,"handleUnmuteLocalTrack",async(_t,Wt,_n)=>{const _i=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==i0.Connected)return void _n(new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const _s=this.filterTobeUnmutedTracks(_t);if(_s.length===0)return void Wt();await this.sendConnection.unmuteLocal(_s.map(_h=>{let[,{id:_p}]=_h;return _p}));const _c=this.createUnmuteMessage(_s),_u=_t.trackMediaType==="video"?J1.UNMUTE_LOCAL_VIDEO:J1.UNMUTE_LOCAL_AUDIO;await p0(this,y_.RequestP2PMuteLocal,{action:_u,message:_c}),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleUpdateVideoEncoder",async(_t,Wt,_n)=>{const _i=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const _s=this.localTrackMap.get(XE.LocalVideoTrack);if(!this.sendConnection||!_s||_s.track!==_t||this.state!==i0.Connected)return void Wt();const{id:_c,track:_u}=_s;_c&&(await this.sendConnection.updateSendParameters(_c,_u),await this.sendConnection.updateEncoderConfig(_c,_u),this.emit(y_.UpdateVideoEncoder,_u)),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleUpdateVideoSendParameters",async(_t,Wt,_n)=>{const _i=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const _s=this.localTrackMap.get(XE.LocalVideoTrack);if(!this.sendConnection||!_s||_s.track!==_t||this.state!==i0.Connected)return void Wt();const{id:_c,track:_u}=_s;_c&&await this.sendConnection.updateSendParameters(_c,_u),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleReplaceTrack",async(_t,Wt,_n,_i)=>{let _s;iE.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(_t.getTrackId(),"]")),typeof _i=="boolean"&&_i||(_s=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var _c;const _h=Array.from(this.localTrackMap.entries()).find(_p=>{let[,{track:Qm}]=_p;return _t===Qm});if(!this.sendConnection||!_h||_h[1].id===void 0||this.state!==i0.Connected)return void Wt();if(await((_c=this.sendConnection)===null||_c===void 0?void 0:_c.replaceTrack(_t,_h[1].id)),_h[0]===XE.LocalVideoTrack&&B_().supportDualStreamEncoding){const _p=this.localTrackMap.get(XE.LocalVideoLowTrack);if(_p){const Qm=_t._mediaStreamTrack.clone();_p.track._originMediaStreamTrack.stop(),_p.track._mediaStreamTrack=Qm,_p.track._originMediaStreamTrack=Qm,await new n_((_g,eE)=>{this.handleReplaceTrack(_p.track,_g,eE,!0)})}}Wt()}catch(_h){_n(_h)}finally{var _u;(_u=_s)===null||_u===void 0||_u()}}),hE(this,"handleGetLocalVideoStats",_t=>{_t(this.statsCollector.getLocalVideoTrackStats())}),hE(this,"handleGetLocalAudioStats",_t=>{_t(this.statsCollector.getLocalAudioTrackStats())}),hE(this,"handleGetRemoteVideoStats",_t=>this.statsCollector.getRemoteVideoTrackStats(_t.uid)[_t.uid]),hE(this,"handleGetRemoteAudioStats",_t=>this.statsCollector.getRemoteAudioTrackStats(_t.uid)[_t.uid]),this.store=$,this.statsCollector=_e,this.statsCollector.addP2PChannel(this),this.statsUploader=new k9($),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(_t=>{_t&&(_t.iceConnectionState!=="disconnected"&&_t.iceConnectionState!=="failed"||this.handleDisconnect(_t.direction))})},yE("ICE_RESTART_INTERVAL"))}async startP2PConnection($,_e){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect($,_e,_t,Wt,_n,_i){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P($,_e){let _t;try{if(_e){this.recvConnection&&(iE.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),_t=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new I9($,this.store,YS.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const Wt=await this.recvConnection.establish(_e);return{iceParameters:Wt.iceParameters,dtlsParameters:Wt.dtlsParameters,sdp:Wt.sdp}}{this.state=i0.New,this.sendConnection&&(iE.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),_t=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new I9($,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const Wt=await this.sendConnection.establish();return{iceParameters:Wt.iceParameters,dtlsParameters:Wt.dtlsParameters,sdp:Wt.sdp}}}finally{_t&&_t()}}async p2pConnect($){if(!this.sendConnection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect($),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=i0.Connected}async addRemoteCandidate($,_e){if(_e===YS.RECEIVE_ONLY){if(!this.sendConnection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate($)}else{if(!this.recvConnection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate($)}}publish($,_e,_t){var Wt=this;return ET(function*(){const _n=yield k_(Wt.sendMutex.lock("From P2PChannel.publish"));try{if(!Wt.sendConnection||Wt.state!==i0.Connected){Wt.throwIfTrackTypeNotMatch($);const _h=$.filter(_p=>Wt.pendingLocalTracks.indexOf(_p)===-1);return void(Wt.pendingLocalTracks=Wt.pendingLocalTracks.concat(_h))}Wt.store.pubId=Wt.store.pubId+1,DS.markPublishStart(Wt.store.clientId,Wt.store.pubId);const _i=Wt.filterTobePublishedTracks($,_e,_t);if(_i.length===0)return void(yield k_(Wt.tryToUnmuteAudio($)));_i.forEach(_h=>{let{track:_p,type:Qm}=_h;const _g=Date.now();Wt.store.publish(_p.getTrackId(),Qm===XE.LocalAudioTrack?"audio":"video",_g)}),Wt.bindLocalTrackEvents(_i);const _s=yield k_(Wt.sendConnection.send(_i.map(_h=>{let{track:_p}=_h;return _p}),Wt.store.codec,Wt.store.audioCodec)),_c=(yield k_(_s.next())).value,_u=Wt.createGatewayPublishMessage(_i,_c);try{yield _u}catch(_h){throw _s.throw(_h),(_h==null?void 0:_h.code)===mE.WS_ABORT&&_i.forEach(_p=>{let{track:Qm}=_p;Wt.pendingLocalTracks.indexOf(Qm)===-1&&Wt.pendingLocalTracks.push(Qm)}),Wt.unbindLocalTrackEvents(_i),_h}yield k_(_s.next()),_i.forEach(_h=>{let{type:_p}=_h;Wt.statsCollector.addLocalStats(_p)}),Wt.statsUploader.startUploadOutboundStats(),Wt.assignLocalTracks(_i,_c),_i.forEach(_h=>{let{track:_p,type:Qm}=_h;const _g=Date.now();Wt.store.publish(_p.getTrackId(),Qm===XE.LocalAudioTrack?"audio":"video",void 0,_g)}),Wt.startUploadUplinkState()}finally{_n()}})()}async unpublish($){if(!this.sendConnection||this.state!==i0.Connected)return void($.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(_n=>!i_($).call($,_n)));const _e=this.filterTobeUnpublishedTracks($);if(_e.length===0)return;const _t=_e.find(_n=>_n[0]==="videoLowTrack");_t&&_t[1].track.close();const Wt=this.createGatewayUnpublishMessage(_e);if(await this.sendConnection.stopSending(_e.map(_n=>{let[,{id:_i}]=_n;return _i})),this.withdrawLocalTracks(_e),this.unbindLocalTrackEvents(_e.map(_n=>{let[_i,{track:_s}]=_n;return{type:_i,track:_s}})),_e.forEach(_n=>{let[_i]=_n;this.statsCollector.removeLocalStats(_i)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===i0.Connected)return _t&&_t[1].track.close(),Wt;$.forEach(_n=>{const _i=this.pendingLocalTracks.indexOf(_n);_i!==-1&&this.pendingLocalTracks.splice(_i,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const $=()=>{const _e=[],_t=[];Array.from(this.localTrackMap.entries()).forEach(Wt=>{let[_n,{track:_i,ssrcs:_s}]=Wt;const _c={stream_type:bhe(_i,_n),ssrcs:_s};_i._muted||!_i._enabled?_e.push(_c):_t.push(_c)}),_e.length>0&&_e.forEach(Wt=>{p0(this,y_.RequestMuteLocal,[Wt])}),_t.length>0&&_t.forEach(Wt=>{p0(this,y_.RequestUnmuteLocal,[Wt])})};$(),this.uplinkStateUploadInterval=window.setInterval(()=>{$()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream($){return ET(function*(){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(iE.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await _y(this,y_.RequestRePublish,this.pendingLocalTracks),this.emit(y_.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe($,_e,_t,Wt){var _n;if(!this.recvConnection)throw new HE(mE.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((_n=this.remoteUserMap.get($))!==null&&_n!==void 0&&_n.has(_e))return;const{track:_i,mid:_s,transceiver:_c}=await this.recvConnection.receive(_e,[{ssrcId:_t}],String($.uid),Wt);_e===h_.AUDIO?($._audioTrack?$._audioTrack._updateOriginMediaStreamTrack(_i):($._audioTrack=new oN(_i,$.uid,$._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat($._audioTrack.getTrackId()))),_c&&$._audioTrack._updateRtpTransceiver(_c),this.bindRemoteTrackEvents($,$._audioTrack)):($._videoSSRC=_t,$._videoTrack?$._videoTrack._updateOriginMediaStreamTrack(_i):($._videoTrack=new iN(_i,$.uid,$._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat($._videoTrack.getTrackId()))),_c&&$._videoTrack._updateRtpTransceiver(_c),this.bindRemoteTrackEvents($,$._videoTrack));const _u=this.remoteUserMap.get($);_u?_u.set(_e,_s):this.remoteUserMap.set($,new Map([[_e,_s]])),this.statsCollector.addRemoteStats($.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const _h=this.pendingRemoteTracks.findIndex(_p=>{let{user:Qm,kind:_g}=_p;return Qm.uid===$.uid&&_e===_g});_h!==-1&&(this.pendingRemoteTracks.splice(_h,1),this.emit(y_.MediaReconnectEnd,$.uid))}async mockSubscribe($,_e,_t,Wt){if(!this.recvConnection)throw new HE(mE.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(_e,[{ssrcId:_t}],String($.uid),Wt)}async unsubscribe($,_e,_t){const Wt=this.pendingRemoteTracks.filter(_i=>{let{user:_s,kind:_c}=_i;return _e!==void 0?_s.uid===$.uid&&_e===_c:_s.uid===$.uid});if(Wt.forEach(_i=>{const _s=this.pendingRemoteTracks.indexOf(_i);this.pendingRemoteTracks.splice(_s,1)}),this.recvConnection||_t||Wt.forEach(_i=>{let{kind:_s}=_i;var _c;if(_s===h_.AUDIO)(_c=$._audioTrack)===null||_c===void 0||_c._destroy(),$._audioTrack=void 0;else if(_s===h_.VIDEO){var _u;(_u=$._videoTrack)===null||_u===void 0||_u._destroy(),$._videoTrack=void 0}}),!this.recvConnection)return;const _n=this.filterTobeUnSubscribedTracks($,_e);_n.length!==0&&(await this.recvConnection.stopReceiving(_n.map(_i=>{let[,{id:_s}]=_i;return _s})),this.withdrawRemoteTracks(_n),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),_n.forEach(_i=>{let[_s,{kind:_c}]=_i;var _u,_h;if(_c===h_.VIDEO&&_s._videoSSRC&&((_u=this.recvConnection)===null||_u===void 0||_u.setStatsRemoteVideoIsReady(_s._videoSSRC,!1)),_c===h_.VIDEO)this.unbindRemoteTrackEvents(_s._videoTrack),_t||((_h=_s._videoTrack)===null||_h===void 0||_h._destroy(),_s._videoTrack=void 0);else if(_c===h_.AUDIO){var _p;this.unbindRemoteTrackEvents(_s._audioTrack),!_t&&((_p=_s._audioTrack)===null||_p===void 0||_p._destroy(),_s._audioTrack=void 0)}}),_n.forEach(_i=>{let[,{kind:_s}]=_i;p0(this,y_.RequestP2PMuteRemote,_s)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const $=()=>Array.from(this.remoteUserMap.entries()).forEach(_e=>{let[,_t]=_e;[h_.VIDEO,h_.AUDIO].forEach(Wt=>{_t.has(Wt)?p0(this,y_.RequestP2PUnmuteRemote,Wt):p0(this,y_.RequestP2PMuteRemote,Wt)})});$(),this.downlinkStatsUploadInterval=window.setInterval(()=>{$()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe($){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock($){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe($){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock($){throw new HE(mE.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote($,_e){if(!this.recvConnection)return;const _t=this.remoteUserMap.get($);if(!_t)return void iE.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat($.uid,"."));if(!_t.get(_e))return void iE.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat($.uid," media type ").concat(_e,"."));const Wt=_e===h_.VIDEO?$._videoSSRC:$._audioSSRC;Wt!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(Wt,!1)}async unmuteRemote($,_e){return this.unmuteRemoteNoLock($,_e)}async unmuteRemoteNoLock($,_e){if(!this.recvConnection)return;const _t=this.remoteUserMap.get($);if(!_t)return void iE.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat($.uid,"."));_t.get(_e)||iE.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat($.uid," media type ").concat(_e,"."))}getAllTracks($){const _e=this.localTrackMap.get(XE.LocalAudioTrack);if((_e==null?void 0:_e.track)instanceof iS){const _t=_e.track;return Array.from(this.localTrackMap.entries()).filter(Wt=>{let[_n]=Wt;return _n!==XE.LocalAudioTrack}).filter(Wt=>{let[_n]=Wt;return!($&&_n===XE.LocalVideoLowTrack)}).map(Wt=>{let[,{track:_n}]=Wt;return _n}).concat(_t.trackList)}return Array.from(this.localTrackMap.entries()).filter(_t=>{let[Wt]=_t;return!($&&Wt===XE.LocalVideoLowTrack)}).map(_t=>{let[,{track:Wt}]=_t;return Wt})}reportPublishEvent($,_e,_t,Wt,_n){if($){const _s=this.localTrackMap.get(XE.LocalAudioTrack),_c=Wt?this.localTrackMap.get(XE.LocalVideoLowTrack):this.localTrackMap.get(XE.LocalVideoTrack);p_.publish(this.store.sessionId,{eventElapse:DS.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:$,ec:_e,audioName:_s==null?void 0:_s.track.getTrackLabel(),videoName:_c==null?void 0:_c.track.getTrackLabel(),screenshare:(_c==null?void 0:_c.track._hints.indexOf(S0.SCREEN_TRACK))!==-1,audio:!!_s,video:!!_c,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_n})}else{var _i;_t||(_t=[]);const _s=_t.find(_u=>_u instanceof V0),_c=Wt?(_i=this.localTrackMap.get(XE.LocalVideoTrack))===null||_i===void 0?void 0:_i.track:_t.find(_u=>_u instanceof m0);p_.publish(this.store.sessionId,{eventElapse:DS.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:$,ec:_e,audioName:_s==null?void 0:_s.getTrackLabel(),videoName:_c==null?void 0:_c.getTrackLabel(),screenshare:(_c==null?void 0:_c._hints.indexOf(S0.SCREEN_TRACK))!==-1,audio:!!_s,video:!!_c,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_n})}}reportSubscribeEvent($,_e,_t,Wt){const _n=Wt===h_.VIDEO?_t._videoSSRC:_t._audioSSRC;_n&&p_.subscribe(this.store.sessionId,{succ:$,ec:_e,video:Wt===h_.VIDEO,audio:Wt===h_.AUDIO,peerid:_t.uid,subscribeRequestid:Wt===h_.VIDEO?_t._videoSSRC:_t._audioSSRC,p2pid:this.store.p2pId,eventElapse:DS.measureFromSubscribeStart(this.store.clientId,_n)})}reset(){iE.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new mS("P2PChannel2-send-mutex"),this.sendMutex=new mS("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const $=this.localTrackMap.get(XE.LocalAudioTrack);if(($==null?void 0:$.track)instanceof iS){if($.track.trackList.length>0){const _e=$.track;$.track.trackList.forEach(_t=>{_e.removeAudioTrack(_t)})}$.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=i0.Disconnected}getStats($){var _e,_t;return $?(_t=this.recvConnection)===null||_t===void 0?void 0:_t.getStats():(_e=this.sendConnection)===null||_e===void 0?void 0:_e.getStats()}getRemoteVideoIsReady($){var _e;return((_e=this.recvConnection)===null||_e===void 0?void 0:_e.getRemoteVideoIsReady($))||!1}getLocalAudioVolume(){const $=this.localTrackMap.get(XE.LocalAudioTrack);if($)return $.track.getVolumeLevel()}getLocalVideoSize(){const $=this.localTrackMap.get(XE.LocalVideoTrack);if($)return{width:$.track.videoWidth||0,height:$.track.videoHeight||0}}getEncoderConfig($){const _e=this.localTrackMap.get($);return _e&&_e.track instanceof m0||_e&&_e.track instanceof V0?_e.track._encoderConfig:void 0}getLocalMedia($){return this.localTrackMap.get($)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia($,_e){if(!$)return this.remoteUserMap.size>0;const _t=this.remoteUserMap.get($);return!!_t&&(!_e||_t.has(_e))}async hasRemoteMediaWithLock($,_e){if(!$)return this.remoteUserMap.size>0;const _t=this.remoteUserMap.get($);return!!_t&&(!_e||_t.has(_e))}getRemoteMedia($){var _e;const _t=Array.from(ST(_e=this.remoteUserMap).call(_e)).find(Wt=>Wt.uid===$);return _t?{audioTrack:_t.audioTrack,audioSSRC:_t._audioSSRC,videoTrack:_t.videoTrack,videoSSRC:_t._videoSSRC}:{}}getAudioLevels(){let $=Array.from(this.remoteUserMap.entries()).map(_t=>{let[Wt]=_t;return{uid:Wt.uid,level:Wt.audioTrack?100*Wt.audioTrack._source.getAccurateVolumeLevel():0}});const _e=this.localTrackMap.get(XE.LocalAudioTrack);return _e&&$.push({level:100*_e.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),$=MN($).call($,(_t,Wt)=>_t.level-Wt.level),$}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(iE.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=i0.Reconnecting,yE("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e]=$;var _t;_e._videoTrack&&_e._videoTrack._player&&((_t=_e._videoTrack._player.getVideoElement())===null||_t===void 0||_t.pause(),_e._videoTrack._player.isKeepLastFrame=!0,_e._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach($=>{var _e;let[_t,{track:Wt}]=$;switch(_t){case XE.LocalVideoTrack:i_(_e=Wt._hints).call(_e,S0.LOW_STREAM)?Wt.close():this.pendingLocalTracks.push(Wt);break;case XE.LocalAudioTrack:Wt instanceof iS?this.pendingLocalTracks=this.pendingLocalTracks.concat(Wt.trackList):this.pendingLocalTracks.push(Wt);case XE.LocalVideoLowTrack:}}),this.emit(y_.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e,_t]=$;Array.from(ST(_t).call(_t)).forEach(Wt=>{this.setPendingRemoteMedia(_e,Wt)}),this.emit(y_.MediaReconnectStart,_e.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),iE.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia($,_e){for(const _t of this.pendingRemoteTracks){const{user:Wt,kind:_n}=_t;if(($ instanceof cI?$.uid:$)===Wt.uid&&_e===_n)return!0}return!1}setPendingRemoteMedia($,_e){this.hasPendingRemoteMedia($,_e)||this.pendingRemoteTracks.push({user:$,kind:_e})}async restartICE($,_e){let _t,Wt;if($===YS.SEND_ONLY){if(!this.sendConnection)throw new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");_t=await this.sendMutex.lock("From P2PChannel.restartICE"),Wt=this.sendConnection}else{if(!this.recvConnection)throw new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");_t=await this.recvMutex.lock("From P2PChannel.restartICE"),Wt=this.recvConnection}try{if(_e){const _n=await Wt.restartICE(_e);return Wt.isInRestartIce=!1,_n}{const _n=await Wt.restartICE();if(_n){const _i=await _y(this,y_.RequestP2PRestartICE,{direction:YS.RECEIVE_ONLY,iceParameter:_n});await Wt.restartICE(_i),Wt.isInRestartIce=!1}}}finally{_t()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const $=this.sendConnection.getStats(),_e=this.localTrackMap.get(XE.LocalVideoTrack),_t=this.localTrackMap.get(XE.LocalAudioTrack),Wt=$.videoSend.find(eE=>{var pE;return eE.ssrc===(_e==null||(pE=_e.ssrcs)===null||pE===void 0?void 0:pE[0].ssrcId)}),_n=$.audioSend.find(eE=>{var pE;return eE.ssrc===(_t==null||(pE=_t.ssrcs)===null||pE===void 0?void 0:pE[0].ssrcId)});if(!Wt||!_n)return 1;const _i=mT(this,y_.NeedSignalRTT),_s=Wt?Wt.rttMs:void 0,_c=_n?_n.rttMs:void 0,_u=_s&&_c?(_s+_c)/2:_s||_c,_h=(_u&&_i?(_u+_i)/2:_u||_i)||0,_p=100*$.sendPacketLossRate*.7/50+.3*_h/1500,Qm=_p<.17?1:_p<.36?2:_p<.59?3:_p<.1?4:5,_g=_e==null?void 0:_e.track;if(_g&&_g._encoderConfig&&_g._hints.indexOf(S0.SCREEN_TRACK)===-1){const eE=_g._encoderConfig.bitrateMax,pE=$.bitrate.actualEncoded;if(eE&&pE){const aE=(1e3*eE-pE)/(1e3*eE);return QH[aE<.15?0:aE<.3?1:aE<.45?2:aE<.6?3:4][Qm]}}return Qm}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const $=this.recvConnection.getStats();let _e=0;return Array.from(this.remoteUserMap.entries()).forEach(_t=>{let[Wt]=_t;const _n=Wt._audioSSRC,_i=Wt._videoSSRC,_s=$.audioRecv.find(pE=>pE.ssrc===_n),_c=$.videoRecv.find(pE=>pE.ssrc===_i);if(!_s&&!_c)return void(_e+=1);const _u=mT(this,y_.NeedSignalRTT),_h=$.rtt,_p=(_h&&_u?(_h+_u)/2:_h||_u)||0,Qm=_s?_s.jitterMs:void 0,_g=$.recvPacketLossRate;let eE=.7*_g*100/50+.3*_p/1500;Qm&&(eE=.6*_g*100/50+.2*_p/1500+.2*Qm/400),_e+=eE<.1?1:eE<.17?2:eE<.36?3:eE<.59?4:5}),this.remoteUserMap.size>0?Math.round(_e/this.remoteUserMap.size):_e}async muteLocalTrack($){return new n_((_e,_t)=>{this.handleMuteLocalTrack($,_e,_t)})}filterTobePublishedTracks($,_e,_t){const Wt=[],_n=B_(),_i=this.getAllTracks();$=AO($=$.filter(_u=>_i.indexOf(_u)===-1));let _s=!1,_c=!1;for(const _u of $){if(_u instanceof m0&&(this.localTrackMap.has(XE.LocalVideoTrack)||_s?new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(Wt.push({track:_u,type:XE.LocalVideoTrack}),_s=!0),_e)){const _h=this.getLowVideoTrack(_u,_t);Wt.push({track:_h,type:XE.LocalVideoLowTrack})}if(_u instanceof V0){const _h=this.localTrackMap.get(XE.LocalAudioTrack);if(_h){if(!(_h.track instanceof iS))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_u._bypassWebAudio)throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_h.track.addAudioTrack(_u),this.bindLocalAudioTrackEvents(_u,!0)}else if(_c){const _p=Wt.find(Qm=>{let{type:_g}=Qm;return _g===XE.LocalAudioTrack});if(!(_p.track instanceof iS))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_u._bypassWebAudio)throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_p.track.addAudioTrack(_u)}else{if(!_n.webAudioMediaStreamDest||_u instanceof iS||_u._bypassWebAudio)Wt.push({track:_u,type:XE.LocalAudioTrack});else{const _p=new iS;_p.addAudioTrack(_u),Wt.push({track:_p,type:XE.LocalAudioTrack})}_c=!0}}}return Wt}filterTobeUnpublishedTracks($){const _e=[],_t=this.getAllTracks();$=AO($=$.filter(Wt=>_t.indexOf(Wt)!==-1));for(const Wt of $){if(Wt instanceof V0){const _n=this.localTrackMap.get(XE.LocalAudioTrack);if(!_n)continue;_n.track instanceof iS?(_n.track.removeAudioTrack(Wt),this.unbindLocalAudioTrackEvents(Wt),_n.track.trackList.length===0&&(_e.push([XE.LocalAudioTrack,_n]),_n.track.close())):_e.push([XE.LocalAudioTrack,_n])}if(Wt instanceof m0){const _n=this.localTrackMap.get(XE.LocalVideoTrack);if(!_n)continue;_e.push([XE.LocalVideoTrack,_n]);const _i=this.localTrackMap.get(XE.LocalVideoLowTrack);_i&&_e.push([XE.LocalVideoLowTrack,_i])}}return _e}bindLocalTrackEvents($){$.forEach(_e=>{let{track:_t,type:Wt}=_e;switch(Wt){case XE.LocalVideoTrack:_t.addListener(a_.GET_STATS,this.handleGetLocalVideoStats),_t.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.addListener(a_.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),_t.addListener(a_.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),_t.addListener(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),_t.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case XE.LocalAudioTrack:this.bindLocalAudioTrackEvents(_t);case XE.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents($,_e){$ instanceof iS?$.trackList.forEach(_t=>{_t.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.addListener(a_.GET_STATS,this.handleGetLocalAudioStats),_t.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):($.addListener(a_.GET_STATS,this.handleGetLocalAudioStats),$.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),$.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),$.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),$.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),_e||$.addListener(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents($){$||($=Array.from(this.localTrackMap.entries()).map(_e=>{let[_t,{track:Wt}]=_e;return{track:Wt,type:_t}})),$.forEach(_e=>{let{track:_t,type:Wt}=_e;switch(Wt){case XE.LocalVideoTrack:_t.off(a_.GET_STATS,this.handleGetLocalVideoStats),_t.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.off(a_.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),_t.off(a_.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),_t.off(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),_t.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case XE.LocalAudioTrack:this.unbindLocalAudioTrackEvents(_t);case XE.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents($){$ instanceof iS?$.trackList.forEach(_e=>{_e.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_e.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_e.off(a_.GET_STATS,this.handleGetLocalAudioStats),_e.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_e.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):($.off(a_.GET_STATS,this.handleGetLocalAudioStats),$.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),$.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),$.off(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),$.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),$.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents($,_e){_e instanceof iN&&_e.addListener(a_.GET_STATS,_t=>{_t(this.handleGetRemoteVideoStats($))}),_e instanceof oN&&_e.addListener(a_.GET_STATS,_t=>{_t(this.handleGetRemoteAudioStats($))})}unbindRemoteTrackEvents($){$&&$.removeAllListeners(a_.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e,_t]=$;_t.has(h_.AUDIO)&&this.unbindRemoteTrackEvents(_e._audioTrack),_t.has(h_.VIDEO)&&this.unbindRemoteTrackEvents(_e._videoTrack)})}createGatewayPublishMessage($,_e){return $.map((_t,Wt)=>{var _n;let _i,{track:_s,type:_c}=_t;switch(_c){case XE.LocalAudioTrack:_i=n0.Audio;break;case XE.LocalVideoTrack:_i=i_(_n=_s._hints).call(_n,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:_i=n0.Low}return{kind:_c===XE.LocalAudioTrack?h_.AUDIO:h_.VIDEO,stream_type:_i,mid:_e[Wt].id,ssrcs:_e[Wt].localSSRC,isMuted:_s.muted||!_s.enabled}})}createGatewayUnpublishMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}assignLocalTracks($,_e){$.forEach((_t,Wt)=>{let{track:_n,type:_i}=_t;this.localTrackMap.set(_i,{track:_n,id:_e[Wt].id,ssrcs:_e[Wt].localSSRC})})}withdrawLocalTracks($){$.forEach(_e=>{let[_t]=_e;this.localTrackMap.delete(_t)})}bindConnectionEvents($){$.onConnectionStateChange=async _e=>{var _t;iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat($.name,".onConnectionStateChange(").concat(_e,")")),this.emit(y_.PeerConnectionStateChange,_e),_e!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),_e==="connected"&&($.isInRestartIce=!1),i_(_t=this._restartStates).call(_t,_e)&&!$.isInRestartIce&&(_e==="disconnected"&&await hS(800),$.iceConnectionState!=="disconnected"&&$.iceConnectionState!=="failed"||this.handleDisconnect($.direction))},$.onICEConnectionStateChange=_e=>{_e!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(_e,")")),p_.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:_e,tag:j0.TRACER}).onSuccess(),this.emit(y_.IceConnectionStateChange,_e)},$.onICETransportStateChange=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(_e,")"))},$.onDTLSTransportStateChange=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(_e,")"))},$.onDTLSTransportError=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(_e,")"))},$.onFirstAudioDecoded=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_i=>_i._audioSSRC===_e);var _n;Wt&&(this.store.subscribe(Wt.uid,"audio",void 0,void 0,void 0,Date.now()),(_n=Wt.audioTrack)===null||_n===void 0||_n.emit(eN.FIRST_FRAME_DECODED),p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_AUDIO_DECODE,L0.FIRST_AUDIO_DECODE,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId}))},$.onFirstAudioReceived=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_n=>_n._audioSSRC===_e);Wt&&p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_AUDIO_RECEIVED,L0.FIRST_AUDIO_RECEIVED,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId})},$.onFirstVideoDecoded=(_e,_t,Wt)=>{this.reportVideoFirstFrameDecoded(_e,_t,Wt)},$.onFirstVideoReceived=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_n=>_n._videoSSRC===_e);Wt&&p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_VIDEO_RECEIVED,L0.FIRST_VIDEO_RECEIVED,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId})},$.onSelectedLocalCandidateChanged=(_e,_t)=>{const Wt=_e.candidateType==="relay",_n=_t.candidateType==="relay";_t.candidateType!=="unknown"&&Wt===_n||this.emit(y_.ConnectionTypeChange,Wt),iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Z1(_t))," -> ").concat(JSON.stringify(Z1(_e)),")"))},$.onSelectedRemoteCandidateChanged=(_e,_t)=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Z1(_t))," -> ").concat(JSON.stringify(Z1(_e)),")"))},$.onFirstVideoDecodedTimeout=_e=>{this.reportVideoFirstFrameDecoded(_e,void 0,void 0,!0)},$.onLocalCandidate=_e=>{this.emit(y_.LocalCandidate,{candidate:_e,direction:$.direction})}}unbindConnectionEvents($){$.onConnectionStateChange=void 0,$.onICEConnectionStateChange=void 0,$.onICETransportStateChange=void 0,$.onDTLSTransportStateChange=void 0,$.onDTLSTransportError=void 0,$.onFirstAudioDecoded=void 0,$.onFirstAudioReceived=void 0,$.onFirstVideoDecoded=void 0,$.onFirstVideoReceived=void 0,$.onSelectedLocalCandidateChanged=void 0,$.onSelectedRemoteCandidateChanged=void 0,$.onFirstVideoDecodedTimeout=void 0,$.onLocalCandidate=void 0}async handleDisconnect($){const _e=$===YS.SEND_ONLY?this.sendConnection:this.recvConnection;_e&&!_e.isInRestartIce&&(_e.isInRestartIce=!0,iE.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(_e.name,"] start use restartICE")),$===YS.SEND_ONLY?this.restartICE($):_y(this,y_.RequestP2PRestartICE,{direction:YS.SEND_ONLY}))}filterTobeMutedTracks($){const _e=[];if(this.getAllTracks().indexOf($)===-1)return _e;const _t=this.localTrackMap.get(XE.LocalAudioTrack);if($ instanceof V0&&(_t==null?void 0:_t.track)instanceof iS)return _t.track.isActive||_e.push([XE.LocalAudioTrack,_t]),_e;const Wt=Array.from(this.localTrackMap.entries()).find(_n=>{let[,{track:_i}]=_n;return $===_i});if(Wt&&(_e.push(Wt),Wt[0]===XE.LocalVideoTrack)){const _n=this.localTrackMap.get(XE.LocalVideoLowTrack);_n&&_e.push([XE.LocalVideoLowTrack,_n])}return _e}filterTobeUnmutedTracks($){const _e=[],_t=this.localTrackMap.get(XE.LocalAudioTrack);if($ instanceof V0&&(_t==null?void 0:_t.track)instanceof iS)return _t.track.isActive&&_e.push([XE.LocalAudioTrack,_t]),_e;const Wt=Array.from(this.localTrackMap.entries()).find(_n=>{let[,{track:_i}]=_n;return $===_i});if(Wt)if(Wt[0]===XE.LocalVideoTrack){_e.push(Wt);const _n=this.localTrackMap.get(XE.LocalVideoLowTrack);_n&&_e.push([XE.LocalVideoLowTrack,_n])}else _e.push(Wt);return _e}createMuteMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}createUnmuteMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}filterTobeUnSubscribedTracks($,_e){const _t=[],Wt=this.remoteUserMap.get($);if(!Wt)return _t;if(_e){const _n=Wt.get(_e);if(!_n)return _t;_t.push([$,{kind:_e,id:_n}])}else Array.from(Wt.entries()).forEach(_n=>{let[_i,_s]=_n;_t.push([$,{kind:_i,id:_s}])});return _t}createUnsubscribeMessage($){const _e=[];return $.forEach(_t=>{let[Wt,{kind:_n,id:_i}]=_t;switch(_n){case h_.VIDEO:return void(Wt._videoSSRC&&_e.push({stream_type:h_.VIDEO,ssrcId:Wt._videoSSRC}));case h_.AUDIO:return void(Wt._audioSSRC&&_e.push({stream_type:h_.AUDIO,ssrcId:Wt._audioSSRC}))}}),_e}withdrawRemoteTracks($){$.forEach(_e=>{let[_t,{kind:Wt}]=_e;const _n=this.remoteUserMap.get(_t);_n&&(_n.delete(Wt),Array.from(_n.entries()).length===0&&this.remoteUserMap.delete(_t))})}async updateBitrateLimit($){const _e=this.localTrackMap.get(XE.LocalVideoTrack),_t=this.localTrackMap.get(XE.LocalVideoLowTrack);_e&&await _e.track.setBitrateLimit($.uplink),_t&&$.low_stream_uplink&&await _t.track.setBitrateLimit({max_bitrate:$.low_stream_uplink.bitrate,min_bitrate:$.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const $=this.sendConnection.peerConnectionState,_e=this.recvConnection.peerConnectionState;return $!=="connected"&&_e!=="connected"}return!0}async tryToUnmuteAudio($){for(let _e=0;_e<$.length;_e++)if($[_e]instanceof V0){const _t=this.filterTobeUnmutedTracks($[_e]);if(_t.length===0)continue;const Wt=this.createUnmuteMessage(_t);return void await p0(this,y_.RequestUnmuteLocal,Wt)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=$=>this.getStats($),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter($=>{let[,{ssrcs:_e}]=$;return!!_e}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=$=>{var _e;return!((_e=this.recvConnection)===null||_e===void 0||!_e.getRemoteVideoIsReady($))},this.statsUploader.requestUpload=($,_e)=>this.emit(y_.RequestUpload,$,_e),this.statsUploader.requestUploadStats=$=>this.emit(y_.RequestUploadStats,$),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await hS(RL(this.dtlsFailedCount,Y0)),this.emit(y_.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(XE.LocalVideoTrack)||this.pendingLocalTracks.some($=>$ instanceof m0)}throwIfTrackTypeNotMatch($){if($.filter(_e=>_e instanceof m0).length>1)throw new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if($.filter(_e=>_e instanceof V0).length>1&&($.some(_e=>_e instanceof V0&&_e._bypassWebAudio)||!B_().webAudioMediaStreamDest))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const _e of $){if(_e instanceof m0&&this.pendingLocalTracks.some(_t=>_t instanceof m0))throw new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(_e instanceof V0&&this.pendingLocalTracks.some(_t=>_t instanceof V0)&&(!B_().webAudioMediaStreamDest||_e._bypassWebAudio||this.pendingLocalTracks.some(_t=>_t instanceof V0&&_t._bypassWebAudio)))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack($,_e){const _t=!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding,Wt=bM(bM({},{width:160,height:120,framerate:15,bitrate:50}),_e);let _n;_n=_t?$._mediaStreamTrack.clone():u8($,Wt);const _i=f0(8,"track-low-"),_s=new m0(_n,bM(bM({},_t&&{scaleResolutionDownBy:BV(Wt,$)}),{},{frameRate:Wt.framerate,bitrateMax:Wt.bitrate,bitrateMin:Wt.bitrate}),void 0,void 0,_i);return _s.on(zI.TRANSCEIVER_UPDATED,_c=>{$._updateRtpTransceiver(_c,ZO.LOW_STREAM)}),_s._hints.push(S0.LOW_STREAM),$.addListener(a_.NEED_CLOSE,()=>{_s.close()}),_s}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded($,_e,_t,Wt){var _n;const _i=Array.from(ST(_n=this.remoteUserMap).call(_n)).find(_s=>_s._videoSSRC===$);if(_i){Wt||this.store.subscribe(_i.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _s=this.store.keyMetrics,_c=_s.subscribe.find(_u=>_u.userId===_i.uid&&_u.type==="video");p_.firstRemoteVideoDecode(this.store.sessionId,gS.FIRST_VIDEO_DECODE,L0.FIRST_VIDEO_DECODE,{peer:_i._uintid,videowidth:_e,videoheight:_t,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,$),subscribeRequestid:$,p2pid:this.store.p2pId,apEnd:_s.requestAPEnd||0,apStart:_s.requestAPStart||0,joinGwEnd:_s.joinGatewayEnd||0,joinGwStart:_s.joinGatewayStart||0,pcEnd:_s.peerConnectionEnd||0,pcStart:_s.peerConnectionStart||0,subscriberEnd:(_c==null?void 0:_c.subscribeEnd)||0,subscriberStart:(_c==null?void 0:_c.subscribeStart)||0,videoAddNotify:(_c==null?void 0:_c.streamAdded)||0,state:Wt?1:0})}}async remoteMediaSsrcChanged($,_e,_t){if(!this.recvConnection)return!1;const Wt=this.remoteUserMap.get($);if(!Wt)return!1;const _n=Wt.get(_e);if(!_n)return!1;const _i=await this.recvConnection.getRemoteSSRC(_n);return _i!==void 0&&_i!==_t}resetConnection($){iE.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat($)),this.state===i0.Connected?(iE.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel($){throw new HE(mE.NOT_SUPPORTED)}async unpublishDataChannel($){throw new HE(mE.NOT_SUPPORTED)}async subscribeDataChannel($,_e){throw new HE(mE.NOT_SUPPORTED)}async unsubscribeDataChannel($,_e){throw new HE(mE.NOT_SUPPORTED)}hasPendingRemoteDataChannel($,_e){throw new HE(mE.NOT_SUPPORTED)}setPendingRemoteDataChannel($,_e){throw new HE(mE.NOT_SUPPORTED)}async preConnect($,_e,_t,Wt,_n,_i){throw new HE(mE.NOT_SUPPORTED)}getEstablishParams(){throw new HE(mE.NOT_SUPPORTED)}async reSubscribe($){throw new HE(mE.NOT_SUPPORTED)}async updateVideoStreamParameter($,_e){throw new HE(mE.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach($=>{let[_e,{track:_t}]=$;_e===XE.LocalVideoLowTrack?_t._updateRtpTransceiver(void 0,ZO.LOW_STREAM):_t._updateRtpTransceiver(void 0)})}},t_(P0.prototype,"p2pConnect",[D9],Object.getOwnPropertyDescriptor(P0.prototype,"p2pConnect"),P0.prototype),t_(P0.prototype,"unpublish",[L9],Object.getOwnPropertyDescriptor(P0.prototype,"unpublish"),P0.prototype),t_(P0.prototype,"unpublishLowStream",[x9],Object.getOwnPropertyDescriptor(P0.prototype,"unpublishLowStream"),P0.prototype),t_(P0.prototype,"subscribe",[M9],Object.getOwnPropertyDescriptor(P0.prototype,"subscribe"),P0.prototype),t_(P0.prototype,"mockSubscribe",[U9],Object.getOwnPropertyDescriptor(P0.prototype,"mockSubscribe"),P0.prototype),t_(P0.prototype,"unsubscribe",[j9],Object.getOwnPropertyDescriptor(P0.prototype,"unsubscribe"),P0.prototype),t_(P0.prototype,"muteRemote",[F9],Object.getOwnPropertyDescriptor(P0.prototype,"muteRemote"),P0.prototype),t_(P0.prototype,"unmuteRemote",[V9],Object.getOwnPropertyDescriptor(P0.prototype,"unmuteRemote"),P0.prototype),t_(P0.prototype,"hasRemoteMediaWithLock",[B9],Object.getOwnPropertyDescriptor(P0.prototype,"hasRemoteMediaWithLock"),P0.prototype),t_(P0.prototype,"disconnectForReconnect",[G9],Object.getOwnPropertyDescriptor(P0.prototype,"disconnectForReconnect"),P0.prototype),t_(P0.prototype,"remoteMediaSsrcChanged",[H9],Object.getOwnPropertyDescriptor(P0.prototype,"remoteMediaSsrcChanged"),P0.prototype),P0);function UR($){return function(_e,_t,Wt){const _n=_e[_t];if(typeof _n!="function")throw new Error("Cannot use mutex on object property.");return Wt.value=async function(){for(var _i=arguments.length,_s=new Array(_i),_c=0;_c<_i;_c++)_s[_c]=arguments[_c];switch($){case MR.SEND_ONLY:{const _u=await this.sendMutex.lock("From P2PChannel2.".concat(_t));try{return await _n.apply(this,_s)}finally{_u()}}case MR.RECEIVE_ONLY:{const _u=await this.recvMutex.lock("From P2PChannel2.".concat(_t));try{return await _n.apply(this,_s)}finally{_u()}}default:{const _u=await this.sendMutex.lock("From P2PChannel2.".concat(_t)),_h=await this.recvMutex.lock("From P2PChannel2.".concat(_t));try{return await _n.apply(this,_s)}finally{_u(),_h()}}}},Wt}}function q9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function _A($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?q9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):q9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class UP{constructor(_e){hE(this,"store",void 0),hE(this,"onStatsException",void 0),hE(this,"onUploadPublishDuration",void 0),hE(this,"onStatsChanged",void 0),hE(this,"localStats",new Map),hE(this,"remoteStats",new Map),hE(this,"updateStatsInterval",void 0),hE(this,"trafficStats",void 0),hE(this,"trafficStatsPeerList",[]),hE(this,"uplinkStats",void 0),hE(this,"exceptionMonitor",void 0),hE(this,"p2pChannel",void 0),hE(this,"scalabilityMode",tle.L1T1),hE(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=_e,this.exceptionMonitor=new rhe,this.exceptionMonitor.on("exception",(_t,Wt,_n)=>{this.onStatsException&&this.onStatsException(_t,Wt,_n)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(XE.LocalAudioTrack)||_A({},G6)}getLocalVideoTrackStats(){return this.localStats.get(XE.LocalVideoTrack)||_A({},H6)}getRemoteAudioTrackStats(_e){const _t=(_i,_s)=>{if(!this.trafficStats)return _s;const _c=this.trafficStats.peer_delay.find(_u=>_u.peer_uid===_i);return _c&&(_s.publishDuration=_c.B_ppad+(Date.now()-this.trafficStats.timestamp)),_s},Wt={};if(_e){var _n;const _i=(_n=this.remoteStats.get(_e))===null||_n===void 0?void 0:_n.audioStats;_i&&(Wt[_e]=_t(_e,_i))}else Array.from(this.remoteStats.entries()).forEach(_i=>{let[_s,{audioStats:_c}]=_i;_c&&(Wt[_s]=_t(_s,_c))});return Wt}getRemoteNetworkQualityStats(_e){const _t={};if(_e){var Wt;const _n=(Wt=this.remoteStats.get(_e))===null||Wt===void 0?void 0:Wt.networkStats;_n&&(_t[_e]=_n)}else Array.from(this.remoteStats.entries()).forEach(_n=>{let[_i,{networkStats:_s}]=_n;_s&&(_t[_i]=_s)});return _t}getRemoteVideoTrackStats(_e){const _t=(_i,_s)=>{if(!this.trafficStats)return _s;const _c=this.trafficStats.peer_delay.find(_u=>_u.peer_uid===_i);return _c&&(_s.publishDuration=_c.B_ppvd+(Date.now()-this.trafficStats.timestamp)),_s},Wt={};if(_e){var _n;const _i=(_n=this.remoteStats.get(_e))===null||_n===void 0?void 0:_n.videoStats;_i&&(Wt[_e]=_t(_e,_i))}else Array.from(this.remoteStats.entries()).forEach(_i=>{let[_s,{videoStats:_c}]=_i;_c&&(Wt[_s]=_t(_s,_c))});return Wt}getRTCStats(){let _e=0,_t=0,Wt=0,_n=0;const _i=this.localStats.get(XE.LocalAudioTrack);_i&&(_e+=_i.sendBytes,_t+=_i.sendBitrate);const _s=this.localStats.get(XE.LocalVideoTrack);_s&&(_e+=_s.sendBytes,_t+=_s.sendBitrate);const _c=this.localStats.get(XE.LocalVideoLowTrack);_c&&(_e+=_c.sendBytes,_t+=_c.sendBitrate),this.remoteStats.forEach(_h=>{let{audioStats:_p,videoStats:Qm}=_h;_p&&(Wt+=_p.receiveBytes,_n+=_p.receiveBitrate),Qm&&(Wt+=Qm.receiveBytes,_n+=Qm.receiveBitrate)});let _u=1;return this.trafficStats&&(_u+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_u,SendBitrate:_t,SendBytes:_e,RecvBytes:Wt,RecvBitrate:_n,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(_e){this.localStats.set(_e,void 0)}removeLocalStats(_e){_e?this.localStats.delete(_e):this.localStats.clear()}addRemoteStats(_e){this.remoteStats.set(_e,{})}removeRemoteStats(_e){_e?this.remoteStats.delete(_e):this.remoteStats.clear()}addP2PChannel(_e){this.p2pChannel=_e}updateTrafficStats(_e){_e.peer_delay=_e.peer_delay.filter(_t=>_t.B_ppad!==void 0||_t.B_ppvd!==void 0),_e.peer_delay.filter(_t=>this.trafficStatsPeerList.indexOf(_t.peer_uid)===-1).forEach(_t=>{var Wt;const _n=(Wt=this.p2pChannel)===null||Wt===void 0?void 0:Wt.getRemoteMedia(_t.peer_uid),_i=_n!=null&&_n.videoSSRC?DS.measureFromSubscribeStart(this.store.clientId,_n.videoSSRC):0,_s=_n!=null&&_n.audioSSRC?DS.measureFromSubscribeStart(this.store.clientId,_n.audioSSRC):0;_t.B_ppad!==void 0&&_t.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(_t.peer_uid,_t.B_ppad,_t.B_ppvd,_i>_s?_i:_s),this.trafficStatsPeerList.push(_t.peer_uid))}),this.trafficStats=_e}updateUplinkStats(_e){this.uplinkStats&&this.uplinkStats.B_fir!==_e.B_fir&&iE.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(_e.B_fir)),this.uplinkStats=_e}static isRemoteVideoFreeze(_e,_t,Wt){if(!_e)return!1;const _n=!!Wt&&_t.framesDecodeFreezeTime>Wt.framesDecodeFreezeTime,_i=!Wt||_t.framesDecodeCount>Wt.framesDecodeCount;return _n||!_i}static isRemoteAudioFreeze(_e){return!!_e&&_e._isFreeze()}isLocalVideoFreeze(_e){return!(!_e.inputFrame||!_e.sentFrame)&&_e.inputFrame.frameRate>5&&_e.sentFrame.frameRate<3}updateLocalStats(_e){Array.from(this.localStats.entries()).forEach(_t=>{let[Wt,_n]=_t;switch(Wt){case XE.LocalVideoTrack:case XE.LocalVideoLowTrack:{const _s=_n,_c=_A({},H6),_u=_e.getStats(),_h=_e.getLocalMedia(Wt);if(_u){const _p=_u.videoSend.find(Qm=>Qm.ssrc===(_h==null?void 0:_h.ssrcs[0].ssrcId));if(_p){const Qm=_e.getLocalVideoSize(),_g=_e.getEncoderConfig(XE.LocalVideoTrack);_p.codec!=="H264"&&_p.codec!=="H265"&&_p.codec!=="VP8"&&_p.codec!=="VP9"&&_p.codec!=="AV1X"&&_p.codec!=="AV1"||(_c.codecType=_p.codec),_c.sendBytes=_p.bytes,_c.sendBitrate=_s?8*Math.max(0,_c.sendBytes-_s.sendBytes):0,_p.inputFrame?(_c.captureFrameRate=_p.inputFrame.frameRate,_c.captureResolutionHeight=_p.inputFrame.height,_c.captureResolutionWidth=_p.inputFrame.width):Qm&&(_c.captureResolutionWidth=Qm.width,_c.captureResolutionHeight=Qm.height),_p.sentFrame?(_c.sendFrameRate=_p.sentFrame.frameRate,_c.sendResolutionHeight=_p.sentFrame.height,_c.sendResolutionWidth=_p.sentFrame.width):Qm&&(_c.sendResolutionWidth=Qm.width,_c.sendResolutionHeight=Qm.height),_p.avgEncodeMs&&(_c.encodeDelay=_p.avgEncodeMs),_g&&_g.bitrateMax&&(_c.targetSendBitrate=1e3*_g.bitrateMax),_c.sendPackets=_p.packets,_c.sendPacketsLost=_p.packetsLost,_c.sendJitterMs=_p.jitterMs,_c.sendRttMs=_p.rttMs,_c.totalDuration=_s?_s.totalDuration+1:1,_c.totalFreezeTime=_s?_s.totalFreezeTime:0,this.isLocalVideoFreeze(_p)&&(_c.totalFreezeTime+=1),_p.scalabilityMode&&this.scalabilityMode!==_p.scalabilityMode&&(iE.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(_p.scalabilityMode)),this.scalabilityMode=_p.scalabilityMode)}this.trafficStats&&(_c.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var _i;this.localStats.set(Wt,_c),((_s==null?void 0:_s.sendResolutionWidth)!==_c.sendResolutionWidth||(_s==null?void 0:_s.sendResolutionHeight)!==_c.sendResolutionHeight)&&((_i=this.onStatsChanged)===null||_i===void 0||_i.call(this,"resolution",{width:_c.sendResolutionWidth,height:_c.sendResolutionHeight})),_c&&_h&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,_h.track,_c);break}case XE.LocalAudioTrack:{const _s=_n,_c=_A({},G6),_u=_e.getStats(),_h=_e.getLocalMedia(Wt);if(_u){const _p=_u.audioSend.find(Qm=>Qm.ssrc===(_h==null?void 0:_h.ssrcs[0].ssrcId));if(_p){if(_p.codec!=="opus"&&_p.codec!=="aac"&&_p.codec!=="PCMU"&&_p.codec!=="PCMA"&&_p.codec!=="G722"||(_c.codecType=_p.codec),_p.inputLevel)_c.sendVolumeLevel=Math.round(32767*_p.inputLevel);else{const Qm=_e.getLocalAudioVolume();Qm&&(_c.sendVolumeLevel=Math.round(32767*Qm))}_c.sendBytes=_p.bytes,_c.sendPackets=_p.packets,_c.sendPacketsLost=_p.packetsLost,_c.sendJitterMs=_p.jitterMs,_c.sendRttMs=_p.rttMs,_c.sendBitrate=_s?8*Math.max(0,_c.sendBytes-_s.sendBytes):0}}this.trafficStats&&(_c.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(XE.LocalAudioTrack,_c),_c&&_h&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,_h.track,_c);break}}})}updateRemoteStats(_e){Array.from(this.remoteStats.entries()).forEach(_t=>{var Wt,_n;let[_i,{videoStats:_s,audioStats:_c,videoPcStats:_u}]=_t;const _h=_c,_p=_s,Qm=_u,_g=_A({},iK),eE=_A({},oK),pE=_A({},qde),{audioTrack:aE,videoTrack:cE,audioSSRC:fE,videoSSRC:gE}=_e.getRemoteMedia(_i);let AE;AE=_e instanceof vT?_e.getStats(!0):_e.getStats();const PE=(Wt=AE)===null||Wt===void 0?void 0:Wt.audioRecv.find(zE=>zE.ssrc===fE),xE=(_n=AE)===null||_n===void 0?void 0:_n.videoRecv.find(zE=>zE.ssrc===gE),GE=this.trafficStats&&this.trafficStats.peer_delay.find(zE=>zE.peer_uid===_i);if(PE&&(PE.codec!=="opus"&&PE.codec!=="aac"&&PE.codec!=="PCMU"&&PE.codec!=="PCMA"&&PE.codec!=="G722"||(_g.codecType=PE.codec),PE.outputLevel?_g.receiveLevel=Math.round(32767*PE.outputLevel):aE&&(_g.receiveLevel=Math.round(32767*aE.getVolumeLevel())),_g.receiveBytes=PE.bytes,_g.receivePackets=PE.packets,_g.receivePacketsLost=PE.packetsLost,_g.packetLossRate=_g.receivePacketsLost/(_g.receivePackets+_g.receivePacketsLost),_g.receiveBitrate=_h?8*Math.max(0,_g.receiveBytes-_h.receiveBytes):0,_g.totalDuration=_h?_h.totalDuration+1:1,_g.totalFreezeTime=_h?_h.totalFreezeTime:0,_g.freezeRate=_g.totalFreezeTime/_g.totalDuration,_g.receiveDelay=PE.jitterBufferMs,_g.totalDuration>10&&UP.isRemoteAudioFreeze(aE)&&(_g.totalFreezeTime+=1)),xE){xE.codec!=="H264"&&xE.codec!=="H265"&&xE.codec!=="VP8"&&xE.codec!=="VP9"&&xE.codec!=="AV1X"&&xE.codec!=="AV1"||(eE.codecType=xE.codec),eE.receiveBytes=xE.bytes,eE.receiveBitrate=_p?8*Math.max(0,eE.receiveBytes-_p.receiveBytes):0,eE.decodeFrameRate=xE.decodeFrameRate<0?0:xE.decodeFrameRate,eE.renderFrameRate=xE.decodeFrameRate<0?0:xE.decodeFrameRate,xE.outputFrame&&(eE.renderFrameRate=xE.outputFrame.frameRate),xE.receivedFrame?(eE.receiveFrameRate=xE.receivedFrame.frameRate,eE.receiveResolutionHeight=xE.receivedFrame.height,eE.receiveResolutionWidth=xE.receivedFrame.width):cE&&(eE.receiveResolutionHeight=cE._videoHeight||0,eE.receiveResolutionWidth=cE._videoWidth||0),xE.framesRateFirefox!==void 0&&(eE.receiveFrameRate=Math.round(xE.framesRateFirefox)),eE.receivePackets=xE.packets,eE.receivePacketsLost=xE.packetsLost,eE.packetLossRate=eE.receivePacketsLost/(eE.receivePackets+eE.receivePacketsLost),eE.totalDuration=_p?_p.totalDuration+1:1,eE.totalFreezeTime=_p?_p.totalFreezeTime:0,eE.receiveDelay=xE.jitterBufferMs||0;const zE=!!gE&&_e.getRemoteVideoIsReady(gE);cE&&zE&&UP.isRemoteVideoFreeze(cE,xE,Qm)&&(eE.totalFreezeTime+=1),eE.freezeRate=eE.totalFreezeTime/eE.totalDuration}GE&&(_g.end2EndDelay=GE.B_ad,eE.end2EndDelay=GE.B_vd,_g.transportDelay=GE.B_ed,eE.transportDelay=GE.B_ed,_g.currentPacketLossRate=GE.B_ealr4/100,eE.currentPacketLossRate=GE.B_evlr4/100,pE.uplinkNetworkQuality=GE.B_punq?GE.B_punq:0,pE.downlinkNetworkQuality=GE.B_pdnq?GE.B_pdnq:0),this.remoteStats.set(_i,{audioStats:_g,videoStats:eE,videoPcStats:xE,networkStats:pE}),aE&&this.exceptionMonitor.setRemoteAudioStats(aE,_g),cE&&this.exceptionMonitor.setRemoteVideoStats(cE,eE)})}}function z9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function jP($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?z9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):z9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class She extends A0{constructor(_e,_t,Wt,_n){super(),hE(this,"spec",void 0),hE(this,"token",void 0),hE(this,"websocket",void 0),hE(this,"pingpongTimer",void 0),hE(this,"reconnectMode","retry"),hE(this,"serviceMode",void 0),hE(this,"reqId",0),hE(this,"commandReqId",0),hE(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),hE(this,"handleWebSocketMessage",_i=>{if(!_i.data)return;const _s=JSON.parse(_i.data);_s.requestId?this.emit("@".concat(_s.requestId,"-").concat(_s.sid),_s):this.serviceMode===ES.INJECT?this.emit(ZR.INJECT_STREAM_STATUS,_s):(p_.workerEvent(this.spec.sid,{actionType:"status",serverCode:_s.code,workerType:this.serviceMode===ES.TRANSCODE?1:2}),this.emit(ZR.PUBLISH_STREAM_STATUS,_s))}),this.spec=_t,this.token=_e,this.serviceMode=_n,this.websocket=new oP("live-streaming",Wt),this.websocket.on(T_.CONNECTED,this.handleWebSocketOpen),this.websocket.on(T_.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(T_.REQUEST_NEW_URLS,(_i,_s)=>{_y(this,ZR.REQUEST_NEW_ADDRESS).then(_i).catch(_s)}),this.websocket.on(T_.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(_e){return this.websocket.init(_e)}async request(_e,_t,Wt,_n){this.reqId+=1,_e==="request"&&(this.commandReqId+=1);const _i=this.commandReqId,_s=this.reqId;if(!_s||!this.websocket)throw new DE(mE.UNEXPECTED_ERROR);const _c=jP({command:_e,sdkVersion:jT==="4.21.0"?"0.0.1":jT,seq:_s,requestId:_s,allocate:Wt,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},_t);if(this.websocket.state==="closed")throw new DE(mE.WS_DISCONNECT);const _u=()=>new n_((_g,eE)=>{this.websocket.once(T_.CLOSED,()=>eE(new DE(mE.WS_ABORT))),this.websocket.once(T_.CONNECTED,_g)});this.websocket.state!=="connected"&&await _u(),_c.clientRequest&&(_c.clientRequest.workerToken=this.token);const _h=new n_((_g,eE)=>{const pE=()=>{eE(new DE(mE.WS_ABORT))};this.websocket.once(T_.RECONNECTING,pE),this.websocket.once(T_.CLOSED,pE),this.once("@".concat(_s,"-").concat(this.spec.sid),aE=>{_g(aE)})});_n&&p_.workerEvent(this.spec.sid,jP(jP({},_n),{},{requestId:_i,actionType:"request",payload:JSON.stringify(_t.clientRequest),serverCode:0,code:0}));const _p=Date.now();this.websocket.sendMessage(_c);let Qm=null;try{Qm=await _h}catch(_g){if(this.websocket.state==="closed")throw _g;return await _u(),await this.request(_e,_t,Wt)}return _n&&p_.workerEvent(this.spec.sid,jP(jP({},_n),{},{requestId:_i,actionType:"response",payload:JSON.stringify(Qm.serverResponse),serverCode:Qm.code,success:Qm.code===200,responseTime:Date.now()-_p})),Qm.code!==200&&this.handleResponseError(Qm),Qm}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const _e=jT==="4.21.0"?"0.0.1":jT;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:_e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(_e){switch(_e.code){case rS.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void iE.warning("live stream response already exists stream");case rS.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case rS.LIVE_STREAM_RESPONSE_BAD_STREAM:case rS.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new DE(mE.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:_e.code}).throw();case rS.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(_e.serverResponse.command==="UnpublishStream"||_e.serverResponse.command==="UninjectStream")return;throw new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case rS.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new DE(mE.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:_e.code}).throw();case rS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const _t=new DE(mE.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(ZR.WARNING,_t,_e.serverResponse.url)}case rS.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const _t=new DE(mE.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(ZR.WARNING,_t,_e.serverResponse.url)}case rS.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case rS.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new DE(mE.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:_e.code}).throw();case rS.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const _t=new DE(mE.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(ZR.WARNING,_t,_e.serverResponse.url)}case rS.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:_e.code}).throw();case rS.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case rS.LIVE_STREAM_RESPONSE_WORKER_LOST:case rS.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(_e.serverResponse.command==="UnpublishStream"||_e.serverResponse.command==="UninjectStream")return;throw new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case rS.ERROR_FAIL_SEND_MESSAGE:if(_e.serverResponse.command==="UnpublishStream"||_e.serverResponse.command==="UninjectStream")return;if(_e.serverResponse.command==="UpdateTranscoding"||_e.serverResponse.command==="ControlStream")return new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:_e.code}).throw();throw new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case rS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new DE(mE.LIVE_STREAMING_CDN_ERROR,"",{code:_e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(TL)},6e3)}}function K9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function iT($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?K9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):K9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}class The extends A0{constructor(_e){let _t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y0,Wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Y0;super(),hE(this,"onLiveStreamWarning",void 0),hE(this,"onLiveStreamError",void 0),hE(this,"onInjectStatusChange",void 0),hE(this,"spec",void 0),hE(this,"retryTimeout",1e4),hE(this,"connection",void 0),hE(this,"httpRetryConfig",void 0),hE(this,"wsRetryConfig",void 0),hE(this,"streamingTasks",new Map),hE(this,"isStartingStreamingTask",!1),hE(this,"taskMutex",new mS("live-streaming")),hE(this,"cancelToken",tT.CancelToken.source()),hE(this,"transcodingConfig",void 0),hE(this,"injectConfig",iT({},ile)),hE(this,"injectLoopTimes",0),hE(this,"uapResponse",void 0),hE(this,"lastTaskId",1),hE(this,"statusError",new Map),this.spec=_e,this.httpRetryConfig=Wt,this.wsRetryConfig=_t}async setTranscodingConfig(_e){const _t=iT(iT({},rle),_e);_t.videoCodecProfile!==66&&_t.videoCodecProfile!==77&&_t.videoCodecProfile!==100&&(iE.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(_t.videoCodecProfile," -> 100")),_t.videoCodecProfile=100),_t.transcodingUsers||(_t.transcodingUsers=_t.userConfigs),_t.transcodingUsers&&(_t.transcodingUsers=_t.transcodingUsers.map(_s=>iT(iT(iT({},nle),_s),{},{zOrder:_s.zOrder?_s.zOrder+1:1}))),function(_s){U0(_s.width)||u0(_s.width,"config.width",0,1e4),U0(_s.height)||u0(_s.height,"config.height",0,1e4),U0(_s.videoBitrate)||u0(_s.videoBitrate,"config.videoBitrate",1,1e6),U0(_s.videoFrameRate)||u0(_s.videoFrameRate,"config.videoFrameRate"),U0(_s.lowLatency)||E1(_s.lowLatency,"config.lowLatency"),U0(_s.audioSampleRate)||aS(_s.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),U0(_s.audioBitrate)||u0(_s.audioBitrate,"config.audioBitrate",1,128),U0(_s.audioChannels)||aS(_s.audioChannels,"config.audioChannels",[1,2,3,4,5]),U0(_s.videoGop)||u0(_s.videoGop,"config.videoGop"),U0(_s.videoCodecProfile)||aS(_s.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),U0(_s.userCount)||u0(_s.userCount,"config.userCount",0,17),U0(_s.backgroundColor)||u0(_s.backgroundColor,"config.backgroundColor",0,16777215),U0(_s.userConfigExtraInfo)||bS(_s.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),_s.transcodingUsers&&!U0(_s.transcodingUsers)&&(v1(_s.transcodingUsers,"config.transcodingUsers"),_s.transcodingUsers.forEach((_c,_u)=>{PL(_c.uid),U0(_c.x)||u0(_c.x,"transcodingUser[".concat(_u,"].x"),0,1e4),U0(_c.y)||u0(_c.y,"transcodingUser[".concat(_u,"].y"),0,1e4),U0(_c.width)||u0(_c.width,"transcodingUser[".concat(_u,"].width"),0,1e4),U0(_c.height)||u0(_c.height,"transcodingUser[".concat(_u,"].height"),0,1e4),U0(_c.zOrder)||u0(_c.zOrder-1,"transcodingUser[".concat(_u,"].zOrder"),0,100),U0(_c.alpha)||u0(_c.alpha,"transcodingUser[".concat(_u,"].alpha"),0,1,!1)})),U0(_s.watermark)||UV(_s.watermark,"watermark"),U0(_s.backgroundImage)||UV(_s.backgroundImage,"backgroundImage"),_s.images&&!U0(_s.images)&&(v1(_s.images,"config.images"),_s.images.forEach((_c,_u)=>{UV(_c,"images[".concat(_u,"]"))}))}(_t);const Wt=[];_t.images&&Wt.push(..._t.images.map(_s=>iT(iT(iT({},MV),_s),{},{zOrder:255}))),_t.backgroundImage&&(Wt.push(iT(iT(iT({},MV),_t.backgroundImage),{},{zOrder:0})),delete _t.backgroundImage),_t.watermark&&(Wt.push(iT(iT(iT({},MV),_t.watermark),{},{zOrder:255})),delete _t.watermark),_t.images=Wt,_t.transcodingUsers&&(_t.userConfigs=_t.transcodingUsers.map(_s=>iT({},_s)),_t.userCount=_t.transcodingUsers.length,delete _t.transcodingUsers);const _n=(_t.userConfigs||[]).map(_s=>typeof _s.uid=="number"?n_.resolve(_s.uid):DW(_s.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await n_.all(_n)).forEach((_s,_c)=>{_t.userConfigs&&_t.userConfigs[_c]&&(_t.userConfigs[_c].uid=_s)}),this.transcodingConfig=_t,this.connection)try{var _i;const _s=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(AR(_i=this.streamingTasks).call(_i)).map(_c=>_c.taskId).join("#")});iE.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(_s.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(_s){if(!_s.data||!_s.data.retry)throw _s;_s.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(_c=>{iE.warning("[".concat(this.spec.clientId,"] live streaming receive error"),_s.toString(),"try to republish",_c.url),this.startLiveStreamingTask(_c.url,_c.mode,_s).then(()=>{iE.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(_c.url," success"))}).catch(_u=>{iE.error("[".concat(this.spec.clientId,"] live streaming republish failed"),_c.url,_u.toString()),this.onLiveStreamError&&this.onLiveStreamError(_c.url,_u)})})}}setInjectStreamConfig(_e,_t){this.injectConfig=Object.assign({},this.injectConfig,_e),this.injectLoopTimes=_t}async startLiveStreamingTask(_e,_t,Wt){var _n;if(Array.from(AR(_n=this.streamingTasks).call(_n)).find(_h=>_h.mode===ES.INJECT)&&_t===ES.INJECT)return new DE(mE.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&_t===ES.TRANSCODE)throw new DE(mE.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let _s={command:"PublishStream",ts:Date.now(),url:_e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};iE.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(_e,", mode: ").concat(_t));const _c=await this.taskMutex.lock();if(!this.connection&&Wt)return void _c();if(this.streamingTasks.get(_e)&&!Wt)return _c(),new DE(mE.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(_t))}catch(_h){throw _c(),_h}switch(_t){case ES.TRANSCODE:_s.transcodingConfig=iT({},this.transcodingConfig);break;case ES.RAW:break;case ES.INJECT:_s={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:_e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(_s.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const _u=this.lastTaskId++;try{const _h=new n_((Qm,_g)=>{hS(this.retryTimeout).then(()=>{if(Wt)return _g(Wt);const eE=this.statusError.get(_e);return eE?(this.statusError.delete(_e),_g(eE)):void 0})}),_p=await n_.race([this.connection.request("request",{clientRequest:_s},!0,{url:_e,command:"PublishStream",workerType:_t===ES.TRANSCODE?1:2,requestByUser:!Wt,tid:_u.toString()}),_h]);this.isStartingStreamingTask=!1,iE.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_p.code)),this.streamingTasks.set(_e,{clientRequest:_s,mode:_t,url:_e,taskId:_u}),_c()}catch(_h){if(_c(),this.isStartingStreamingTask=!1,!_h.data||!_h.data.retry||Wt)throw _h;return _h.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(_e,_t,_h)):await this.startLiveStreamingTask(_e,_t,_h)}}stopLiveStreamingTask(_e){return new n_((_t,Wt)=>{const _n=this.streamingTasks.get(_e);if(!_n||!this.connection)return new DE(mE.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const _i=_n.mode;_n.abortTask=()=>{iE.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(_e),_t()},this.connection.request("request",{clientRequest:{command:_i===ES.INJECT?"UninjectStream":"UnpublishStream",url:_n.url}},!1,{url:_e,command:"UnPublishStream",workerType:_i===ES.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(_s=>{iE.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(_s.code)),this.streamingTasks.delete(_e),this.streamingTasks.size===0&&_i!==ES.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),_t(),_i===ES.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,_e)}).catch(Wt)})}async controlInjectStream(_e,_t,Wt,_n){const _i=this.streamingTasks.get(_e);if(!_i||!this.connection||_i.mode!==ES.INJECT)throw new DE(mE.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:_e,control:_t,audioVolume:Wt,position:_n}})).serverResponse}resetAllTask(){var _e;const _t=Array.from(AR(_e=this.streamingTasks).call(_e));this.terminate();for(const Wt of _t)this.startLiveStreamingTask(Wt.url,Wt.mode).catch(_n=>{this.onLiveStreamError&&this.onLiveStreamError(Wt.url,_n)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=tT.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(_e){if(this.connection)throw new DE(mE.UNEXPECTED_ERROR,"live streaming connection has already connected");const _t=await _y(this,kL.REQUEST_WORKER_MANAGER_LIST,_e);return this.uapResponse=_t,this.connection=new She(_t.workerToken,this.spec,this.wsRetryConfig,_e),this.connection.on(ZR.WARNING,(Wt,_n)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(_n,Wt)),this.connection.on(ZR.PUBLISH_STREAM_STATUS,Wt=>this.handlePublishStreamServer(Wt)),this.connection.on(ZR.INJECT_STREAM_STATUS,Wt=>this.handleInjectStreamServerStatus(Wt)),this.connection.on(ZR.REQUEST_NEW_ADDRESS,(Wt,_n)=>{if(!this.connection)return _n(new DE(mE.UNEXPECTED_ERROR,"can not get new live streaming address list"));_y(this,kL.REQUEST_WORKER_MANAGER_LIST,_e).then(_i=>{this.uapResponse=_i,Wt(_i.addressList)}).catch(_n)}),await this.connection.init(_t.addressList),this.connection}handlePublishStreamServer(_e){const _t=_e.serverStatus&&_e.serverStatus.url||"empty_url",Wt=this.streamingTasks.get(_t),_n=_e.reason;switch(_e.code){case rS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case rS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const _s=new DE(mE.LIVE_STREAMING_CDN_ERROR,"",{code:_e.code});if(Wt)return iE.error(_s.toString()),this.onLiveStreamError&&this.onLiveStreamError(_t,_s);if(!this.isStartingStreamingTask)return;this.statusError.set(_t,_s)}case rS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const _s=new DE(mE.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,_n);return this.onLiveStreamWarning&&this.onLiveStreamWarning(_t,_s)}case rS.LIVE_STREAM_RESPONSE_WORKER_LOST:case rS.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var _i;if(!this.connection)return;this.connection.tryNextAddress();const _s=Array.from(AR(_i=this.streamingTasks).call(_i));for(const _c of _s)_c.abortTask?_c.abortTask():(iE.warning("[".concat(this.spec.clientId,"] publish stream status code"),_e.code,"try to republish",_c.url),this.startLiveStreamingTask(_c.url,_c.mode,new DE(mE.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:_e.code})).then(()=>{iE.debug("[".concat(this.spec.clientId,"] republish live stream success"),_c.url)}).catch(_u=>{iE.error(_u.toString()),this.onLiveStreamError&&this.onLiveStreamError(_c.url,_u)}));return}}}handleInjectStreamServerStatus(_e){const _t=Number(_e.uid),Wt=_e.serverStatus&&_e.serverStatus.url;switch(_e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_START_SUCCESS,_t,Wt));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,_t,Wt),void this.streamingTasks.delete(Wt);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_START_UNAUTHORIZED,_t,Wt),void this.streamingTasks.delete(Wt);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_BROKEN,_t,Wt),void this.streamingTasks.delete(Wt);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(kO.INJECT_STREAM_STATUS_START_TIMEOUT,_t,Wt),void this.streamingTasks.delete(Wt);default:return void iE.debug("inject stream server status",_e)}}hasUrl(_e){return this.streamingTasks.has(_e)}}class $9{constructor(){hE(this,"destChannelMediaInfos",new Map),hE(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(_e){aW(_e),this.srcChannelMediaInfo=_e}addDestChannelInfo(_e){aW(_e),this.destChannelMediaInfos.set(_e.channelName,_e)}removeDestChannelInfo(_e){NL(_e),this.destChannelMediaInfos.delete(_e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function Y9($){if(!($ instanceof $9))return new DE(mE.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const _e=$.getSrcChannelMediaInfo(),_t=$.getDestChannelMediaInfo();if(!_e)return new DE(mE.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(_t.size===0)return new DE(mE.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class whe extends A0{constructor(_e,_t,Wt){super(),hE(this,"ws",void 0),hE(this,"requestId",1),hE(this,"heartBeatTimer",void 0),hE(this,"joinInfo",void 0),hE(this,"clientId",void 0),hE(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),hE(this,"onClose",_n=>{this.emit("close"),this.dispose()}),hE(this,"onMessage",_n=>{const _i=JSON.parse(_n.data);if(!_i||_i.command!=="serverResponse"||!_i.requestId)return _i&&_i.command==="serverStatus"&&_i.serverStatus&&_i.serverStatus.command?(this.emit("status",_i.serverStatus),void this.emit(_i.serverStatus.command,_i.serverStatus)):void 0;this.emit("req_".concat(_i.requestId),_i)}),this.joinInfo=_e,this.clientId=_t,this.ws=new oP("cross-channel-".concat(this.clientId),Wt),this.ws.on(T_.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(T_.CONNECTED,this.onOpen),this.ws.on(T_.ON_MESSAGE,this.onMessage),this.ws.on(T_.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(_e){const _t=this.requestId++;return _e.requestId=_t,_e.seq=_t,this.ws.sendMessage(_e),_t}waitStatus(_e){return new n_((_t,Wt)=>{const _n=window.setTimeout(()=>{Wt(new DE(mE.TIMEOUT,"wait status timeout, status: ".concat(_e)))},5e3);this.once(_e,_i=>{window.clearTimeout(_n),_i.state&&_i.state!==0?Wt(new DE(mE.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(_e))):_t(void 0)}),this.once("dispose",()=>{window.clearTimeout(_n),Wt(new DE(mE.WS_ABORT))})})}async request(_e){if(this.ws.state==="closed")throw new DE(mE.WS_DISCONNECT);const _t=()=>new n_((_s,_c)=>{this.ws.once(T_.CLOSED,()=>_c(new DE(mE.WS_ABORT))),this.ws.once(T_.CONNECTED,_s)});this.ws.state!=="connected"&&await _t();const Wt=this.sendMessage(_e),_n=new n_((_s,_c)=>{const _u=()=>{_c(new DE(mE.WS_ABORT))};this.ws.once(T_.RECONNECTING,_u),this.ws.once(T_.CLOSED,_u),this.once("req_".concat(Wt),_s),hS(3e3).then(()=>{this.removeAllListeners("req_".concat(Wt)),this.ws.off(T_.RECONNECTING,_u),this.ws.off(T_.CLOSED,_u),_c(new DE(mE.TIMEOUT,"cross channel ws request timeout"))})}),_i=await _n;if(!_i||_i.code!==200)throw new DE(mE.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(_i)));return _i}async connect(_e){this.ws.removeAllListeners(T_.REQUEST_NEW_URLS),this.ws.on(T_.REQUEST_NEW_URLS,_t=>{_t(_e)}),await this.ws.init(_e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(_e){const _t=this.requestId++;return _e.requestId=_t,this.ws.sendMessage(_e),_t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Rhe extends A0{set state(_e){_e!==this._state&&(_e!==aT.RELAY_STATE_FAILURE&&(this.errorCode=DO.RELAY_OK),this.emit("state",_e,this.errorCode),this._state=_e)}get state(){return this._state}constructor(_e,_t,Wt,_n,_i){super(),hE(this,"joinInfo",void 0),hE(this,"sid",void 0),hE(this,"clientId",void 0),hE(this,"cancelToken",tT.CancelToken.source()),hE(this,"workerToken",void 0),hE(this,"requestId",0),hE(this,"signal",void 0),hE(this,"prevChannelMediaConfig",void 0),hE(this,"httpRetryConfig",void 0),hE(this,"_resolution",void 0),hE(this,"_state",aT.RELAY_STATE_IDLE),hE(this,"errorCode",DO.RELAY_OK),hE(this,"onStatus",_s=>{iE.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(_s))),_s&&_s.command&&(_s.command==="onAudioPacketReceived"&&this.emit("event",_1.PACKET_RECEIVED_AUDIO_FROM_SRC),_s.command==="onVideoPacketReceived"&&this.emit("event",_1.PACKET_RECEIVED_VIDEO_FROM_SRC),_s.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=DO.SRC_TOKEN_EXPIRED,this.state=aT.RELAY_STATE_FAILURE),_s.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=DO.DEST_TOKEN_EXPIRED,this.state=aT.RELAY_STATE_FAILURE))}),hE(this,"onReconnect",async()=>{iE.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",_1.NETWORK_DISCONNECTED),this.state=aT.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(_s=>{this.state!==aT.RELAY_STATE_IDLE&&(iE.error("auto restart channel media relay failed",_s.toString()),this.errorCode=DO.SERVER_CONNECTION_LOST,this.state=aT.RELAY_STATE_FAILURE)})}),this.joinInfo=_e,this.clientId=_t,this.sid=eP(),this.signal=new whe(this.joinInfo,this.clientId,Wt),this.httpRetryConfig=_n,this._resolution=_i}async startChannelMediaRelay(_e){if(this.state!==aT.RELAY_STATE_IDLE)throw new DE(mE.INVALID_OPERATION);this.state=aT.RELAY_STATE_CONNECTING,await this.connect(),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(_e)}catch(_t){throw _t.data&&_t.data.serverResponse&&_t.data.serverResponse.command==="SetSourceChannel"?new DE(mE.CROSS_CHANNEL_FAILED_JOIN_SRC):_t.data&&_t.data.serverResponse&&_t.serverResponse.command==="SetDestChannelStatus"?new DE(mE.CROSS_CHANNEL_FAILED_JOIN_DEST):_t.data&&_t.data.serverResponse&&_t.serverResponse.command==="StartPacketTransfer"?new DE(mE.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):_t}this.prevChannelMediaConfig=_e}async updateChannelMediaRelay(_e){if(this.state!==aT.RELAY_STATE_RUNNING)throw new DE(mE.INVALID_OPERATION);await this.sendUpdateMessage(_e),this.prevChannelMediaConfig=_e}async setVideoProfile(_e){if(this._resolution=_e,this.state!==aT.RELAY_STATE_RUNNING)throw new DE(mE.INVALID_OPERATION);const _t=this.genMessage(JS.SetVideoProfile);await this.signal.request(_t),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),iE.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=aT.RELAY_STATE_IDLE,this.dispose()}dispose(){iE.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=tT.CancelToken.source(),this.state=aT.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const _e=await wle(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=_e.workerToken,await this.signal.connect(_e.addressList),this.emit("event",_1.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(_e){const _t=this.genMessage(JS.StopPacketTransfer);await this.signal.request(_t),await this.signal.waitStatus("Normal Quit"),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const Wt=this.genMessage(JS.SetSdkProfile,_e);await this.signal.request(Wt),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const _n=this.genMessage(JS.SetSourceChannel,_e);await this.signal.request(_n),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",_1.PACKET_JOINED_SRC_CHANNEL),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const _i=this.genMessage(JS.SetSourceUserId,_e);await this.signal.request(_i),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const _s=this.genMessage(JS.SetDestChannel,_e);await this.signal.request(_s),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",_1.PACKET_JOINED_DEST_CHANNEL),iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const _c=this.genMessage(JS.StartPacketTransfer,_e);await this.signal.request(_c),this.emit("event",_1.PACKET_SENT_TO_DEST_CHANNEL),this.state=aT.RELAY_STATE_RUNNING,iE.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(_e){const _t=this.genMessage(JS.UpdateDestChannel,_e);await this.signal.request(_t),this.emit("event",_1.PACKET_UPDATE_DEST_CHANNEL),iE.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const _e=this.genMessage(JS.StopPacketTransfer);await this.signal.request(_e),iE.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(_e,_t){const Wt=[],_n=[],_i=[];this.requestId+=1;const _s={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:jT,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};_s.sdkVersion==="4.21.0"&&(_s.sdkVersion="0.0.1");let _c=null,_u=null;switch(_e){case JS.SetSdkProfile:return _s.clientRequest={command:"SetSdkProfile",type:"multi_channel"},_s;case JS.SetSourceChannel:if(_u=_t&&_t.getSrcChannelMediaInfo(),!_u)throw new DE(mE.UNEXPECTED_ERROR,"can not find source config");return _s.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_u.channelName,token:_u.token||this.joinInfo.appId},_s;case JS.SetSourceUserId:if(_u=_t&&_t.getSrcChannelMediaInfo(),!_u)throw new DE(mE.UNEXPECTED_ERROR,"can not find source config");return _s.clientRequest={command:"SetSourceUserId",uid:_u.uid+""},_s;case JS.SetDestChannel:if(_c=_t&&_t.getDestChannelMediaInfo(),!_c)throw new DE(mE.UNEXPECTED_ERROR,"can not find dest config");return _c.forEach(_h=>{Wt.push(_h.channelName),_n.push(_h.uid+""),_i.push(_h.token||this.joinInfo.appId)}),_s.clientRequest={command:"SetDestChannel",channelName:Wt,uid:_n,token:_i},_s;case JS.StartPacketTransfer:return _s.clientRequest={command:"StartPacketTransfer"},_s;case JS.Reconnect:return _s.clientRequest={command:"Reconnect"},_s;case JS.StopPacketTransfer:return _s.clientRequest={command:"StopPacketTransfer"},_s;case JS.UpdateDestChannel:if(_c=_t&&_t.getDestChannelMediaInfo(),!_c)throw new DE(mE.UNEXPECTED_ERROR,"can not find dest config");return _c.forEach(_h=>{Wt.push(_h.channelName),_n.push(_h.uid+""),_i.push(_h.token||this.joinInfo.appId)}),_s.clientRequest={command:"UpdateDestChannel",channelName:Wt,uid:_n,token:_i},_s;case JS.SetVideoProfile:_s.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return _s}}function SM($){var _e={},_t=!1;function Wt(_n,_i){return _t=!0,{done:!1,value:new _B(_i=new e8(function(_s){_s($[_n](_i))}),1)}}return _e[yO!==void 0&&_G||"@@iterator"]=function(){return this},_e.next=function(_n){return _t?(_t=!1,_n):Wt("next",_n)},typeof $.throw=="function"&&(_e.throw=function(_n){if(_t)throw _t=!1,_n;return Wt("throw",_n)}),typeof $.return=="function"&&(_e.return=function(_n){return _t?(_t=!1,_n):Wt("return",_n)}),_e}var J9=zt(s9);function X9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function Z9($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?X9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):X9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}var g0;function Q9($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function eY($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?Q9(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):Q9(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let cN=(g0=class HP extends LL{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(_e=>_e.rtpMap&&_e.rtpMap.encodingName.toLowerCase()||"").filter(_e=>{var _t;return i_(_t=Object.keys(NO)).call(_t,_e)}))]}constructor(_e,_t){super(_e,_t),hE(this,"store",void 0),hE(this,"peerConnection",void 0),hE(this,"remoteSDP",void 0),hE(this,"initialOffer",void 0),hE(this,"statsFilter",void 0),hE(this,"useRTX",!1),hE(this,"localCapabilities",void 0),hE(this,"localCandidateCount",0),hE(this,"allCandidatesReceived",!1),hE(this,"establishPromise",void 0),hE(this,"mutex",new mS("P2PConnection-mutex")),this.store=_t,this.peerConnection=new RTCPeerConnection(HP.resolvePCConfiguration(_e),{optional:[{googDscp:!0}]}),this.statsFilter=gM(this.peerConnection,yE("STATS_UPDATE_INTERVAL"),void 0,h0()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const _e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!_e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const _t=LR(_e.sdp),Wt=MP(_e.sdp,{filterRTX:!this.useRTX,filterVideoFec:yE("FILTER_VIDEO_FEC"),filterAudioFec:yE("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=Wt,this.initialOffer=_e,eY(eY({},_t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:Wt},offerSDP:_e.sdp})}catch(_e){throw new HE(mE.GET_LOCAL_CONNECTION_PARAMS_FAILED,_e.toString())}}async connect(_e,_t,Wt,_n,_i,_s){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(_u){hE(this,"sessionDesc",void 0),hE(this,"localCapabilities",void 0),hE(this,"rtpCapabilities",void 0),hE(this,"candidates",void 0),hE(this,"iceParameters",void 0),hE(this,"dtlsParameters",void 0),hE(this,"setup",void 0),hE(this,"currentMidIndex",void 0),hE(this,"cname",void 0),_u=b0(_u);const{remoteIceParameters:_h,remoteDtlsParameters:_p,candidates:Qm,remoteRTPCapabilities:_g,remoteSetup:eE,localCapabilities:pE,sdkCodec:aE,cname:cE}=_u,fE=N0.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=_g,this.candidates=Qm,this.iceParameters=_h,this.dtlsParameters=_p,this.setup=eE,this.localCapabilities=pE,this.cname=cE;for(let gE=0;gE<fE.mediaDescriptions.length;gE++){const AE=fE.mediaDescriptions[gE];if(AE.attributes.iceUfrag=_h.iceUfrag,AE.attributes.icePwd=_h.icePwd,AE.attributes.fingerprints=_p.fingerprints,AE.attributes.candidates=Qm,AE.attributes.setup=eE,AE.media.mediaType==="video"){AE.media.fmts=_g.videoCodecs.map(xE=>xE.payloadType.toString(10));let PE=_g.videoCodecs.filter(xE=>{var GE,zE;return(GE=xE.rtpMap)===null||GE===void 0?void 0:i_(zE=GE.encodingName.toLowerCase()).call(zE,aE)});PE.length===0&&(PE=_g.videoCodecs),AE.attributes.payloads=PE,AE.attributes.extmaps=_g.videoExtensions}AE.media.mediaType==="audio"&&(AE.media.fmts=_g.audioCodecs.map(PE=>PE.payloadType.toString(10)),AE.attributes.payloads=_g.audioCodecs,AE.attributes.extmaps=_g.audioExtensions),fE.mediaDescriptions[gE]=this.mungMediaDesc(AE)}this.sessionDesc=fE,this.currentMidIndex=fE.mediaDescriptions.length-1}toString(){return N0.print(this.sessionDesc)}send(_u,_h,_p){const{ssrcs:Qm,ssrcGroups:_g}=DT(_h,this.cname),eE=this.sessionDesc.mediaDescriptions.find(cE=>_u===h_.VIDEO?cE.media.mediaType==="video":cE.media.mediaType==="audio"),pE=Qm[0].attributes.label,aE=Qm[0].attributes.mslabel;return eE.attributes.ssrcs=eE.attributes.ssrcs.concat(Qm),eE.attributes.ssrcGroups=eE.attributes.ssrcGroups.concat(_g),{id:pE,mslabel:aE}}batchSend(_u){return _u.map(_h=>{let{kind:_p,ssrcMsg:Qm}=_h;return this.send(_p,Qm,void 0)})}stopSending(_u){this.sessionDesc.mediaDescriptions.forEach(_h=>{const _p=[],Qm=[],_g=[];_h.attributes.ssrcs.forEach(eE=>{i_(_u).call(_u,eE.attributes.label||"")?_g.push(eE):_p.push(eE)}),_h.attributes.ssrcGroups.forEach(eE=>{var pE;i_(pE=_g.map(aE=>aE.ssrcId)).call(pE,eE.ssrcIds[0])||Qm.push(eE)}),_h.attributes.ssrcs=_p,_h.attributes.ssrcGroups=Qm})}mute(_u){const _h=this.sessionDesc.mediaDescriptions.find(_p=>_p.attributes.mid===_u);if(!_h)throw new Error("mediaDescription not found with ".concat(_u," in remote SDP when calling RemoteSDP.mute."));_h.attributes.direction="inactive"}unmute(_u){const _h=this.sessionDesc.mediaDescriptions.find(_p=>_p.attributes.mid===_u);if(!_h)throw new Error("mediaDescription not found with ".concat(_u," in remote SDP when calling RemoteSDP.unmute."));_h.attributes.direction="sendonly"}receive(_u,_h,_p){_u.forEach((Qm,_g)=>{const eE=Qm._mediaStreamTrack,pE=this.sessionDesc.mediaDescriptions.findIndex(cE=>cE.attributes.mid===eE.kind),aE=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[pE],Qm);this.sessionDesc.mediaDescriptions[pE]=aE})}stopReceiving(_u){}updateCandidates(_u){_u===BS.TCP?this.candidates.forEach(_h=>{this.candidates.findIndex(_p=>_p.transport==="tcp"&&_p.connectionAddress===_h.connectionAddress&&_p.port===_h.port)===-1&&this.candidates.push(Z9(Z9({},_h),{},{foundation:"tcpcandidate",priority:Number(_h.priority)-1+"",transport:"tcp",port:Number(_h.port)+90+""}))}):this.candidates=this.candidates.filter(_h=>_h.transport!=="tcp");for(const _h of this.sessionDesc.mediaDescriptions)_h.attributes.candidates=this.candidates}restartICE(_u){_u=b0(_u),this.iceParameters=_u,this.sessionDesc.mediaDescriptions.forEach(_h=>{_h.attributes.iceUfrag=_u.iceUfrag,_h.attributes.icePwd=_u.icePwd})}predictReceivingMids(_u){const _h=[];for(let _p=0;_p<_u;_p++)_h.push((this.currentMidIndex+_p+1).toString(10));return _h}mungRecvMediaDsec(_u,_h){const _p=b0(_u);return oI(_p,_h),vM(_p,_h),_p}updateRecvMedia(_u,_h){const _p=this.sessionDesc.mediaDescriptions.findIndex(Qm=>Qm.attributes.mid===_u);if(_p!==-1){const Qm=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[_p],_h);this.sessionDesc.mediaDescriptions[_p]=Qm}}bumpMid(_u){this.currentMidIndex+=_u}updateTrackLabel(_u,_h,_p){const Qm=this.sessionDesc.mediaDescriptions.find(eE=>_u===h_.VIDEO?eE.attributes.mid==="video":eE.attributes.mid==="audio");if(Qm){const eE=Qm.attributes.ssrcs.find(pE=>pE.attributes.label===_h);var _g;eE&&(eE.attributes.label=_p,(_g=eE.attributes.msid)===null||_g===void 0||_g.replace(_h,_p))}}mungMediaDesc(_u){const _h=b0(_u);return EM(_h),function(_p){const Qm=_p.attributes.extmaps.find(_g=>_g.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");Qm&&_p.attributes.extmaps.splice(_p.attributes.extmaps.indexOf(Qm),1),_p.attributes.payloads.forEach(_g=>{const eE=_g.rtcpFeedbacks.findIndex(pE=>pE.type==="transport-cc");eE!==-1&&_g.rtcpFeedbacks.splice(eE,1)})}(_h),_h}getSSRC(_u){for(const _h of this.sessionDesc.mediaDescriptions)for(const _p of _h.attributes.ssrcs)if(_p.attributes.label===_u)return[_p]}}({remoteIceParameters:_e,remoteDtlsParameters:_t,candidates:Wt,remoteRTPCapabilities:_n.send,remoteSetup:_i,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:_s});const _c=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_c})}catch(_c){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_c.toString()))}}async updateRemoteRTPCapabilities(_e,_t){throw new HE(mE.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(_e,_t){var Wt=this;return ET(function*(){const _n=yield k_(Wt.mutex.lock());try{if(!Wt.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _i=_e.map(_g=>Wt.peerConnection.addTrack(_g._mediaStreamTrack)),_s=yield k_(Wt.peerConnection.createOffer()),_c=N0.parse(_s.sdp),_u=_e.map(_g=>{const eE=_g._mediaStreamTrack,pE=_c.mediaDescriptions.find(aE=>aE.attributes.mid===eE.kind);if(!pE)throw new Error("Cannot extract ssrc from mediaDescription.");return function(aE,cE,fE){const gE=aE.attributes.ssrcs.filter(PE=>PE.attributes.label===cE),AE=aE.attributes.ssrcGroups;if(gE.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(AE&&gE.length>1){const PE=AE.find(xE=>xE.ssrcIds.indexOf(gE[0].ssrcId)!==-1);return PE?[{ssrcId:PE.ssrcIds[0],rtx:fE?PE.ssrcIds[1]:void 0}]:[{ssrcId:gE[0].ssrcId}]}return[{ssrcId:gE[0].ssrcId}]}(pE,eE.id,Wt.useRTX)});let _h;try{_h=yield _u}catch(_g){throw _i.forEach(eE=>{dS()&&eE.replaceTrack(null),Wt.peerConnection.removeTrack(eE)}),_g}const _p=Wt.mungSendOfferSDP(_s.sdp,_e);Wt.remoteSDP.receive(_e,_t,_h);const Qm=Wt.remoteSDP.toString();return yield k_(Wt.peerConnection.setLocalDescription({type:"offer",sdp:_p})),yield k_(Wt.applySendEncodings(_i,_e)),yield k_(Wt.peerConnection.setRemoteDescription({type:"answer",sdp:Qm})),_e.map((_g,eE)=>{const pE=_g._mediaStreamTrack.id;return{localSSRC:_u[eE],id:pE}})}catch(_i){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_i.toString()))}finally{_n()}})()}async stopSending(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const _t=this.peerConnection.getSenders().filter(_i=>{var _s;return _e.indexOf(((_s=_i.track)===null||_s===void 0?void 0:_s.id)||"")!==-1});if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");_t.map(_i=>{dS()&&_i.replaceTrack(null),this.peerConnection.removeTrack(_i)});const Wt=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.stopReceiving(_e);const _n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:_n})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(_t.toString()))}}async receive(_e,_t,Wt,_n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(_e," before remoteSDP created."));const{id:_i,mslabel:_s}=this.remoteSDP.send(_e,_t,_n),_c=new n_((_p,Qm)=>{const _g=setTimeout(()=>{Qm(new Error("Cannot receive track, id: ".concat(_i)))},1e4),eE=pE=>{const aE=W_();if((aE.name==="Safari"&&Number(aE.version)===11||PS())&&pE.track.id!==_i&&pE.streams[0].id===_s){var cE;const fE=pE.streams[0].getTracks()[0];return(cE=this.remoteSDP)===null||cE===void 0||cE.updateTrackLabel(_e,_i,pE.track.id),this.peerConnection.removeEventListener("track",eE),clearTimeout(_g),void _p(fE)}if(pE.track.id===_i)return this.peerConnection.removeEventListener("track",eE),clearTimeout(_g),void _p(pE.track)};this.peerConnection.addEventListener("track",eE)}),_u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_u});const _h=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_h),{track:await _c,id:_i}}catch(_i){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async stopReceiving(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(_e);const _t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const Wt=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(Wt)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(_t.toString()))}}async muteRemote(_e){}async unmuteRemote(_e){}async muteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const _t=this.peerConnection.getSenders().filter(Wt=>{var _n;return _e.indexOf(((_n=Wt.track)===null||_n===void 0?void 0:_n.id)||"")!==-1});if(_t.length!==_e.length)throw new Error("sender' length doesn't match mids' length.");_t.map(Wt=>{if(dS()&&Wt.track)Wt.track.enabled=!1;else{const _n=Wt.getParameters();_n.encodings.forEach(_i=>_i.active=!1),Wt.setParameters(_n)}})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(_t.toString()))}}async unmuteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const _t=this.peerConnection.getSenders().filter(_i=>{var _s;return _e.indexOf(((_s=_i.track)===null||_s===void 0?void 0:_s.id)||"")!==-1});if(_t.length!==_e.length)throw new Error("Senders' length doesn't match mids' length.");_t.map(async _i=>{if(dS()&&_i.track)_i.track.enabled=!0;else{const _s=_i.getParameters();_s.encodings.forEach(_c=>_c.active=!0),await _i.setParameters(_s)}});const Wt=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(Wt);const _n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:_n})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(_t.toString()))}}restartICE(_e){var _t=this;return ET(function*(){const Wt=yield k_(_t.mutex.lock("From P2PConnection.restartICE"));try{if(!_t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(B_().supportPCSetConfiguration){const _u=_t.peerConnection.getConfiguration(),_h=_e===BS.RELAY?"relay":"all";_u.iceTransportPolicy!==_h&&(iE.debug("[".concat(_t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(_u.iceTransportPolicy,"] to [").concat(_h,"]")),_u.iceTransportPolicy=_h,_t.peerConnection.setConfiguration(_u))}else if(_e===BS.RELAY)return;_e!==BS.RELAY&&_t.remoteSDP.updateCandidates(_e);const _n=yield k_(_t.peerConnection.createOffer({iceRestart:!0}));if(!_n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=LR(_n.sdp),{remoteIceParameters:_s}=yield _i.iceParameters;_t.remoteSDP.restartICE(_s);const _c=_t.remoteSDP.toString();yield k_(_t.peerConnection.setLocalDescription(_n)),yield k_(_t.peerConnection.setRemoteDescription({type:"answer",sdp:_c}))}catch(_n){iE.warning("[".concat(_t.store.clientId,"] restart ICE failed, abort operation"),_n)}finally{Wt()}})()}close(){var _e;this.peerConnection.close(),(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(_e){return this.statsFilter.getVideoIsReady(_e)}async updateEncoderConfig(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const Wt=await this.peerConnection.createOffer(),_n=this.mungSendOfferSDP(Wt.sdp,[_t]);this.remoteSDP.updateRecvMedia(_t._mediaStreamTrack.kind,_t);const _i=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:_n}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(Wt){throw new HE(mE.EXCHANGE_SDP_FAILED,Wt.toString())}}async updateSendParameters(_e,_t){const Wt=this.peerConnection.getSenders().filter(_n=>{var _i;return((_i=_n.track)===null||_i===void 0?void 0:_i.id)===_e});Wt.length===1&&await this.applySendEncodings(Wt,[_t])}setStatsRemoteVideoIsReady(_e,_t){this.statsFilter.setVideoIsReady2(_e,_t)}async replaceTrack(_e,_t){const Wt=this.peerConnection.getSenders().find(_n=>{var _i;return((_i=_n.track)===null||_i===void 0?void 0:_i.id)===_t});Wt&&await Wt.replaceTrack(_e._mediaStreamTrack)}createDataChannels(_e,_t){throw new HE(mE.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(_e){throw new HE(mE.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var _e;(_e=this.onICEConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var _e;(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=_e=>{_e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,iE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,iE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},yE("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(_e){const _t={iceServers:[],sdpSemantics:"plan-b"};return _e.iceServers?_t.iceServers=_e.iceServers:_e.turnServer&&_e.turnServer.mode!=="off"&&(IO(_e.turnServer.servers)?_t.iceServers=_e.turnServer.servers:(_t.iceServers&&_t.iceServers.push(...HP.turnServerConfigToIceServers(_e.turnServer.servers)),yE("USE_TURN_SERVER_OF_GATEWAY")&&_t.iceServers&&_e.turnServer.serversFromGateway&&_t.iceServers.push(...HP.turnServerConfigToIceServers(_e.turnServer.serversFromGateway)),_e.turnServer.servers.concat(_e.turnServer.serversFromGateway||[]).forEach(Wt=>{Wt.forceturn&&(_t.iceTransportPolicy="relay")}))),_t}static turnServerConfigToIceServers(_e){const _t=[];return _e.forEach(Wt=>{Wt.security?Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turns:".concat(Wt.turnServerURL,":").concat(Wt.tcpport,"?transport=tcp")}):(Wt.udpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.udpport,"?transport=udp")}),Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.tcpport,"?transport=tcp")}))}),_t}async updateRtpSenderEncodings(_e,_t){var Wt;if(_t||(_t=this.peerConnection.getSenders().find(_h=>{var _p;return((_p=_h.track)===null||_p===void 0?void 0:_p.id)===_e._mediaStreamTrack.id})),!_t)return iE.warn("[".concat(_e.getTrackId(),"] no rtpSender found}"));if(!B_().supportSetRtpSenderParameters)return iE.warn("Browser not support set rtp-sender parameters");const _n={},_i={};if(_e instanceof m0)switch(_e._optimizationMode){case"motion":_n.degradationPreference="maintain-framerate";break;case"detail":_n.degradationPreference="maintain-resolution";break;default:_n.degradationPreference="balanced"}if(yE("DSCP_TYPE")&&W1()){var _s;const _h=yE("DSCP_TYPE");i_(_s=["very-low","low","medium","high"]).call(_s,_h)&&(_i.networkPriority=_h)}const _c=_t.getParameters(),_u=(Wt=_c.encodings)===null||Wt===void 0?void 0:Wt[0];_u&&Object.assign(_u,_i),Object.assign(_c,_n),iE.debug("[".concat(_e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_c.encodings))),await _t.setParameters(_c)}async applySendEncodings(_e,_t){try{if(!B_().supportSetRtpSenderParameters||_e.length!==_t.length)return;for(let Wt=0;Wt<_e.length;Wt++){const _n=_e[Wt],_i=_t[Wt];_n&&_i&&await this.updateRtpSenderEncodings(_i,_n)}}catch{iE.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(_e,_t){const Wt=N0.parse(_e);return _t.forEach((_n,_i)=>{const _s=_n._mediaStreamTrack,_c=Wt.mediaDescriptions.find(_u=>_u.attributes.mid===_s.kind);_c&&oI(_c,_n)}),N0.print(Wt)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=_e=>{var _t;(_t=this.onFirstAudioReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoReceived=_e=>{var _t;(_t=this.onFirstVideoReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstAudioDecoded=_e=>{var _t;(_t=this.onFirstAudioDecoded)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoDecoded=(_e,_t,Wt)=>{var _n;(_n=this.onFirstVideoDecoded)===null||_n===void 0||_n.call(this,_e,_t,Wt)},this.statsFilter.onSelectedLocalCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedLocalCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onSelectedRemoteCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedRemoteCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const _t=this.remoteSDP.batchSend(_e).map((_i,_s)=>{let{id:_c,mslabel:_u}=_i;const{kind:_h}=_e[_s];return new n_((_p,Qm)=>{const _g=setTimeout(()=>{Qm(new Error("Cannot receive track, id: ".concat(_c)))},1e4),eE=pE=>{const aE=W_();if(aE.name==="Safari"&&Number(aE.version)===11&&pE.track.id!==_c&&pE.streams[0].id===_u){var cE;const fE=pE.streams[0].getTracks()[0];return(cE=this.remoteSDP)===null||cE===void 0||cE.updateTrackLabel(_h,_c,pE.track.id),this.peerConnection.removeEventListener("track",eE),clearTimeout(_g),void _p({track:fE,id:_c})}if(pE.track.id===_c)return this.peerConnection.removeEventListener("track",eE),clearTimeout(_g),void _p({track:pE.track,id:_c})};this.peerConnection.addEventListener("track",eE)})}),Wt=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:Wt});const _n=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_n),await n_.all(_t)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_t.toString()))}}async getRemoteSSRC(_e){if(!this.remoteSDP)return;const _t=this.remoteSDP.getSSRC(_e);return _t==null?void 0:_t[0].ssrcId}setConfiguration(_e){if(B_().supportPCSetConfiguration){const _t=HP.resolvePCConfiguration(_e);this.peerConnection.setConfiguration(_t)}}},t_(g0.prototype,"connect",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"connect"),g0.prototype),t_(g0.prototype,"stopSending",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"stopSending"),g0.prototype),t_(g0.prototype,"receive",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"receive"),g0.prototype),t_(g0.prototype,"stopReceiving",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"stopReceiving"),g0.prototype),t_(g0.prototype,"muteRemote",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"muteRemote"),g0.prototype),t_(g0.prototype,"unmuteRemote",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"unmuteRemote"),g0.prototype),t_(g0.prototype,"muteLocal",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"muteLocal"),g0.prototype),t_(g0.prototype,"unmuteLocal",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"unmuteLocal"),g0.prototype),t_(g0.prototype,"close",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"close"),g0.prototype),t_(g0.prototype,"updateEncoderConfig",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"updateEncoderConfig"),g0.prototype),t_(g0.prototype,"updateSendParameters",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"updateSendParameters"),g0.prototype),t_(g0.prototype,"replaceTrack",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"replaceTrack"),g0.prototype),t_(g0.prototype,"getRemoteSSRC",[zT],Object.getOwnPropertyDescriptor(g0.prototype,"getRemoteSSRC"),g0.prototype),g0);function zT($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("Locking from P2PConnection.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}function tY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function lI($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?tY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):tY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const FP="9",nY=4e4;function rY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function O1($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?rY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):rY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let TM=function($){return $.BANDWIDTH="bandwidth",$.CPU="cpu",$.NONE="none",$.OTHER="other",$}({});var lN=function($){return $[$.DOWN=0]="DOWN",$[$.UP=1]="UP",$}(lN||{});const wM=new Map;function iY($,_e,_t,Wt){let{scale:_n}=$;if(_n===0&&Wt===lN.UP||_n>=_e.length-1&&Wt===lN.DOWN)return $;let _i=O1(O1({},$),{},{scale:Wt===lN.DOWN?++_n:--_n});switch(_t){case"maintain-framerate":_i=O1(O1({},_i),_e[_n].motion);break;case"maintain-resolution":_i=O1(O1({},_i),_e[_n].detail);break;case"balanced":_i=O1(O1({},_i),_e[_n].balanced)}return _i}function oY($,_e){if(_e){const _t={overUse:0,underUse:0,adaptationList:sY(_e)};wM.set($,_t)}else wM.delete($)}function sY($){const _e=O1({},$),{bitrateMax:_t,frameRate:Wt,scaleResolutionDownBy:_n,bitrateMin:_i}=_e,{MIN_FRAME_RATE:_s,MAX_THRESHOLD_FRAMERATE:_c,MAX_SCALE:_u,BITRATE_MIN_THRESHOLD:_h,BITRATE_MAX_THRESHOLD:_p,BWE_SCALE_UP_THRESHOLD:Qm,BWE_SCALE_DOWN_THRESHOLD:_g,PERF_SCALE_DOWN_THRESHOLD:eE,PERF_SCALE_UP_THRESHOLD:pE,BALANCE_BITRATE_FACTOR:aE,BALANCE_FRAMERATE_FACTOR:cE,BALANCE_RESOLUTION_FACTOR:fE,MOTION_RESOLUTION_FACTOR:gE,MOTION_BITRATE_FACTOR:AE,DETAIL_FRAMERATE_FACTOR:PE,DETAIL_BITRATE_FACTOR:xE}=IV,GE=Math.min(_e.frameRate,_c),zE=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(_g,1)*_t),bwe_up:_t,fps_down:Math.round(Math.pow(eE,1)*GE),fps_up:Wt},balanced:{scaleResolutionDownBy:1,frameRate:Wt,bitrateMax:_t,bitrateMin:_i},motion:{scaleResolutionDownBy:1,frameRate:Wt,bitrateMax:_t,bitrateMin:_i},detail:{scaleResolutionDownBy:1,frameRate:Wt,bitrateMax:_t,bitrateMin:_i}}];for(let KE=1;KE<=_u;KE++){const JE={bwe_up:Math.round(Math.pow(Qm,KE)*_t),bwe_down:Math.round(Math.pow(_g,KE+1)*_t),fps_up:Math.round(Math.pow(pE,KE)*GE),fps_down:Math.round(Math.pow(eE,KE+1)*GE)},c_={scaleResolutionDownBy:_n/Math.pow(fE,KE),frameRate:Math.max(Math.round(Math.pow(cE,KE)*Wt),_s),bitrateMax:Math.max(Math.round(Math.pow(aE,KE)*_t),_p),bitrateMin:Math.max(Math.round(Math.pow(aE,KE)*_i),_h)},V_={scaleResolutionDownBy:_n/Math.pow(gE,KE),frameRate:Wt,bitrateMax:Math.max(Math.round(Math.pow(AE,KE)*_t),_p),bitrateMin:Math.max(Math.round(Math.pow(AE,KE)*_i),_h)},Q_={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(PE,KE)*Wt),_s),bitrateMax:Math.max(Math.round(Math.pow(xE,KE)*_t),_p),bitrateMin:Math.max(Math.round(Math.pow(xE,KE)*_i),_h)};zE.push({scale:KE,threshold:JE,balanced:c_,motion:V_,detail:Q_})}return zE}function Che($,_e,_t,Wt,_n,_i){const _s=wM.get($)||{overUse:0,underUse:0,adaptationList:sY(_n)},{adaptationList:_c}=_s;wM.set($,_s);const{OVERUSE_TIMES_THRESHOLD:_u,UNDERUSE_TIMES_THRESHOLD:_h}=IV,{scale:_p}=Wt;let Qm,_g;return typeof _e=="number"&&_e>0&&function(eE,pE,aE,cE){if(pE>=aE.length)return!1;let{threshold:{fps_down:fE}}=aE[pE];return yE("FORCE_AG_HIGH_FRAMERATE")&&cE==="maintain-framerate"&&(fE=aE[0].threshold.fps_down),eE<fE}(_e,_p,_c,_i)&&(_s.overUse++,_g=TM.CPU,_s.overUse>_u)||typeof _t=="number"&&_t>0&&function(eE,pE,aE){if(pE>=aE.length)return!1;const{threshold:{bwe_down:cE}}=aE[pE];return eE<cE}(_t,_p,_c)&&(_s.overUse++,_g=TM.BANDWIDTH,_s.overUse>_u)?(_s.overUse=0,_s.underUse=0,Qm=iY(Wt,_c,_i,lN.DOWN),[Qm,_g]):(typeof _e=="number"&&_e>0&&typeof _t=="number"&&_t>0&&function(eE,pE,aE,cE){if(pE===0)return;let{threshold:{fps_up:fE}}=aE[pE];return yE("FORCE_AG_HIGH_FRAMERATE")&&cE==="maintain-framerate"&&(fE=aE[1].threshold.fps_up),eE>fE}(_e,_p,_c,_i)&&function(eE,pE,aE){if(pE===0)return;const{threshold:{bwe_up:cE}}=aE[pE];return eE>cE}(_t,_p,_c)&&(_s.underUse++,_s.underUse>_h&&(_s.overUse=0,_s.underUse=0,Qm=iY(Wt,_c,_i,lN.UP),Qm.scale===0&&(_g=TM.NONE))),[Qm,_g])}function aY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function p8($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?aY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):aY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function Ihe($){var _e;return!!yE("ENABLE_AG_ADAPTATION")&&!!($ instanceof Z6||i_(_e=$._hints).call(_e,S0.CUSTOM_TRACK))&&(!!yE("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(_t){const Wt=W_();if(Wt.os!==uS.IOS||!Wt.osVersion)return!1;const _n=Wt.osVersion.split(".");return Number(_n[0])>=_t}(14)&&_H(17,4)||vH(14)&&yH(17,4)))}const RM=new Map;function CM($){const _e=RM.get($);if(_e){const{timer:_t,adaptationFunc:Wt,originConfig:_n}=_e;window.clearTimeout(_t),Wt(_n),RM.delete($)}oY($)}var z_;function cY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function uI($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?cY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):cY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let jR=(z_=class WP extends LL{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var _e,_t;return(_e=(_t=this.peerConnection.getReceivers()[0])===null||_t===void 0||(_t=_t.transport)===null||_t===void 0?void 0:_t.state)!==null&&_e!==void 0?_e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(_e=>_e.rtpMap&&_e.rtpMap.encodingName.toLowerCase()||"").filter(_e=>{var _t;return i_(_t=Object.keys(NO)).call(_t,_e)}))]}constructor(_e,_t){super(_e,_t),hE(this,"store",void 0),hE(this,"peerConnection",void 0),hE(this,"id",f0(5,"connection-")),hE(this,"remoteSDP",void 0),hE(this,"initialOffer",void 0),hE(this,"transportEventReceiver",void 0),hE(this,"statsFilter",void 0),hE(this,"useXR",yE("USE_XR")),hE(this,"localCapabilities",void 0),hE(this,"remoteCodecs",void 0),hE(this,"localCandidateCount",0),hE(this,"allCandidatesReceived",!1),hE(this,"dataStreamChannelMap",new Map),hE(this,"establishPromise",void 0),hE(this,"recoveredDataChannelIds",[]),hE(this,"currentDataChannelId",1),hE(this,"mutex",new mS("P2PConnection-mutex")),hE(this,"qualityLimitationReason",TM.NONE),this.store=_t,this.peerConnection=new RTCPeerConnection(WP.resolvePCConfiguration(_e),{optional:[{googDscp:!0}]}),this.statsFilter=gM(this.peerConnection,yE("STATS_UPDATE_INTERVAL"),void 0,h0()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(_e,_t){if(this.remoteCodecs=_t,!this.remoteSDP)return void iE.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(_t));if(this.remoteSDP.updateRemoteCodec(_e,_t,this.store.codec)){const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(Wt);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}else iE.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const _e=await this.peerConnection.createOffer();if(!_e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const _t=LR(_e.sdp),Wt=await c8({filterRTX:!yE("USE_PUB_RTX")&&!yE("USE_SUB_RTX"),filterVideoFec:yE("FILTER_VIDEO_FEC"),filterAudioFec:yE("FILTER_AUDIO_FEC"),filterVideoCodec:yE("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=aN(Wt),this.initialOffer=_e,uI(uI({},_t),{},{rtpCapabilities:Wt,offerSDP:_e.sdp})}catch(_e){throw new HE(mE.GET_LOCAL_CONNECTION_PARAMS_FAILED,_e.toString())}}async connect(_e,_t,Wt,_n,_i,_s){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return b0(this._localCapabilities)}get rtpCapabilities(){return b0(this._rtpCapabilities)}get candidates(){return b0(this._candidates)}get iceParameters(){return b0(this._iceParameters)}get dtlsParameters(){return b0(this._dtlsParameters)}constructor(eE){hE(this,"sessionDesc",void 0),hE(this,"_localCapabilities",void 0),hE(this,"_rtpCapabilities",void 0),hE(this,"_candidates",void 0),hE(this,"_iceParameters",void 0),hE(this,"_dtlsParameters",void 0),hE(this,"setup",void 0),hE(this,"currentMidIndex",void 0),hE(this,"cname",void 0),hE(this,"firefoxSsrcMidMap",new Map),eE=b0(eE);const{remoteIceParameters:pE,remoteDtlsParameters:aE,candidates:cE,remoteRTPCapabilities:fE,remoteSetup:gE,localCapabilities:AE,cname:PE}=eE,xE=N0.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=fE,this._candidates=cE,this._iceParameters=pE,this._dtlsParameters=aE,this._localCapabilities=AE,this.setup=gE,this.cname=PE;const GE=this.rtpCapabilities.send;for(const zE of xE.mediaDescriptions){if(zE.attributes.iceUfrag=pE.iceUfrag,zE.attributes.icePwd=pE.icePwd,zE.attributes.fingerprints=aE.fingerprints,zE.attributes.candidates=cE,zE.attributes.setup=gE,zE.media.mediaType==="video"&&(zE.media.fmts=GE.videoCodecs.map(KE=>KE.payloadType.toString(10)),zE.attributes.payloads=GE.videoCodecs,zE.attributes.extmaps=GE.videoExtensions,yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:KE,ssrcGroups:JE}=DT([{ssrcId:nY,rtx:yE("USE_SUB_RTX")?40001:void 0}],this.cname);zE.attributes.ssrcs=KE,zE.attributes.ssrcGroups=JE}if(zE.media.mediaType==="audio"&&(zE.media.fmts=GE.audioCodecs.map(KE=>KE.payloadType.toString(10)),zE.attributes.payloads=GE.audioCodecs,zE.attributes.extmaps=GE.audioExtensions,xR(zE),yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:KE,ssrcGroups:JE}=DT([{ssrcId:2e4}],this.cname);zE.attributes.ssrcs=KE,zE.attributes.ssrcGroups=JE}}this.sessionDesc=xE,this.currentMidIndex=xE.mediaDescriptions.length-1}preloadRemoteMedia(){const eE=yE("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const pE=this.candidates,aE=this.dtlsParameters,cE=this.iceParameters,fE=this.rtpCapabilities.send;for(let gE=1;gE<eE;gE++){const AE=2*gE+2e4,PE=2*gE+nY,{ssrcs:xE,ssrcGroups:GE}=DT([{ssrcId:AE}],this.cname),{ssrcs:zE,ssrcGroups:KE}=DT([{ssrcId:PE,rtx:yE("USE_SUB_RTX")?PE+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:FP,protos:["UDP","TLS","RTP","SAVPF"],fmts:fE.videoCodecs.map(JE=>JE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:cE.iceUfrag,icePwd:cE.icePwd,unrecognized:[],candidates:pE,extmaps:fE.videoExtensions,fingerprints:aE.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:zE,ssrcGroups:KE,rtcpFeedbackWildcards:[],payloads:fE.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*gE)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:FP,protos:["UDP","TLS","RTP","SAVPF"],fmts:fE.audioCodecs.map(JE=>JE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:cE.iceUfrag,icePwd:cE.icePwd,unrecognized:[],candidates:pE,extmaps:fE.audioExtensions,fingerprints:aE.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:xE,ssrcGroups:GE,rtcpFeedbackWildcards:[],payloads:fE.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*gE+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return N0.print(this.sessionDesc)}send(eE,pE,aE,cE){const{ssrcs:fE,ssrcGroups:gE}=DT(pE,this.cname,yE("SYNC_GROUP")?aE:void 0),AE=this.findPreloadMediaDesc(fE);if(AE){if(h0()&&this.firefoxSsrcMidMap.set(fE[0].ssrcId,AE.attributes.mid),cE&&(cE.twcc||cE.remb)){const PE=this.sessionDesc.mediaDescriptions.indexOf(AE);return this.sessionDesc.mediaDescriptions[PE]=this.mungSendMediaDesc(AE,cE),{mid:AE.attributes.mid,needExchangeSDP:!0}}return{mid:AE.attributes.mid,needExchangeSDP:!1}}{const PE=this.findAvailableMediaIndex(eE,fE);let xE;return PE===-1||PE===1&&(dS()||SH())||PE===0&&yE("USE_SUB_RTX")||TH()?(xE=this.createOrRecycleSendMedia(eE,fE,gE,"sendonly",cE),this.updateBundleMids()):(xE=b0(this.sessionDesc.mediaDescriptions[PE]),xE.attributes.direction="sendonly",xE.attributes.ssrcs=fE,xE.attributes.ssrcGroups=gE,this.sessionDesc.mediaDescriptions[PE]=this.mungSendMediaDesc(xE,cE)),h0()&&this.firefoxSsrcMidMap.set(fE[0].ssrcId,xE.attributes.mid),{mid:xE.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:eE,needExchangeSDP:pE}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:eE.attributes.mid,needExchangeSDP:pE}}batchSend(eE){const pE=eE.map(fE=>{let{kind:gE,ssrcMsg:AE,mslabel:PE}=fE;return this.send(gE,AE,PE)}),aE=[];let cE=!1;return pE.forEach(fE=>{let{mid:gE,needExchangeSDP:AE}=fE;AE&&(cE=!0),aE.push(gE)}),{mids:aE,needExchangeSDP:cE}}stopSending(eE){const pE=this.sessionDesc.mediaDescriptions.filter(aE=>aE.attributes.mid&&eE.indexOf(aE.attributes.mid)!==-1);if(pE.length!==eE.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");pE.forEach(aE=>{aE.attributes.mid==="0"||h0()||TH()?aE.attributes.ssrcs=[]:(aE.attributes.ssrcs=[],aE.attributes.direction="inactive",aE.media.port="0")}),this.updateBundleMids()}mute(eE){const pE=this.sessionDesc.mediaDescriptions.find(aE=>aE.attributes.mid===eE);if(!pE)throw new Error("mediaDescription not found with ".concat(eE," in remote SDP when calling RemoteSDP.mute."));pE.attributes.direction="inactive"}unmute(eE){const pE=this.sessionDesc.mediaDescriptions.find(aE=>aE.attributes.mid===eE);if(!pE)throw new Error("mediaDescription not found with ".concat(eE," in remote SDP when calling RemoteSDP.unmute."));pE.attributes.direction="sendonly"}muteRemote(eE){const pE=this.sessionDesc.mediaDescriptions.filter(aE=>i_(eE).call(eE,aE.attributes.mid||""));if(pE.length!==eE.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");pE.forEach(aE=>{aE.attributes.direction="inactive"})}unmuteRemote(eE){const pE=this.sessionDesc.mediaDescriptions.filter(aE=>i_(eE).call(eE,aE.attributes.mid||""));if(pE.length!==eE.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");pE.forEach(aE=>{aE.attributes.direction="recvonly"})}receive(eE,pE,aE,cE){eE.forEach((fE,gE)=>{this.createOrRecycleRecvMedia(fE,[],"recvonly",pE,aE,cE[gE])}),this.updateBundleMids()}stopReceiving(eE){const pE=this.sessionDesc.mediaDescriptions.filter(aE=>eE.indexOf(aE.attributes.mid)!==-1);if(pE.length!==eE.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");pE.forEach(aE=>{aE.media.port="0",aE.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(eE){const pE=this._candidates.filter(aE=>aE.transport==="udp");if(eE===BS.TCP){if(pE.length===0)return;if(yE("TCP_CANDIDATE_ONLY")){const aE=this._candidates.filter(cE=>cE.transport==="tcp");pE.forEach(cE=>{aE.findIndex(fE=>fE.connectionAddress===cE.connectionAddress)===-1&&aE.push(lI(lI({},cE),{},{foundation:"tcpcandidate",priority:Number(cE.priority)-1+"",transport:"tcp",port:Number(cE.port)+90+""}))}),this._candidates=aE}else{const aE=[];pE.forEach(cE=>{aE.push(lI(lI({},cE),{},{foundation:"tcpcandidate",priority:Number(cE.priority)-1+"",transport:"tcp",port:Number(cE.port)+90+""}))}),this._candidates=[...pE,...aE]}}else if(eE===BS.RELAY){if(pE.length!==0)return;{const aE=this._candidates.filter(cE=>cE.transport==="tcp");aE.forEach(cE=>{pE.push(lI(lI({},cE),{},{foundation:"udpcandidate",priority:Number(cE.priority)+1+"",transport:"udp",port:Number(cE.port)-90+""}))}),this._candidates=[...pE,...aE]}}else pE.length===0?(this._candidates.filter(aE=>aE.transport==="tcp").forEach(aE=>{pE.push(lI(lI({},aE),{},{foundation:"udpcandidate",priority:Number(aE.priority)+1+"",transport:"udp",port:Number(aE.port)-90+""}))}),this._candidates=pE):this._candidates=this._candidates.filter(aE=>aE.transport!=="tcp");for(const aE of this.sessionDesc.mediaDescriptions)aE.attributes.candidates=this.candidates}restartICE(eE){eE=b0(eE),this._iceParameters=eE,this.sessionDesc.mediaDescriptions.forEach(pE=>{pE.attributes.iceUfrag=eE.iceUfrag,pE.attributes.icePwd=eE.icePwd})}predictReceivingMids(eE){const pE=[];for(let aE=0;aE<eE;aE++)pE.push((this.currentMidIndex+aE+1).toString(10));return pE}findAvailableMediaIndex(eE,pE){return this.sessionDesc.mediaDescriptions.findIndex(aE=>{const cE=aE.media.mediaType===eE&&aE.media.port!=="0"&&(aE.attributes.direction==="sendonly"||aE.attributes.direction==="sendrecv")&&aE.attributes.ssrcs.length===0;if(h0()){if(cE){const fE=this.firefoxSsrcMidMap.get(pE[0].ssrcId);return!(fE||aE.attributes.mid!=="0"&&aE.attributes.mid!=="1")||!(!fE||fE!==aE.attributes.mid)}return!1}return cE})}createOrRecycleDataChannel(){for(const aE of this.sessionDesc.mediaDescriptions)if(aE.media.mediaType==="application")return{mediaDesc:aE,needExchangeSDP:!1};this.currentMidIndex+=1;const eE="".concat(this.currentMidIndex),pE={media:{mediaType:"application",port:FP,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(eE),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(pE),{mediaDesc:pE,needExchangeSDP:!0}}createOrRecycleRecvMedia(eE,pE,aE,cE,fE,gE){const AE=eE._mediaStreamTrack.kind,PE=this.rtpCapabilities.recv,xE=JI(AE,PE,this.localCapabilities.send,AE===h_.VIDEO?cE:fE),GE=AE===h_.VIDEO?PE.videoExtensions:PE.audioExtensions;this.currentMidIndex+=1;const zE="".concat(this.currentMidIndex);let KE={media:{mediaType:AE,port:FP,protos:["UDP","TLS","RTP","SAVPF"],fmts:xE.map(c_=>c_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:GE,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:pE,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:xE,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:aE,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(zE)}};KE=this.mungRecvMediaDsec(KE,eE,gE);const JE=this.findFirstClosedMedia(AE);if(JE){const c_=this.sessionDesc.mediaDescriptions.indexOf(JE);this.sessionDesc.mediaDescriptions[c_]=KE}else this.sessionDesc.mediaDescriptions.push(KE);return KE}updateRemoteCodec(eE,pE,aE){const cE=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(KE=>KE.rtpMap&&KE.rtpMap.encodingName.toLowerCase()||"").filter(KE=>{var JE;return i_(JE=Object.keys(NO)).call(JE,KE)}))],fE=new Set(pE);if(cE.every(KE=>fE.has(KE)))return iE.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(pE)),!1;const gE=this._rtpCapabilities.recv.videoCodecs.filter(KE=>pE.some(JE=>{var c_;return i_(c_=KE.rtpMap&&KE.rtpMap.encodingName.toLowerCase()||"").call(c_,JE)}));if(gE.length===0)return iE.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(cE," codecs: ").concat(pE)),!1;const AE=[...new Set(gE.map(KE=>KE.rtpMap&&KE.rtpMap.encodingName.toLowerCase()||""))];let PE;if(iE.debug("updateRemoteCodec, from ".concat(cE," to ").concat(AE)),eE.length===0)PE=this.sessionDesc.mediaDescriptions.filter(KE=>KE.media.mediaType==="video"&&KE.attributes.direction==="recvonly");else if(PE=this.sessionDesc.mediaDescriptions.filter(KE=>KE.attributes.mid&&i_(eE).call(eE,KE.attributes.mid)&&KE.attributes.direction==="recvonly"),PE.length!==eE.length)return iE.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(eE,", codecs: ").concat(pE)),!1;if(yE("USE_PUB_RTX")||yE("USE_SUB_RTX")){const KE=l8(gE,this.rtpCapabilities.recv.videoCodecs);gE.push(...KE)}this._rtpCapabilities.recv.videoCodecs=gE;const xE=this.localCapabilities.send,GE=this.rtpCapabilities.recv,zE=JI(h_.VIDEO,GE,xE,aE);return PE.forEach(KE=>{const JE=zE.map(c_=>c_.payloadType.toString(10));iE.debug("updateRemoteCodec mid: ".concat(KE.attributes.mid,", from ").concat(KE.attributes.payloads," to ").concat(zE)),KE.attributes.payloads=zE,KE.media.fmts=JE}),!0}createOrRecycleSendMedia(eE,pE,aE,cE,fE){const gE=this.rtpCapabilities.send,AE=eE===h_.VIDEO?gE.videoCodecs:gE.audioCodecs,PE=eE===h_.VIDEO?gE.videoExtensions:gE.audioExtensions;this.currentMidIndex+=1;const xE="".concat(this.currentMidIndex);let GE={media:{mediaType:eE,port:FP,protos:["UDP","TLS","RTP","SAVPF"],fmts:AE.map(KE=>KE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:PE,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:pE,ssrcGroups:aE,rtcpFeedbackWildcards:[],payloads:AE,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:cE,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(xE)}};GE=this.mungSendMediaDesc(GE,fE);const zE=this.findFirstClosedMedia(eE);if(zE){const KE=this.sessionDesc.mediaDescriptions.indexOf(zE);this.sessionDesc.mediaDescriptions[KE]=GE}else this.sessionDesc.mediaDescriptions.push(GE);return GE}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(eE=>eE.media.port!=="0").map(eE=>eE.attributes.mid)}mungRecvMediaDsec(eE,pE,aE){const cE=b0(eE);return EM(cE),oI(cE,pE),vM(cE,pE),s8(cE),sN(cE,aE,this.localCapabilities.send),cE}mungSendMediaDesc(eE,pE){const aE=b0(eE);return sN(aE,pE,this.localCapabilities.recv),xR(aE),aE}updateRecvMedia(eE,pE){const aE=this.sessionDesc.mediaDescriptions.findIndex(cE=>cE.attributes.mid===eE);if(aE!==-1){const cE=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[aE],pE);this.sessionDesc.mediaDescriptions[aE]=cE}}bumpMid(eE){this.currentMidIndex+=eE}findFirstClosedMedia(eE){return this.sessionDesc.mediaDescriptions.find(pE=>h0()?pE.media.port==="0"&&pE.media.mediaType===eE:pE.media.port==="0")}findPreloadMediaDesc(eE){return this.sessionDesc.mediaDescriptions.find(pE=>{var aE;return((aE=pE.attributes)===null||aE===void 0||(aE=aE.ssrcs[0])===null||aE===void 0?void 0:aE.ssrcId)===eE[0].ssrcId})}getSSRC(eE){var pE;return(pE=this.sessionDesc.mediaDescriptions.find(aE=>aE.attributes.mid===eE))===null||pE===void 0?void 0:pE.attributes.ssrcs}}({remoteIceParameters:_e,remoteDtlsParameters:_t,candidates:Wt,remoteRTPCapabilities:_n,remoteSetup:_i,localCapabilities:this.localCapabilities,cname:_s}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const _c=this.remoteSDP.toString(),_u=N0.parse(this.initialOffer.sdp),_h=_u.mediaDescriptions.find(eE=>eE.media.mediaType==="audio");_h&&xR(_h),this.useXR&&_M(_u);const _p=N0.print(_u),Qm=this.logSDPExchange(_p||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:_p}),Qm==null||Qm(_c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_c});const _g=this.peerConnection.getTransceivers()[0];if(_g!=null&&_g.receiver&&this.tryBindTransportEvents(_g.receiver),yE("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const eE=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:eE});const pE=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(pE)}}catch(_c){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(_c.toString()))}}send(_e,_t,Wt){var _n=this;return ET(function*(){const _i=yield k_(_n.mutex.lock("From P2PConnection.send"));try{if(!_n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _s=[];_e.forEach(aE=>{const cE=_n.peerConnection.addTransceiver(aE._mediaStreamTrack,{direction:"sendonly"});_s.push(cE),aE._updateRtpTransceiver(cE)}),h0()&&yE("SIMULCAST")===!0&&(yield k_(_n.applySimulcastForFirefox(_s,_e)));const _c=yield k_(_n.peerConnection.createOffer()),_u=_n.remoteSDP.predictReceivingMids(_e.length),_h=_n.mungSendOfferSDP(_c.sdp,_e,_u),_p=N0.parse(_h),Qm=_u.map(aE=>{const cE=_p.mediaDescriptions.find(fE=>fE.attributes.mid===aE);if(!cE)throw new Error("Cannot extract ssrc from mediaDescription.");return o8(cE,yE("USE_PUB_RTX"))});let _g;try{_g=yield Qm}catch(aE){_g=[],_n.remoteSDP.receive(_e,_t,Wt,_g);const cE=_n.remoteSDP.toString();throw yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_h})),yield k_(_n.peerConnection.setRemoteDescription({type:"answer",sdp:cE})),yield k_(_n.stopSending(_u,!0)),aE}_n.remoteSDP.receive(_e,_t,Wt,_g);const eE=_n.remoteSDP.toString(),pE=_n.logSDPExchange(_h,"offer","local","send");return yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_h})),yield k_(_n.applySimulcastEncodings(_s,_e)),yield k_(_n.applySendEncodings(_s,_e)),pE==null||pE(eE),yield k_(_n.peerConnection.setRemoteDescription({type:"answer",sdp:eE})),_s.map((aE,cE)=>{const fE=_u[cE];return{localSSRC:Qm[cE],id:fE,transceiver:aE}})}catch(_s){throw _s instanceof HE?_s:new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_s.toString()))}finally{_i()}})()}async createDataChannels(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let Wt=this.dataStreamChannelMap.get(_e);if(Wt&&Wt.readyState==="open")iE.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const _i=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof _i!="number")throw new Error("create DataChannel error, because cannot get dc id");Wt=this.peerConnection.createDataChannel("datastream-channel",{id:_i,negotiated:!0,ordered:!1,maxRetransmits:yE("DATASTREAM_MAX_RETRANSMITS")}),Wt.binaryType="arraybuffer",this.dataStreamChannelMap.set(_e,Wt)}_t.forEach(_i=>{_i._updateOriginDataChannel(Wt)});const{needExchangeSDP:_n}=this.remoteSDP.sendDataChannel();if(_n){const _i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_i});const _s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_s),iE.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else iE.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(Wt){throw Wt instanceof HE?Wt:new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(Wt.toString()))}}async stopDataChannels(_e){try{const _t=this.dataStreamChannelMap.get(_e);return _t&&(_t.id&&this.recoveredDataChannelIds.push(_t.id),_t.close()),void this.dataStreamChannelMap.delete(_e)}catch(_t){throw _t instanceof HE?_t:new HE(mE.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(_t.toString()))}}async stopSending(_e,_t){const Wt=_t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const _n=this.peerConnection.getTransceivers().filter(_u=>_e.indexOf(_u.mid)!==-1);if(_n.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");_n.map(_u=>{var _h;CM(this.id+_u.mid),_u.direction="inactive",(_h=_u.stop)===null||_h===void 0||_h.call(_u)});const _i=await this.peerConnection.createOffer(),_s=this.logSDPExchange(_i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_i),this.remoteSDP.stopReceiving(_e);const _c=this.remoteSDP.toString();_s==null||_s(_c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_c})}catch(_n){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(_n.toString()))}finally{Wt&&Wt()}}async receive(_e,_t,Wt,_n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(_e," before remoteSDP created."));const{mid:_i,needExchangeSDP:_s}=this.remoteSDP.send(_e,_t,Wt,_n);if(_s){const _u=this.remoteSDP.toString(),_h=this.logSDPExchange(_u,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_u});const _p=await this.peerConnection.createAnswer(),Qm=this.mungReceiveAnswerSDP(_p.sdp,_i,_e);_h==null||_h(Qm||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:Qm}),iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," by exchanging SDP."))}else iE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(_e," no need to exchange SDP."));const _c=this.peerConnection.getTransceivers().find(_u=>_u.mid===_i);if(!_c)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_c.receiver.track,id:_i,transceiver:_c}}catch(_i){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async batchReceive(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:_t,needExchangeSDP:Wt}=this.remoteSDP.batchSend(_e);if(Wt){const _n=this.remoteSDP.toString(),_i=this.logSDPExchange(_n,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_n});const _s=await this.peerConnection.createAnswer();_i==null||_i(_s.sdp||""),await this.peerConnection.setLocalDescription(_s),iE.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else iE.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return _t.map(_n=>{const _i=this.peerConnection.getTransceivers().find(_s=>_s.mid===_n);if(!_i)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_i.receiver.track,id:_n,transceiver:_i}})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_t.toString()))}}async stopReceiving(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(_t.toString()))}}async muteRemote(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(_e," before remote SDP created."));this.remoteSDP.mute(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(_t.toString()))}}async unmuteRemote(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(_e," before remote SDP created."));this.remoteSDP.unmute(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(_t.toString()))}}async muteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(_s=>{_s.direction="inactive"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.muteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(_t.toString()))}}async unmuteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(async(_s,_c)=>{_s.direction="sendonly"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.unmuteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new HE(mE.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(_t.toString()))}}restartICE(_e){var _t=this;return ET(function*(){const Wt=yield k_(_t.mutex.lock("From P2PConnection.restartICE"));try{if(!_t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(B_().supportPCSetConfiguration){const _h=_t.peerConnection.getConfiguration(),_p=_e===BS.RELAY?"relay":"all";_h.iceTransportPolicy!==_p&&(iE.debug("[".concat(_t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(_h.iceTransportPolicy,"] to [").concat(_p,"]")),_h.iceTransportPolicy=_p,_t.peerConnection.setConfiguration(_h))}else if(_e===BS.RELAY)return;_t.remoteSDP.updateCandidates(_e);const _n=yield k_(_t.peerConnection.createOffer({iceRestart:!0}));if(!_n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=LR(_n.sdp),{remoteIceParameters:_s}=yield _i.iceParameters;_t.remoteSDP.restartICE(_s);const _c=_t.remoteSDP.toString(),_u=_t.logSDPExchange(_n.sdp||"","offer","local","restartICE");_t.store.descriptionStart(),yield k_(_t.peerConnection.setLocalDescription(_n)),_u==null||_u(_c),yield k_(_t.peerConnection.setRemoteDescription({type:"answer",sdp:_c}))}catch(_n){iE.warning("[".concat(_t.store.clientId,"] restart ICE failed, abort operation"),_n)}finally{Wt()}})()}close(){var _e;this.peerConnection.getTransceivers().forEach(_t=>{CM(this.id+_t.mid)}),this.peerConnection.close(),(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return uI(uI({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(_e){return this.statsFilter.getVideoIsReady(_e)}async updateEncoderConfig(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const Wt=await this.peerConnection.createOffer(),_n=this.mungSendOfferSDP(Wt.sdp,[_t],[_e]);this.remoteSDP.updateRecvMedia(_e,_t);const _i=this.remoteSDP.toString(),_s=this.logSDPExchange(_n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:_n}),_s==null||_s(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(Wt){throw new HE(mE.EXCHANGE_SDP_FAILED,Wt.toString())}}async updateSendParameters(_e,_t){const Wt=this.peerConnection.getTransceivers().filter(_n=>_n.mid===_e);Wt.length===1&&(this.isVP8Simulcast(_t)?h0()||await this.applySimulcastEncodings(Wt,[_t]):await this.applySendEncodings(Wt,[_t]))}setStatsRemoteVideoIsReady(_e,_t){this.statsFilter.setVideoIsReady2(_e,_t)}async replaceTrack(_e,_t){const Wt=this.peerConnection.getTransceivers().find(_n=>_n.mid===_t);Wt&&await Wt.sender.replaceTrack(_e._mediaStreamTrack)}async getSelectedCandidatePair(){const _e=this.peerConnection.getReceivers();if(_e.length>0&&_e[0].transport&&_e[0].transport.iceTransport&&_e[0].transport.iceTransport.getSelectedCandidatePair&&_e[0].transport.iceTransport.getSelectedCandidatePair()){const _t=_e[0].transport.iceTransport,{local:Wt,remote:_n}=_t.getSelectedCandidatePair();return{local:uI(uI({},a1),{},{candidateType:Wt.type,protocol:Wt.protocol,address:Wt.address,port:Wt.port}),remote:uI(uI({},a1),{},{candidateType:_n.type,protocol:_n.protocol,address:_n.address,port:_n.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var _e;(_e=this.onICEConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var _e;(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=_e=>{_e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,iE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,iE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},yE("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(_e){const _t={iceServers:[]};return _e.iceServers?_t.iceServers=_e.iceServers:_e.turnServer&&_e.turnServer.mode!=="off"&&(IO(_e.turnServer.servers)?_t.iceServers=_e.turnServer.servers:(_t.iceServers&&_t.iceServers.push(...WP.turnServerConfigToIceServers(_e.turnServer.servers)),yE("USE_TURN_SERVER_OF_GATEWAY")&&_t.iceServers&&_e.turnServer.serversFromGateway&&_t.iceServers.push(...WP.turnServerConfigToIceServers(_e.turnServer.serversFromGateway)),yE("FORCE_TURN_TCP")?_t.iceTransportPolicy="relay":_e.turnServer.servers.concat(_e.turnServer.serversFromGateway||[]).forEach(Wt=>{Wt.forceturn&&(_t.iceTransportPolicy="relay")}))),yE("ENABLE_ENCODED_TRANSFORM")&&B_().supportWebRTCEncodedTransform&&(_t.encodedInsertableStreams=!0),_t}static turnServerConfigToIceServers(_e){const _t=[];return _e.forEach(Wt=>{Wt.security?Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turns:".concat(X1(Wt.turnServerURL),":").concat(Wt.tcpport,"?transport=tcp")}):(Wt.udpport&&!yE("FORCE_TURN_TCP")&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.udpport,"?transport=udp")}),Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.tcpport,"?transport=tcp")}))}),_t}tryBindTransportEvents(_e){const _t=_e.transport;if(_t){this.transportEventReceiver=_e,_t.onstatechange=()=>{var _n;_t!=null&&_t.state&&((_n=this.onDTLSTransportStateChange)===null||_n===void 0||_n.call(this,_t.state))},_t.onerror=_n=>{var _i;(_i=this.onDTLSTransportError)===null||_i===void 0||_i.call(this,"error"in _n?_n.error:_n)};const Wt=_t.iceTransport;Wt&&(Wt.onstatechange=()=>{const _n=_t==null?void 0:_t.iceTransport.state;var _i;_n&&((_i=this.onICETransportStateChange)===null||_i===void 0||_i.call(this,_n))},Wt.getSelectedCandidatePair&&(Wt.onselectedcandidatepairchange=()=>{if(Wt.getSelectedCandidatePair()){const{local:_n,remote:_i}=Wt.getSelectedCandidatePair();iE.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:_n.type,protocol:_n.protocol}),", remote ").concat(JSON.stringify({candidateType:_i.type,protocol:_i.protocol,address:_i.address,port:_i.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(_e,_t){var Wt,_n;if(_t||(_t=this.peerConnection.getSenders().find(cE=>cE.track===_e._mediaStreamTrack)),!_t)return iE.warn("[".concat(_e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(_e))return iE.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!B_().supportSetRtpSenderParameters)return iE.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const _i={},_s={};switch(_e._optimizationMode){case"motion":_i.degradationPreference="maintain-framerate";break;case"detail":_i.degradationPreference="maintain-resolution";break;case"balanced":_i.degradationPreference="balanced"}const _c=function(aE,cE){return aE.getTransceivers().find(fE=>fE.sender.track===cE||fE.receiver.track===cE)}(this.peerConnection,_e._mediaStreamTrack),_u=Jde(_e);if(Ihe(_e)&&_c&&_t&&_u&&this.getLocalVideoStats&&i_(Wt=["vp8","vp9"]).call(Wt,this.store.codec)){var _h;const aE=_i.degradationPreference||(i_(_h=_e._hints).call(_h,S0.CUSTOM_TRACK)?yE("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(cE,fE,gE,AE,PE,xE){if(CM(cE),AE!=="balanced"&&AE!=="maintain-framerate"&&AE!=="maintain-resolution")return;let GE=-1;oY(cE,fE);const zE=window.setInterval(()=>{const JE=RM.get(cE);if(!yE("ENABLE_AG_ADAPTATION")||!JE)return void CM(cE);const c_=xE();if(c_.sendPackets>0&&c_.OutgoingAvailableBandwidth>0){if(GE===-1)return void(GE=Date.now());if(Date.now()-GE<1e3)return;const V_=c_.sendFrameRate,Q_=c_.OutgoingAvailableBandwidth,[T0,Z0]=Che(cE,V_,Q_,JE.adaptationConfig,fE,AE);Z0&&(gE.qualityLimitationReason=Z0),T0&&JE.adaptationConfig.scale!==T0.scale&&(iE.debug("[".concat(cE,"] applyAdaptation: ").concat(gE.qualityLimitationReason,`
           sendFps `).concat(V_,", bwe ").concat(Q_,", switch from ").concat(JE.adaptationConfig.scale," to ").concat(T0.scale," ")),JE.adaptationConfig=p8(p8({},JE.adaptationConfig),T0),PE(T0))}},yE("CHECK_LOCAL_STATS_INTERVAL")),KE=p8({},fE);RM.set(cE,{timer:zE,adaptationConfig:KE,originConfig:fE,adaptationFunc:PE}),iE.debug("[".concat(cE,"] start adaptation, originConfig: ").concat(JSON.stringify(fE),", degradationPreference: ").concat(AE))})(this.id+_c.mid,_u,this,aE,cE=>{_t&&this.updateAdaptation(_t,cE)},this.getLocalVideoStats.bind(this))}if(_e._encoderConfig){var _p;const{bitrateMax:aE,frameRate:cE,scaleResolutionDownBy:fE}=_e._encoderConfig;aE&&(_s.maxBitrate=1e3*aE),(i_(_p=_e._hints).call(_p,S0.LOW_STREAM)||_e.isUseScaleResolutionDownBy)&&(cE&&(_s.maxFramerate=cT(cE)),fE&&fE>=1&&(_s.scaleResolutionDownBy=fE))}const{maxFramerate:Qm}=yE("ENCODER_CONFIG_LIMIT");if(Qm&&typeof Qm=="number"&&(_s.maxFramerate=_s.maxFramerate?Math.min(_s.maxFramerate,Qm):Qm),yE("DSCP_TYPE")&&W1()){var _g;const aE=yE("DSCP_TYPE");i_(_g=["very-low","low","medium","high"]).call(_g,aE)&&(_s.networkPriority=aE)}const eE=_t.getParameters(),pE=(_n=eE.encodings)===null||_n===void 0?void 0:_n[0];h0()&&!pE&&(_i.encodings=[_s]),pE&&Object.assign(pE,_s),Object.assign(eE,_i),iE.debug("[".concat(_e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(eE.encodings))),await _t.setParameters(eE)}async updateAdaptation(_e,_t){var Wt,_n;if(!_e)return iE.debug("[updateAdaptation] no rtpSender found");if(!B_().supportSetRtpSenderParameters)return iE.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const _i={},{bitrateMax:_s,frameRate:_c,scaleResolutionDownBy:_u}=_t;_s&&(_i.maxBitrate=1e3*_s),_c&&(_i.maxFramerate=cT(_c)),_u&&_u>=1&&i_(Wt=["vp8","vp9"]).call(Wt,this.store.codec)&&(_i.scaleResolutionDownBy=_u);const _h=_e.getParameters(),_p=(_n=_h.encodings)===null||_n===void 0?void 0:_n[0];_p&&Object.assign(_p,_i),Object.assign(_h,{});try{await _e.setParameters(_h),iE.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(_h.encodings)))}catch(Qm){!("transport"in _e)||_e.transport&&_e.transport.state==="connected"?this.peerConnectionState!=="connected"?iE.debug("[updateAdaptation] peerConnection not connected}"):iE.debug("[updateAdaptation] updateRtpSenderEncodings failed",Qm):iE.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(_e,_t){try{if(!B_().supportSetRtpSenderParameters||_e.length!==_t.length)return;for(let Wt=0;Wt<_e.length;Wt++){const _n=_e[Wt],_i=_t[Wt];_i instanceof m0&&!this.isVP8Simulcast(_i)&&await this.updateRtpSenderEncodings(_i,_n.sender)}}catch{iE.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(_e,_t,Wt){const _n=N0.parse(_e);return _t.forEach((_i,_s)=>{const _c=Wt[_s],_u=_n.mediaDescriptions.find(_h=>_h.attributes.mid===_c);_u&&(oI(_u,_i),a8(_u,_i,this.store.codec))}),N0.print(_n)}mungReceiveAnswerSDP(_e,_t,Wt){const _n=N0.parse(_e),_i=_n.mediaDescriptions.find(_s=>_s.attributes.mid===_t);return _i&&(Wt===h_.AUDIO&&_i.media.mediaType==="audio"&&xR(_i),this.useXR&&_M(_n)),N0.print(_n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=_e=>{var _t;(_t=this.onFirstAudioReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoReceived=_e=>{var _t;(_t=this.onFirstVideoReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstAudioDecoded=_e=>{var _t;(_t=this.onFirstAudioDecoded)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoDecoded=(_e,_t,Wt)=>{var _n;(_n=this.onFirstVideoDecoded)===null||_n===void 0||_n.call(this,_e,_t,Wt)},this.statsFilter.onSelectedLocalCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedLocalCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onSelectedRemoteCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedRemoteCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onFirstVideoDecodedTimeout=_e=>{var _t;(_t=this.onFirstVideoDecodedTimeout)===null||_t===void 0||_t.call(this,_e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(_e,_t){if(_e.length===_t.length)for(let _u=0;_u<_e.length;_u++){var Wt,_n,_i,_s,_c;const _h=_e[_u],_p=_t[_u];if(_p instanceof m0&&!i_(Wt=_p._hints).call(Wt,S0.LOW_STREAM)&&(_n=_p._encoderConfig)!==null&&_n!==void 0&&_n.bitrateMax&&((_i=_p._encoderConfig)===null||_i===void 0?void 0:_i.bitrateMax)>200&&(_s=_p._scalabilityMode)!==null&&_s!==void 0&&_s.numSpatialLayers&&((_c=_p._scalabilityMode)===null||_c===void 0?void 0:_c.numSpatialLayers)>1&&this.store.codec==="vp8"){const Qm={},_g={high:1e3*(_p._encoderConfig.bitrateMax-50),medium:5e4};Qm.encodings=[{rid:"m",active:!0,maxBitrate:_g.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:_g.high}];const eE=_h.sender.getParameters();await _h.sender.setParameters(Object.assign(eE,Qm))}}}async applySimulcastEncodings(_e,_t){if(!h0()&&_e.length===_t.length)for(let Wt=0;Wt<_e.length;Wt++){const _n=_t[Wt];if(_n instanceof m0&&this.isVP8Simulcast(_n)){const _i=_e[Wt],_s={},_c={high:1e3*(_n._encoderConfig.bitrateMax-50),medium:5e4};_s.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_c.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_c.medium,scaleResolutionDownBy:4}];const _u=_i.sender.getParameters();await _i.sender.setParameters(Object.assign(_u,_s))}}}isVP8Simulcast(_e){var _t,Wt,_n,_i,_s;return!!(_e instanceof m0&&yE("SIMULCAST")&&this.store.codec==="vp8"&&!i_(_t=_e._hints).call(_t,S0.LOW_STREAM)&&(Wt=_e._encoderConfig)!==null&&Wt!==void 0&&Wt.bitrateMax&&((_n=_e._encoderConfig)===null||_n===void 0?void 0:_n.bitrateMax)>200&&(_i=_e._scalabilityMode)!==null&&_i!==void 0&&_i.numSpatialLayers&&((_s=_e._scalabilityMode)===null||_s===void 0?void 0:_s.numSpatialLayers)>1)}logSDPExchange(_e,_t,Wt,_n){if(yE("SDP_LOGGING"))return iE.upload("[".concat(this.store.clientId,"] exchanging ").concat(Wt," ").concat(_t," SDP during P2PConnection.").concat(_n,`
`),_e),_t==="offer"?_i=>{this.logSDPExchange(_i,"answer",Wt==="local"?"remote":"local",_n)}:void 0}async getRemoteSSRC(_e){if(!this.remoteSDP)return;const _t=this.remoteSDP.getSSRC(_e);return _t==null?void 0:_t[0].ssrcId}setConfiguration(_e){if(B_().supportPCSetConfiguration){const _t=WP.resolvePCConfiguration(_e);this.peerConnection.setConfiguration(_t)}}},t_(z_.prototype,"updateRemoteRTPCapabilities",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"updateRemoteRTPCapabilities"),z_.prototype),t_(z_.prototype,"connect",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"connect"),z_.prototype),t_(z_.prototype,"createDataChannels",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"createDataChannels"),z_.prototype),t_(z_.prototype,"receive",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"receive"),z_.prototype),t_(z_.prototype,"batchReceive",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"batchReceive"),z_.prototype),t_(z_.prototype,"stopReceiving",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"stopReceiving"),z_.prototype),t_(z_.prototype,"muteRemote",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"muteRemote"),z_.prototype),t_(z_.prototype,"unmuteRemote",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"unmuteRemote"),z_.prototype),t_(z_.prototype,"muteLocal",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"muteLocal"),z_.prototype),t_(z_.prototype,"unmuteLocal",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"unmuteLocal"),z_.prototype),t_(z_.prototype,"close",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"close"),z_.prototype),t_(z_.prototype,"updateEncoderConfig",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"updateEncoderConfig"),z_.prototype),t_(z_.prototype,"updateSendParameters",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"updateSendParameters"),z_.prototype),t_(z_.prototype,"replaceTrack",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"replaceTrack"),z_.prototype),t_(z_.prototype,"updateAdaptation",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"updateAdaptation"),z_.prototype),t_(z_.prototype,"getRemoteSSRC",[lT],Object.getOwnPropertyDescriptor(z_.prototype,"getRemoteSSRC"),z_.prototype),z_);function lT($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("From P2PConnection.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}function lY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function uY($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?lY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):lY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const dY=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,IM="9",f8=2e4,m8=4e4;class Ahe{get localCapabilities(){return b0(this._localCapabilities)}get rtpCapabilities(){return b0(this._rtpCapabilities)}get candidates(){return b0(this._candidates)}get iceParameters(){return b0(this._iceParameters)}get dtlsParameters(){return b0(this._dtlsParameters)}constructor(_e){hE(this,"sessionDesc",void 0),hE(this,"_localCapabilities",void 0),hE(this,"_rtpCapabilities",void 0),hE(this,"_candidates",void 0),hE(this,"_iceParameters",void 0),hE(this,"_dtlsParameters",void 0),hE(this,"setup",void 0),hE(this,"currentMidIndex",void 0),hE(this,"cname",void 0),hE(this,"firefoxSsrcMidMap",new Map),_e=b0(_e);const{remoteIceParameters:_t,remoteDtlsParameters:Wt,candidates:_n,remoteRTPCapabilities:_i,remoteSetup:_s,localCapabilities:_c,cname:_u}=_e,_h=N0.parse(dY);this._rtpCapabilities=_i,this._candidates=_n,this._iceParameters=_t,this._dtlsParameters=Wt,this._localCapabilities=_c,this.setup=_s,this.cname=_u;const _p=this.rtpCapabilities.send;for(const Qm of _h.mediaDescriptions){if(Qm.attributes.iceUfrag=_t.iceUfrag,Qm.attributes.icePwd=_t.icePwd,Qm.attributes.fingerprints=Wt.fingerprints,Qm.attributes.candidates=_n,Qm.attributes.setup=_s,Qm.media.mediaType==="application"&&(Qm.attributes.sctpPort="5000"),Qm.media.mediaType==="video"&&(Qm.media.fmts=_p.videoCodecs.map(_g=>_g.payloadType.toString(10)),Qm.attributes.payloads=_p.videoCodecs,Qm.attributes.extmaps=_p.videoExtensions,yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:eE}=DT([{ssrcId:m8,rtx:yE("USE_SUB_RTX")?40001:void 0}],this.cname);Qm.attributes.ssrcs=_g,Qm.attributes.ssrcGroups=eE}if(Qm.media.mediaType==="audio"&&(Qm.media.fmts=_p.audioCodecs.map(_g=>_g.payloadType.toString(10)),Qm.attributes.payloads=_p.audioCodecs,Qm.attributes.extmaps=_p.audioExtensions,xR(Qm),yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:eE}=DT([{ssrcId:f8}],this.cname);Qm.attributes.ssrcs=_g,Qm.attributes.ssrcGroups=eE}}this.sessionDesc=_h,this.currentMidIndex=_h.mediaDescriptions.length-1}updateRemoteRTPCapabilities(_e){const _t=N0.parse(dY);this._rtpCapabilities=_e;const Wt=this.rtpCapabilities.send;for(const _n of _t.mediaDescriptions){if(_n.attributes.iceUfrag=this._iceParameters.iceUfrag,_n.attributes.icePwd=this._iceParameters.icePwd,_n.attributes.fingerprints=this._dtlsParameters.fingerprints,_n.attributes.candidates=this._candidates,_n.attributes.setup=this.setup,_n.media.mediaType==="application"&&(_n.attributes.sctpPort="5000"),_n.media.mediaType==="video"&&(_n.media.fmts=Wt.videoCodecs.map(_i=>_i.payloadType.toString(10)),_n.attributes.payloads=Wt.videoCodecs,_n.attributes.extmaps=Wt.videoExtensions,yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_i,ssrcGroups:_s}=DT([{ssrcId:m8,rtx:yE("USE_SUB_RTX")?40001:void 0}],this.cname);_n.attributes.ssrcs=_i,_n.attributes.ssrcGroups=_s}if(_n.media.mediaType==="audio"&&(_n.media.fmts=Wt.audioCodecs.map(_i=>_i.payloadType.toString(10)),_n.attributes.payloads=Wt.audioCodecs,_n.attributes.extmaps=Wt.audioExtensions,yE("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_i,ssrcGroups:_s}=DT([{ssrcId:f8}],this.cname);_n.attributes.ssrcs=_i,_n.attributes.ssrcGroups=_s}}this.sessionDesc=_t,this.currentMidIndex=_t.mediaDescriptions.length-1}preloadRemoteMedia(_e){this.rtpCapabilities;const _t=this.candidates,Wt=this.dtlsParameters,_n=this.iceParameters,_i=this.rtpCapabilities.send;for(let _s=1;_s<_e;_s++){const _c=2*_s+f8,_u=2*_s+m8,{ssrcs:_h,ssrcGroups:_p}=DT([{ssrcId:_c}],this.cname),{ssrcs:Qm,ssrcGroups:_g}=DT([{ssrcId:_u,rtx:yE("USE_SUB_RTX")?_u+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:IM,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.videoCodecs.map(eE=>eE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_n.iceUfrag,icePwd:_n.icePwd,unrecognized:[],candidates:_t,extmaps:_i.videoExtensions,fingerprints:Wt.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Qm,ssrcGroups:_g,rtcpFeedbackWildcards:[],payloads:_i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_s-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:IM,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.audioCodecs.map(eE=>eE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_n.iceUfrag,icePwd:_n.icePwd,unrecognized:[],candidates:_t,extmaps:_i.audioExtensions,fingerprints:Wt.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_h,ssrcGroups:_p,rtcpFeedbackWildcards:[],payloads:_i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_s)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return N0.print(this.sessionDesc)}send(_e,_t,Wt,_n){const{ssrcs:_i,ssrcGroups:_s}=DT(_t,this.cname,yE("SYNC_GROUP")?Wt:void 0),_c=this.findPreloadMediaDesc(_i);if(_c){if(h0()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_c.attributes.mid),_n&&(_n.twcc||_n.remb)){const _u=this.sessionDesc.mediaDescriptions.indexOf(_c);return this.sessionDesc.mediaDescriptions[_u]=this.mungSendMediaDesc(_c,_n),{mid:_c.attributes.mid,needExchangeSDP:!0}}return{mid:_c.attributes.mid,needExchangeSDP:!1}}{const _u=this.findAvailableMediaIndex(_e,_i);let _h;return _u===-1||dS()||PS()||SH()||_u===0&&yE("USE_SUB_RTX")?(_h=this.createOrRecycleSendMedia(_e,_i,_s,"sendonly",_n),this.updateBundleMids()):(_h=b0(this.sessionDesc.mediaDescriptions[_u]),_h.attributes.direction="sendonly",_h.attributes.ssrcs=_i,_h.attributes.ssrcGroups=_s,this.sessionDesc.mediaDescriptions[_u]=this.mungSendMediaDesc(_h,_n)),h0()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_h.attributes.mid),{mid:_h.attributes.mid,needExchangeSDP:!0}}}batchSend(_e){const _t=_e.map(_i=>{let{kind:_s,ssrcMsg:_c,mslabel:_u}=_i;return this.send(_s,_c,_u)}),Wt=[];let _n=!1;return _t.forEach(_i=>{let{mid:_s,needExchangeSDP:_c}=_i;_c&&(_n=!0),Wt.push(_s)}),{mids:Wt,needExchangeSDP:_n}}stopSending(_e){const _t=this.sessionDesc.mediaDescriptions.filter(Wt=>Wt.attributes.mid&&_e.indexOf(Wt.attributes.mid)!==-1);if(_t.length!==_e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");_t.forEach(Wt=>{Wt.attributes.mid==="0"||h0()||dS()||PS()?Wt.attributes.ssrcs=[]:(Wt.attributes.ssrcs=[],Wt.attributes.direction="inactive",Wt.media.port="0")}),this.updateBundleMids()}mute(_e){const _t=this.sessionDesc.mediaDescriptions.find(Wt=>Wt.attributes.mid===_e);if(!_t)throw new Error("mediaDescription not found with ".concat(_e," in remote SDP when calling RemoteSDP.mute."));_t.attributes.direction="inactive"}unmute(_e){const _t=this.sessionDesc.mediaDescriptions.find(Wt=>Wt.attributes.mid===_e);if(!_t)throw new Error("mediaDescription not found with ".concat(_e," in remote SDP when calling RemoteSDP.unmute."));_t.attributes.direction="sendonly"}muteRemote(_e){const _t=this.sessionDesc.mediaDescriptions.filter(Wt=>i_(_e).call(_e,Wt.attributes.mid||""));if(_t.length!==_e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");_t.forEach(Wt=>{Wt.attributes.direction="inactive"})}unmuteRemote(_e){const _t=this.sessionDesc.mediaDescriptions.filter(Wt=>i_(_e).call(_e,Wt.attributes.mid||""));if(_t.length!==_e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");_t.forEach(Wt=>{Wt.attributes.direction="recvonly"})}receive(_e,_t,Wt,_n){_e.forEach((_i,_s)=>{this.createOrRecycleRecvMedia(_i,[],"recvonly",_t,Wt,_n[_s])}),this.updateBundleMids()}stopReceiving(_e){const _t=this.sessionDesc.mediaDescriptions.filter(Wt=>_e.indexOf(Wt.attributes.mid)!==-1);if(_t.length!==_e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");_t.forEach(Wt=>{Wt.media.port="0",Wt.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(_e){_e===BS.TCP?this._candidates.forEach(_t=>{this._candidates.findIndex(Wt=>Wt.transport==="tcp"&&Wt.connectionAddress===_t.connectionAddress&&Wt.port===_t.port)===-1&&this._candidates.push(uY(uY({},_t),{},{foundation:"tcpcandidate",priority:Number(_t.priority)-1+"",transport:"tcp",port:Number(_t.port)+90+""}))}):this._candidates=this._candidates.filter(_t=>_t.transport!=="tcp");for(const _t of this.sessionDesc.mediaDescriptions)_t.attributes.candidates=this.candidates}restartICE(_e){_e=b0(_e),this._iceParameters=_e,this.sessionDesc.mediaDescriptions.forEach(_t=>{_t.attributes.iceUfrag=_e.iceUfrag,_t.attributes.icePwd=_e.icePwd})}predictReceivingMids(_e){const _t=[];for(let Wt=0;Wt<_e;Wt++)_t.push((this.currentMidIndex+Wt+1).toString(10));return _t}findAvailableMediaIndex(_e,_t){return this.sessionDesc.mediaDescriptions.findIndex(Wt=>{const _n=Wt.media.mediaType===_e&&Wt.media.port!=="0"&&(Wt.attributes.direction==="sendonly"||Wt.attributes.direction==="sendrecv")&&Wt.attributes.ssrcs.length===0;if(h0()){if(_n){const _i=this.firefoxSsrcMidMap.get(_t[0].ssrcId);return!(_i||Wt.attributes.mid!=="0"&&Wt.attributes.mid!=="1")||!(!_i||_i!==Wt.attributes.mid)}return!1}return _n})}createOrRecycleRecvMedia(_e,_t,Wt,_n,_i,_s){const _c=_e._mediaStreamTrack.kind,_u=this.rtpCapabilities.recv,_h=JI(_c,_u,this.localCapabilities.send,_c===h_.VIDEO?_n:_i),_p=_c===h_.VIDEO?_u.videoExtensions:_u.audioExtensions;this.currentMidIndex+=1;const Qm="".concat(this.currentMidIndex);let _g={media:{mediaType:_c,port:IM,protos:["UDP","TLS","RTP","SAVPF"],fmts:_h.map(pE=>pE.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_p,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_h,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:Wt,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Qm)}};_g=this.mungRecvMediaDsec(_g,_e,_s);const eE=this.findFirstClosedMedia(_c);if(eE){const pE=this.sessionDesc.mediaDescriptions.indexOf(eE);this.sessionDesc.mediaDescriptions[pE]=_g}else this.sessionDesc.mediaDescriptions.push(_g);return _g}updateRemoteCodec(_e,_t,Wt){const _n=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(_g=>_g.rtpMap&&_g.rtpMap.encodingName.toLowerCase()||"").filter(_g=>{var eE;return i_(eE=Object.keys(NO)).call(eE,_g)}))],_i=new Set(_t);if(_n.every(_g=>_i.has(_g)))return iE.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(_t)),!1;const _s=this._rtpCapabilities.recv.videoCodecs.filter(_g=>_t.some(eE=>{var pE;return i_(pE=_g.rtpMap&&_g.rtpMap.encodingName.toLowerCase()||"").call(pE,eE)}));if(_s.length===0)return iE.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(_n," codecs: ").concat(_t)),!1;const _c=[...new Set(_s.map(_g=>_g.rtpMap&&_g.rtpMap.encodingName.toLowerCase()||""))];let _u;if(iE.debug("updateRemoteCodec, from ".concat(_n," to ").concat(_c)),_e.length===0)_u=this.sessionDesc.mediaDescriptions.filter(_g=>_g.media.mediaType==="video"&&_g.attributes.direction==="recvonly");else if(_u=this.sessionDesc.mediaDescriptions.filter(_g=>_g.attributes.mid&&i_(_e).call(_e,_g.attributes.mid)&&_g.attributes.direction==="recvonly"),_u.length!==_e.length)return iE.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(_e,", codecs: ").concat(_t)),!1;this._rtpCapabilities.recv.videoCodecs=_s;const _h=this.localCapabilities.send,_p=this.rtpCapabilities.recv,Qm=JI(h_.VIDEO,_p,_h,Wt);return _u.forEach(_g=>{const eE=Qm.map(pE=>pE.payloadType.toString(10));iE.debug("updateRemoteCodec mid: ".concat(_g.attributes.mid,", from ").concat(_g.attributes.payloads," to ").concat(Qm)),_g.attributes.payloads=Qm,_g.media.fmts=eE}),!0}createOrRecycleSendMedia(_e,_t,Wt,_n,_i){const _s=this.rtpCapabilities.send,_c=_e===h_.VIDEO?_s.videoCodecs:_s.audioCodecs,_u=_e===h_.VIDEO?_s.videoExtensions:_s.audioExtensions;this.currentMidIndex+=1;const _h="".concat(this.currentMidIndex);let _p={media:{mediaType:_e,port:IM,protos:["UDP","TLS","RTP","SAVPF"],fmts:_c.map(_g=>_g.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_u,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_t,ssrcGroups:Wt,rtcpFeedbackWildcards:[],payloads:_c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:_n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_h)}};_p=this.mungSendMediaDesc(_p,_i);const Qm=this.findFirstClosedMedia(_e);if(Qm){const _g=this.sessionDesc.mediaDescriptions.indexOf(Qm);this.sessionDesc.mediaDescriptions[_g]=_p}else this.sessionDesc.mediaDescriptions.push(_p);return _p}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(_e=>_e.media.port!=="0").map(_e=>_e.attributes.mid)}mungRecvMediaDsec(_e,_t,Wt){const _n=b0(_e);return EM(_n),oI(_n,_t),vM(_n,_t),s8(_n),sN(_n,Wt,this.localCapabilities.send),_n}mungSendMediaDesc(_e,_t){const Wt=b0(_e);return sN(Wt,_t,this.localCapabilities.recv),xR(Wt),Wt}updateRecvMedia(_e,_t){const Wt=this.sessionDesc.mediaDescriptions.findIndex(_n=>_n.attributes.mid===_e);if(Wt!==-1){const _n=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[Wt],_t);this.sessionDesc.mediaDescriptions[Wt]=_n}}bumpMid(_e){this.currentMidIndex+=_e}findFirstClosedMedia(_e){return this.sessionDesc.mediaDescriptions.find(_t=>h0()?_t.media.port==="0"&&_t.media.mediaType===_e:_t.media.port==="0")}findPreloadMediaDesc(_e){return this.sessionDesc.mediaDescriptions.find(_t=>{var Wt;return((Wt=_t.attributes)===null||Wt===void 0||(Wt=Wt.ssrcs[0])===null||Wt===void 0?void 0:Wt.ssrcId)===_e[0].ssrcId})}getSSRC(_e){var _t;return(_t=this.sessionDesc.mediaDescriptions.find(Wt=>Wt.attributes.mid===_e))===null||_t===void 0?void 0:_t.attributes.ssrcs}}var K_;function hY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function AM($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?hY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):hY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}let Ohe=(K_=class GM extends LL{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){let _e;return this.localCapabilities&&(_e=aN(this.localCapabilities)),[...new Set(_e&&_e.send.videoCodecs.map(_t=>_t.rtpMap&&_t.rtpMap.encodingName.toLowerCase()||"").filter(_t=>{var Wt;return i_(Wt=Object.keys(NO)).call(Wt,_t)}))]}constructor(_e,_t,Wt){super(_e,_t),hE(this,"store",void 0),hE(this,"peerConnection",void 0),hE(this,"remoteSDP",void 0),hE(this,"initialOffer",void 0),hE(this,"transportEventReceiver",void 0),hE(this,"statsFilter",void 0),hE(this,"useXR",yE("USE_XR")),hE(this,"localCapabilities",void 0),hE(this,"localCandidateCount",0),hE(this,"allCandidatesReceived",!1),hE(this,"remoteCodecs",void 0),hE(this,"dataStreamChannelMap",new Map),hE(this,"establishPromise",void 0),hE(this,"mutex",new mS("NVExtentionsConnection-mutex")),hE(this,"rtcMedia",void 0),this.store=_t,this.peerConnection=Wt,this.statsFilter=gM(this.peerConnection,yE("STATS_UPDATE_INTERVAL"),void 0,h0()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(_e){try{const _t=await this.peerConnection.createOffer();if(!_t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const Wt=LR(_t.sdp),_n=await c8({filterRTX:!yE("USE_PUB_RTX")&&!yE("USE_SUB_RTX"),filterVideoFec:yE("FILTER_VIDEO_FEC"),filterAudioFec:yE("FILTER_AUDIO_FEC"),filterVideoCodec:yE("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=_n,this.initialOffer=_t,AM(AM({},Wt),{},{rtpCapabilities:_n,offerSDP:_t.sdp})}catch(_t){throw new DE(mE.GET_LOCAL_CONNECTION_PARAMS_FAILED,_t.toString())}}async connect(_e,_t,Wt,_n,_i,_s){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Ahe({remoteIceParameters:_e,remoteDtlsParameters:_t,candidates:Wt,remoteRTPCapabilities:_n,remoteSetup:_i,localCapabilities:aN(this.localCapabilities),cname:_s});const _c=this.remoteSDP.toString(),_u=N0.parse(this.initialOffer.sdp),_h=_u.mediaDescriptions.find(_g=>_g.media.mediaType==="audio");_h&&xR(_h),this.useXR&&_M(_u);const _p=N0.print(_u),Qm=this.logSDPExchange(_p||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:_p}),Qm==null||Qm(_c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_c})}catch(_c){throw new DE(mE.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(_c.toString()))}}async updateRemoteRTPCapabilities(_e,_t){if(this.remoteCodecs=_t,!this.remoteSDP)return void iE.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(_t));if(this.remoteSDP.updateRemoteCodec(_e,_t,this.store.codec)){const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(Wt);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}else iE.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(_e){var _t,Wt,_n,_i;(_t=this.remoteSDP)===null||_t===void 0||_t.updateRemoteRTPCapabilities(_e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((_i=this.remoteSDP)===null||_i===void 0||_i.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(Wt=this.remoteSDP)===null||Wt===void 0||Wt.preloadRemoteMedia(2);const _s=(_n=this.remoteSDP)===null||_n===void 0?void 0:_n.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_s});const _c=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_c),iE.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(_e,_t,Wt){var _n=this;return ET(function*(){const _i=yield k_(_n.mutex.lock("From NVExtentionsConnection.send"));try{if(!_n.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const _s=[];_e.forEach(aE=>{const cE=_n.peerConnection.addTransceiver(aE._mediaStreamTrack,{direction:"sendonly"});_s.push(cE)}),h0()&&yE("SIMULCAST")===!0&&(yield k_(_n.applySimulcastForFirefox(_s,_e)));const _c=yield k_(_n.peerConnection.createOffer()),_u=_n.remoteSDP.predictReceivingMids(_e.length),_h=_n.mungSendOfferSDP(_c.sdp,_e,_u),_p=N0.parse(_h),Qm=_u.map(aE=>{const cE=_p.mediaDescriptions.find(fE=>fE.attributes.mid===aE);if(!cE)throw new Error("Cannot extract ssrc from mediaDescription.");return o8(cE,yE("USE_PUB_RTX"))});let _g;try{_g=yield Qm}catch(aE){_g=[],_n.remoteSDP.receive(_e,_t,Wt,_g);const cE=_n.remoteSDP.toString();throw yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_h})),yield k_(_n.peerConnection.setRemoteDescription({type:"answer",sdp:cE})),yield k_(_n.stopSending(_u,!0)),aE}_n.remoteSDP.receive(_e,_t,Wt,_g);const eE=_n.remoteSDP.toString(),pE=_n.logSDPExchange(_h,"offer","local","send");return yield k_(_n.peerConnection.setLocalDescription({type:"offer",sdp:_h})),yield k_(_n.applySimulcastEncodings(_s,_e)),yield k_(_n.applySendEncodings(_s,_e)),pE==null||pE(eE),yield k_(_n.peerConnection.setRemoteDescription({type:"answer",sdp:eE})),_s.map((aE,cE)=>{const fE=_u[cE];return{localSSRC:Qm[cE],id:fE,transceiver:aE}})}catch(_s){throw _s instanceof DE?_s:new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(_s.toString()))}finally{_i()}})()}async stopSending(_e,_t){const Wt=_t?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const _n=this.peerConnection.getTransceivers().filter(_u=>_e.indexOf(_u.mid)!==-1);if(_n.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");_n.map(_u=>{var _h;_u.direction="inactive",(_h=_u.stop)===null||_h===void 0||_h.call(_u)});const _i=await this.peerConnection.createOffer(),_s=this.logSDPExchange(_i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_i),this.remoteSDP.stopReceiving(_e);const _c=this.remoteSDP.toString();_s==null||_s(_c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_c})}catch(_n){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(_n.toString()))}finally{Wt&&Wt()}}async createDataChannels(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let Wt=this.dataStreamChannelMap.get(_e);return Wt&&Wt.readyState==="open"?iE.debug("[P2PConnection] Channels are already available and can be reused directly."):(Wt=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:yE("DATASTREAM_MAX_RETRANSMITS")}),Wt.binaryType="arraybuffer",this.dataStreamChannelMap.set(_e,Wt)),void _t.forEach(_n=>{_n._updateOriginDataChannel(Wt)})}catch(Wt){throw Wt instanceof DE?Wt:new DE(mE.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(Wt.toString()))}}async stopDataChannels(_e){try{const _t=this.dataStreamChannelMap.get(_e);return _t==null||_t.close(),void this.dataStreamChannelMap.delete(_e)}catch(_t){throw _t instanceof DE?_t:new DE(mE.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(_t.toString()))}}async receive(_e,_t,Wt,_n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(_e," before remoteSDP created."));const{mid:_i,needExchangeSDP:_s}=this.remoteSDP.send(_e,_t,Wt,_n);if(_s){const _u=this.remoteSDP.toString(),_h=this.logSDPExchange(_u,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_u});const _p=await this.peerConnection.createAnswer(),Qm=this.mungReceiveAnswerSDP(_p.sdp,_i,_e);_h==null||_h(Qm||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:Qm}),iE.debug("[NVExtentionsConnection] receive ".concat(_e," by exchanging SDP."))}else iE.debug("[NVExtentionsConnection] receive ".concat(_e," no need to exchange SDP."));const _c=this.peerConnection.getTransceivers().find(_u=>_u.mid===_i);if(!_c)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_c.receiver.track,id:_i}}catch(_i){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(_i.toString()))}}async batchReceive(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:_t,needExchangeSDP:Wt}=this.remoteSDP.batchSend(_e);if(Wt){const _n=this.remoteSDP.toString(),_i=this.logSDPExchange(_n,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_n});const _s=await this.peerConnection.createAnswer();_i==null||_i(_s.sdp||""),await this.peerConnection.setLocalDescription(_s),iE.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else iE.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return _t.map(_n=>{const _i=this.peerConnection.getTransceivers().find(_s=>_s.mid===_n);if(!_i)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_i.receiver.track,id:_n}})}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(_t.toString()))}}async stopReceiving(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(_t.toString()))}}async muteRemote(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(_e," before remote SDP created."));this.remoteSDP.mute(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(_t.toString()))}}async unmuteRemote(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(_e," before remote SDP created."));this.remoteSDP.unmute(_e);const _t=this.remoteSDP.toString(),Wt=this.logSDPExchange(_t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _n=await this.peerConnection.createAnswer();Wt==null||Wt(_n.sdp||""),await this.peerConnection.setLocalDescription(_n)}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(_t.toString()))}}async muteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(_s=>{_s.direction="inactive"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.muteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(_t.toString()))}}async unmuteLocal(_e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const _t=this.peerConnection.getTransceivers().filter(_s=>_s.mid&&_e.indexOf(_s.mid)!==-1);if(_t.length!==_e.length)throw new Error("Transceivers' length doesn't match mids' length.");_t.map(async(_s,_c)=>{_s.direction="sendonly"});const Wt=await this.peerConnection.createOffer(),_n=this.logSDPExchange(Wt.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(Wt),this.remoteSDP.unmuteRemote(_e);const _i=this.remoteSDP.toString();_n==null||_n(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(_t){throw new DE(mE.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(_t.toString()))}}restartICE(_e){var _t=this;return ET(function*(){const Wt=yield k_(_t.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!_t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(B_().supportPCSetConfiguration){const _h=_t.peerConnection.getConfiguration(),_p=_e===BS.RELAY?"relay":"all";_h.iceTransportPolicy!==_p&&(iE.debug("restartICE change iceTransportPolicy from [".concat(_h.iceTransportPolicy,"] to [").concat(_p,"]")),_h.iceTransportPolicy=_p,_t.peerConnection.setConfiguration(_h))}else if(_e===BS.RELAY)return;_e!==BS.RELAY&&_t.remoteSDP.updateCandidates(_e);const _n=yield k_(_t.peerConnection.createOffer({iceRestart:!0}));if(!_n.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=LR(_n.sdp),{remoteIceParameters:_s}=yield _i.iceParameters;_t.remoteSDP.restartICE(_s);const _c=_t.remoteSDP.toString(),_u=_t.logSDPExchange(_n.sdp||"","offer","local","restartICE");yield k_(_t.peerConnection.setLocalDescription(_n)),_u==null||_u(_c),yield k_(_t.peerConnection.setRemoteDescription({type:"answer",sdp:_c}))}catch(_n){iE.warning("restart ICE failed, abort operation",_n)}finally{Wt()}})()}close(){var _e;(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(_e){return this.statsFilter.getVideoIsReady(_e)}async updateEncoderConfig(_e,_t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const Wt=await this.peerConnection.createOffer(),_n=this.mungSendOfferSDP(Wt.sdp,[_t],[_e]);this.remoteSDP.updateRecvMedia(_e,_t);const _i=this.remoteSDP.toString(),_s=this.logSDPExchange(_n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:_n}),_s==null||_s(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(Wt){throw new DE(mE.EXCHANGE_SDP_FAILED,Wt.toString())}}async updateSendParameters(_e,_t){const Wt=this.peerConnection.getTransceivers().filter(_n=>_n.mid===_e);Wt.length===1&&(this.isVP8Simulcast(_t)?h0()||await this.applySimulcastEncodings(Wt,[_t]):await this.applySendEncodings(Wt,[_t]))}setStatsRemoteVideoIsReady(_e,_t){this.statsFilter.setVideoIsReady2(_e,_t)}async replaceTrack(_e,_t){const Wt=this.peerConnection.getTransceivers().find(_n=>_n.mid===_t);Wt&&await Wt.sender.replaceTrack(_e._mediaStreamTrack)}getP2PConnectionParams(){var _e;if((_e=this.peerConnection.currentLocalDescription)===null||_e===void 0||!_e.sdp||!this.localCapabilities)throw new Error;return AM(AM({},LR(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var _e;(_e=this.onICEConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var _e;(_e=this.onConnectionStateChange)===null||_e===void 0||_e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=_e=>{_e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,iE.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,iE.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},yE("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(_e){const _t={iceServers:[]};return _e.iceServers?_t.iceServers=_e.iceServers:_e.turnServer&&_e.turnServer.mode!=="off"&&(IO(_e.turnServer.servers)?_t.iceServers=_e.turnServer.servers:(_t.iceServers&&_t.iceServers.push(...GM.turnServerConfigToIceServers(_e.turnServer.servers)),yE("USE_TURN_SERVER_OF_GATEWAY")&&_t.iceServers&&_e.turnServer.serversFromGateway&&_t.iceServers.push(...GM.turnServerConfigToIceServers(_e.turnServer.serversFromGateway)),yE("FORCE_TURN_TCP")?_t.iceTransportPolicy="relay":_e.turnServer.servers.concat(_e.turnServer.serversFromGateway||[]).forEach(Wt=>{Wt.forceturn&&(_t.iceTransportPolicy="relay")}))),_t}static turnServerConfigToIceServers(_e){const _t=[];return _e.forEach(Wt=>{Wt.security?Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turns:".concat(X1(Wt.turnServerURL),":").concat(Wt.tcpport,"?transport=tcp")}):(Wt.udpport&&!yE("FORCE_TURN_TCP")&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.udpport,"?transport=udp")}),Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.tcpport,"?transport=tcp")}))}),_t}async applySendEncodings(_e,_t){try{if(!B_().supportSetRtpSenderParameters||_e.length!==_t.length)return;for(let Qm=0;Qm<_e.length;Qm++){const _g=_e[Qm],eE=_t[Qm];if(eE&&eE instanceof m0){var Wt,_n,_i;if(this.isVP8Simulcast(eE))continue;const pE={},aE={};switch(eE._optimizationMode){case"motion":pE.degradationPreference="maintain-framerate";break;case"detail":pE.degradationPreference="maintain-resolution";break;default:pE.degradationPreference="balanced"}var _s,_c,_u,_h;if((Wt=eE._encoderConfig)!==null&&Wt!==void 0&&Wt.bitrateMax&&(aE.maxBitrate=1e3*((_s=eE._encoderConfig)===null||_s===void 0?void 0:_s.bitrateMax)),i_(_n=eE._hints).call(_n,S0.LOW_STREAM)&&((_c=eE._encoderConfig)!==null&&_c!==void 0&&_c.frameRate&&(aE.maxFramerate=cT(eE._encoderConfig.frameRate)),(_u=eE._encoderConfig)!==null&&_u!==void 0&&_u.scaleResolutionDownBy&&((_h=eE._encoderConfig)===null||_h===void 0?void 0:_h.scaleResolutionDownBy)>1&&(aE.scaleResolutionDownBy=eE._encoderConfig.scaleResolutionDownBy)),yE("DSCP_TYPE")&&W1()){var _p;const gE=yE("DSCP_TYPE");i_(_p=["very-low","low","medium","high"]).call(_p,gE)&&(aE.networkPriority=gE)}const cE=_g.sender.getParameters(),fE=(_i=cE.encodings)===null||_i===void 0?void 0:_i[0];h0()&&!fE&&(pE.encodings=[aE]),fE&&Object.assign(fE,aE),Object.assign(cE,pE),await _g.sender.setParameters(cE)}}}catch{iE.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(_e,_t,Wt){const _n=N0.parse(_e);return _t.forEach((_i,_s)=>{const _c=Wt[_s],_u=_n.mediaDescriptions.find(_h=>_h.attributes.mid===_c);_u&&(oI(_u,_i),a8(_u,_i,this.store.codec))}),N0.print(_n)}mungReceiveAnswerSDP(_e,_t,Wt){const _n=N0.parse(_e),_i=_n.mediaDescriptions.find(_s=>_s.attributes.mid===_t);return _i&&Wt===h_.AUDIO&&_i.media.mediaType==="audio"&&xR(_i),this.useXR&&_M(_n),N0.print(_n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=_e=>{var _t;(_t=this.onFirstAudioReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoReceived=_e=>{var _t;(_t=this.onFirstVideoReceived)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstAudioDecoded=_e=>{var _t;(_t=this.onFirstAudioDecoded)===null||_t===void 0||_t.call(this,_e)},this.statsFilter.onFirstVideoDecoded=(_e,_t,Wt)=>{var _n;(_n=this.onFirstVideoDecoded)===null||_n===void 0||_n.call(this,_e,_t,Wt)},this.statsFilter.onSelectedLocalCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedLocalCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onSelectedRemoteCandidateChanged=(_e,_t)=>{var Wt;(Wt=this.onSelectedRemoteCandidateChanged)===null||Wt===void 0||Wt.call(this,_e,_t)},this.statsFilter.onFirstVideoDecodedTimeout=_e=>{var _t;(_t=this.onFirstVideoDecodedTimeout)===null||_t===void 0||_t.call(this,_e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(_e,_t){if(_e.length===_t.length)for(let _u=0;_u<_e.length;_u++){var Wt,_n,_i,_s,_c;const _h=_e[_u],_p=_t[_u];if(_p instanceof m0&&!i_(Wt=_p._hints).call(Wt,S0.LOW_STREAM)&&(_n=_p._encoderConfig)!==null&&_n!==void 0&&_n.bitrateMax&&((_i=_p._encoderConfig)===null||_i===void 0?void 0:_i.bitrateMax)>200&&(_s=_p._scalabilityMode)!==null&&_s!==void 0&&_s.numSpatialLayers&&((_c=_p._scalabilityMode)===null||_c===void 0?void 0:_c.numSpatialLayers)>1&&this.store.codec==="vp8"){const Qm={},_g={high:1e3*(_p._encoderConfig.bitrateMax-50),medium:5e4};Qm.encodings=[{rid:"m",active:!0,maxBitrate:_g.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:_g.high}];const eE=_h.sender.getParameters();await _h.sender.setParameters(Object.assign(eE,Qm))}}}async applySimulcastEncodings(_e,_t){if(!h0()&&_e.length===_t.length)for(let Wt=0;Wt<_e.length;Wt++){const _n=_t[Wt];if(_n instanceof m0&&this.isVP8Simulcast(_n)){const _i=_e[Wt],_s={},_c={high:1e3*(_n._encoderConfig.bitrateMax-50),medium:5e4};_s.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:_c.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:_c.medium,scaleResolutionDownBy:4}];const _u=_i.sender.getParameters();await _i.sender.setParameters(Object.assign(_u,_s))}}}isVP8Simulcast(_e){var _t,Wt,_n,_i,_s;return!!(_e instanceof m0&&yE("SIMULCAST")&&this.store.codec==="vp8"&&!i_(_t=_e._hints).call(_t,S0.LOW_STREAM)&&(Wt=_e._encoderConfig)!==null&&Wt!==void 0&&Wt.bitrateMax&&((_n=_e._encoderConfig)===null||_n===void 0?void 0:_n.bitrateMax)>200&&(_i=_e._scalabilityMode)!==null&&_i!==void 0&&_i.numSpatialLayers&&((_s=_e._scalabilityMode)===null||_s===void 0?void 0:_s.numSpatialLayers)>1)}logSDPExchange(_e,_t,Wt,_n){if(yE("SDP_LOGGING"))return iE.upload("exchanging ".concat(Wt," ").concat(_t," SDP during NVExtentionsConnection.").concat(_n,`
`),_e),_t==="offer"?_i=>{this.logSDPExchange(_i,"answer",Wt==="local"?"remote":"local",_n)}:void 0}async getRemoteSSRC(_e){if(!this.remoteSDP)return;const _t=this.remoteSDP.getSSRC(_e);return _t==null?void 0:_t[0].ssrcId}setConfiguration(_e){if(B_().supportPCSetConfiguration){const _t=GM.resolvePCConfiguration(_e);this.peerConnection.setConfiguration(_t)}}},t_(K_.prototype,"connect",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"connect"),K_.prototype),t_(K_.prototype,"updateRemoteRTPCapabilities",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"updateRemoteRTPCapabilities"),K_.prototype),t_(K_.prototype,"updateRemoteConnect",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"updateRemoteConnect"),K_.prototype),t_(K_.prototype,"createDataChannels",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"createDataChannels"),K_.prototype),t_(K_.prototype,"receive",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"receive"),K_.prototype),t_(K_.prototype,"batchReceive",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"batchReceive"),K_.prototype),t_(K_.prototype,"stopReceiving",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"stopReceiving"),K_.prototype),t_(K_.prototype,"muteRemote",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"muteRemote"),K_.prototype),t_(K_.prototype,"unmuteRemote",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"unmuteRemote"),K_.prototype),t_(K_.prototype,"muteLocal",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"muteLocal"),K_.prototype),t_(K_.prototype,"unmuteLocal",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"unmuteLocal"),K_.prototype),t_(K_.prototype,"close",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"close"),K_.prototype),t_(K_.prototype,"updateEncoderConfig",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"updateEncoderConfig"),K_.prototype),t_(K_.prototype,"updateSendParameters",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"updateSendParameters"),K_.prototype),t_(K_.prototype,"replaceTrack",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"replaceTrack"),K_.prototype),t_(K_.prototype,"getRemoteSSRC",[uT],Object.getOwnPropertyDescriptor(K_.prototype,"getRemoteSSRC"),K_.prototype),K_);function uT($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("From NVExtentionsConnection.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}var o0;function pY($){var _e,_t,Wt,_n=2;for(typeof Symbol<"u"&&(_t=J9,Wt=Symbol.iterator);_n--;){if(_t&&(_e=$[_t])!=null)return _e.call($);if(Wt&&(_e=$[Wt])!=null)return new OM(_e.call($));_t="@@asyncIterator",Wt="@@iterator"}throw new TypeError("Object is not async iterable")}function OM($){function _e(_t){if(Object(_t)!==_t)return n_.reject(new TypeError(_t+" is not an object."));var Wt=_t.done;return n_.resolve(_t.value).then(function(_n){return{value:_n,done:Wt}})}return OM=function(_t){this.s=_t,this.n=_t.next},OM.prototype={s:null,n:null,next:function(){return _e(this.n.apply(this.s,arguments))},return:function(_t){var Wt=this.s.return;return Wt===void 0?n_.resolve({value:_t,done:!0}):_e(Wt.apply(this.s,arguments))},throw:function(_t){var Wt=this.s.return;return Wt===void 0?n_.reject(_t):_e(Wt.apply(this.s,arguments))}},new OM($)}let dI=(o0=class HM extends LL{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(_e,_t){super(_e,_t),hE(this,"store",void 0),hE(this,"peerConnection",void 0),hE(this,"cname",void 0),hE(this,"mutex",new mS("DataChannelConnection-mutex")),hE(this,"dataChannel",void 0),hE(this,"_p2pConnection",void 0),hE(this,"establishPromise",void 0),hE(this,"_nvMedia",void 0),this.store=_t,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(HM.resolvePCConfiguration(_e),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new Ohe(_e,_t,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var _e;const _t=(_e=this._nvMedia)===null||_e===void 0?void 0:_e.getLocalRtpCapabilities();return await this._p2pConnection.establish(_t)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(_e,_t,Wt,_n,_i,_s){return this.cname=_s,await this._p2pConnection.connect(_e,_t,Wt,_n,_i,_s),await new n_((_c,_u)=>{const _h=setTimeout(()=>{this.closeSignal(),_u(new DE(mE.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(Wt))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(_h),void _c()},this.dataChannel.onerror=_p=>{this.closeSignal(),_u(_p)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(_e,_t){return this._p2pConnection.updateRemoteRTPCapabilities(_e,_t)}send(_e,_t,Wt){var _n=this;return ET(function*(){const _i=yield k_(_n.mutex.lock("From DataChannelConnection.send"));try{return yield*SM(pY(_n._p2pConnection.send(_e,_t,Wt)))}finally{_i()}})()}async stopSending(_e,_t){return this._p2pConnection.stopSending(_e,_t)}async createDataChannels(_e,_t){return this._p2pConnection.createDataChannels(_e,_t)}async stopDataChannels(_e){return this._p2pConnection.stopDataChannels(_e)}async receive(_e,_t,Wt,_n){return this._nvMedia?(iE.debug("[DataChannelConnection] receive ".concat(_e," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(_e,_t,this.cname)):(iE.debug("[DataChannelConnection] receive ".concat(_e," by WebRTC.")),await this._p2pConnection.receive(_e,_t,Wt,_n))}async batchReceive(_e){return[...await this._p2pConnection.batchReceive(_e)]}async stopReceiving(_e){return await this._p2pConnection.stopReceiving(_e)}async muteRemote(_e){return await this._p2pConnection.muteRemote(_e)}async unmuteRemote(_e){return await this._p2pConnection.unmuteRemote(_e)}async muteLocal(_e){return await this._p2pConnection.muteLocal(_e)}async unmuteLocal(_e){return await this._p2pConnection.unmuteLocal(_e)}restartICE(_e){var _t=this;return ET(function*(){return yield*SM(pY(_t._p2pConnection.restartICE(_e)))})()}close(){var _e;(_e=this._nvMedia)===null||_e===void 0||_e.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(_e){return this._p2pConnection.getRemoteVideoIsReady(_e)}updateRemoteConnect(_e){var _t;(_t=this._nvMedia)===null||_t===void 0||_t.setRemoteRtpCapabilities(_e),this._p2pConnection.updateRemoteConnect(_e)}async updateEncoderConfig(_e,_t){return await this._p2pConnection.updateEncoderConfig(_e,_t)}async updateSendParameters(_e,_t){return await this._p2pConnection.updateSendParameters(_e,_t)}setStatsRemoteVideoIsReady(_e,_t){this._p2pConnection.setStatsRemoteVideoIsReady(_e,_t)}async replaceTrack(_e,_t){return await this._p2pConnection.replaceTrack(_e,_t)}async getRemoteSSRC(_e){return this._p2pConnection.getRemoteSSRC(_e)}logSDPExchange(_e,_t,Wt,_n){if(yE("SDP_LOGGING"))return iE.upload("exchanging ".concat(Wt," ").concat(_t," SDP during DataChannelConnection.").concat(_n,`
`),_e),_t==="offer"?_i=>{this.logSDPExchange(_i,"answer",Wt==="local"?"remote":"local",_n)}:void 0}static resolvePCConfiguration(_e){const _t={iceServers:[]};return _e.iceServers?_t.iceServers=_e.iceServers:_e.turnServer&&_e.turnServer.mode!=="off"&&(IO(_e.turnServer.servers)?_t.iceServers=_e.turnServer.servers:(_t.iceServers&&_t.iceServers.push(...HM.turnServerConfigToIceServers(_e.turnServer.servers)),yE("USE_TURN_SERVER_OF_GATEWAY")&&_t.iceServers&&_e.turnServer.serversFromGateway&&_t.iceServers.push(...HM.turnServerConfigToIceServers(_e.turnServer.serversFromGateway)),yE("FORCE_TURN_TCP")?_t.iceTransportPolicy="relay":_e.turnServer.servers.concat(_e.turnServer.serversFromGateway||[]).forEach(Wt=>{Wt.forceturn&&(_t.iceTransportPolicy="relay")}))),_t}static turnServerConfigToIceServers(_e){const _t=[];return _e.forEach(Wt=>{Wt.security?Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turns:".concat(X1(Wt.turnServerURL),":").concat(Wt.tcpport,"?transport=tcp")}):(Wt.udpport&&!yE("FORCE_TURN_TCP")&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.udpport,"?transport=udp")}),Wt.tcpport&&_t.push({username:Wt.username,credential:Wt.password,credentialType:"password",urls:"turn:".concat(Wt.turnServerURL,":").concat(Wt.tcpport,"?transport=tcp")}))}),_t}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=_e=>{var _t;return(_t=this.onICEConnectionStateChange)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onConnectionStateChange=_e=>{var _t;return(_t=this.onConnectionStateChange)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onDTLSTransportStateChange=_e=>{var _t;return(_t=this.onDTLSTransportStateChange)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onDTLSTransportError=_e=>{var _t;return(_t=this.onDTLSTransportError)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onICETransportStateChange=_e=>{var _t;return(_t=this.onICETransportStateChange)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onFirstAudioReceived=_e=>{var _t;return(_t=this.onFirstAudioReceived)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onFirstVideoReceived=_e=>{var _t;return(_t=this.onFirstVideoReceived)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onFirstAudioDecoded=_e=>{var _t;return(_t=this.onFirstAudioDecoded)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onFirstVideoDecoded=(_e,_t,Wt)=>{var _n;return(_n=this.onFirstVideoDecoded)===null||_n===void 0?void 0:_n.call(this,_e,_t,Wt)},this._p2pConnection.onFirstVideoDecodedTimeout=_e=>{var _t;return(_t=this.onFirstVideoDecodedTimeout)===null||_t===void 0?void 0:_t.call(this,_e)},this._p2pConnection.onSelectedLocalCandidateChanged=(_e,_t)=>{var Wt;return(Wt=this.onSelectedLocalCandidateChanged)===null||Wt===void 0?void 0:Wt.call(this,_e,_t)},this._p2pConnection.onSelectedRemoteCandidateChanged=(_e,_t)=>{var Wt;return(Wt=this.onSelectedRemoteCandidateChanged)===null||Wt===void 0?void 0:Wt.call(this,_e,_t)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(_e){_e.onConnectionStateChange=void 0,_e.onICEConnectionStateChange=void 0,_e.onICETransportStateChange=void 0,_e.onDTLSTransportStateChange=void 0,_e.onDTLSTransportError=void 0,_e.onFirstAudioDecoded=void 0,_e.onFirstAudioReceived=void 0,_e.onFirstVideoDecoded=void 0,_e.onFirstVideoReceived=void 0,_e.onSelectedLocalCandidateChanged=void 0,_e.onSelectedRemoteCandidateChanged=void 0,_e.onFirstVideoDecodedTimeout=void 0}setConfiguration(_e){this._p2pConnection.setConfiguration(_e)}},t_(o0.prototype,"connect",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"connect"),o0.prototype),t_(o0.prototype,"updateRemoteRTPCapabilities",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"updateRemoteRTPCapabilities"),o0.prototype),t_(o0.prototype,"createDataChannels",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"createDataChannels"),o0.prototype),t_(o0.prototype,"receive",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"receive"),o0.prototype),t_(o0.prototype,"stopReceiving",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"stopReceiving"),o0.prototype),t_(o0.prototype,"muteRemote",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"muteRemote"),o0.prototype),t_(o0.prototype,"unmuteRemote",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"unmuteRemote"),o0.prototype),t_(o0.prototype,"muteLocal",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"muteLocal"),o0.prototype),t_(o0.prototype,"unmuteLocal",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"unmuteLocal"),o0.prototype),t_(o0.prototype,"close",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"close"),o0.prototype),t_(o0.prototype,"updateEncoderConfig",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"updateEncoderConfig"),o0.prototype),t_(o0.prototype,"updateSendParameters",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"updateSendParameters"),o0.prototype),t_(o0.prototype,"replaceTrack",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"replaceTrack"),o0.prototype),t_(o0.prototype,"getRemoteSSRC",[LT],Object.getOwnPropertyDescriptor(o0.prototype,"getRemoteSSRC"),o0.prototype),o0);function LT($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("From DataChannelConnection.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}var D_;function fY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function c1($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?fY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):fY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}function mY($){var _e,_t,Wt,_n=2;for(typeof Symbol<"u"&&(_t=J9,Wt=Symbol.iterator);_n--;){if(_t&&(_e=$[_t])!=null)return _e.call($);if(Wt&&(_e=$[Wt])!=null)return new NM(_e.call($));_t="@@asyncIterator",Wt="@@iterator"}throw new TypeError("Object is not async iterable")}function NM($){function _e(_t){if(Object(_t)!==_t)return n_.reject(new TypeError(_t+" is not an object."));var Wt=_t.done;return n_.resolve(_t.value).then(function(_n){return{value:_n,done:Wt}})}return NM=function(_t){this.s=_t,this.n=_t.next},NM.prototype={s:null,n:null,next:function(){return _e(this.n.apply(this.s,arguments))},return:function(_t){var Wt=this.s.return;return Wt===void 0?n_.resolve({value:_t,done:!0}):_e(Wt.apply(this.s,arguments))},throw:function(_t){var Wt=this.s.return;return Wt===void 0?n_.reject(_t):_e(Wt.apply(this.s,arguments))}},new NM($)}let PM=(D_=class extends A0{get state(){return this._state}set state($){const _e=this._state;this._state=$,this.emit(y_.StateChange,_e,this._state)}constructor($,_e){super(),hE(this,"store",void 0),hE(this,"statsUploader",void 0),hE(this,"connection",void 0),hE(this,"localTrackMap",new Map),hE(this,"remoteUserMap",new Map),hE(this,"localDataChannels",[]),hE(this,"remoteDataChannelMap",new Map),hE(this,"pendingLocalTracks",[]),hE(this,"pendingRemoteTracks",[]),hE(this,"pendingLocalDataChannels",[]),hE(this,"pendingRemoteDataChannels",[]),hE(this,"statsCollector",void 0),hE(this,"isPlanB",!1),hE(this,"shouldForwardP2PCreation",void 0),hE(this,"iceFailedCount",0),hE(this,"dtlsFailedCount",0),hE(this,"mutex",new mS("P2PChannel-mutex")),hE(this,"_state",i0.Disconnected),hE(this,"_pcStatsUploadType",yE("NEW_ICE_RESTART")?y1.FIRST_CONNECTION:y1.OLD_FIRST_CONNECTION),hE(this,"_isInRestartIce",!1),hE(this,"_isStartRestartIce",!1),hE(this,"_restartStates",["disconnected","failed"]),hE(this,"_restartTimer",void 0),hE(this,"_isFirstConnected",!0),hE(this,"handleMuteLocalTrack",async(_t,Wt,_n)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==i0.Connected)return void _n(new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const _s=this.filterTobeMutedTracks(_t);if(_s.length===0)return void Wt();const _c=_s.find(_h=>_h[0]==="videoLowTrack");_c&&_c[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(_s.map(_h=>{let[,{id:_p}]=_h;return _p}));const _u=this.createMuteMessage(_s);await p0(this,y_.RequestMuteLocal,_u),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleUnmuteLocalTrack",async(_t,Wt,_n)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==i0.Connected)return void _n(new HE(mE.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const _s=this.filterTobeUnmutedTracks(_t);if(_s.length===0)return void Wt();const _c=_s.find(_h=>_h[0]==="videoLowTrack");if(_c){const _h=_c[1];if(_h.track._originMediaStreamTrack.stop(),!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding){const _p=_t._mediaStreamTrack.clone();_h.track._mediaStreamTrack=_p,_h.track._originMediaStreamTrack=_p}else{const _p=u8(_t,OI(this,y_.RequestLowStreamParameter));_h.track._mediaStreamTrack=_p,_h.track._originMediaStreamTrack=_p}await new n_((_p,Qm)=>{this.handleReplaceTrack(_h.track,_p,Qm,!0)})}await this.connection.unmuteLocal(_s.map(_h=>{let[,{id:_p}]=_h;return _p}));const _u=this.createUnmuteMessage(_s);await p0(this,y_.RequestUnmuteLocal,_u),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleUpdateVideoEncoder",async(_t,Wt,_n)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const _s=this.localTrackMap.get(XE.LocalVideoTrack);if(!this.connection||!_s||_s.track!==_t||this.state!==i0.Connected)return void Wt();const{id:_c,track:_u}=_s;await this.connection.updateSendParameters(_c,_u),await this.connection.updateEncoderConfig(_c,_u),this.emit(y_.UpdateVideoEncoder,_u),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleUpdateVideoSendParameters",async(_t,Wt,_n)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const _s=this.localTrackMap.get(XE.LocalVideoTrack);if(!this.connection||!_s||_s.track!==_t||this.state!==i0.Connected)return void Wt();const{id:_c,track:_u}=_s;await this.connection.updateSendParameters(_c,_u),Wt()}catch(_s){_n(_s)}finally{_i()}}),hE(this,"handleReplaceMixingTrack",async(_t,Wt,_n,_i)=>{if(!this.connection||this.state!==i0.Connected)return void Wt();const _s=h8([_t]);let _c;iE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(_s.getTrackId(),"]")),typeof _i=="boolean"&&_i||(_c=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(_t,_s),Wt()}catch(_h){_n(_h)}finally{var _u;(_u=_c)===null||_u===void 0||_u()}}),hE(this,"handleReplaceTrack",async(_t,Wt,_n,_i)=>{let _s;iE.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(_t.getTrackId(),"]")),typeof _i=="boolean"&&_i||(_s=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var _c;const _h=Array.from(this.localTrackMap.entries()).find(_p=>{let[,{track:Qm}]=_p;return _t===Qm});if(!this.connection||!_h||this.state!==i0.Connected)return void Wt();if(await((_c=this.connection)===null||_c===void 0?void 0:_c.replaceTrack(_t,_h[1].id)),this.isPlanB){const _p=_h[1];_p.id=_t._mediaStreamTrack.id,this.localTrackMap.set(_h[0],_p)}if(_h[0]===XE.LocalVideoTrack&&!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding){const _p=this.localTrackMap.get(XE.LocalVideoLowTrack);if(_p){const Qm=_t._mediaStreamTrack.clone();_p.track._originMediaStreamTrack.stop(),_p.track._mediaStreamTrack=Qm,_p.track._originMediaStreamTrack=Qm,await new n_((_g,eE)=>{this.handleReplaceTrack(_p.track,_g,eE,!0)})}}Wt()}catch(_h){_n(_h)}finally{var _u;(_u=_s)===null||_u===void 0||_u()}}),hE(this,"handleGetRTCStats",_t=>{_t(this.statsCollector.getRTCStats())}),hE(this,"handleGetLocalVideoStats",_t=>{_t(this.statsCollector.getLocalVideoTrackStats())}),hE(this,"handleGetLocalAudioStats",_t=>{_t(this.statsCollector.getLocalAudioTrackStats())}),hE(this,"handleGetRemoteVideoStats",_t=>this.statsCollector.getRemoteVideoTrackStats(_t.uid)[_t.uid]),hE(this,"handleGetRemoteAudioStats",_t=>this.statsCollector.getRemoteAudioTrackStats(_t.uid)[_t.uid]),this.store=$,this.statsCollector=_e,this.statsCollector.addP2PChannel(this),this.statsUploader=new k9(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!B_().supportUnifiedPlan||yE("CHROME_FORCE_PLAN_B")&&W1(),this.shouldForwardP2PCreation=yE("FORWARD_P2P_CREATION")&&B_().supportPCSetConfiguration&&gV(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new dI({},this.store):this.isPlanB?new cN({},this.store):new jR({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection($,_e){var _t;this.state=i0.New;const Wt=this.shouldForwardP2PCreation&&((_t=this.connection)===null||_t===void 0?void 0:_t.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!Wt||(Wt&&this.connection&&(iE.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new dI($,this.store):this.isPlanB?new cN($,this.store):new jR($,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=yE("NEW_ICE_RESTART")?y1.FIRST_CONNECTION:y1.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration($),this.connection.establishPromise}async connect($,_e,_t,Wt,_n,_i){if(!this.connection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof dI?this.connection.updateRemoteConnect(Wt):(this.store.peerConnectionStart(),await this.connection.connect($,_e,_t,Wt,_n,_i),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=i0.Connected)}updateRemoteRTPCapabilities($){const _e=Array.from(this.localTrackMap.entries()).filter(_n=>{var _i;let[_s]=_n;return i_(_i=[XE.LocalVideoLowTrack,XE.LocalVideoTrack]).call(_i,_s)}),_t=_e.map(_n=>{let[,{id:_i}]=_n;return _i}),Wt=_e.map(_n=>{let[_i]=_n;return _i});if(this.connection instanceof jR){if(p_.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(Wt),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify($)}),!i_($).call($,this.store.codec)){const _n=["vp9","vp8","h264"].find(_i=>i_($).call($,_i));_n&&(this.store.codec=_n,iE.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(_n,".")))}this.connection.updateRemoteRTPCapabilities(_t,$)}}async preConnect($,_e,_t,Wt,_n,_i){if(!this.connection)throw new HE(mE.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const _s=await this.connection.connect($,_e,_t,Wt,_n,_i);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=i0.Connected,_s}getEstablishParams(){if(this.connection instanceof dI)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel($){if(!this.connection||this.state!==i0.Connected){if(this.state===i0.Disconnected)throw new HE(mE.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return void $.forEach(_t=>{var Wt;i_(Wt=this.pendingLocalDataChannels).call(Wt,_t)||this.pendingLocalDataChannels.push(_t)})}const _e=this.filterTobePublishedDataChannels($);_e.length!==0&&(_e.forEach(_t=>{const Wt=Date.now();this.store.publish(_t.id.toString(),"datachannel",Wt)}),await this.connection.createDataChannels(this.store.uid,_e),_e.forEach(_t=>{this.localDataChannels.push(_t);const Wt=Date.now();this.store.publish(_t.id+"","datachannel",void 0,Wt)}))}publish($,_e,_t){var Wt=this;return ET(function*(){const _n=yield k_(Wt.mutex.lock("From P2PChannel.publish"));try{if(!Wt.connection||Wt.state!==i0.Connected){if(Wt.state===i0.Disconnected)throw new HE(mE.UNEXPECTED_ERROR,"PeerConnection already disconnected.");Wt.throwIfTrackTypeNotMatch($);const _s=$.filter(_c=>Wt.pendingLocalTracks.indexOf(_c)===-1);return void(Wt.pendingLocalTracks=Wt.pendingLocalTracks.concat(_s))}Wt.store.pubId=Wt.store.pubId+1,DS.markPublishStart(Wt.store.clientId,Wt.store.pubId);const _i=Wt.filterTobePublishedTracks($,_e,_t);if(_i.length===0)return void(yield k_(Wt.tryToUnmuteAudio($)));yield*SM(mY(Wt.doPublish(Wt.connection,_i)))}finally{_n()}})()}doPublish($,_e){var _t=this;return ET(function*(){_e.forEach(Qm=>{let{track:_g,type:eE}=Qm;const pE=Date.now();_t.store.publish(_g.getTrackId(),eE===XE.LocalAudioTrack?"audio":"video",pE)}),_t.bindLocalTrackEvents(_e);const Wt=_e.map(Qm=>{let{track:_g}=Qm;return _g}),_n=yield k_($.send(_e.map(Qm=>{let{track:_g}=Qm;return _g}),_t.store.codec,_t.store.audioCodec)),_i=(yield k_(_n.next())).value,_s=_t.createGatewayPublishMessage(_e,_i);let _c;try{_c=yield _s}catch(Qm){throw _n.throw(Qm),(Qm==null?void 0:Qm.code)===mE.WS_ABORT&&_e.forEach(_g=>{let{track:eE}=_g;_t.pendingLocalTracks.indexOf(eE)===-1&&_t.pendingLocalTracks.push(eE)}),_t.unbindLocalTrackEvents(_e),Qm}const _u=_t.mapPubResToRemoteConfig(_s,_c),_h=(yield k_(_n.next(_u))).value,_p=yE("ENABLE_VIDEO_SEI");Wt.forEach(async Qm=>{const _g=Qm.getRTCRtpTransceiver();_g&&_p&&(Qm.trackMediaType===h_.VIDEO?await the(_g.sender,Qm):Qm.trackMediaType===h_.AUDIO&&await async function(eE){if(!B_().supportWebRTCEncodedTransform)return void iE.warning("browser not support audio encoded transform");if(pM.has(eE)||!eE.track)return;const pE={track:eE.track};if(H1()){if(!eE.createEncodedStreams)return void iE.warning("browser not support createEncodedStreams() API");let cE=null;try{cE=eE.createEncodedStreams()}catch(gE){return void iE.error("create audio-encoded-streams error",gE&&gE.message)}const fE=new TransformStream({transform(gE,AE){pE.controller||(pE.controller=AE),eE.track&&eE.track.id!==pE.track.id&&(iE.debug("audio track changed: ".concat(pE.track.id," => ").concat(eE.track.id)),pE.track.removeEventListener("ended",aE),pE.track=eE.track,pE.track.addEventListener("ended",aE)),AE.enqueue(gE)}});cE.readable.pipeThrough(fE).pipeTo(cE.writable)}else if(dS()){if(typeof RTCRtpScriptTransform>"u")return void iE.warning("browser not support RTCRtpScriptTransform");const cE=hM(),fE=new MessageChannel;await new n_(AE=>cE.onmessage=PE=>{PE.data==="registered"&&AE(void 0)});const gE=new RTCRtpScriptTransform(cE,{name:"tx",port:fE.port2},[fE.port2]);eE.transform=gE,await new n_(AE=>cE.onmessage=PE=>{PE.data==="started"&&AE(void 0)}),fE.port1.onmessage=AE=>{var PE;AE.data.transformed&&eE.track&&((PE=eE.track)===null||PE===void 0?void 0:PE.id)!==pE.track.id&&(iE.debug("audio track changed: ".concat(pE.track.id," => ").concat(eE.track.id)),pE.track.removeEventListener("ended",aE),pE.track=eE.track,pE.track.addEventListener("ended",aE))},pE.worker=cE}function aE(){if(eE.track){if(this.id!==eE.track.id)return;eE.track.removeEventListener("ended",aE)}const cE=pM.get(eE);if(cE){pM.delete(eE);try{var fE,gE;(fE=cE.controller)===null||fE===void 0||fE.terminate(),(gE=cE.worker)===null||gE===void 0||gE.terminate()}catch(AE){iE.warning(AE&&AE.message)}}}pM.set(eE,pE),eE.track.addEventListener("ended",aE)}(_g.sender))}),_e.forEach(Qm=>{let{type:_g}=Qm;_t.statsCollector.addLocalStats(_g)}),_t.assignLocalTracks(_e,_h),_t.statsUploader.startUploadOutboundStats(),_e.forEach(Qm=>{let{track:_g,type:eE}=Qm;const pE=Date.now();_t.store.publish(_g.getTrackId(),eE===XE.LocalAudioTrack?"audio":"video",void 0,pE)})})()}async updateVideoStreamParameter($,_e){const _t=this.localTrackMap.get(_e);if(!_t)return;if(!(_t.track instanceof m0))return iE.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof jR||this.connection instanceof cN))return iE.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:Wt}=_t,_n=function(_i,_s){const _c={};return _i.height&&_i.width&&(_c.scaleResolutionDownBy=BV(_i,_s)),_c.maxFramerate=_i.framerate?cT(_i.framerate):void 0,_c.maxBitrate=_i.bitrate?1e3*_i.bitrate:void 0,_c}($,Wt);if(Wt._encoderConfig||(Wt._encoderConfig={}),_e!==XE.LocalVideoLowTrack||!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding)_n.scaleResolutionDownBy!=null&&(Wt._encoderConfig.scaleResolutionDownBy=_n.scaleResolutionDownBy);else{const _i=Wt._originMediaStreamTrack;if(!_i.canvas)return iE.warn("[".concat(Wt.getTrackId(),"] no canvas on track"));(function(_s,_c){const _u=_s.canvas;_c.width&&(_u.width=cT(_c.width)),_c.height&&(_u.height=cT(_c.height)),_c.framerate&&(_u.stopCapture&&_u.stopCapture(),_u.stopCapture=z6(()=>{!_u.startCapture&&_u.stopCapture&&_u.stopCapture(),_u.startCapture&&_u.startCapture()},cT(_c.framerate)))})(_i,$)}_n.maxBitrate!=null&&(Wt._encoderConfig.bitrateMax=_n.maxBitrate/1e3),_n.maxFramerate!=null&&(Wt._encoderConfig.frameRate&&typeof Wt._encoderConfig.frameRate=="object"?Wt._encoderConfig.frameRate.max=_n.maxFramerate:Wt._encoderConfig.frameRate={max:_n.maxFramerate}),iE.debug("[".concat(Wt.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(Wt._encoderConfig))),await this.connection.updateRtpSenderEncodings(Wt)}publishLowStream($){var _e=this;return ET(function*(){if(!_e.connection||_e.state!==i0.Connected)return;const _t=yield k_(_e.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const _n=_e.localTrackMap.get(XE.LocalVideoTrack);if(!_n)throw new HE(mE.UNEXPECTED_ERROR,"Could not find high stream");if(_e.localTrackMap.has(XE.LocalVideoLowTrack))throw new HE(mE.UNEXPECTED_ERROR,"[".concat(_e.store.clientId,"] Can't publish low stream when stream already publish"));const _i=[{track:_e.getLowVideoTrack(_n.track,$),type:XE.LocalVideoLowTrack}];if(yield*SM(mY(_e.doPublish(_e.connection,_i))),_n.track.muted||!_n.track.enabled){var Wt;const _s=(Wt=_e.localTrackMap.get(XE.LocalVideoLowTrack))===null||Wt===void 0?void 0:Wt.id;_s!==void 0&&(yield k_(_e.connection.muteLocal([_s])))}}finally{_t()}})()}async republish(){this.pendingLocalTracks.length>0&&(iE.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await _y(this,y_.RequestRePublish,this.pendingLocalTracks),this.emit(y_.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(iE.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await _y(this,y_.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe($){for(let _e=this.pendingRemoteTracks.length-1;_e>=0;_e--){const{user:_t,kind:Wt}=this.pendingRemoteTracks[_e];(Wt!==h_.AUDIO||_t._audio_added_&&_t._audioSSRC)&&(Wt!==h_.VIDEO||_t._video_added_&&_t._videoSSRC)||this.pendingRemoteTracks.splice(_e,1)}if($)await _y(this,y_.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:_e,kind:_t}of this.pendingRemoteTracks)await this.subscribe(_e,_t,_t===h_.VIDEO?_e._videoSSRC:_e._audioSSRC);this.pendingRemoteTracks.forEach(_e=>{let{user:_t}=_e;this.emit(y_.MediaReconnectEnd,_t.uid)}),this.pendingRemoteTracks=[]}async unpublish($){if(!this.connection||this.state!==i0.Connected)return void $.forEach(Wt=>{const _n=this.pendingLocalTracks.indexOf(Wt);_n!==-1&&this.pendingLocalTracks.splice(_n,1)});const _e=this.filterTobeUnpublishedTracks($);if(_e.length===0)return;const _t=_e.find(Wt=>Wt[0]==="videoLowTrack");return _t&&_t[1].track.close(),this.doUnpublish(this.connection,_e)}async unpublishDataChannel($){if(!this.connection||this.state!==i0.Connected)return void $.forEach(_t=>{const Wt=this.pendingLocalDataChannels.indexOf(_t);Wt!==-1&&this.pendingLocalDataChannels.splice(Wt,1)});const _e=this.filterTobeUnpublishedDataChannels($);return _e.length!==0?(_e.forEach(_t=>{const Wt=this.localDataChannels.indexOf(_t);Wt!==-1&&this.localDataChannels.splice(Wt,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),_e.map(_t=>_t.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==i0.Connected)return;const $=this.localTrackMap.get(XE.LocalVideoLowTrack);if(!$)return;$.track.close();const _e=[[XE.LocalVideoLowTrack,$]];return this.doUnpublish(this.connection,_e)}async doUnpublish($,_e){const _t=this.createGatewayUnpublishMessage(_e);return await $.stopSending(_e.map(Wt=>{let[,{id:_n}]=Wt;return _n})),this.withdrawLocalTracks(_e),this.unbindLocalTrackEvents(_e.map(Wt=>{let[_n,{track:_i}]=Wt;return{type:_n,track:_i}})),_e.forEach(Wt=>{let[_n]=Wt;this.statsCollector.removeLocalStats(_n)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),_t}async subscribeDataChannel($,_e){if(!this.connection||this.state!==i0.Connected)throw new HE(mE.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const _t=_e.filter(Wt=>{var _n;return!((_n=this.remoteDataChannelMap.get($))!==null&&_n!==void 0&&_n.get(Wt.id))});if(_t.length!==0)return await this.connection.createDataChannels($.uid,_t),_t.forEach(Wt=>{var _n;this.remoteDataChannelMap.has($)?(_n=this.remoteDataChannelMap.get($))===null||_n===void 0||_n.set(Wt.id,Wt):this.remoteDataChannelMap.set($,new Map([[Wt.id,Wt]]));const _i=this.pendingRemoteDataChannels.findIndex(_s=>{let{user:_c,id:_u}=_s;return _c.uid===$.uid&&_u===Wt.id});_i!==-1&&this.pendingRemoteDataChannels.splice(_i,1)}),_t.map(Wt=>Wt.id)}async subscribe($,_e,_t,Wt,_n){var _i;if(!this.connection||this.state!==i0.Connected)throw new HE(mE.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((_i=this.remoteUserMap.get($))!==null&&_i!==void 0&&_i.has(_e))return;let _s,_c,_u;if(_n){const Qm=_n.find(eE=>{let{stream_type:pE}=eE;return pE===_e});if(!Qm)throw new HE(mE.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(_e," for user: ").concat($.uid," because subscribe answer from gateway does not contain stream_type: ").concat(_e,"."));const _g=await this.connection.receive(_e,Qm.ssrcs,String($._uintid),Qm.attributes);this.connection instanceof jR&&(_u=_g.transceiver),_s=_g.track,_c=_g.id}else{const Qm=await this.connection.receive(_e,[{ssrcId:_t,rtx:Wt}],String($._uintid),void 0);this.connection instanceof jR&&(_u=Qm.transceiver),_s=Qm.track,_c=Qm.id}_e===h_.AUDIO?($._audioTrack?$._audioTrack._updateOriginMediaStreamTrack(_s):($._audioTrack=new oN(_s,$.uid,$._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat($._audioTrack.getTrackId()))),_u&&$._audioTrack._updateRtpTransceiver(_u),this.bindRemoteTrackEvents($,$._audioTrack)):($._videoTrack?$._videoTrack._updateOriginMediaStreamTrack(_s):($._videoTrack=new iN(_s,$.uid,$._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat($._videoTrack.getTrackId()))),_u&&$._videoTrack._updateRtpTransceiver(_u),this.bindRemoteTrackEvents($,$._videoTrack)),yE("ENABLE_VIDEO_SEI")&&_u&&(_e==h_.VIDEO?await nhe(_u.receiver,{onSei:Qm=>{var _g;(_g=$._videoTrack)===null||_g===void 0||_g._onSei(Qm)}}):_e==h_.AUDIO&&await async function(Qm){if(!B_().supportWebRTCEncodedTransform)return void iE.warning("browser not support audio encoded transform");if(fM.has(Qm))return;const _g={track:Qm.track};if(H1()){if(!Qm.createEncodedStreams)return void iE.warning("browser not support createEncodedStreams() API");let pE=null;try{pE=Qm.createEncodedStreams()}catch(cE){return void iE.error("create audio-encoded-streams error",cE&&cE.message)}const aE=new TransformStream({transform(cE,fE){_g.controller||(_g.controller=fE),Qm.track&&Qm.track.id!==_g.track.id&&(iE.debug("audio track changed: ".concat(_g.track.id," => ").concat(Qm.track.id)),_g.track.removeEventListener("ended",eE),_g.track=Qm.track,_g.track.addEventListener("ended",eE)),fE.enqueue(cE)}});pE.readable.pipeThrough(aE).pipeTo(pE.writable)}else if(dS()){if(typeof RTCRtpScriptTransform>"u")return void iE.warning("browser not support RTCRtpScriptTransform");const pE=hM(),aE=new MessageChannel;await new n_(fE=>pE.onmessage=gE=>{gE.data==="registered"&&fE(void 0)});const cE=new RTCRtpScriptTransform(pE,{name:"rx",port:aE.port2},[aE.port2]);Qm.transform=cE,await new n_(fE=>pE.onmessage=gE=>{gE.data==="started"&&fE(void 0)}),aE.port1.onmessage=fE=>{var gE;fE.data.transformed&&Qm.track&&((gE=Qm.track)===null||gE===void 0?void 0:gE.id)!==_g.track.id&&(iE.debug("audio track changed: ".concat(_g.track.id," => ").concat(Qm.track.id)),_g.track.removeEventListener("ended",eE),_g.track=Qm.track,_g.track.addEventListener("ended",eE))},_g.worker=pE}function eE(){Qm.track.removeEventListener("ended",eE),function(pE){const aE=fM.get(pE);if(aE){fM.delete(pE);try{var cE,fE;(cE=aE.controller)===null||cE===void 0||cE.terminate(),(fE=aE.worker)===null||fE===void 0||fE.terminate()}catch(gE){iE.warning(gE&&gE.message)}}}(Qm)}fM.set(Qm,_g),Qm.track.addEventListener("ended",eE)}(_u.receiver));const _h=this.remoteUserMap.get($);_h?_h.set(_e,_c):this.remoteUserMap.set($,new Map([[_e,_c]])),this.statsCollector.addRemoteStats($.uid),this.statsUploader.startUploadInboundStats();const _p=this.pendingRemoteTracks.findIndex(Qm=>{let{user:_g,kind:eE}=Qm;return _g.uid===$.uid&&_e===eE});_p!==-1&&(this.pendingRemoteTracks.splice(_p,1),this.emit(y_.MediaReconnectEnd,$.uid))}async massSubscribe($){return this.massSubscribeNoLock($)}async massSubscribeNoLock($){if(!this.connection||this.state!==i0.Connected)throw new HE(mE.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");$=$.filter(_t=>{var Wt;let{user:_n,mediaType:_i}=_t;return!((Wt=this.remoteUserMap.get(_n))!==null&&Wt!==void 0&&Wt.has(_i))});const _e=await this.connection.batchReceive($.map(_t=>{let{user:Wt,mediaType:_n,ssrcId:_i,rtxSsrcId:_s}=_t;return{kind:_n,ssrcMsg:[{ssrcId:_i,rtx:_s}],mslabel:String(Wt._uintid)}}));$.forEach((_t,Wt)=>{let{user:_n,mediaType:_i}=_t;const{track:_s,id:_c,transceiver:_u}=_e[Wt];_i===h_.AUDIO?(_n._audioTrack?_n._audioTrack._updateOriginMediaStreamTrack(_s):(_n._audioTrack=new oN(_s,_n.uid,_n._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(_n._audioTrack.getTrackId()))),_u&&_n._audioTrack._updateRtpTransceiver(_u),this.bindRemoteTrackEvents(_n,_n._audioTrack)):(_n._videoTrack?_n._videoTrack._updateOriginMediaStreamTrack(_s):(_n._videoTrack=new iN(_s,_n.uid,_n._uintid,this.store),iE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(_n._videoTrack.getTrackId()))),_u&&_n._videoTrack._updateRtpTransceiver(_u),this.bindRemoteTrackEvents(_n,_n._videoTrack));const _h=this.remoteUserMap.get(_n);_h?_h.set(_i,_c):this.remoteUserMap.set(_n,new Map([[_i,_c]])),this.statsCollector.addRemoteStats(_n.uid),this.statsUploader.startUploadInboundStats();const _p=this.pendingRemoteTracks.findIndex(Qm=>{let{user:_g,kind:eE}=Qm;return _g.uid===_n.uid&&_i===eE});_p!==-1&&(this.pendingRemoteTracks.splice(_p,1),this.emit(y_.MediaReconnectEnd,_n.uid))})}async unsubscribe($,_e,_t){const Wt=this.pendingRemoteTracks.filter(_s=>{let{user:_c,kind:_u}=_s;return _e!==void 0?_c.uid===$.uid&&_e===_u:_c.uid===$.uid});if(Wt.forEach(_s=>{const _c=this.pendingRemoteTracks.indexOf(_s);this.pendingRemoteTracks.splice(_c,1)}),this.connection&&this.state===i0.Connected||_t||Wt.forEach(_s=>{let{kind:_c}=_s;var _u;if(_c===h_.AUDIO)(_u=$._audioTrack)===null||_u===void 0||_u._destroy(),$._audioTrack=void 0;else if(_c===h_.VIDEO){var _h;(_h=$._videoTrack)===null||_h===void 0||_h._destroy(),$._videoTrack=void 0}}),!this.connection||this.state!==i0.Connected)return;const _n=this.filterTobeUnSubscribedTracks($,_e);if(_n.length===0)return;await this.connection.stopReceiving(_n.map(_s=>{let[,{id:_c}]=_s;return _c}));const _i=this.createUnsubscribeMessage(_n);return this.withdrawRemoteTracks(_n),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),_n.forEach(_s=>{let[_c,{kind:_u}]=_s;var _h,_p;if(_u===h_.VIDEO&&_c._videoSSRC&&((_h=this.connection)===null||_h===void 0||_h.setStatsRemoteVideoIsReady(_c._videoSSRC,!1)),_u===h_.VIDEO)this.unbindRemoteTrackEvents(_c._videoTrack),_t||((_p=_c._videoTrack)===null||_p===void 0||_p._destroy(),_c._videoTrack=void 0);else if(_u===h_.AUDIO){var Qm;this.unbindRemoteTrackEvents(_c._audioTrack),!_t&&((Qm=_c._audioTrack)===null||Qm===void 0||Qm._destroy(),_c._audioTrack=void 0)}}),_i}async unsubscribeDataChannel($,_e){if(_e.forEach(_n=>{const _i=this.pendingRemoteDataChannels.findIndex(_s=>_s.id===_n.id);_i!==-1&&this.pendingRemoteDataChannels.splice(_i,1)}),!this.connection)return;const _t=this.filterTobeUnSubscribedDataChannels($,_e);if(_t.length===0)return;_e.forEach(_n=>{_n._close()});const Wt=this.remoteDataChannelMap.get($);return _t.forEach(_n=>{Wt&&Wt.delete(_n.id)}),Wt&&Wt.size===0&&(this.remoteDataChannelMap.delete($),await this.connection.stopDataChannels($.uid)),_t.map(_n=>_n.id)}async massUnsubscribe($){return this.massUnsubscribeNoLock($)}async massUnsubscribeNoLock($){let _e=[];for(const{user:_n,mediaType:_i}of $){const _s=this.pendingRemoteTracks.filter(_c=>{let{user:_u,kind:_h}=_c;return _i!==void 0?_u.uid===_n.uid&&_i===_h:_u.uid===_n.uid});_s.forEach(_c=>{const _u=this.pendingRemoteTracks.indexOf(_c);this.pendingRemoteTracks.splice(_u,1)}),_e=_e.concat(_s)}if(!this.connection||this.state!==i0.Connected)return void _e.forEach(_n=>{let{user:_i,kind:_s}=_n;var _c;if(_s===h_.AUDIO)(_c=_i._audioTrack)===null||_c===void 0||_c._destroy(),_i._audioTrack=void 0;else if(_s===h_.VIDEO){var _u;(_u=_i._videoTrack)===null||_u===void 0||_u._destroy(),_i._videoTrack=void 0}});const _t=wR($).call($,(_n,_i)=>{let{user:_s,mediaType:_c}=_i;const _u=this.filterTobeUnSubscribedTracks(_s,_c);return _n.concat(_u)},[]);if(_t.length===0)return;await this.connection.stopReceiving(_t.map(_n=>{let[,{id:_i}]=_n;return _i}));const Wt=this.createUnsubscribeAllMessage(_t);return this.withdrawRemoteTracks(_t),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),_t.forEach(_n=>{let[_i,{kind:_s}]=_n;var _c,_u;if(_s===h_.VIDEO&&_i._videoSSRC&&((_c=this.connection)===null||_c===void 0||_c.setStatsRemoteVideoIsReady(_i._videoSSRC,!1)),_s===h_.VIDEO)this.unbindRemoteTrackEvents(_i._videoTrack),(_u=_i._videoTrack)===null||_u===void 0||_u._destroy(),_i._videoTrack=void 0;else if(_s===h_.AUDIO){var _h;this.unbindRemoteTrackEvents(_i._audioTrack),(_h=_i._audioTrack)===null||_h===void 0||_h._destroy(),_i._audioTrack=void 0}}),Wt}async muteRemote($,_e){if(!this.connection)return;const _t=this.remoteUserMap.get($);if(!_t)return void iE.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat($.uid,"."));if(!_t.get(_e))return void iE.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat($.uid," media type ").concat(_e,"."));const Wt=_e===h_.VIDEO?$._videoSSRC:$._audioSSRC;Wt!==void 0&&this.connection.setStatsRemoteVideoIsReady(Wt,!1)}async unmuteRemote($,_e){return this.unmuteRemoteNoLock($,_e)}async unmuteRemoteNoLock($,_e){if(!this.connection)return;const _t=this.remoteUserMap.get($);if(!_t)return void iE.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat($.uid,"."));_t.get(_e)||iE.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat($.uid," media type ").concat(_e,"."))}getAllTracks($){const _e=this.localTrackMap.get(XE.LocalAudioTrack);if((_e==null?void 0:_e.track)instanceof iS){const _t=_e.track;return Array.from(this.localTrackMap.entries()).filter(Wt=>{let[_n]=Wt;return _n!==XE.LocalAudioTrack}).filter(Wt=>{let[_n]=Wt;return!($&&_n===XE.LocalVideoLowTrack)}).map(Wt=>{let[,{track:_n}]=Wt;return _n}).concat(_t.trackList)}return Array.from(this.localTrackMap.entries()).filter(_t=>{let[Wt]=_t;return!($&&Wt===XE.LocalVideoLowTrack)}).map(_t=>{let[,{track:Wt}]=_t;return Wt})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent($,_e,_t,Wt,_n){if($){const _s=this.localTrackMap.get(XE.LocalAudioTrack),_c=Wt?this.localTrackMap.get(XE.LocalVideoLowTrack):this.localTrackMap.get(XE.LocalVideoTrack);p_.publish(this.store.sessionId,{eventElapse:DS.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:$,ec:_e,audioName:_s==null?void 0:_s.track.getTrackLabel(),videoName:_c==null?void 0:_c.track.getTrackLabel(),screenshare:(_c==null?void 0:_c.track._hints.indexOf(S0.SCREEN_TRACK))!==-1,audio:!!_s,video:!!_c,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_n})}else{var _i;_t||(_t=[]);const _s=_t.find(_u=>_u instanceof V0),_c=Wt?(_i=this.localTrackMap.get(XE.LocalVideoTrack))===null||_i===void 0?void 0:_i.track:_t.find(_u=>_u instanceof m0);p_.publish(this.store.sessionId,{eventElapse:DS.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:$,ec:_e,audioName:_s==null?void 0:_s.getTrackLabel(),videoName:_c==null?void 0:_c.getTrackLabel(),screenshare:(_c==null?void 0:_c._hints.indexOf(S0.SCREEN_TRACK))!==-1,audio:!!_s,video:!!_c,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_n})}}reportSubscribeEvent($,_e,_t,Wt){const _n=Wt===h_.VIDEO?_t._videoSSRC:_t._audioSSRC;_n&&p_.subscribe(this.store.sessionId,{succ:$,ec:_e,video:Wt===h_.VIDEO,audio:Wt===h_.AUDIO,peerid:_t.uid,subscribeRequestid:Wt===h_.VIDEO?_t._videoSSRC:_t._audioSSRC,p2pid:this.store.p2pId,eventElapse:DS.measureFromSubscribeStart(this.store.clientId,_n)})}reset(){iE.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new mS("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new dI({},this.store):this.isPlanB?new cN({},this.store):new jR({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const $=this.localTrackMap.get(XE.LocalAudioTrack);if(($==null?void 0:$.track)instanceof iS){if($.track.trackList.length>0){const _e=$.track;$.track.trackList.forEach(_t=>{_e.removeAudioTrack(_t)})}$.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=i0.Disconnected}getStats(){var $;return($=this.connection)===null||$===void 0?void 0:$.getStats()}getRemoteVideoIsReady($){var _e;return((_e=this.connection)===null||_e===void 0?void 0:_e.getRemoteVideoIsReady($))||!1}getLocalAudioVolume(){const $=this.localTrackMap.get(XE.LocalAudioTrack);if($)return $.track.getVolumeLevel()}getLocalVideoSize(){const $=this.localTrackMap.get(XE.LocalVideoTrack);if($)return{width:$.track.videoWidth||0,height:$.track.videoHeight||0}}getEncoderConfig($){const _e=this.localTrackMap.get($);return _e&&_e.track instanceof m0||_e&&_e.track instanceof V0?_e.track._encoderConfig:void 0}getLocalMedia($){return this.localTrackMap.get($)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia($,_e){if(!$)return this.remoteUserMap.size>0;const _t=this.remoteUserMap.get($);return!!_t&&(!_e||_t.has(_e))}async hasRemoteMediaWithLock($,_e){if(!$)return this.remoteUserMap.size>0;const _t=this.remoteUserMap.get($);return!!_t&&(!_e||_t.has(_e))}getRemoteMedia($){var _e;const _t=Array.from(ST(_e=this.remoteUserMap).call(_e)).find(Wt=>Wt.uid===$);return _t?{audioTrack:_t.audioTrack,audioSSRC:_t._audioSSRC,videoTrack:_t.videoTrack,videoSSRC:_t._videoSSRC}:{}}getAudioLevels(){let $=Array.from(this.remoteUserMap.entries()).map(_t=>{let[Wt]=_t;return{uid:Wt.uid,level:Wt.audioTrack?100*Wt.audioTrack._source.getAccurateVolumeLevel():0}});const _e=this.localTrackMap.get(XE.LocalAudioTrack);return _e&&$.push({level:100*_e.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),$=MN($).call($,(_t,Wt)=>_t.level-Wt.level),$}async disconnectForReconnect(){this.connection&&(iE.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=i0.Reconnecting,yE("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e]=$;var _t;_e._videoTrack&&_e._videoTrack._player&&((_t=_e._videoTrack._player.getVideoElement())===null||_t===void 0||_t.pause(),_e._videoTrack._player.isKeepLastFrame=!0,_e._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new dI({},this.store):this.isPlanB?new cN({},this.store):new jR({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach($=>{var _e;let[_t,{track:Wt}]=$;switch(_t){case XE.LocalVideoTrack:i_(_e=Wt._hints).call(_e,S0.LOW_STREAM)?Wt.close():this.pendingLocalTracks.push(Wt);break;case XE.LocalAudioTrack:Wt instanceof iS?this.pendingLocalTracks=this.pendingLocalTracks.concat(Wt.trackList):this.pendingLocalTracks.push(Wt);case XE.LocalVideoLowTrack:}}),this.emit(y_.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e,_t]=$;Array.from(ST(_t).call(_t)).forEach(Wt=>{this.setPendingRemoteMedia(_e,Wt)}),this.emit(y_.MediaReconnectStart,_e.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach($=>{this.pendingLocalDataChannels.push($)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach($=>{let[_e,_t]=$;Array.from(ST(_t).call(_t)).forEach(Wt=>{this.setPendingRemoteDataChannel(_e,Wt)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),iE.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel($,_e){for(const _t of this.pendingRemoteDataChannels){const{user:Wt,id:_n}=_t;if(($ instanceof cI?$.uid:$)===Wt.uid&&_n===_e)return!0}return!1}setPendingRemoteDataChannel($,_e){this.hasPendingRemoteDataChannel($,_e)||this.pendingRemoteDataChannels.push({user:$,id:_e})}hasPendingRemoteMedia($,_e){for(const _t of this.pendingRemoteTracks){const{user:Wt,kind:_n}=_t;if(($ instanceof cI?$.uid:$)===Wt.uid&&_e===_n)return!0}return!1}setPendingRemoteMedia($,_e){this.hasPendingRemoteMedia($,_e)||this.pendingRemoteTracks.push({user:$,kind:_e})}restartICE($){var _e=this;return ET(function*(){if(!_e.connection||_e.state!==i0.Connected||_e.connection instanceof dI)return;const _t=yield k_(_e.mutex.lock("From P2PChannel.restartICE"));let Wt;try{Wt=yield k_(_e.connection.restartICE($));const _i=yield k_(Wt.next());if(_i.done)return;const _s=_i.value,_c=yield _s;switch(_e.reportPCDisconnectedOrFailed($),$){case BS.TCP:_e._pcStatsUploadType=y1.TCP_RESTART;break;case BS.RELAY:_e._pcStatsUploadType=y1.RELAY_RESTART;break;default:_e._pcStatsUploadType=y1.OLD_RESTART}_e._isInRestartIce=!0,Wt.next(_c)}catch(_i){var _n;(_n=Wt)===null||_n===void 0||_n.throw(_i)}finally{_t()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const $=this.connection.getStats(),_e=this.localTrackMap.get(XE.LocalVideoTrack),_t=this.localTrackMap.get(XE.LocalAudioTrack),Wt=$.videoSend.find(eE=>eE.ssrc===(_e==null?void 0:_e.ssrcs[0].ssrcId)),_n=$.audioSend.find(eE=>eE.ssrc===(_t==null?void 0:_t.ssrcs[0].ssrcId));if(!Wt||!_n)return 1;const _i=mT(this,y_.NeedSignalRTT),_s=Wt?Wt.rttMs:void 0,_c=_n?_n.rttMs:void 0,_u=_s&&_c?(_s+_c)/2:_s||_c,_h=(_u&&_i?(_u+_i)/2:_u||_i)||0,_p=100*$.sendPacketLossRate*.7/50+.3*_h/1500,Qm=_p<.17?1:_p<.36?2:_p<.59?3:_p<.1?4:5,_g=_e==null?void 0:_e.track;if(_g&&_g._encoderConfig&&_g._hints.indexOf(S0.SCREEN_TRACK)===-1){const eE=_g._encoderConfig.bitrateMax,pE=$.bitrate.actualEncoded;if(eE&&pE){const aE=(1e3*eE-pE)/(1e3*eE);return QH[aE<.15?0:aE<.3?1:aE<.45?2:aE<.6?3:4][Qm]}}return Qm}getDownlinkNetworkQuality(){if(!this.connection)return 0;const $=this.connection.getStats();let _e=0;return Array.from(this.remoteUserMap.entries()).forEach(_t=>{let[Wt]=_t;const _n=Wt._audioSSRC,_i=Wt._videoSSRC,_s=$.audioRecv.find(pE=>pE.ssrc===_n),_c=$.videoRecv.find(pE=>pE.ssrc===_i);if(!_s&&!_c)return void(_e+=1);const _u=mT(this,y_.NeedSignalRTT),_h=$.rtt,_p=(_h&&_u?(_h+_u)/2:_h||_u)||0,Qm=_s?_s.jitterMs:void 0,_g=$.recvPacketLossRate;let eE=.7*_g*100/50+.3*_p/1500;Qm&&(eE=.6*_g*100/50+.2*_p/1500+.2*Qm/400),_e+=eE<.1?1:eE<.17?2:eE<.36?3:eE<.59?4:5}),this.remoteUserMap.size>0?Math.round(_e/this.remoteUserMap.size):_e}async muteLocalTrack($){return new n_((_e,_t)=>{this.handleMuteLocalTrack($,_e,_t)})}async replaceTrack($,_e){var _t;if(iE.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat($.getTrackId(),"] to [").concat(_e.getTrackId(),"]")),!this.connection||this.state!==i0.Connected)return;const Wt=Array.from(this.localTrackMap.entries()).find(_i=>{let[,{track:_s}]=_i;return $===_s});if(!Wt)return;const _n=Wt[0];if($!==_e&&(this.unbindLocalTrackEvents([{track:$,type:_n}]),this.bindLocalTrackEvents([{track:_e,type:_n}]),Wt[1].track=_e),await((_t=this.connection)===null||_t===void 0?void 0:_t.replaceTrack(_e,Wt[1].id)),this.isPlanB){const _i=Wt[1];_i.id=_e._mediaStreamTrack.id,this.localTrackMap.set(_n,_i)}if(_n===XE.LocalVideoTrack&&!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding){const _i=this.localTrackMap.get(XE.LocalVideoLowTrack);if(_i){const _s=$._mediaStreamTrack.clone();_i.track._originMediaStreamTrack.stop(),_i.track._mediaStreamTrack=_s,_i.track._originMediaStreamTrack=_s,await new n_((_c,_u)=>{this.handleReplaceTrack(_i.track,_c,_u,!0)})}}}filterTobePublishedTracks($,_e,_t){const Wt=[],_n=this.getAllTracks();$=AO($=$.filter(_u=>_n.indexOf(_u)===-1));let _i,_s=!1;const _c=this.localTrackMap.get(XE.LocalAudioTrack);for(const _u of $){if(_u instanceof m0&&(this.localTrackMap.has(XE.LocalVideoTrack)||_s?new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(Wt.push({track:_u,type:XE.LocalVideoTrack}),_s=!0),_e)){const _h=this.getLowVideoTrack(_u,_t);Wt.push({track:_h,type:XE.LocalVideoLowTrack})}if(_u instanceof V0)if(_c){const _h=_c.track;if(_h instanceof iS)d8([_u]),_h.addAudioTrack(_u),this.bindLocalAudioTrackEvents(_u,!0);else{const _p=h8([_h,_u]);iE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(_p.getTrackId(),"]")),this.replaceTrack(_h,_p)}}else _i instanceof iS?(d8([_u]),_i.addAudioTrack(_u)):_i||!_u._useAudioElement&&B_().webAudioMediaStreamDest&&!_u._bypassWebAudio?_i=h8(_i?[_u,_i]:[_u]):_i=_u}return _i&&(iE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(_i.getTrackId(),"]")),Wt.push({track:_i,type:XE.LocalAudioTrack})),Wt}filterTobeUnpublishedTracks($){const _e=[],_t=this.getAllTracks();$=AO($=$.filter(Wt=>_t.indexOf(Wt)!==-1));for(const Wt of $){if(Wt instanceof V0){const _n=this.localTrackMap.get(XE.LocalAudioTrack);if(!_n)continue;_n.track instanceof iS?(_n.track.removeAudioTrack(Wt),this.unbindLocalAudioTrackEvents(Wt),_n.track.trackList.length===0&&(_e.push([XE.LocalAudioTrack,_n]),_n.track.close())):_e.push([XE.LocalAudioTrack,_n])}if(Wt instanceof m0){const _n=this.localTrackMap.get(XE.LocalVideoTrack);if(!_n)continue;_e.push([XE.LocalVideoTrack,_n]);const _i=this.localTrackMap.get(XE.LocalVideoLowTrack);_i&&_e.push([XE.LocalVideoLowTrack,_i])}}return _e}filterTobePublishedDataChannels($){return $=($=AO($)).filter(_e=>this.localDataChannels.findIndex(_t=>_t.id===_e.id)===-1)}filterTobeUnpublishedDataChannels($){return $=($=($=AO($)).filter(_e=>this.localDataChannels.indexOf(_e)!==-1)).filter(_e=>_e._originDataChannel)}bindLocalTrackEvents($){$.forEach(_e=>{let{track:_t,type:Wt}=_e;switch(Wt){case XE.LocalVideoTrack:_t.addListener(a_.GET_STATS,this.handleGetLocalVideoStats),_t.addListener(a_.GET_RTC_STATS,this.handleGetRTCStats),_t.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.addListener(a_.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),_t.addListener(a_.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),_t.addListener(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),_t.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case XE.LocalAudioTrack:this.bindLocalAudioTrackEvents(_t);case XE.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents($,_e){$ instanceof iS?$.trackList.forEach(_t=>{_t.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.addListener(a_.GET_STATS,this.handleGetLocalAudioStats),_t.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):($.addListener(a_.GET_STATS,this.handleGetLocalAudioStats),$.addListener(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),$.addListener(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),$.addListener(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),$.addListener(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),_e||($.addListener(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),$.addListener(a_.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents($){$||($=Array.from(this.localTrackMap.entries()).map(_e=>{let[_t,{track:Wt}]=_e;return{track:Wt,type:_t}})),$.forEach(_e=>{let{track:_t,type:Wt}=_e;switch(Wt){case XE.LocalVideoTrack:_t.off(a_.GET_STATS,this.handleGetLocalVideoStats),_t.off(a_.GET_RTC_STATS,this.handleGetRTCStats),_t.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_t.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_t.off(a_.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),_t.off(a_.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),_t.off(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),_t.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_t.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case XE.LocalAudioTrack:this.unbindLocalAudioTrackEvents(_t);case XE.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents($){$ instanceof iS?$.trackList.forEach(_e=>{_e.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),_e.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),_e.off(a_.GET_STATS,this.handleGetLocalAudioStats),_e.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),_e.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):($.off(a_.GET_STATS,this.handleGetLocalAudioStats),$.off(a_.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),$.off(a_.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),$.off(a_.NEED_REPLACE_TRACK,this.handleReplaceTrack),$.off(a_.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),$.off(a_.NEED_MUTE_TRACK,this.handleMuteLocalTrack),$.off(a_.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents($,_e){_e instanceof iN&&_e.addListener(a_.GET_STATS,_t=>{_t(this.handleGetRemoteVideoStats($))}),_e instanceof oN&&_e.addListener(a_.GET_STATS,_t=>{_t(this.handleGetRemoteAudioStats($))})}unbindRemoteTrackEvents($){$&&$.removeAllListeners(a_.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach($=>{let[_e,_t]=$;_t.has(h_.AUDIO)&&this.unbindRemoteTrackEvents(_e._audioTrack),_t.has(h_.VIDEO)&&this.unbindRemoteTrackEvents(_e._videoTrack)})}createGatewayPublishMessage($,_e){return $.map((_t,Wt)=>{var _n;let _i,_s,{track:_c,type:_u}=_t;switch(_u){case XE.LocalAudioTrack:_i=n0.Audio,_s={dtx:_c instanceof dM&&_c._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case XE.LocalVideoTrack:_i=i_(_n=_c._hints).call(_n,S0.SCREEN_TRACK)?n0.Screen:n0.High,_s=c1(c1({},vW(_c)),{},{codec:this.store.codec});break;case XE.LocalVideoLowTrack:_i=n0.Low,_s=c1(c1({},vW(_c)),{},{codec:this.store.codec})}return{stream_type:_i,attributes:_s,ssrcs:_e[Wt]}})}createGatewayUnpublishMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}assignLocalTracks($,_e){$.forEach((_t,Wt)=>{let{track:_n,type:_i}=_t;this.localTrackMap.set(_i,{track:_n,id:_e[Wt].id,ssrcs:_e[Wt].localSSRC})})}withdrawLocalTracks($){$.forEach(_e=>{let[_t]=_e;this.localTrackMap.delete(_t)})}bindConnectionEvents($){$.onConnectionStateChange=async _e=>{if(iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(_e,")")),this.emit(y_.PeerConnectionStateChange,_e),_e!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),_e==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),yE("NEW_ICE_RESTART")){var _t;if(i_(_t=this._restartStates).call(_t,_e)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const Wt=_s=>{($.iceConnectionState==="disconnected"||$.iceConnectionState==="checking"||$.iceConnectionState==="failed")&&(iE.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(_s)),mT(this,y_.QueryClientConnectionState)==="CONNECTED"&&this.emit(y_.RequestRestartICE,_s))},_n=()=>{$.iceConnectionState!=="disconnected"&&$.iceConnectionState!=="checking"&&$.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),iE.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(y_.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},_i=yE("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(yE("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&B_().supportPCSetConfiguration)Wt(BS.RELAY),this._restartTimer=window.setTimeout(_n,_i);else if(h0())Wt(BS.UDP),this._restartTimer=window.setTimeout(_n,4e3);else{if(Wt(BS.TCP),B_().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{Wt(BS.RELAY),this._restartTimer=window.setTimeout(_n,_i)},_i));this._restartTimer=window.setTimeout(_n,_i)}},800))}}else{if(_e==="disconnected"&&$.iceConnectionState==="disconnected")return setTimeout(()=>{$.iceConnectionState==="disconnected"&&yE("ICE_RESTART")&&mT(this,y_.QueryClientConnectionState)==="CONNECTED"&&this.emit(y_.RequestRestartICE)},800),void setTimeout(()=>{$.peerConnectionState==="disconnected"&&(iE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(y_.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);_e==="failed"&&(iE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(y_.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},$.onICEConnectionStateChange=_e=>{_e!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(_e,")")),p_.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:_e,tag:j0.TRACER}).onSuccess(),this.emit(y_.IceConnectionStateChange,_e)},$.onICETransportStateChange=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(_e,")"))},$.onDTLSTransportStateChange=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(_e,")"))},$.onDTLSTransportError=_e=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(_e,")"))},$.onFirstAudioDecoded=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_i=>_i._audioSSRC===_e);var _n;Wt&&(this.store.subscribe(Wt.uid,"audio",void 0,void 0,void 0,Date.now()),(_n=Wt.audioTrack)===null||_n===void 0||_n.emit(eN.FIRST_FRAME_DECODED),p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_AUDIO_DECODE,L0.FIRST_AUDIO_DECODE,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId}))},$.onFirstAudioReceived=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_n=>_n._audioSSRC===_e);Wt&&p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_AUDIO_RECEIVED,L0.FIRST_AUDIO_RECEIVED,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId})},$.onFirstVideoDecoded=(_e,_t,Wt)=>{this.reportVideoFirstFrameDecoded(_e,_t,Wt)},$.onFirstVideoReceived=_e=>{var _t;const Wt=Array.from(ST(_t=this.remoteUserMap).call(_t)).find(_n=>_n._videoSSRC===_e);Wt&&p_.firstRemoteFrame(this.store.sessionId,gS.FIRST_VIDEO_RECEIVED,L0.FIRST_VIDEO_RECEIVED,{peer:Wt._uintid,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,_e),subscribeRequestid:_e,p2pid:this.store.p2pId})},$.onSelectedLocalCandidateChanged=(_e,_t)=>{const Wt=_e.candidateType==="relay",_n=_t.candidateType==="relay";_t.candidateType!=="unknown"&&Wt===_n||this.emit(y_.ConnectionTypeChange,Wt),iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(Z1(_t))," -> ").concat(JSON.stringify(Z1(_e)),")"))},$.onSelectedRemoteCandidateChanged=(_e,_t)=>{iE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(Z1(_t))," -> ").concat(JSON.stringify(Z1(_e)),")"))},$.onFirstVideoDecodedTimeout=_e=>{this.reportVideoFirstFrameDecoded(_e,void 0,void 0,!0)},$.getLocalVideoStats=()=>{const _e=this.statsCollector.getLocalVideoTrackStats(),_t=this.statsCollector.getRTCStats();return c1(c1({},_e),_t)}}unbindConnectionEvents($){$.onConnectionStateChange=void 0,$.onICEConnectionStateChange=void 0,$.onICETransportStateChange=void 0,$.onDTLSTransportStateChange=void 0,$.onDTLSTransportError=void 0,$.onFirstAudioDecoded=void 0,$.onFirstAudioReceived=void 0,$.onFirstVideoDecoded=void 0,$.onFirstVideoReceived=void 0,$.onSelectedLocalCandidateChanged=void 0,$.onSelectedRemoteCandidateChanged=void 0,$.onFirstVideoDecodedTimeout=void 0,$.getLocalVideoStats=void 0}filterTobeMutedTracks($){const _e=[];if(this.getAllTracks().indexOf($)===-1)return _e;const _t=this.localTrackMap.get(XE.LocalAudioTrack);if($ instanceof V0&&(_t==null?void 0:_t.track)instanceof iS)return _t.track.isActive||_e.push([XE.LocalAudioTrack,_t]),_e;const Wt=Array.from(this.localTrackMap.entries()).find(_n=>{let[,{track:_i}]=_n;return $===_i});if(Wt&&(_e.push(Wt),Wt[0]===XE.LocalVideoTrack)){const _n=this.localTrackMap.get(XE.LocalVideoLowTrack);_n&&_e.push([XE.LocalVideoLowTrack,_n])}return _e}filterTobeUnmutedTracks($){const _e=[],_t=this.localTrackMap.get(XE.LocalAudioTrack);if($ instanceof V0&&(_t==null?void 0:_t.track)instanceof iS)return _t.track.isActive&&_e.push([XE.LocalAudioTrack,_t]),_e;const Wt=Array.from(this.localTrackMap.entries()).find(_n=>{let[,{track:_i}]=_n;return $===_i});if(Wt)if(Wt[0]===XE.LocalVideoTrack){_e.push(Wt);const _n=this.localTrackMap.get(XE.LocalVideoLowTrack);_n&&_e.push([XE.LocalVideoLowTrack,_n])}else _e.push(Wt);return _e}createMuteMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}createUnmuteMessage($){return $.map(_e=>{var _t;let Wt,[_n,{track:_i,ssrcs:_s,id:_c}]=_e;switch(_n){case XE.LocalAudioTrack:Wt=n0.Audio;break;case XE.LocalVideoTrack:Wt=i_(_t=_i._hints).call(_t,S0.SCREEN_TRACK)?n0.Screen:n0.High;break;case XE.LocalVideoLowTrack:Wt=n0.Low}return{stream_type:Wt,ssrcs:_s,mid:_c}})}filterTobeUnSubscribedTracks($,_e){const _t=[],Wt=this.remoteUserMap.get($);if(!Wt)return _t;if(_e){const _n=Wt.get(_e);if(!_n)return _t;_t.push([$,{kind:_e,id:_n}])}else Array.from(Wt.entries()).forEach(_n=>{let[_i,_s]=_n;_t.push([$,{kind:_i,id:_s}])});return _t}filterTobeUnSubscribedDataChannels($,_e){const _t=[];return _e.forEach(Wt=>{var _n;(_n=this.remoteDataChannelMap.get($))!==null&&_n!==void 0&&_n.has(Wt.id)&&_t.push(Wt)}),_t}createUnsubscribeMessage($){const _e=[];return $.forEach(_t=>{let[Wt,{kind:_n,id:_i}]=_t;switch(_n){case h_.VIDEO:return void(Wt._videoSSRC&&_e.push({stream_type:h_.VIDEO,ssrcId:Wt._videoSSRC}));case h_.AUDIO:return void(Wt._audioSSRC&&_e.push({stream_type:h_.AUDIO,ssrcId:Wt._audioSSRC}))}}),_e}createUnsubscribeAllMessage($){const _e=new Map;return $.forEach(_t=>{let[Wt,{kind:_n}]=_t;if(_e.has(Wt)){let _i=_e.get(Wt);_n===h_.VIDEO?_i|=pS.Video:_i|=pS.Audio,_e.set(Wt,_i)}else _n===h_.VIDEO?_e.set(Wt,pS.Video):_e.set(Wt,pS.Audio)}),{users:Array.from(_e.entries()).map(_t=>{let[Wt,_n]=_t;return{stream_id:Wt.uid,stream_type:_n}})}}withdrawRemoteTracks($){$.forEach(_e=>{let[_t,{kind:Wt}]=_e;const _n=this.remoteUserMap.get(_t);_n&&(_n.delete(Wt),Array.from(_n.entries()).length===0&&this.remoteUserMap.delete(_t))})}async updateBitrateLimit($){const _e=this.localTrackMap.get(XE.LocalVideoTrack),_t=this.localTrackMap.get(XE.LocalVideoLowTrack);_e&&await _e.track.setBitrateLimit($.uplink),_t&&$.low_stream_uplink&&await _t.track.setBitrateLimit({max_bitrate:$.low_stream_uplink.bitrate,min_bitrate:$.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig($,_e){return $.map((_t,Wt)=>{var _n;let{stream_type:_i}=_t;return(_n=_e.find(_s=>{let{stream_type:_c}=_s;return _i===_c}))===null||_n===void 0?void 0:_n.attributes})}async tryToUnmuteAudio($){for(let _t=0;_t<$.length;_t++)if($[_t]instanceof V0){var _e;const Wt=this.filterTobeUnmutedTracks($[_t]);if(Wt.length===0)continue;await((_e=this.connection)===null||_e===void 0?void 0:_e.unmuteLocal(Wt.map(_i=>{let[,{id:_s}]=_i;return _s})));const _n=this.createUnmuteMessage(Wt);return void await p0(this,y_.RequestUnmuteLocal,_n)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=$=>{var _e;return!((_e=this.connection)===null||_e===void 0||!_e.getRemoteVideoIsReady($))},this.statsUploader.requestUpload=($,_e)=>this.emit(y_.RequestUpload,$,_e),this.statsUploader.requestUploadStats=$=>this.emit(y_.RequestUploadStats,$),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await hS(RL(this.dtlsFailedCount,Y0)),this.emit(y_.RequestReconnect)}async reconnectP2P(){const $=Array.from(this.localTrackMap.entries()),_e=this.createGatewayUnpublishMessage($);Array.from(this.remoteUserMap.entries()),_e.length>0&&await _y(this,y_.RequestUnpublishForReconnectPC,_e),this.disconnectForReconnect(),this.emit(y_.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(XE.LocalVideoTrack)||this.pendingLocalTracks.some($=>$ instanceof m0)}throwIfTrackTypeNotMatch($){if($.filter(_e=>_e instanceof m0).length>1)throw new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if($.filter(_e=>_e instanceof V0).length>1&&($.some(_e=>_e instanceof V0&&_e._bypassWebAudio)||!B_().webAudioMediaStreamDest))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const _e of $){if(_e instanceof m0&&this.pendingLocalTracks.some(_t=>_t instanceof m0))throw new HE(mE.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(_e instanceof V0&&this.pendingLocalTracks.some(_t=>_t instanceof V0)&&(!B_().webAudioMediaStreamDest||_e._bypassWebAudio||this.pendingLocalTracks.some(_t=>_t instanceof V0&&_t._bypassWebAudio)))throw new HE(mE.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack($,_e){const _t=!yE("DISABLE_DUAL_STREAM_USE_ENCODING")&&B_().supportDualStreamEncoding,Wt=c1(c1({},{width:160,height:120,framerate:15,bitrate:50}),_e);let _n;_n=_t?$._mediaStreamTrack.clone():u8($,Wt);const _i=f0(8,"track-low-"),_s=new m0(_n,c1(c1({},_t&&{scaleResolutionDownBy:BV(Wt,$)}),{},{frameRate:Wt.framerate,bitrateMax:Wt.bitrate,bitrateMin:Wt.bitrate}),void 0,void 0,_i);return _s.on(zI.TRANSCEIVER_UPDATED,_c=>{$._updateRtpTransceiver(_c,ZO.LOW_STREAM)}),_s._hints.push(S0.LOW_STREAM),$.on("sei-to-send",_c=>{_s.emit("sei-to-send",_c)}),$.addListener(a_.NEED_CLOSE,()=>{_s.close()}),_s}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats($,_e,_t){let Wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof jR){var _n,_i,_s,_c;const _u=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:_h,dtlsTransportState:_p,peerConnectionState:Qm}=this.connection,{local:_g,remote:eE}=await this.connection.getSelectedCandidatePair();p_.pcStats(this.store.sessionId,{startTime:_u,eventElapse:$-_u||0,iceconnectionsate:_h,dtlsstate:_p,connectionstate:Qm,intSucc:_e?1:2,error:Wt,selectedLocalCandidateProtocol:(_n=_g==null?void 0:_g.protocol)!==null&&_n!==void 0?_n:"",selectedLocalCandidateType:(_i=_g.candidateType)!==null&&_i!==void 0?_i:"",selectedLocalCandidateAddress:"".concat(_g.address,":").concat(_g.port),selectedRemoteCandidateProtocol:(_s=eE.protocol)!==null&&_s!==void 0?_s:"",selectedRemoteCandidateType:(_c=eE.candidateType)!==null&&_c!==void 0?_c:"",selectedRemoteCandidateAddress:"".concat(eE.address,":").concat(eE.port),restartCnt:_t})}}reportVideoFirstFrameDecoded($,_e,_t,Wt){var _n;const _i=Array.from(ST(_n=this.remoteUserMap).call(_n)).find(_s=>_s._videoSSRC===$);if(_i){Wt||this.store.subscribe(_i.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _s=this.store.keyMetrics,_c=_s.subscribe.find(_u=>_u.userId===_i.uid&&_u.type==="video");p_.firstRemoteVideoDecode(this.store.sessionId,gS.FIRST_VIDEO_DECODE,L0.FIRST_VIDEO_DECODE,{peer:_i._uintid,videowidth:_e,videoheight:_t,subscribeElapse:DS.measureFromSubscribeStart(this.store.clientId,$),subscribeRequestid:$,p2pid:this.store.p2pId,apEnd:_s.requestAPEnd||0,apStart:_s.requestAPStart||0,joinGwEnd:_s.joinGatewayEnd||0,joinGwStart:_s.joinGatewayStart||0,pcEnd:_s.peerConnectionEnd||0,pcStart:_s.peerConnectionStart||0,subscriberEnd:(_c==null?void 0:_c.subscribeEnd)||0,subscriberStart:(_c==null?void 0:_c.subscribeStart)||0,videoAddNotify:(_c==null?void 0:_c.streamAdded)||0,state:Wt?1:0})}}async remoteMediaSsrcChanged($,_e,_t){if(!this.connection)return!1;const Wt=this.remoteUserMap.get($);if(!Wt)return!1;const _n=Wt.get(_e);if(!_n)return!1;const _i=await this.connection.getRemoteSSRC(_n);return _i!==void 0&&_i!==_t}resetConnection($){iE.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat($)),this.state===i0.Connected?(iE.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=$===cW.datachannel?new dI({},this.store):this.isPlanB?new cN({},this.store):new jR({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach($=>{let[_e,{track:_t}]=$;_e===XE.LocalVideoLowTrack?_t._updateRtpTransceiver(void 0,ZO.LOW_STREAM):_t._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed($){this.connection&&this.connection instanceof jR&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===y1.TCP_RESTART&&$===BS.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,y1.DISCONNECTED_OR_FAILED)))}},t_(D_.prototype,"startP2PConnection",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"startP2PConnection"),D_.prototype),t_(D_.prototype,"connect",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"connect"),D_.prototype),t_(D_.prototype,"updateRemoteRTPCapabilities",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"updateRemoteRTPCapabilities"),D_.prototype),t_(D_.prototype,"preConnect",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"preConnect"),D_.prototype),t_(D_.prototype,"publishDataChannel",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"publishDataChannel"),D_.prototype),t_(D_.prototype,"unpublish",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unpublish"),D_.prototype),t_(D_.prototype,"unpublishDataChannel",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unpublishDataChannel"),D_.prototype),t_(D_.prototype,"unpublishLowStream",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unpublishLowStream"),D_.prototype),t_(D_.prototype,"subscribeDataChannel",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"subscribeDataChannel"),D_.prototype),t_(D_.prototype,"subscribe",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"subscribe"),D_.prototype),t_(D_.prototype,"massSubscribe",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"massSubscribe"),D_.prototype),t_(D_.prototype,"unsubscribe",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unsubscribe"),D_.prototype),t_(D_.prototype,"unsubscribeDataChannel",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unsubscribeDataChannel"),D_.prototype),t_(D_.prototype,"massUnsubscribe",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"massUnsubscribe"),D_.prototype),t_(D_.prototype,"muteRemote",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"muteRemote"),D_.prototype),t_(D_.prototype,"unmuteRemote",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"unmuteRemote"),D_.prototype),t_(D_.prototype,"hasRemoteMediaWithLock",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"hasRemoteMediaWithLock"),D_.prototype),t_(D_.prototype,"disconnectForReconnect",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"disconnectForReconnect"),D_.prototype),t_(D_.prototype,"updateBitrateLimit",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"updateBitrateLimit"),D_.prototype),t_(D_.prototype,"remoteMediaSsrcChanged",[FS],Object.getOwnPropertyDescriptor(D_.prototype,"remoteMediaSsrcChanged"),D_.prototype),D_);function FS($,_e,_t){const Wt=$[_e];if(typeof Wt!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _n=this.mutex,_i=await _n.lock("From P2PChannel.".concat(_e));try{for(var _s=arguments.length,_c=new Array(_s),_u=0;_u<_s;_u++)_c[_u]=arguments[_u];return await Wt.apply(this,_c)}finally{_i()}},_t}function Nhe($){let _e=vY();return function(_t,Wt){let _n=_t.appId;_n!==void 0&&(s0(Wt,10),l1(Wt,_n));let _i=_t.cid;_i!==void 0&&(s0(Wt,16),s0(Wt,_i));let _s=_t.cname;_s!==void 0&&(s0(Wt,26),l1(Wt,_s));let _c=_t.deviceId;_c!==void 0&&(s0(Wt,34),l1(Wt,_c));let _u=_t.elapse;_u!==void 0&&(s0(Wt,40),hI(Wt,_u));let _h=_t.fileSize;_h!==void 0&&(s0(Wt,48),hI(Wt,uN(_h)));let _p=_t.height;_p!==void 0&&(s0(Wt,56),hI(Wt,uN(_p)));let Qm=_t.jpg;Qm!==void 0&&(s0(Wt,66),s0(Wt,Qm.length),function(_R,$E){let QE=dN(_R,$E.length);_R.bytes.set($E,QE)}(Wt,Qm));let _g=_t.networkType;_g!==void 0&&(s0(Wt,72),hI(Wt,uN(_g)));let eE=_t.osType;eE!==void 0&&(s0(Wt,80),hI(Wt,uN(eE)));let pE=_t.requestId;pE!==void 0&&(s0(Wt,90),l1(Wt,pE));let aE=_t.sdkVersion;aE!==void 0&&(s0(Wt,98),l1(Wt,aE));let cE=_t.sequence;cE!==void 0&&(s0(Wt,104),hI(Wt,uN(cE)));let fE=_t.sid;fE!==void 0&&(s0(Wt,114),l1(Wt,fE));let gE=_t.timestamp;gE!==void 0&&(s0(Wt,120),hI(Wt,gE));let AE=_t.uid;AE!==void 0&&(s0(Wt,128),s0(Wt,AE));let PE=_t.vid;PE!==void 0&&(s0(Wt,136),s0(Wt,PE));let xE=_t.width;xE!==void 0&&(s0(Wt,144),hI(Wt,uN(xE)));let GE=_t.service;GE!==void 0&&(s0(Wt,152),s0(Wt,GE));let zE=_t.callbackData;zE!==void 0&&(s0(Wt,162),l1(Wt,zE));let KE=_t.jpgEncryption;KE!==void 0&&(s0(Wt,168),s0(Wt,KE));let JE=_t.requestType;JE!==void 0&&(s0(Wt,176),s0(Wt,JE));let c_=_t.scorePorn;c_!==void 0&&(s0(Wt,185),y8(Wt,c_));let V_=_t.scoreSexy;V_!==void 0&&(s0(Wt,193),y8(Wt,V_));let Q_=_t.scoreNeutral;Q_!==void 0&&(s0(Wt,201),y8(Wt,Q_));let T0=_t.scene;T0!==void 0&&(s0(Wt,208),s0(Wt,T0));let Z0=_t.ossFilePrefix;Z0!==void 0&&(s0(Wt,218),l1(Wt,Z0));let M0=_t.serviceVendor;if(M0!==void 0)for(let _R of M0){s0(Wt,226);let $E=vY();Dhe(_R,$E),s0(Wt,$E.limit),Uhe(Wt,$E),Mhe($E)}}($,_e),function(_t){let Wt=_t.bytes,_n=_t.limit;return Wt.length===_n?Wt:Wt.subarray(0,_n)}(_e)}function Phe($){return function(_t){let Wt={};e:for(;!_Y(_t);){let _n=u1(_t);switch(_n>>>3){case 0:break e;case 1:Wt.code=u1(_t);break;case 2:Wt.msg=yY(_t,u1(_t));break;case 3:{let _i=Lhe(_t);Wt.data=khe(_t),_t.limit=_i;break}default:gY(_t,7&_n)}}return Wt}({bytes:_e=$,offset:0,limit:_e.length});var _e}function khe($){let _e={};e:for(;!_Y($);){let _t=u1($);switch(_t>>>3){case 0:break e;case 1:_e.requestId=yY($,u1($));break;case 2:_e.requestType=u1($)>>>0;break;case 3:_e.scorePorn=_8($);break;case 4:_e.scoreSexy=_8($);break;case 5:_e.scoreNeutral=_8($);break;case 6:_e.requestScene=u1($)>>>0;break;case 7:_e.scene=u1($)>>>0;break;default:gY($,7&_t)}}return _e}function Dhe($,_e){let _t=$.service;_t!==void 0&&(s0(_e,8),s0(_e,_t));let Wt=$.vendor;Wt!==void 0&&(s0(_e,16),s0(_e,Wt));let _n=$.token;_n!==void 0&&(s0(_e,26),l1(_e,_n));let _i=$.callbackUrl;_i!==void 0&&(s0(_e,34),l1(_e,_i))}function Lhe($){let _e=u1($),_t=$.limit;return $.limit=$.offset+_e,_t}function gY($,_e){switch(_e){case 0:for(;128&bY($););break;case 2:E8($,u1($));break;case 5:E8($,4);break;case 1:E8($,8);break;default:throw new Error("Unimplemented type: "+_e)}}let xhe=new Float32Array(1);new Uint8Array(xhe.buffer);let g8=new Float64Array(1),dT=new Uint8Array(g8.buffer);function uN($){return{low:$|=0,high:$>>31,unsigned:$>=0}}let EY=[];function vY(){const $=EY.pop();return $?($.offset=$.limit=0,$):{bytes:new Uint8Array(64),offset:0,limit:0}}function Mhe($){EY.push($)}function E8($,_e){if($.offset+_e>$.limit)throw new Error("Skip past limit");$.offset+=_e}function _Y($){return $.offset>=$.limit}function dN($,_e){let _t=$.bytes,Wt=$.offset,_n=$.limit,_i=Wt+_e;if(_i>_t.length){let _s=new Uint8Array(2*_i);_s.set(_t),$.bytes=_s}return $.offset=_i,_i>_n&&($.limit=_i),Wt}function v8($,_e){let _t=$.offset;if(_t+_e>$.limit)throw new Error("Read past limit");return $.offset+=_e,_t}function yY($,_e){let _t=v8($,_e),Wt=String.fromCharCode,_n=$.bytes,_i="",_s="";for(let _c=0;_c<_e;_c++){let _u,_h,_p,Qm,_g=_n[_c+_t];128&_g?(224&_g)==192?_c+1>=_e?_s+=_i:(_u=_n[_c+_t+1],(192&_u)!=128?_s+=_i:(Qm=(31&_g)<<6|63&_u,Qm<128?_s+=_i:(_s+=Wt(Qm),_c++))):(240&_g)==224?_c+2>=_e?_s+=_i:(_u=_n[_c+_t+1],_h=_n[_c+_t+2],(49344&(_u|_h<<8))!=32896?_s+=_i:(Qm=(15&_g)<<12|(63&_u)<<6|63&_h,Qm<2048||Qm>=55296&&Qm<=57343?_s+=_i:(_s+=Wt(Qm),_c+=2))):(248&_g)==240?_c+3>=_e?_s+=_i:(_u=_n[_c+_t+1],_h=_n[_c+_t+2],_p=_n[_c+_t+3],(12632256&(_u|_h<<8|_p<<16))!=8421504?_s+=_i:(Qm=(7&_g)<<18|(63&_u)<<12|(63&_h)<<6|63&_p,Qm<65536||Qm>1114111?_s+=_i:(Qm-=65536,_s+=Wt(55296+(Qm>>10),56320+(1023&Qm)),_c+=3))):_s+=_i:_s+=Wt(_g)}return _s}function l1($,_e){let _t=_e.length,Wt=0;for(let _s=0;_s<_t;_s++){let _c=_e.charCodeAt(_s);_c>=55296&&_c<=56319&&_s+1<_t&&(_c=(_c<<10)+_e.charCodeAt(++_s)-56613888),Wt+=_c<128?1:_c<2048?2:_c<65536?3:4}s0($,Wt);let _n=dN($,Wt),_i=$.bytes;for(let _s=0;_s<_t;_s++){let _c=_e.charCodeAt(_s);_c>=55296&&_c<=56319&&_s+1<_t&&(_c=(_c<<10)+_e.charCodeAt(++_s)-56613888),_c<128?_i[_n++]=_c:(_c<2048?_i[_n++]=_c>>6&31|192:(_c<65536?_i[_n++]=_c>>12&15|224:(_i[_n++]=_c>>18&7|240,_i[_n++]=_c>>12&63|128),_i[_n++]=_c>>6&63|128),_i[_n++]=63&_c|128)}}function Uhe($,_e){let _t=dN($,_e.limit),Wt=$.bytes,_n=_e.bytes;for(let _i=0,_s=_e.limit;_i<_s;_i++)Wt[_i+_t]=_n[_i]}function bY($){return $.bytes[v8($,1)]}function SY($,_e){let _t=dN($,1);$.bytes[_t]=_e}function _8($){let _e=v8($,8),_t=$.bytes;return dT[0]=_t[_e++],dT[1]=_t[_e++],dT[2]=_t[_e++],dT[3]=_t[_e++],dT[4]=_t[_e++],dT[5]=_t[_e++],dT[6]=_t[_e++],dT[7]=_t[_e++],g8[0]}function y8($,_e){let _t=dN($,8),Wt=$.bytes;g8[0]=_e,Wt[_t++]=dT[0],Wt[_t++]=dT[1],Wt[_t++]=dT[2],Wt[_t++]=dT[3],Wt[_t++]=dT[4],Wt[_t++]=dT[5],Wt[_t++]=dT[6],Wt[_t++]=dT[7]}function u1($){let _e,_t=0,Wt=0;do _e=bY($),_t<32&&(Wt|=(127&_e)<<_t),_t+=7;while(128&_e);return Wt}function s0($,_e){for(_e>>>=0;_e>=128;)SY($,127&_e|128),_e>>>=7;SY($,_e)}function hI($,_e){let _t=_e.low>>>0,Wt=(_e.low>>>28|_e.high<<4)>>>0,_n=_e.high>>>24,_i=_n===0?Wt===0?_t<16384?_t<128?1:2:_t<1<<21?3:4:Wt<16384?Wt<128?5:6:Wt<1<<21?7:8:_n<128?9:10,_s=dN($,_i),_c=$.bytes;switch(_i){case 10:_c[_s+9]=_n>>>7&1;case 9:_c[_s+8]=_i!==9?128|_n:127&_n;case 8:_c[_s+7]=_i!==8?Wt>>>21|128:Wt>>>21&127;case 7:_c[_s+6]=_i!==7?Wt>>>14|128:Wt>>>14&127;case 6:_c[_s+5]=_i!==6?Wt>>>7|128:Wt>>>7&127;case 5:_c[_s+4]=_i!==5?128|Wt:127&Wt;case 4:_c[_s+3]=_i!==4?_t>>>21|128:_t>>>21&127;case 3:_c[_s+2]=_i!==3?_t>>>14|128:_t>>>14&127;case 2:_c[_s+1]=_i!==2?_t>>>7|128:_t>>>7&127;case 1:_c[_s]=_i!==1?128|_t:127&_t}}function TY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}const jhe=new Map([["moderation",1],["supervise",2]]);class kM extends A0{get connectionState(){return this._connectionState}set connectionState(_e){if(this._connectionState===_e)return;const _t=this._connectionState;this._connectionState=_e,this.emit(vS.CONNECTION_STATE_CHANGE,_t,_e)}get inspectType(){return this._inspectType}set inspectType(_e){var _t;this._inspectMode=wR(_t=_e.map(Wt=>jhe.get(Wt)||0)).call(_t,(Wt,_n)=>Wt+_n),this._inspectType=_e}get quality(){return this._quality}set quality(_e){this._quality=_e>1?1:_e<.1?.1:_e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(_e){super(),hE(this,"name","AgoraRTCVideoContentInspect"),hE(this,"_connectionState",rR.CONNECTING),hE(this,"_innerConnectionState",void 0),hE(this,"sequence",0),hE(this,"inspectStartTime",void 0),hE(this,"workerManagerConnection",void 0),hE(this,"workerConnection",void 0),hE(this,"workerMessageLengthLimit",void 0),hE(this,"inspectIntervalMinimum",void 0),hE(this,"qualityRatio",void 0),hE(this,"_connectInfo",void 0),hE(this,"_cancelTokenSource",tT.CancelToken.source()),hE(this,"_retryConfig",void 0),hE(this,"wmSequence",0),hE(this,"inspectInterval",void 0),hE(this,"inspectTimer",null),hE(this,"ossFilePrefix",void 0),hE(this,"extraInfo",void 0),hE(this,"_inspectType",void 0),hE(this,"_inspectMode",void 0),hE(this,"_quality",1),hE(this,"qualityTimer",null),hE(this,"_inspectId",void 0),hE(this,"_needWorkUrlOnly",!1),hE(this,"inspectImage",()=>{if(this.connectionState!==rR.CONNECTED)throw new DE(mE.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===rR.CONNECTED?this.requestToInspectImage():iE.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=f0(5,"inspect-"),this.workerMessageLengthLimit=yE("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=yE("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=yE("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=_e.interval,this.ossFilePrefix=_e.ossFilePrefix,this.extraInfo=_e.extraInfo,this.inspectType=_e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new oP("worker-manager-"+this._inspectId,Y0),this.on(vS.STATE_CHANGE,(_t,Wt)=>{this._innerConnectionState=_t,iE.debug("[".concat(this._inspectId,"] Inspect operation :").concat(iR[_t]," ").concat(Wt||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new oP("worker-"+this._inspectId,Y0),this.handleWorkerEvents()}async init(_e,_t){this.emit(vS.STATE_CHANGE,iR.CONNECT_AP),this._connectInfo=_e;const Wt=this._cancelTokenSource.token;return this._retryConfig=_t,new n_((_n,_i)=>{this.on(vS.CONNECTION_STATE_CHANGE,(_s,_c)=>{_c===rR.CONNECTED&&_n()}),this.requestAP(_e,Wt,_t).then(_s=>{this.connectWorkerManager(_s)}).catch(_s=>{_i(_s)})})}async requestAP(_e,_t,Wt){const _n=yE("WEBCS_DOMAIN").map(_c=>"https://".concat(_c,"/api/v1")),_i=await function(_c,_u,_h,_p){let{appId:Qm,areaCode:_g,cname:eE,sid:pE,token:aE,uid:cE}=_u;UO++;const fE="image_moderation_api",gE={service_name:fE,json_body:JSON.stringify({appId:Qm,areaCode:_g,cname:eE,command:"allocateEdge",requestId:UO,seq:UO,sid:pE,token:aE,ts:Date.now(),uid:cE+""})};let AE,PE,xE=_c[0];return IR(async()=>{AE=Date.now();const GE=await PR(xE,{data:gE,cancelToken:_h,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(PE=Date.now()-AE,GE.code!==0){const c_=new DE(mE.UNEXPECTED_RESPONSE,"image inspect ap error, code"+GE.code,{retry:!0,responseTime:PE});throw iE.error(c_.toString()),c_}const zE=JSON.parse(GE.json_body);if(zE.code!==200){const c_=new DE(mE.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(zE.code,", reason: ").concat(zE.reason),{code:zE.code,responseTime:PE});throw iE.error(c_.toString()),c_}if(!zE.servers||!Array.isArray(zE.servers)||zE.servers.length===0){const c_=new DE(mE.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:zE.code,responseTime:PE});throw iE.error(c_.toString()),c_}const KE=yE("VIDEO_INSPECT_WORKER_MANAGER_HOST"),JE=yE("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:zE.servers.map(c_=>{let{address:V_,wss:Q_}=c_;if(V_&&Q_)return"wss://".concat(V_.replace(/\./g,"-"),".").concat(KE,":").concat(JE||Q_)}).filter(c_=>!!c_),workerToken:zE.workerToken,vid:zE.vid,responseTime:PE}},(GE,zE)=>(p_.apworkerEvent(pE,{success:!0,sc:200,serviceName:fE,responseDetail:JSON.stringify(GE.addressList),firstSuccess:zE===0,responseTime:PE,serverIp:_c[zE%_c.length]}),!1),(GE,zE)=>(p_.apworkerEvent(pE,{success:!1,sc:GE.data&&GE.data.code||200,serviceName:fE,responseTime:PE,serverIp:_c[zE%_c.length]}),!!(GE.code!==mE.OPERATION_ABORTED&&GE.code!==mE.UNEXPECTED_RESPONSE||GE.data&&GE.data.retry)&&(xE=_c[(zE+1)%_c.length],!0)),_p)}(_n,_e,_t,Wt);this.emit(vS.STATE_CHANGE,iR.AP_CONNECTED);const{addressList:_s}=_i;return this.wmSequence++,_s}async connectWorkerManager(_e){let _t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=_t,this.emit(vS.STATE_CHANGE,iR.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(_e,1e4)}async connectWorker(_e){await this.workerConnection.init([_e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(T_.CONNECTED,async()=>{this.emit(vS.STATE_CHANGE,iR.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.21.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(T_.CLOSED,()=>{this._innerConnectionState<iR.GET_WORKER_MANAGER_RESPONSE&&iE.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(T_.FAILED,()=>{this._innerConnectionState<iR.GET_WORKER_MANAGER_RESPONSE&&iE.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(T_.RECONNECTING,()=>{this._innerConnectionState<iR.GET_WORKER_MANAGER_RESPONSE&&iE.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(T_.ON_MESSAGE,async _e=>{this.emit(vS.STATE_CHANGE,iR.GET_WORKER_MANAGER_RESPONSE);const _t=this.workerManagerConnection.url;this.workerManagerConnection.close();const Wt=JSON.parse(_e.data);if(Wt.code!==200)throw iE.error("[".concat(this._inspectId,"] Unexpected code ").concat(Wt.code," from worker manager")),new DE(mE.UNEXPECTED_RESPONSE,"response code of worker is unexpected",Wt);if(!(Wt.serverResponse&&Wt.serverResponse.portWss&&_t))throw iE.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(Wt))),new DE(mE.UNEXPECTED_RESPONSE,"response content of worker is unexpected",Wt);{const _n=yE("VIDEO_INSPECT_WORKER_PORT")||Wt.serverResponse.portWss,_i=_t.replace(/:\d+\/?$/,":".concat(_n));this.emit(vS.STATE_CHANGE,iR.CONNECT_WORKER,_i),this._needWorkUrlOnly?this.emit(vS.REQUEST_NEW_WORKER_URL,_i):await this.connectWorker(_i)}}),this.workerManagerConnection.on(T_.WILL_RECONNECT,(_e,_t,Wt)=>{Wt(_e)}),this.workerManagerConnection.on(T_.REQUEST_NEW_URLS,(_e,_t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(_e).catch(_t)})}handleWorkerEvents(){this.workerConnection.on(T_.CONNECTED,async()=>{this.emit(vS.STATE_CHANGE,iR.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=rR.CONNECTED}),this.workerConnection.on(T_.ON_MESSAGE,async _e=>{if(_e.data instanceof ArrayBuffer){const Wt=Phe(new Uint8Array(_e.data));if(yE("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&iE.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(Wt)),Wt.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(vS.INSPECT_RESULT,void 0,void 0);if(Wt.data&&Wt.data.scorePorn&&Wt.data.scoreSexy&&Wt.data.scoreNeutral){var _t;const _n={porn:Wt.data.scorePorn,sexy:Wt.data.scoreSexy,neutral:Wt.data.scoreNeutral},_i=wR(_t=Object.keys(_n)).call(_t,(_c,_u)=>_n[_c]>_n[_u]?_c:_u,"porn"),_s=Object.keys(_n).find(_c=>_c===_i);this.emit(vS.INSPECT_RESULT,_s)}else this.emit(vS.INSPECT_RESULT,void 0,new DE(mE.UNEXPECTED_RESPONSE,Wt.code+"","There is an unexpected data on message"))}else this.emit(vS.INSPECT_RESULT,void 0,new DE(mE.UNEXPECTED_RESPONSE,Wt.code+"",Wt.msg))}else iE.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(vS.INSPECT_RESULT,void 0,new DE(mE.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(T_.CLOSED,()=>{this.connectionState=rR.CLOSED}),this.workerConnection.on(T_.FAILED,()=>{this.connectionState=rR.CLOSED}),this.workerConnection.on(T_.RECONNECTING,()=>{this.connectionState=this.connectionState===rR.CONNECTED?rR.RECONNECTING:rR.CONNECTING}),this.workerConnection.on(T_.WILL_RECONNECT,(_e,_t,Wt)=>{_e==="recover"&&Wt(_e),Wt("tryNext")}),this.workerConnection.on(T_.REQUEST_NEW_URLS,(_e,_t)=>{this.workerManagerConnection.close(),this.once(vS.REQUEST_NEW_WORKER_URL,Wt=>{_e([Wt])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(Wt=>{this.connectWorkerManager(Wt,!0)}).catch(Wt=>{_t(Wt)})})}static intToLong(_e){return{low:_e|=0,high:_e>>31,unsigned:_e>=0}}async requestToInspectImage(){this.sequence++;const _e=mT(this,vS.CLIENT_LOCAL_VIDEO_TRACK),_t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(_e){if(!_e.isPlaying)return void this.emit(vS.INSPECT_RESULT,void 0,new DE(mE.INVALID_OPERATION,"Only the track being played can be inspected"));const Wt=await this.generateRequestData(_e,_t);this.workerConnection.sendMessage(Wt,!0,!0)}else this.emit(vS.INSPECT_RESULT,void 0,new DE(mE.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(_e,_t){let{appId:Wt,cname:_n,cid:_i,vid:_s,sid:_c,uid:_u}=_t;const _h=Date.now(),_p=await _e.getCurrentFrameImage("image/jpeg",this.quality),Qm=await wK(_p,Wt,_n),_g=this.sequence+"-"+_i+"-"+_u+"-"+_h+"-"+f0(12,""),eE={appId:Wt,cid:_i,cname:_n,deviceId:"",elapse:kM.intToLong(Number(_h-this.inspectStartTime)),fileSize:Qm.byteLength,jpgEncryption:2,height:_p.height,width:_p.width,jpg:Qm,networkType:6,osType:7,requestId:_g,sdkVersion:"4.21.0",sequence:this.sequence,sid:_c,timestamp:kM.intToLong(_h),uid:_u,vid:_s,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete eE.callbackData,this.ossFilePrefix===void 0&&delete eE.ossFilePrefix;const pE=Nhe(eE);if(pE.byteLength<this.workerMessageLengthLimit){if(yE("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const aE=function(cE){for(var fE=1;fE<arguments.length;fE++){var gE=arguments[fE]!=null?arguments[fE]:{};fE%2?TY(Object(gE),!0).forEach(function(AE){hE(cE,AE,gE[AE])}):Object.getOwnPropertyDescriptors?Object.defineProperties(cE,Object.getOwnPropertyDescriptors(gE)):TY(Object(gE)).forEach(function(AE){Object.defineProperty(cE,AE,Object.getOwnPropertyDescriptor(gE,AE))})}return cE}({},eE);delete aE.jpg,iE.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(aE))}return pE}{const aE=this.quality*this.qualityRatio;return this.quality=aE,await this.generateRequestData(_e,{appId:Wt,cname:_n,cid:_i,vid:_s,sid:_c,uid:_u})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=tT.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=rR.CLOSED,this.emit(vS.STATE_CHANGE,iR.CLOSED)}}function Fhe($){let _e=function(){const _t=Ghe.pop();return _t?(_t.offset=_t.limit=0,_t):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(_t,Wt){let _n=_t.appId;_n!==void 0&&(X0(Wt,10),pI(Wt,_n));let _i=_t.cid;_i!==void 0&&(X0(Wt,16),X0(Wt,_i));let _s=_t.cname;_s!==void 0&&(X0(Wt,26),pI(Wt,_s));let _c=_t.deviceId;_c!==void 0&&(X0(Wt,34),pI(Wt,_c));let _u=_t.elapse;_u!==void 0&&(X0(Wt,40),fI(Wt,_u));let _h=_t.fileSize;_h!==void 0&&(X0(Wt,48),fI(Wt,hN(_h)));let _p=_t.height;_p!==void 0&&(X0(Wt,56),fI(Wt,hN(_p)));let Qm=_t.jpg;Qm!==void 0&&(X0(Wt,66),X0(Wt,Qm.length),RY(Wt,Qm));let _g=_t.networkType;_g!==void 0&&(X0(Wt,72),fI(Wt,hN(_g)));let eE=_t.osType;eE!==void 0&&(X0(Wt,80),fI(Wt,hN(eE)));let pE=_t.requestId;pE!==void 0&&(X0(Wt,90),pI(Wt,pE));let aE=_t.sdkVersion;aE!==void 0&&(X0(Wt,98),pI(Wt,aE));let cE=_t.sequence;cE!==void 0&&(X0(Wt,104),fI(Wt,hN(cE)));let fE=_t.sid;fE!==void 0&&(X0(Wt,114),pI(Wt,fE));let gE=_t.timestamp;gE!==void 0&&(X0(Wt,120),fI(Wt,gE));let AE=_t.uid;AE!==void 0&&(X0(Wt,128),X0(Wt,AE));let PE=_t.vid;PE!==void 0&&(X0(Wt,136),X0(Wt,PE));let xE=_t.width;xE!==void 0&&(X0(Wt,144),fI(Wt,hN(xE)));let GE=_t.service;GE!==void 0&&(X0(Wt,152),X0(Wt,GE));let zE=_t.callbackData;zE!==void 0&&(X0(Wt,162),X0(Wt,zE.length),RY(Wt,zE));let KE=_t.ticket;KE!==void 0&&(X0(Wt,170),pI(Wt,KE));let JE=_t.vendorConfigs;JE!==void 0&&(X0(Wt,178),pI(Wt,JE))}($,_e),function(_t){let Wt=_t.bytes,_n=_t.limit;return Wt.length===_n?Wt:Wt.subarray(0,_n)}(_e)}function Vhe($){return function(_t){let Wt={};e:for(;!Hhe(_t);){let _n=VP(_t);switch(_n>>>3){case 0:break e;case 1:Wt.code=VP(_t);break;case 2:Wt.msg=CY(_t,VP(_t));break;case 3:Wt.requestId=CY(_t,VP(_t));break;case 4:Wt.timestamp=Whe(_t,!1);break;default:Bhe(_t,7&_n)}}return Wt}({bytes:_e=$,offset:0,limit:_e.length});var _e}function Bhe($,_e){switch(_e){case 0:for(;128&vR($););break;case 2:b8($,VP($));break;case 5:b8($,4);break;case 1:b8($,8);break;default:throw new Error("Unimplemented type: "+_e)}}function hN($){return{low:$|=0,high:$>>31,unsigned:$>=0}}let Ghe=[];function b8($,_e){if($.offset+_e>$.limit)throw new Error("Skip past limit");$.offset+=_e}function Hhe($){return $.offset>=$.limit}function DM($,_e){let _t=$.bytes,Wt=$.offset,_n=$.limit,_i=Wt+_e;if(_i>_t.length){let _s=new Uint8Array(2*_i);_s.set(_t),$.bytes=_s}return $.offset=_i,_i>_n&&($.limit=_i),Wt}function wY($,_e){let _t=$.offset;if(_t+_e>$.limit)throw new Error("Read past limit");return $.offset+=_e,_t}function RY($,_e){let _t=DM($,_e.length);$.bytes.set(_e,_t)}function CY($,_e){let _t=wY($,_e),Wt=String.fromCharCode,_n=$.bytes,_i="",_s="";for(let _c=0;_c<_e;_c++){let _u,_h,_p,Qm,_g=_n[_c+_t];128&_g?(224&_g)==192?_c+1>=_e?_s+=_i:(_u=_n[_c+_t+1],(192&_u)!=128?_s+=_i:(Qm=(31&_g)<<6|63&_u,Qm<128?_s+=_i:(_s+=Wt(Qm),_c++))):(240&_g)==224?_c+2>=_e?_s+=_i:(_u=_n[_c+_t+1],_h=_n[_c+_t+2],(49344&(_u|_h<<8))!=32896?_s+=_i:(Qm=(15&_g)<<12|(63&_u)<<6|63&_h,Qm<2048||Qm>=55296&&Qm<=57343?_s+=_i:(_s+=Wt(Qm),_c+=2))):(248&_g)==240?_c+3>=_e?_s+=_i:(_u=_n[_c+_t+1],_h=_n[_c+_t+2],_p=_n[_c+_t+3],(12632256&(_u|_h<<8|_p<<16))!=8421504?_s+=_i:(Qm=(7&_g)<<18|(63&_u)<<12|(63&_h)<<6|63&_p,Qm<65536||Qm>1114111?_s+=_i:(Qm-=65536,_s+=Wt(55296+(Qm>>10),56320+(1023&Qm)),_c+=3))):_s+=_i:_s+=Wt(_g)}return _s}function pI($,_e){let _t=_e.length,Wt=0;for(let _s=0;_s<_t;_s++){let _c=_e.charCodeAt(_s);_c>=55296&&_c<=56319&&_s+1<_t&&(_c=(_c<<10)+_e.charCodeAt(++_s)-56613888),Wt+=_c<128?1:_c<2048?2:_c<65536?3:4}X0($,Wt);let _n=DM($,Wt),_i=$.bytes;for(let _s=0;_s<_t;_s++){let _c=_e.charCodeAt(_s);_c>=55296&&_c<=56319&&_s+1<_t&&(_c=(_c<<10)+_e.charCodeAt(++_s)-56613888),_c<128?_i[_n++]=_c:(_c<2048?_i[_n++]=_c>>6&31|192:(_c<65536?_i[_n++]=_c>>12&15|224:(_i[_n++]=_c>>18&7|240,_i[_n++]=_c>>12&63|128),_i[_n++]=_c>>6&63|128),_i[_n++]=63&_c|128)}}function vR($){return $.bytes[wY($,1)]}function IY($,_e){let _t=DM($,1);$.bytes[_t]=_e}function VP($){let _e,_t=0,Wt=0;do _e=vR($),_t<32&&(Wt|=(127&_e)<<_t),_t+=7;while(128&_e);return Wt}function X0($,_e){for(_e>>>=0;_e>=128;)IY($,127&_e|128),_e>>>=7;IY($,_e)}function Whe($,_e){let _t,Wt=0,_n=0,_i=0;return _t=vR($),Wt=127&_t,128&_t&&(_t=vR($),Wt|=(127&_t)<<7,128&_t&&(_t=vR($),Wt|=(127&_t)<<14,128&_t&&(_t=vR($),Wt|=(127&_t)<<21,128&_t&&(_t=vR($),_n=127&_t,128&_t&&(_t=vR($),_n|=(127&_t)<<7,128&_t&&(_t=vR($),_n|=(127&_t)<<14,128&_t&&(_t=vR($),_n|=(127&_t)<<21,128&_t&&(_t=vR($),_i=127&_t,128&_t&&(_t=vR($),_i|=(127&_t)<<7))))))))),{low:Wt|_n<<28,high:_n>>>4|_i<<24,unsigned:_e}}function fI($,_e){let _t=_e.low>>>0,Wt=(_e.low>>>28|_e.high<<4)>>>0,_n=_e.high>>>24,_i=_n===0?Wt===0?_t<16384?_t<128?1:2:_t<1<<21?3:4:Wt<16384?Wt<128?5:6:Wt<1<<21?7:8:_n<128?9:10,_s=DM($,_i),_c=$.bytes;switch(_i){case 10:_c[_s+9]=_n>>>7&1;case 9:_c[_s+8]=_i!==9?128|_n:127&_n;case 8:_c[_s+7]=_i!==8?Wt>>>21|128:Wt>>>21&127;case 7:_c[_s+6]=_i!==7?Wt>>>14|128:Wt>>>14&127;case 6:_c[_s+5]=_i!==6?Wt>>>7|128:Wt>>>7&127;case 5:_c[_s+4]=_i!==5?128|Wt:127&Wt;case 4:_c[_s+3]=_i!==4?_t>>>21|128:_t>>>21&127;case 3:_c[_s+2]=_i!==3?_t>>>14|128:_t>>>14&127;case 2:_c[_s+1]=_i!==2?_t>>>7|128:_t>>>7&127;case 1:_c[_s]=_i!==1?128|_t:127&_t}}const AY={},OY={},LM=4294967296,qhe=LM*LM,NY=qhe/2;kY(0,!0);const PY=kY(0),zhe=BP(0,-2147483648,!1),Khe=BP(-1,2147483647,!1);function kY($,_e){let _t,Wt,_n;return _e?(_n=0<=($>>>=0)&&$<256)&&(Wt=OY[$],Wt)?Wt:(_t=BP($,0,!0),_n&&(OY[$]=_t),_t):(_n=-128<=($|=0)&&$<128)&&(Wt=AY[$],Wt)?Wt:(_t=BP($,$<0?-1:0,!1),_n&&(AY[$]=_t),_t)}function BP($,_e,_t){return{low:0|$,high:0|_e,unsigned:!!_t}}function $he($,_e){if(isNaN($))return PY;{if($<=-NY)return zhe;if($+1>=NY)return Khe}return $<0?PY:BP($%LM|0,$/LM|0,_e)}function DY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}class S8 extends A0{get connectionState(){return this._connectionState}set connectionState(_e){if(this._connectionState===_e)return;const _t=this._connectionState;this._connectionState=_e,this.emit(OR.CONNECTION_STATE_CHANGE,_e,_t)}get quality(){return this._quality}set quality(_e){this._quality=_e>1?1:_e<.1?.1:_e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(_e){var _t;super(),hE(this,"name","AgoraRTCImageModeration"),hE(this,"_connectionState",VT.CONNECTING),hE(this,"_sequence",0),hE(this,"_moderationStartTime",void 0),hE(this,"_workerConnection",void 0),hE(this,"_workerMessageLengthLimit",void 0),hE(this,"_qualityRatio",void 0),hE(this,"_connectInfo",void 0),hE(this,"_cancelTokenSource",tT.CancelToken.source()),hE(this,"_retryConfig",void 0),hE(this,"_moderationInterval",void 0),hE(this,"_moderationTimer",null),hE(this,"_moderationMode",1),hE(this,"_quality",1),hE(this,"_qualityTimer",null),hE(this,"_ticket",void 0),hE(this,"_moderationIntervalMinimum",void 0),hE(this,"_uploadFailedNum",0),hE(this,"_uploadNum",0),hE(this,"_uploadTimer",null),hE(this,"_extraInfo",void 0),hE(this,"_vendor",""),hE(this,"_encoder",new TextEncoder),hE(this,"_moderationId",void 0),hE(this,"inspectImage",()=>{if(this.connectionState!==VT.CONNECTED)throw new DE(mE.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===VT.CONNECTED?this.requestToInspectImage():iE.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=f0(5,"image-moderation-"),this._workerMessageLengthLimit=yE("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=yE("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(_t=_e.interval)!==null&&_t!==void 0?_t:1e3,_e.extraInfo&&(this._extraInfo=this._encoder.encode(_e.extraInfo)),_e.vendor&&(this._vendor=_e.vendor),this._qualityRatio=yE("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new oP("worker-"+this._moderationId,Y0),this.on(OR.STATE_CHANGE,(Wt,_n)=>{iE.debug("[".concat(this._moderationId,"] Moderation operation :").concat(LO[Wt]," ").concat(_n||""))}),this.handleWorkerEvents()}async init(_e,_t){this.emit(OR.STATE_CHANGE,LO.CONNECT_AP),this._connectInfo=_e;const Wt=this._cancelTokenSource.token;return this._retryConfig=_t,new n_((_n,_i)=>{this.on(OR.CONNECTION_STATE_CHANGE,(_s,_c)=>{_s===VT.CONNECTED&&_n()}),this.requestAP(_e,Wt,_t).then(_s=>{this.connectWorker(_s)}).catch(_s=>{_i(_s)})})}updateConfig(_e){var _t;this._moderationInterval=(_t=_e.interval)!==null&&_t!==void 0?_t:1e3,_e.extraInfo&&(this._extraInfo=this._encoder.encode(_e.extraInfo)),_e.vendor&&(this._vendor=_e.vendor),iE.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(_e))),this.connectionState===VT.CONNECTED&&this.inspectImage()}async requestAP(_e,_t,Wt){const _n=yE("WEBCS_DOMAIN").map(_u=>"https://".concat(_u,"/api/v1")),_i=await function(_u,_h,_p,Qm){let{appId:_g,areaCode:eE,cname:pE,sid:aE,token:cE,uid:fE}=_h;UO++;const gE="moderation_plugin",AE={service_name:gE,json_body:JSON.stringify({appId:_g,areaCode:eE,cname:pE,command:"allocateEdge",requestId:UO,seq:UO,sid:aE,appToken:cE,ts:Date.now(),uid:fE+""})};let PE,xE,GE=_u[0];return IR(async()=>{PE=Date.now();const zE=await PR(GE,{data:AE,cancelToken:_p,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(xE=Date.now()-PE,zE.code!==0){const c_=new DE(mE.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+zE.code,{retry:!0,responseTime:xE});throw iE.error(c_.toString()),c_}const KE=JSON.parse(zE.json_body);if(KE.code!==200){const c_=new DE(mE.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(KE.code,", reason: ").concat(KE.reason),{code:KE.code,responseTime:xE});throw iE.error(c_.toString()),c_}if(!KE.servers||!Array.isArray(KE.servers)||KE.servers.length===0){const c_=new DE(mE.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:KE.code,responseTime:xE});throw iE.error(c_.toString()),c_}if(!KE.servers.some(c_=>!!c_.wss)){const c_=new DE(mE.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:KE.code,responseTime:xE});throw iE.error(c_.toString()),c_}const JE=yE("IMAGE_MODERATION_WORKER_HOST");return{addressList:KE.servers.map(c_=>{let{address:V_,wss:Q_}=c_;if(V_&&Q_)return"wss://".concat(V_.replace(/\./g,"-"),".").concat(JE,":").concat(Q_,"/moderation")}).filter(c_=>!!c_),workerToken:KE.workerToken,vid:KE.vid,ticket:KE.appTicket,responseTime:xE}},(zE,KE)=>(p_.apworkerEvent(aE,{success:!0,sc:200,serviceName:gE,responseDetail:JSON.stringify(zE.addressList),firstSuccess:KE===0,responseTime:xE,serverIp:_u[KE%_u.length]}),!1),(zE,KE)=>(p_.apworkerEvent(aE,{success:!1,sc:zE.data&&zE.data.code||200,serviceName:gE,responseTime:xE,serverIp:_u[KE%_u.length]}),!!(zE.code!==mE.OPERATION_ABORTED&&zE.code!==mE.UNEXPECTED_RESPONSE||zE.data&&zE.data.retry)&&(GE=_u[(KE+1)%_u.length],!0)),Qm)}(_n,_e,_t,Wt);this.emit(OR.STATE_CHANGE,LO.AP_CONNECTED);const{addressList:_s,ticket:_c}=_i;return this._ticket=_c,_s}async connectWorker(_e){this.emit(OR.STATE_CHANGE,LO.CONNECT_WORKER),await this._workerConnection.init(_e,1e4)}handleWorkerEvents(){this._workerConnection.on(T_.CONNECTED,async()=>{this.emit(OR.STATE_CHANGE,LO.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=VT.CONNECTED}),this._workerConnection.on(T_.CLOSED,()=>{this.connectionState=VT.CLOSED}),this._workerConnection.on(T_.FAILED,()=>{this.connectionState=VT.CLOSED}),this._workerConnection.on(T_.RECONNECTING,()=>{this.connectionState=this.connectionState===VT.CONNECTED?VT.RECONNECTING:VT.CONNECTING}),this._workerConnection.on(T_.ON_MESSAGE,async _e=>{if(_e.data instanceof ArrayBuffer){const _t=Vhe(new Uint8Array(_e.data));yE("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&iE.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(_t)),this._uploadNum++,_t.code===void 0||_t.code===0||(this._uploadFailedNum++,iE.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(_t.code,", msg is ").concat(_t.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{p_.reportApiInvoke(this._connectInfo.sid||null,{name:Q0.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,_t.code],tag:j0.TRACER}).onError(new DE(mE.IMAGE_MODERATION_UPLOAD_FAILED,_t.msg)),this._uploadTimer=null},yE("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else iE.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(T_.WILL_RECONNECT,(_e,_t,Wt)=>{_e==="recover"&&Wt(_e),Wt("tryNext")}),this._workerConnection.on(T_.REQUEST_NEW_URLS,(_e,_t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(_e).catch(_t)})}static intToLong(_e){return{low:_e|=0,high:_e>>31,unsigned:_e>=0}}async requestToInspectImage(){const _e=mT(this,OR.CLIENT_LOCAL_VIDEO_TRACK),_t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(_e){if(!_e.isPlaying)return void(yE("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&iE.debug("Only the track being played can be inspected"));this._sequence++;const Wt=await this.generateRequestData(_e,_t);this._workerConnection.sendMessage(Wt,!0,!0)}else yE("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&iE.debug("Only the track being published can be inspected")}async generateRequestData(_e,_t){let{appId:Wt,cname:_n,cid:_i,vid:_s,sid:_c,uid:_u}=_t;const _h=Date.now(),_p=await _e.getCurrentFrameImage("image/jpeg",this.quality),Qm=await wK(_p,Wt,_n),_g=this._sequence+"-"+_i+"-"+_u+"-"+_h+"-"+f0(12,""),eE={appId:Wt,cid:_i,cname:_n,deviceId:"",elapse:S8.intToLong(Number(_h-this._moderationStartTime)),fileSize:_p.buffer.byteLength,height:_p.height,width:_p.width,jpg:Qm,networkType:6,osType:7,requestId:_g,sdkVersion:"4.21.0",sequence:this._sequence,sid:_c,timestamp:$he(_h),uid:_u,vid:_s,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete eE.callbackData;const pE=Fhe(eE);if(pE.byteLength<this._workerMessageLengthLimit){if(yE("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const aE=function(cE){for(var fE=1;fE<arguments.length;fE++){var gE=arguments[fE]!=null?arguments[fE]:{};fE%2?DY(Object(gE),!0).forEach(function(AE){hE(cE,AE,gE[AE])}):Object.getOwnPropertyDescriptors?Object.defineProperties(cE,Object.getOwnPropertyDescriptors(gE)):DY(Object(gE)).forEach(function(AE){Object.defineProperty(cE,AE,Object.getOwnPropertyDescriptor(gE,AE))})}return cE}({},eE);delete aE.jpg,iE.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(aE))}return pE}{const aE=this.quality*this._qualityRatio;return this.quality=aE,await this.generateRequestData(_e,{appId:Wt,cname:_n,cid:_i,vid:_s,sid:_c,uid:_u})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=tT.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=VT.CLOSED,this.emit(OR.STATE_CHANGE,LO.CLOSED)}}function LY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function xY($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?LY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):LY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const Yhe=Date.now(),Jhe=20,T8=new Map,xM=new Map;async function MY($){const _e=T8.get($),_t=Array.isArray(_e)&&_e[_e.length-1],Wt=xM.get($);if(!_t)return void(Wt.isSyncing=!1);const _n={uid:_t.uid,payload:_t.payload};Wt.firstRecvTs===0&&(Wt.firstRecvTs=_t.recvTs,Wt.firstSendTs=_t.sendTs);const _i=_t.sendTs-Wt.firstSendTs,_s=_i-(Date.now()-Wt.firstRecvTs);_s>0&&(Wt.firstRecvTs=Date.now()-_i);let _c=_t.mediaDelay+_s;_c<=0?(_e.pop(),UY(_t.context,_n),_c=0):_c=Math.min(_c,Jhe),setTimeout(()=>_e.length&&MY($),_c)}function UY($,_e){$.safeEmit(j_.STREAM_MESSAGE,_e.uid,_e.payload),$.onStreamMessage&&$.onStreamMessage(_e)}function Xhe($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_t=arguments.length>2?arguments[2]:void 0;if(!$.syncWithAudio)return UY(_t,{uid:$.uid,payload:$.payload});const Wt="".concat(_t.id,"-").concat($.uid),_n=T8.get(Wt)||[],_i=_n.findIndex(_h=>$.sendTs>=_h.sendTs),_s=xY(xY({},$),{},{context:_t,mediaDelay:_e,recvTs:Date.now()});_i===-1?_n.push(_s):_n.splice(_i,0,_s),T8.set(Wt,_n);let _c=!1;var _u;xM.has(Wt)?_c=!((_u=xM.get(Wt))===null||_u===void 0||!_u.isSyncing):xM.set(Wt,{isSyncing:_c,firstRecvTs:0,firstSendTs:0}),_c||MY(Wt)}const Zhe=W_().name;function jY($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function FY($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?jY(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):jY(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const pN="websdk_ng_cache_parameter",Qhe=yE("MAX_PRELOAD_ASYNC_LENGTH"),epe=1e4,eO=new Map,tO=[];let w8=null,R8=0,C8=0;const MM=new Map,tpe=function($,_e){const _t=[];let Wt=0;const _n=async()=>{const _i=_t.shift();_i&&await _i(),_t.length>0&&Wt<_e?_n():Wt--};return async function(){for(var _i=arguments.length,_s=new Array(_i),_c=0;_c<_i;_c++)_s[_c]=arguments[_c];return new n_(async(_u,_h)=>{_t.push(async()=>{try{const _p=await $(..._s);_u(_p)}catch(_p){_h(_p)}}),Wt<_e&&(Wt++,_n())})}}(VY,Qhe),I8=tT.CancelToken.source();async function VY($,_e,_t,Wt,_n){try{if(!yE("ENABLE_PRELOAD"))return;if(!B_().supportWebCrypto)return void q1(()=>{iE.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!_t&&_t!==null)throw new HE(mE.INVALID_PARAMS,"Invalid token: ".concat(_t,". If you don not use token, set it to null"));_t&&bS(_t,"token",1,2047),bS($,"appid",1,2047),NL(_e),Wt&&PL(Wt);const _i=eP();iE.debug("preload channel ".concat(_e,", uid is ").concat(Wt));const _s={appId:$,cname:_e,token:_t||$,uid:typeof Wt!="string"?Wt:null,sid:_i,proxyServer:_n};let _c,_u;typeof Wt=="string"?(_s.stringUid=Wt,[_u,_c]=await n_.all([Sle(Wt,{sid:_i,appId:$},I8.token),LW(FY(FY({},_s),{},{token:_t||$,uid:0}),I8.token)]),_s.uid=_u.uid,_c.gatewayInfo.uid=_s.uid,_c.gatewayInfo.res.uid=_s.uid):_c=await LW(_s,I8.token);const _h={sid:_i,appId:$,cname:_e,token:_t||$,uid:_s.stringUid||Wt,intUid:_s.uid||_c.gatewayInfo.uid,stringUid:_s.stringUid,ts:Date.now(),sua:_u,ap:_c};await async function(_p){let Qm;try{_p.uid&&GY({appId:_p.appId,cname:_p.cname,token:_p.token,uid:_p.uid,stringUid:_p.stringUid});const _g=zY(_p),eE=await async function(aE,cE){try{const fE=await window.crypto.subtle.importKey("raw",jH(cE),"AES-GCM",!1,["encrypt"]),gE=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},fE,PI(window.btoa(JSON.stringify(aE))));return z1(new Uint8Array(gE))}catch{return}}(_p,_p.token||_p.appId);if(!eE)return;Qm=qY(pN);const pE=Qm?JSON.parse(Qm):[];pE.push({[_g]:eE}),pE.length>yE("AP_CACHE_NUM")&&pE.shift(),UM(pN,JSON.stringify(pE))}catch(_g){iE.warn("Error caching server parameters:",_g.message),UM(pN,"")}}(_h),R8++}catch(_i){throw C8++,function(_s){w8||(w8=window.setTimeout(()=>{let _u="";MM.forEach((_h,_p)=>{_u+="".concat(_p,": ").concat(_h," ;")}),p_.reportApiInvoke(null,{name:Q0.PRELOAD,options:{success:R8,failed:C8,err:_u}}).onError(_s),R8=0,C8=0,MM.clear(),w8=null},epe));const _c=MM.get(_s.code)||0;MM.set(_s.code,_c+1)}(_i),_i}}async function BY($){try{const _e=GY($);if(!_e||$.cloudProxyServer!=="disabled")return;const _t=await async function(Wt,_n){try{const _i=await window.crypto.subtle.importKey("raw",jH(_n),"AES-GCM",!1,["decrypt"]),_s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},_i,PI(Wt));return JSON.parse(window.atob(z1(new Uint8Array(_s))))}catch{return}}(_e,$.token||$.appId);if(!_t||!function(Wt,_n){return Wt.cname===_n.cname&&Wt.appId===_n.appId&&Wt.token===_n.token?_n.stringUid?Wt.stringUid===_n.stringUid:typeof _n.uid=="number"?Wt.uid===_n.uid:Wt.uid==_n.uid:!1}(_t,$))return;if(_t&&Date.now()-_t.ts<yE("AP_CACHE_LIFETIME"))return _t}catch(_e){iE.warn("Error get preloadInfo",_e.message)}}function GY($){let _e;try{if(_e=qY(pN),!_e)return;const _t=JSON.parse(_e),Wt=zY($),_n=function(_s,_c){for(let _u=_s.length-1;_u>=0;_u--)if(_c(_s[_u]))return _u;return-1}(_t,_s=>Wt in _s);if(_n===-1)return;const _i=_t.splice(_n,1)[0];return UM(pN,JSON.stringify(_t)),_i[Wt]}catch(_t){iE.warn("Error delete preload info: ".concat(_e),_t.message),UM(pN,"")}}function A8($){if($){let _e=eO.get($);_e&&(window.clearTimeout(_e),_e=null,eO.delete($)),i_(tO).call(tO,$)||$.cloudProxyServer!=="disabled"||tO.push($)}if(eO.size<yE("AP_CACHE_NUM")&&tO.length>0){const _e=tO.shift();eO.set(_e,window.setTimeout(async()=>{const{appId:_t,cname:Wt,token:_n,uid:_i,proxyServer:_s}=_e;try{await tpe(_t,Wt,_n,_i,_s),eO.has(_e)&&A8(_e)}catch(_c){iE.warn("update preload failed",_c.message),HY(_e)}},yE("AP_UPDATE_INTERVAL")))}}function HY($){const _e=tO.indexOf($);_e!==-1&&tO.splice(_e,1);let _t=eO.get($);_t&&(window.clearTimeout(_t),_t=null,eO.delete($),A8())}function WY($,_e){const _t=$.sua,Wt=$.ap;_e&&_t&&p_.reqUserAccount($.sid,{lts:_t.requestTime,elapse:_t.elapse,success:!0,serverAddr:_t.url,stringUid:_e,uid:$.intUid,errorCode:null,extend:_t.req}),p_.reportResourceTiming($.ap.url,$.sid),p_.joinWebProxyAP($.sid,{lts:Wt.requestTime,elapse:Wt.elapse,sucess:1,apServerAddr:Wt.url,turnServerAddrList:Wt.proxyInfo.addresses.map(_n=>_n.ip).join(","),eventType:"disabled",unilbsServerIds:[J0.CHOOSE_SERVER,J0.CLOUD_PROXY_FALLBACK].toString()}),p_.joinChooseServer($.sid,{lts:Wt.requestTime,elapse:Wt.elapse,succ:!0,csAddr:Wt.url,opid:Wt.opid,serverList:Wt.gatewayInfo.gatewayAddrs.map(_n=>_n.address),ec:null,cid:Wt.gatewayInfo.cid.toString(),uid:Wt.gatewayInfo.uid.toString(),csIp:Wt.gatewayInfo.csIp,unilbsServerIds:[J0.CHOOSE_SERVER].toString(),isHttp3:Wt.isHttp3})}function qY($){return window.atob(window.localStorage.getItem($)||"")}function UM($,_e){window.localStorage.setItem($,window.btoa(_e))}function zY($){let _e="".concat($.appId,"_").concat($.cname);return typeof $.uid=="string"&&(_e+="_s_".concat($.uid)),typeof $.uid=="number"&&(_e+="_".concat($.uid)),$.token&&(_e+="_".concat($.token)),qH(_e)}var KY,$Y,YY,JY,XY,ZY,QY,eJ,tJ,nJ,rJ,iJ,oJ,sJ,aJ,cJ,lJ,uJ,dJ,hJ,pJ,fJ,mJ,gJ,EJ,vJ,_J,yJ,bJ,SJ,TJ,wJ,RJ,CJ,IJ,AJ,OJ,NJ,PJ,kJ,DJ,LJ,o_;function xJ($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function KT($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?xJ(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):xJ(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}mS.setLogger(iE);let npe=(KY=__(),$Y=__({argsMap:($,_e)=>{if(!Array.isArray(_e)){if(!(_e instanceof tN))return[_e];_e=[_e]}return _e.map(_t=>_t?Object(_t).toString():"null")}}),YY=__({argsMap:($,_e)=>(_e||(_e=[]),_e instanceof i9?[_e.getChannelId()]:(Array.isArray(_e)||(_e=[_e]),_e.map(_t=>_t.getTrackId())))}),JY=__({argsMap:($,_e,_t,Wt)=>[typeof _e=="object"?_e.uid:_e,_t,Wt]}),XY=__({argsMap:($,_e,_t)=>[_e,_t]}),ZY=__({argsMap:($,_e)=>_e.map(_t=>{let{user:Wt,mediaType:_n}=_t;return[Wt==null?void 0:Wt.uid,_n]})}),QY=__({argsMap:($,_e,_t,Wt)=>[typeof _e=="object"?_e.uid:_e,_t,Wt]}),eJ=__({argsMap:($,_e)=>_e.map(_t=>{let{user:Wt,mediaType:_n}=_t;return{uid:Wt==null?void 0:Wt.uid,mediaType:_n}})}),tJ=__(),nJ=__(),rJ=__(),iJ=__(),oJ=__(),sJ=__(),aJ=__(),cJ=__(),lJ=__(),uJ=__(),dJ=__(),hJ=__(),pJ=__(),fJ=__(),mJ=__({argsMap:($,_e)=>[_e]}),gJ=__(),EJ=__(),vJ=__(),_J=__(),yJ=__(),bJ=__(),SJ=__(),TJ=__(),wJ=__(),RJ=__(),CJ=__({argsMap:($,_e)=>(Array.isArray(_e)||(_e=[_e]),[JSON.stringify(_e)])}),IJ=__(),AJ=__(),OJ=__(),NJ=__(),PJ=__(),kJ=__(),DJ=__({reportResult:!0}),LJ=__(),o_=class extends A0{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var $;return(($=this._config)===null||$===void 0?void 0:$.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor($){let _e;if(super(),hE(this,"store",void 0),hE(this,"_uid",void 0),hE(this,"_channelName",void 0),hE(this,"_uintUid",void 0),hE(this,"_users",[]),hE(this,"_config",void 0),hE(this,"_clientId",void 0),hE(this,"_appId",void 0),hE(this,"_sessionId",null),hE(this,"_key",void 0),hE(this,"_rtmConfig",{}),hE(this,"_joinInfo",void 0),hE(this,"_gateway",void 0),hE(this,"_statsCollector",void 0),hE(this,"_configDistribute",void 0),hE(this,"_leaveMutex",new mS("client-leave")),hE(this,"_publishMutex",new mS("client-publish")),hE(this,"_renewTokenMutex",new mS("client-renewtoken")),hE(this,"_subscribeMutex",new mS("client-subscribe")),hE(this,"_encryptionMode","none"),hE(this,"_encryptionSecret",null),hE(this,"_encryptionSalt",null),hE(this,"_encryptDataStream",!1),hE(this,"_encryptDataStreamKey",null),hE(this,"_encryptDataStreamIv",null),hE(this,"_proxyServer",void 0),hE(this,"_turnServer",{servers:[],mode:"auto"}),hE(this,"_cloudProxyServerMode","disabled"),hE(this,"_isDualStreamEnabled",!1),hE(this,"_defaultStreamFallbackType",void 0),hE(this,"_lowStreamParameter",void 0),hE(this,"_streamFallbackTypeCacheMap",new Map),hE(this,"_remoteStreamTypeCacheMap",new Map),hE(this,"_axiosCancelSource",tT.CancelToken.source()),hE(this,"_audioVolumeIndicationInterval",void 0),hE(this,"_networkQualityInterval",void 0),hE(this,"_userOfflineTimeout",void 0),hE(this,"_streamRemovedTimeout",void 0),hE(this,"_injectStreamingClient",void 0),hE(this,"_liveTranscodeStreamingClient",void 0),hE(this,"_liveRawStreamingClient",void 0),hE(this,"_channelMediaRelayClient",void 0),hE(this,"_networkQualitySensitivity","normal"),hE(this,"_p2pChannel",void 0),hE(this,"_useLocalAccessPoint",!1),hE(this,"_setLocalAPVersion",void 0),hE(this,"_joinAndNotLeaveYet",!1),hE(this,"_numberOfJoinCount",0),hE(this,"_remoteDefaultVideoStreamType",void 0),hE(this,"_inspect",void 0),hE(this,"_moderation",void 0),hE(this,"_license",void 0),hE(this,"_pendingPublishedUsers",[]),hE(this,"ntpAlignErrorCount",0),hE(this,"remoteInboundOffset",0),hE(this,"_handleLocalTrackEnable",(_t,Wt,_n)=>{this.publish(_t,!1).then(Wt).catch(_n)}),hE(this,"_handleLocalTrackDisable",(_t,Wt,_n)=>{this.unpublish(_t).then(Wt).catch(_n)}),hE(this,"_handleUserOnline",_t=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(_t.uid,this.channelName))return void iE.debug("[".concat(_t.uid,"] will be ignored in local"));this.isStringUID&&typeof _t.uid!="string"&&iE.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const Wt=this._users.find(_n=>_n.uid===_t.uid);if(Wt)Wt._trust_in_room_=!0,Wt._is_pre_created&&(Wt._is_pre_created=!1,this.safeEmit(j_.USER_JOINED,Wt));else{const _n=new cI(_t.uid,_t.uint_id||_t.uid);this._users.push(_n),iE.debug("[".concat(this._clientId,"] user online"),_t.uid),this.safeEmit(j_.USER_JOINED,_n)}}),hE(this,"_handleUserOffline",_t=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(_t.uid,this.channelName))return;const Wt=this._users.find(_n=>_n.uid===_t.uid);Wt&&(this._handleRemoveStream(_t),this._handleRemoveDataChannels(_t),Wt._audio_pre_subscribed||Wt._video_pre_subscribed?Wt._is_pre_created=!0:bL(this._users,Wt),this._remoteStreamTypeCacheMap.delete(Wt.uid),this._streamFallbackTypeCacheMap.delete(Wt.uid),iE.debug("[".concat(this._clientId,"] user offline"),_t.uid,"reason:",_t.reason),this.safeEmit(j_.USER_LEAVED,Wt,_t.reason))}),hE(this,"_handleAddAudioOrVideoStream",(_t,Wt,_n,_i,_s,_c,_u)=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(Wt,this.channelName))return;const _h=this._users.find(Qm=>Qm.uid===Wt);if(!_h)return void iE.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));iE.debug("[".concat(this._clientId,"] stream added with uid ").concat(Wt,", type ").concat(_t)),this.store.subscribe(_h.uid,_t,void 0,void 0,void 0,Date.now());const _p=_t==="audio"?_h.hasAudio:_h.hasVideo;_h._uintid||(_h._uintid=_s||Wt),_t==="audio"?_h._trust_audio_stream_added_state_=!0:_h._trust_video_stream_added_state_=!0,_t==="audio"?(_h._audio_added_=!0,_n!==void 0&&(_h._audioSSRC=_n),_i!==void 0&&(_h._cname=_i),_c&&(_h._audioOrtc=_c)):(_h._video_added_=!0,_n!==void 0&&(_h._videoSSRC=_n),_i!==void 0&&(_h._cname=_i),_u!==void 0&&(_h._rtxSsrcId=_u),_c&&(_h._videoOrtc=_c)),(_t==="audio"?_h.hasAudio:_h.hasVideo)&&!_p&&(iE.info("[".concat(this._clientId,"] remote user ").concat(_h.uid," published ").concat(_t)),this.safeEmit(j_.USER_PUBLISHED,_h,_t)),_t==="video"?p_.onGatewayStream(this._sessionId,gS.ON_ADD_VIDEO_STREAM,L0.ON_ADD_VIDEO_STREAM,{peer:_s||Wt,ssrc:_h._videoSSRC}):p_.onGatewayStream(this._sessionId,gS.ON_ADD_AUDIO_STREAM,L0.ON_ADD_AUDIO_STREAM,{peer:_s||Wt,ssrc:_h._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(_h,_t,_n).then(Qm=>{if(Qm&&(iE.debug("[".concat(this._clientId,"] resubscribe ").concat(_t," for user ").concat(_h.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof PM))return this._p2pChannel.unsubscribe(_h,_t,!0).then(()=>this._subscribe(_h,_t,!0).catch(_g=>{iE.error("[".concat(this._clientId,"] resubscribe error"),_g.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(_h,_t)&&(iE.debug("[".concat(this._clientId,"] resubscribe ").concat(_t," for user ").concat(_h.uid," after reconnect.")),this._subscribe(_h,_t,!0).catch(Qm=>{iE.error("[".concat(this._clientId,"] resubscribe error"),Qm.toString())}))}),hE(this,"_handleRemoveStream",_t=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(_t.uid,this.channelName))return;const Wt=this._users.find(_i=>_i.uid===_t.uid);if(!Wt)return void iE.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));iE.debug("[".concat(this._clientId,"] stream removed with uid ").concat(_t.uid));let _n=()=>{};Wt.hasAudio&&Wt.hasVideo?_n=()=>{iE.info("[".concat(this._clientId,"] remote user ").concat(Wt.uid," unpublished audio track")),this.safeEmit(j_.USER_UNPUBLISHED,Wt,"audio"),iE.info("[".concat(this._clientId,"] remote user ").concat(Wt.uid," unpublished video track")),this.safeEmit(j_.USER_UNPUBLISHED,Wt,"video")}:Wt.hasVideo?_n=()=>{iE.info("[".concat(this._clientId,"] remote user ").concat(Wt.uid," unpublished video track")),this.safeEmit(j_.USER_UNPUBLISHED,Wt,"video")}:Wt.hasAudio&&(_n=()=>{iE.info("[".concat(this._clientId,"] remote user ").concat(Wt.uid," unpublished audio track")),this.safeEmit(j_.USER_UNPUBLISHED,Wt,"audio")}),Wt._video_pre_subscribed||Wt._audio_pre_subscribed||(Wt._trust_audio_stream_added_state_=!0,Wt._trust_video_stream_added_state_=!0,Wt._audio_added_=!1,Wt._video_added_=!1,this._p2pChannel instanceof PM&&this._p2pChannel.unsubscribe(Wt).then(_i=>{if(_i)return this._gateway.unsubscribe(_i,Wt.uid)}),Wt._audioSSRC=void 0,Wt._videoSSRC=void 0,Wt._audioOrtc=void 0,Wt._videoOrtc=void 0,Wt._rtxSsrcId=void 0),p_.onGatewayStream(this._sessionId,gS.ON_REMOVE_STREAM,L0.ON_REMOVE_STREAM,{peer:_t.uint_id||_t.uid}),_n()}),hE(this,"_handleSetStreamLocalEnable",(_t,Wt,_n)=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(Wt,this.channelName))return;const _i=this._users.find(_u=>_u.uid===Wt);if(!_i)return void iE.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));iE.debug("[".concat(this._clientId,"] local ").concat(_t," ").concat(_n?"enabled":"disabled"," with uid ").concat(Wt));const _s=_t==="audio"?_i.hasAudio:_i.hasVideo;if(_t==="audio"){_i._trust_audio_enabled_state_=!0;const _u=_i._audio_enabled_;if(_i._audio_enabled_=_n,_i._audio_enabled_===_u)return;{const _h=_i._audio_enabled_?"enable-local-audio":"disable-local-audio";iE.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(Wt,", msg: ").concat(_h)),this.safeEmit(j_.USER_INFO_UPDATED,Wt,_h)}}else{_i._trust_video_enabled_state_=!0;const _u=_i._video_enabled_;if(_i._video_enabled_=_n,_i._video_enabled_===_u)return;{const _h=_i._video_enabled_?"enable-local-video":"disable-local-video";iE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(Wt,", msg: ").concat(_h)),this.safeEmit(j_.USER_INFO_UPDATED,Wt,_h)}}const _c=_t==="audio"?_i.hasAudio:_i.hasVideo;return _s!==_c?!_s&&_c?(iE.info("[".concat(this._clientId,"] remote user ").concat(Wt," published ").concat(_t)),void this.safeEmit(j_.USER_PUBLISHED,_i,_t)):(_t==="video"&&_i._videoTrack&&_i._videoTrack._destroy(),_t==="audio"&&_i._audioTrack,this._p2pChannel.muteRemote(_i,_t),iE.info("[".concat(this._clientId,"] remote user ").concat(Wt," unpublished ").concat(_t)),void this.safeEmit(j_.USER_UNPUBLISHED,_i,_t)):void 0}),hE(this,"_handleMuteStream",(_t,Wt,_n)=>{if(yE("BLOCK_LOCAL_CLIENT")&&DI(_t,this.channelName))return;iE.debug("[".concat(this._clientId,"] receive mute message"),_t,Wt,_n);const _i=this._users.find(_u=>_u.uid===_t);if(!_i)return void iE.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(_t));const _s=Wt==="audio"?_i.hasAudio:_i.hasVideo;if(Wt==="audio"){_i._trust_audio_mute_state_=!0;const _u=_i._audio_muted_;if(_i._audio_muted_=_n,_i._audio_muted_===_u)return;{const _h=_i._audio_muted_?"mute-audio":"unmute-audio";iE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(_t,", msg: ").concat(_h)),this.safeEmit(j_.USER_INFO_UPDATED,_t,_h)}}else{_i._trust_video_mute_state_=!0;const _u=_i._video_muted_;if(_i._video_muted_=_n,_i._video_muted_===_u)return;{const _h=_i._video_muted_?"mute-video":"unmute-video";iE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(_t,", msg: ").concat(_h)),this.safeEmit(j_.USER_INFO_UPDATED,_t,_h)}}const _c=Wt==="audio"?_i.hasAudio:_i.hasVideo;if(_s!==_c){if(!_s&&_c)return(Wt==="audio"?_i._audioSSRC:_i._videoSSRC)?(iE.info("[".concat(this._clientId,"] remote user ").concat(_t," published ").concat(Wt)),void this.safeEmit(j_.USER_PUBLISHED,_i,Wt)):void iE.warning("[".concat(this._clientId,"] remote user ").concat(_t," receive ").concat(Wt," unmute message  before add stream message, ").concat(Wt," SSRC doesn't exist yet."));Wt==="video"&&_i._videoTrack&&!_i._video_pre_subscribed&&_i._videoTrack._destroy(),Wt==="audio"&&_i._audioTrack,this._p2pChannel.muteRemote(_i,Wt),iE.info("[".concat(this._clientId,"] remote user ").concat(_t," unpublished ").concat(Wt)),this.safeEmit(j_.USER_UNPUBLISHED,_i,Wt)}}),hE(this,"_handleP2PLost",async _t=>{iE.debug("[".concat(this._clientId,"] receive p2p lost"),_t),parseInt(_t.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():iE.warning("[".concat(this._clientId,"] P2PLost stream not found"),_t)}),hE(this,"_handleTokenWillExpire",()=>{iE.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(j_.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),hE(this,"_handleBeforeUnload",_t=>{_t.type==="beforeunload"&&_t.returnValue!==void 0&&_t.returnValue!==""||(this.leave(),iE.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),hE(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(j_.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const _t={downlinkNetworkQuality:0,uplinkNetworkQuality:0};_t.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),_t.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(j_.NETWORK_QUALITY,_t)}),hE(this,"_handleP2PAddAudioOrVideoStream",(_t,Wt,_n,_i)=>{const _s=this._users.find(_u=>_u.uid===Wt);if(!_s)return void iE.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));iE.debug("[".concat(this._clientId,"] stream added with uid ").concat(Wt,", type ").concat(_t)),this.store.subscribe(_s.uid,_t,void 0,void 0,void 0,Date.now());const _c=_t==="audio"?_s.hasAudio:_s.hasVideo;_t==="audio"?_s._trust_audio_stream_added_state_=!0:_s._trust_video_stream_added_state_=!0,_t==="audio"?(_s._audio_added_=!0,_n!==void 0&&(_s._audioSSRC=_n),_i!==void 0&&(_s._audioMid=_i)):(_s._video_added_=!0,_n!==void 0&&(_s._videoSSRC=_n),_i!==void 0&&(_s._videoMid=_i)),(_t==="audio"?_s.hasAudio:_s.hasVideo)&&!_c&&(iE.info("[".concat(this._clientId,"] remote user ").concat(_s.uid," published ").concat(_t)),this.safeEmit(j_.USER_PUBLISHED,_s,_t)),this._p2pChannel.hasPendingRemoteMedia(_s,_t)&&(iE.debug("[".concat(this._clientId,"] resubscribe ").concat(_t," for user ").concat(_s.uid," after reconnect.")),this._subscribe(_s,_t,!0).catch(_u=>{iE.error("[".concat(this._clientId,"] resubscribe error"),_u.toString())}))}),this._config=$,this._clientId=f0(5,"client-"),this.store=new sce($.codec,$.audioCodec,$.mode,this._clientId),this.store.clientCreated(),$.proxyServer&&this.setProxyServer($.proxyServer,!0),$.turnServer&&this.setTurnServer($.turnServer,!0),iE.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(jT," build: ").concat(AV,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),$.clientRoleOptions)try{MH($.clientRoleOptions),_e=Object.assign({},$.clientRoleOptions)}catch(_t){iE.warning("[".concat(this._clientId,"] ").concat(_t.toString()))}this._statsCollector=new UP(this.store),this._statsCollector.onStatsException=(_t,Wt,_n)=>{iE.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(_t,", msg: ").concat(Wt,", uid: ").concat(_n)),this.safeEmit(j_.EXCEPTION,{code:_t,msg:Wt,uid:_n})},this._statsCollector.onUploadPublishDuration=(_t,Wt,_n,_i)=>{const _s=this._users.find(_c=>_c.uid===_t);_s&&p_.peerPublishStatus(this._sessionId,{subscribeElapse:_i,audioPublishDuration:Wt,videoPublishDuration:_n,peer:_s._uintid})},this.store.useDataChannel=B_().supportDataChannel&&yE("SIGNAL_CHANNEL"),this.store.useP2P=$.mode==="p2p",this._gateway=new gle(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:$.websocketRetryConfig||Y0,httpRetryConfig:$.httpRetryConfig||Y0,forceWaitGatewayResponse:$.forceWaitGatewayResponse===void 0||$.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:$.role,clientRoleOptions:_e}),this._configDistribute=new Cle,this.store.useP2P?(this._p2pChannel=new vT(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new PM(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta($,_e,_t,Wt,_n){let _i=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],_s=arguments.length>6&&arguments[6]!==void 0&&arguments[6];d0("JOIN_GATEWAY_USE_443PORT_ONLY",_i),d0("JOIN_GATEWAY_USE_DUAL_DOMAIN",_s);const _c=this._gateway.signal.websocket;return _c instanceof iP&&(_c.use443PortOnly=_i,_c.tryDoubleDomain=_s),async function(_u,_h,_p){gL.get(_u)||gL.set(_u,[]),EL.get(_u)||EL.set(_u,_h),JR.get(_u)||JR.set(_u,0);const Qm=gL.get(_u),_g=EL.get(_u);if(!Qm||!_g)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(JR.get(_u)===_g){const fE=JN();Qm.push(fE),await fE.promise}JR.set(_u,JR.get(_u)+1);for(var eE=arguments.length,pE=new Array(eE>3?eE-3:0),aE=3;aE<eE;aE++)pE[aE-3]=arguments[aE];const cE=await _p(...pE);return JR.set(_u,JR.get(_u)-1),JR.get(_u)===_g-1&&Qm.length>0&&(Qm[0].resolve(),Qm.shift()),JR.get(_u)===0&&(gL.set(_u,[]),EL.set(_u,0),JR.set(_u,0)),cE}("client.join",yE("JOIN_MAX_CONCURRENCY"),this.join.bind(this),$,_e,_t,Wt,_n)}async join($,_e,_t,Wt,_n){const _i=++this._numberOfJoinCount;this.store.joinStart(),Wt&&(this.store.uid=Wt);const _s=(CL||CL||(CL=(window.location.protocol.split(":")[0]||"").toUpperCase(),CL))==="HTTPS",_c=zH()?window.isSecureContext:"Browser Not Support";(!zH()&&!_s||!window.isSecureContext)&&iE.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),iE.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),p_.setAppId($);try{if(!_t&&_t!==null)throw new DE(mE.INVALID_PARAMS,"Invalid token: ".concat(_t,". If you don not use token, set it to null"));_t&&bS(_t,"token",1,2047),bS($,"appid",1,2047),NL(_e),Wt&&PL(Wt),_n&&bS(_n,"optionalInfo",1,2047)}catch(aE){throw p_.reportApiInvoke(eP(),{name:Q0.JOIN,options:[$,_e,_t,Wt],states:{isHttps:_s,isSecureContext:_c},tag:j0.TRACER}).onError(aE),aE}const _u=await BY({appId:$,cname:_e,uid:Wt,stringUid:typeof Wt=="string"?Wt:void 0,token:_t||$,cloudProxyServer:this._cloudProxyServerMode}),_h=(_u==null?void 0:_u.sid)||eP(),_p=p_.reportApiInvoke(_h,{name:Q0.JOIN,options:[$,_e,_t,Wt],states:{isHttps:_s,isSecureContext:_c},tag:j0.TRACER});if(iE.info("[".concat(this._clientId,"] start join channel ").concat(_e,", join number: ").concat(_i)),this._leaveMutex.isLocked&&(iE.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),iE.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const aE=new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw _p.onError(aE),aE}this._sessionId||(this._sessionId=_h,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const Qm=KT(KT({},this._rtmConfig),{},{clientId:this._clientId,appId:$,sid:this._sessionId,cname:_e,uid:typeof Wt!="string"?Wt:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:_t||$,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:_n,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!_u},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(Qm.setLocalAPVersion=this._setLocalAPVersion),typeof Wt=="string"&&(Qm.stringUid=Wt,this._uintUid?(Qm.uid=this._uintUid,this._uintUid=void 0):Qm.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(Qm.aesmode=this._encryptionMode,Qm.aespassword=await(async aE=>{const cE=function(PE){const xE=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),GE=new Uint8Array(new ArrayBuffer(xE.length));for(let zE=0;zE<xE.length;zE+=1)GE[zE]=xE.charCodeAt(zE);return GE}(),fE=await window.crypto.subtle.importKey("spki",cE,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),gE=_V(aE),AE=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},fE,gE);return function(PE){let xE="";for(let GE=0;GE<PE.length;GE+=1)xE+=String.fromCharCode(PE[GE]);return window.btoa(xE)}(new Uint8Array(AE))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(Qm.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const aE=new TextEncoder,cE=yE("USE_PURE_ENCRYPTION_MASTER_KEY")?aE.encode(Qm.appId+this._encryptionSecret+this._encryptionSecret):aE.encode(Qm.appId+Qm.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(fE,gE,AE){const PE=await window.crypto.subtle.importKey("raw",gE,"PBKDF2",!1,["deriveBits","deriveKey"]),xE=fE==="aes-128-gcm2"?128:256,GE=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:$H,hash:"SHA-256",salt:AE},PE,xE+ace);return new Uint8Array(GE).subarray(xE/8)}(this._encryptionMode,cE,PI(this._encryptionSalt)),this._encryptDataStreamKey=await async function(fE,gE,AE){const PE=await window.crypto.subtle.importKey("raw",gE,"PBKDF2",!1,["deriveBits","deriveKey"]),xE=fE==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:$H,hash:"SHA-256",salt:AE},PE,{name:"AES-GCM",length:xE},!0,["encrypt","decrypt"])}(this._encryptionMode,cE,PI(this._encryptionSalt))}else _c?iE.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):iE.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,iE.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:_e,appId:$,stringUid:Qm.stringUid,preload:Qm.preload});const _g=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&_g===this._sessionId&&p_.joinChannelTimeout(this._sessionId,5)},5e3);try{var eE;let aE;const cE=Qm.cloudProxyServer;if(i_(eE=["proxy3","proxy4","proxy5"]).call(eE,cE)){const xE=yE("PROXY_SERVER_TYPE3");Array.isArray(xE)?Qm.proxyServer=xE[0]:Qm.proxyServer=xE}if(p_.setProxyServer(Qm.proxyServer),iE.setProxyServer(Qm.proxyServer),this.store.requestAPStart(),_u){if(iE.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(Qm.stringUid?", ".concat(Qm.stringUid," => ").concat(_u.intUid):""," ")),Qm.stringUid&&!Qm.uid&&(Qm.uid=_u.intUid),aE={gatewayInfo:_u.ap.gatewayInfo},yE("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&Qm.turnServer.mode==="auto")if(_u.ap.proxyInfo.addresses.length===0)iE.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const xE=(await yW(_u.ap.proxyInfo,_u.ap.gatewayInfo.uid)).map(GE=>({turnServerURL:GE.address,tcpport:GE.tcpport||CS.tcpport,udpport:GE.udpport||CS.udpport,username:GE.username||CS.username,password:GE.password||CS.password,forceturn:!1,security:!0}));Qm.turnServer={mode:"manual",servers:xE}}WY(_u,Qm.stringUid)}else{if(Qm.stringUid&&!Qm.uid){let xE;[xE,aE]=await n_.all([DW(Qm.stringUid,Qm,this._axiosCancelSource.token,this._config.httpRetryConfig||Y0,this.store),kW(Qm,this._axiosCancelSource.token,this._config.httpRetryConfig||Y0,!0,this.store)]),iE.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(Qm.stringUid," => ").concat(xE)),Qm.uid=xE,aE.gatewayInfo.uid=xE,aE.gatewayInfo.res.uid=xE}else aE=await kW(Qm,this._axiosCancelSource.token,this._config.httpRetryConfig||Y0,!0,this.store);if(!this._joinAndNotLeaveYet)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(Qm,this._axiosCancelSource.token),this._configDistribute.on(jV.UPDATE_BITRATE_LIMIT,xE=>{this._p2pChannel.updateBitrateLimit(xE)})},0),this._key=_t||$;const fE=aE.gatewayInfo,gE=Qm.uid?Qm.uid:fE.uid;this._joinInfo=KT(KT({},Qm),{},{cid:fE.cid,uid:gE,vid:fE.vid,apResponse:fE.res,uni_lbs_ip:fE.uni_lbs_ip,gatewayAddrs:fE.gatewayAddrs}),this.store.intUid=gE;const AE=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));_p.onSuccess(AE),this._appId=$,this._channelName=Qm.cname,this._uid=AE,this.store.uid=AE,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(dS()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const PE=Qm.stringUid?"string uid: ".concat(Qm.stringUid,",uid: ").concat(Qm.uid):"uid: ".concat(this._uid);return iE.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(_e,",").concat(PE)),setTimeout(()=>{iE.startUpload()},5e3),this.store.joinEnd(),pE=this,i_($1).call($1,pE)||$1.push(pE),this._cloudProxyServerMode==="disabled"&&B_().supportWebCrypto&&yE("ENABLE_PRELOAD")&&A8(this._joinInfo),AE}catch(aE){const cE=Array.isArray(aE)?aE[0]:aE;throw cE&&cE.code===mE.OPERATION_ABORTED?iE.warning("[".concat(this._clientId,"] join number: ").concat(_i,", Joining channel failed, rollback"),cE):iE.error("[".concat(this._clientId,"] join number: ").concat(_i,", Joining channel failed, rollback"),cE),cE.code!==mE.OPERATION_ABORTED&&this._numberOfJoinCount===_i&&(this._gateway.state="DISCONNECTED",this._reset()),_p.onError(cE),cE}var pE}_joinGateway(){if(!this._joinInfo||!this._key)throw new DE(mE.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!yE("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then($=>$).catch($=>{if($.code===mE.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,U_.FALLBACK),$;if($.code===mE.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,U_.FALLBACK),$;throw $}).then($=>{if($ instanceof DE){if($.code===mE.INIT_WEBSOCKET_TIMEOUT){if(iE.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new DE(mE.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const _e=yE("PROXY_SERVER_TYPE3");if(Array.isArray(_e))if(this._joinInfo.apUrl){const Wt=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),_n=Wt.slice(Wt.length-2).join(".");_e.forEach(_i=>{this._joinInfo&&i_(_i).call(_i,_n)&&(this._joinInfo.proxyServer=_i)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=_e[0])}else this._joinInfo.proxyServer=_e[0];else this._joinInfo.proxyServer=_e;const _t=yE("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return _t&&_t[1]&&_t[1]!=="443"&&iE.setProxyServer(this._joinInfo.proxyServer),yE("STATS_COLLECTOR_PORT").toString()!=="443"&&p_.setProxyServer(this._joinInfo.proxyServer),p_.reportApiInvoke(this._sessionId,{name:Q0.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:j0.TRACER}).onSuccess(),this.safeEmit(j_.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),yE("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(Wt=>{"forceturn"in Wt&&(Wt.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(iE.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new DE(mE.INVALID_OPERATION);return p_.reportApiInvoke(this._sessionId,{name:Q0.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:j0.TRACER}).onSuccess(),this._joinGateway()}return $}).then($=>$)}async leave(){iE.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(dS()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(_e){const _t=$1.indexOf(_e);_t!==-1&&$1.splice(_t,1)}(this),this._statsCollector.stopUpdateStats();const $=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return iE.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void $();await this._gateway.leave(this.connectionState!=="CONNECTED"),iE.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),$()}async publish($){let _e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray($)){if(!($ instanceof tN))return this._publishDataChannel($);$=[$]}if($.length===0)throw new DE(mE.INVALID_PARAMS,"param list is empty");const _t=$;if(this._gateway.role==="audience")throw new DE(mE.INVALID_OPERATION,"audience can not publish stream");for(const _n of _t){if(!(_n instanceof tN))throw new DE(mE.INVALID_PARAMS,"parameter is not local track");if(!_n._enabled&&_e)throw new DE(mE.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(_n.getTrackId()))}iE.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(_t.map(_n=>"".concat(_n.getTrackId()," "))));const Wt=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),_e&&_t.forEach(_n=>{const _i=this._configDistribute.getBitrateLimit();_n instanceof m0&&_i&&_n.setBitrateLimit(_i.uplink)});try{await this._publishHighStream(_t),iE.info("[".concat(this._clientId,"] Publish success, id ").concat(_t.map(_n=>"".concat(_n.getTrackId()," "))))}catch(_n){throw iE.error("[".concat(this._clientId,"] publish error"),_n.toString()),_n}finally{Wt()}}async _publishDataChannel($){u0($.id,"id",0,65535,!0),E1($.ordered,"ordered"),bS($.metadata,"metadata",0,512),iE.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat($.id));const _e=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(Wt=>Wt.id===$.id)!==-1)throw new DE(mE.INVALID_PARAMS,"Invalid id: ".concat($.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new DE(mE.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&yE("FORCE_TURN")&&!yE("TURN_ENABLE_TCP")&&!yE("TURN_ENABLE_UDP"))throw new DE(mE.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const _t=new i9($);if(await this._p2pChannel.publishDataChannel([_t]),!this._p2pChannel.isP2PDisconnected()){if(typeof _t._originDataChannelId!="number")throw iE.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new DE(mE.CREATE_DATACHANNEL_ERROR);try{const Wt={streamId:$.id,ordered:$.ordered,maxRetransmits:yE("DATASTREAM_MAX_RETRANSMITS"),metadata:$.metadata,channelId:_t._originDataChannelId};await this._gateway.publishDataChannel(this._uid,Wt,!0),await _t._waitTillOpen()}catch(Wt){if(Wt.code!==mE.DISCONNECT_P2P)throw Wt}}return iE.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(_t.id)),_t}catch(_t){throw iE.error("[".concat(this._clientId,"] publish datachannels error"),_t.toString()),_t}finally{_e()}}async unpublish($){if(!this._joinInfo||this._uid===void 0)throw new DE(mE.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let _e=[];if($)if(Array.isArray($))_e=$;else{if(!($ instanceof tN))return this._unpublishDataChannel([$]);_e=[$]}else this.store.useP2P||await this._unpublishDataChannel(),_e=this._p2pChannel.getAllTracks(!0);iE.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(_e.map(Wt=>"".concat(Wt.getTrackId()," "))," "));const _t=await this._publishMutex.lock();try{if(this._p2pChannel instanceof vT){const Wt=await this._p2pChannel.unpublish(_e);Wt&&await this._gateway.sendExtensionMessage(W0.UNPUBLISH,{unpubMsg:Wt},!0)}else{const Wt=await this._p2pChannel.unpublish(_e);Wt&&await this._gateway.unpublish(Wt,this._uid),iE.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(_e.map(_n=>"".concat(_n.getTrackId()))))}}catch(Wt){throw iE.error("[".concat(this._clientId,"] unpublish error"),Wt.toString()),Wt}finally{_t&&_t()}}async _unpublishDataChannel($){$!==void 0&&$.length!==0||($=this._p2pChannel.getAllDataChannels()),iE.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat($.map(_t=>"".concat(_t.id," "))," "));const _e=await this._publishMutex.lock();try{const _t=await this._p2pChannel.unpublishDataChannel($);_t&&await this._gateway.unpublishDataChannel(_t),iE.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat($.map(Wt=>"".concat(Wt.id))))}catch(_t){throw iE.error("[".concat(this._clientId,"] unpublish dataChannel error"),_t.toString()),_t}finally{_e&&_e()}}async subscribe($,_e,_t){if(!($ instanceof cI)){const Wt=this.remoteUsers.find(_n=>_n.uid===$);if(!Wt)throw new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");$=Wt}return _e==="datachannel"?this._subscribeDataChannel($,_t):this._subscribe($,_e)}async presubscribe($,_e){if(aS(_e,"mediaType",["audio","video"]),this._p2pChannel instanceof vT)throw new DE(mE.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const _t=_e===h_.AUDIO,Wt=_e===h_.VIDEO,_n=await this._subscribeMutex.lock();try{const{ssrcId:_i,ortc:_s,rtxSsrcId:_c,cname:_u,uint_id:_h}=await this._gateway.presubscribe($,_e,!0);if(_i==null)throw new DE(mE.UNEXPECTED_RESPONSE,"no ssrc id");let _p=this._users.find(_g=>_g.uid===$);_p||(_p=new cI($,_h||$),_p._is_pre_created=!0,this._users.push(_p)),_u&&(_p._cname=_u),_p._uintid||(_p._uintid=_h||$),_t&&(_p._audioSSRC=_i,_p._audio_pre_subscribed=!0,_s&&(_p._audioOrtc=_s)),Wt&&(_p._videoSSRC=_i,_p._video_pre_subscribed=!0,_s&&(_p._videoOrtc=_s),_c!=null&&(_p._rtxSsrcId=_c)),iE.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(_i)),await this._p2pChannel.subscribe(_p,_e,_i,_c,_s);const Qm=_t?_p._audioTrack:_p._videoTrack;if(!Qm)throw new DE(mE.UNEXPECTED_ERROR,"can not find remote track in user");return _t&&(_p._trust_audio_stream_added_state_=!0,_p._audio_added_=!0),Wt&&(_p._trust_video_stream_added_state_=!0,_p._video_added_=!0),Qm}catch(_i){throw iE.error("[".concat(this._clientId,"] presub user ").concat($," error"),_i),_i}finally{_n()}}async _subscribeDataChannel($,_e){var _t;if(u0(_e,"channelId",0,65535,!0),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(_c=>_c===$))throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", this user is not in the channel")),new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");if(!$.hasAudio&&!$.hasVideo&&$._dataChannels.length===0)throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", user is not published")),new DE(mE.INVALID_REMOTE_USER,"user is not published");const _n=(_t=$._dataChannels)===null||_t===void 0?void 0:_t.find(_c=>_c.id===_e);if(!_n)throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid," with mediaType datachannel, remote datachannel is not published")),new DE(mE.REMOTE_USER_IS_NOT_PUBLISHED);const _i=await this._subscribeMutex.lock();iE.info("[".concat(this._clientId,"] subscribe user ").concat($.uid,", mediaType: datachannel"));try{const _c=await this._p2pChannel.subscribeDataChannel($,[_n]);if(_c&&i_(_c).call(_c,_n.id))try{var _s;if(typeof _n._originDataChannelId!="number")throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid," with mediaType datachannel, cannot get RTCDatachannel")),new DE(mE.CREATE_DATACHANNEL_ERROR);const _u={id:_n.id,datachannelId:_n._originDataChannelId,ordered:_n.ordered,maxRetransmits:_n.maxRetransmits,metadata:(_s=_n.metadata)!==null&&_s!==void 0?_s:""};await this._gateway.subscribeDataChannel($.uid,_u,!0),await _n._waitTillOpen()}catch(_u){if((_u==null?void 0:_u.code)!==mE.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel($,[_n]),_u;await this._p2pChannel.unsubscribeDataChannel($,[_n]),this._p2pChannel.setPendingRemoteDataChannel($,_n.id)}return iE.info("[".concat(this._clientId,"] subscribe success user ").concat($.uid,", mediaType: datachannel")),_n}finally{_i()}}async _p2pSubscribe($,_e,_t){if(aS(_e,"mediaType",["audio","video"]),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(_i=>_i===$)){const _i=new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", this user is not in the channel")),_i}if(!$.hasAudio&&!$.hasVideo){const _i=new DE(mE.INVALID_REMOTE_USER,"user is not published");throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", user is not published")),_i}if(!_t&&(_e==="audio"&&!$.hasAudio||_e==="video"&&!$.hasVideo)){const _i=new DE(mE.REMOTE_USER_IS_NOT_PUBLISHED);throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid," with mediaType ").concat(_e,", remote track is not published")),_i}const _n=await this._subscribeMutex.lock();iE.info("[".concat(this._clientId,"] subscribe user ").concat($.uid,", mediaType: ").concat(_e));try{if(await this._p2pChannel.hasRemoteMediaWithLock($,_e))await this._p2pChannel.unmuteRemote($,_e);else try{const _s=_e==="audio"?$._audioSSRC:$._videoSSRC,_c=_e==="audio"?$._audioMid:$._videoMid;this.store.subscribe($.uid,_e,Date.now()),this._p2pChannel instanceof vT&&await this._p2pChannel.subscribe($,_e,_s,_c)}catch(_s){throw _s}iE.info("[".concat(this._clientId,"] subscribe success user ").concat($.uid,", mediaType: ").concat(_e)),this._defaultStreamFallbackType&&this.setStreamFallbackOption($.uid,this._defaultStreamFallbackType).catch(_s=>{iE.warning("[".concat(this._clientId,"] auto set fallback failed"),_s)});const _i=_e==="audio"?$._audioTrack:$._videoTrack;if(!_i)throw new DE(mE.UNEXPECTED_ERROR,"can not find remote track in user object");return _i}catch(_i){throw iE.error("[".concat(this._clientId,"] subscribe user ").concat($.uid," error"),_i),_i}finally{_n()}}async _subscribe($,_e,_t){if(this._p2pChannel instanceof vT)return this._p2pSubscribe($,_e);if(aS(_e,"mediaType",["audio","video"]),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(_h=>_h===$)){const _h=new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", this user is not in the channel")),_h}if(!$.hasAudio&&!$.hasVideo){const _h=new DE(mE.INVALID_REMOTE_USER,"user is not published");throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid,", user is not published")),_h}if(!(_t||(_e!=="audio"||$.hasAudio&&$._audioSSRC!==void 0)&&(_e!=="video"||$.hasVideo&&$._videoSSRC!==void 0))){const _h=new DE(mE.REMOTE_USER_IS_NOT_PUBLISHED);throw iE.error("[".concat(this._clientId,"] can not subscribe ").concat($.uid," with mediaType ").concat(_e,", remote track is not published")),_h}let _n=_e==="audio"?$._audioSSRC:$._videoSSRC,_i=_e==="audio"?$._audioOrtc:$._videoOrtc,_s=_e==="video"?$._rtxSsrcId:void 0,_c={stream_type:_e==="audio"?h_.AUDIO:h_.VIDEO,ssrcId:_n};const _u=await this._subscribeMutex.lock();iE.info("[".concat(this._clientId,"] subscribe user ").concat($.uid,", mediaType: ").concat(_e));try{if(await this._p2pChannel.hasRemoteMediaWithLock($,_e))await this._p2pChannel.unmuteRemote($,_e);else try{const _p=_e==="audio"?$._audioSSRC:$._videoSSRC;_p!==void 0&&_p!==_n&&(_n=_p,_i=_e==="audio"?$._audioOrtc:$._videoOrtc,_s=_e==="video"?$._rtxSsrcId:void 0,_c={stream_type:_e==="audio"?h_.AUDIO:h_.VIDEO,ssrcId:_n}),DS.markSubscribeStart(this.store.clientId,_n),this.store.subscribe($.uid,_e,Date.now()),await this._p2pChannel.subscribe($,_e,_n,_s,_i);try{await this._gateway.subscribe($.uid,_c,!0)}catch(Qm){if((Qm==null?void 0:Qm.code)!==mE.WS_ABORT)throw await this._p2pChannel.unsubscribe($,_e),Qm;await this._p2pChannel.unsubscribe($,_e,!0),this._p2pChannel.setPendingRemoteMedia($,_e)}this.store.subscribe($.uid,_e,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,$,_e)}catch(_p){throw this._p2pChannel.reportSubscribeEvent(!1,_p==null?void 0:_p.code,$,_e),_p}iE.info("[".concat(this._clientId,"] subscribe success user ").concat($.uid,", mediaType: ").concat(_e)),this._defaultStreamFallbackType&&this.setStreamFallbackOption($.uid,this._defaultStreamFallbackType).catch(_p=>{iE.warning("[".concat(this._clientId,"] auto set fallback failed"),_p)});const _h=_e==="audio"?$._audioTrack:$._videoTrack;if(!_h)throw new DE(mE.UNEXPECTED_ERROR,"can not find remote track in user object");return _h}catch(_h){throw iE.error("[".concat(this._clientId,"] subscribe user ").concat($.uid," error"),_h),_h}finally{_u()}}async massSubscribe($){if(v1($,"subscribeList"),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const _e=Date.now(),_t=new Map,Wt=await this._subscribeMutex.lock();iE.info("[".concat(this._clientId,"]start massSubscribe user ").concat($.map(_c=>{let{user:_u,mediaType:_h}=_c;return"user: ".concat(_u==null?void 0:_u.uid,", mediaType: ").concat(_h)}).join("; ")));const _n=($=[...$]).map(_c=>{let{user:_u,mediaType:_h}=_c;return{user:_u,mediaType:_h}}),_i=await this._p2pChannel.globalLock();try{var _s;for(let _u=$.length-1;_u>=0;_u--){const _h=$[_u],{user:_p,mediaType:Qm}=_h;if(aS(Qm,"mediaType",["audio","video"]),!_p){const aE=new DE(mE.INVALID_PARAMS,"user property does not exist in subscribeList item");throw iE.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),aE}if(!this._users.find(aE=>aE===_p)){const aE=new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");iE.error("[".concat(this._clientId,"] can not massSubscribe ").concat(_p.uid,", this user is not in the channel")),_n[_u].error=aE,$.splice(_u,1);continue}if(Qm==="audio"&&(!_p.hasAudio||_p._audioSSRC===void 0)||Qm==="video"&&(!_p.hasVideo||_p._videoSSRC===void 0)){const aE=new DE(mE.REMOTE_USER_IS_NOT_PUBLISHED);iE.error("[".concat(this._clientId,"] can not subscribe ").concat(_p.uid," with mediaType ").concat(Qm,", remote user is not published")),_n[_u].error=aE,$.splice(_u,1);continue}const eE=pS.Video|pS.LwoVideo,pE=_t.get(_p);if(pE){if(Qm==="video"?pE&eE:pE&pS.Audio){$.splice(_u,1),iE.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(_p.uid,", mediaType:").concat(Qm," twice"));continue}_t.set(_p,pE|(Qm==="video"?eE:pS.Audio))}else _t.set(_p,Qm==="video"?eE:pS.Audio)}for(let _u=$.length-1;_u>=0;_u--){const _h=$[_u],{user:_p,mediaType:Qm}=_h,_g=pS.Video|pS.LwoVideo;if(this._p2pChannel.hasRemoteMedia(_p,Qm)){await this._p2pChannel.unmuteRemoteNoLock(_p,Qm);const eE=_t.get(_p);_t.set(_p,Qm==="video"?eE^_g:eE^pS.Audio),$.splice(_u,1)}}this.store.massSubscribe($.map(_u=>({userId:_u.user.uid,type:_u.mediaType})),_e);const _c=wR(_s=Array.from(_t.entries())).call(_s,(_u,_h)=>{let[_p,Qm]=_h;if(Qm===0)return _u;const _g={stream_id:_p.uid,stream_type:Qm};return Qm&pS.Audio&&(_g.audio_ssrc=_p._audioSSRC),Qm&pS.Video&&(_g.video_ssrc=_p._videoSSRC),_u.push(_g),_u},[]);try{$.length>0&&await this._p2pChannel.massSubscribeNoLock($.map(_h=>{let{user:_p,mediaType:Qm}=_h;return{user:_p,mediaType:Qm,ssrcId:Qm===h_.VIDEO?_p._videoSSRC:_p._audioSSRC,rtxSsrcId:Qm===h_.VIDEO?_p._rtxSsrcId:void 0}}));const _u=new Map;if(_c.length>0){const _h=await this._gateway.subscribeAll(_c,!0);((_h==null?void 0:_h.users)||[]).forEach(_p=>{let{stream_id:Qm,video_error_code:_g,audio_error_code:eE,error_code:pE}=_p;(_g||eE||pE)&&_u.set(Qm,{video_error_code:_g,audio_error_code:eE,error_code:pE})})}if(Array.from(_u.entries()).length>0){const _h=[];Array.from(_u.entries()).forEach(_p=>{let[Qm,_g]=_p;const eE=this.remoteUsers.find(pE=>pE.uid===Qm);if(eE){let pE;_g.error_code||_g.video_error_code&&_g.audio_error_code?pE=void 0:_g.video_error_code?pE=h_.VIDEO:_g.audio_error_code&&(pE=h_.AUDIO),_h.push({user:eE,mediaType:pE})}}),_h.length>0&&await this._p2pChannel.massUnsubscribeNoLock(_h)}for(const _h of _n){const _p=_u.get(_h.user.uid);if(_p){const Qm=_p.error_code||_h.mediaType==="audio"&&_p.audio_error_code||_h.mediaType==="video"&&_p.video_error_code;if(Qm){const _g=xI(Qm);iE.error("user:".concat(_h.user.uid," mediaType:").concat(_h.mediaType," has massSubscribe error ").concat(_g.desc)),_h.error=new DE(mE.SUBSCRIBE_FAILED,"code ".concat(Qm,": ").concat(_g.desc))}}_h.error||(_h.mediaType==="video"?_h.track=_h.user.videoTrack:_h.track=_h.user.audioTrack)}return this.store.massSubscribe(_n.filter(_h=>!_h.error).map(_h=>({userId:_h.user.uid,type:_h.mediaType})),void 0,Date.now()),_n.forEach(_h=>{var _p;p_.subscribe(this.store.sessionId,{succ:!!_h.error,ec:((_p=_h.error)===null||_p===void 0?void 0:_p.code)||null,video:_h.mediaType===h_.VIDEO,audio:_h.mediaType===h_.AUDIO,peerid:_h.user.uid,subscribeRequestid:_h.mediaType===h_.VIDEO?_h.user._videoSSRC:_h.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-_e)},!0)}),iE.info("[".concat(this._clientId,"] massSubscribe success ").concat($.map(_h=>{let{user:_p,mediaType:Qm}=_h;return"user: ".concat(_p==null?void 0:_p.uid,", mediaType: ").concat(Qm)}).join("; "))),_n}catch(_u){throw await this._p2pChannel.massUnsubscribeNoLock($),_u}}finally{_i(),Wt()}}async unsubscribe($,_e,_t){if(!($ instanceof cI)){const _i=this.remoteUsers.find(_s=>_s.uid===$);if(!_i)throw new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");$=_i}if(_e||this.store.useP2P){if(_e==="datachannel")return this._unsubscribeDataChannel($,_t)}else await this._unsubscribeDataChannel($,_t);if(_e&&aS(_e,"mediaType",["audio","video"]),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(_i=>_i===$)){const _i=new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");throw iE.error("[".concat(this._clientId,"] can not unsubscribe ").concat($.uid,", user is not in the channel")),_i}iE.info("[".concat(this._clientId,"] unsubscribe uid: ").concat($.uid,", mediaType: ").concat(_e));const _n=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof vT)await this._p2pChannel.unsubscribe($,_e);else{const _i=await this._p2pChannel.unsubscribe($,_e);_i&&await this._gateway.unsubscribe(_i,$.uid),_e&&_e!=="audio"||($._audio_pre_subscribed=!1),_e&&_e!=="video"||($._video_pre_subscribed=!1),$._is_pre_created&&bL(this._users,$),iE.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat($.uid,", mediaType: ").concat(_e))}}catch(_i){if(_i.code===mE.DISCONNECT_P2P)return void iE.warning("disconnecting p2p, abort unsubscribe request.");throw iE.error("[".concat(this._clientId,"] unsubscribe user ").concat($.uid," error"),_i.toString()),_i}finally{_n()}}async _unsubscribeDataChannel($,_e){if(_e&&u0(_e,"id",0,65535,!0),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(_n=>_n===$)){const _n=new DE(mE.INVALID_REMOTE_USER,"user is not in the channel");throw iE.error("[".concat(this._clientId,"] can not unsubscribe ").concat($.uid,", user is not in the channel")),_n}let Wt;if(typeof _e=="number"){const _n=$._dataChannels.find(_i=>_i.id===_e);_n&&(Wt=[_n])}else Wt=$._dataChannels;if(Wt===void 0){const _n=new DE(mE.REMOTE_USER_IS_NOT_PUBLISHED);throw iE.error("[".concat(this._clientId,"] can not unsubscribe ").concat($.uid," with channelId ").concat(_e,", remote datachannel is not published")),_n}iE.info("[".concat(this._clientId,"] unsubscribe uid: ").concat($.uid,", mediaType: datachannel, ids: ").concat(Wt.map(_n=>_n.id)));try{const _n=await this._p2pChannel.unsubscribeDataChannel($,Wt);_n&&await this._gateway.unsubscribeDataChannel(_n,$.uid),iE.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat($.uid,", mediaType: datachannel, ids: ").concat(_n))}catch(_n){if(_n.code===mE.DISCONNECT_P2P)return void iE.warning("disconnecting p2p, abort unsubscribe request.");throw iE.error("[".concat(this._clientId,"] unsubscribe user ").concat($.uid," error"),_n.toString()),_n}}async massUnsubscribe($){if(v1($,"unsubscribeList"),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");iE.info("[".concat(this._clientId,"] start massUnsubscribe ").concat($.map(_t=>{let{user:Wt,mediaType:_n}=_t;return"user: ".concat(Wt==null?void 0:Wt.uid,", mediaType: ").concat(_n,";")}).join())),$=[...$];const _e=new Map;for(let _t=$.length-1;_t>=0;_t--){const{user:Wt,mediaType:_n}=$[_t];if(!Wt){const _c=new DE(mE.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw iE.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),_c}if(aS(_n,"mediaType",["video","audio",void 0]),!this._users.find(_c=>_c===Wt)){iE.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(Wt.uid,", user is not in the channel")),$.splice(_t,1);continue}const _s=pS.Video|pS.LwoVideo;if(_e.has(Wt)){const _c=_e.get(Wt);let _u;switch(_n){case"video":_u=_c&_s;break;case"audio":_u=_c&pS.Audio;break;default:_u=_c&(pS.Audio|_s)}if(_u){iE.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(Wt.uid,",mediaType:").concat(_n," twice.")),$.splice(_t,1);continue}_n?_n==="audio"?_e.set(Wt,_c|pS.Audio):_n==="video"&&_e.set(Wt,_c|_s):_e.set(Wt,_c|pS.Audio|_s)}else _n?_n==="audio"?_e.set(Wt,pS.Audio):_n==="video"&&_e.set(Wt,_s):_e.set(Wt,pS.Audio|_s)}try{const _t=await this._p2pChannel.massUnsubscribe($);_t&&await this._gateway.massUnsubscribe(_t),iE.info("[".concat(this._clientId,"] massUnsubscribe success ").concat($.map(Wt=>{let{user:_n,mediaType:_i}=Wt;return"user: ".concat(_n==null?void 0:_n.uid,", mediaType: ").concat(_i,";")}).join()))}catch(_t){if(_t.code===mE.DISCONNECT_P2P)return void iE.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw iE.error("[".concat(this._clientId,"] massUnsubscribe error"),_t.toString()),_t}}async setLowStreamParameter($){(function(_t){if(!_t)throw new HE(mE.INVALID_PARAMS);U0(_t.width)||EV(_t.width,"streamParameter.width"),U0(_t.height)||EV(_t.height,"streamParameter.height"),U0(_t.framerate)||EV(_t.framerate,"streamParameter.framerate"),U0(_t.bitrate)||u0(_t.bitrate,"streamParameter.bitrate")})($),(!$.width&&$.height||$.width&&!$.height)&&iE.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),iE.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify($));const _e=this._configDistribute.getLowStreamConfigDistribute();if(_e&&_e.bitrate&&$.bitrate&&_e.bitrate<$.bitrate&&($.bitrate=_e.bitrate),this._lowStreamParameter=$,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter($,XE.LocalVideoLowTrack)}async enableDualStream(){if(!B_().supportDualStream)throw p_.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new DE(mE.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new DE(mE.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch($){throw p_.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),$}this._isDualStreamEnabled=!0,p_.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),iE.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(XE.LocalVideoLowTrack))try{const $=await this._p2pChannel.unpublishLowStream();$&&await this._gateway.unpublish($,this._joinInfo.stringUid||this._joinInfo.uid)}catch($){throw p_.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),$}this._isDualStreamEnabled=!1,p_.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),iE.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole($,_e){if(function(_t){aS(_t,"role",["audience","host"])}($),_e&&MH(_e),this.mode==="rtc"||this.mode==="p2p")throw iE.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new DE(mE.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(_e&&_e.level&&$==="host")throw new DE(mE.INVALID_OPERATION,"host mode can not set audience latency level");if($==="audience"&&this._p2pChannel.hasLocalMedia())throw new DE(mE.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole($,_e),this._config.role=$,iE.info("[".concat(this._clientId,"] set client role to ").concat($,", level: ").concat(_e&&_e.level))}getRemoteInboundOffset(){var $;const _e=($=this._p2pChannel.getStats())===null||$===void 0?void 0:$.audioSend[0];if(!_e||!_e.timestamp)return 0;const _t=_e.timestamp-Date.now();return Math.abs(_t)>1e3+_e.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?_t:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer($,_e){if(bS($,"proxyServer"),!_e){if(this.connectionState!=="DISCONNECTED")throw new DE(mE.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new DE(mE.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=$,p_.setProxyServer(this._proxyServer),iE.setProxyServer(this._proxyServer),iE.info("[".concat(this._clientId,"] Set proxy server ").concat(_e?"by initialize call":""," success."))}setTurnServer($,_e){if(Array.isArray($)||($=[$]),!_e){if(this.connectionState!=="DISCONNECTED")throw new DE(mE.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new DE(mE.INVALID_OPERATION,"You have already set the proxy")}if(IO($))return this._turnServer={servers:$,mode:"original-manual"},void iE.info("[".concat(this._clientId,"] Set original turnserver ").concat(_e?"by initialize call":""," success: ").concat($.map(_t=>_t.urls).join(","),"."));$.forEach(_t=>xH(_t)),this._turnServer={servers:$,mode:"manual"},iE.info("[".concat(this._clientId,"] Set turnserver ").concat(_e?"by initialize call":""," success."))}setLicense($){if(this.connectionState!=="DISCONNECTED")throw new DE(mE.INVALID_OPERATION,"you should set license before join channel");if(bS($,"license",32,32),!/^[A-Za-z\d]+$/.test($))throw new DE(mE.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=$,iE.info("[".concat(this._clientId,"] set license success"),$)}startProxyServer($){if(this.connectionState!=="DISCONNECTED")throw new DE(mE.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new DE(mE.INVALID_OPERATION,"You have already set the proxy");const _e=[3,4,5];let _t;switch($===void 0&&($=3),$){case 1:case 2:throw new DE(mE.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:_t="proxy3";break;case 4:_t="proxy4";break;case 5:_t="proxy5";break;default:throw new DE(mE.INVALID_PARAMS,"proxy server mode must be ".concat(_e.join("|")))}this._cloudProxyServerMode=_t,this.store.cloudProxyServerMode=_t,iE.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new DE(mE.INVALID_OPERATION,"Stop proxy server after leave channel");p_.setProxyServer(),iE.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",iE.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2($){if(!$.accessPoints)throw new DE(mE.INVALID_PARAMS,"accessPoints is required.");v1($.accessPoints.serverList,"accessPoints.serverList"),bS($.accessPoints.domain,"accessPoints.domain");const _e=(_g,eE)=>{u0(_g,eE,0,65535,!0)};let _t=443;if($.accessPoints.port&&(_e($.accessPoints.port,"accessPoints.port"),_t=$.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new DE(mE.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");yE("CLOSE_AFB_FOR_LOCAL_AP")&&(d0("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),d0("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const Wt=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,_n=$.accessPoints.domain,_i=$.accessPoints.serverList.map(_g=>Wt.test(_g)?"".concat(_g.replace(/\./g,"-"),".").concat(_n):_g),_s=_i.map(_g=>"".concat(_g,":").concat(_t));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,d0("WEBCS_DOMAIN",_s),d0("WEBCS_DOMAIN_BACKUP_LIST",_s),d0("GATEWAY_DOMAINS",[_n]),$.report&&$.report.hostname&&Array.isArray($.report.hostname)&&$.report.hostname.length?(v1($.report.hostname,"report.hostname"),d0("EVENT_REPORT_DOMAIN",$.report.hostname[0]),d0("EVENT_REPORT_BACKUP_DOMAIN",$.report.hostname[1]||$.report.hostname[0])):(d0("EVENT_REPORT_DOMAIN",_i[0]),d0("EVENT_REPORT_BACKUP_DOMAIN",_i[1]||_i[0]));let _c=6443;$.report&&$.report.port&&(_e($.report.port,"report.port"),_c=$.report.port),d0("STATS_COLLECTOR_PORT",_c),$.report?d0("ENABLE_EVENT_REPORT",!0):d0("ENABLE_EVENT_REPORT",!1);let _u="";$.log&&$.log.hostname&&Array.isArray($.log.hostname)&&$.log.hostname.length?(v1($.log.hostname,"log.hostname"),_u=$.log.hostname[0]):_u=_i[0];let _h=6444;$.log&&$.log.port&&(_e($.log.port,"log.port"),_h=$.log.port),d0("LOG_UPLOAD_SERVER","".concat(_u,":").concat(_h));let _p=[];$.cds&&$.cds.hostname&&Array.isArray($.cds.hostname)&&$.cds.hostname.length?(v1($.cds.hostname,"cds.hostname"),_p=$.cds.hostname):_p=_i;let Qm=443;$.cds&&$.cds.port&&(_e($.cds.port,"cds.port"),Qm=$.cds.port),d0("CDS_AP",_p.map(_g=>"".concat(_g,":").concat(Qm))),$.cds?d0("ENABLE_CONFIG_DISTRIBUTE",!0):d0("ENABLE_CONFIG_DISTRIBUTE",!1),iE.info("set local access point v2 success")}setLocalAccessPoints($,_e){if(v1($,"serverList"),bS(_e,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new DE(mE.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const _t=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;$=$.map(Wt=>_t.test(Wt)?"".concat(Wt.replace(/\./g,"-"),".").concat(_e):Wt),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,d0("WEBCS_DOMAIN",$),d0("WEBCS_DOMAIN_BACKUP_LIST",$),d0("GATEWAY_DOMAINS",[_e]),d0("EVENT_REPORT_DOMAIN",$[0]),d0("EVENT_REPORT_BACKUP_DOMAIN",$[1]||$[0]),d0("LOG_UPLOAD_SERVER","".concat($[0],":6444")),iE.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType($){if(aS($,"streamType",[0,1]),this._remoteDefaultVideoStreamType=$,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType($),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(_e){throw iE.error("[".concat(this._clientId,"] set default remote video stream type error"),_e.toString()),_e}else iE.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat($))}async setRemoteVideoStreamType($,_e){aS(_e,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType($,_e),setTimeout(()=>{const _t=this._users.find(Wt=>Wt.uid===$);_t&&_t.videoTrack&&_t.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(_t){throw iE.error("[".concat(this._clientId,"] set remote video stream type error"),_t.toString()),_t}iE.info("[".concat(this._clientId,"] set remote ").concat($," video stream type to ").concat(_e)),this._remoteStreamTypeCacheMap.set($,_e)}async setStreamFallbackOption($,_e){aS(_e,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption($,_e)}catch(_t){throw iE.error("[".concat(this._clientId,"] set stream fallback option"),_t.toString()),_t}iE.info("[".concat(this._clientId,"] set remote ").concat($," stream fallback type to ").concat(_e)),this._streamFallbackTypeCacheMap.set($,_e)}setEncryptionConfig($,_e,_t,Wt){(function(_i){aS(_i,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})($),bS(_e,"secret");const _n=["aes-128-gcm2","aes-256-gcm2"];if(i_(_n).call(_n,$)){if(!_t||!(_t instanceof Uint8Array&&_t.length===32))throw new DE(mE.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(_t)throw new DE(mE.INVALID_PARAMS,"current encrypt mode does not need salt");if(Wt){if(E1(Wt,"encryptDataStream"),!i_(_n).call(_n,$))throw new DE(mE.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(_e)||iE.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=$,this._encryptionSecret=_e,_t&&(this._encryptionSalt=z1(_t))}async renewToken($){if(bS($,"token",1,2047),!this._key||!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"renewToken should not be called before user join");const _e=this._key;this._key=$,this._joinInfo&&(this._joinInfo.token=$);const _t=await this._renewTokenMutex.lock();try{if(yE("USE_NEW_TOKEN")){iE.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const Wt=await Rle(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Y0);iE.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:$,ticket:Wt})}else iE.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:$});iE.debug("[".concat(this._clientId,"] renewToken success"))}catch(Wt){throw this._key=_e,this._joinInfo.token=_e,iE.error("[".concat(this._clientId,"] renewToken failed"),Wt.toString()),Wt}finally{_t()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?iE.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const $=this._p2pChannel.getAudioLevels();this.safeEmit(j_.VOLUME_INDICATOR,$)},yE("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const $=this._statsCollector.getRTCStats(),_e=this._gateway.getInChannelInfo();return $.Duration=Math.round(_e.duration/1e3),$}async startLiveStreaming($,_e){if(!_e){if(this.codec!=="h264")throw new DE(mE.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new DE(mE.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl($)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl($))throw new DE(mE.LIVE_STREAMING_TASK_CONFLICT);const _t=_e?ES.TRANSCODE:ES.RAW;return this._createLiveStreamingClient(_t).startLiveStreamingTask($,_t)}setLiveTranscoding($){return this._createLiveStreamingClient(ES.TRANSCODE).setTranscodingConfig($)}async stopLiveStreaming($){const _e=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(_t=>_t&&_t.hasUrl($));if(!_e.length)throw new DE(mE.INVALID_PARAMS,"can not find live streaming url to stop");await n_.all(_e.map(_t=>_t&&_t.stopLiveStreamingTask($)))}async addInjectStreamUrl($,_e){if(!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const _t=this._createLiveStreamingClient(ES.INJECT);_t.setInjectStreamConfig(_e,0),await _t.startLiveStreamingTask($,ES.INJECT)}async removeInjectStreamUrl(){var $;const _e=this._createLiveStreamingClient(ES.INJECT),_t=Array.from(AR($=_e.streamingTasks).call($)).find(Wt=>Wt.mode===ES.INJECT);if(!this._joinInfo||!_t)throw new DE(mE.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await _e.stopLiveStreamingTask(_t.url)}async startChannelMediaRelay($){Y9($),await this._createChannelMediaRelayClient().startChannelMediaRelay($)}async updateChannelMediaRelay($){Y9($),await this._createChannelMediaRelayClient().updateChannelMediaRelay($)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}async sendStreamMessage($){var _e;let _t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"can not send data stream, not joined");if((typeof $=="string"||$ instanceof Uint8Array)&&($={payload:$}),typeof $.payload=="string"){const _n=new TextEncoder;$.payload=_n.encode($.payload)}let Wt=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&i_(_e=["aes-128-gcm2","aes-256-gcm2"]).call(_e,this._encryptionMode)&&(Wt=!0,$.payload=await async function(_n,_i,_s){var _c;const _u=wR(_c=Array.from(_s)).call(_c,(aE,cE)=>aE+cE,0),_h={serverTs:0,seq:cce++,length:_s.length,checkSum:_u},_p=new Uint8Array(WH(_u,2)),Qm=new ArrayBuffer(PO),_g=new DataView(Qm);_g.setUint32(0,_h.serverTs),_g.setUint16(4,_h.seq),_g.setUint16(6,_h.length),_g.setUint16(8,_h.checkSum);const eE=16-_s.length%16;_s=FH(_s,new Uint8Array(eE));const pE=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:_n,tagLength:KH,additionalData:_p},_i,_s);return FH(new Uint8Array(Qm),new Uint8Array(pE))}(this._encryptDataStreamIv,this._encryptDataStreamKey,$.payload)),new Blob([$.payload]).size>1024)throw new DE(mE.INVALID_PARAMS,Wt?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(g_.DATA_STREAM,{payload:z1($.payload),syncWithAudio:$.syncWithAudio,sendTs:Date.now()-Yhe},!_t)}sendMetadata($){if(!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([$]).size>1024)throw new DE(mE.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(g_.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:z1($)})}async sendCustomReportMessage($){if(Array.isArray($)||($=[$]),$.forEach(uce),!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"can not send custom report, not joined");await p_.sendCustomReportMessage(this._joinInfo.sid,$)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer($,_e){aS(_e.spatialLayer,"spatialLayer",[0,1,2,3]),aS(_e.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer($,_e)}catch(_t){throw iE.error("[".concat(this._clientId,"] pick SVC layer failed"),_t.toString()),_t}}async setRTMConfig($){const{apRTM:_e=!1,rtmFlag:_t}=$;if(E1(_e,"apRTM"),u0(_t,"rtmFlag",0),this._rtmConfig.apRTM=_e,this._rtmConfig.rtmFlag=_t,iE.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify($)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=_e,this._joinInfo.rtmFlag=_t,this._gateway.setRTM2Flag(_t)}_reset(){if(iE.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=tT.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&HY(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach($=>{$._audioTrack&&$._audioTrack._destroy(),$._videoTrack&&$._videoTrack._destroy(),$._dataChannels&&($._dataChannels.forEach(_e=>_e._close()),$._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new mS("client-publish"),this._subscribeMutex=new mS("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession($,_e){var _t;const Wt=$||eP();$?iE.debug("[".concat(this._clientId,"] new Session ").concat(Wt)):iE.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(Wt));const _n=$?"":this._sessionId||"";this._sessionId=Wt,this.store.sessionId=Wt;const _i={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(_e==null?void 0:_e.stringUid)||((_t=this._joinInfo)===null||_t===void 0?void 0:_t.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:_n,clientRole:this.role==="audience"?2:1};_e?p_.sessionInit(this._sessionId,KT({cname:_e.channel,appid:_e.appId,preload:_e.preload},_i)):this._joinInfo?p_.sessionInit(this._sessionId,KT({cname:this._joinInfo.cname,appid:this._joinInfo.appId,preload:!!this._joinInfo.recoverPreloadCache},_i)):this._gateway.joinInfo&&p_.sessionInit(this._sessionId,KT({cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId},_i)),this._joinInfo&&(this._joinInfo.sid=Wt),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=Wt)}async _publishHighStream($){if(!this._joinInfo||this._uid===void 0)throw new DE(mE.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&yE("FORCE_TURN")&&!yE("TURN_ENABLE_TCP")&&!yE("TURN_ENABLE_UDP"))throw new DE(mE.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");iE.debug("[".concat(this._clientId,"] publish high stream"));try{const _t=await this._p2pChannel.publish($,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof vT){const Wt=(await _t.next()).value;if(Wt){try{await this._gateway.sendExtensionMessage(W0.PUBLISH,Wt,!0)}catch(_n){throw _t.throw(_n),_n}await _t.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const Wt=(await _t.next()).value;if(Wt){var _e;let _n;try{_n=await this._gateway.publish(this._uid,Wt,!0)}catch(_i){if(_i.code!==mE.DISCONNECT_P2P)throw _t.throw(_i),_i}await _t.next(((_e=_n)===null||_e===void 0?void 0:_e.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const _n of $)_n instanceof m0&&_n._encoderConfig&&this._gateway.setVideoProfile(_n._encoderConfig),!_n.muted&&_n.enabled||await this._p2pChannel.muteLocalTrack(_n)}}catch(_t){if(this._p2pChannel.reportPublishEvent(!1,_t==null?void 0:_t.code,$),(_t==null?void 0:_t.code)===mE.WS_ABORT)return;throw _t}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new DE(mE.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new DE(mE.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));iE.debug("[".concat(this._clientId,"] publish low stream"));const $=this._configDistribute.getLowStreamConfigDistribute();$&&$.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&$.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=$.bitrate));try{const _t=await this._p2pChannel.publishLowStream(this._lowStreamParameter),Wt=(await _t.next()).value;if(Wt){var _e;let _n;try{_n=await this._gateway.publish(this._uid,Wt,!0)}catch(_i){if(_i.code!==mE.DISCONNECT_P2P)throw _t.throw(_i),_i}_t.next(((_e=_n)===null||_e===void 0?void 0:_e.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(_t){if(this._p2pChannel.reportPublishEvent(!1,_t==null?void 0:_t.code,void 0,!0),(_t==null?void 0:_t.code)===mE.WS_ABORT)return;throw _t}}_createLiveStreamingClient($){if(!this._joinInfo||!this._appId)return new DE(mE.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const _e=()=>new The(this._joinInfo,this._config.websocketRetryConfig||Y0,this._config.httpRetryConfig||Y0),_t=Wt=>{Wt.onLiveStreamError=(_n,_i)=>{p_.reportApiInvoke(this._sessionId,{name:Q0.ON_LIVE_STREAM_ERROR,options:[_n,_i],tag:j0.TRACER}).onSuccess(),this.safeEmit(j_.LIVE_STREAMING_ERROR,_n,_i)},Wt.onLiveStreamWarning=(_n,_i)=>{p_.reportApiInvoke(this._sessionId,{name:Q0.ON_LIVE_STREAM_WARNING,options:[_n,_i],tag:j0.TRACER}).onSuccess(),this.safeEmit(j_.LIVE_STREAMING_WARNING,_n,_i)},Wt.on(kL.REQUEST_WORKER_MANAGER_LIST,(_n,_i,_s)=>{if(!this._joinInfo)return _s(new DE(mE.INVALID_OPERATION,"can not find join info to get worker manager"));MW(_n,this._joinInfo,this._axiosCancelSource.token,Y0).then(_i).catch(_s)})};switch($){case ES.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=_e(),_t(this._liveRawStreamingClient)),this._liveRawStreamingClient;case ES.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=_e(),_t(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case ES.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=_e(),this._injectStreamingClient.on(kL.REQUEST_WORKER_MANAGER_LIST,(Wt,_n,_i)=>{if(!this._joinInfo)return _i(new DE(mE.INVALID_OPERATION,"can not find join info to get worker manager"));MW(Wt,this._joinInfo,this._axiosCancelSource.token,Y0).then(_n).catch(_i)}),this._injectStreamingClient.onInjectStatusChange=(Wt,_n,_i)=>{this.safeEmit(j_.INJECT_STREAM_STATUS,Wt,_n,_i)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new DE(mE.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:$,sendResolutionHeight:_e}=this.getLocalVideoStats(),_t={width:$,height:_e};this._channelMediaRelayClient=new Rhe(this._joinInfo,this._clientId,this._config.websocketRetryConfig||Y0,this._config.httpRetryConfig||Y0,_t),this._channelMediaRelayClient.on("state",Wt=>{Wt===aT.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(j_.CHANNEL_MEDIA_RELAY_STATE,Wt)}),this._channelMediaRelayClient.on("event",Wt=>{this.safeEmit(j_.CHANNEL_MEDIA_RELAY_EVENT,Wt)}),this._statsCollector.onStatsChanged=(Wt,_n)=>{var _i;Wt==="resolution"&&((_i=this._channelMediaRelayClient)===null||_i===void 0||_i.setVideoProfile(_n))}}return this._channelMediaRelayClient}_handleUpdateDataChannel($,_e){const{added:_t,deleted:Wt}=$,_n=[];Array.isArray(_t)&&_t.length>0&&_t.forEach(_i=>{const{uid:_s,stream_id:_c,ordered:_u,max_retrans_times:_h,metadata:_p}=_i,Qm=this._users.find(_g=>_g._uintid===_s);if(!Qm)return void iE.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(iE.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(_s)),i_(_n).call(_n,Qm)||_n.push(Qm),Qm._uintid||(Qm._uintid=_s),Qm._dataChannels.findIndex(_g=>_g.id===_i.stream_id)===-1){const _g={id:_c,ordered:!!_u,maxRetransmits:_h,metadata:_p},eE=new ehe(_g);Qm._dataChannels.push(eE),iE.info("[".concat(this._clientId,"] remote user ").concat(Qm.uid," published datachannel")),_e||this.safeEmit(j_.USER_PUBLISHED,Qm,"datachannel",_g)}this._p2pChannel.hasPendingRemoteDataChannel(Qm,_i.stream_id)&&(iE.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(Qm.uid," after reconnect.")),this._subscribeDataChannel(Qm,_i.stream_id).catch(_g=>{iE.error("[".concat(this._clientId,"] resubscribe datachannel error"),_g.toString())}))}),_e&&(this.safeEmit(j_.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(Wt)&&Wt.length>0&&Wt.forEach(_i=>{const{uid:_s,stream_id:_c}=_i,_u=this._users.find(_p=>_p._uintid===_s);if(!_u)return void iE.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const _h=_u._dataChannels.find(_p=>_p.id===_i.stream_id);_h&&(iE.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(_s)),this._p2pChannel.unsubscribeDataChannel(_u,[_h]).then(_p=>{if(_u._dataChannels=_u._dataChannels.filter(Qm=>Qm!==_h),_p)return this._gateway.unsubscribeDataChannel(_p,_u.uid)}),iE.info("[".concat(this._clientId,"] remote user ").concat(_s," unpublished datachannel ,id:").concat(_h.id)),this.safeEmit(j_.USER_UNPUBLISHED,_u,"datachannel",_h._config))})}_handleRemoveDataChannels($){const _e=this._users.find(_t=>_t.uid===$.uid);if(_e){if(_e._dataChannels!==void 0&&_e._dataChannels.length>0){iE.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat($.uid));const _t=()=>{iE.info("[".concat(this._clientId,"] remote user ").concat(_e.uid," unpublished datachannel")),_e._dataChannels.forEach(Wt=>{this.safeEmit(j_.USER_UNPUBLISHED,_e,"datachannel",Wt._config)})};this._p2pChannel.unsubscribeDataChannel(_e,_e._dataChannels).then(Wt=>{if(Wt)return this._gateway.unsubscribeDataChannel(Wt,_e.uid)}),_t()}}else iE.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(H0.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(H0.CONNECTION_STATE_CHANGE,($,_e,_t)=>{var Wt;if(_t===U_.FALLBACK)return;const _n=()=>{this.safeEmit(j_.CONNECTION_STATE_CHANGE,$,_e,_t)};if(p_.reportApiInvoke(this._sessionId||((Wt=this._gateway.joinInfo)===null||Wt===void 0?void 0:Wt.sid)||null,{name:Q0.CONNECTION_STATE_CHANGE,options:[$,_e,_t],tag:j0.TRACER}).onSuccess(JSON.stringify({cur:$,prev:_e,reason:_t})),iE.info("[".concat(this._clientId,"] connection state change: ").concat(_e," -> ").concat($)),$==="DISCONNECTED")return this._reset(),void _n();if($==="RECONNECTING")this._users.forEach(_s=>{_s._trust_in_room_=!1,_s._trust_audio_enabled_state_=!1,_s._trust_video_enabled_state_=!1,_s._trust_audio_mute_state_=!1,_s._trust_video_mute_state_=!1,_s._trust_audio_stream_added_state_=!1,_s._trust_video_stream_added_state_=!1,_s._is_pre_created||(_s._audio_pre_subscribed||(_s._audioSSRC=void 0,_s._audioOrtc=void 0),_s._video_pre_subscribed||(_s._videoSSRC=void 0,_s._videoOrtc=void 0,_s._rtxSsrcId=void 0),_s._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if($==="CONNECTED"){var _i;this._streamFallbackTypeCacheMap.forEach((_s,_c)=>{this._gateway.setStreamFallbackOption(_c,_s).catch(_u=>{iE.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_u)})}),this._remoteStreamTypeCacheMap.forEach((_s,_c)=>{this._gateway.setRemoteVideoStreamType(_c,_s).catch(_u=>{iE.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_u)})}),this._remoteDefaultVideoStreamType!==void 0&&((_i=this._joinInfo)===null||_i===void 0?void 0:_i.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{iE.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(_s=>{iE.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(_s))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(_s=>!_s._trust_in_room_).forEach(_s=>{iE.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(_s.uid)),this._handleUserOffline({uid:_s.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(_s=>{_s._trust_audio_mute_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(_s.uid)),this._handleMuteStream(_s.uid,h_.AUDIO,!1)),_s._trust_video_mute_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(_s.uid)),this._handleMuteStream(_s.uid,h_.VIDEO,!1)),_s._trust_audio_enabled_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(_s.uid)),this._handleSetStreamLocalEnable("audio",_s.uid,!0)),_s._trust_video_enabled_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(_s.uid)),this._handleSetStreamLocalEnable("video",_s.uid,!0)),_s._trust_video_stream_added_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(_s.uid)),this._handleResetAddStream(_s,"video")),_s._trust_audio_stream_added_state_||(iE.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(_s.uid)),this._handleResetAddStream(_s,"audio")),_s._video_added_||_s._audio_added_||(iE.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(_s.uid)),this._handleRemoveStream({uid:_s.uid,uint_id:_s._uintid}))}))},1e3))}_n()}),this._gateway.on(H0.REQUEST_NEW_GATEWAY_LIST,async($,_e)=>{if(!this._joinInfo)return _e(new DE(mE.UNEXPECTED_ERROR,"can not recover, no join info"));try{let _t;this._joinInfo.recoverPreloadCache?(_t=this._joinInfo.recoverPreloadCache.ap,WY(this._joinInfo.recoverPreloadCache),this._joinInfo.recoverPreloadCache=void 0):_t=await XV(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Y0,this.store),this._joinInfo&&(this._joinInfo.apResponse=_t.gatewayInfo.res,this._joinInfo.gatewayAddrs=_t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=_t.gatewayInfo.uni_lbs_ip);const Wt=[];_t.gatewayInfo.gatewayAddrs.forEach(_n=>{let{address:_i}=_n;const[_s,_c]=_i.split(":");this._joinInfo&&this._joinInfo.proxyServer?Wt.push({proxy:this._joinInfo.proxyServer,host:_s,port:_c}):Wt.push({host:_s,port:_c})}),$(Wt)}catch(_t){_e(_t)}}),this._gateway.on(H0.NETWORK_QUALITY,$=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(j_.NETWORK_QUALITY,$)}),this._gateway.on(H0.STREAM_TYPE_CHANGE,($,_e)=>{this.safeEmit(j_.STREAM_TYPE_CHANGED,$,_e),p_.reportApiInvoke(this._sessionId,{name:Q0.STREAM_TYPE_CHANGE,options:[$,_e],tag:j0.TRACER}).onSuccess(JSON.stringify({uid:$,streamType:_e}))}),this._gateway.on(H0.IS_P2P_DISCONNECTED,$=>{this._p2pChannel.isP2PDisconnected()?$(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?$(!1):$(!0)}),this._gateway.on(H0.NEED_RENEW_SESSION,async $=>{if($==="recover"&&this._joinInfo){const _e=await BY(KT(KT({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));this._joinInfo.recoverPreloadCache=_e,this._startSession(_e==null?void 0:_e.sid)}else this._startSession()}),this._gateway.on(H0.REQUEST_P2P_CONNECTION_PARAMS,async($,_e,_t)=>{try{_e(await this._p2pChannel.startP2PConnection($))}catch(Wt){_t(Wt)}}),this._gateway.on(H0.JOIN_RESPONSE,($,_e)=>{if(this.store.useP2P)return;const{dtlsParameters:_t,iceParameters:Wt,candidates:_n,rtpCapabilities:_i,setup:_s,cname:_c}=T9($.ortc,_e);this._p2pChannel.connect(Wt,_t,_n,_i,_s,_c)}),this._gateway.on(H0.REQUEST_DC_CONNECTION_PARAMS,$=>{$(this._p2pChannel.getEstablishParams())}),this._gateway.on(H0.RESET_SIGNAL,$=>{this._p2pChannel.resetConnection($),this._handleGatewaySignalEvents()}),this._gateway.on(H0.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(H0.DATACHANNEL_PRECONNECT,async($,_e,_t,Wt)=>{var _n,_i,_s,_c,_u,_h;await this._p2pChannel.startP2PConnection({turnServer:(_n=this._joinInfo)===null||_n===void 0?void 0:_n.turnServer},!0);const _p=function(Qm,_g){let eE;return _g&&_g.ip&&typeof _g.port=="number"?(eE=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_g.ip,port:_g.port.toString(),type:"host",extension:{}}],iE.debug("Using remote candidate from AP ".concat(_g.ip,":").concat(_g.port)),_g.ip6&&(eE.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_g.ip6,port:_g.port.toString(),type:"host",extension:{}}),iE.debug("Using IPV6 remote candidate from AP ".concat(_g.ip6,":").concat(_g.port)))):eE=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:Qm.ip,port:Qm.port.toString(),type:"host",extension:{}}],eE}($,_e);return this._p2pChannel.preConnect({iceUfrag:"".concat((_i=this._joinInfo)===null||_i===void 0?void 0:_i.apResponse.cid,"_").concat((_s=this._joinInfo)===null||_s===void 0?void 0:_s.apResponse.cert),icePwd:"".concat((_c=this._joinInfo)===null||_c===void 0?void 0:_c.apResponse.cid,"_").concat((_u=this._joinInfo)===null||_u===void 0?void 0:_u.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(_h=yE("FINGERPRINT"))!==null&&_h!==void 0?_h:$.fingerprint}]},_p,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(_t).catch(Wt)})}_handleGatewaySignalEvents(){this._gateway.signal.on(C_.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(C_.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(C_.ON_ADD_AUDIO_STREAM,$=>this._handleAddAudioOrVideoStream("audio",$.uid,$.ssrcId,$.cname,$.uint_id,$.ortc)),this._gateway.signal.on(C_.ON_ADD_VIDEO_STREAM,$=>this._handleAddAudioOrVideoStream("video",$.uid,$.ssrcId,$.cname,$.uint_id,$.ortc,$.rtxSsrcId)),this._gateway.signal.on(C_.ON_REMOTE_DATASTREAM_UPDATE,$=>{this._handleUpdateDataChannel($)}),this._gateway.signal.on(C_.ON_REMOTE_FULL_DATASTREAM_INFO,$=>{this._handleUpdateDataChannel({added:$.datastreams,deleted:[]},!0)}),this._gateway.signal.on(C_.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(C_.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(C_.MUTE_AUDIO,$=>this._handleMuteStream($.uid,h_.AUDIO,!0)),this._gateway.signal.on(C_.UNMUTE_AUDIO,$=>this._handleMuteStream($.uid,h_.AUDIO,!1)),this._gateway.signal.on(C_.MUTE_VIDEO,$=>this._handleMuteStream($.uid,h_.VIDEO,!0)),this._gateway.signal.on(C_.UNMUTE_VIDEO,$=>this._handleMuteStream($.uid,h_.VIDEO,!1)),this._gateway.signal.on(C_.RECEIVE_METADATA,$=>{const _e=PI($.metadata);this.safeEmit(j_.RECEIVE_METADATA,$.uid,_e)}),this._gateway.signal.on(C_.ON_DATA_STREAM,async $=>{var _e;if(!$)return;let _t=PI($.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&i_(_e=["aes-128-gcm2","aes-256-gcm2"]).call(_e,this._encryptionMode)){if($.payload.length<PO)throw new DE(mE.UNEXPECTED_RESPONSE,"payload length ".concat($.payload.length," is less than header length ").concat(PO));_t=await async function(_i,_s,_c){const _u=_c.subarray(0,PO),_h=_u.slice(8,PO),_p=(_h[0]<<8)+_h[1],Qm=(_u[6]<<8)+_u[7],_g=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:_i,tagLength:KH,additionalData:new Uint8Array(WH(_p,2))},_s,_c.subarray(PO));return new Uint8Array(_g).subarray(0,Qm)}(this._encryptDataStreamIv,this._encryptDataStreamKey,_t)}let Wt=0;if($.ordered||$.syncWithAudio){const _n=this._p2pChannel.getStats(),_i=this.remoteUsers.find(_c=>_c.uid===$.uid),_s=_n==null?void 0:_n.audioRecv.find(_c=>_c.ssrc===(_i==null?void 0:_i._audioSSRC));Wt=_s==null?void 0:_s.jitterBufferMs}Wt==null&&(Wt=0),Xhe(KT(KT({},$),{},{payload:_t}),Wt,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(C_.ON_CRYPT_ERROR,()=>{q1(()=>{iE.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(j_.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(C_.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(C_.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{iE.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,U_.TOKEN_EXPIRE),this.safeEmit(j_.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(C_.ON_STREAM_FALLBACK_UPDATE,$=>{iE.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat($.stream_id,", attr: ").concat($.stream_type)),this.safeEmit(j_.STREAM_FALLBACK,$.stream_id,$.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(C_.ON_PUBLISH_STREAM,$=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:$.proxy})),iE.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify($))))}),this._gateway.signal.on(C_.ENABLE_LOCAL_VIDEO,$=>{this._handleSetStreamLocalEnable("video",$.uid,!0)}),this._gateway.signal.on(C_.DISABLE_LOCAL_VIDEO,$=>{this._handleSetStreamLocalEnable("video",$.uid,!1)}),this._gateway.signal.on(l_.REQUEST_TIMEOUT,($,_e)=>{if(this._joinInfo)switch($){case g_.PUBLISH:{if(!_e)return;const _n=_e.ortc;if(_n){var _t,Wt;const _i=_n.some(_u=>{let{stream_type:_h}=_u;return _h===n0.Audio}),_s=_n.some(_u=>{let{stream_type:_h}=_u;return _h!==n0.Audio}),_c=_n.some(_u=>{let{stream_type:_h}=_u;return _h===n0.Screen||_h===n0.ScreenLow});_e.state==="offer"&&p_.publish(this._joinInfo.sid,{eventElapse:DS.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:mE.TIMEOUT,audio:_i,video:_s,p2pid:_e.p2p_id,publishRequestid:this.store.pubId,screenshare:_c,audioName:_i?(_t=_n.find(_u=>{let{stream_type:_h}=_u;return _h===n0.Audio}))===null||_t===void 0||(_t=_t.ssrcs[0])===null||_t===void 0?void 0:_t.ssrcId.toString():void 0,videoName:_s?(Wt=_n.find(_u=>{let{stream_type:_h}=_u;return _h!==n0.Audio}))===null||Wt===void 0||(Wt=Wt.ssrcs[0])===null||Wt===void 0?void 0:Wt.ssrcId.toString():void 0})}break}case g_.SUBSCRIBE:_e&&p_.subscribe(this._joinInfo.sid,{succ:!1,ec:mE.TIMEOUT,audio:_e.stream_type===h_.AUDIO,video:_e.stream_type===h_.VIDEO,peerid:_e.stream_id,subscribeRequestid:_e.ssrcId,p2pid:this.store.p2pId,eventElapse:DS.measureFromSubscribeStart(this.store.clientId,_e.ssrcId)})}}),this._gateway.signal.on(C_.ON_P2P_OK,$=>{this.uid,this._uid}),this._gateway.signal.on(C_.ON_PUBLISHED_USER_LIST,$=>{if($==null||!$.users)return;yE("BLOCK_LOCAL_CLIENT")&&($.users=$.users.filter(Wt=>!DI(Wt.string_id||Wt.stream_id,this.channelName)));const _e=[],_t=[];for(const Wt of $.users){let _n=this._users.find(_p=>_p._uintid===Wt.stream_id);_n?_n._trust_in_room_=!0:(_n=new cI(Wt.string_id||Wt.stream_id,Wt.stream_id),this._users.push(_n),this.getListeners(j_.PUBLISHED_USER_LIST).length===0&&(iE.debug("[".concat(this._clientId,"] user online"),Wt.stream_id),this.safeEmit(j_.USER_JOINED,_n)));const _i=pS.Audio&Wt.stream_type,_s=(pS.Video|pS.LwoVideo)&Wt.stream_type,_c=(65280&Wt.stream_type)!=0,_u=_i&&_n.hasAudio,_h=_s&&_n.hasVideo;_s&&(_n._trust_video_stream_added_state_=!0,_n._video_added_=!0,_n._videoSSRC=Wt.video_ssrc,_n._rtxSsrcId=Wt.video_rtx),_i&&(_n._trust_audio_stream_added_state_=!0,_n._audio_added_=!0,_n._audioSSRC=Wt.audio_ssrc),_i&&!_u&&this.getListeners(j_.PUBLISHED_USER_LIST).length===0&&(iE.info("[".concat(this._clientId,"] remote user ").concat(_n.uid," published audio")),this.safeEmit(j_.USER_PUBLISHED,_n,"audio")),_s&&!_h&&this.getListeners(j_.PUBLISHED_USER_LIST).length===0&&(iE.info("[".concat(this._clientId,"] remote user ").concat(_n.uid," published video")),this.safeEmit(j_.USER_PUBLISHED,_n,"video")),(_i&&!_u||_s&&!_h||_c)&&_e.push(_n),_s&&this._p2pChannel.hasPendingRemoteMedia(_n,"video")&&_t.push({user:_n,mediaType:"video"}),_i&&this._p2pChannel.hasPendingRemoteMedia(_n,"audio")&&_t.push({user:_n,mediaType:"audio"})}_t.length>0&&(iE.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(_t.map(Wt=>"user: ".concat(Wt.user.uid,", mediaType: ").concat(Wt.mediaType)).join("; ")," ")),this.massSubscribe(_t).catch(Wt=>{iE.error("[".concat(this._clientId,"] mass resubscribe error"),Wt.toString())})),this.getListeners(j_.PUBLISHED_USER_LIST).length>0?yE("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=_e:(iE.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(_e.map(Wt=>Wt.uid).join(", "))),this.safeEmit(j_.PUBLISHED_USER_LIST,_e)):iE.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(_e.map(Wt=>Wt.uid).join(", ")))}),this._gateway.signal.on(C_.ON_RTP_CAPABILITY_CHANGE,$=>{const{video_codec:_e}=$;this._p2pChannel instanceof PM&&this._p2pChannel.updateRemoteRTPCapabilities(_e.map(_t=>_t.toLowerCase()).filter(_t=>{var Wt;return i_(Wt=Object.keys(NO)).call(Wt,_t)}))})}_handleP2PEvents(){this._gateway.signal.on(C_.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(W0.PUBLISH,($,_e,_t)=>{const{uid:Wt}=$;$.forEach(_n=>{const{kind:_i,ssrcs:_s,mid:_c,isMuted:_u}=_n;this._handleP2PAddAudioOrVideoStream(_i,Wt,_s[0].ssrcId,_c);const _h=this._users.find(_p=>_p.uid===Wt);return _h&&this._p2pChannel instanceof vT?this._p2pChannel.mockSubscribe(_h,_i,_s[0].ssrcId,_c).then(()=>{_e()}).catch(_t):_e(),this._handleMuteStream(Wt,_i,!!_u)})}),this._gateway.signal.on(W0.CALL,async($,_e,_t)=>{if(this._p2pChannel instanceof vT)try{var Wt;_e(await this._p2pChannel.startP2P({turnServer:(Wt=this._joinInfo)===null||Wt===void 0?void 0:Wt.turnServer},$))}catch(_n){_t(_n)}}),this._gateway.signal.on(l_.P2P_CONNECTION,async $=>{this._p2pChannel instanceof vT&&await this._p2pChannel.p2pConnect($)}),this._gateway.signal.on(W0.UNPUBLISH,async($,_e,_t)=>{if(this._p2pChannel instanceof vT){const{unpubMsg:Wt,uid:_n}=$,_i=this._users.find(_s=>_s.uid===_n);if(!_i)return iE.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(_n)),void _e();try{Wt.forEach(async _s=>{let{stream_type:_c}=_s;const _u=_c===n0.Audio?h_.AUDIO:h_.VIDEO;await this._p2pChannel.unsubscribe(_i,_u),this._handleMuteStream(_n,_u,!0)}),_e()}catch(_s){_t(_s)}}}),this._gateway.signal.on(W0.CONTROL,async($,_e)=>{const{action:_t}=$;switch(_t){case J1.MUTE_LOCAL_VIDEO:this._handleMuteStream(_e,h_.VIDEO,!0);break;case J1.MUTE_LOCAL_AUDIO:this._handleMuteStream(_e,h_.AUDIO,!0);break;case J1.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",_e),this._handleMuteStream(_e,h_.VIDEO,!1);break;case J1.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",_e),this._handleMuteStream(_e,h_.AUDIO,!1)}}),this._gateway.signal.on(W0.RESTART_ICE,async($,_e,_t)=>{if(this._p2pChannel instanceof vT)try{const{direction:Wt,iceParameter:_n}=$;Wt!==YS.SEND_ONLY||_n?_e(await this._p2pChannel.restartICE(Wt,_n)):(this._p2pChannel.handleDisconnect(Wt),_e())}catch(Wt){_t(Wt)}}),this._gateway.signal.on(W0.CANDIDATE,$=>{if(this._p2pChannel instanceof vT){const{candidate:_e,direction:_t}=$;this._p2pChannel.addRemoteCandidate(_e,_t)}}),this._p2pChannel.on(y_.RequestP2PRestartICE,async($,_e,_t)=>{try{const{direction:Wt}=$;_e(await this._gateway.sendExtensionMessage(W0.RESTART_ICE,$,Wt===YS.SEND_ONLY))}catch(Wt){_t(Wt)}}),this._p2pChannel.on(y_.LocalCandidate,$=>{this._gateway.sendExtensionMessage(W0.CANDIDATE,JSON.stringify($),!0)}),this._p2pChannel.on(y_.RequestP2PMuteLocal,async($,_e,_t)=>{try{await this._gateway.sendExtensionMessage(W0.CONTROL,$,!0),_e()}catch(Wt){_t(Wt)}}),this._p2pChannel.on(y_.RequestP2PUnmuteRemote,async($,_e,_t)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote($,this._joinInfo.stringUid||this._joinInfo.uid),_e()}catch(Wt){Wt.code===mE.DISCONNECT_P2P?_e():_t(Wt)}else _e()}),this._p2pChannel.on(y_.RequestP2PMuteRemote,async($,_e,_t)=>{if(this._joinInfo)try{await this._gateway.muteRemote($,this._joinInfo.stringUid||this._joinInfo.uid),_e()}catch(Wt){Wt.code===mE.DISCONNECT_P2P?_e():_t(Wt)}else _e()}),this._p2pChannel.on(y_.StateChange,($,_e)=>{_e===i0.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(y_.RequestMuteLocal,async($,_e,_t)=>{if(this._joinInfo)try{await this._gateway.muteLocal($,this._joinInfo.stringUid||this._joinInfo.uid),_e()}catch(Wt){Wt.code===mE.DISCONNECT_P2P?_e():_t(Wt)}else _e()}),this._p2pChannel.on(y_.RequestUnmuteLocal,async($,_e,_t)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal($,this._joinInfo.stringUid||this._joinInfo.uid),_e()}catch(Wt){Wt.code===mE.DISCONNECT_P2P?_e():_t(Wt)}else _e()}),this._p2pChannel.on(y_.RequestRePublish,($,_e,_t)=>{this.publish($,!1).then(_e).catch(_t)}),this._p2pChannel.on(y_.RequestRePublishDataChannel,($,_e,_t)=>{n_.all($.map(async Wt=>{await this._p2pChannel.publishDataChannel([Wt]);const _n={streamId:Wt.id,ordered:Wt.ordered,maxRetransmits:Wt.maxRetransmits,metadata:Wt.metadata,channelId:Wt._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,_n,!0)}catch(_i){if(_i.code!==mE.DISCONNECT_P2P)throw _i}})).then(_e).catch(_t)}),this._p2pChannel.on(y_.RequestReSubscribe,async($,_e,_t)=>{try{for(const{user:Wt,kind:_n}of $)_n===h_.VIDEO?await this.subscribe(Wt,"video"):await this.subscribe(Wt,"audio");_e()}catch(Wt){_t(Wt)}}),this._p2pChannel.on(y_.RequestUpload,($,_e)=>{this._gateway.upload($,_e)}),this._p2pChannel.on(y_.RequestUploadStats,$=>{this._gateway.uploadWRTCStats($)}),this._p2pChannel.on(y_.MediaReconnectStart,$=>{this.safeEmit(j_.MEDIA_RECONNECT_START,$)}),this._p2pChannel.on(y_.MediaReconnectEnd,$=>{this.safeEmit(j_.MEDIA_RECONNECT_END,$)}),this._p2pChannel.on(y_.NeedSignalRTT,$=>{$(this._gateway.getSignalRTT())}),this._p2pChannel.on(y_.RequestRestartICE,async $=>{if(this._p2pChannel instanceof vT)return;const _e=await this._p2pChannel.restartICE($),_t=await _e.next();if(_t.done)return;const Wt=_t.value;let _n;try{_n=await this._gateway.restartICE({iceParameters:Wt})}catch(_s){return void _e.throw(_s)}const{iceParameters:_i}=function(_s){const _c=_s.iceParameters;return{iceParameters:{iceUfrag:_c.iceUfrag,icePwd:_c.icePwd}}}(_n);await _e.next({remoteIceParameters:_i})}),this._p2pChannel.on(y_.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(y_.RequestReconnectPC,async()=>{var $;const{iceParameters:_e,dtlsParameters:_t,rtpCapabilities:Wt}=await this._p2pChannel.startP2PConnection({turnServer:($=this._joinInfo)===null||$===void 0?void 0:$.turnServer}),{gatewayEstablishParams:_n,gatewayAddress:_i}=await this._gateway.reconnectPC({iceParameters:_e,dtlsParameters:_t,rtpCapabilities:Wt}),{dtlsParameters:_s,iceParameters:_c,candidates:_u,rtpCapabilities:_h,setup:_p,cname:Qm}=T9(_n,_i);await this._p2pChannel.connect(_c,_s,_u,_h,_p,Qm),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(y_.RequestUnpublishForReconnectPC,async($,_e,_t)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish($,this._uid),_e()):_t()}),this._p2pChannel.on(y_.P2PLost,()=>{this.safeEmit(j_.P2P_LOST,this.store.uid)}),this._p2pChannel.on(y_.UpdateVideoEncoder,$=>{$._encoderConfig&&this._gateway.setVideoProfile($._encoderConfig)}),this._p2pChannel.on(y_.ConnectionTypeChange,$=>{this.safeEmit(j_.IS_USING_CLOUD_PROXY,$)}),this._p2pChannel.on(y_.RequestLowStreamParameter,$=>{$(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(y_.QueryClientConnectionState,$=>{$(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect($){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!$)throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!$.inspectType||!Array.isArray($.inspectType))throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const _e=[...new Set($.inspectType)];_e.forEach(_t=>{var Wt;if(!i_(Wt=["supervise","moderation"]).call(Wt,_t))throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(_t," is not a valid inspect type."))}),$.inspectType=_e}if($&&$.extraInfo&&$.extraInfo.length>1024)throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const _e=new kM($);this._inspect=_e,this.handleVideoInspectEvents(this._inspect),await _e.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},Y0)}catch(_e){throw Array.isArray(_e)?_e[0]:_e}}async disableContentInspect(){if(!this._inspect)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch($){throw Array.isArray($)?$[0]:$}}async setImageModeration($,_e){if(E1($,"enabled"),$){if(!_e)throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(u0(_e.interval,"interval",1e3,1/0),_e&&_e.extraInfo&&_e.extraInfo.length>1024)throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] config.extraInfo length cannot exceed 1024 bytes"));if(_e&&_e.vendor&&_e.vendor.length>1024)throw new DE(mE.INVALID_PARAMS,"[".concat(this._clientId,"] config.vendor length cannot exceed 1024 bytes"));if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(_e);const _t=new S8(_e);this._moderation=_t,this.handleImageModerationEvents(this._moderation),await _t.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},Y0)}catch(_t){throw Array.isArray(_t)?_t[0]:_t}}else{if(!this._moderation)throw new DE(mE.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(_t){throw Array.isArray(_t)?_t[0]:_t}}}setP2PTransport($){if(function(_e){aS(_e,"transport",["default","auto","relay","sd-rtn"])}($),this.mode!=="p2p")throw new DE(mE.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=$,iE.info("[".concat(this._clientId,"] set client p2pTransport to ").concat($))}handleImageModerationEvents($){$.on(OR.CONNECTION_STATE_CHANGE,(_e,_t)=>{if(this.safeEmit(j_.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,_e,_t),_e===VT.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new DE(mE.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");$.inspectImage()}}),$.on(OR.CLIENT_LOCAL_VIDEO_TRACK,_e=>{_e(this.localTracks.filter(_t=>_t.trackMediaType==="video")[0])})}handleVideoInspectEvents($){$.on(vS.CONNECTION_STATE_CHANGE,(_e,_t)=>{if(this.safeEmit(j_.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,_e,_t),_t===rR.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(j_.CONTENT_INSPECT_ERROR,new DE(mE.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));$.inspectImage()}}),$.on(vS.INSPECT_RESULT,(_e,_t)=>{var Wt;if((_t==null?void 0:_t.code)===mE.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return iE.debug("Stop inspect content because that has left channel"),this==null||(Wt=this._inspect)===null||Wt===void 0||Wt.close(),void(this._inspect=void 0);this.safeEmit(j_.CONTENT_INSPECT_RESULT,_e,_t)}),$.on(vS.CLIENT_LOCAL_VIDEO_TRACK,_e=>{_e(this.localTracks.filter(_t=>_t.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return iE.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled($){E1($,"enabled"),d0("ENABLE_PUBLISH_AUDIO_FILTER",$),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled($)}_handleResetAddStream($,_e){switch(_e){case"audio":$._audio_added_=!1,$._trust_audio_stream_added_state_=!0;break;case"video":$._video_added_=!1,$._trust_video_stream_added_state_=!0}}},t_(o_.prototype,"leave",[KY],Object.getOwnPropertyDescriptor(o_.prototype,"leave"),o_.prototype),t_(o_.prototype,"publish",[$Y],Object.getOwnPropertyDescriptor(o_.prototype,"publish"),o_.prototype),t_(o_.prototype,"unpublish",[YY],Object.getOwnPropertyDescriptor(o_.prototype,"unpublish"),o_.prototype),t_(o_.prototype,"subscribe",[JY],Object.getOwnPropertyDescriptor(o_.prototype,"subscribe"),o_.prototype),t_(o_.prototype,"presubscribe",[XY],Object.getOwnPropertyDescriptor(o_.prototype,"presubscribe"),o_.prototype),t_(o_.prototype,"massSubscribe",[ZY],Object.getOwnPropertyDescriptor(o_.prototype,"massSubscribe"),o_.prototype),t_(o_.prototype,"unsubscribe",[QY],Object.getOwnPropertyDescriptor(o_.prototype,"unsubscribe"),o_.prototype),t_(o_.prototype,"massUnsubscribe",[eJ],Object.getOwnPropertyDescriptor(o_.prototype,"massUnsubscribe"),o_.prototype),t_(o_.prototype,"setLowStreamParameter",[tJ],Object.getOwnPropertyDescriptor(o_.prototype,"setLowStreamParameter"),o_.prototype),t_(o_.prototype,"enableDualStream",[nJ],Object.getOwnPropertyDescriptor(o_.prototype,"enableDualStream"),o_.prototype),t_(o_.prototype,"disableDualStream",[rJ],Object.getOwnPropertyDescriptor(o_.prototype,"disableDualStream"),o_.prototype),t_(o_.prototype,"setClientRole",[iJ],Object.getOwnPropertyDescriptor(o_.prototype,"setClientRole"),o_.prototype),t_(o_.prototype,"setProxyServer",[oJ],Object.getOwnPropertyDescriptor(o_.prototype,"setProxyServer"),o_.prototype),t_(o_.prototype,"setTurnServer",[sJ],Object.getOwnPropertyDescriptor(o_.prototype,"setTurnServer"),o_.prototype),t_(o_.prototype,"setLicense",[aJ],Object.getOwnPropertyDescriptor(o_.prototype,"setLicense"),o_.prototype),t_(o_.prototype,"startProxyServer",[cJ],Object.getOwnPropertyDescriptor(o_.prototype,"startProxyServer"),o_.prototype),t_(o_.prototype,"stopProxyServer",[lJ],Object.getOwnPropertyDescriptor(o_.prototype,"stopProxyServer"),o_.prototype),t_(o_.prototype,"setLocalAccessPointsV2",[uJ],Object.getOwnPropertyDescriptor(o_.prototype,"setLocalAccessPointsV2"),o_.prototype),t_(o_.prototype,"setLocalAccessPoints",[dJ],Object.getOwnPropertyDescriptor(o_.prototype,"setLocalAccessPoints"),o_.prototype),t_(o_.prototype,"setRemoteDefaultVideoStreamType",[hJ],Object.getOwnPropertyDescriptor(o_.prototype,"setRemoteDefaultVideoStreamType"),o_.prototype),t_(o_.prototype,"setRemoteVideoStreamType",[pJ],Object.getOwnPropertyDescriptor(o_.prototype,"setRemoteVideoStreamType"),o_.prototype),t_(o_.prototype,"setStreamFallbackOption",[fJ],Object.getOwnPropertyDescriptor(o_.prototype,"setStreamFallbackOption"),o_.prototype),t_(o_.prototype,"setEncryptionConfig",[mJ],Object.getOwnPropertyDescriptor(o_.prototype,"setEncryptionConfig"),o_.prototype),t_(o_.prototype,"renewToken",[gJ],Object.getOwnPropertyDescriptor(o_.prototype,"renewToken"),o_.prototype),t_(o_.prototype,"enableAudioVolumeIndicator",[EJ],Object.getOwnPropertyDescriptor(o_.prototype,"enableAudioVolumeIndicator"),o_.prototype),t_(o_.prototype,"startLiveStreaming",[vJ],Object.getOwnPropertyDescriptor(o_.prototype,"startLiveStreaming"),o_.prototype),t_(o_.prototype,"setLiveTranscoding",[_J],Object.getOwnPropertyDescriptor(o_.prototype,"setLiveTranscoding"),o_.prototype),t_(o_.prototype,"stopLiveStreaming",[yJ],Object.getOwnPropertyDescriptor(o_.prototype,"stopLiveStreaming"),o_.prototype),t_(o_.prototype,"addInjectStreamUrl",[bJ],Object.getOwnPropertyDescriptor(o_.prototype,"addInjectStreamUrl"),o_.prototype),t_(o_.prototype,"removeInjectStreamUrl",[SJ],Object.getOwnPropertyDescriptor(o_.prototype,"removeInjectStreamUrl"),o_.prototype),t_(o_.prototype,"startChannelMediaRelay",[TJ],Object.getOwnPropertyDescriptor(o_.prototype,"startChannelMediaRelay"),o_.prototype),t_(o_.prototype,"updateChannelMediaRelay",[wJ],Object.getOwnPropertyDescriptor(o_.prototype,"updateChannelMediaRelay"),o_.prototype),t_(o_.prototype,"stopChannelMediaRelay",[RJ],Object.getOwnPropertyDescriptor(o_.prototype,"stopChannelMediaRelay"),o_.prototype),t_(o_.prototype,"sendCustomReportMessage",[CJ],Object.getOwnPropertyDescriptor(o_.prototype,"sendCustomReportMessage"),o_.prototype),t_(o_.prototype,"pickSVCLayer",[IJ],Object.getOwnPropertyDescriptor(o_.prototype,"pickSVCLayer"),o_.prototype),t_(o_.prototype,"setRTMConfig",[AJ],Object.getOwnPropertyDescriptor(o_.prototype,"setRTMConfig"),o_.prototype),t_(o_.prototype,"enableContentInspect",[OJ],Object.getOwnPropertyDescriptor(o_.prototype,"enableContentInspect"),o_.prototype),t_(o_.prototype,"disableContentInspect",[NJ],Object.getOwnPropertyDescriptor(o_.prototype,"disableContentInspect"),o_.prototype),t_(o_.prototype,"setImageModeration",[PJ],Object.getOwnPropertyDescriptor(o_.prototype,"setImageModeration"),o_.prototype),t_(o_.prototype,"setP2PTransport",[kJ],Object.getOwnPropertyDescriptor(o_.prototype,"setP2PTransport"),o_.prototype),t_(o_.prototype,"getJoinChannelServiceRecords",[DJ],Object.getOwnPropertyDescriptor(o_.prototype,"getJoinChannelServiceRecords"),o_.prototype),t_(o_.prototype,"setPublishAudioFilterEnabled",[LJ],Object.getOwnPropertyDescriptor(o_.prototype,"setPublishAudioFilterEnabled"),o_.prototype),o_);class GP{constructor(_e,_t){hE(this,"id",0),hE(this,"element",void 0),hE(this,"peerPair",void 0),hE(this,"context",void 0),hE(this,"audioPlayerElement",void 0),hE(this,"audioTrack",void 0),GP.count+=1,this.id=GP.count,this.element=_e,this.context=_t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=_e=>{const _t=document.createElement("audio");_t.srcObject=new MediaStream([_e.track]),_t.play(),this.audioPlayerElement=_t}}async switchSdp(){if(!this.peerPair)return;const _e=async(Wt,_n)=>{const _i=_n==="offer"?await Wt.createOffer():await Wt.createAnswer();return await Wt.setLocalDescription(_i),Wt.iceGatheringState==="complete"?Wt.localDescription:new n_(_s=>{Wt.onicegatheringstatechange=()=>{Wt.iceGatheringState==="complete"&&_s(Wt.localDescription)}})},_t=async(Wt,_n)=>await Wt.setRemoteDescription(_n);try{const Wt=await _e(this.peerPair[0],"offer");await _t(this.peerPair[1],Wt);const _n=await _e(this.peerPair[1],"answer");await _t(this.peerPair[0],_n)}catch(Wt){throw new DE(mE.LOCAL_AEC_ERROR,Wt.toString()).print()}}async getTracksFromMediaElement(_e){if(this.audioTrack)return this.audioTrack;let _t;try{_e instanceof HTMLVideoElement&&(_e.captureStream?_e.captureStream():_e.mozCaptureStream()),_t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(_e).connect(_t)}catch(_n){throw new DE(mE.LOCAL_AEC_ERROR,_n.toString()).print()}if(!_t)throw new DE(mE.LOCAL_AEC_ERROR,"no dest node when local aec").print();const Wt=_t.stream.getAudioTracks()[0];return this.audioTrack=Wt,Wt}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const _e=this.element,_t=await this.getTracksFromMediaElement(_e);this.peerPair&&this.peerPair[0].addTrack(_t),await this.switchSdp()}close(){iE.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(_e=>{_e.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var MJ,jM;hE(GP,"count",0);const rpe=window.AudioContext||window.webkitAudioContext,ipe=new(MJ=__({report:p_}),t_((jM=class{constructor(){hE(this,"units",[]),hE(this,"context",void 0)}processExternalMediaAEC($){if(!this._doesEnvironmentNeedAEC())return iE.debug("the system does not need to process local aec"),-1;this.context||(this.context=new rpe);let _e=this.units.find(_t=>_t&&_t.getElement()===$);return _e||(_e=new GP($,this.context),this.units.push(_e)),_e.startEchoCancellation(),iE.debug("start processing local audio echo cancellation, id is",_e.id),_e.id}_doesEnvironmentNeedAEC(){return W_().name!==t0.SAFARI}}).prototype,"processExternalMediaAEC",[MJ],Object.getOwnPropertyDescriptor(jM.prototype,"processExternalMediaAEC"),jM.prototype),jM);function UJ($,_e){var _t=Object.keys($);if(Object.getOwnPropertySymbols){var Wt=Object.getOwnPropertySymbols($);_e&&(Wt=Wt.filter(function(_n){return Object.getOwnPropertyDescriptor($,_n).enumerable})),_t.push.apply(_t,Wt)}return _t}function jJ($){for(var _e=1;_e<arguments.length;_e++){var _t=arguments[_e]!=null?arguments[_e]:{};_e%2?UJ(Object(_t),!0).forEach(function(Wt){hE($,Wt,_t[Wt])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(_t)):UJ(Object(_t)).forEach(function(Wt){Object.defineProperty($,Wt,Object.getOwnPropertyDescriptor(_t,Wt))})}return $}const O8=window||document;function FJ($){let _e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!O8)return;const _t=eS._cspEventHandlerPointer;if(_t&&_e)return void console.error(_t,_e);const Wt=_n=>{if(!(_n&&_n.blockedURI&&(eS.onSecurityPolicyViolation||eS.getListeners(QR.SECURITY_POLICY_VIOLATION).length>0)))return;const _i=_n.blockedURI;yE("CSP_DETECTED_HOSTNAME_LIST").some(_s=>i_(_i).call(_i,_s))&&(eS.onSecurityPolicyViolation&&typeof eS.onSecurityPolicyViolation=="function"&&eS.onSecurityPolicyViolation(_n),eS.getListeners(QR.SECURITY_POLICY_VIOLATION).length>0&&eS.safeEmit(QR.SECURITY_POLICY_VIOLATION,_n))};_t&&O8.removeEventListener("securitypolicyviolation",_t),(_e||$&&typeof $=="function"||eS.getListeners(QR.SECURITY_POLICY_VIOLATION).length>0)&&O8.addEventListener("securitypolicyviolation",Wt),eS._cspEventHandlerPointer=Wt}d0("PROCESS_ID","process-".concat(f0(8,""),"-").concat(f0(4,""),"-").concat(f0(4,""),"-").concat(f0(4,""),"-").concat(f0(12,""))),function(){let $;try{$=window.localStorage.getItem("websdk_ng_global_parameter")}catch(_e){return void iE.error("Error loading sdk config",_e.message)}if($)try{const _e=JSON.parse(window.atob($)),_t=Date.now();iE.debug("Loading global parameters from cache",_e),Object.keys(_e).forEach(Wt=>{if(Object.prototype.hasOwnProperty.call(nS,Wt)){const{value:_n,expires:_i}=_e[Wt];if(_i&&_i<=_t)return;K1[Wt]=_n,nS[Wt]=_n}})}catch(_e){iE.error("Error loading mutableParamsCache: ".concat($),_e.message)}}(),Array.isArray(K1.AREAS)&&K1.AREAS.length>0&&qV(K1.AREAS,!0);const VJ=($,_e,_t)=>{iE.debug("setParameter key:".concat($,", value:").concat(JSON.stringify(_e))),d0($,_e,_t)},eS=function($){const _e=new A0,_t=$,Wt={getListeners:_e.getListeners.bind(_e),on:(_n,_i)=>(function(_s,_c){_s===QR.SECURITY_POLICY_VIOLATION&&FJ(_c,!0)}(_n,_i),_e.on.bind(_e)(_n,_i)),addListener:_e.addListener.bind(_e),once:_e.once.bind(_e),off:_e.off.bind(_e),removeAllListeners:_e.removeAllListeners.bind(_e),emit:_e.emit.bind(_e),safeEmit:_e.safeEmit.bind(_e)};return jJ(jJ({},_t),Wt)}({__TRACK_LIST__:XO,VERSION:jT,BUILD:AV,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:VJ,getParameter:yE,getSupportedCodec:async function(){let $={audio:[],video:[]};try{let _e=new RTCPeerConnection;const _t=await async function(Wt){let _n;return B_().supportUnifiedPlan?(Wt.addTransceiver("video",{direction:"recvonly"}),Wt.addTransceiver("audio",{direction:"recvonly"}),_n=(await Wt.createOffer()).sdp):_n=(await Wt.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,_n}(_e);if(!_t)return $;_e.close(),_e=null,$=function(Wt){const _n={video:[],audio:[]};return Wt.match(/ VP8/i)&&_n.video.push("VP8"),Wt.match(/ VP9/i)&&_n.video.push("VP9"),Wt.match(/ AV1/i)&&_n.video.push("AV1"),Wt.match(/ H264/i)&&_n.video.push("H264"),Wt.match(/ H265/i)&&_n.video.push("H265"),Wt.match(/ opus/i)&&_n.audio.push("OPUS"),Wt.match(/ PCMU/i)&&_n.audio.push("PCMU"),Wt.match(/ PCMA/i)&&_n.audio.push("PCMA"),Wt.match(/ G722/i)&&_n.audio.push("G722"),_n}(_t)}catch(_e){throw new DE(mE.CREATE_OFFER_FAILED,_e.toString&&_e.toString()).print()}return $},checkSystemRequirements:function(){const $=p_.reportApiInvoke(null,{name:Q0.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:j0.TRACER});let _e=!1;try{const _i=window.RTCPeerConnection,_s=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,_c=window.WebSocket;_e=!!(_i&&_s&&_c),_e&&gV()&&function(_u){const _h=W_();return!(_h.name!==t0.CHROME||!_h.osVersion)&&Number(_h.version)<_u}(75)&&new _i().close()}catch(_i){return iE.error("check system requirement failed: ",_i),!1}let _t=!1;const Wt=W_();Wt.name===t0.CHROME&&Number(Wt.version)>=58&&(CR.engine.name!=="WebKit"||function(){const _i=W_();if(_L()){if(_i.os===uS.MAC_OS)return!0;if(_i.os===uS.IOS){const _s=CR.os.version&&CR.os.version.split(".");if(_s&&Number(_s[0])===14&&_s[1]&&Number(_s[1])>=3||_s&&Number(_s[0])>14)return!0}}return!1}())&&(_t=!0),(Wt.name===t0.FIREFOX&&Number(Wt.version)>=56||Wt.name===t0.OPERA&&Number(Wt.version)>=45||Wt.name===t0.SAFARI&&Number(Wt.version)>=11||Wt.name==="WebKit"&&(PS()||tR())&&Wt.osVersion&&Number(Wt.osVersion.split(".")[0])>=11||RH()||W_().name===t0.QQ)&&(_t=!0),iE.debug("checkSystemRequirements, api:",_e,"browser",_t);const _n=_e&&_t;return $.onSuccess(_n),_n},getDevices:function($){return NT.enumerateDevices(!0,!0,$)},getMicrophones:function($){return NT.getRecordingDevices($)},getCameras:function($){return NT.getCamerasDevices($)},getElectronScreenSources:pK,getPlaybackDevices:function($){return NT.getSpeakers($)},createClient:function(){var $;let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const _t=p_.reportApiInvoke(null,{name:Q0.CREATE_CLIENT,options:[_e],tag:j0.TRACER});try{(function(Wt){aS(Wt.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),aS(Wt.mode,"config.mode",["rtc","live","p2p"]),Wt.audioCodec!==void 0&&aS(Wt.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),Wt.proxyServer!==void 0&&bS(Wt.proxyServer,"config.proxyServer",1,1e4),Wt.turnServer!==void 0&&xH(Wt.turnServer),Wt.httpRetryConfig!==void 0&&LH(Wt.httpRetryConfig),Wt.websocketRetryConfig!==void 0&&LH(Wt.websocketRetryConfig)})(_e)}catch(Wt){throw _t.onError(Wt),Wt}return(_H(16,0)||yH(16,0))&&(_e.codec==="vp9"&&(_e.codec="vp8",iE.debug("browser not support vp9, force use vp8")),d0("UNSUPPORTED_VIDEO_CODEC",["vp9"])),_e.audioCodec===void 0&&(_e.audioCodec="opus"),_t.onSuccess(),new npe(KT(KT({forceWaitGatewayResponse:!0},_e),{},{role:i_($=["rtc","p2p"]).call($,_e.mode)?"host":_e.role||"audience"}))},createCameraVideoTrack:async function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const _e=yE("CAMERA_CAPTURE_CONFIG"),_t=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_CAM_VIDEO_TRACK,options:[O0({},$),_e]});_e&&($.encoderConfig=_e);const Wt=uM($),_n=f0(8,"track-cam-");let _i=null;const _s=$.encoderConfig==="720p_auto";iE.info("start create camera video track with config",JSON.stringify($),"trackId",_n);try{_i=(await OT({video:Wt},_n)).getVideoTracks()[0]||null}catch(_u){throw _t.onError(_u),_u}if(!_i){const _u=new HE(mE.UNEXPECTED_ERROR,"can not find track in media stream");return _t.onError(_u),_u.throw(iE)}$.optimizationMode&&Q6(_n,_i,$,i1($.encoderConfig));const _c=new Z6(_i,$,Wt,$.scalabiltyMode?sM($.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},$.optimizationMode,_n);return _s&&_c.startMonitorStats(),_t.onSuccess(_c.getTrackId()),iE.info("create camera video success, trackId:",_n),_c},createCustomVideoTrack:function($){const _e=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_CUSTOM_VIDEO_TRACK,options:[$]}),_t=new m0($.mediaStreamTrack,{width:$.width,height:$.height,frameRate:$.frameRate,bitrateMax:$.bitrateMax,bitrateMin:$.bitrateMin},$.scalabiltyMode?sM($.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},$.optimizationMode,f0(8,"track-cus-"),[S0.CUSTOM_TRACK]);return _e.onSuccess(_t.getTrackId()),iE.info("create custom video track success with config",$,"trackId",_t.getTrackId()),_t},createScreenVideoTrack:async function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const _t=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_SCREEN_VIDEO_TRACK,options:[O0({},$),_e]}),Wt=$.encoderConfig==="720p_auto";$.encoderConfig?typeof $.encoderConfig=="string"||$.encoderConfig.width&&$.encoderConfig.height||($.encoderConfig.width={max:1920},$.encoderConfig.height={max:1080}):$.encoderConfig="1080p_2";const _n=function(Qm){const _g={};Qm.screenSourceType&&(_g.mediaSource=Qm.screenSourceType),Qm.extensionId&&H1()&&(_g.extensionId=Qm.extensionId);const{displaySurface:eE,selfBrowserSurface:pE,surfaceSwitching:aE,systemAudio:cE}=Qm;(fV(107)||EH(107)||bH(93))&&(eE&&(aS(eE,"displaySurface",["browser","window","monitor"]),_g.displaySurface=eE),pE?(aS(pE,"selfBrowserSurface",["exclude","include"]),_g.selfBrowserSurface=pE):_g.selfBrowserSurface="include",aE&&(aS(aE,"surfaceSwitching",["exclude","include"]),_g.surfaceSwitching=aE)),(fV(105)||EH(105)||bH(91))&&cE&&(aS(cE,"systemAudio",["exclude","include"]),_g.systemAudio=cE),Qm.electronScreenSourceId&&(_g.sourceId=Qm.electronScreenSourceId);const fE=Qm.encoderConfig?B6(Qm.encoderConfig):null;return _g.mandatory={chromeMediaSource:"desktop",maxWidth:fE?fE.width:void 0,maxHeight:fE?fE.height:void 0},fE&&(fE.frameRate&&(typeof fE.frameRate=="number"?(_g.mandatory.maxFrameRate=fE.frameRate,_g.mandatory.minFrameRate=fE.frameRate):(_g.mandatory.maxFrameRate=fE.frameRate.max||fE.frameRate.ideal||fE.frameRate.exact||void 0,_g.mandatory.minFrameRate=fE.frameRate.min||fE.frameRate.ideal||fE.frameRate.exact||void 0),_g.frameRate=fE.frameRate),fE.width&&(_g.width=fE.width),fE.height&&(_g.height=fE.height)),_g}($),_i=f0(8,"track-scr-v-");let _s=null,_c=null;const _u=B_();if(!_u.supportShareAudio&&_e==="enable"){const Qm=new HE(mE.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return _t.onError(Qm),Qm.throw(iE)}iE.info("start create screen video track with config",$,"withAudio",_e,"trackId",_i);try{const Qm=await OT({screen:_n,screenAudio:_e==="auto"?_u.supportShareAudio:_e==="enable"},_i);_s=Qm.getVideoTracks()[0]||null,_c=Qm.getAudioTracks()[0]||null}catch(Qm){throw _t.onError(Qm),Qm}if(!_s){const Qm=new HE(mE.UNEXPECTED_ERROR,"can not find track in media stream");return _t.onError(Qm),Qm.throw(iE)}if(!_c&&_e==="enable"){_s&&_s.stop();const Qm=new HE(mE.SHARE_AUDIO_NOT_ALLOWED);return _t.onError(Qm),Qm.throw(iE)}$.optimizationMode||($.optimizationMode="detail"),$.optimizationMode&&(Q6(_i,_s,$,$.encoderConfig&&B6($.encoderConfig)||void 0),$.encoderConfig&&typeof $.encoderConfig!="string"&&($.encoderConfig.bitrateMin=$.encoderConfig.bitrateMax));const _h=new m0(_s,$.encoderConfig?B6($.encoderConfig):{},$.scalabiltyMode?sM($.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},$.optimizationMode,_i,[S0.SCREEN_TRACK]);if(Wt&&_h.startMonitorStats(),!_c)return _t.onSuccess(_h.getTrackId()),iE.info("create screen video track success","video:",_h.getTrackId()),_h;const _p=new V0(_c,void 0,f0(8,"track-scr-a-"),!1);return _t.onSuccess([_h.getTrackId(),_p.getTrackId()]),iE.info("create screen video track success","video:",_h.getTrackId(),"audio:",_p.getTrackId()),[_h,_p]},createMicrophoneAndCameraTracks:async function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const _t=yE("CAMERA_CAPTURE_CONFIG"),Wt=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_MIC_AND_CAM_TRACKS,options:[$,_e,_t]});_t&&(_e.encoderConfig=_t);const _n=_e.encoderConfig==="720p_auto",_i=uM(_e),_s=TK($),_c=f0(8,"track-mic-"),_u=f0(8,"track-cam-");let _h=null,_p=null;iE.info("start create camera video track(".concat(_u,") and microphone audio track(").concat(_c,") with config, audio: ").concat(JSON.stringify($),", video: ").concat(JSON.stringify(_e)));try{const eE=await OT({audio:_s,video:_i},"".concat(_c,"-").concat(_u));_h=eE.getAudioTracks()[0],_p=eE.getVideoTracks()[0]}catch(eE){throw Wt.onError(eE),eE}if(!_h||!_p){const eE=new HE(mE.UNEXPECTED_ERROR,"can not find tracks in media stream");return Wt.onError(eE),eE.throw(iE)}_e.optimizationMode&&Q6(_u,_p,_e,i1(_e.encoderConfig));const Qm=new dM(_h,$,_s,_c),_g=new Z6(_p,_e,_i,_e.scalabiltyMode?sM(_e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},_e.optimizationMode,_u);return _n&&_g.startMonitorStats(),Wt.onSuccess([Qm.getTrackId(),_g.getTrackId()]),iE.info("create camera video track(".concat(_u,") and microphone audio track(").concat(_c,") success")),[Qm,_g]},createMicrophoneAudioTrack:async function(){let $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const _e=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_MIC_AUDIO_TRACK,options:[$]}),_t=TK($),Wt=f0(8,"track-mic-");let _n=null;iE.info("start create microphone audio track with config",JSON.stringify($),"trackId",Wt);try{_n=(await OT({audio:_t},Wt)).getAudioTracks()[0]||null}catch(_s){throw _e.onError(_s),_s}if(!_n){const _s=new HE(mE.UNEXPECTED_ERROR,"can not find track in media stream");return _e.onError(_s),_s.throw(iE)}const _i=new dM(_n,$,_t,Wt);return _e.onSuccess(_i.getTrackId()),iE.info("create microphone audio track success, trackId:",Wt),_i},createCustomAudioTrack:function($){const _e=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_CUSTOM_AUDIO_TRACK,options:[$]}),_t=new V0($.mediaStreamTrack,$.encoderConfig?aM($.encoderConfig):{},f0(8,"track-cus-"),!1);return iE.info("create custom audio track success with config",$,"trackId",_t.getTrackId()),_e.onSuccess(_t.getTrackId()),_t},createBufferSourceAudioTrack:async function($){var _e;const{cacheOnlineFile:_t,encoderConfig:Wt}=$;let{source:_n}=$;const _i={source:_n instanceof AudioBuffer?"AudioBuffer":_n instanceof File?(_e=File.name)!==null&&_e!==void 0?_e:"File":_n,cacheOnlineFile:_t,encoderConfig:Wt},_s=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CREATE_BUFFER_AUDIO_TRACK,options:[_i]});if(yE("DISABLE_WEBAUDIO"))throw new HE(mE.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const _c=f0(8,"track-buf-");iE.info("start create buffer source audio track with config",JSON.stringify(_i),"trackId",_c);const _u=_n;if(!(_n instanceof AudioBuffer))try{_n=await async function(Qm,_g){let eE=null;if(typeof Qm=="string"){const aE=l$.get(Qm);if(aE)return iE.debug("use cached audio resource: ",Qm),aE;try{eE=(await IR(()=>tT.get(Qm,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(cE){throw new HE(mE.FETCH_AUDIO_FILE_FAILED,cE.toString())}}else eE=await new n_((cE,fE)=>{const gE=new FileReader;gE.onload=AE=>{AE.target?cE(AE.target.result):fE(new HE(mE.READ_LOCAL_AUDIO_FILE_ERROR))},gE.onerror=()=>{fE(new HE(mE.READ_LOCAL_AUDIO_FILE_ERROR))},gE.readAsArrayBuffer(Qm)});const pE=await function(aE){const cE=nN();return new n_((fE,gE)=>{cE.decodeAudioData(aE,AE=>{fE(AE)},AE=>{gE(new HE(mE.DECODE_AUDIO_FILE_FAILED,AE.toString()))})})}(eE);return typeof Qm=="string"&&_g&&l$.set(Qm,pE),pE}(_n,_t)}catch(Qm){return _s.onError(Qm),Qm.throw(iE)}const _h=new Zde(_n),_p=new Xde(_u,_h,Wt?aM(Wt):{},_c);return iE.info("create buffer source audio track success, trackId:",_c),_s.onSuccess(_p.getTrackId()),_p},setAppType:function($){if(iE.debug("setAppType: ".concat($)),!(Number.isInteger($)&&$>=0))throw iE.debug("Invalid appType"),new DE(mE.INVALID_PARAMS,"invalid app type",$);d0("APP_TYPE",Math.floor($))},setLogLevel:function($){iE.setLogLevel($)},enableLogUpload:function(){yE("USE_NEW_LOG")?d0("UPLOAD_LOG",!0):iE.enableLogUpload()},disableLogUpload:function(){yE("USE_NEW_LOG")?d0("UPLOAD_LOG",!1):iE.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new $9},checkAudioTrackIsActive:async function($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const _t=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[_e]});if(!($ instanceof V0||$ instanceof oN)){const _u=new DE(mE.INVALID_TRACK,"the parameter is not a audio track");return _t.onError(_u),_u.throw()}_e&&_e<1e3&&(_e=1e3);const Wt=$ instanceof V0?$.getTrackLabel():"remote_track",_n=$.getVolumeLevel();let _i=_n,_s=_n;const _c=Date.now();return new n_(_u=>{const _h=setInterval(()=>{const _p=$.getVolumeLevel();_i=_p>_i?_p:_i,_s=_p<_s?_p:_s;const Qm=_i-_s>1e-4,_g=Date.now()-_c;if(Qm||_g>_e){clearInterval(_h);const eE=Qm,pE={duration:_g,deviceLabel:Wt,maxVolumeLevel:_i,result:eE};iE.info("[track-".concat($.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(pE))),_t.onSuccess(pE),_u(eE)}},200)})},checkVideoTrackIsActive:async function($){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const _t=p_.reportApiInvoke(null,{tag:j0.TRACER,name:Q0.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[_e]});if(!($ instanceof m0||$ instanceof iN)){const Qm=new DE(mE.INVALID_TRACK,"the parameter is not a video track");return _t.onError(Qm),Qm.throw()}_e&&_e<1e3&&(_e=1e3);const Wt=$ instanceof m0?$.getTrackLabel():"remote_track",_n=$.getMediaStreamTrack(!0),_i=document.createElement("video");_i.style.width="1px",_i.style.height="1px",_i.setAttribute("muted",""),_i.muted=!0,_i.setAttribute("playsinline",""),_i.controls=!1,(dS()||_L())&&(_i.style.opacity="0.01",_i.style.position="fixed",_i.style.left="0",_i.style.top="0",document.body.appendChild(_i)),_i.srcObject=new MediaStream([_n]),_i.play();const _s=document.createElement("canvas");_s.width=160,_s.height=120;let _c=0,_u=0;try{const Qm=Date.now();_c=await function(_g,eE,pE,aE){let cE,fE=0,gE=null;return new n_((AE,PE)=>{function xE(){fE>aE&&cE&&(cE(),AE(fE));const GE=pE.getContext("2d");if(!GE){const JE=new DE(mE.UNEXPECTED_ERROR,"can not get canvas 2d context.");return iE.error(JE.toString()),void PE(JE)}GE.drawImage(_g,0,0,160,120);const zE=GE.getImageData(0,0,pE.width,pE.height),KE=Math.floor(zE.data.length/3);if(gE){for(let JE=0;JE<KE;JE+=3)if(zE.data[JE]!==gE[JE])return fE+=1,void(gE=zE.data);gE=zE.data}else gE=zE.data}setTimeout(()=>{cE&&(cE(),AE(fE))},eE),cE=z6(()=>{xE()},30)})}(_i,_e,_s,4),_u=Date.now()-Qm}catch(Qm){throw _t.onError(Qm),Qm}Zhe===t0.SAFARI&&(_i.pause(),_i.remove()),_i.srcObject=null;const _h=_c>4,_p={duration:_u,changedPicNum:_c,deviceLabel:Wt,result:_h};return iE.info("[track-".concat($.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(_p))),_t.onSuccess(_p),_h},setArea:qV,audioElementPlayCenter:rT,resumeAudioContext:function(){rT.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function($){ipe.processExternalMediaAEC($)},registerExtensions:function($){const _e=yE("PLUGIN_INFO")||[];$.forEach(_t=>{"name"in _t&&!i_(_e).call(_e,_t.name)&&_e.push(_t.name);const Wt=_t;Wt.__registered__=!0,Wt.logger.hookLog=iE.extLog,Wt.reporter.hookApiInvoke=p_.extApiInvoke,Wt.parameters&&Object.keys(Wt.parameters).forEach(_n=>{Wt.parameters[_n]=yE(_n)})}),VJ("PLUGIN_INFO",_e)},ChannelMediaRelayError:DO,ChannelMediaRelayEvent:_1,ChannelMediaRelayState:aT,RemoteStreamFallbackType:Wde,RemoteStreamType:Hde,ConnectionDisconnectedReason:U_,AudienceLatencyLevelType:nce,AREAS:J_,preload:async function($,_e,_t,Wt){return VY($,_e,_t,Wt)}});return Object.defineProperties(eS,{onAudioAutoplayFailed:{get:()=>PT.onAudioAutoplayFailed,set:$=>{PT.onAudioAutoplayFailed=$}},onAutoplayFailed:{get:()=>PT.onAutoplayFailed,set:$=>{PT.onAutoplayFailed=$}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>eS._onSecurityPolicyViolation,set($){eS._onSecurityPolicyViolation=$,FJ($)}},__CLIENT_LIST__:{get:()=>yE("SHOW_GLOBAL_CLIENT_LIST")?$1:[]}}),NT.on(KI.CAMERA_DEVICE_CHANGED,$=>{iE.info("camera device changed",JSON.stringify($)),eS.onCameraChanged&&eS.onCameraChanged($),eS.safeEmit(QR.CAMERA_CHANGED,$)}),NT.on(KI.RECORDING_DEVICE_CHANGED,$=>{iE.info("microphone device changed",JSON.stringify($)),eS.onMicrophoneChanged&&eS.onMicrophoneChanged($),eS.safeEmit(QR.MICROPHONE_CHANGED,$)}),NT.on(KI.PLAYOUT_DEVICE_CHANGED,$=>{iE.debug("playout device changed",JSON.stringify($)),eS.onPlaybackDeviceChanged&&eS.onPlaybackDeviceChanged($),eS.safeEmit(QR.PLAYBACK_DEVICE_CHANGED,$)}),rT.onAutoplayFailed=()=>{iE.info("detect audio element autoplay failed"),PT.onAudioAutoplayFailed&&PT.onAudioAutoplayFailed()},c0.on("autoplay-failed",()=>{iE.info("detect webaudio autoplay failed"),PT.onAudioAutoplayFailed&&PT.onAudioAutoplayFailed(),eS.safeEmit(QR.AUTOPLAY_FAILED)}),c0.on(SS.STATE_CHANGE,($,_e)=>{iE.info("audio context state changed: ".concat(_e," => ").concat($)),eS.onAudioContextStateChanged&&eS.onAudioContextStateChanged($,_e),eS.safeEmit(QR.AUDIO_CONTEXT_STATE_CHANGED,$,_e)}),F0.on(AI.NETWORK_STATE_CHANGE,($,_e)=>{iE.info("[network-indicator] network state changed, ".concat(_e," => ").concat($))}),window&&(window.__ARTC__=eS),eS})})(AgoraRTC_NProduction);var AgoraRTC_NProductionExports=AgoraRTC_NProduction.exports;const AgoraRTC__default=getDefaultExportFromCjs(AgoraRTC_NProductionExports);function _objectWithoutPropertiesLoose(_,e){if(_==null)return{};var j={},Vt=Object.keys(_),zt,_r;for(_r=0;_r<Vt.length;_r++)zt=Vt[_r],!(e.indexOf(zt)>=0)&&(j[zt]=_[zt]);return j}var AgoraRTCErrorCode;(function(_){_.UNEXPECTED_ERROR="UNEXPECTED_ERROR",_.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",_.TIMEOUT="TIMEOUT",_.INVALID_PARAMS="INVALID_PARAMS",_.NOT_SUPPORTED="NOT_SUPPORTED",_.INVALID_OPERATION="INVALID_OPERATION",_.OPERATION_ABORTED="OPERATION_ABORTED",_.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",_.NETWORK_ERROR="NETWORK_ERROR",_.NETWORK_TIMEOUT="NETWORK_TIMEOUT",_.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",_.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",_.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",_.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",_.ELECTRON_IS_NULL="ELECTRON_IS_NULL",_.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",_.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",_.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",_.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",_.PERMISSION_DENIED="PERMISSION_DENIED",_.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",_.TRACK_IS_DISABLED="TRACK_IS_DISABLED",_.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",_.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",_.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",_.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",_.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",_.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",_.UID_CONFLICT="UID_CONFLICT",_.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",_.INVALID_TRACK="INVALID_TRACK",_.SENDER_NOT_FOUND="SENDER_NOT_FOUND",_.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",_.SET_ANSWER_FAILED="SET_ANSWER_FAILED",_.ICE_FAILED="ICE_FAILED",_.PC_CLOSED="PC_CLOSED",_.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",_.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",_.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",_.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",_.INVALID_REMOTE_USER="INVALID_REMOTE_USER",_.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",_.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",_.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",_.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",_.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",_.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",_.WS_ABORT="WS_ABORT",_.WS_DISCONNECT="WS_DISCONNECT",_.WS_ERR="WS_ERR",_.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",_.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",_.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",_.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",_.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",_.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",_.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",_.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",_.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",_.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",_.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",_.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",_.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",_.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",_.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",_.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",_.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",_.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"})(AgoraRTCErrorCode||(AgoraRTCErrorCode={}));var createClient=function(e){var j;function Vt(){return j||(j=AgoraRTC__default.createClient(e)),j}return function(){return Vt()}};function createMicrophoneAndCameraTracks(_,e){var j=function(){try{return Promise.resolve(AgoraRTC__default.createMicrophoneAndCameraTracks(_,e)).then(function(_r){return Vt=_r,Vt})}catch(_r){return Promise.reject(_r)}},Vt=null;return function(){var _r=reactExports.useState(!1),_o=_r[0],ga=_r[1],_a=reactExports.useState(null),_l=_a[0],_d=_a[1],_f=reactExports.useRef(Vt);return reactExports.useEffect(function(){return _f.current===null?j().then(function(_m){_f.current=_m,ga(!0)},function(_m){_d(_m)}):ga(!0),function(){Vt=null}},[]),{ready:_o,tracks:_f.current,error:_l}}}var AgoraVideoPlayer=function(e){var j=reactExports.useRef(null),Vt=e.videoTrack,zt=e.config,_r=_objectWithoutPropertiesLoose(e,["videoTrack","config"]);return reactExports.useLayoutEffect(function(){return j.current!==null&&Vt.play(j.current,zt),function(){Vt.stop()}},[Vt]),React.createElement("div",Object.assign({},_r,{ref:j}))},agoraRtmSdk={exports:{}};agoraRtmSdk.exports;(function(module,exports){var define_process_env_default={};/*
 @preserve
 AgoraRTM Web SDK 1.4.3-203 - commit: v1.4.3-17-g1e27aa38
 Copyright (C) 2018-2021 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(_,e){module.exports=e()})(commonjsGlobal,function(){function be(_,e){var j=Object.keys(_);if(Object.getOwnPropertySymbols){var Vt=Object.getOwnPropertySymbols(_);e&&(Vt=Vt.filter(function(zt){return Object.getOwnPropertyDescriptor(_,zt).enumerable})),j.push.apply(j,Vt)}return j}function ua(_){for(var e=1;e<arguments.length;e++){var j=arguments[e]!=null?arguments[e]:{};e%2?be(Object(j),!0).forEach(function(Vt){m(_,Vt,j[Vt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(j)):be(Object(j)).forEach(function(Vt){Object.defineProperty(_,Vt,Object.getOwnPropertyDescriptor(j,Vt))})}return _}function X(_){return(X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(_)}function sl(_,e,j,Vt,zt,_r,_o){try{var ga=_[_r](_o),_a=ga.value}catch(_l){return void j(_l)}ga.done?e(_a):Promise.resolve(_a).then(Vt,zt)}function J(_){return function(){var e=this,j=arguments;return new Promise(function(Vt,zt){function _r(_a){sl(ga,Vt,zt,_r,_o,"next",_a)}function _o(_a){sl(ga,Vt,zt,_r,_o,"throw",_a)}var ga=_.apply(e,j);_r(void 0)})}}function W(_,e){if(!(_ instanceof e))throw new TypeError("Cannot call a class as a function")}function tl(_,e){for(var j=0;j<e.length;j++){var Vt=e[j];Vt.enumerable=Vt.enumerable||!1,Vt.configurable=!0,"value"in Vt&&(Vt.writable=!0),Object.defineProperty(_,Vt.key,Vt)}}function Ha(_,e,j){return e&&tl(_.prototype,e),j&&tl(_,j),_}function m(_,e,j){return e in _?Object.defineProperty(_,e,{value:j,enumerable:!0,configurable:!0,writable:!0}):_[e]=j,_}function la(_,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(e&&e.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),e&&df(_,e)}function wd(_){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(_)}function df(_,e){return(df=Object.setPrototypeOf||function(j,Vt){return j.__proto__=Vt,j})(_,e)}function ul(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sh(_,e,j){return(Sh=ul()?Reflect.construct:function(Vt,zt,_r){var _o=[null];return _o.push.apply(_o,zt),Vt=new(Function.bind.apply(Vt,_o)),_r&&df(Vt,_r.prototype),Vt}).apply(null,arguments)}function ef(_){var e=typeof Map=="function"?new Map:void 0;return(ef=function(j){function Vt(){return Sh(j,arguments,wd(this).constructor)}if(j===null||Function.toString.call(j).indexOf("[native code]")===-1)return j;if(typeof j!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(j))return e.get(j);e.set(j,Vt)}return Vt.prototype=Object.create(j.prototype,{constructor:{value:Vt,enumerable:!1,writable:!0,configurable:!0}}),df(Vt,j)})(_)}function ff(_,e){if(_==null)return{};if(_==null)var j={};else{j={};var Vt,zt=Object.keys(_);for(Vt=0;Vt<zt.length;Vt++){var _r=zt[Vt];0<=e.indexOf(_r)||(j[_r]=_[_r])}}if(Object.getOwnPropertySymbols)for(Vt=Object.getOwnPropertySymbols(_),_r=0;_r<Vt.length;_r++)zt=Vt[_r],0<=e.indexOf(zt)||Object.prototype.propertyIsEnumerable.call(_,zt)&&(j[zt]=_[zt]);return j}function n(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function ma(_){var e=ul();return function(){var j=wd(_);if(e){var Vt=wd(this).constructor;j=Reflect.construct(j,arguments,Vt)}else j=j.apply(this,arguments);return j=!j||typeof j!="object"&&typeof j!="function"?n(this):j}}function Th(_,e,j){return(Th=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(Vt,zt,_r){for(;!Object.prototype.hasOwnProperty.call(Vt,zt)&&(Vt=wd(Vt))!==null;);if(Vt)return(zt=Object.getOwnPropertyDescriptor(Vt,zt)).get?zt.get.call(_r):zt.value})(_,e,j||_)}function ra(_,e){var j=Array.isArray(_)?_:void 0;if(!j)if((j=_&&(typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"]))==null)j=void 0;else{var Vt,zt=[],_r=!0,_o=!1;try{for(j=j.call(_);!(_r=(Vt=j.next()).done)&&(zt.push(Vt.value),!e||zt.length!==e);_r=!0);}catch(_a){_o=!0;var ga=_a}finally{try{_r||j.return==null||j.return()}finally{if(_o)throw ga}}j=zt}if(!(_=j||vl(_,e)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return _}function G(_){var e=Array.isArray(_)?Uh(_):void 0;if(e||(e=typeof Symbol<"u"&&_[Symbol.iterator]!=null||_["@@iterator"]!=null?Array.from(_):void 0),!(_=e||vl(_)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return _}function vl(_,e){if(_){if(typeof _=="string")return Uh(_,e);var j=Object.prototype.toString.call(_).slice(8,-1);if(j==="Object"&&_.constructor&&(j=_.constructor.name),j==="Map"||j==="Set")return Array.from(_);if(j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j))return Uh(_,e)}}function Uh(_,e){(e==null||e>_.length)&&(e=_.length);for(var j=0,Vt=Array(e);j<e;j++)Vt[j]=_[j];return Vt}function fa(_,e,j,Vt,zt){var _r={};return Object.keys(Vt).forEach(function(_o){_r[_o]=Vt[_o]}),_r.enumerable=!!_r.enumerable,_r.configurable=!!_r.configurable,("value"in _r||_r.initializer)&&(_r.writable=!0),_r=j.slice().reverse().reduce(function(_o,ga){return ga(_,e,_o)||_o},_r),zt&&_r.initializer!==void 0&&(_r.value=_r.initializer?_r.initializer.call(zt):void 0,_r.initializer=void 0),_r.initializer===void 0&&(Object.defineProperty(_,e,_r),_r=null),_r}function $a(_){var e={exports:{}};return _(e,e.exports),e.exports}function wl(_,e){var j,Vt=3>arguments.length?_:arguments[2];return va(_)===Vt?_[e]:(j=Fb.f(_,e))?Q(j,"value")?j.value:j.get===void 0?void 0:j.get.call(Vt):ha(j=Vb(_))?wl(j,e,Vt):void 0}function rs(_){var e=_.charCodeAt(0)<<24,j=0|ss(~e),Vt=0,zt=0|_.length,_r="";if(5>j&&zt>=j){for(e=e<<j>>>24+j,Vt=1;Vt<j;Vt=Vt+1|0)e=e<<6|63&_.charCodeAt(Vt);65535>=e?_r+=xd(e):1114111>=e?_r+=xd(55296+((e=e-65536|0)>>10)|0,56320+(1023&e)|0):Vt=0}for(;Vt<zt;Vt=Vt+1|0)_r+="";return _r}function xl(){}function ts(_){var e=0|_.charCodeAt(0);if(55296<=e&&56319>=e){var j=0|_.charCodeAt(1);if(!(j==j&&56320<=j&&57343>=j))return xd(239,191,189);if(65535<(e=(e-55296<<10)+j-56320+65536|0))return xd(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|63&e)}return 127>=e?_:2047>=e?xd(192|e>>>6,128|63&e):xd(224|e>>>12,128|e>>>6&63,128|63&e)}function yl(){}function ea(){ea.init.call(this)}function ng(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+X(_))}function zl(_,e,j,Vt){ng(j);var zt=_._events;if(zt===void 0)zt=_._events=Object.create(null),_._eventsCount=0;else{zt.newListener!==void 0&&(_.emit("newListener",e,j.listener?j.listener:j),zt=_._events);var _r=zt[e]}return _r===void 0?(zt[e]=j,++_._eventsCount):(typeof _r=="function"?_r=zt[e]=Vt?[j,_r]:[_r,j]:Vt?_r.unshift(j):_r.push(j),0<(j=_._maxListeners===void 0?ea.defaultMaxListeners:_._maxListeners)&&_r.length>j&&!_r.warned&&(_r.warned=!0,(j=Error("Possible EventEmitter memory leak detected. "+_r.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",j.emitter=_,j.type=e,j.count=_r.length,console&&console.warn&&console.warn(j))),_}function us(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Al(_,e,j){return _={fired:!1,wrapFn:void 0,target:_,type:e,listener:j},(e=us.bind(_)).listener=j,_.wrapFn=e}function Bl(_,e,j){if((_=_._events)===void 0)return[];if((e=_[e])===void 0)return[];if(typeof e=="function")return j?[e.listener||e]:[e];if(j)for(j=Array(e.length),_=0;_<j.length;++_)j[_]=e[_].listener||e[_];else j=Cl(e,e.length);return j}function Dl(_){var e=this._events;if(e!==void 0){if(typeof(_=e[_])=="function")return 1;if(_!==void 0)return _.length}return 0}function Cl(_,e){for(var j=Array(e),Vt=0;Vt<e;++Vt)j[Vt]=_[Vt];return j}function vs(_,e,j){typeof _.on=="function"&&El(_,"error",e,j)}function El(_,e,j,Vt){if(typeof _.on=="function")Vt.once?_.once(e,j):_.on(e,j);else{if(typeof _.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+X(_));_.addEventListener(e,function zt(_r){Vt.once&&_.removeEventListener(e,zt),j(_r)})}}function ws(_){return _?G(_):xs(function(){return[]},function(e,j){return e.push(j),e})}function Fl(_,e){var j,Vt,zt,_r;return w.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:j=Gl(_)([Hl,Hl,function(ga,_a){return _a}])[2],Vt=0;case 2:if(!(Vt<e.length)){_o.next=17;break}if(zt=e[Vt],!((_r=j(Vh,zt))instanceof og)){_o.next=11;break}if((_r=Wh(_r.deref()))===Vh){_o.next=10;break}return _o.next=10,_r;case 10:return _o.abrupt("return");case 11:if(_r===Vh){_o.next=14;break}return _o.next=14,_r;case 14:Vt++,_o.next=2;break;case 17:case"end":return _o.stop()}},ys)}function pg(_,e){return e!=null&&typeof e[Symbol.iterator]=="function"?Fl(pg(_),e):function(j){var Vt=j[2];return zs(j,function(zt,_r){return Vt(zt,_(_r))})}}function Ac(_){return Object.prototype.toString.call(_).slice(8,-1)}function yd(_){return Ac(_)==="Object"&&_.constructor===Object&&Object.getPrototypeOf(_)===Object.prototype}function Il(_){var e;return(e=Ac(_)==="Boolean"||Ac(_)==="Null"||Ac(_)==="Undefined")||(e=Ac(_)==="Number"&&!isNaN(_)),e||Ac(_)==="String"||Ac(_)==="Symbol"}function zd(_){var e=-1,j=_==null?0:_.length;for(this.clear();++e<j;){var Vt=_[e];this.set(Vt[0],Vt[1])}}function ce(_){var e=-1,j=_==null?0:_.length;for(this.clear();++e<j;){var Vt=_[e];this.set(Vt[0],Vt[1])}}function de(_){var e=-1,j=_==null?0:_.length;for(this.clear();++e<j;){var Vt=_[e];this.set(Vt[0],Vt[1])}}function gf(_){var e=-1,j=_==null?0:_.length;for(this.__data__=new qg;++e<j;)this.add(_[e])}function ee(_){this.size=(this.__data__=new rg(_)).size}function fe(_,e,j,Vt,zt,_r){var _o,ga=1&e,_a=2&e,_l=4&e;if(j&&(_o=zt?j(_,Vt,zt,_r):j(_)),_o!==void 0)return _o;if(!lb(_))return _;if(Vt=Va(_)){if(_o=As(_),!ga)return Xh(_,_o)}else{var _d=hf(_),_f=_d=="[object Function]"||_d=="[object GeneratorFunction]";if(jf(_))return Jl(_,ga);if(_d=="[object Object]"||_d=="[object Arguments]"||_f&&!zt){if(_o=_a||_f?{}:Kl(_),!ga)return _a?Bs(_,Cs(_o,_)):Ds(_,Es(_o,_))}else{if(!wa[_d])return zt?_:{};_o=Fs(_,_d,ga)}}if(_r||(_r=new ge),zt=_r.get(_))return zt;_r.set(_,_o),Gs(_)?_.forEach(function(tE){_o.add(fe(tE,e,j,tE,_,_r))}):Hs(_)&&_.forEach(function(tE,rE){_o.set(rE,fe(tE,e,j,rE,_,_r))}),_a=_l?_a?Ll:Yh:_a?kf:Ad;var _m=Vt?void 0:_a(_);return Is(_m||_,function(tE,rE){_m&&(tE=_[rE=tE]),Ml(_o,rE,fe(tE,e,j,rE,_,_r))}),_o}function Zh(_,e){if(typeof _!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var j=function Vt(){var zt=arguments,_r=e?e.apply(this,zt):zt[0],_o=Vt.cache;return _o.has(_r)?_o.get(_r):(zt=_.apply(this,zt),Vt.cache=_o.set(_r,zt)||_o,zt)};return j.cache=new(Zh.Cache||qg),j}function Nl(_){if(typeof _=="string")return _;if(Va(_))return he(_,Nl)+"";if(ie(_))return Ol?Ol.call(_):"";var e=_+"";return e=="0"&&1/_==-Js?"-0":e}function $h(_,e,j,Vt,zt){var _r=-1,_o=_.length;for(j||(j=Ks),zt||(zt=[]);++_r<_o;){var ga=_[_r];j(ga)?ai(zt,ga):zt[zt.length]=ga}return zt}function je(_,e,j,Vt,zt){if(_===e)e=!0;else if(_==null||e==null||!gc(_)&&!gc(e))e=_!=_&&e!=e;else e:{var _r=Va(_),_o=Va(e),ga=_r?"[object Array]":hf(_),_a=_o?"[object Array]":hf(e),_l=(ga=ga=="[object Arguments]"?"[object Object]":ga)=="[object Object]";if(_o=(_a=_a=="[object Arguments]"?"[object Object]":_a)=="[object Object]",(_a=ga==_a)&&jf(_)){if(!jf(e)){e=!1;break e}_r=!0,_l=!1}if(_a&&!_l)zt||(zt=new ge),e=_r||bi(_)?Pl(_,e,j,Vt,je,zt):Ls(_,e,ga,j,Vt,je,zt);else{if(!(1&j)&&(_r=_l&&Ql.call(_,"__wrapped__"),ga=_o&&Ql.call(e,"__wrapped__"),_r||ga)){_=_r?_.value():_,e=ga?e.value():e,zt||(zt=new ge),e=je(_,e,j,Vt,zt);break e}if(_a)t:if(zt||(zt=new ge),_r=1&j,ga=Yh(_),_o=ga.length,_a=Yh(e).length,_o==_a||_r){for(_a=_o;_a--;){var _d=ga[_a];if(!(_r?_d in e:Ms.call(e,_d))){e=!1;break t}}if(_l=zt.get(_),_d=zt.get(e),_l&&_d)e=_l==e&&_d==_;else{_l=!0,zt.set(_,e),zt.set(e,_);for(var _f=_r;++_a<_o;){var _m=_[_d=ga[_a]],tE=e[_d];if(Vt)var rE=_r?Vt(tE,_m,_d,e,_,zt):Vt(_m,tE,_d,_,e,zt);if(rE===void 0?_m!==tE&&!je(_m,tE,j,Vt,zt):!rE){_l=!1;break}_f||(_f=_d=="constructor")}_l&&!_f&&(j=_.constructor)!=(Vt=e.constructor)&&"constructor"in _&&"constructor"in e&&!(typeof j=="function"&&j instanceof j&&typeof Vt=="function"&&Vt instanceof Vt)&&(_l=!1),zt.delete(_),zt.delete(e),e=_l}}else e=!1;else e=!1}}return e}function xa(_,e,j){this.low=0|_,this.high=0|e,this.unsigned=!!j}function mb(_){return(_&&_.__isLong__)===!0}function Bd(_,e){var j;if(e){if((e=0<=(_>>>=0)&&256>_)&&(j=Rl[_]))return j;j=ya(_,0>(0|_)?-1:0,!0),e&&(Rl[_]=j)}else{if((e=-128<=(_|=0)&&128>_)&&(j=Sl[_]))return j;j=ya(_,0>_?-1:0,!1),e&&(Sl[_]=j)}return j}function Gb(_,e){if(isNaN(_))return e?Cd:Hb;if(e){if(0>_)return Cd;if(_>=Tl)return Ul}else{if(_<=-Vl)return nb;if(_+1>=Vl)return Wl}return 0>_?Gb(-_,e).neg():ya(_%ke|0,_/ke|0,e)}function ya(_,e,j){return new xa(_,e,j)}function ci(_,e,j){if(_.length===0)throw Error("empty string");if(_==="NaN"||_==="Infinity"||_==="+Infinity"||_==="-Infinity")return Hb;if(typeof e=="number"?(j=e,e=!1):e=!!e,2>(j=j||10)||36<j)throw RangeError("radix");var Vt;if(0<(Vt=_.indexOf("-")))throw Error("interior hyphen");if(Vt===0)return ci(_.substring(1),e,j).neg();Vt=Gb(sg(j,8));for(var zt=Hb,_r=0;_r<_.length;_r+=8){var _o=Math.min(8,_.length-_r),ga=parseInt(_.substring(_r,_r+_o),j);8>_o?(_o=Gb(sg(j,_o)),zt=zt.mul(_o).add(Gb(ga))):zt=(zt=zt.mul(Vt)).add(Gb(ga))}return zt.unsigned=e,zt}function Wb(_,e){return typeof _=="number"?Gb(_,e):typeof _=="string"?ci(_,e):ya(_.low,_.high,typeof e=="boolean"?e:_.unsigned)}function O(_,e){function j(){this.constructor=_}di(_,e),_.prototype=e===null?Object.create(e):(j.prototype=e.prototype,new j)}function le(_){return typeof _=="function"}function me(_){setTimeout(function(){throw _},0)}function ei(_){return _!==null&&X(_)==="object"}function Xl(_){return _.reduce(function(e,j){return e.concat(j instanceof lf?j.errors:j)},[])}function fi(_){for(;_;){var e=_.destination,j=_.isStopped;if(_.closed||j)return!1;_=e&&e instanceof ia?e:null}return!0}function Yc(_){return _}function gi(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];return Yl(_)}function Yl(_){return _.length===0?Yc:_.length===1?_[0]:function(e){return _.reduce(function(j,Vt){return Vt(j)},e)}}function Zl(_){if(_||(_=Ib.Promise||Promise),!_)throw Error("no Promise impl found");return _}function $l(){return function(_){return _.lift(new Ns(_))}}function mf(_){return _?Os(_):vb}function Os(_){return new Y(function(e){return _.schedule(function(){return e.complete()})})}function Zc(_){return _&&typeof _.schedule=="function"}function hi(_,e){return new Y(function(j){var Vt=new Oa,zt=0;return Vt.add(e.schedule(function(){zt===_.length?j.complete():(j.next(_[zt++]),j.closed||Vt.add(this.schedule()))})),Vt})}function nf(_,e){return e?hi(_,e):new Y(am(_))}function bb(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];return Zc(e=_[_.length-1])?(_.pop(),hi(_,e)):nf(_)}function Z(_,e){return new Y(e?function(j){return e.schedule(Ps,0,{error:_,subscriber:j})}:function(j){return j.error(_)})}function Ps(_){_.subscriber.error(_.error)}function Qs(_,e){return e===void 0&&(e=0),function(j){return j.lift(new Rs(_,e))}}function bm(_){return _ in ii&&(delete ii[_],!0)}function hc(){}function ba(_,e){return function(j){if(typeof _!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return j.lift(new Ss(_,e))}}function cm(_,e,j){if(e){if(!Zc(e))return function(){for(var Vt=[],zt=0;zt<arguments.length;zt++)Vt[zt]=arguments[zt];return cm(_,j).apply(void 0,Vt).pipe(ba(function(_r){return Jb(_r)?e.apply(void 0,_r):e(_r)}))};j=e}return function(){for(var Vt=[],zt=0;zt<arguments.length;zt++)Vt[zt]=arguments[zt];var _r,_o=this,ga={context:_o,subject:_r,callbackFunc:_,scheduler:j};return new Y(function(_a){if(j)return j.schedule(Ts,0,{args:Vt,subscriber:_a,params:ga});if(!_r){_r=new of;try{_.apply(_o,Vt.concat([function(){for(var _l=[],_d=0;_d<arguments.length;_d++)_l[_d]=arguments[_d];_r.next(1>=_l.length?_l[0]:_l),_r.complete()}]))}catch(_l){fi(_r)?_r.error(_l):console.warn(_l)}}return _r.subscribe(_a)})}}function Ts(_){var e=this,j=_.args,Vt=_.subscriber,zt=_.params;_=zt.callbackFunc;var _r=zt.context,_o=zt.scheduler,ga=zt.subject;if(!ga){ga=zt.subject=new of,zt=function(){for(var _a=[],_l=0;_l<arguments.length;_l++)_a[_l]=arguments[_l];e.add(_o.schedule(Us,0,{value:1>=_a.length?_a[0]:_a,subject:ga}))};try{_.apply(_r,j.concat([zt]))}catch(_a){ga.error(_a)}}this.add(ga.subscribe(Vt))}function Us(_){var e=_.subject;e.next(_.value),e.complete()}function dm(_,e,j){if(e){if(!Zc(e))return function(){for(var Vt=[],zt=0;zt<arguments.length;zt++)Vt[zt]=arguments[zt];return dm(_,j).apply(void 0,Vt).pipe(ba(function(_r){return Jb(_r)?e.apply(void 0,_r):e(_r)}))};j=e}return function(){for(var Vt=[],zt=0;zt<arguments.length;zt++)Vt[zt]=arguments[zt];var _r={subject:void 0,args:Vt,callbackFunc:_,scheduler:j,context:this};return new Y(function(_o){var ga=_r.context,_a=_r.subject;if(j)return j.schedule(Vs,0,{params:_r,subscriber:_o,context:ga});if(!_a){_a=_r.subject=new of;try{_.apply(ga,Vt.concat([function(){for(var _l=[],_d=0;_d<arguments.length;_d++)_l[_d]=arguments[_d];(_d=_l.shift())?_a.error(_d):(_a.next(1>=_l.length?_l[0]:_l),_a.complete())}]))}catch(_l){fi(_a)?_a.error(_l):console.warn(_l)}}return _a.subscribe(_o)})}}function Vs(_){var e=this,j=_.params,Vt=_.subscriber;_=_.context;var zt=j.callbackFunc,_r=j.args,_o=j.scheduler,ga=j.subject;if(!ga){ga=j.subject=new of,j=function(){for(var _a=[],_l=0;_l<arguments.length;_l++)_a[_l]=arguments[_l];(_l=_a.shift())?e.add(_o.schedule(em,0,{err:_l,subject:ga})):e.add(_o.schedule(Ws,0,{value:1>=_a.length?_a[0]:_a,subject:ga}))};try{zt.apply(_,_r.concat([j]))}catch(_a){this.add(_o.schedule(em,0,{err:_a,subject:ga}))}}this.add(ga.subscribe(Vt))}function Ws(_){var e=_.subject;e.next(_.value),e.complete()}function em(_){_.subject.error(_.err)}function fm(_){return!!_&&typeof _.subscribe!="function"&&typeof _.then=="function"}function ji(_,e,j,Vt,zt){if(zt===void 0&&(zt=new Xs(_,j,Vt)),!zt.closed)return e instanceof Y?e.subscribe(zt):pf(e)(zt)}function Ys(_,e){return new Y(function(j){var Vt=new Oa;return Vt.add(e.schedule(function(){var zt=_[ne]();Vt.add(zt.subscribe({next:function(_r){Vt.add(e.schedule(function(){return j.next(_r)}))},error:function(_r){Vt.add(e.schedule(function(){return j.error(_r)}))},complete:function(){Vt.add(e.schedule(function(){return j.complete()}))}}))})),Vt})}function Zs(_,e){return new Y(function(j){var Vt=new Oa;return Vt.add(e.schedule(function(){return _.then(function(zt){Vt.add(e.schedule(function(){j.next(zt),Vt.add(e.schedule(function(){return j.complete()}))}))},function(zt){Vt.add(e.schedule(function(){return j.error(zt)}))})})),Vt})}function $s(_,e){if(!_)throw Error("Iterable cannot be null");return new Y(function(j){var Vt,zt=new Oa;return zt.add(function(){Vt&&typeof Vt.return=="function"&&Vt.return()}),zt.add(e.schedule(function(){Vt=_[$c](),zt.add(e.schedule(function(){if(!j.closed){try{var _r=Vt.next(),_o=_r.value,ga=_r.done}catch(_a){return void j.error(_a)}ga?j.complete():(j.next(_o),this.schedule())}}))})),zt})}function gm(_,e){if(_!=null){if(_&&typeof _[ne]=="function")return Ys(_,e);if(fm(_))return Zs(_,e);if(hm(_))return hi(_,e);if(_&&typeof _[$c]=="function"||typeof _=="string")return $s(_,e)}throw new TypeError((_!==null&&X(_)||_)+" is not observable")}function Kb(_,e){return e?gm(_,e):_ instanceof Y?_:new Y(pf(_))}function ic(_,e){if(!e.closed){if(_ instanceof Y)return _.subscribe(e);try{var j=pf(_)(e)}catch(Vt){e.error(Vt)}return j}}function cb(_,e,j){return j===void 0&&(j=Number.POSITIVE_INFINITY),typeof e=="function"?function(Vt){return Vt.pipe(cb(function(zt,_r){return Kb(_(zt,_r)).pipe(ba(function(_o,ga){return e(zt,_o,_r,ga)}))},j))}:(typeof e=="number"&&(j=e),function(Vt){return Vt.lift(new at(_,j))})}function tg(_){return _===void 0&&(_=Number.POSITIVE_INFINITY),cb(Yc,_)}function im(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];return tg(1)(bb.apply(void 0,_))}function ad(_){return new Y(function(e){try{var j=_()}catch(Vt){return void e.error(Vt)}return(j?Kb(j):mf()).subscribe(e)})}function jm(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];if(_.length===1){var j=_[0];if(Jb(j))return ug(j,null);if(ei(j)&&Object.getPrototypeOf(j)===Object.prototype)return ug((_=Object.keys(j)).map(function(zt){return j[zt]}),_)}if(typeof _[_.length-1]=="function"){var Vt=_.pop();return ug(_=_.length===1&&Jb(_[0])?_[0]:_,null).pipe(ba(function(zt){return Vt.apply(void 0,zt)}))}return ug(_,null)}function ug(_,e){return new Y(function(j){var Vt=_.length;if(Vt===0)j.complete();else for(var zt=Array(Vt),_r=0,_o=0,ga=function(_l){var _d=Kb(_[_l]),_f=!1;j.add(_d.subscribe({next:function(_m){_f||(_f=!0,_o++),zt[_l]=_m},error:function(_m){return j.error(_m)},complete:function(){++_r!==Vt&&_f||(_o===Vt&&j.next(e?e.reduce(function(_m,tE,rE){return _m[tE]=zt[rE],_m},{}):zt),j.complete())}}))},_a=0;_a<Vt;_a++)ga(_a)})}function gb(_,e,j,Vt){return le(j)&&(Vt=j,j=void 0),Vt?gb(_,e,j).pipe(ba(function(zt){return Jb(zt)?Vt.apply(void 0,zt):Vt(zt)})):new Y(function(zt){km(_,e,function(_r){1<arguments.length?zt.next(Array.prototype.slice.call(arguments)):zt.next(_r)},zt,j)})}function km(_,e,j,Vt,zt){if(_&&typeof _.addEventListener=="function"&&typeof _.removeEventListener=="function"){_.addEventListener(e,j,zt);var _r=function(){return _.removeEventListener(e,j,zt)}}else if(_&&typeof _.on=="function"&&typeof _.off=="function")_.on(e,j),_r=function(){return _.off(e,j)};else if(_&&typeof _.addListener=="function"&&typeof _.removeListener=="function")_.addListener(e,j),_r=function(){return _.removeListener(e,j)};else{if(!_||!_.length)throw new TypeError("Invalid event target");for(var _o=0,ga=_.length;_o<ga;_o++)km(_[_o],e,j,Vt,zt)}Vt.add(_r)}function lm(_,e,j){return j?lm(_,e).pipe(ba(function(Vt){return Jb(Vt)?j.apply(void 0,Vt):j(Vt)})):new Y(function(Vt){var zt=function(){for(var _o=[],ga=0;ga<arguments.length;ga++)_o[ga]=arguments[ga];return Vt.next(_o.length===1?_o[0]:_o)};try{var _r=_(zt)}catch(_o){return void Vt.error(_o)}if(le(e))return function(){return e(zt,_r)}})}function bt(_){var e=_.subscriber,j=_.condition;if(!e.closed){if(_.needIterate)try{_.state=_.iterate(_.state)}catch(_r){return void e.error(_r)}else _.needIterate=!0;if(j){var Vt=void 0;try{Vt=j(_.state)}catch(_r){return void e.error(_r)}if(!Vt)return void e.complete();if(e.closed)return}try{var zt=_.resultSelector(_.state)}catch(_r){return void e.error(_r)}if(!e.closed&&(e.next(zt),!e.closed))return this.schedule(_)}}function ki(_){return!Jb(_)&&0<=_-parseFloat(_)+1}function mm(_,e){return _===void 0&&(_=0),e===void 0&&(e=bd),(!ki(_)||0>_)&&(_=0),e&&typeof e.schedule=="function"||(e=bd),new Y(function(j){return j.add(e.schedule(ct,_,{subscriber:j,counter:0,period:_})),j})}function ct(_){var e=_.subscriber,j=_.counter;_=_.period,e.next(j),this.schedule({subscriber:e,counter:j+1,period:_},_)}function Xb(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];e=Number.POSITIVE_INFINITY;var j=null,Vt=_[_.length-1];return Zc(Vt)?(j=_.pop(),1<_.length&&typeof _[_.length-1]=="number"&&(e=_.pop())):typeof Vt=="number"&&(e=_.pop()),j===null&&_.length===1&&_[0]instanceof Y?_[0]:tg(e)(nf(_,j))}function li(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];if(_.length===0)return vb;var j=_[0],Vt=_.slice(1);return _.length===1&&Jb(j)?li.apply(void 0,j):new Y(function(zt){var _r=function(){return zt.add(li.apply(void 0,Vt).subscribe(zt))};return Kb(j).subscribe({next:function(_o){zt.next(_o)},error:_r,complete:_r})})}function dt(_){var e=_.keys,j=_.index,Vt=_.subscriber,zt=_.subscription;if(_=_.obj,!Vt.closed)if(j<e.length){var _r=e[j];Vt.next([_r,_[_r]]),zt.add(this.schedule({keys:e,index:j+1,subscriber:Vt,subscription:zt,obj:_}))}else Vt.complete()}function et(_,e){function j(){return!j.pred.apply(j.thisArg,arguments)}return j.pred=_,j.thisArg=e,j}function wb(_,e){return function(j){return j.lift(new ft(_,e))}}function Ca(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];if(_.length===1){if(!Jb(_[0]))return _[0];_=_[0]}return nf(_,void 0).lift(new gt)}function ht(_){var e=_.start,j=_.index,Vt=_.subscriber;j>=_.count?Vt.complete():(Vt.next(e),Vt.closed||(_.index=j+1,_.start=e+1,this.schedule(_)))}function Bc(_,e,j){_===void 0&&(_=0);var Vt=-1;return ki(e)?Vt=1>Number(e)?1:Number(e):Zc(e)&&(j=e),Zc(j)||(j=bd),new Y(function(zt){var _r=ki(_)?_:+_-j.now();return j.schedule(it,_r,{index:0,period:Vt,subscriber:zt})})}function it(_){var e=_.index,j=_.period,Vt=_.subscriber;if(Vt.next(e),!Vt.closed){if(j===-1)return Vt.complete();_.index=e+1,this.schedule(_,j)}}function mi(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];return typeof(e=_[_.length-1])=="function"&&_.pop(),nf(_,void 0).lift(new jt(e))}function Ga(_){return function(e){var j=new kt(_);return e=e.lift(j),j.caught=e}}function ni(_,e){return cb(_,e,1)}function nm(_){return _===void 0&&(_=null),function(e){return e.lift(new lt(_))}}function cd(_,e){e===void 0&&(e=bd);var j=_ instanceof Date&&!isNaN(+_)?+_-e.now():Math.abs(_);return function(Vt){return Vt.lift(new mt(j,e))}}function om(_,e){return function(j){return j.lift(new nt(_,e))}}function Dd(_){return _===void 0&&(_=ot),function(e){return e.lift(new pt(_))}}function ot(){return new vg}function Ka(_){return function(e){return _===0?mf():e.lift(new qt(_))}}function pm(_,e){return e?function(j){return j.pipe(pm(function(Vt,zt){return Kb(_(Vt,zt)).pipe(ba(function(_r,_o){return e(Vt,_r,zt,_o)}))}))}:function(j){return j.lift(new rt(_))}}function wg(_){return function(e){return e.lift(new st(_))}}function aa(_,e){var j=2<=arguments.length;return function(Vt){return Vt.pipe(_?wb(function(zt,_r){return _(zt,_r,Vt)}):Yc,Ka(1),j?nm(e):Dd(function(){return new vg}))}}function tt(){return function(_){return _.lift(new ut)}}function qm(_){return function(e){return _===0?mf():e.lift(new vt(_))}}function qf(_){return function(e){return e.lift(new wt(_))}}function xg(_,e){var j=!1;return 2<=arguments.length&&(j=!0),function(Vt){return Vt.lift(new xt(_,e,j))}}function rm(_,e){return 2<=arguments.length?function(j){return gi(xg(_,e),qm(1),nm(e))(j)}:function(j){return gi(xg(function(Vt,zt,_r){return _(Vt,zt,_r+1)}),qm(1))(j)}}function yt(_,e){return function(j){var Vt=typeof _=="function"?_:function(){return _},zt=Object.create(j,At);return zt.source=j,zt.subjectFactory=Vt,zt}}function oe(_){return function(e){return e.lift(new Bt(_,e))}}function Ct(){return new Pa}function pe(){return function(_){return $l()(yt(Ct)(_))}}function sm(_,e,j){var Vt=_&&X(_)==="object"?_:{bufferSize:_,windowTime:e,refCount:!1,scheduler:j};return function(zt){return zt.lift(Dt(Vt))}}function Dt(_){var e,j,Vt=_.bufferSize,zt=Vt===void 0?Number.POSITIVE_INFINITY:Vt,_r=(Vt=_.windowTime)===void 0?Number.POSITIVE_INFINITY:Vt,_o=_.refCount,ga=_.scheduler,_a=0,_l=!1,_d=!1;return function(_f){if(_a++,!e||_l){_l=!1;var _m=(e=new qe(zt,_r,ga)).subscribe(this);j=_f.subscribe({next:function(tE){e.next(tE)},error:function(tE){_l=!0,e.error(tE)},complete:function(){_d=!0,j=void 0,e.complete()}}),_d&&(j=void 0)}else _m=e.subscribe(this);this.add(function(){_a--,_m.unsubscribe(),_m=void 0,j&&!_d&&_o&&_a===0&&(j.unsubscribe(),e=j=void 0)})}}function Cc(_,e){return typeof e=="function"?function(j){return j.pipe(Cc(function(Vt,zt){return Kb(_(Vt,zt)).pipe(ba(function(_r,_o){return e(Vt,_r,zt,_o)}))}))}:function(j){return j.lift(new Et(_))}}function ob(_){return function(e){return e.lift(new Ft(_))}}function Gt(_,e){return e===void 0&&(e=!1),function(j){return j.lift(new Ht(_,e))}}function ca(_,e,j){return function(Vt){return Vt.lift(new It(_,e,j))}}function Jt(_,e,j){return e===void 0&&(e=bd),j===void 0&&(j=Kt),function(Vt){return Vt.lift(new Lt(_,e,j.leading,j.trailing))}}function Mt(_){_.subscriber.clearThrottle()}function Nt(_,e,j){return j===void 0&&(j=bd),function(Vt){var zt=_ instanceof Date&&!isNaN(+_),_r=zt?+_-j.now():Math.abs(_);return Vt.lift(new Ot(_r,zt,e,j))}}function hb(_,e){return e===void 0&&(e=bd),Nt(_,Z(new pb),e)}function Pt(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];return function(j){var Vt;return typeof _[_.length-1]=="function"&&(Vt=_.pop()),j.lift(new Qt(_,Vt))}}function tm(_,e,j,Vt,zt){_!==e&&um(e,function(_r,_o){if(zt||(zt=new ge),lb(_r)){_r=zt;var ga=oi(_,_o),_a=oi(e,_o),_l=_r.get(_a);if(_l)pi(_,_o,_l);else{var _d=(_l=Vt?Vt(ga,_a,_o+"",_,e,_r):void 0)===void 0;if(_d){var _f=Va(_a),_m=!_f&&jf(_a),tE=!_f&&!_m&&bi(_a);_l=_a,_f||_m||tE?Va(ga)?_l=ga:gc(ga)&&Ed(ga)?_l=Xh(ga):_m?(_d=!1,_l=Jl(_a,!0)):tE?(_d=!1,_l=vm(_a,!0)):_l=[]:wm(_a)||rf(_a)?(_l=ga,rf(ga)?_l=re(ga,kf(ga)):lb(ga)&&!qi(ga)||(_l=Kl(_a))):_d=!1}_d&&(_r.set(_a,_l),tm(_l,_a,j,Vt,_r),_r.delete(_a)),pi(_,_o,_l)}}else(ga=Vt?Vt(oi(_,_o),_r,_o+"",_,e,zt):void 0)===void 0&&(ga=_r),pi(_,_o,ga)},kf)}function Rt(_){var e=1,j=ri;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?e=1>=arguments.length?void 0:arguments[1]:j=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(e=1>=arguments.length?void 0:arguments[1],j=2>=arguments.length?void 0:arguments[2]);var Vt=e||1;return function(zt){return zt.pipe(xg(function(_r,_o){var ga=j.now(),_a=ga-_;if((_r=_r.filter(function(_f){return _f.until>_a})).length>=Vt){var _l=_r[_r.length-1],_d=_r[0].until+_*Math.floor(_r.length/Vt);_r.push({delay:_l.until<ga?_d-ga:_d-_l.until,until:_d,value:_o})}else _r.push({delay:0,until:ga,value:_o});return _r},[]),ba(function(_r){return _r[_r.length-1]}),ni(function(_r){var _o=bb(_r.value);return _r.delay?_o.pipe(cd(_r.delay,j)):_o}))}}function St(_,e){var j=(e=e===void 0?{protocols:xm,makeWebSocket:ym}:e).protocols,Vt=j===void 0?xm:j,zt=(e=e.makeWebSocket)===void 0?ym:e;return new Y(function(_r){var _o,ga=new Pa,_a=zt(_,Vt),_l=!1,_d=!1,_f=function(_m){if(_o)throw _l=!0,_m=Error("Web socket message factory function called more than once"),_r.error(_m),_m;return _o=_m.subscribe(function(tE){_a.send(tE)}),ga};return _a.onopen=function(){_d?(_l=!0,_a.close()):_r.next(_f)},_a.onmessage=function(_m){ga.next(_m.data)},_a.onerror=function(_m){_l=!0,_r.error(Error(_m.message))},_a.onclose=function(_m){_l||(_l=!0,_d?(_r.complete(),ga.complete()):_r.error(Error(_m.code===1e3?"Normal closure":_m.reason)))},function(){_d=!0,_o&&_o.unsubscribe(),_l||(_l=!0,_a.close())}})}function yg(){this._listeners={}}function zm(_){return typeof Float32Array<"u"?function(){function e(_a,_l,_d){_r[0]=_a,_l[_d]=_o[0],_l[_d+1]=_o[1],_l[_d+2]=_o[2],_l[_d+3]=_o[3]}function j(_a,_l,_d){_r[0]=_a,_l[_d]=_o[3],_l[_d+1]=_o[2],_l[_d+2]=_o[1],_l[_d+3]=_o[0]}function Vt(_a,_l){return _o[0]=_a[_l],_o[1]=_a[_l+1],_o[2]=_a[_l+2],_o[3]=_a[_l+3],_r[0]}function zt(_a,_l){return _o[3]=_a[_l],_o[2]=_a[_l+1],_o[1]=_a[_l+2],_o[0]=_a[_l+3],_r[0]}var _r=new Float32Array([-0]),_o=new Uint8Array(_r.buffer),ga=_o[3]===128;_.writeFloatLE=ga?e:j,_.writeFloatBE=ga?j:e,_.readFloatLE=ga?Vt:zt,_.readFloatBE=ga?zt:Vt}():function(){function e(Vt,zt,_r,_o){var ga=0>zt?1:0;if(ga&&(zt=-zt),zt===0)Vt(0<1/zt?0:2147483648,_r,_o);else if(isNaN(zt))Vt(2143289344,_r,_o);else if(34028234663852886e22<zt)Vt((ga<<31|2139095040)>>>0,_r,_o);else if(11754943508222875e-54>zt)Vt((ga<<31|Math.round(zt/1401298464324817e-60))>>>0,_r,_o);else{var _a=Math.floor(Math.log(zt)/Math.LN2);Vt((ga<<31|_a+127<<23|8388607&Math.round(zt*Math.pow(2,-_a)*8388608))>>>0,_r,_o)}}function j(Vt,zt,_r){return _r=Vt(zt,_r),Vt=2*(_r>>31)+1,zt=_r>>>23&255,_r&=8388607,zt===255?_r?NaN:1/0*Vt:zt===0?1401298464324817e-60*Vt*_r:Vt*Math.pow(2,zt-150)*(_r+8388608)}_.writeFloatLE=e.bind(null,Am),_.writeFloatBE=e.bind(null,Bm),_.readFloatLE=j.bind(null,Cm),_.readFloatBE=j.bind(null,Dm)}(),typeof Float64Array<"u"?function(){function e(_a,_l,_d){_r[0]=_a,_l[_d]=_o[0],_l[_d+1]=_o[1],_l[_d+2]=_o[2],_l[_d+3]=_o[3],_l[_d+4]=_o[4],_l[_d+5]=_o[5],_l[_d+6]=_o[6],_l[_d+7]=_o[7]}function j(_a,_l,_d){_r[0]=_a,_l[_d]=_o[7],_l[_d+1]=_o[6],_l[_d+2]=_o[5],_l[_d+3]=_o[4],_l[_d+4]=_o[3],_l[_d+5]=_o[2],_l[_d+6]=_o[1],_l[_d+7]=_o[0]}function Vt(_a,_l){return _o[0]=_a[_l],_o[1]=_a[_l+1],_o[2]=_a[_l+2],_o[3]=_a[_l+3],_o[4]=_a[_l+4],_o[5]=_a[_l+5],_o[6]=_a[_l+6],_o[7]=_a[_l+7],_r[0]}function zt(_a,_l){return _o[7]=_a[_l],_o[6]=_a[_l+1],_o[5]=_a[_l+2],_o[4]=_a[_l+3],_o[3]=_a[_l+4],_o[2]=_a[_l+5],_o[1]=_a[_l+6],_o[0]=_a[_l+7],_r[0]}var _r=new Float64Array([-0]),_o=new Uint8Array(_r.buffer),ga=_o[7]===128;_.writeDoubleLE=ga?e:j,_.writeDoubleBE=ga?j:e,_.readDoubleLE=ga?Vt:zt,_.readDoubleBE=ga?zt:Vt}():function(){function e(Vt,zt,_r,_o,ga,_a){var _l=0>_o?1:0;if(_l&&(_o=-_o),_o===0)Vt(0,ga,_a+zt),Vt(0<1/_o?0:2147483648,ga,_a+_r);else if(isNaN(_o))Vt(0,ga,_a+zt),Vt(2146959360,ga,_a+_r);else if(17976931348623157e292<_o)Vt(0,ga,_a+zt),Vt((_l<<31|2146435072)>>>0,ga,_a+_r);else if(22250738585072014e-324>_o)Vt((_o/=5e-324)>>>0,ga,_a+zt),Vt((_l<<31|_o/4294967296)>>>0,ga,_a+_r);else{var _d=Math.floor(Math.log(_o)/Math.LN2);_d===1024&&(_d=1023),Vt(4503599627370496*(_o*=Math.pow(2,-_d))>>>0,ga,_a+zt),Vt((_l<<31|_d+1023<<20|1048576*_o&1048575)>>>0,ga,_a+_r)}}function j(Vt,zt,_r,_o,ga){return zt=Vt(_o,ga+zt),_o=Vt(_o,ga+_r),Vt=2*(_o>>31)+1,zt=4294967296*(1048575&_o)+zt,(_r=_o>>>20&2047)===2047?zt?NaN:1/0*Vt:_r===0?5e-324*Vt*zt:Vt*Math.pow(2,_r-1075)*(zt+4503599627370496)}_.writeDoubleLE=e.bind(null,Am,0,4),_.writeDoubleBE=e.bind(null,Bm,4,0),_.readDoubleLE=j.bind(null,Cm,0,4),_.readDoubleBE=j.bind(null,Dm,4,0)}(),_}function Am(_,e,j){e[j]=255&_,e[j+1]=_>>>8&255,e[j+2]=_>>>16&255,e[j+3]=_>>>24}function Bm(_,e,j){e[j]=_>>>24,e[j+1]=_>>>16&255,e[j+2]=_>>>8&255,e[j+3]=255&_}function Cm(_,e){return(_[e]|_[e+1]<<8|_[e+2]<<16|_[e+3]<<24)>>>0}function Dm(_,e){return(_[e]<<24|_[e+1]<<16|_[e+2]<<8|_[e+3])>>>0}function Wa(_,e){this.lo=_>>>0,this.hi=e>>>0}function sf(_,e,j){this.fn=_,this.len=e,this.next=void 0,this.val=j}function si(){}function Tt(_){this.head=_.head,this.tail=_.tail,this.len=_.len,this.next=_.states}function ja(){this.len=0,this.tail=this.head=new sf(si,0,0),this.states=null}function ti(_,e,j){e[j]=255&_}function ui(_,e){this.len=_,this.next=void 0,this.val=e}function vi(_,e,j){for(;_.hi;)e[j++]=127&_.lo|128,_.lo=(_.lo>>>7|_.hi<<25)>>>0,_.hi>>>=7;for(;127<_.lo;)e[j++]=127&_.lo|128,_.lo>>>=7;e[j++]=_.lo}function wi(_,e,j){e[j]=255&_,e[j+1]=_>>>8&255,e[j+2]=_>>>16&255,e[j+3]=_>>>24}function jc(){xi.call(this)}function Ut(_,e,j){40>_.length?V.utf8.write(_,e,j):e.utf8Write?e.utf8Write(_,j):e.write(_,j)}function Yb(_,e){return RangeError("index out of range: "+_.pos+" + "+(e||1)+" > "+_.len)}function La(_){this.buf=_,this.pos=0,this.len=_.length}function yi(){var _=new Em(0,0),e=0;if(!(4<this.len-this.pos)){for(;3>e;++e){if(this.pos>=this.len)throw Yb(this);if(_.lo=(_.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return _}return _.lo=(_.lo|(127&this.buf[this.pos++])<<7*e)>>>0,_}for(;4>e;++e)if(_.lo=(_.lo|(127&this.buf[this.pos])<<7*e)>>>0,128>this.buf[this.pos++])return _;if(_.lo=(_.lo|(127&this.buf[this.pos])<<28)>>>0,_.hi=(_.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return _;if(e=0,4<this.len-this.pos){for(;5>e;++e)if(_.hi=(_.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return _}else for(;5>e;++e){if(this.pos>=this.len)throw Yb(this);if(_.hi=(_.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,128>this.buf[this.pos++])return _}throw Error("invalid varint encoding")}function zg(_,e){return(_[e-4]|_[e-3]<<8|_[e-2]<<16|_[e-1]<<24)>>>0}function Fm(){if(this.pos+8>this.len)throw Yb(this,8);return new Em(zg(this.buf,this.pos+=4),zg(this.buf,this.pos+=4))}function Fd(_){zi.call(this,_)}function tf(_,e,j){if(typeof _!="function")throw TypeError("rpcImpl must be a function");V.EventEmitter.call(this),this.rpcImpl=_,this.requestDelimited=!!e,this.responseDelimited=!!j}function za(_){return typeof _=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(_)&&_!=="null"}function Gm(_){try{var e=_.split(".").map(function(Vt){return Number(Vt)})}catch{return!1}if(e.length!==4||e[0]===0)return!1;for(_=0;_<e.length;_++){var j=e[_];if(!Number.isInteger(j)||0>j||255<j)return!1}return!0}function Hm(_,e){if(!Array.isArray(e)||e.length===0||32<e.length||e.some(function(j){return j.length===0||32<j.length}))throw new I("arguments is not valid",Ja);if(!za(_))throw new I("ID is invalid",Ja)}function uf(_){var e=_.attributes,j=_.attrSizeMap,Vt=_.maxAttrsCount,zt=_.maxAttrValueSize;if(_=_.maxTotalSize,!yd(e))throw new I("attributes must be an object",Ja);if(Object.keys(e).length>Vt)throw new ib("Exceed the limit of ".concat(Vt," attributes"),se);if(Object.keys(e).length===0)throw new I("The attributes is an empty object",Ja);var _r=0,_o=0;for(e=Object.entries(e);_o<e.length;_o++){var ga=ra(e[_o],2),_a=ga[1];ga=new Blob([ga[0]]).size;var _l=new Blob([_a]).size;if(ga===0||32<ga)throw new I("Invalid attribute key",Ja);if(_l>zt)throw new ib("Invalid attribute value, over the limit of ".concat(zt," bytes"),se);if(typeof _a!="string"||_a.length===0)throw new I("Invalid attribute value",Ja);_r+=ga,_r+=_l}if(_r>_)throw new ib("The attributes size overflow",se);if(j!==void 0){if(Object.keys(j).length>Vt)throw new ib("Exceed the limit of ".concat(Vt," attributes"),se);for(_r=Vt=0,j=Object.entries(j);_r<j.length;_r++){if(_o=(e=ra(j[_r],2))[1],(e=new Blob([e[0]]).size)===0)throw new I("Invalid attribute key",Ja);if(_o>zt)throw new ib("Invalid attribute value, over the limit of ".concat(zt," bytes"),se);Vt+=e,Vt+=_o}if(Vt>_)throw new ib("The attributes size overflow",se)}}function Ag(_,e){return Math.floor(Math.random()*(Math.floor(e)-Math.ceil(_)+1))+_}function Bg(){var _=Ag(0,4294967295),e=Ag(1,4294967295);return new U(_,e,!0)}function Xa(_){return _.toString().padEnd(32,"0")}function Im(_,e){return new TypeError("Unexpected ".concat(_,": ").concat(e))}function Jm(_,e){return _=_.split(".").map(function(j){return Number(j)}),e=e.split(".").map(function(j){return Number(j)}),Math.sqrt(1e3*Math.pow(_[0]-e[0],2)+100*Math.pow(_[1]-e[1],2)+10*Math.pow(_[2]-e[2],2)+1*Math.pow(_[3]-e[3],2))}function Km(_){return _.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?_.toNumber():_.toString()}function Ai(_,e){e="".concat(_).concat(e||"");var j=Lm.get(e)||1;return Lm.set(e,j+1),"".concat(_).concat(j)}function Mm(_,e){var j=typeof e=="number"?e:e!==void 0&&typeof e!="string"?e.code:void 0;return e=typeof e!="number"&&typeof e!="string"&&e!==void 0&&e.serverCode!==void 0?e.serverCode:void 0,j="".concat(j!==void 0?" Error Code ".concat(j):"").concat(e!==void 0?", server Code ".concat(e):""),_=typeof _=="string"&&_?Cg(_):Array.isArray(_)&&typeof _[0]=="string"&&_[0]?Cg(Nm.apply(void 0,[_[0]].concat(G(_.slice(1))))):"","".concat(j===""?"":"".concat(j," - ")).concat(_)}function Om(_){return Bi.apply(this,arguments)}function Bi(){return(Bi=J(w.mark(function _(e){return w.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",new Promise(function(Vt){setTimeout(function(){Vt()},e)}));case 1:case"end":return j.stop()}},_)}))).apply(this,arguments)}function Pm(_){return _ instanceof Blob||Object.prototype.toString.call(_)==="[object Blob]"}function Dg(_){var e=255&_,j=_>>8&255,Vt=_>>16&255;return"".concat(_>>24&255,".").concat(Vt,".").concat(j,".").concat(e)}function te(_,e,j){return Ci.apply(this,arguments)}function Ci(){return(Ci=J(w.mark(function _(e,j,Vt){var zt,_r,_o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE,IE,_E,kE,ME,bE,LE,TE,OE;return w.wrap(function(vE){for(;;)switch(vE.prev=vE.next){case 0:if(zt=j.body,_r=j.headers,_o=_r===void 0?{}:_r,ga=j.timeout,_a=ga===void 0?1e4:ga,_l=j.signal,_d=j.withCredentials,_f=_d!==void 0&&_d,_m=(Vt||{}).useBinaryResponse,tE=_m!==void 0&&_m,(rE=new XMLHttpRequest).open("POST",e,!0),rE.responseType=tE?"arraybuffer":"text",rE.withCredentials=_f,rE.timeout=_a,oE=zt instanceof FormData,dE=zt instanceof Uint8Array,!(1<(nE=Object.keys(_o).filter(function(NE){return NE.toLowerCase()==="content-type"})).length)){vE.next=14;break}throw new RangeError("multiple content-type");case 14:nE.length===0&&(dE?_o["Content-Type"]="application/octet-stream":oE||(_o["Content-Type"]="application/json"));case 15:if("setRequestHeader"in rE){vE.next=46;break}return rE.abort(),vE.next=19,fetch(e,{body:oE||dE?zt:JSON.stringify(zt),cache:"no-cache",credentials:_f?"include":"same-origin",headers:_o,method:"POST",mode:"cors",referrer:"no-referrer",signal:_l});case 19:if(sE=vE.sent,!(200<=(lE=sE.status)&&300>lE||lE===304)){vE.next=31;break}if(!tE){vE.next=27;break}return vE.next=25,sE.arrayBuffer();case 25:return EE=vE.sent,vE.abrupt("return",{status:lE,responseData:EE});case 27:return vE.next=29,sE.text();case 29:return wE=vE.sent,vE.abrupt("return",{status:lE,responseText:wE});case 31:return IE=new da(["Post XHR failure, status %d",lE]),vE.prev=32,vE.next=35,sE.text();case 35:throw _E=vE.sent,IE.statusCode=lE,IE.message=_E||"Request failed, status ".concat(lE),IE;case 41:throw vE.prev=41,vE.t0=vE.catch(32),IE.statusCode=lE,IE.message="Request failed, status ".concat(lE),IE;case 46:if(Object.keys(_o).length!==0)for(kE=0,ME=Object.entries(_o);kE<ME.length;kE++)bE=ra(ME[kE],2),LE=bE[0],TE=bE[1],rE.setRequestHeader(LE,TE);return _l!==void 0&&(OE=function NE(){rE.abort(),_l.removeEventListener("abort",NE)},_l.addEventListener("abort",OE)),oE||dE?rE.send(zt):rE.send(JSON.stringify(zt)),vE.abrupt("return",new Promise(function(NE,jE){rE.onload=function(){var UE=rE.status;if(200<=UE&&300>UE||UE===304)NE(tE?{status:UE,responseData:rE.response}:{status:UE,responseText:rE.responseText});else{var RE=new da(["Post XHR failure, status %d",UE]);RE.statusCode=UE,RE.message=rE.response||"Request failed, status ".concat(rE.status),jE(RE)}},rE.ontimeout=function(UE){jE(new db(["XHR request timed out after %d ms",_a],{originalError:UE}))},rE.onerror=function(){var UE=new da(["Post XHR failure, status %d",rE.status]);UE.statusCode=rE.status,UE.message=rE.response||"Request failed, status ".concat(rE.status),jE(UE)},rE.onabort=function(){try{jE(new DOMException("The request aborted.","AbortError"))}catch{var UE=Error("The request aborted.");UE.name="AbortError",jE(UE)}}}));case 50:case"end":return vE.stop()}},_,null,[[32,41]])}))).apply(this,arguments)}function Rm(_){return Hi.apply(this,arguments)}function Hi(){return(Hi=J(w.mark(function _(e){var j;return w.wrap(function(Vt){for(;;)switch(Vt.prev=Vt.next){case 0:return(j=new Image).src=e,Vt.abrupt("return",new Promise(function(zt,_r){j.onload=function(){zt({width:j.width,height:j.height})},j.onerror=_r}));case 3:case"end":return Vt.stop()}},_)}))).apply(this,arguments)}function Xt(_,e){return Ii.apply(this,arguments)}function Ii(){return(Ii=J(w.mark(function _(e,j){var Vt,zt,_r,_o,ga,_a,_l,_d,_f,_m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:if(Vt=e.thumbnailHeight,zt=Vt===void 0?0:Vt,_r=e.thumbnailWidth,_o=_r===void 0?0:_r,ga=e.width,_a=ga===void 0?0:ga,_l=e.height,_d=_l===void 0?0:_l,_f=e.thumbnail,_m=[],typeof zt=="number"&&typeof _o=="number"&&typeof _a=="number"&&typeof _d=="number"){tE.next=5;break}throw new I("Invalid message params",wf);case 5:return 0>=_a&&0>=_d&&_m.push(Rm(Sm(j)).then(function(rE){_a=rE.width,_d=rE.height})),0>=_o&&0>=zt&&_f!==void 0&&_m.push(Ji(_f).then(function(){var rE=J(w.mark(function oE(dE){var nE;return w.wrap(function(sE){for(;;)switch(sE.prev=sE.next){case 0:return sE.next=2,Rm(Sm(dE));case 2:nE=sE.sent,_o=nE.width,zt=nE.height;case 5:case"end":return sE.stop()}},oE)}));return function(oE){return rE.apply(this,arguments)}}())),tE.next=9,Promise.all(_m).catch(function(){});case 9:return tE.abrupt("return",{width:_a,height:_d,thumbnailWidth:_o,thumbnailHeight:zt});case 10:case"end":return tE.stop()}},_)}))).apply(this,arguments)}function Tm(_,e){if(!yd(_))throw new I("message object is not a plain object",e);if(_.messageType===void 0)if(_.rawMessage instanceof Uint8Array){if(_.messageType="RAW",_.text!==void 0)throw new I("Raw messages cannot have text property. Use description instead",e)}else{if(typeof _.text!="string")throw new I("messageType is undefined",e);if(_.messageType="TEXT",_.rawMessage!==void 0)throw new I("Text messages cannot have rawMessage property",e)}}function Gg(_){return Ki.apply(this,arguments)}function Ki(){return(Ki=J(w.mark(function _(e){var j,Vt,zt,_r,_o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE,IE;return w.wrap(function(_E){for(;;)switch(_E.prev=_E.next){case 0:if(j=e.message,Vt=e.peerId,zt=e.toPeer,_r=e.session,_o=e.errorCodes,ga=e.diff,_a=e.logger,_l=e.options,_r!==void 0){_E.next=3;break}throw new K("The client is not logged in. Cannot do the operation",_o.NOT_LOGGED_IN);case 3:if(_d=!1,j.messageType!=="TEXT"||!j.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!zt){_E.next=11;break}if(_f=j.text.split("_"),_m=ra(_f,3),tE=_m[0],rE=_m[1],_m[2]!==void 0&&za(rE)&&tE==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){_E.next=10;break}throw new I("Message is not valid",ve);case 10:_d=!0;case 11:if(oE=Date.now(),dE=_r.messageSentTimes.length-1,!((nE=_r.messageSentTimes[dE])&&nE+3e3<oE)){_E.next=18;break}_r.messageSentTimes=[oE],_E.next=29;break;case 18:sE=dE;case 19:if(!(0<=sE)){_E.next=28;break}if(!(_r.messageSentTimes[sE]+3e3<oE)){_E.next=23;break}return _r.messageSentTimes=_r.messageSentTimes.slice(sE+1,dE+1),_E.abrupt("break",28);case 23:if(!(180<=dE-sE+1)){_E.next=25;break}throw new ib("Message sent failed, exceeded the 180 message in 3 seconds",_o.TOO_OFTEN);case 25:sE--,_E.next=19;break;case 28:_r.messageSentTimes.push(oE);case 29:_E.t0=j.messageType,_E.next=_E.t0==="TEXT"?32:_E.t0==="RAW"?37:_E.t0==="FILE"||_E.t0==="IMAGE"?39:40;break;case 32:if(!_d){_E.next=36;break}return lE=j.text.split("_"),EE=ra(lE,3),wE=EE[1],IE=EE[2],_a.info("[rtm-API] EndCall message send api is called"),_E.abrupt("return",_r.sendInvitationMessage({peerId:Vt,type:"CallCancel",extra:IE,channelId:wE,callId:"0"}));case 36:return _E.abrupt("return",_r.sendTextMessage(j.text,Vt,zt,_l,1e4-ga));case 37:return j.description===void 0&&(j.description=""),_E.abrupt("return",_r.sendRawMessage(j.rawMessage,j.description,Vt,zt,_l,1e4-ga));case 39:return _E.abrupt("return",_r.sendMediaMessage(j.messageType,j,Vt,zt,_l,1e4-ga));case 40:throw new I("Invalid message type",ve);case 41:case"end":return _E.stop()}},_)}))).apply(this,arguments)}function Yt(_){var e=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],j=_.replace(/(https?:\/\/)?(www.)?/i,"");return e||(j=j.split(".").slice(_.length-2).join(".")),j.indexOf("/")!==-1?j.split("/")[0]:j}function oa(_){if(typeof _!="string")return"[Sensitive Info]";var e=Math.floor(.7*_.length),j=_.length;return Um(_,e,j,"*".repeat(j-e))}function Vm(_,e,j){function Vt(zt){if(_===void 0)return _;if(Il(zt))return zt;if(Array.isArray(zt))return zt.map(Vt);var _r={},_o=0;for(zt=Hg(zt);_o<zt.length;_o++){var ga=ra(zt[_o],2),_a=ga[0];if(typeof(ga=ga[1])=="string"&&j.includes(_a)){_r[_a]=typeof ga=="string"?oa(ga):"[Sensitive Info]";break}e.includes(_a)?_r[_a]="[Hidden Info]":_r[_a]=ga==null?ga:j.includes(_a)?"[Sensitive Info]":Vt(ga)}return _r}return Array.isArray(_)?_.map(Vt):Vt(_)}function Wm(_){return Object.getOwnPropertyNames(_).forEach(function(e){X(e=_[e])=="object"&&e!==null&&Wm(e)}),Object.freeze(_)}function pa(_){return new TextDecoder("utf-8").decode(_.buffer.slice(_.byteOffset,_.byteOffset+_.byteLength))}function Ig(_){return new TextEncoder().encode(_).length}function Xm(){for(var _=0,e=arguments.length,j=Array(e),Vt=0;Vt<e;Vt++)j[Vt]=arguments[Vt];for(e=0;e<j.length;e++)_+=j[e].length;for(_=new Uint8Array(_),Vt=e=0;Vt<j.length;Vt++){var zt=j[Vt];_.set(zt,e),e+=zt.length}return _}function we(_,e,j){var Vt=_.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(_=Vt==null?void 0:Vt[1],Vt=Vt==null?void 0:Vt[2]){var zt;for(Vt=Vt.substr(1).split("&"),zt=0;zt<Vt.length;zt++)if(Vt[zt].split("=")[0]==e){Vt[zt]=e+"="+encodeURIComponent(j);break}return zt==Vt.length&&Vt.push(e+"="+encodeURIComponent(j)),_+"?"+Vt.join("&")}return _+"?"+e+"="+encodeURIComponent(j)}function Ji(_){return new Promise(function(e,j){var Vt=new FileReader;Vt.onloadend=function(){var zt=Vt.result||new ArrayBuffer(0);e(zt)},Vt.onerror=j,Vt.readAsArrayBuffer(_)})}function Zt(_,e){_=_=[_],typeof(e=e||{})=="string"&&(e={type:e});try{var j=new Blob(_,e)}catch(zt){if(zt.name!=="TypeError")throw zt;j=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder);for(var Vt=0;Vt<_.length;Vt+=1)j.append(_[Vt]);j=j.getBlob(e.type)}return j}function Um(_,e,j,Vt){return typeof _!="string"?"[Sensitive Info]":_.substring(0,e)+Vt+_.substring(j)}function Ym(_){var e=[];return function j(Vt){if(Vt===null||X(Vt)!=="object")return Vt;if(e.indexOf(Vt)!==-1)return"[Circular]";if(e.push(Vt),typeof Vt.toJSON=="function")try{var zt=j(Vt.toJSON());return e.pop(),zt}catch(_r){return"[Throws: "+(_r?_r.message:"?")+"]"}return Array.isArray(Vt)?(zt=Vt.map(j),e.pop(),zt):(zt=Object.keys(Vt).reduce(function(_r,_o){e:{if($t.call(Vt,_o))try{var ga=Vt[_o];break e}catch(_a){ga="[Throws: "+(_a?_a.message:"?")+"]";break e}ga=Vt[_o]}return _r[_o]=j(ga),_r},{}),e.pop(),zt)}(_)}function au(_){if(!(100<(_=String(_)).length)&&(_=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_))){var e=parseFloat(_[1]);switch((_[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*e;case"weeks":case"week":case"w":return 6048e5*e;case"days":case"day":case"d":return 864e5*e;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*e;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*e;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e}}}function Jg(_,e,j,Vt){return Math.round(_/j)+" "+Vt+(e>=1.5*j?"s":"")}function bu(_){var e=_.areas,j=_.excludedArea;if(e.length===1&&e[0]===F.GLOBAL&&j===F.CHINA)return xe([F.OVERSEA]);if(e.includes(F.GLOBAL)){if(_=xf(Kg).filter(function(_r){return _r!==F.GLOBAL&&_r!==F.OVERSEA}),j in yf){e=yf[j];var Vt=[].concat(G(e??[]),[j]);return xe(_.filter(function(_r){return!Vt.includes(_r)}))}if(Zm(j)){var zt=cu(j);return xe(_.filter(function(_r){return _r!==j&&_r!==zt}))}}if(Zm(j)||j in yf)return xe(e);throw new I("Invalid excludedArea area config")}function Ma(_,e,j){j===void 0&&(j=Object.getOwnPropertyDescriptor(_,e));var Vt=j.value;return j.value=function(){for(var zt=this,_r=arguments.length,_o=Array(_r),ga=0;ga<_r;ga++)_o[ga]=arguments[ga];this.invokeTracker.apply(this,["%s: ".concat(0<_o.length?"%s with args: ".concat(_o.map(function(){return"%o"})):"%s"),this.name,e].concat(G(_o.map(ye))));try{var _a=Vt.apply(this,_o)}catch(_d){throw this.logError.apply(this,["".concat(_d.code!==void 0?"Error Code ".concat(_d.code,": "):"","%s failed").concat(0<_o.length?" with args: ".concat(_o.map(function(){return"%o"})):""),e].concat(G(_o.map(ye)))),_d.originalError&&this.logError(_d.originalError),this.errorTracker(_d),_d}var _l=Date.now();return J(w.mark(function _d(){var _f,_m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:return tE.prev=0,tE.next=3,_a;case 3:_f=tE.sent,tE.next=12;break;case 6:return tE.prev=6,tE.t0=tE.catch(0),zt.logError.apply(zt,["".concat(tE.t0.code!==void 0?"Error Code ".concat(tE.t0.code,": "):"","%s failed").concat(0<_o.length?" with args: ".concat(_o.map(function(){return"%o"})):""),e].concat(G(_o.map(ye)))),tE.t0.originalError&&zt.logError(tE.t0.originalError),zt.errorTracker(tE.t0),tE.abrupt("return");case 12:_f!==_a?_f===void 0?zt.resultTracker("%s promise resolves after %dms",e,Date.now()-_l):zt.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-_l,ye(_f)):Ac(_f)!=="Object"||yd(_f)?zt.resultTracker("%s result is %o",e,ye(_f)):zt.resultTracker("%s result is %s",e,_f.name||((_m=_f.constructor)===null||_m===void 0?void 0:_m.name));case 13:case"end":return tE.stop()}},_d,null,[[0,6]])}))(),_a},j}function Nb(_,e,j){j===void 0&&(j=Object.getOwnPropertyDescriptor(_,e));var Vt=j.value;return j.value=function(){for(var zt=this,_r=arguments.length,_o=Array(_r),ga=0;ga<_r;ga++)_o[ga]=arguments[ga];this.invokeTracker.apply(this,["%s: ".concat(0<_o.length?"%s with args: ".concat(_o.map(function(){return"%o"})):"%s"),this.name,e].concat(_o));try{var _a=Vt.apply(this,_o)}catch(_d){throw this.logError.apply(this,["".concat(_d.code!==void 0?"Error Code ".concat(_d.code,": "):"","%s failed").concat(0<_o.length?" with args: ".concat(_o.map(function(){return"%o"})):""),e].concat(_o)),_d.originalError&&this.logError(_d.originalError),this.errorTracker(_d),_d}var _l=Date.now();return J(w.mark(function _d(){var _f,_m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:return tE.prev=0,tE.next=3,_a;case 3:_f=tE.sent,tE.next=12;break;case 6:return tE.prev=6,tE.t0=tE.catch(0),zt.logError.apply(zt,["".concat(tE.t0.code!==void 0?"Error Code ".concat(tE.t0.code,": "):"","%s failed").concat(0<_o.length?" with args: ".concat(_o.map(function(){return"%o"})):""),e].concat(_o)),tE.t0.originalError&&zt.logError(tE.t0.originalError),zt.errorTracker(tE.t0),tE.abrupt("return");case 12:_f!==_a?_f===void 0?zt.resultTracker("%s promise resolves after %dms",e,Date.now()-_l):zt.resultTracker("%s promise resolves after %dms, result is %o",e,Date.now()-_l,_f):Ac(_f)!=="Object"||yd(_f)?zt.resultTracker("%s result is %o",e,_f):zt.resultTracker("%s result is %s",e,_f.name||((_m=_f.constructor)===null||_m===void 0?void 0:_m.name));case 13:case"end":return tE.stop()}},_d,null,[[0,6]])}))(),_a},j}function du(_,e){var j="".concat(_,"Uri");if(typeof(j=Li[j])!="number"||j===0)throw new TypeError("Got Unknown URI Name");return e=new(_=$m[_])(e),e=_.encode(e).finish(),new eu({uri:j,data:e})}function an(_,e){return"".concat(_.split(".").join("-"),".edge.").concat(e?"sd-rtn.com":"agora.io")}function eb(_,e,j){return Mi.apply(this,arguments)}function Mi(){return(Mi=J(w.mark(function _(e,j,Vt){var zt,_r;return w.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:_o.next=2;break;case 2:return zt=fu[e].encode(j).finish(),_r=function(){var ga=J(w.mark(function _a(_l){var _d,_f,_m,tE=arguments;return w.wrap(function(rE){for(;;)switch(rE.prev=rE.next){case 0:if(!(3<(_f=1<tE.length&&tE[1]!==void 0?tE[1]:0))){rE.next=3;break}return rE.abrupt("return");case 3:return _m=we(_m=Vt?"https://".concat((_d=M==null?void 0:M.PROXY_NGINX[0])!==null&&_d!==void 0?_d:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(_l,"&p=6443&d=events/proto-raw"):"https://".concat(_l,":6443/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),_m=we(_m,"id",gu[e].toString()),rE.next=8,te(_m,{body:zt,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(oE){return _r(_l,_f+1)});case 8:case"end":return rE.stop()}},_a)}));return function(_a){return ga.apply(this,arguments)}}(),_o.prev=4,_o.next=7,_r((M==null?void 0:M.EVENT_REPORT_DOMAIN[0])||"webcollector-rtm.agora.io");case 7:_o.next=13;break;case 9:return _o.prev=9,_o.t0=_o.catch(4),_o.next=13,_r(M&&bn(1<(M==null?void 0:M.EVENT_REPORT_DOMAIN.length)?M==null?void 0:M.EVENT_REPORT_DOMAIN.slice(1):M==null?void 0:M.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 13:case"end":return _o.stop()}},_,null,[[4,9]])}))).apply(this,arguments)}function fb(_){return _===void 0?U.fromNumber(0):U.fromNumber(Date.now()-_)}function hu(_){return btoa(String.fromCharCode.apply({},_.replace(/\r|\n/g,"").replace(/([\dA-Fa-f]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").map(function(e){return parseInt(e,16)}))).replace(/={1,2}$/,"")}function Lg(_,e){return U.fromValue(_).eq(e)}function Mg(_,e){var j=e===void 0?_.val:e,Vt=_.isBoolean;e=_.isNumber;var zt=_.oneof,_r=_.len;if([Vt,e,zt].filter(function(_o){return!_o}).length!==2)throw new TypeError("invalid field type");if(j!==void 0&&(_=!1,zt!==void 0&&(zt=Ni(zt),iu(zt,Lg).length===zt.length&&ju(zt,function(_o){return Lg(j,_o)})!==void 0&&(_=!0)),Vt=Vt!==void 0&&(j===0||j===1)&&_r===1,e=e!==void 0&&j.toString(2).length<=_r,!(_||Vt||e)))throw Error("invalid field value")}function cn(_){return function(){var e=_();if(!e)throw new K("Client is not logged in. Cannot do the operation");return e}}var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},Ng=function(_){return _&&_.Math==Math&&_},y=Ng(typeof globalThis=="object"&&globalThis)||Ng(typeof window=="object"&&window)||Ng(typeof self=="object"&&self)||Ng(typeof Ya=="object"&&Ya)||function(){return this}()||Function("return this")(),R=function(_){try{return!!_()}catch{return!0}},ka=!R(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),dn={}.propertyIsEnumerable,en=Object.getOwnPropertyDescriptor,zf=en&&!dn.call({1:2},1)?function(_){return!!(_=en(this,_))&&_.enumerable}:dn,dd=function(_,e){return{enumerable:!(1&_),configurable:!(2&_),writable:!(4&_),value:e}},ku={}.toString,Zb=function(_){return ku.call(_).slice(8,-1)},lu="".split,Af=R(function(){return!Object("z").propertyIsEnumerable(0)})?function(_){return Zb(_)=="String"?lu.call(_,""):Object(_)}:Object,jb=function(_){if(_==null)throw TypeError("Can't call method on "+_);return _},qb=function(_){return Af(jb(_))},ha=function(_){return typeof _=="object"?_!==null:typeof _=="function"},lc=function(_,e){if(!ha(_))return _;var j,Vt;if(e&&typeof(j=_.toString)=="function"&&!ha(Vt=j.call(_))||typeof(j=_.valueOf)=="function"&&!ha(Vt=j.call(_))||!e&&typeof(j=_.toString)=="function"&&!ha(Vt=j.call(_)))return Vt;throw TypeError("Can't convert object to primitive value")},Qa=function(_){return Object(jb(_))},mu={}.hasOwnProperty,Q=function(_,e){return mu.call(Qa(_),e)},ze=y.document,Og=ha(ze)&&ha(ze.createElement),fn=!ka&&!R(function(){return Object.defineProperty(Og?ze.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),gn=Object.getOwnPropertyDescriptor,Fb={f:ka?gn:function(_,e){if(_=qb(_),e=lc(e,!0),fn)try{return gn(_,e)}catch{}if(Q(_,e))return dd(!zf.call(_,e),_[e])}},va=function(_){if(!ha(_))throw TypeError(String(_)+" is not an object");return _},hn=Object.defineProperty,Ra={f:ka?hn:function(_,e,j){if(va(_),e=lc(e,!0),va(j),fn)try{return hn(_,e,j)}catch{}if("get"in j||"set"in j)throw TypeError("Accessors not supported");return"value"in j&&(_[e]=j.value),_}},Na=ka?function(_,e,j){return Ra.f(_,e,dd(1,j))}:function(_,e,j){return _[e]=j,_},Oi=function(_,e){try{Na(y,_,e)}catch{y[_]=e}return e},ed=y["__core-js_shared__"]||Oi("__core-js_shared__",{}),nu=Function.toString;typeof ed.inspectSource!="function"&&(ed.inspectSource=function(_){return nu.call(_)});var Pi=ed.inspectSource,jn=y.WeakMap,ou=typeof jn=="function"&&/native code/.test(Pi(jn)),fd=$a(function(_){(_.exports=function(e,j){return ed[e]||(ed[e]=j!==void 0?j:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})}),pu=0,qu=Math.random(),Ae=function(_){return"Symbol("+String(_===void 0?"":_)+")_"+(++pu+qu).toString(36)},kn=fd("keys"),Pg=function(_){return kn[_]||(kn[_]=Ae(_))},Be={},ru=y.WeakMap;if(ou||ed.state)var Gd=ed.state||(ed.state=new ru),su=Gd.get,ln=Gd.has,tu=Gd.set,Qi=function(_,e){if(ln.call(Gd,_))throw new TypeError("Object already initialized");return e.facade=_,tu.call(Gd,_,e),e},Qg=function(_){return su.call(Gd,_)||{}},Ri=function(_){return ln.call(Gd,_)};else{var Ce=Pg("state");Be[Ce]=!0,Qi=function(_,e){if(Q(_,Ce))throw new TypeError("Object already initialized");return e.facade=_,Na(_,Ce,e),e},Qg=function(_){return Q(_,Ce)?_[Ce]:{}},Ri=function(_){return Q(_,Ce)}}var Za={set:Qi,get:Qg,has:Ri,enforce:function(_){return Ri(_)?Qg(_):Qi(_,{})},getterFor:function(_){return function(e){var j;if(!ha(e)||(j=Qg(e)).type!==_)throw TypeError("Incompatible receiver, "+_+" required");return j}}},Ta=$a(function(_){var e=Za.get,j=Za.enforce,Vt=String(String).split("String");(_.exports=function(zt,_r,_o,ga){var _a=!!ga&&!!ga.unsafe,_l=!!ga&&!!ga.enumerable;if(ga=!!ga&&!!ga.noTargetGet,typeof _o=="function"){typeof _r!="string"||Q(_o,"name")||Na(_o,"name",_r);var _d=j(_o);_d.source||(_d.source=Vt.join(typeof _r=="string"?_r:""))}zt===y?_l?zt[_r]=_o:Oi(_r,_o):(_a?!ga&&zt[_r]&&(_l=!0):delete zt[_r],_l?zt[_r]=_o:Na(zt,_r,_o))})(Function.prototype,"toString",function(){return typeof this=="function"&&e(this).source||Pi(this)})}),mn=function(_){return typeof _=="function"?_:void 0},mc=function(_,e){return 2>arguments.length?mn(y[_])||mn(y[_]):y[_]&&y[_][e]||y[_]&&y[_][e]},uu=Math.ceil,vu=Math.floor,$b=function(_){return isNaN(_=+_)?0:(0<_?vu:uu)(_)},wu=Math.min,ta=function(_){return 0<_?wu($b(_),9007199254740991):0},xu=Math.max,yu=Math.min,xb=function(_,e){return 0>(_=$b(_))?xu(_+e,0):yu(_,e)},nn=function(_){return function(e,j,Vt){e=qb(e);var zt=ta(e.length);if(Vt=xb(Vt,zt),_&&j!=j){for(;zt>Vt;)if((j=e[Vt++])!=j)return!0}else for(;zt>Vt;Vt++)if((_||Vt in e)&&e[Vt]===j)return _||Vt||0;return!_&&-1}},on=nn(!0),Si=nn(!1),pn=function(_,e){_=qb(_);var j,Vt=0,zt=[];for(j in _)!Q(Be,j)&&Q(_,j)&&zt.push(j);for(;e.length>Vt;)Q(_,j=e[Vt++])&&(~Si(zt,j)||zt.push(j));return zt},Rg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),zu=Rg.concat("length","prototype"),Hd={f:Object.getOwnPropertyNames||function(_){return pn(_,zu)}},Bf={f:Object.getOwnPropertySymbols},qn=mc("Reflect","ownKeys")||function(_){var e=Hd.f(va(_)),j=Bf.f;return j?e.concat(j(_)):e},rn=function(_,e){for(var j=qn(e),Vt=Ra.f,zt=Fb.f,_r=0;_r<j.length;_r++){var _o=j[_r];Q(_,_o)||Vt(_,_o,zt(e,_o))}},Au=/#|\.prototype\./,nc=function(_,e){return(_=Bu[Cu(_)])==Du||_!=Eu&&(typeof e=="function"?R(e):!!e)},Cu=nc.normalize=function(_){return String(_).replace(Au,".").toLowerCase()},Bu=nc.data={},Eu=nc.NATIVE="N",Du=nc.POLYFILL="P",Fu=Fb.f,N=function(_,e){var j,Vt,zt,_r=_.target,_o=_.global,ga=_.stat;if(Vt=_o?y:ga?y[_r]||Oi(_r,{}):(y[_r]||{}).prototype)for(zt in e){var _a=e[zt],_l=_.noTargetGet?(j=Fu(Vt,zt))&&j.value:Vt[zt];if(!(j=nc(_o?zt:_r+(ga?".":"#")+zt,_.forced))&&_l!==void 0){if(typeof _a==typeof _l)continue;rn(_a,_l)}(_.sham||_l&&_l.sham)&&Na(_a,"sham",!0);try{Ta(Vt,zt,_a,_)}catch{}}},yb=function(_){if(typeof _!="function")throw TypeError(String(_)+" is not a function");return _},Id=function(_,e,j){if(yb(_),e===void 0)return _;switch(j){case 0:return function(){return _.call(e)};case 1:return function(Vt){return _.call(e,Vt)};case 2:return function(Vt,zt){return _.call(e,Vt,zt)};case 3:return function(Vt,zt,_r){return _.call(e,Vt,zt,_r)}}return function(){return _.apply(e,arguments)}},gd=Array.isArray||function(_){return Zb(_)=="Array"},De=mc("navigator","userAgent")||"",sn=y.process,tn=sn&&sn.versions,un=tn&&tn.v8;if(un)var hd=un.split("."),Ti=4>hd[0]?1:hd[0]+hd[1];else De&&(hd=De.match(/Edge\/(\d+)/),(!hd||74<=hd[1])&&(hd=De.match(/Chrome\/(\d+)/))&&(Ti=hd[1]));var id=Ti&&+Ti,oc=!!Object.getOwnPropertySymbols&&!R(function(){return!String(Symbol())||!Symbol.sham&&id&&41>id}),vn=oc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Cf=fd("wks"),Df=y.Symbol,Gu=vn?Df:Df&&Df.withoutSetter||Ae,qa=function(_){return Q(Cf,_)&&(oc||typeof Cf[_]=="string")||(oc&&Q(Df,_)?Cf[_]=Df[_]:Cf[_]=Gu("Symbol."+_)),Cf[_]},Hu=qa("species"),Sg=function(_,e){if(gd(_)){var j=_.constructor;typeof j!="function"||j!==Array&&!gd(j.prototype)?ha(j)&&(j=j[Hu])===null&&(j=void 0):j=void 0}return new(j===void 0?Array:j)(e===0?0:e)},wn=[].push,jd=function(_){var e=_==1,j=_==2,Vt=_==3,zt=_==4,_r=_==6,_o=_==7,ga=_==5||_r;return function(_a,_l,_d,_f){var _m=Qa(_a),tE=Af(_m);_l=Id(_l,_d,3),_d=ta(tE.length);var rE,oE=0;for(_f=_f||Sg,_a=e?_f(_a,_d):j||_o?_f(_a,0):void 0;_d>oE;oE++)if((ga||oE in tE)&&(rE=_l(_f=tE[oE],oE,_m),_))if(e)_a[oE]=rE;else if(rE)switch(_){case 3:return!0;case 5:return _f;case 6:return oE;case 2:wn.call(_a,_f)}else switch(_){case 4:return!1;case 7:wn.call(_a,_f)}return _r?-1:Vt||zt?zt:_a}},Jd=jd(0),xn=jd(1),yn=jd(2),Iu=jd(3),Ju=jd(4),zn=jd(5),An=jd(6),Ku=qa("species"),Ef=function(_){return 51<=id||!R(function(){var e=[];return(e.constructor={})[Ku]=function(){return{foo:1}},e[_](Boolean).foo!==1})},Lu=Ef("filter");N({target:"Array",proto:!0,forced:!Lu},{filter:function(_){return yn(this,_,1<arguments.length?arguments[1]:void 0)}});var Dc=Object.keys||function(_){return pn(_,Rg)},Mu=R(function(){Dc(1)});N({target:"Object",stat:!0,forced:Mu},{keys:function(_){return Dc(Qa(_))}});var Ee=function(_,e){var j=[][_];return!!j&&R(function(){j.call(null,e||function(){throw 1},1)})},Nu=[].join,Ou=Af!=Object,Pu=Ee("join",",");N({target:"Array",proto:!0,forced:Ou||!Pu},{join:function(_){return Nu.call(qb(this),_===void 0?",":_)}});var Qu=Ef("map");N({target:"Array",proto:!0,forced:!Qu},{map:function(_){return xn(this,_,1<arguments.length?arguments[1]:void 0)}});var Ui=function(_){var e=_.return;if(e!==void 0)return va(e.call(_)).value},Fe={},Ru=qa("iterator"),Su=Array.prototype,Vi=function(_){return _!==void 0&&(Fe.Array===_||Su[Ru]===_)},Ge=function(_,e,j){(e=lc(e))in _?Ra.f(_,e,dd(0,j)):_[e]=j},Tu=qa("toStringTag"),Bn={};Bn[Tu]="z";var Wi=String(Bn)==="[object z]",Uu=qa("toStringTag"),Vu=Zb(function(){return arguments}())=="Arguments",Ff=Wi?Zb:function(_){var e;if(_===void 0)var j="Undefined";else{if(_===null)var Vt="Null";else{e:{var zt=_=Object(_);try{Vt=zt[Uu];break e}catch{}Vt=void 0}Vt=typeof(j=Vt)=="string"?j:Vu?Zb(_):(e=Zb(_))=="Object"&&typeof _.callee=="function"?"Arguments":e}j=Vt}return j},Wu=qa("iterator"),Xi=function(_){if(_!=null)return _[Wu]||_["@@iterator"]||Fe[Ff(_)]},Cn=qa("iterator"),Dn=!1;try{var Xu=0,En={next:function(){return{done:!!Xu++}},return:function(){Dn=!0}};En[Cn]=function(){return this},Array.from(En,function(){throw 2})}catch(_){}var Tg=function(_,e){if(!e&&!Dn)return!1;var j=!1;try{(e={})[Cn]=function(){return{next:function(){return{done:j=!0}}}},_(e)}catch{}return j},Yu=!Tg(function(_){Array.from(_)});N({target:"Array",stat:!0,forced:Yu},{from:function(_){var e,j=Qa(_),Vt=typeof this=="function"?this:Array,zt=arguments.length,_r=1<zt?arguments[1]:void 0,_o=_r!==void 0,ga=Xi(j),_a=0;if(_o&&(_r=Id(_r,2<zt?arguments[2]:void 0,2)),ga==null||Vt==Array&&Vi(ga)){var _l=ta(j.length);for(Vt=new Vt(_l);_l>_a;_a++)ga=_o?_r(j[_a],_a):j[_a],Ge(Vt,_a,ga)}else for(zt=(j=ga.call(j)).next,Vt=new Vt;!(e=zt.call(j)).done;_a++){if(_o){ga=j;var _d=_r;e=[e.value,_a];try{_l=_d(va(e)[0],e[1])}catch(_f){throw Ui(ga),_f}}else _l=e.value;Ge(Vt,_a,ga=_l)}return Vt.length=_a,Vt}});var Fn=function(_){return function(e,j){e=String(jb(e)),j=$b(j);var Vt,zt=e.length;if(0>j||j>=zt)return _?"":void 0;var _r=e.charCodeAt(j);return 55296>_r||56319<_r||j+1===zt||56320>(Vt=e.charCodeAt(j+1))||57343<Vt?_?e.charAt(j):_r:_?e.slice(j,j+2):Vt-56320+(_r-55296<<10)+65536}},Gn=Fn(!0),Hn=!R(function(){function _(){}return _.prototype.constructor=null,Object.getPrototypeOf(new _)!==_.prototype}),In=Pg("IE_PROTO"),Zu=Object.prototype,Vb=Hn?Object.getPrototypeOf:function(_){return _=Qa(_),Q(_,In)?_[In]:typeof _.constructor=="function"&&_ instanceof _.constructor?_.constructor.prototype:_ instanceof Object?Zu:null},Yi=qa("iterator"),Jn=!1,$u=function(){return this},Kd;if([].keys){var Kn=[].keys();if("next"in Kn){var Ln=Vb(Vb(Kn));Ln!==Object.prototype&&(Kd=Ln)}else Jn=!0}(Kd==null||R(function(){var _={};return Kd[Yi].call(_)!==_}))&&(Kd={}),Q(Kd,Yi)||Na(Kd,Yi,$u);var Ug=Kd,Vg=Jn,av=ka?Object.defineProperties:function(_,e){va(_);for(var j,Vt=Dc(e),zt=Vt.length,_r=0;zt>_r;)Ra.f(_,j=Vt[_r++],e[j]);return _},Zi=mc("document","documentElement"),Mn=Pg("IE_PROTO"),$i=function(){},aj,Wg=function(){try{aj=document.domain&&new ActiveXObject("htmlfile")}catch{}if(aj){var _=aj;_.write("<script><\/script>"),_.close(),_=_.parentWindow.Object}else(_=Og?ze.createElement("iframe"):{}).style.display="none",Zi.appendChild(_),_.src="javascript:",(_=_.contentWindow.document).open(),_.write("<script>document.F=Object<\/script>"),_.close(),_=_.F;for(Wg=_,_=Rg.length;_--;)delete Wg.prototype[Rg[_]];return Wg()};Be[Mn]=!0;var ac=Object.create||function(_,e){if(_!==null){$i.prototype=va(_);var j=new $i;$i.prototype=null,j[Mn]=_}else j=Wg();return e===void 0?j:av(j,e)},bv=Ra.f,Nn=qa("toStringTag"),Ec=function(_,e,j){_&&!Q(_=j?_:_.prototype,Nn)&&bv(_,Nn,{configurable:!0,value:e})},cv=function(){return this},dv=function(_,e,j){return e+=" Iterator",_.prototype=ac(Ug,{next:dd(1,j)}),Ec(_,e,!1),Fe[e]=cv,_},Ua=Object.setPrototypeOf||("__proto__"in{}?function(){var _=!1,e={};try{var j=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;j.call(e,[]),_=e instanceof Array}catch{}return function(Vt,zt){if(va(Vt),!ha(zt)&&zt!==null)throw TypeError("Can't set "+String(zt)+" as a prototype");return _?j.call(Vt,zt):Vt.__proto__=zt,Vt}}():void 0),Gf=qa("iterator"),ev=function(){return this},bj=function(_,e,j,Vt,zt,_r,_o){dv(j,e,Vt),Vt=function(oE){if(oE===zt&&_m)return _m;if(!Vg&&oE in _d)return _d[oE];switch(oE){case"keys":case"values":case"entries":return function(){return new j(this,oE)}}return function(){return new j(this)}};var ga,_a=e+" Iterator",_l=!1,_d=_.prototype,_f=_d[Gf]||_d["@@iterator"]||zt&&_d[zt],_m=!Vg&&_f||Vt(zt),tE=e=="Array"&&_d.entries||_f;if(tE&&(_=Vb(tE.call(new _)),Ug!==Object.prototype&&_.next&&(Vb(_)!==Ug&&(Ua?Ua(_,Ug):typeof _[Gf]!="function"&&Na(_,Gf,ev)),Ec(_,_a,!0))),zt=="values"&&_f&&_f.name!=="values"&&(_l=!0,_m=function(){return _f.call(this)}),_d[Gf]!==_m&&Na(_d,Gf,_m),Fe[e]=_m,zt){var rE={values:Vt("values"),keys:_r?_m:Vt("keys"),entries:Vt("entries")};if(_o)for(ga in rE)!Vg&&!_l&&ga in _d||Ta(_d,ga,rE[ga]);else N({target:e,proto:!0,forced:Vg||_l},rE)}return rE},fv=Za.set,gv=Za.getterFor("String Iterator");bj(String,"String",function(_){fv(this,{type:"String Iterator",string:String(_),index:0})},function(){var _=gv(this),e=_.string,j=_.index;return j>=e.length?{value:void 0,done:!0}:(e=Gn(e,j),_.index+=e.length,{value:e,done:!1})});var cj=qa("unscopables"),dj=Array.prototype;dj[cj]==null&&Ra.f(dj,cj,{configurable:!0,value:ac(null)});var Ld=function(_){dj[cj][_]=!0},On=!0;"find"in[]&&Array(1).find(function(){On=!1}),N({target:"Array",proto:!0,forced:On},{find:function(_){return zn(this,_,1<arguments.length?arguments[1]:void 0)}}),Ld("find");var Pn=function(_){var e=String(jb(this)),j="";if(0>(_=$b(_))||_==1/0)throw RangeError("Wrong number of repetitions");for(;0<_;(_>>>=1)&&(e+=e))1&_&&(j+=e);return j};N({target:"String",proto:!0},{repeat:Pn}),N({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),N({target:"Number",stat:!0},{isNaN:function(_){return _!=_}}),y.Number.isNaN;var hv=Wi?{}.toString:function(){return"[object "+Ff(this)+"]"};Wi||Ta(Object.prototype,"toString",hv,{unsafe:!0});var Fc=y.Promise,Hf=function(_,e,j){for(var Vt in e)Ta(_,Vt,e[Vt],j);return _},Qn=qa("species"),If=function(_){_=mc(_);var e=Ra.f;ka&&_&&!_[Qn]&&e(_,Qn,{configurable:!0,get:function(){return this}})},Gc=function(_,e,j){if(!(_ instanceof e))throw TypeError("Incorrect "+(j?j+" ":"")+"invocation");return _},Jf=function(_,e){this.stopped=_,this.result=e},Xg=function(_,e,j){var Vt,zt=!(!j||!j.AS_ENTRIES),_r=!(!j||!j.IS_ITERATOR),_o=!(!j||!j.INTERRUPTED),ga=Id(e,j&&j.that,1+zt+_o),_a=function(_d){return _l&&Ui(_l),new Jf(!0,_d)};if(e=function(_d){return zt?(va(_d),_o?ga(_d[0],_d[1],_a):ga(_d[0],_d[1])):_o?ga(_d,_a):ga(_d)},_r)var _l=_;else{if(typeof(_r=Xi(_))!="function")throw TypeError("Target is not iterable");if(Vi(_r)){for(_r=0,j=ta(_.length);j>_r;_r++)if((Vt=e(_[_r]))&&Vt instanceof Jf)return Vt;return new Jf(!1)}_l=_r.call(_)}for(_=_l.next;!(_r=_.call(_l)).done;){try{Vt=e(_r.value)}catch(_d){throw Ui(_l),_d}if(typeof Vt=="object"&&Vt&&Vt instanceof Jf)return Vt}return new Jf(!1)},iv=qa("species"),kd=function(_,e){var j;return(_=va(_).constructor)===void 0||(j=va(_)[iv])==null?e:yb(j)},Rn=/(?:iphone|ipod|ipad).*applewebkit/i.test(De),Hc=Zb(y.process)=="process",Yg=y.location,ej=y.setImmediate,Sn=y.clearImmediate,jv=y.process,Tn=y.MessageChannel,fj=y.Dispatch,gj=0,Kf={},hj=function(_){if(Kf.hasOwnProperty(_)){var e=Kf[_];delete Kf[_],e()}},ij=function(_){return function(){hj(_)}},Un=function(_){hj(_.data)},Vn=function(_){y.postMessage(_+"",Yg.protocol+"//"+Yg.host)};if(!ej||!Sn)if(ej=function(_){for(var e=[],j=1;arguments.length>j;)e.push(arguments[j++]);return Kf[++gj]=function(){(typeof _=="function"?_:Function(_)).apply(void 0,e)},Lf(gj),gj},Sn=function(_){delete Kf[_]},Hc)var Lf=function(_){jv.nextTick(ij(_))};else if(fj&&fj.now)Lf=function(_){fj.now(ij(_))};else if(Tn&&!Rn){var Wn=new Tn,Xn=Wn.port2;Wn.port1.onmessage=Un,Lf=Id(Xn.postMessage,Xn,1)}else y.addEventListener&&typeof postMessage=="function"&&!y.importScripts&&Yg&&Yg.protocol!=="file:"&&!R(Vn)?(Lf=Vn,y.addEventListener("message",Un,!1)):Lf="onreadystatechange"in(Og?ze.createElement("script"):{})?function(_){Zi.appendChild(Og?ze.createElement("script"):{}).onreadystatechange=function(){Zi.removeChild(this),hj(_)}}:function(_){setTimeout(ij(_),0)};var jj=ej,kv=/web0s(?!.*chrome)/i.test(De),lv=Fb.f,Yn=y.MutationObserver||y.WebKitMutationObserver,Zn=y.document,$n=y.process,Zg=y.Promise,ao=lv(y,"queueMicrotask"),bo=ao&&ao.value,Md,Mf;if(!bo){var ah=function(){var _;for(Hc&&(_=$n.domain)&&_.exit();Md;){var e=Md.fn;Md=Md.next;try{e()}catch(j){throw Md?$g():Mf=void 0,j}}Mf=void 0,_&&_.enter()};if(Rn||Hc||kv||!Yn||!Zn)if(Zg&&Zg.resolve){var kj=Zg.resolve(void 0);kj.constructor=Zg;var mv=kj.then,$g=function(){mv.call(kj,ah)}}else $g=Hc?function(){$n.nextTick(ah)}:function(){jj.call(y,ah)};else{var co=!0,eo=Zn.createTextNode("");new Yn(ah).observe(eo,{characterData:!0}),$g=function(){eo.data=co=!co}}}var fo=bo||function(_){_={fn:_,next:void 0},Mf&&(Mf.next=_),Md||(Md=_,$g()),Mf=_},nv=function(_){var e,j;this.promise=new _(function(Vt,zt){if(e!==void 0||j!==void 0)throw TypeError("Bad Promise constructor");e=Vt,j=zt}),this.resolve=yb(e),this.reject=yb(j)},lj={f:function(_){return new nv(_)}},mj=function(_,e){return va(_),ha(e)&&e.constructor===_?e:((0,(_=lj.f(_)).resolve)(e),_.promise)},ov=function(_,e){var j=y.console;j&&j.error&&(arguments.length===1?j.error(_):j.error(_,e))},nj=function(_){try{return{error:!1,value:_()}}catch(e){return{error:!0,value:e}}},pv=typeof window=="object",qv=qa("species"),go=Za.get,rv=Za.set,sv=Za.getterFor("Promise"),Nd=Fc&&Fc.prototype,zb=Fc,bh=Nd,ho=y.TypeError,oj=y.document,pj=y.process,He=lj.f,tv=He,uv=!!(oj&&oj.createEvent&&y.dispatchEvent),io=typeof PromiseRejectionEvent=="function",jo=!1,Nf=nc("Promise",function(){var _=Pi(zb)!==String(zb);if(!_&&id===66)return!0;if(51<=id&&/native code/.test(zb))return!1;var e=new zb(function(Vt){Vt(1)}),j=function(Vt){Vt(function(){},function(){})};return(e.constructor={})[qv]=j,!(jo=e.then(function(){})instanceof j)||!_&&pv&&!io}),vv=Nf||!Tg(function(_){zb.all(_).catch(function(){})}),ko=function(_){var e;return!(!ha(_)||typeof(e=_.then)!="function")&&e},qj=function(_,e){if(!_.notified){_.notified=!0;var j=_.reactions;fo(function(){for(var Vt=_.value,zt=_.state==1,_r=0;j.length>_r;){var _o,ga=j[_r++],_a=zt?ga.ok:ga.fail,_l=ga.resolve,_d=ga.reject,_f=ga.domain;try{if(_a){if(zt||(_.rejection===2&&wv(_),_.rejection=1),_a===!0)var _m=Vt;else if(_f&&_f.enter(),_m=_a(Vt),_f){_f.exit();var tE=!0}_m===ga.promise?_d(ho("Promise-chain cycle")):(_o=ko(_m))?_o.call(_m,_l,_d):_l(_m)}else _d(Vt)}catch(rE){_f&&!tE&&_f.exit(),_d(rE)}}_.reactions=[],_.notified=!1,e&&!_.rejection&&xv(_)})}},lo=function(_,e,j){var Vt;if(uv){var zt=oj.createEvent("Event");zt.promise=e,zt.reason=j,zt.initEvent(_,!1,!0),y.dispatchEvent(zt)}else zt={promise:e,reason:j};!io&&(Vt=y["on"+_])?Vt(zt):_==="unhandledrejection"&&ov("Unhandled promise rejection",j)},xv=function(_){jj.call(y,function(){var e=_.facade,j=_.value;if(_.rejection!==1&&!_.parent){var Vt=nj(function(){Hc?pj.emit("unhandledRejection",j,e):lo("unhandledrejection",e,j)});if(_.rejection=Hc||_.rejection!==1&&!_.parent?2:1,Vt.error)throw Vt.value}})},wv=function(_){jj.call(y,function(){var e=_.facade;Hc?pj.emit("rejectionHandled",e):lo("rejectionhandled",e,_.value)})},Ie=function(_,e,j){return function(Vt){_(e,Vt,j)}},Je=function(_,e,j){_.done||(_.done=!0,j&&(_=j),_.value=e,_.state=2,qj(_,!0))},rj=function(_,e,j){if(!_.done){_.done=!0,j&&(_=j);try{if(_.facade===e)throw ho("Promise can't be resolved itself");var Vt=ko(e);Vt?fo(function(){var zt={done:!1};try{Vt.call(e,Ie(rj,zt,_),Ie(Je,zt,_))}catch(_r){Je(zt,_r,_)}}):(_.value=e,_.state=1,qj(_,!1))}catch(zt){Je({done:!1},zt,_)}}};if(Nf){zb=function(_){Gc(this,zb,"Promise"),yb(_),sj.call(this);var e=go(this);try{_(Ie(rj,e),Ie(Je,e))}catch(j){Je(e,j)}},bh=zb.prototype;var sj=function(_){rv(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};sj.prototype=Hf(bh,{then:function(_,e){var j=sv(this),Vt=He(kd(this,zb));return Vt.ok=typeof _!="function"||_,Vt.fail=typeof e=="function"&&e,Vt.domain=Hc?pj.domain:void 0,j.parent=!0,j.reactions.push(Vt),j.state!=0&&qj(j,!1),Vt.promise},catch:function(_){return this.then(void 0,_)}});var yv=function(){var _=new sj,e=go(_);this.promise=_,this.resolve=Ie(rj,e),this.reject=Ie(Je,e)};if(lj.f=He=function(_){return _===zb||_===zv?new yv(_):tv(_)},typeof Fc=="function"&&Nd!==Object.prototype){var Av=Nd.then;jo||(Ta(Nd,"then",function(_,e){var j=this;return new zb(function(Vt,zt){Av.call(j,Vt,zt)}).then(_,e)},{unsafe:!0}),Ta(Nd,"catch",bh.catch,{unsafe:!0}));try{delete Nd.constructor}catch{}Ua&&Ua(Nd,bh)}}N({global:!0,wrap:!0,forced:Nf},{Promise:zb}),Ec(zb,"Promise",!1),If("Promise");var zv=mc("Promise");N({target:"Promise",stat:!0,forced:Nf},{reject:function(_){var e=He(this);return e.reject.call(void 0,_),e.promise}}),N({target:"Promise",stat:!0,forced:Nf},{resolve:function(_){return mj(this,_)}}),N({target:"Promise",stat:!0,forced:vv},{all:function(_){var e=this,j=He(e),Vt=j.resolve,zt=j.reject,_r=nj(function(){var _o=yb(e.resolve),ga=[],_a=0,_l=1;Xg(_,function(_d){var _f=_a++,_m=!1;ga.push(void 0),_l++,_o.call(e,_d).then(function(tE){_m||(_m=!0,ga[_f]=tE,--_l||Vt(ga))},zt)}),--_l||Vt(ga)});return _r.error&&zt(_r.value),j.promise},race:function(_){var e=this,j=He(e),Vt=j.reject,zt=nj(function(){var _r=yb(e.resolve);Xg(_,function(_o){_r.call(e,_o).then(j.resolve,Vt)})});return zt.error&&Vt(zt.value),j.promise}});var mo=[].indexOf,no=!!mo&&0>1/[1].indexOf(1,-0),Bv=Ee("indexOf");N({target:"Array",proto:!0,forced:no||!Bv},{indexOf:function(_){return no?mo.apply(this,arguments)||0:Si(this,_,1<arguments.length?arguments[1]:void 0)}});var tj=function(){var _=va(this),e="";return _.global&&(e+="g"),_.ignoreCase&&(e+="i"),_.multiline&&(e+="m"),_.dotAll&&(e+="s"),_.unicode&&(e+="u"),_.sticky&&(e+="y"),e},pc=R(function(){var _=RegExp("a","y");return _.lastIndex=2,_.exec("abcd")!=null}),Cv=R(function(){var _=RegExp("^r","gy");return _.lastIndex=2,_.exec("str")!=null}),ch=RegExp.prototype.exec,Dv=fd("native-string-replace",String.prototype.replace),oo=ch,uj=(c=/a/,a=/b*/g,ch.call(c,"a"),ch.call(a,"a"),c.lastIndex!==0||a.lastIndex!==0),po=pc||Cv,vj=/()??/.exec("")[1]!==void 0,c,a;(uj||vj||po)&&(oo=function(_){var e,j=po&&this.sticky,Vt=tj.call(this),zt=this.source,_r=0,_o=_;if(j){(Vt=Vt.replace("y","")).indexOf("g")===-1&&(Vt+="g"),_o=String(_).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&_[this.lastIndex-1]!==`
`)&&(zt="(?: "+zt+")",_o=" "+_o,_r++);var ga=new RegExp("^(?:"+zt+")",Vt)}if(vj&&(ga=new RegExp("^"+zt+"$(?!\\s)",Vt)),uj)var _a=this.lastIndex;var _l=ch.call(j?ga:this,_o);return j?_l?(_l.input=_l.input.slice(_r),_l[0]=_l[0].slice(_r),_l.index=this.lastIndex,this.lastIndex+=_l[0].length):this.lastIndex=0:uj&&_l&&(this.lastIndex=this.global?_l.index+_l[0].length:_a),vj&&_l&&1<_l.length&&Dv.call(_l[0],ga,function(){for(e=1;e<arguments.length-2;e++)arguments[e]===void 0&&(_l[e]=void 0)}),_l});var Of=oo;N({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Ev=qa("species"),wj=RegExp.prototype,Fv=!R(function(){var _=/./;return _.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(_,"$<a>")!=="7"}),qo="a".replace(/./,"$0")==="$0",ro=qa("replace"),so=!!/./[ro]&&/./[ro]("a","$0")==="",Gv=!R(function(){var _=/(?:)/,e=_.exec;return _.exec=function(){return e.apply(this,arguments)},(_="ab".split(_)).length!==2||_[0]!=="a"||_[1]!=="b"}),dh=function(_,e,j,Vt){var zt=qa(_),_r=!R(function(){var _l={};return _l[zt]=function(){return 7},""[_](_l)!=7}),_o=_r&&!R(function(){var _l=!1,_d=/a/;return _==="split"&&((_d={constructor:{}}).constructor[Ev]=function(){return _d},_d.flags="",_d[zt]=/./[zt]),_d.exec=function(){return _l=!0,null},_d[zt](""),!_l});if(!_r||!_o||_==="replace"&&(!Fv||!qo||so)||_==="split"&&!Gv){var ga=/./[zt],_a=(j=j(zt,""[_],function(_l,_d,_f,_m,tE){var rE=_d.exec;return rE===Of||rE===wj.exec?_r&&!tE?{done:!0,value:ga.call(_d,_f,_m)}:{done:!0,value:_l.call(_f,_d,_m)}:{done:!1}},{REPLACE_KEEPS_$0:qo,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:so}))[1];Ta(String.prototype,_,j[0]),Ta(wj,zt,e==2?function(_l,_d){return _a.call(_l,this,_d)}:function(_l){return _a.call(_l,this)})}Vt&&Na(wj[zt],"sham",!0)},xj=function(_,e,j){return e+(j?Gn(_,e).length:1)},Hv=Math.floor,Iv="".replace,Jv=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Kv=/\$([$&'`]|\d{1,2})/g,Lv=function(_,e,j,Vt,zt,_r){var _o=j+_.length,ga=Vt.length,_a=Kv;return zt!==void 0&&(zt=Qa(zt),_a=Jv),Iv.call(_r,_a,function(_l,_d){switch(_d.charAt(0)){case"$":return"$";case"&":return _;case"`":return e.slice(0,j);case"'":return e.slice(_o);case"<":_l=zt[_d.slice(1,-1)];break;default:var _f=+_d;if(_f===0)return _l;if(_f>ga)return(_f=Hv(_f/10))===0?_l:_f<=ga?Vt[_f-1]===void 0?_d.charAt(1):Vt[_f-1]+_d.charAt(1):_l;_l=Vt[_f-1]}return _l===void 0?"":_l})},Ke=function(_,e){var j=_.exec;if(typeof j=="function"){if(typeof(_=j.call(_,e))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return _}if(Zb(_)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Of.call(_,e)},Mv=Math.max,Nv=Math.min,Ov=function(_){return _===void 0?_:String(_)};dh("replace",2,function(_,e,j,Vt){var zt=Vt.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_r=Vt.REPLACE_KEEPS_$0,_o=zt?"$":"$0";return[function(ga,_a){var _l=jb(this),_d=ga==null?void 0:ga[_];return _d!==void 0?_d.call(ga,_l,_a):e.call(String(_l),ga,_a)},function(ga,_a){if(!zt&&_r||typeof _a=="string"&&_a.indexOf(_o)===-1){var _l=j(e,ga,this,_a);if(_l.done)return _l.value}var _d=va(ga);ga=String(this),(_l=typeof _a=="function")||(_a=String(_a));var _f=_d.global;if(_f){var _m=_d.unicode;_d.lastIndex=0}for(var tE=[];;){var rE=Ke(_d,ga);if(rE===null||(tE.push(rE),!_f))break;String(rE[0])===""&&(_d.lastIndex=xj(ga,ta(_d.lastIndex),_m))}for(_m="",_f=_d=0;_f<tE.length;_f++){rE=tE[_f];for(var oE=String(rE[0]),dE=Mv(Nv($b(rE.index),ga.length),0),nE=[],sE=1;sE<rE.length;sE++)nE.push(Ov(rE[sE]));rE=rE.groups,_l?(nE=[oE].concat(nE,dE,ga),rE!==void 0&&nE.push(rE),rE=String(_a.apply(void 0,nE))):rE=Lv(oE,ga,dE,nE,rE,_a),dE>=_d&&(_m+=ga.slice(_d,dE)+rE,_d=dE+oE.length)}return _m+ga.slice(_d)}]});var Pv=Ef("slice"),Qv=qa("species"),Rv=[].slice,Sv=Math.max;N({target:"Array",proto:!0,forced:!Pv},{slice:function(_,e){var j=qb(this),Vt=ta(j.length);if(_=xb(_,Vt),e=xb(e===void 0?Vt:e,Vt),gd(j)){var zt=j.constructor;if(typeof zt!="function"||zt!==Array&&!gd(zt.prototype)?ha(zt)&&(zt=zt[Qv])===null&&(zt=void 0):zt=void 0,zt===Array||zt===void 0)return Rv.call(j,_,e)}for(zt=new(zt===void 0?Array:zt)(Sv(e-_,0)),Vt=0;_<e;_++,Vt++)_ in j&&Ge(zt,Vt,j[_]);return zt.length=Vt,zt}});var Tv=Za.set,Uv=Za.getterFor("Array Iterator"),ld=bj(Array,"Array",function(_,e){Tv(this,{type:"Array Iterator",target:qb(_),index:0,kind:e})},function(){var _=Uv(this),e=_.target,j=_.kind,Vt=_.index++;return!e||Vt>=e.length?(_.target=void 0,{value:void 0,done:!0}):j=="keys"?{value:Vt,done:!1}:j=="values"?{value:e[Vt],done:!1}:{value:[Vt,e[Vt]],done:!1}},"values");Fe.Arguments=Fe.Array,Ld("keys"),Ld("values"),Ld("entries");var to=typeof ArrayBuffer<"u"&&typeof DataView<"u",Le=function(_){if(_===void 0)return 0;_=$b(_);var e=ta(_);if(_!==e)throw RangeError("Wrong length or index");return e},Vv=Math.abs,Ic=Math.pow,Wv=Math.floor,Xv=Math.log,Yv=Math.LN2,yj=function(_){var e=Qa(this),j=ta(e.length),Vt=arguments.length,zt=xb(1<Vt?arguments[1]:void 0,j);for(j=(Vt=2<Vt?arguments[2]:void 0)===void 0?j:xb(Vt,j);j>zt;)e[zt++]=_;return e},Zv=Hd.f,$v=Ra.f,Me=Za.get,uo=Za.set,bc=y.ArrayBuffer,Ab=bc,cc=y.DataView,eh=cc&&cc.prototype,vo=Object.prototype,fh=y.RangeError,wo=function(_,e,j){var Vt,zt=Array(j),_r=(1<<(j=8*j-e-1))-1,_o=_r>>1,ga=e===23?Ic(2,-24)-Ic(2,-77):0,_a=0>_||_===0&&0>1/_?1:0,_l=0;if((_=Vv(_))!=_||_===1/0){_=_!=_?1:0;var _d=_r}else _d=Wv(Xv(_)/Yv),1>_*(Vt=Ic(2,-_d))&&(_d--,Vt*=2),2<=(_=1<=_d+_o?_+ga/Vt:_+ga*Ic(2,1-_o))*Vt&&(_d++,Vt/=2),_d+_o>=_r?(_=0,_d=_r):1<=_d+_o?(_=(_*Vt-1)*Ic(2,e),_d+=_o):(_=_*Ic(2,_o-1)*Ic(2,e),_d=0);for(;8<=e;zt[_l++]=255&_,_/=256,e-=8);for(_d=_d<<e|_,j+=e;0<j;zt[_l++]=255&_d,_d/=256,j-=8);return zt[--_l]|=128*_a,zt},xo=function(_,e){var j=_.length,Vt=8*j-e-1,zt=(1<<Vt)-1,_r=zt>>1;Vt-=7,--j;var _o=_[j--],ga=127&_o;for(_o>>=7;0<Vt;ga=256*ga+_[j],j--,Vt-=8);var _a=ga&(1<<-Vt)-1;for(ga>>=-Vt,Vt+=e;0<Vt;_a=256*_a+_[j],j--,Vt-=8);if(ga===0)ga=1-_r;else{if(ga===zt)return _a?NaN:_o?-1/0:1/0;_a+=Ic(2,e),ga-=_r}return(_o?-1:1)*_a*Ic(2,ga-e)},yo=function(_){return[255&_]},zo=function(_){return[255&_,_>>8&255]},Ao=function(_){return[255&_,_>>8&255,_>>16&255,_>>24&255]},Bo=function(_){return _[3]<<24|_[2]<<16|_[1]<<8|_[0]},aw=function(_){return wo(_,23,4)},bw=function(_){return wo(_,52,8)},gh=function(_,e){$v(_.prototype,e,{get:function(){return Me(this)[e]}})},md=function(_,e,j,Vt){j=Le(j);var zt=Me(_);if(j+e>zt.byteLength)throw fh("Wrong index");return _=Me(zt.buffer).bytes,j+=zt.byteOffset,e=_.slice(j,j+e),Vt?e:e.reverse()},nd=function(_,e,j,Vt,zt,_r){j=Le(j);var _o=Me(_);if(j+e>_o.byteLength)throw fh("Wrong index");for(_=Me(_o.buffer).bytes,j+=_o.byteOffset,Vt=Vt(+zt),zt=0;zt<e;zt++)_[j+zt]=Vt[_r?zt:e-zt-1]};if(to){if(!R(function(){bc(1)})||!R(function(){new bc(-1)})||R(function(){return new bc,new bc(1.5),new bc(NaN),bc.name!="ArrayBuffer"})){Ab=function(_){return Gc(this,Ab),new bc(Le(_))};for(var cw=Ab.prototype=bc.prototype,Co=Zv(bc),Do=0,zj;Co.length>Do;)(zj=Co[Do++])in Ab||Na(Ab,zj,bc[zj]);cw.constructor=Ab}Ua&&Vb(eh)!==vo&&Ua(eh,vo);var hh=new cc(new Ab(2)),Eo=eh.setInt8;hh.setInt8(0,2147483648),hh.setInt8(1,2147483649),!hh.getInt8(0)&&hh.getInt8(1)||Hf(eh,{setInt8:function(_,e){Eo.call(this,_,e<<24>>24)},setUint8:function(_,e){Eo.call(this,_,e<<24>>24)}},{unsafe:!0})}else Ab=function(_){Gc(this,Ab,"ArrayBuffer"),_=Le(_),uo(this,{bytes:yj.call(Array(_),0),byteLength:_}),ka||(this.byteLength=_)},cc=function(_,e,j){Gc(this,cc,"DataView"),Gc(_,Ab,"DataView");var Vt=Me(_).byteLength;if(0>(e=$b(e))||e>Vt)throw fh("Wrong offset");if(e+(j=j===void 0?Vt-e:ta(j))>Vt)throw fh("Wrong length");uo(this,{buffer:_,byteLength:j,byteOffset:e}),ka||(this.buffer=_,this.byteLength=j,this.byteOffset=e)},ka&&(gh(Ab,"byteLength"),gh(cc,"buffer"),gh(cc,"byteLength"),gh(cc,"byteOffset")),Hf(cc.prototype,{getInt8:function(_){return md(this,1,_)[0]<<24>>24},getUint8:function(_){return md(this,1,_)[0]},getInt16:function(_){var e=md(this,2,_,1<arguments.length?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(_){var e=md(this,2,_,1<arguments.length?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(_){return Bo(md(this,4,_,1<arguments.length?arguments[1]:void 0))},getUint32:function(_){return Bo(md(this,4,_,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(_){return xo(md(this,4,_,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(_){return xo(md(this,8,_,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(_,e){nd(this,1,_,yo,e)},setUint8:function(_,e){nd(this,1,_,yo,e)},setInt16:function(_,e){nd(this,2,_,zo,e,2<arguments.length?arguments[2]:void 0)},setUint16:function(_,e){nd(this,2,_,zo,e,2<arguments.length?arguments[2]:void 0)},setInt32:function(_,e){nd(this,4,_,Ao,e,2<arguments.length?arguments[2]:void 0)},setUint32:function(_,e){nd(this,4,_,Ao,e,2<arguments.length?arguments[2]:void 0)},setFloat32:function(_,e){nd(this,4,_,aw,e,2<arguments.length?arguments[2]:void 0)},setFloat64:function(_,e){nd(this,8,_,bw,e,2<arguments.length?arguments[2]:void 0)}});Ec(Ab,"ArrayBuffer"),Ec(cc,"DataView");var Pf={ArrayBuffer:Ab,DataView:cc},Aj=Pf.ArrayBuffer,Fo=Pf.DataView,Go=Aj.prototype.slice,dw=R(function(){return!new Aj(2).slice(1,void 0).byteLength});N({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:dw},{slice:function(_,e){if(Go!==void 0&&e===void 0)return Go.call(va(this),_);var j=va(this).byteLength;_=xb(_,j),e=xb(e===void 0?j:e,j),j=new(kd(this,Aj))(ta(e-_));for(var Vt=new Fo(this),zt=new Fo(j),_r=0;_<e;)zt.setUint8(_r++,Vt.getUint8(_++));return j}});var ew=Ra.f,ih=y.Int8Array,Bj=ih&&ih.prototype,Ho=y.Uint8ClampedArray,Io=Ho&&Ho.prototype,qc=ih&&Vb(ih),dc=Bj&&Vb(Bj),Jo=Object.prototype,Ko=Jo.isPrototypeOf,Lo=qa("toStringTag"),Cj=Ae("TYPED_ARRAY_TAG"),Jc=to&&!!Ua&&Ff(y.opera)!=="Opera",Mo=!1,Bb,rc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},fw={BigInt64Array:8,BigUint64Array:8},jh=function(_){return!!ha(_)&&(_=Ff(_),Q(rc,_)||Q(fw,_))};for(Bb in rc)y[Bb]||(Jc=!1);if((!Jc||typeof qc!="function"||qc===Function.prototype)&&(qc=function(){throw TypeError("Incorrect invocation")},Jc))for(Bb in rc)y[Bb]&&Ua(y[Bb],qc);if((!Jc||!dc||dc===Jo)&&(dc=qc.prototype,Jc))for(Bb in rc)y[Bb]&&Ua(y[Bb].prototype,dc);if(Jc&&Vb(Io)!==dc&&Ua(Io,dc),ka&&!Q(dc,Lo))for(Bb in Mo=!0,ew(dc,Lo,{get:function(){return ha(this)?this[Cj]:void 0}}),rc)y[Bb]&&Na(y[Bb],Cj,Bb);var Qf=Jc,No=Mo&&Cj,Da=function(_){if(jh(_))return _;throw TypeError("Target is not a typed array")},Ne=function(_){if(Ua){if(Ko.call(qc,_))return _}else for(var e in rc)if(Q(rc,Bb)){var j=y[e];if(j&&(_===j||Ko.call(j,_)))return _}throw TypeError("Target is not a typed array constructor")},Aa=function(_,e,j){if(ka){if(j)for(var Vt in rc){var zt=y[Vt];if(zt&&Q(zt.prototype,_))try{delete zt.prototype[_]}catch{}}dc[_]&&!j||Ta(dc,_,j?e:Jc&&Bj[_]||e)}},Oo=function(_,e,j){var Vt,zt;if(ka){if(Ua){if(j){for(Vt in rc)if((zt=y[Vt])&&Q(zt,_))try{delete zt[_]}catch{}}if(qc[_]&&!j)return;try{return Ta(qc,_,j?e:Jc&&qc[_]||e)}catch{}}for(Vt in rc)!(zt=y[Vt])||zt[_]&&!j||Ta(zt,_,e)}},Po=qc,Rf=dc,gw=y.ArrayBuffer,Od=y.Int8Array,Dj=!Qf||!R(function(){Od(1)})||!R(function(){new Od(-1)})||!Tg(function(_){new Od,new Od(null),new Od(1.5),new Od(_)},!0)||R(function(){return new Od(new gw(2),1,void 0).length!==1}),kh=function(_,e){if(0>(_=$b(_)))throw RangeError("The argument can't be less than 0");if(_%e)throw RangeError("Wrong offset");return _},Ej=function(_){var e=Qa(_),j=arguments.length,Vt=1<j?arguments[1]:void 0,zt=Vt!==void 0,_r=Xi(e);if(_r!=null&&!Vi(_r)){var _o=_r.call(e),ga=_o.next;for(e=[];!(_r=ga.call(_o)).done;)e.push(_r.value)}for(zt&&2<j&&(Vt=Id(Vt,arguments[2],2)),_r=ta(e.length),_o=new(Ne(this))(_r),j=0;_r>j;j++)_o[j]=zt?Vt(e[j],j):e[j];return _o},lh=function(_,e,j){var Vt,zt;return Ua&&typeof(Vt=e.constructor)=="function"&&Vt!==j&&ha(zt=Vt.prototype)&&zt!==j.prototype&&Ua(_,zt),_},Sf=$a(function(_){var e=Hd.f,j=Za.get,Vt=Za.set,zt=Ra.f,_r=Fb.f,_o=Math.round,ga=y.RangeError,_a=Pf.ArrayBuffer,_l=Pf.DataView,_d=function(dE,nE){var sE=0,lE=nE.length;for(dE=new(Ne(dE))(lE);lE>sE;)dE[sE]=nE[sE++];return dE},_f=function(dE,nE){zt(dE,nE,{get:function(){return j(this)[nE]}})},_m=function(dE){var nE;return dE instanceof _a||(nE=Ff(dE))=="ArrayBuffer"||nE=="SharedArrayBuffer"},tE=function(dE,nE){return jh(dE)&&typeof nE!="symbol"&&nE in dE&&String(+nE)==String(nE)},rE=function(dE,nE){return tE(dE,nE=lc(nE,!0))?dd(2,dE[nE]):_r(dE,nE)},oE=function(dE,nE,sE){return!(tE(dE,nE=lc(nE,!0))&&ha(sE)&&Q(sE,"value"))||Q(sE,"get")||Q(sE,"set")||sE.configurable||Q(sE,"writable")&&!sE.writable||Q(sE,"enumerable")&&!sE.enumerable?zt(dE,nE,sE):(dE[nE]=sE.value,dE)};ka?(Qf||(Fb.f=rE,Ra.f=oE,_f(Rf,"buffer"),_f(Rf,"byteOffset"),_f(Rf,"byteLength"),_f(Rf,"length")),N({target:"Object",stat:!0,forced:!Qf},{getOwnPropertyDescriptor:rE,defineProperty:oE}),_.exports=function(dE,nE,sE){var lE=dE.match(/\d+$/)[0]/8,EE=dE+(sE?"Clamped":"")+"Array",wE="get"+dE,IE="set"+dE,_E=y[EE],kE=_E;dE=kE&&kE.prototype;var ME={},bE=function(LE,TE){zt(LE,TE,{get:function(){var OE=j(this);return OE.view[wE](TE*lE+OE.byteOffset,!0)},set:function(OE){var vE=j(this);sE&&(OE=0>(OE=_o(OE))?0:255<OE?255:255&OE),vE.view[IE](TE*lE+vE.byteOffset,OE,!0)},enumerable:!0})};Qf?Dj&&(kE=nE(function(LE,TE,OE,vE){return Gc(LE,kE,EE),lh(ha(TE)?_m(TE)?vE!==void 0?new _E(TE,kh(OE,lE),vE):OE!==void 0?new _E(TE,kh(OE,lE)):new _E(TE):jh(TE)?_d(kE,TE):Ej.call(kE,TE):new _E(Le(TE)),LE,kE)}),Ua&&Ua(kE,Po),Jd(e(_E),function(LE){LE in kE||Na(kE,LE,_E[LE])}),kE.prototype=dE):(kE=nE(function(LE,TE,OE,vE){Gc(LE,kE,EE);var NE=0,jE=0;if(ha(TE)){if(!_m(TE))return jh(TE)?_d(kE,TE):Ej.call(kE,TE);var UE=TE;if(jE=kh(OE,lE),TE=TE.byteLength,vE===void 0){if(TE%lE||0>(vE=TE-jE))throw ga("Wrong length")}else if((vE=ta(vE)*lE)+jE>TE)throw ga("Wrong length");TE=vE/lE}else TE=Le(TE),UE=new _a(vE=TE*lE);for(Vt(LE,{buffer:UE,byteOffset:jE,byteLength:vE,length:TE,view:new _l(UE)});NE<TE;)bE(LE,NE++)}),Ua&&Ua(kE,Po),dE=kE.prototype=ac(Rf)),dE.constructor!==kE&&Na(dE,"constructor",kE),No&&Na(dE,No,EE),ME[EE]=kE,N({global:!0,forced:kE!=_E,sham:!Qf},ME),"BYTES_PER_ELEMENT"in kE||Na(kE,"BYTES_PER_ELEMENT",lE),"BYTES_PER_ELEMENT"in dE||Na(dE,"BYTES_PER_ELEMENT",lE),If(EE)}):_.exports=function(){}});Sf("Uint8",function(_){return function(e,j,Vt){return _(this,e,j,Vt)}});var hw=Math.min,iw=[].copyWithin||function(_,e){var j=Qa(this),Vt=ta(j.length),zt=xb(_,Vt),_r=xb(e,Vt),_o=2<arguments.length?arguments[2]:void 0;for(Vt=hw((_o===void 0?Vt:xb(_o,Vt))-_r,Vt-zt),_o=1,_r<zt&&zt<_r+Vt&&(_o=-1,_r+=Vt-1,zt+=Vt-1);0<Vt--;)_r in j?j[zt]=j[_r]:delete j[zt],zt+=_o,_r+=_o;return j};Aa("copyWithin",function(_,e){return iw.call(Da(this),_,e,2<arguments.length?arguments[2]:void 0)}),Aa("every",function(_){return Ju(Da(this),_,1<arguments.length?arguments[1]:void 0)}),Aa("fill",function(_){return yj.apply(Da(this),arguments)}),Aa("filter",function(_){var e=yn(Da(this),_,1<arguments.length?arguments[1]:void 0),j=kd(this,this.constructor),Vt=0,zt=e.length;for(j=new(Ne(j))(zt);zt>Vt;)j[Vt]=e[Vt++];return j}),Aa("find",function(_){return zn(Da(this),_,1<arguments.length?arguments[1]:void 0)}),Aa("findIndex",function(_){return An(Da(this),_,1<arguments.length?arguments[1]:void 0)}),Aa("forEach",function(_){Jd(Da(this),_,1<arguments.length?arguments[1]:void 0)}),Aa("includes",function(_){return on(Da(this),_,1<arguments.length?arguments[1]:void 0)}),Aa("indexOf",function(_){return Si(Da(this),_,1<arguments.length?arguments[1]:void 0)});var Qo=qa("iterator"),Ro=y.Uint8Array,jw=ld.values,kw=ld.keys,lw=ld.entries,Fj=Ro&&Ro.prototype[Qo],So=!!Fj&&(Fj.name=="values"||Fj.name==null),To=function(){return jw.call(Da(this))};Aa("entries",function(){return lw.call(Da(this))}),Aa("keys",function(){return kw.call(Da(this))}),Aa("values",To,!So),Aa(Qo,To,!So);var mw=[].join;Aa("join",function(_){return mw.apply(Da(this),arguments)});var nw=Math.min,Gj=[].lastIndexOf,Uo=!!Gj&&0>1/[1].lastIndexOf(1,-0),ow=Ee("lastIndexOf"),pw=Uo||!ow?function(_){if(Uo)return Gj.apply(this,arguments)||0;var e=qb(this),j=ta(e.length),Vt=j-1;for(1<arguments.length&&(Vt=nw(Vt,$b(arguments[1]))),0>Vt&&(Vt=j+Vt);0<=Vt;Vt--)if(Vt in e&&e[Vt]===_)return Vt||0;return-1}:Gj;Aa("lastIndexOf",function(_){return pw.apply(Da(this),arguments)}),Aa("map",function(_){return xn(Da(this),_,1<arguments.length?arguments[1]:void 0,function(e,j){return new(Ne(kd(e,e.constructor)))(j)})});var Vo=function(_){return function(e,j,Vt,zt){yb(j),e=Qa(e);var _r=Af(e),_o=ta(e.length),ga=_?_o-1:0,_a=_?-1:1;if(2>Vt)for(;;){if(ga in _r){zt=_r[ga],ga+=_a;break}if(ga+=_a,_?0>ga:_o<=ga)throw TypeError("Reduce of empty array with no initial value")}for(;_?0<=ga:_o>ga;ga+=_a)ga in _r&&(zt=j(zt,_r[ga],ga,e));return zt}},Wo=Vo(!1),qw=Vo(!0);Aa("reduce",function(_){return Wo(Da(this),_,arguments.length,1<arguments.length?arguments[1]:void 0)}),Aa("reduceRight",function(_){return qw(Da(this),_,arguments.length,1<arguments.length?arguments[1]:void 0)});var rw=Math.floor;Aa("reverse",function(){for(var _,e=Da(this).length,j=rw(e/2),Vt=0;Vt<j;)_=this[Vt],this[Vt++]=this[--e],this[e]=_;return this});var sw=R(function(){new Int8Array(1).set({})});Aa("set",function(_){Da(this);var e=kh(1<arguments.length?arguments[1]:void 0,1),j=this.length,Vt=Qa(_),zt=ta(Vt.length),_r=0;if(zt+e>j)throw RangeError("Wrong length");for(;_r<zt;)this[e+_r]=Vt[_r++]},sw);var tw=[].slice,uw=R(function(){new Int8Array(1).slice()});Aa("slice",function(_,e){_=tw.call(Da(this),_,e);var j=kd(this,this.constructor);e=0;var Vt=_.length;for(j=new(Ne(j))(Vt);Vt>e;)j[e]=_[e++];return j},uw),Aa("some",function(_){return Iu(Da(this),_,1<arguments.length?arguments[1]:void 0)});var vw=[].sort;Aa("sort",function(_){return vw.call(Da(this),_)}),Aa("subarray",function(_,e){var j=Da(this),Vt=j.length;return _=xb(_,Vt),new(kd(j,j.constructor))(j.buffer,j.byteOffset+_*j.BYTES_PER_ELEMENT,ta((e===void 0?Vt:xb(e,Vt))-_))});var mh=y.Int8Array,Xo=[].toLocaleString,ww=[].slice,xw=!!mh&&R(function(){Xo.call(new mh(1))}),yw=R(function(){return[1,2].toLocaleString()!=new mh([1,2]).toLocaleString()})||!R(function(){mh.prototype.toLocaleString.call([1,2])});Aa("toLocaleString",function(){return Xo.apply(xw?ww.call(Da(this)):Da(this),arguments)},yw);var Yo=y.Uint8Array,zw=Yo&&Yo.prototype||{},nh=[].toString,Aw=[].join;R(function(){nh.call({})})&&(nh=function(){return Aw.call(this)}),Aa("toString",nh,zw.toString!=nh);var Zo=Pf.ArrayBuffer;N({global:!0,forced:y.ArrayBuffer!==Zo},{ArrayBuffer:Zo}),If("ArrayBuffer");var Bw=Ra.f,Hj=Function.prototype,Cw=Hj.toString,Dw=/^\s*function ([^ (]*)/;!ka||"name"in Hj||Bw(Hj,"name",{configurable:!0,get:function(){try{return Cw.call(this).match(Dw)[1]}catch{return""}}});var $o=RegExp.prototype,ap=$o.toString,Ew=R(function(){return ap.call({source:"a",flags:"b"})!="/a/b"}),Fw=ap.name!="toString";(Ew||Fw)&&Ta(RegExp.prototype,"toString",function(){var _=va(this),e=String(_.source),j=_.flags;return"/"+e+"/"+(_=String(j===void 0&&_ instanceof RegExp&&!("flags"in $o)?tj.call(_):j))},{unsafe:!0});var Gw=Ef("splice"),Hw=Math.max,Iw=Math.min;N({target:"Array",proto:!0,forced:!Gw},{splice:function(_,e){var j,Vt,zt=Qa(this),_r=ta(zt.length),_o=xb(_,_r),ga=arguments.length;if(ga===0?ga=j=0:ga===1?(ga=0,j=_r-_o):(ga-=2,j=Iw(Hw($b(e),0),_r-_o)),9007199254740991<_r+ga-j)throw TypeError("Maximum allowed length exceeded");var _a=Sg(zt,j);for(Vt=0;Vt<j;Vt++){var _l=_o+Vt;_l in zt&&Ge(_a,Vt,zt[_l])}if(_a.length=j,ga<j){for(Vt=_o;Vt<_r-j;Vt++){var _d=Vt+ga;(_l=Vt+j)in zt?zt[_d]=zt[_l]:delete zt[_d]}for(Vt=_r;Vt>_r-j+ga;Vt--)delete zt[Vt-1]}else if(ga>j)for(Vt=_r-j;Vt>_o;Vt--)_d=Vt+ga-1,(_l=Vt+j-1)in zt?zt[_d]=zt[_l]:delete zt[_d];for(Vt=0;Vt<ga;Vt++)zt[Vt+_o]=arguments[Vt+2];return zt.length=_r-j+ga,_a}});var Ij={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Jj=qa("iterator"),bp=qa("toStringTag"),Kj=ld.values,oh;for(oh in Ij){var cp=y[oh],Kc=cp&&cp.prototype;if(Kc){if(Kc[Jj]!==Kj)try{Na(Kc,Jj,Kj)}catch{Kc[Jj]=Kj}if(Kc[bp]||Na(Kc,bp,oh),Ij[oh]){for(var Oe in ld)if(Kc[Oe]!==ld[Oe])try{Na(Kc,Oe,ld[Oe])}catch{Kc[Oe]=ld[Oe]}}}}var dp=Object.is||function(_,e){return _===e?_!==0||1/_==1/e:_!=_&&e!=e};dh("search",1,function(_,e,j){return[function(Vt){var zt=jb(this),_r=Vt==null?void 0:Vt[_];return _r!==void 0?_r.call(Vt,zt):new RegExp(Vt)[_](String(zt))},function(Vt){var zt=j(e,Vt,this);if(zt.done)return zt.value;Vt=va(Vt);var _r=String(this);return zt=Vt.lastIndex,dp(zt,0)||(Vt.lastIndex=0),_r=Ke(Vt,_r),dp(Vt.lastIndex,zt)||(Vt.lastIndex=zt),_r===null?-1:_r.index}]}),$a(function(_){(function(e,j){_.exports?_.exports=j(e):j(e)})(typeof self<"u"?self:Ya,function(e){function j(bE){return btoa(bE).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function Vt(bE){return bE=(bE+="===").slice(0,-bE.length%4),atob(bE.replace(/-/g,"+").replace(/_/g,"/"))}function zt(bE){for(var LE=new Uint8Array(bE.length),TE=0;TE<bE.length;TE++)LE[TE]=bE.charCodeAt(TE);return LE}function _r(bE){return bE instanceof ArrayBuffer&&(bE=new Uint8Array(bE)),String.fromCharCode.apply(String,bE)}function _o(bE){var LE={name:(bE.name||bE||"").toUpperCase().replace("V","v")};switch(LE.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":bE.length&&(LE.length=bE.length);break;case"HMAC":bE.hash&&(LE.hash=_o(bE.hash)),bE.length&&(LE.length=bE.length);break;case"RSAES-PKCS1-v1_5":bE.publicExponent&&(LE.publicExponent=new Uint8Array(bE.publicExponent)),bE.modulusLength&&(LE.modulusLength=bE.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":bE.hash&&(LE.hash=_o(bE.hash)),bE.publicExponent&&(LE.publicExponent=new Uint8Array(bE.publicExponent)),bE.modulusLength&&(LE.modulusLength=bE.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return LE}function ga(bE){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[bE.name][(bE.hash||{}).name||bE.length||""]}function _a(bE){(bE instanceof ArrayBuffer||bE instanceof Uint8Array)&&(bE=JSON.parse(decodeURIComponent(escape(_r(bE)))));var LE={kty:bE.kty,alg:bE.alg,ext:bE.ext||bE.extractable};switch(LE.kty){case"oct":LE.k=bE.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(TE){TE in bE&&(LE[TE]=bE[TE])});break;default:throw new TypeError("Unsupported key type")}return LE}function _l(bE){return bE=_a(bE),wE&&(bE.extractable=bE.ext,delete bE.ext),zt(unescape(encodeURIComponent(JSON.stringify(bE)))).buffer}function _d(bE){var LE=_f(bE),TE=!1;switch(2<LE.length&&(TE=!0,LE.shift()),bE={ext:!0},LE[0][0]){case"1.2.840.113549.1.1.1":var OE="n e d p q dp dq qi".split(" ");for(LE=_f(LE[1]),TE&&LE.shift(),TE=0;TE<LE.length;TE++)LE[TE][0]||(LE[TE]=LE[TE].subarray(1)),bE[OE[TE]]=j(_r(LE[TE]));bE.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return bE}function _f(bE,LE){if(bE instanceof ArrayBuffer&&(bE=new Uint8Array(bE)),LE||(LE={pos:0,end:bE.length}),2>LE.end-LE.pos||LE.end>bE.length)throw new RangeError("Malformed DER");var TE=bE[LE.pos++],OE=bE[LE.pos++];if(128<=OE){if(OE&=127,LE.end-LE.pos<OE)throw new RangeError("Malformed DER");for(var vE=0;OE--;)vE<<=8,vE|=bE[LE.pos++];OE=vE}if(LE.end-LE.pos<OE)throw new RangeError("Malformed DER");switch(TE){case 2:TE=bE.subarray(LE.pos,LE.pos+=OE);break;case 3:if(bE[LE.pos++])throw Error("Unsupported bit string");OE--;case 4:TE=new Uint8Array(bE.subarray(LE.pos,LE.pos+=OE)).buffer;break;case 5:TE=null;break;case 6:if(!((bE=btoa(_r(bE.subarray(LE.pos,LE.pos+=OE))))in _E))throw Error("Unsupported OBJECT ID "+bE);TE=_E[bE];break;case 48:for(TE=[],OE=LE.pos+OE;LE.pos<OE;)TE.push(_f(bE,LE));break;default:throw Error("Unsupported DER tag 0x"+TE.toString(16))}return TE}function _m(bE,LE){LE||(LE=[]);var TE=LE.length+2;if(LE.push(0,0),bE instanceof Uint8Array)for(var OE=2,vE=bE.length,NE=0;NE<vE;NE++)LE.push(bE[NE]);else if(bE instanceof ArrayBuffer)for(OE=4,vE=bE.byteLength,bE=new Uint8Array(bE),NE=0;NE<vE;NE++)LE.push(bE[NE]);else if(bE===null)OE=5,vE=0;else if(typeof bE=="string"&&bE in kE)for(OE=6,vE=(bE=zt(atob(kE[bE]))).length,NE=0;NE<vE;NE++)LE.push(bE[NE]);else if(bE instanceof Array){for(NE=0;NE<bE.length;NE++)_m(bE[NE],LE);OE=48,vE=LE.length-TE}else{if(!(X(bE)==="object"&&bE.tag===3&&bE.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+bE);for(OE=3,vE=(bE=new Uint8Array(bE.value)).byteLength,LE.push(0),NE=0;NE<vE;NE++)LE.push(bE[NE]);vE++}if(128<=vE){for(NE=vE,vE=4,LE.splice(TE,0,NE>>24&255,NE>>16&255,NE>>8&255,255&NE);1<vE&&!(NE>>24);)NE<<=8,vE--;4>vE&&LE.splice(TE,4-vE),vE|=128}return LE.splice(TE-2,2,OE,vE),LE}function tE(bE,LE,TE,OE){Object.defineProperties(this,{_key:{value:bE},type:{value:bE.type,enumerable:!0},extractable:{value:TE===void 0?bE.extractable:TE,enumerable:!0},algorithm:{value:LE===void 0?bE.algorithm:LE,enumerable:!0},usages:{value:OE===void 0?bE.usages:OE,enumerable:!0}})}function rE(bE){return bE==="verify"||bE==="encrypt"||bE==="wrapKey"}function oE(bE){return bE==="sign"||bE==="decrypt"||bE==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var dE=e.crypto||e.msCrypto;if(dE){var nE=dE.subtle||dE.webkitSubtle;if(nE){var sE=e.Crypto||dE.constructor||Object,lE=e.SubtleCrypto||nE.constructor||Object;e.CryptoKey||e.Key;var EE=-1<e.navigator.userAgent.indexOf("Edge/"),wE=!!e.msCrypto&&!EE,IE=!dE.subtle&&!!dE.webkitSubtle;if(wE||IE){var _E={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},kE={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(bE){var LE=nE[bE];nE[bE]=function(TE,OE,vE){var NE=[].slice.call(arguments);switch(bE){case"generateKey":var jE=_o(TE),UE=OE,RE=vE;break;case"importKey":jE=_o(vE),UE=NE[3],RE=NE[4],TE==="jwk"&&((OE=_a(OE)).alg||(OE.alg=ga(jE)),OE.key_ops||(OE.key_ops=OE.kty!=="oct"?"d"in OE?RE.filter(oE):RE.filter(rE):RE.slice()),NE[1]=_l(OE));break;case"unwrapKey":jE=NE[4],UE=NE[5],RE=NE[6],NE[2]=vE._key}if(bE==="generateKey"&&jE.name==="HMAC"&&jE.hash)return jE.length=jE.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[jE.hash.name],nE.importKey("raw",dE.getRandomValues(new Uint8Array(jE.length+7>>3)),jE,UE,RE);if(IE&&bE==="generateKey"&&jE.name==="RSASSA-PKCS1-v1_5"&&(!jE.modulusLength||2048<=jE.modulusLength))return(TE=_o(TE)).name="RSAES-PKCS1-v1_5",delete TE.hash,nE.generateKey(TE,!0,["encrypt","decrypt"]).then(function(VE){return Promise.all([nE.exportKey("jwk",VE.publicKey),nE.exportKey("jwk",VE.privateKey)])}).then(function(VE){return VE[0].alg=VE[1].alg=ga(jE),VE[0].key_ops=RE.filter(rE),VE[1].key_ops=RE.filter(oE),Promise.all([nE.importKey("jwk",VE[0],jE,!0,VE[0].key_ops),nE.importKey("jwk",VE[1],jE,UE,VE[1].key_ops)])}).then(function(VE){return{publicKey:VE[0],privateKey:VE[1]}});if((IE||wE&&(jE.hash||{}).name==="SHA-1")&&bE==="importKey"&&TE==="jwk"&&jE.name==="HMAC"&&OE.kty==="oct")return nE.importKey("raw",zt(Vt(OE.k)),vE,NE[3],NE[4]);if(IE&&bE==="importKey"&&(TE==="spki"||TE==="pkcs8"))return nE.importKey("jwk",_d(OE),vE,NE[3],NE[4]);if(wE&&bE==="unwrapKey")return nE.decrypt(NE[3],vE,OE).then(function(VE){return nE.importKey(TE,VE,NE[4],NE[5],NE[6])});try{var FE=LE.apply(nE,NE)}catch(VE){return Promise.reject(VE)}return wE&&(FE=new Promise(function(VE,BE){FE.onabort=FE.onerror=function(qE){BE(qE)},FE.oncomplete=function(qE){VE(qE.target.result)}})),FE=FE.then(function(VE){return jE.name!=="HMAC"||jE.length||(jE.length=8*VE.algorithm.length),jE.name.search("RSA")==0&&(jE.modulusLength||(jE.modulusLength=(VE.publicKey||VE).algorithm.modulusLength),jE.publicExponent||(jE.publicExponent=(VE.publicKey||VE).algorithm.publicExponent)),VE.publicKey&&VE.privateKey?{publicKey:new tE(VE.publicKey,jE,UE,RE.filter(rE)),privateKey:new tE(VE.privateKey,jE,UE,RE.filter(oE))}:new tE(VE,jE,UE,RE)})}}),["exportKey","wrapKey"].forEach(function(bE){var LE=nE[bE];nE[bE]=function(TE,OE,vE){var NE=[].slice.call(arguments);switch(bE){case"exportKey":NE[1]=OE._key;break;case"wrapKey":NE[1]=OE._key,NE[2]=vE._key}if((IE||wE&&(OE.algorithm.hash||{}).name==="SHA-1")&&bE==="exportKey"&&TE==="jwk"&&OE.algorithm.name==="HMAC"&&(NE[0]="raw"),!IE||bE!=="exportKey"||TE!=="spki"&&TE!=="pkcs8"||(NE[0]="jwk"),wE&&bE==="wrapKey")return nE.exportKey(TE,OE).then(function(UE){return TE==="jwk"&&(UE=zt(unescape(encodeURIComponent(JSON.stringify(_a(UE)))))),nE.encrypt(NE[3],vE,UE)});try{var jE=LE.apply(nE,NE)}catch(UE){return Promise.reject(UE)}return wE&&(jE=new Promise(function(UE,RE){jE.onabort=jE.onerror=function(FE){RE(FE)},jE.oncomplete=function(FE){UE(FE.target.result)}})),bE==="exportKey"&&TE==="jwk"&&(jE=jE.then(function(UE){return(IE||wE&&(OE.algorithm.hash||{}).name==="SHA-1")&&OE.algorithm.name==="HMAC"?{kty:"oct",alg:ga(OE.algorithm),key_ops:OE.usages.slice(),ext:!0,k:j(_r(UE))}:((UE=_a(UE)).alg||(UE.alg=ga(OE.algorithm)),UE.key_ops||(UE.key_ops=OE.type==="public"?OE.usages.filter(rE):OE.type==="private"?OE.usages.filter(oE):OE.usages.slice()),UE)})),!IE||bE!=="exportKey"||TE!=="spki"&&TE!=="pkcs8"||(jE=jE.then(function(UE){var RE=[["",null]],FE=!1;switch((UE=_a(UE)).kty){case"RSA":for(var VE="n e d p q dp dq qi".split(" "),BE=[],qE=0;qE<VE.length&&VE[qE]in UE;qE++){var e_=BE[qE]=zt(Vt(UE[VE[qE]]));128&e_[0]&&(BE[qE]=new Uint8Array(e_.length+1),BE[qE].set(e_,1))}2<BE.length&&(FE=!0,BE.unshift(new Uint8Array([0]))),RE[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return RE.push(new Uint8Array(_m(BE)).buffer),FE?RE.unshift(new Uint8Array([0])):RE[1]={tag:3,value:RE[1]},new Uint8Array(_m(RE)).buffer})),jE}}),["encrypt","decrypt","sign","verify"].forEach(function(bE){var LE=nE[bE];nE[bE]=function(TE,OE,vE,NE){if(wE&&(!vE.byteLength||NE&&!NE.byteLength))throw Error("Empty input is not allowed");var jE=[].slice.call(arguments),UE=_o(TE);if(!wE||bE!=="sign"&&bE!=="verify"||TE!=="RSASSA-PKCS1-v1_5"&&TE!=="HMAC"||(jE[0]={name:TE}),wE&&OE.algorithm.hash&&(jE[0].hash=jE[0].hash||OE.algorithm.hash),wE&&bE==="decrypt"&&UE.name==="AES-GCM"){var RE=TE.tagLength>>3;jE[2]=(vE.buffer||vE).slice(0,vE.byteLength-RE),TE.tag=(vE.buffer||vE).slice(vE.byteLength-RE)}wE&&UE.name==="AES-GCM"&&jE[0].tagLength===void 0&&(jE[0].tagLength=128),jE[1]=OE._key;try{var FE=LE.apply(nE,jE)}catch(VE){return Promise.reject(VE)}return wE&&(FE=new Promise(function(VE,BE){FE.onabort=FE.onerror=function(qE){BE(qE)},FE.oncomplete=function(qE){if(qE=qE.target.result,bE==="encrypt"&&qE instanceof AesGcmEncryptResult){var e_=qE.ciphertext,b_=qE.tag;(qE=new Uint8Array(e_.byteLength+b_.byteLength)).set(new Uint8Array(e_),0),qE.set(new Uint8Array(b_),e_.byteLength),qE=qE.buffer}VE(qE)}})),FE}}),wE){var ME=nE.digest;nE.digest=function(bE,LE){if(!LE.byteLength)throw Error("Empty input is not allowed");try{var TE=ME.call(nE,bE,LE)}catch(OE){return Promise.reject(OE)}return TE=new Promise(function(OE,vE){TE.onabort=TE.onerror=function(NE){vE(NE)},TE.oncomplete=function(NE){OE(NE.target.result)}})},e.crypto=Object.create(dE,{getRandomValues:{value:function(bE){return dE.getRandomValues(bE)}},subtle:{value:nE}}),e.CryptoKey=tE}IE&&(dE.subtle=nE,e.Crypto=sE,e.SubtleCrypto=lE,e.CryptoKey=tE)}}}})});var Jw=qa("match"),Lj=function(_){var e;return ha(_)&&((e=_[Jw])!==void 0?!!e:Zb(_)=="RegExp")},Kw=[].push,Lw=Math.min;dh("split",2,function(_,e,j){var Vt="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(zt,_r){var _o=String(jb(this));if((_r=_r===void 0?4294967295:_r>>>0)===0)return[];if(zt===void 0)return[_o];if(!Lj(zt))return e.call(_o,zt,_r);var ga,_a,_l,_d=[],_f=0;for(zt=new RegExp(zt.source,(zt.ignoreCase?"i":"")+(zt.multiline?"m":"")+(zt.unicode?"u":"")+(zt.sticky?"y":"")+"g");(ga=Of.call(zt,_o))&&!((_a=zt.lastIndex)>_f&&(_d.push(_o.slice(_f,ga.index)),1<ga.length&&ga.index<_o.length&&Kw.apply(_d,ga.slice(1)),_l=ga[0].length,_f=_a,_d.length>=_r));)zt.lastIndex===ga.index&&zt.lastIndex++;return _f===_o.length?(_l||!zt.test(""))&&_d.push(""):_d.push(_o.slice(_f)),_d.length>_r?_d.slice(0,_r):_d}:"0".split(void 0,0).length?function(zt,_r){return zt===void 0&&_r===0?[]:e.call(this,zt,_r)}:e;return[function(zt,_r){var _o=jb(this),ga=zt==null?void 0:zt[_];return ga!==void 0?ga.call(zt,_o,_r):Vt.call(String(_o),zt,_r)},function(zt,_r){var _o=j(Vt,zt,this,_r,Vt!==e);if(_o.done)return _o.value;var ga=va(zt);zt=String(this);var _a=kd(ga,RegExp);if(_o=ga.unicode,ga=new _a(pc?"^(?:"+ga.source+")":ga,(ga.ignoreCase?"i":"")+(ga.multiline?"m":"")+(ga.unicode?"u":"")+(pc?"g":"y")),(_r=_r===void 0?4294967295:_r>>>0)===0)return[];if(zt.length===0)return Ke(ga,zt)===null?[zt]:[];var _l=0,_d=0;for(_a=[];_d<zt.length;){ga.lastIndex=pc?0:_d;var _f,_m=Ke(ga,pc?zt.slice(_d):zt);if(_m===null||(_f=Lw(ta(ga.lastIndex+(pc?_d:0)),zt.length))===_l)_d=xj(zt,_d,_o);else{if(_a.push(zt.slice(_l,_d)),_a.length===_r)return _a;for(_l=1;_l<=_m.length-1;_l++)if(_a.push(_m[_l]),_a.length===_r)return _a;_d=_l=_f}}return _a.push(zt.slice(_l)),_a}]},pc),function(_){_.console||(_.console={}),_=_.console;for(var e,j=function(){},Vt=["memory"],zt="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");e=Vt.pop();)_[e]||(_[e]={});for(;e=zt.pop();)_[e]||(_[e]=j)}(typeof window>"u"?Ya:window),N({target:"Object",stat:!0},{setPrototypeOf:Ua});var Mw=R(function(){Vb(1)});N({target:"Object",stat:!0,forced:Mw,sham:!Hn},{getPrototypeOf:function(_){return Vb(Qa(_))}});var ep=[].slice,Mj={},Nw=Function.bind||function(_){var e=yb(this),j=ep.call(arguments,1),Vt=function(){var zt=j.concat(ep.call(arguments));if(this instanceof Vt){var _r=zt.length;if(!(_r in Mj)){for(var _o=[],ga=0;ga<_r;ga++)_o[ga]="a["+ga+"]";Mj[_r]=Function("C,a","return new C("+_o.join(",")+")")}zt=Mj[_r](e,zt)}else zt=e.apply(_,zt);return zt};return ha(e.prototype)&&(Vt.prototype=e.prototype),Vt},Nj=mc("Reflect","construct"),fp=R(function(){function _(){}return!(Nj(function(){},[],_)instanceof _)}),gp=!R(function(){Nj(function(){})}),hp=fp||gp;N({target:"Reflect",stat:!0,forced:hp,sham:hp},{construct:function(_,e){yb(_),va(e);var j=3>arguments.length?_:yb(arguments[2]);if(gp&&!fp)return Nj(_,e,j);if(_==j){switch(e.length){case 0:return new _;case 1:return new _(e[0]);case 2:return new _(e[0],e[1]);case 3:return new _(e[0],e[1],e[2]);case 4:return new _(e[0],e[1],e[2],e[3])}return(j=[null]).push.apply(j,e),new(Nw.apply(_,j))}j=j.prototype,j=ac(ha(j)?j:Object.prototype);var Vt=Function.apply.call(_,j,e);return ha(Vt)?Vt:j}}),N({target:"Reflect",stat:!0},{get:wl});var ip=Fb.f,Ow=R(function(){ip(1)});N({target:"Object",stat:!0,forced:!ka||Ow,sham:!ka},{getOwnPropertyDescriptor:function(_,e){return ip(qb(_),e)}});var jp=Hd.f,Pw={}.toString,kp=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Oj=function(_){if(kp&&Pw.call(_)=="[object Window]")try{var e=jp(_)}catch{e=kp.slice()}else e=jp(qb(_));return e},lp={f:qa},Qw=Ra.f,ph=function(_){var e=y.Symbol||(y.Symbol={});Q(e,_)||Qw(e,_,{value:lp.f(_)})},rb=Pg("hidden"),mp=qa("toPrimitive"),Rw=Za.set,np=Za.getterFor("Symbol"),Ob=Object.prototype,sb=y.Symbol,Tf=mc("JSON","stringify"),op=Fb.f,od=Ra.f,pp=Oj,Sw=zf,Lc=fd("symbols"),Uf=fd("op-symbols"),Pj=fd("string-to-symbol-registry"),Qj=fd("symbol-to-string-registry"),Tw=fd("wks"),Rj=y.QObject,Sj=!Rj||!Rj.prototype||!Rj.prototype.findChild,Tj=ka&&R(function(){return ac(od({},"a",{get:function(){return od(this,"a",{value:7}).a}})).a!=7})?function(_,e,j){var Vt=op(Ob,e);Vt&&delete Ob[e],od(_,e,j),Vt&&_!==Ob&&od(Ob,e,Vt)}:od,Uj=function(_,e){var j=Lc[_]=ac(sb.prototype);return Rw(j,{type:"Symbol",tag:_,description:e}),ka||(j.description=e),j},Vj=vn?function(_){return typeof _=="symbol"}:function(_){return Object(_)instanceof sb},qh=function(_,e,j){return _===Ob&&qh(Uf,e,j),va(_),e=lc(e,!0),va(j),Q(Lc,e)?(j.enumerable?(Q(_,rb)&&_[rb][e]&&(_[rb][e]=!1),j=ac(j,{enumerable:dd(0,!1)})):(Q(_,rb)||od(_,rb,dd(1,{})),_[rb][e]=!0),Tj(_,e,j)):od(_,e,j)},qp=function(_,e){va(_);var j=qb(e);return e=Dc(j).concat(Wj(j)),Jd(e,function(Vt){ka&&!Xj.call(j,Vt)||qh(_,Vt,j[Vt])}),_},Xj=function(_){_=lc(_,!0);var e=Sw.call(this,_);return!(this===Ob&&Q(Lc,_)&&!Q(Uf,_))&&(!(e||!Q(this,_)||!Q(Lc,_)||Q(this,rb)&&this[rb][_])||e)},rp=function(_,e){if(_=qb(_),e=lc(e,!0),_!==Ob||!Q(Lc,e)||Q(Uf,e)){var j=op(_,e);return!j||!Q(Lc,e)||Q(_,rb)&&_[rb][e]||(j.enumerable=!0),j}},sp=function(_){_=pp(qb(_));var e=[];return Jd(_,function(j){Q(Lc,j)||Q(Be,j)||e.push(j)}),e},Wj=function(_){var e=_===Ob;_=pp(e?Uf:qb(_));var j=[];return Jd(_,function(Vt){!Q(Lc,Vt)||e&&!Q(Ob,Vt)||j.push(Lc[Vt])}),j};if(oc||(sb=function(){if(this instanceof sb)throw TypeError("Symbol is not a constructor");var _=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,e=Ae(_),j=function(Vt){this===Ob&&j.call(Uf,Vt),Q(this,rb)&&Q(this[rb],e)&&(this[rb][e]=!1),Tj(this,e,dd(1,Vt))};return ka&&Sj&&Tj(Ob,e,{configurable:!0,set:j}),Uj(e,_)},Ta(sb.prototype,"toString",function(){return np(this).tag}),Ta(sb,"withoutSetter",function(_){return Uj(Ae(_),_)}),zf=Xj,Ra.f=qh,Fb.f=rp,Hd.f=Oj=sp,Bf.f=Wj,lp.f=function(_){return Uj(qa(_),_)},ka&&(od(sb.prototype,"description",{configurable:!0,get:function(){return np(this).description}}),Ta(Ob,"propertyIsEnumerable",Xj,{unsafe:!0}))),N({global:!0,wrap:!0,forced:!oc,sham:!oc},{Symbol:sb}),Jd(Dc(Tw),function(_){ph(_)}),N({target:"Symbol",stat:!0,forced:!oc},{for:function(_){if(_=String(_),Q(Pj,_))return Pj[_];var e=sb(_);return Pj[_]=e,Qj[e]=_,e},keyFor:function(_){if(!Vj(_))throw TypeError(_+" is not a symbol");if(Q(Qj,_))return Qj[_]},useSetter:function(){Sj=!0},useSimple:function(){Sj=!1}}),N({target:"Object",stat:!0,forced:!oc,sham:!ka},{create:function(_,e){return e===void 0?ac(_):qp(ac(_),e)},defineProperty:qh,defineProperties:qp,getOwnPropertyDescriptor:rp}),N({target:"Object",stat:!0,forced:!oc},{getOwnPropertyNames:sp,getOwnPropertySymbols:Wj}),N({target:"Object",stat:!0,forced:R(function(){Bf.f(1)})},{getOwnPropertySymbols:function(_){return Bf.f(Qa(_))}}),Tf){var Uw=!oc||R(function(){var _=sb();return Tf([_])!="[null]"||Tf({a:_})!="{}"||Tf(Object(_))!="{}"});N({target:"JSON",stat:!0,forced:Uw},{stringify:function(_,e,j){for(var Vt,zt=[_],_r=1;arguments.length>_r;)zt.push(arguments[_r++]);if(Vt=e,(ha(e)||_!==void 0)&&!Vj(_))return gd(e)||(e=function(_o,ga){if(typeof Vt=="function"&&(ga=Vt.call(this,_o,ga)),!Vj(ga))return ga}),zt[1]=e,Tf.apply(null,zt)}})}sb.prototype[mp]||Na(sb.prototype,mp,sb.prototype.valueOf),Ec(sb,"Symbol"),Be[rb]=!0;var Vw=Ra.f,Mc=y.Symbol;if(ka&&typeof Mc=="function"&&(!("description"in Mc.prototype)||Mc().description!==void 0)){var tp={},Vf=function(){var _=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),e=this instanceof Vf?new Mc(_):_===void 0?Mc():Mc(_);return _===""&&(tp[e]=!0),e};rn(Vf,Mc);var Yj=Vf.prototype=Mc.prototype;Yj.constructor=Vf;var Ww=Yj.toString,Xw=String(Mc("test"))=="Symbol(test)",Yw=/^Symbol\((.*)\)[^)]+$/;Vw(Yj,"description",{configurable:!0,get:function(){var _=ha(this)?this.valueOf():this,e=Ww.call(_);return Q(tp,_)?"":(_=Xw?e.slice(7,-1):e.replace(Yw,"$1"))===""?void 0:_}}),N({global:!0,forced:!0},{Symbol:Vf})}ph("toStringTag"),Ec(y.JSON,"JSON",!0),Ec(Math,"Math",!0),function(){function _(_m,tE){if(!(_m instanceof tE))throw new TypeError("Cannot call a class as a function")}function e(_m,tE){for(var rE=0;rE<tE.length;rE++){var oE=tE[rE];oE.enumerable=oE.enumerable||!1,oE.configurable=!0,"value"in oE&&(oE.writable=!0),Object.defineProperty(_m,oE.key,oE)}}function j(_m,tE,rE){return tE&&e(_m.prototype,tE),_m}function Vt(_m,tE){if(typeof tE!="function"&&tE!==null)throw new TypeError("Super expression must either be null or a function");_m.prototype=Object.create(tE&&tE.prototype,{constructor:{value:_m,writable:!0,configurable:!0}}),tE&&_r(_m,tE)}function zt(_m){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(tE){return tE.__proto__||Object.getPrototypeOf(tE)})(_m)}function _r(_m,tE){return(_r=Object.setPrototypeOf||function(rE,oE){return rE.__proto__=oE,rE})(_m,tE)}function _o(_m){if(_m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _m}function ga(_m){var tE=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var rE=zt(_m);if(tE){var oE=zt(this).constructor;rE=Reflect.construct(rE,arguments,oE)}else rE=rE.apply(this,arguments);return rE=!rE||X(rE)!=="object"&&typeof rE!="function"?_o(this):rE}}function _a(_m,tE,rE){return(_a=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(oE,dE,nE){for(;!Object.prototype.hasOwnProperty.call(oE,dE)&&(oE=zt(oE))!==null;);if(oE)return(dE=Object.getOwnPropertyDescriptor(oE,dE)).get?dE.get.call(nE):dE.value})(_m,tE,rE||_m)}var _l=function(){function _m(){_(this,_m),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return j(_m,[{key:"addEventListener",value:function(tE,rE,oE){tE in this.listeners||(this.listeners[tE]=[]),this.listeners[tE].push({callback:rE,options:oE})}},{key:"removeEventListener",value:function(tE,rE){if(tE in this.listeners){for(var oE=0,dE=(tE=this.listeners[tE]).length;oE<dE;oE++)if(tE[oE].callback===rE){tE.splice(oE,1);break}}}},{key:"dispatchEvent",value:function(tE){if(tE.type in this.listeners){for(var rE=this.listeners[tE.type].slice(),oE=0,dE=rE.length;oE<dE;oE++){var nE=rE[oE];try{nE.callback.call(this,tE)}catch(sE){Promise.resolve().then(function(){throw sE})}nE.options&&nE.options.once&&this.removeEventListener(tE.type,nE.callback)}return!tE.defaultPrevented}}}]),_m}(),_d=function(_m){function tE(){_(this,tE);var oE=rE.call(this);return oE.listeners||_l.call(_o(oE)),Object.defineProperty(_o(oE),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(_o(oE),"onabort",{value:null,writable:!0,configurable:!0}),oE}Vt(tE,_m);var rE=ga(tE);return j(tE,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(oE){oE.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,oE)),_a(zt(tE.prototype),"dispatchEvent",this).call(this,oE)}}]),tE}(_l),_f=function(){function _m(){_(this,_m),Object.defineProperty(this,"signal",{value:new _d,writable:!0,configurable:!0})}return j(_m,[{key:"abort",value:function(){try{var tE=new Event("abort")}catch{typeof document<"u"?document.createEvent?(tE=document.createEvent("Event")).initEvent("abort",!1,!1):(tE=document.createEventObject()).type="abort":tE={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(tE)}},{key:"toString",value:function(){return"[object AbortController]"}}]),_m}();typeof Symbol<"u"&&Symbol.toStringTag&&(_f.prototype[Symbol.toStringTag]="AbortController",_d.prototype[Symbol.toStringTag]="AbortSignal"),function(_m){if(_m.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var tE=!0}else tE=typeof _m.Request=="function"&&!_m.Request.prototype.hasOwnProperty("signal")||!_m.AbortController;tE&&(_m.AbortController=_f,_m.AbortSignal=_d)}(typeof self<"u"?self:Ya)}();var Zw=Math.floor,$w=Math.log,ax=Math.LOG2E;N({target:"Math",stat:!0},{clz32:function(_){return(_>>>=0)?31-Zw($w(_+.5)*ax):32}});var bx=Math.log,cx=Math.LN2,ss=Math.clz32||function(_){return 31-bx(_>>>0)/cx|0},xd=String.fromCharCode,up={}.toString,Zj=window.Uint8Array,ak=Zj||Array,dx=up.call((window.ArrayBuffer||ak).prototype),bk;xl.prototype.decode=function(_){if(_=_&&_.buffer||_,up.call(_)!==dx)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var e="",j=0,Vt=0|(_=Zj?new ak(_):_).length;j<Vt;j=j+32768|0)e+=xd.apply(0,_[Zj?"slice":"subarray"](j,j+32768|0));return e.replace(/[\xc0-\xff][\x80-\xbf]*/g,rs)},window.TextDecoder||(window.TextDecoder=xl),yl.prototype.encode=function(_){for(var e=0|(_=_===void 0?"":(""+_).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,ts)).length,j=new ak(e),Vt=0;Vt<e;Vt=Vt+1|0)j[Vt]=_.charCodeAt(Vt);return j},window.TextEncoder||(window.TextEncoder=yl),function(_){var e,j,Vt,zt,_r,_o,ga,_a,_l,_d,_f;(function(_m){_m.LOGIN="LOGIN",_m.LOGIN_SUCCESS="LOGIN_SUCCESS",_m.LOGIN_FAILURE="LOGIN_FAILURE",_m.LOGIN_TIMEOUT="LOGIN_TIMEOUT",_m.INTERRUPTED="INTERRUPTED",_m.LOGOUT="LOGOUT",_m.BANNED_BY_SERVER="BANNED_BY_SERVER",_m.REMOTE_LOGIN="REMOTE_LOGIN"})(e||(e={})),_.ConnectionChangeReason=e,function(_m){_m.DISCONNECTED="DISCONNECTED",_m.CONNECTING="CONNECTING",_m.CONNECTED="CONNECTED",_m.RECONNECTING="RECONNECTING",_m.ABORTED="ABORTED"}(j||(j={})),_.ConnectionState=j,function(_m){_m.IDLE="IDLE",_m.SENT_TO_REMOTE="SENT_TO_REMOTE",_m.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",_m.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",_m.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",_m.CANCELED="CANCELED",_m.FAILURE="FAILURE"}(Vt||(Vt={})),_.LocalInvitationState=Vt,function(_m){_m.INVITATION_RECEIVED="INVITATION_RECEIVED",_m.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",_m.REFUSED="REFUSED",_m.ACCEPTED="ACCEPTED",_m.CANCELED="CANCELED",_m.FAILURE="FAILURE"}(zt||(zt={})),_.RemoteInvitationState=zt,function(_m){_m.UNKNOWN="UNKNOWN",_m.PEER_NO_RESPONSE="PEER_NO_RESPONSE",_m.INVITATION_EXPIRE="INVITATION_EXPIRE",_m.PEER_OFFLINE="PEER_OFFLINE",_m.NOT_LOGGEDIN="NOT_LOGGEDIN"}(_r||(_r={})),_.LocalInvitationFailureReason=_r,function(_m){_m.UNKNOWN="UNKNOWN",_m.PEER_OFFLINE="PEER_OFFLINE",_m.ACCEPT_FAILURE="ACCEPT_FAILURE",_m.INVITATION_EXPIRE="INVITATION_EXPIRE"}(_o||(_o={})),_.RemoteInvitationFailureReason=_o,function(_m){_m.ONLINE="ONLINE",_m.UNREACHABLE="UNREACHABLE",_m.OFFLINE="OFFLINE"}(ga||(ga={})),_.PeerOnlineState=ga,(_a||(_a={})).ONLINE_STATUS="ONLINE_STATUS",_.PeerSubscriptionOption=_a,function(_m){_m.TEXT="TEXT",_m.RAW="RAW",_m.IMAGE="IMAGE",_m.FILE="FILE"}(_l||(_l={})),_.MessageType=_l,function(_m){_m.CN="CN",_m.NA="NA",_m.EU="EU",_m.AS="AS",_m.JP="JP",_m.IN="IN",_m.GLOB="GLOB",_m.OC="OC",_m.SA="SA",_m.AF="AF",_m.OVS="OVS"}(_d||(_d={})),_.LegacyAreaCode=_d,function(_m){_m.GLOBAL="GLOBAL",_m.INDIA="INDIA",_m.JAPAN="JAPAN",_m.ASIA="ASIA",_m.EUROPE="EUROPE",_m.CHINA="CHINA",_m.NORTH_AMERICA="NORTH_AMERICA"}(_f||(_f={})),_.AreaCode=_f}(bk||(bk={}));var S=bk;N({target:"Array",proto:!0},{includes:function(_){return on(this,_,1<arguments.length?arguments[1]:void 0)}}),Ld("includes");var ck=function(_){if(Lj(_))throw TypeError("The method doesn't accept regular expressions");return _},ex=qa("match"),dk=function(_){var e=/./;try{"/./"[_](e)}catch{try{return e[ex]=!1,"/./"[_](e)}catch{}}return!1};N({target:"String",proto:!0,forced:!dk("includes")},{includes:function(_){return!!~String(jb(this)).indexOf(ck(_),1<arguments.length?arguments[1]:void 0)}});var Nc={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0};ph("iterator"),ph("asyncIterator");var ek=Ee("forEach")?[].forEach:function(_){return Jd(this,_,1<arguments.length?arguments[1]:void 0)},vp;for(vp in Ij){var wp=y[vp],rh=wp&&wp.prototype;if(rh&&rh.forEach!==ek)try{Na(rh,"forEach",ek)}catch{rh.forEach=ek}}var fx=[].reverse,xp=[1,2];N({target:"Array",proto:!0,forced:String(xp)===String(xp.reverse())},{reverse:function(){return gd(this)&&(this.length=this.length),fx.call(this)}});var w=$a(function(_){_=function(e){function j(vE,NE,jE){return Object.defineProperty(vE,NE,{value:jE,enumerable:!0,configurable:!0,writable:!0}),vE[NE]}function Vt(vE,NE,jE,UE){return NE=Object.create((NE&&NE.prototype instanceof _r?NE:_r).prototype),UE=new tE(UE||[]),NE._invoke=function(RE,FE,VE){var BE=_E;return function(qE,e_){if(BE===ME)throw Error("Generator is already running");if(BE===bE){if(qE==="throw")throw e_;return oE()}for(VE.method=qE,VE.arg=e_;;){if((qE=VE.delegate)&&(qE=_d(qE,VE))){if(qE===LE)continue;return qE}if(VE.method==="next")VE.sent=VE._sent=VE.arg;else if(VE.method==="throw"){if(BE===_E)throw BE=bE,VE.arg;VE.dispatchException(VE.arg)}else VE.method==="return"&&VE.abrupt("return",VE.arg);if(BE=ME,(qE=zt(RE,FE,VE)).type==="normal"){if(BE=VE.done?bE:kE,qE.arg===LE)continue;return{value:qE.arg,done:VE.done}}qE.type==="throw"&&(BE=bE,VE.method="throw",VE.arg=qE.arg)}}}(vE,jE,UE),NE}function zt(vE,NE,jE){try{return{type:"normal",arg:vE.call(NE,jE)}}catch(UE){return{type:"throw",arg:UE}}}function _r(){}function _o(){}function ga(){}function _a(vE){["next","throw","return"].forEach(function(NE){j(vE,NE,function(jE){return this._invoke(NE,jE)})})}function _l(vE,NE){function jE(RE,FE,VE,BE){if((RE=zt(vE[RE],vE,FE)).type!=="throw"){var qE=RE.arg;return(RE=qE.value)&&X(RE)==="object"&&sE.call(RE,"__await")?NE.resolve(RE.__await).then(function(e_){jE("next",e_,VE,BE)},function(e_){jE("throw",e_,VE,BE)}):NE.resolve(RE).then(function(e_){qE.value=e_,VE(qE)},function(e_){return jE("throw",e_,VE,BE)})}BE(RE.arg)}var UE;this._invoke=function(RE,FE){function VE(){return new NE(function(BE,qE){jE(RE,FE,BE,qE)})}return UE=UE?UE.then(VE,VE):VE()}}function _d(vE,NE){var jE=vE.iterator[NE.method];if(jE===dE){if(NE.delegate=null,NE.method==="throw"){if(vE.iterator.return&&(NE.method="return",NE.arg=dE,_d(vE,NE),NE.method==="throw"))return LE;NE.method="throw",NE.arg=new TypeError("The iterator does not provide a 'throw' method")}return LE}return(jE=zt(jE,vE.iterator,NE.arg)).type==="throw"?(NE.method="throw",NE.arg=jE.arg,NE.delegate=null,LE):(jE=jE.arg)?jE.done?(NE[vE.resultName]=jE.value,NE.next=vE.nextLoc,NE.method!=="return"&&(NE.method="next",NE.arg=dE),NE.delegate=null,LE):jE:(NE.method="throw",NE.arg=new TypeError("iterator result is not an object"),NE.delegate=null,LE)}function _f(vE){var NE={tryLoc:vE[0]};1 in vE&&(NE.catchLoc=vE[1]),2 in vE&&(NE.finallyLoc=vE[2],NE.afterLoc=vE[3]),this.tryEntries.push(NE)}function _m(vE){var NE=vE.completion||{};NE.type="normal",delete NE.arg,vE.completion=NE}function tE(vE){this.tryEntries=[{tryLoc:"root"}],vE.forEach(_f,this),this.reset(!0)}function rE(vE){if(vE){var NE=vE[EE];if(NE)return NE.call(vE);if(typeof vE.next=="function")return vE;if(!isNaN(vE.length)){var jE=-1;return(NE=function UE(){for(;++jE<vE.length;)if(sE.call(vE,jE))return UE.value=vE[jE],UE.done=!1,UE;return UE.value=dE,UE.done=!0,UE}).next=NE}}return{next:oE}}function oE(){return{value:dE,done:!0}}var dE,nE=Object.prototype,sE=nE.hasOwnProperty,lE=typeof Symbol=="function"?Symbol:{},EE=lE.iterator||"@@iterator",wE=lE.asyncIterator||"@@asyncIterator",IE=lE.toStringTag||"@@toStringTag";try{j({},"")}catch{j=function(NE,jE,UE){return NE[jE]=UE}}e.wrap=Vt;var _E="suspendedStart",kE="suspendedYield",ME="executing",bE="completed",LE={};j(lE={},EE,function(){return this});var TE=Object.getPrototypeOf;(TE=TE&&TE(TE(rE([]))))&&TE!==nE&&sE.call(TE,EE)&&(lE=TE);var OE=ga.prototype=_r.prototype=Object.create(lE);return _o.prototype=ga,j(OE,"constructor",ga),j(ga,"constructor",_o),_o.displayName=j(ga,IE,"GeneratorFunction"),e.isGeneratorFunction=function(vE){return!!(vE=typeof vE=="function"&&vE.constructor)&&(vE===_o||(vE.displayName||vE.name)==="GeneratorFunction")},e.mark=function(vE){return Object.setPrototypeOf?Object.setPrototypeOf(vE,ga):(vE.__proto__=ga,j(vE,IE,"GeneratorFunction")),vE.prototype=Object.create(OE),vE},e.awrap=function(vE){return{__await:vE}},_a(_l.prototype),j(_l.prototype,wE,function(){return this}),e.AsyncIterator=_l,e.async=function(vE,NE,jE,UE,RE){RE===void 0&&(RE=Promise);var FE=new _l(Vt(vE,NE,jE,UE),RE);return e.isGeneratorFunction(NE)?FE:FE.next().then(function(VE){return VE.done?VE.value:FE.next()})},_a(OE),j(OE,IE,"Generator"),j(OE,EE,function(){return this}),j(OE,"toString",function(){return"[object Generator]"}),e.keys=function(vE){var NE,jE=[];for(NE in vE)jE.push(NE);return jE.reverse(),function UE(){for(;jE.length;){var RE=jE.pop();if(RE in vE)return UE.value=RE,UE.done=!1,UE}return UE.done=!0,UE}},e.values=rE,tE.prototype={constructor:tE,reset:function(vE){if(this.next=this.prev=0,this.sent=this._sent=dE,this.done=!1,this.delegate=null,this.method="next",this.arg=dE,this.tryEntries.forEach(_m),!vE)for(var NE in this)NE.charAt(0)==="t"&&sE.call(this,NE)&&!isNaN(+NE.slice(1))&&(this[NE]=dE)},stop:function(){this.done=!0;var vE=this.tryEntries[0].completion;if(vE.type==="throw")throw vE.arg;return this.rval},dispatchException:function(vE){function NE(qE,e_){return FE.type="throw",FE.arg=vE,jE.next=qE,e_&&(jE.method="next",jE.arg=dE),!!e_}if(this.done)throw vE;for(var jE=this,UE=this.tryEntries.length-1;0<=UE;--UE){var RE=this.tryEntries[UE],FE=RE.completion;if(RE.tryLoc==="root")return NE("end");if(RE.tryLoc<=this.prev){var VE=sE.call(RE,"catchLoc"),BE=sE.call(RE,"finallyLoc");if(VE&&BE){if(this.prev<RE.catchLoc)return NE(RE.catchLoc,!0);if(this.prev<RE.finallyLoc)return NE(RE.finallyLoc)}else if(VE){if(this.prev<RE.catchLoc)return NE(RE.catchLoc,!0)}else{if(!BE)throw Error("try statement without catch or finally");if(this.prev<RE.finallyLoc)return NE(RE.finallyLoc)}}}},abrupt:function(vE,NE){for(var jE=this.tryEntries.length-1;0<=jE;--jE){var UE=this.tryEntries[jE];if(UE.tryLoc<=this.prev&&sE.call(UE,"finallyLoc")&&this.prev<UE.finallyLoc){var RE=UE;break}}return RE&&(vE==="break"||vE==="continue")&&RE.tryLoc<=NE&&NE<=RE.finallyLoc&&(RE=null),(jE=RE?RE.completion:{}).type=vE,jE.arg=NE,RE?(this.method="next",this.next=RE.finallyLoc,LE):this.complete(jE)},complete:function(vE,NE){if(vE.type==="throw")throw vE.arg;return vE.type==="break"||vE.type==="continue"?this.next=vE.arg:vE.type==="return"?(this.rval=this.arg=vE.arg,this.method="return",this.next="end"):vE.type==="normal"&&NE&&(this.next=NE),LE},finish:function(vE){for(var NE=this.tryEntries.length-1;0<=NE;--NE){var jE=this.tryEntries[NE];if(jE.finallyLoc===vE)return this.complete(jE.completion,jE.afterLoc),_m(jE),LE}},catch:function(vE){for(var NE=this.tryEntries.length-1;0<=NE;--NE){var jE=this.tryEntries[NE];if(jE.tryLoc===vE){if((vE=jE.completion).type==="throw"){var UE=vE.arg;_m(jE)}return UE}}throw Error("illegal catch attempt")},delegateYield:function(vE,NE,jE){return this.delegate={iterator:rE(vE),resultName:NE,nextLoc:jE},this.method==="next"&&(this.arg=dE),LE}},e}(_.exports);try{regeneratorRuntime=_}catch{(typeof globalThis>"u"?"undefined":X(globalThis))==="object"?globalThis.regeneratorRuntime=_:Function("r","regeneratorRuntime = r")(_)}}),yp=!R(function(){return Object.isExtensible(Object.preventExtensions({}))}),fk=$a(function(_){var e=Ra.f,j=Ae("meta"),Vt=0,zt=Object.isExtensible||function(){return!0},_r=function(ga){e(ga,j,{value:{objectID:"O"+ ++Vt,weakData:{}}})},_o=_.exports={REQUIRED:!1,fastKey:function(ga,_a){if(!ha(ga))return typeof ga=="symbol"?ga:(typeof ga=="string"?"S":"P")+ga;if(!Q(ga,j)){if(!zt(ga))return"F";if(!_a)return"E";_r(ga)}return ga[j].objectID},getWeakData:function(ga,_a){if(!Q(ga,j)){if(!zt(ga))return!0;if(!_a)return!1;_r(ga)}return ga[j].weakData},onFreeze:function(ga){return yp&&_o.REQUIRED&&zt(ga)&&!Q(ga,j)&&_r(ga),ga}};Be[j]=!0}),zp=function(_,e,j){var Vt=_.indexOf("Map")!==-1,zt=_.indexOf("Weak")!==-1,_r=Vt?"set":"add",_o=y[_],ga=_o&&_o.prototype,_a=_o,_l={},_d=function(dE){var nE=ga[dE];Ta(ga,dE,dE=="add"?function(sE){return nE.call(this,sE===0?0:sE),this}:dE=="delete"?function(sE){return!(zt&&!ha(sE))&&nE.call(this,sE===0?0:sE)}:dE=="get"?function(sE){return zt&&!ha(sE)?void 0:nE.call(this,sE===0?0:sE)}:dE=="has"?function(sE){return!(zt&&!ha(sE))&&nE.call(this,sE===0?0:sE)}:function(sE,lE){return nE.call(this,sE===0?0:sE,lE),this})};if(nc(_,typeof _o!="function"||!(zt||ga.forEach&&!R(function(){new _o().entries().next()}))))_a=j.getConstructor(e,_,Vt,_r),fk.REQUIRED=!0;else if(nc(_,!0)){var _f=new _a,_m=_f[_r](zt?{}:-0,1)!=_f,tE=R(function(){_f.has(1)}),rE=Tg(function(dE){new _o(dE)}),oE=!zt&&R(function(){for(var dE=new _o,nE=5;nE--;)dE[_r](nE,nE);return!dE.has(-0)});rE||((_a=e(function(dE,nE){return Gc(dE,_a,_),dE=lh(new _o,dE,_a),nE!=null&&Xg(nE,dE[_r],{that:dE,AS_ENTRIES:Vt}),dE})).prototype=ga,ga.constructor=_a),(tE||oE)&&(_d("delete"),_d("has"),Vt&&_d("get")),(oE||_m)&&_d(_r),zt&&ga.clear&&delete ga.clear}return _l[_]=_a,N({global:!0,forced:_a!=_o},_l),Ec(_a,_),zt||j.setStrong(_a,_,Vt),_a},gx=Ra.f,Ap=fk.fastKey,Bp=Za.set,gk=Za.getterFor,Cp={getConstructor:function(_,e,j,Vt){var zt=_(function(_a,_l){Gc(_a,zt,e),Bp(_a,{type:e,index:ac(null),first:void 0,last:void 0,size:0}),ka||(_a.size=0),_l!=null&&Xg(_l,_a[Vt],{that:_a,AS_ENTRIES:j})}),_r=gk(e),_o=function(_a,_l,_d){var _f,_m=_r(_a),tE=ga(_a,_l);return tE?tE.value=_d:(_m.last=tE={index:_f=Ap(_l,!0),key:_l,value:_d,previous:_l=_m.last,next:void 0,removed:!1},_m.first||(_m.first=tE),_l&&(_l.next=tE),ka?_m.size++:_a.size++,_f!=="F"&&(_m.index[_f]=tE)),_a},ga=function(_a,_l){_a=_r(_a);var _d=Ap(_l);if(_d!=="F")return _a.index[_d];for(_a=_a.first;_a;_a=_a.next)if(_a.key==_l)return _a};return Hf(zt.prototype,{clear:function(){for(var _a=_r(this),_l=_a.index,_d=_a.first;_d;)_d.removed=!0,_d.previous&&(_d.previous=_d.previous.next=void 0),delete _l[_d.index],_d=_d.next;_a.first=_a.last=void 0,ka?_a.size=0:this.size=0},delete:function(_a){var _l=_r(this);if(_a=ga(this,_a)){var _d=_a.next,_f=_a.previous;delete _l.index[_a.index],_a.removed=!0,_f&&(_f.next=_d),_d&&(_d.previous=_f),_l.first==_a&&(_l.first=_d),_l.last==_a&&(_l.last=_f),ka?_l.size--:this.size--}return!!_a},forEach:function(_a){for(var _l,_d=_r(this),_f=Id(_a,1<arguments.length?arguments[1]:void 0,3);_l=_l?_l.next:_d.first;)for(_f(_l.value,_l.key,this);_l&&_l.removed;)_l=_l.previous},has:function(_a){return!!ga(this,_a)}}),Hf(zt.prototype,j?{get:function(_a){return(_a=ga(this,_a))&&_a.value},set:function(_a,_l){return _o(this,_a===0?0:_a,_l)}}:{add:function(_a){return _o(this,_a=_a===0?0:_a,_a)}}),ka&&gx(zt.prototype,"size",{get:function(){return _r(this).size}}),zt},setStrong:function(_,e,j){var Vt=e+" Iterator",zt=gk(e),_r=gk(Vt);bj(_,e,function(_o,ga){Bp(this,{type:Vt,target:_o,state:zt(_o),kind:ga,last:void 0})},function(){for(var _o=_r(this),ga=_o.kind,_a=_o.last;_a&&_a.removed;)_a=_a.previous;return _o.target&&(_o.last=_a=_a?_a.next:_o.state.first)?ga=="keys"?{value:_a.key,done:!1}:ga=="values"?{value:_a.value,done:!1}:{value:[_a.key,_a.value],done:!1}:(_o.target=void 0,{value:void 0,done:!0})},j?"entries":"values",!j,!0),If(e)}};zp("Set",function(_){return function(){return _(this,arguments.length?arguments[0]:void 0)}},Cp);var hx=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,ix=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,hk=function(_){return function(e){return e=String(jb(e)),1&_&&(e=e.replace(hx,"")),2&_&&(e=e.replace(ix,"")),e}},ik=hk(3),sh=y.parseInt,jx=/^[+-]?0[Xx]/,Dp=sh(`	
\v\f\r \u2028\u2029\uFEFF08`)!==8||sh(`	
\v\f\r \u2028\u2029\uFEFF0x16`)!==22?function(_,e){return _=ik(String(_)),sh(_,e>>>0||(jx.test(_)?16:10))}:sh;N({global:!0,forced:parseInt!=Dp},{parseInt:Dp});var kx=Hd.f,lx=Fb.f,mx=Ra.f,pd=y.Number,th=pd.prototype,nx=Zb(ac(th))=="Number",Ep=function(_){var e,j=lc(_,!1);if(typeof j=="string"&&2<j.length){if((_=(j=ik(j)).charCodeAt(0))===43||_===45){if((_=j.charCodeAt(2))===88||_===120)return NaN}else if(_===48){switch(j.charCodeAt(1)){case 66:case 98:_=2;var Vt=49;break;case 79:case 111:_=8,Vt=55;break;default:return+j}var zt=(j=j.slice(2)).length;for(e=0;e<zt;e++){var _r=j.charCodeAt(e);if(48>_r||_r>Vt)return NaN}return parseInt(j,_)}}return+j};if(nc("Number",!pd(" 0o1")||!pd("0b1")||pd("+0x1"))){for(var Pd=function(_){var e=1>arguments.length?0:_,j=this;return j instanceof Pd&&(nx?R(function(){th.valueOf.call(j)}):Zb(j)!="Number")?lh(new pd(Ep(e)),j,Pd):Ep(e)},Fp=ka?kx(pd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),jk=0,uh;Fp.length>jk;jk++)Q(pd,uh=Fp[jk])&&!Q(Pd,uh)&&mx(Pd,uh,lx(pd,uh));Pd.prototype=th,th.constructor=Pd,Ta(y,"Number",Pd)}var Gp=qa("isConcatSpreadable"),ox=51<=id||!R(function(){var _=[];return _[Gp]=!1,_.concat()[0]!==_}),px=Ef("concat");N({target:"Array",proto:!0,forced:!ox||!px},{concat:function(_){var e,j=Qa(this),Vt=Sg(j,0),zt=0,_r=-1;for(e=arguments.length;_r<e;_r++){var _o=_r===-1?j:arguments[_r],ga=_o;if(ha(ga)){var _a=ga[Gp];ga=_a!==void 0?!!_a:gd(ga)}else ga=!1;if(ga){if(9007199254740991<zt+(_a=ta(_o.length)))throw TypeError("Maximum allowed index exceeded");for(ga=0;ga<_a;ga++,zt++)ga in _o&&Ge(Vt,zt,_o[ga])}else{if(9007199254740991<=zt)throw TypeError("Maximum allowed index exceeded");Ge(Vt,zt++,_o)}}return Vt.length=zt,Vt}});var kk=mc("Reflect","apply"),qx=Function.apply,rx=!R(function(){kk(function(){})});N({target:"Reflect",stat:!0,forced:rx},{apply:function(_,e,j){return yb(_),va(j),kk?kk(_,e,j):qx.call(_,e,j)}}),N({target:"Reflect",stat:!0},{ownKeys:qn});var sx=Oj,tx=R(function(){return!Object.getOwnPropertyNames(1)});N({target:"Object",stat:!0,forced:tx},{getOwnPropertyNames:sx});var Pe=(typeof Reflect>"u"?"undefined":X(Reflect))==="object"?Reflect:null,Hp=Pe&&typeof Pe.apply=="function"?Pe.apply:function(_,e,j){return Function.prototype.apply.call(_,e,j)},ux=Pe&&typeof Pe.ownKeys=="function"?Pe.ownKeys:Object.getOwnPropertySymbols?function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:function(_){return Object.getOwnPropertyNames(_)},Ip=Number.isNaN||function(_){return _!=_};ea.EventEmitter=ea,ea.prototype._events=void 0,ea.prototype._eventsCount=0,ea.prototype._maxListeners=void 0;var Jp=10;Object.defineProperty(ea,"defaultMaxListeners",{enumerable:!0,get:function(){return Jp},set:function(_){if(typeof _!="number"||0>_||Ip(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");Jp=_}}),ea.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ea.prototype.setMaxListeners=function(_){if(typeof _!="number"||0>_||Ip(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this},ea.prototype.getMaxListeners=function(){return this._maxListeners===void 0?ea.defaultMaxListeners:this._maxListeners},ea.prototype.emit=function(_){for(var e=[],j=1;j<arguments.length;j++)e.push(arguments[j]);j=_==="error";var Vt=this._events;if(Vt!==void 0)j=j&&Vt.error===void 0;else if(!j)return!1;if(j){var zt;throw 0<e.length&&(zt=e[0]),zt instanceof Error?zt:((e=Error("Unhandled error."+(zt?" ("+zt.message+")":""))).context=zt,e)}if((j=Vt[_])===void 0)return!1;if(typeof j=="function")Hp(j,this,e);else for(Vt=Cl(j,zt=j.length),j=0;j<zt;++j)Hp(Vt[j],this,e);return!0},ea.prototype.addListener=function(_,e){return zl(this,_,e,!1)},ea.prototype.on=ea.prototype.addListener,ea.prototype.prependListener=function(_,e){return zl(this,_,e,!0)},ea.prototype.once=function(_,e){return ng(e),this.on(_,Al(this,_,e)),this},ea.prototype.prependOnceListener=function(_,e){return ng(e),this.prependListener(_,Al(this,_,e)),this},ea.prototype.removeListener=function(_,e){var j;ng(e);var Vt=this._events;if(Vt===void 0)return this;var zt=Vt[_];if(zt===void 0)return this;if(zt===e||zt.listener===e)--this._eventsCount==0?this._events=Object.create(null):(delete Vt[_],Vt.removeListener&&this.emit("removeListener",_,zt.listener||e));else if(typeof zt!="function"){var _r=-1;for(j=zt.length-1;0<=j;j--)if(zt[j]===e||zt[j].listener===e){var _o=zt[j].listener;_r=j;break}if(0>_r)return this;if(_r===0)zt.shift();else{for(;_r+1<zt.length;_r++)zt[_r]=zt[_r+1];zt.pop()}zt.length===1&&(Vt[_]=zt[0]),Vt.removeListener!==void 0&&this.emit("removeListener",_,_o||e)}return this},ea.prototype.off=ea.prototype.removeListener,ea.prototype.removeAllListeners=function(_){var e=this._events;if(e===void 0)return this;if(e.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):e[_]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete e[_]),this;if(arguments.length===0){var j=Object.keys(e);for(e=0;e<j.length;++e){var Vt=j[e];Vt!=="removeListener"&&this.removeAllListeners(Vt)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(j=e[_])=="function")this.removeListener(_,j);else if(j!==void 0)for(e=j.length-1;0<=e;e--)this.removeListener(_,j[e]);return this},ea.prototype.listeners=function(_){return Bl(this,_,!0)},ea.prototype.rawListeners=function(_){return Bl(this,_,!1)},ea.listenerCount=function(_,e){return typeof _.listenerCount=="function"?_.listenerCount(e):Dl.call(_,e)},ea.prototype.listenerCount=Dl,ea.prototype.eventNames=function(){return 0<this._eventsCount?ux(this._events):[]},ea.once=function(_,e){return new Promise(function(j,Vt){function zt(_o){_.removeListener(e,_r),Vt(_o)}function _r(){typeof _.removeListener=="function"&&_.removeListener("error",zt),j([].slice.call(arguments))}El(_,e,_r,{once:!0}),e!=="error"&&vs(_,zt,{once:!0})})};var Qe=Object.assign,Kp=Object.defineProperty,Lp=!Qe||R(function(){if(ka&&Qe({b:1},Qe(Kp({},"a",{enumerable:!0,get:function(){Kp(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var _={},e={},j=Symbol();return _[j]=7,"abcdefghijklmnopqrst".split("").forEach(function(Vt){e[Vt]=Vt}),Qe({},_)[j]!=7||Dc(Qe({},e)).join("")!="abcdefghijklmnopqrst"})?function(_,e){for(var j=Qa(_),Vt=arguments.length,zt=1,_r=Bf.f,_o=zf;Vt>zt;)for(var ga,_a=Af(arguments[zt++]),_l=_r?Dc(_a).concat(_r(_a)):Dc(_a),_d=_l.length,_f=0;_d>_f;)ga=_l[_f++],(!ka||_o.call(_a,ga))&&(j[ga]=_a[ga]);return j}:Qe;N({target:"Object",stat:!0,forced:Object.assign!==Lp},{assign:Lp}),zp("Map",function(_){return function(){return _(this,arguments.length?arguments[0]:void 0)}},Cp);var vx=Math.log,wx=Math.LN2;N({target:"Math",stat:!0},{log2:function(_){return vx(_)/wx}});var xx=Ra.f,yx=Hd.f,zx=Za.enforce,Ax=qa("match"),sc=y.RegExp,lk=sc.prototype,Wf=/a/g,mk=/a/g,nk=new sc(Wf)!==Wf;if(ka&&nc("RegExp",!nk||pc||R(function(){return mk[Ax]=!1,sc(Wf)!=Wf||sc(mk)==mk||sc(Wf,"i")!="/a/i"}))){for(var Oc=function(_,e){var j,Vt=this instanceof Oc,zt=Lj(_),_r=e===void 0;return!Vt&&zt&&_.constructor===Oc&&_r||(nk?zt&&!_r&&(_=_.source):_ instanceof Oc&&(_r&&(e=tj.call(_)),_=_.source),pc&&(j=!!e&&-1<e.indexOf("y"))&&(e=e.replace(/y/g,"")),_=lh(nk?new sc(_,e):sc(_,e),Vt?this:lk,Oc),pc&&j&&(zx(_).sticky=!0)),_},Bx=function(_){_ in Oc||xx(Oc,_,{configurable:!0,get:function(){return sc[_]},set:function(e){sc[_]=e}})},Mp=yx(sc),Np=0;Mp.length>Np;)Bx(Mp[Np++]);lk.constructor=Oc,Oc.prototype=lk,Ta(y,"RegExp",Oc)}If("RegExp"),Sf("Float32",function(_){return function(e,j,Vt){return _(this,e,j,Vt)}}),Sf("Float64",function(_){return function(e,j,Vt){return _(this,e,j,Vt)}}),Sf("Uint32",function(_){return function(e,j,Vt){return _(this,e,j,Vt)}}),Sf("Uint16",function(_){return function(e,j,Vt){return _(this,e,j,Vt)}});var ok=function(_,e){return _===e?0:_==null?e==null?0:-1:e==null?_==null?0:1:typeof _.compare=="function"?_.compare(e):typeof e.compare=="function"?-e.compare(_):_<e?-1:_>e?1:0},pk=[],Op=pk.sort,Cx=R(function(){pk.sort(void 0)}),Dx=R(function(){pk.sort(null)}),Ex=Ee("sort");N({target:"Array",proto:!0,forced:Cx||!Dx||!Ex},{sort:function(_){return _===void 0?Op.call(Qa(this)):Op.call(Qa(this),yb(_))}});var Pp=Object.getPrototypeOf({}),Xf=function(_,e){var j;return _===e||(_==null?_==e:X(_.equiv)==="function"?_.equiv(e):e==null?_==e:X(e.equiv)==="function"?e.equiv(_):X(_)!=="string"&&X(e)!=="string"&&((j=Object.getPrototypeOf(_))!=null&&j!==Pp||(j=Object.getPrototypeOf(e))!=null&&j!==Pp?X(_)!=="function"&&_.length!==void 0&&X(e)!=="function"&&e.length!==void 0?Gx(_,e):_ instanceof Set&&e instanceof Set?Hx(_,e):_ instanceof Map&&e instanceof Map?Ix(_,e):_ instanceof Date&&e instanceof Date?_.getTime()===e.getTime():_ instanceof RegExp&&e instanceof RegExp?_.toString()===e.toString():_!=_&&e!=e:Fx(_,e)))},Gx=function(_,e){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf,Vt=_.length;if(Vt===e.length)for(;0<=--Vt&&j(_[Vt],e[Vt]););return 0>Vt},Hx=function(_,e){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;return _.size===e.size&&j(G(_.keys()).sort(),G(e.keys()).sort())},Ix=function(_,e){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;return _.size===e.size&&j(G(_).sort(),G(e).sort())},Fx=function(_,e){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Xf;if(Object.keys(_).length!==Object.keys(e).length)return!1;for(var Vt in _)if(!e.hasOwnProperty(Vt)||!j(_[Vt],e[Vt]))return!1;return!0},Qp=function(_){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(j){return j!==void 0?": "+j:""};return function(j){function Vt(_r){return W(this,Vt),zt.call(this,_(_r)+e(_r))}la(Vt,j);var zt=ma(Vt);return Vt}(ef(Error))},Jx=Qp(function(){return"illegal argument(s)"}),vh=function(_){throw new Jx(_)},qk=Qp(function(){return"index out of bounds"}),Rp=1/4294967295,Kx=function(){function _(){W(this,_)}return Ha(_,[{key:"float",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*Rp*e}},{key:"norm",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*Rp-.5)*e}},{key:"minmax",value:function(e,j){return this.float()*(j-e)+e}}]),_}(),rk=Math.random,Lx=new(function(_){function e(){return W(this,e),j.apply(this,arguments)}la(e,_);var j=ma(e);return Ha(e,[{key:"int",value:function(){return 4294967296*rk()>>>0}},{key:"float",value:function(){var Vt=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return rk()*Vt}},{key:"norm",value:function(){var Vt=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(rk()-.5)*Vt}}]),e}(Kx)),Vh=Symbol(),Hl=function(){},Mx=fk.onFreeze,sk=Object.freeze,Nx=R(function(){sk(1)});N({target:"Object",stat:!0,forced:Nx,sham:!yp},{freeze:function(_){return sk&&ha(_)?sk(Mx(_)):_}});var Ox=Ee("reduce"),Px=!Hc&&79<id&&83>id;N({target:"Array",proto:!0,forced:!Ox||Px},{reduce:function(_){return Wo(this,_,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Gl=function(_){return _!=null&&typeof _.xform=="function"?_.xform():_},og=function(){function _(e){W(this,_),this.value=e}return Ha(_,[{key:"deref",value:function(){return this.value}}]),_}(),Wh=function(_){return _ instanceof og?_.deref():_},xs=function(_,e){return[_,function(j){return j},e]},Qx=w.mark(function(_,e){var j,Vt,zt,_r,_o,ga;return w.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:j=Gl(_)(ws()),Vt=j[1],zt=j[2],_r=0;case 4:if(!(_r<e.length)){_a.next=15;break}if(_o=e[_r],!((ga=zt([],_o))instanceof og)){_a.next=10;break}return _a.delegateYield(Wh(Vt(ga.deref())),"t0",9);case 9:return _a.abrupt("return");case 10:if(!ga.length){_a.next=12;break}return _a.delegateYield(ga,"t1",12);case 12:_r++,_a.next=4;break;case 15:return _a.delegateYield(Wh(Vt([])),"t2",16);case 16:case"end":return _a.stop()}},Qx)}),ys=w.mark(Fl),zs=function(_,e){return[_[0],_[1],e]},Sp=!0;"findIndex"in[]&&Array(1).findIndex(function(){Sp=!1}),N({target:"Array",proto:!0,forced:Sp},{findIndex:function(_){return An(this,_,1<arguments.length?arguments[1]:void 0)}}),Ld("findIndex"),N({target:"Array",proto:!0},{fill:yj}),Ld("fill");var Rx=function(){function _(e){W(this,_),this._length=0,e&&this.into(e)}return Ha(_,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new _(this)}},{key:"empty",value:function(){return new _}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,j=this.head;j;)e=j.next,delete j.value,delete j.prev,delete j.next,j=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var j=this._length;if(j<e._length)return-1;if(j>e._length)return 1;if(j===0)return 0;j=this.head,e=e.head;for(var Vt=0;j&&Vt==0;)Vt=ok(j.value,e.value),j=j.next,e=e.next;return Vt}},{key:"equiv",value:function(e){if(!(e instanceof _||e!=null&&typeof e!="function"&&e.length!==void 0)||this._length!==e.length)return!1;if(!this._length||this===e)return!0;for(var j=this.head,Vt=0;Vt<e.length;Vt++){if(!Xf(j.value,e[Vt]))return!1;j=j.next}return!0}},{key:Symbol.iterator,value:w.mark(function e(){var j;return w.wrap(function(Vt){for(;;)switch(Vt.prev=Vt.next){case 0:j=this.head;case 1:if(!j){Vt.next=7;break}return Vt.next=4,j.value;case 4:j=j.next,Vt.next=1;break;case 7:case"end":return Vt.stop()}},e,this)})},{key:"seq",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(e>=j||0>e)){e=this.nthCell(e);var Vt=this.nthCell(j-1);return j=function zt(_r){return{first:function(){return _r.value},next:function(){return _r!==Vt&&_r.next?zt(_r.next):void 0}}},e?j(e):void 0}}},{key:"cycle",value:w.mark(function e(){return w.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.delegateYield(this,"t0",2);case 2:j.next=0;break;case 4:case"end":return j.stop()}},e,this)})},{key:"$reduce",value:function(e,j){for(var Vt=this.head;Vt&&!(j instanceof og);)j=e(j,Vt.value),Vt=Vt.next;return j}},{key:"drop",value:function(){var e=this.head;if(e)return(this.head=e.next)?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){return e={value:e,next:this.head},this.head?this.head.prev=e:this.tail=e,this.head=e,this._length++,this}},{key:"insertBefore",value:function(e,j){return e||vh("cell is undefined"),j={value:j,next:e,prev:e.prev},e.prev?e.prev.next=j:this.head=j,e.prev=j,this._length++,this}},{key:"insertAfter",value:function(e,j){return e||vh("cell is undefined"),j={value:j,next:e.next,prev:e},e.next?e.next.prev=j:this.tail=j,e.next=j,this._length++,this}},{key:"insertBeforeNth",value:function(e,j){if(0>e&&(e+=this._length),0>=e)return this.cons(j);if(0>e||e>=this._length)throw new qk(e);return this.insertBefore(this.nthCellUnsafe(e),j)}},{key:"insertAfterNth",value:function(e,j){if(0>e&&(e+=this._length),e>=this._length-1)return this.push(j);if(0>e||e>=this._length)throw new qk(e);return this.insertAfter(this.nthCellUnsafe(e),j)}},{key:"insertSorted",value:function(e,j){j=j||ok;for(var Vt=this.head;Vt;){if(0>=j(e,Vt.value))return this.insertBefore(Vt,e);Vt=Vt.next}return this.push(e)}},{key:"find",value:function(e){for(var j=this.head;j;){if(j.value===e)return j;j=j.next}}},{key:"findWith",value:function(e){for(var j=this.head;j;){if(e(j.value))return j;j=j.next}}},{key:"concat",value:function(){for(var e=this.copy(),j=arguments.length,Vt=Array(j),zt=0;zt<j;zt++)Vt[zt]=arguments[zt];for(j=0;j<Vt.length;j++)e.into(Vt[j]);return e}},{key:"into",value:function(e){for(var j=0;j<e.length;j++)this.push(e[j])}},{key:"slice",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;e=0>e?e+this._length:e,j=0>j?j+this._length:j,(0>e||0>j)&&vh("invalid indices: ${from} / ${to}");for(var Vt=new _,zt=this.nthCell(e);zt&&++e<=j;)Vt.push(zt.value),zt=zt.next;return Vt}},{key:"splice",value:function(e){var j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,Vt=2<arguments.length?arguments[2]:void 0;if(typeof e=="number"){if(0>e&&(e+=this._length),0>e||e>=this._length)throw new qk(e);var zt=this.nthCellUnsafe(e)}else zt=e;var _r=new _;if(0<j)for(;zt&&0<j--;)this.remove(zt),_r.push(zt.value),zt=zt.next;else zt&&(zt=zt.next);if(Vt)if(zt)for(j=0;j<Vt.length;j++)this.insertBefore(zt,Vt[j]);else for(zt=0;zt<Vt.length;zt++)this.push(Vt[zt]);return _r}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,j){if(e!==j){var Vt=e.value;e.value=j.value,j.value=Vt}return this}},{key:"push",value:function(e){return this.tail?(e={value:e,prev:this.tail},this.tail=this.tail.next=e,this._length++,this):this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return(this.tail=e.prev)?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,j){var Vt=this.nthCell(e);return!Vt&&vh("index out of bounds: ".concat(e)),Vt.value=j,this}},{key:"nth",value:function(e,j){return(e=this.nthCell(e))?e.value:j}},{key:"nthCell",value:function(e){if(0>e&&(e+=this._length),!(0>e||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(e){for(var j=new _,Vt=this.head;Vt;)j.push(e(Vt.value)),Vt=Vt.next;return j}},{key:"filter",value:function(e){for(var j=new _,Vt=this.head;Vt;)e(Vt.value)&&j.push(Vt.value),Vt=Vt.next;return j}},{key:"reduce",value:function(e,j){for(var Vt=this.head;Vt;)j=e(j,Vt.value),Vt=Vt.next;return j}},{key:"shuffle",value:function(e){var j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Lx;if(2>this._length)return this;for(e=e??Math.ceil(1.5*Math.log2(this._length));0<e;e--)for(var Vt=this.head;Vt;){var zt=Vt.next;.5>j.float()?this.asHead(Vt):this.asTail(Vt),Vt=zt}return this}},{key:"sort",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:ok;if(!this._length)return this;for(var j=1;;){var Vt=this.head;this.tail=this.head=void 0;for(var zt=0;Vt;){zt++;for(var _r=Vt,_o=0,ga=0;ga<j&&(_o++,_r=_r.next);ga++);for(ga=j;0<_o||0<ga&&_r;){if(_o===0){var _a=_r;_r=_r.next,ga--}else _r&&ga!==0?0>=e(Vt.value,_r.value)?(_a=Vt,Vt=Vt.next,_o--):(_a=_r,_r=_r.next,ga--):(_a=Vt,Vt=Vt.next,_o--);this.tail?this.tail.next=_a:this.head=_a,_a.prev=this.tail,this.tail=_a}Vt=_r}if(this.tail.next=void 0,1>=zt)return this;j*=2}}},{key:"reverse",value:function(){for(var e=this.head,j=this.tail,Vt=(this._length>>>1)+(1&this._length);e&&j&&0<Vt;){var zt=e.value;e.value=j.value,j.value=zt,e=e.next,j=j.prev,Vt--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],j=this.head;j;)e.push(String(j.value)),j=j.next;return e.join(", ")}},{key:"toJSON",value:function(){return G(this)}},{key:"nthCellUnsafe",value:function(e){if(e<=this._length>>1)var j=this.head,Vt="next";else j=this.tail,Vt="prev",e=this._length-e-1;for(;0<e--&&j;)j=j[Vt];return j}}]),_}(),tc=function(){function _(e,j){W(this,_),j=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},j),this.map=j.map(),this.items=new Rx,this._size=0,this.opts=j,e&&this.into(e)}return Ha(_,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return pg(function(e){return[e.k,e]},this.items)}},{key:"keys",value:function(){return pg(function(e){return e.k},this.items)}},{key:"values",value:function(){return pg(function(e){return e.v},this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var j=e.items.head;j;)e.map.set(j.value.k,j),j=j.next;return e}},{key:"empty",value:function(){return new _(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var j;j=this.items.drop();)e(j.k,j.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,j){return(e=this.map.get(e))?this.resetEntry(e):j}},{key:"set",value:function(e,j){var Vt=this.opts.ksize(e)+this.opts.vsize(j),zt=this.map.get(e);return this._size+=Math.max(0,Vt-(zt?zt.value.s:0)),this.ensureSize()&&this.doSetEntry(zt,e,j,Vt),j}},{key:"into",value:function(e){for(var j=0;j<e.length;j++){var Vt=e[j];this.set(Vt[0],Vt[1])}return this}},{key:"getSet",value:function(e,j){var Vt=this,zt=this.map.get(e);return zt?Promise.resolve(this.resetEntry(zt)):j().then(function(_r){return Vt.set(e,_r)})}},{key:"delete",value:function(e){return!!(e=this.map.get(e))&&(this.removeEntry(e),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,j=this.opts.maxsize,Vt=this.opts.maxlen;this._size>j||this.length>=Vt;){var zt=this.items.drop();if(!zt)return!1;this.map.delete(zt.k),e&&e(zt.k,zt.v),this._size-=zt.s}return!0}},{key:"removeEntry",value:function(e){var j=e.value;this.map.delete(j.k),this.items.remove(e),this.opts.release&&this.opts.release(j.k,j.v),this._size-=j.s}},{key:"doSetEntry",value:function(e,j,Vt,zt){e?(e.value.v=Vt,e.value.s=zt,this.items.asTail(e)):(this.items.push({k:j,v:Vt,s:zt}),this.map.set(j,this.items.tail))}}]),_}(),Sx=function(_){function e(Vt,zt){return W(this,e),zt=Object.assign({ttl:36e5},zt),j.call(this,Vt,zt)}la(e,_);var j=ma(e);return Ha(e,[{key:"empty",value:function(){return new e(null,this.opts)}},{key:"has",value:function(Vt){return this.get(Vt)!==void 0}},{key:"get",value:function(Vt,zt){if(Vt=this.map.get(Vt)){if(Vt.value.t>=Date.now())return this.resetEntry(Vt);this.removeEntry(Vt)}return zt}},{key:"set",value:function(Vt,zt){var _r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,_o=this.opts.ksize(Vt)+this.opts.vsize(zt),ga=this.map.get(Vt);return this._size+=Math.max(0,_o-(ga?ga.value.s:0)),this.ensureSize()&&(_r=Date.now()+_r,ga?(ga.value.v=zt,ga.value.s=_o,ga.value.t=_r,this.items.asTail(ga)):(this.items.push({k:Vt,v:zt,s:_o,t:_r}),this.map.set(Vt,this.items.tail))),zt}},{key:"getSet",value:function(Vt,zt){var _r=this,_o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,ga=this.get(Vt);return ga?Promise.resolve(ga):zt().then(function(_a){return _r.set(Vt,_a,_o)})}},{key:"prune",value:function(){for(var Vt=Date.now(),zt=this.items.head;zt;)zt.value.t<Vt&&this.removeEntry(zt),zt=zt.next}},{key:"ensureSize",value:function(){for(var Vt=this.opts.maxsize,zt=this.opts.maxlen,_r=Date.now(),_o=this.items.head;_o&&(this._size>Vt||this.length>=zt);)_o.value.t<_r&&this.removeEntry(_o),_o=_o.next;return Th(wd(e.prototype),"ensureSize",this).call(this)}}]),e}(tc),Tp=X(Ya)=="object"&&Ya&&Ya.Object===Object&&Ya,Tx=(typeof self>"u"?"undefined":X(self))=="object"&&self&&self.Object===Object&&self,Cb=Tp||Tx||Function("return this")(),Pb=Cb.Symbol,Up=Object.prototype,Ux=Up.hasOwnProperty,Vx=Up.toString,Yf=Pb?Pb.toStringTag:void 0,Wx=Object.prototype.toString,Vp=Pb?Pb.toStringTag:void 0,Qd=function(_){if(_==null)_=_===void 0?"[object Undefined]":"[object Null]";else if(Vp&&Vp in Object(_)){var e=Ux.call(_,Yf),j=_[Yf];try{_[Yf]=void 0;var Vt=!0}catch{}var zt=Vx.call(_);Vt&&(e?_[Yf]=j:delete _[Yf]),_=zt}else _=Wx.call(_);return _},lb=function(_){var e=X(_);return _!=null&&(e=="object"||e=="function")},qi=function(_){return!!lb(_)&&((_=Qd(_))=="[object Function]"||_=="[object GeneratorFunction]"||_=="[object AsyncFunction]"||_=="[object Proxy]")},tk=Cb["__core-js_shared__"],Wp=function(){var _=/[^.]+$/.exec(tk&&tk.keys&&tk.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),Xx=Function.prototype.toString,Rd=function(_){if(_!=null){try{return Xx.call(_)}catch{}return _+""}return""},Yx=/^\[object .+?Constructor\]$/,Zx=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sd=function(_,e){return _=_==null?void 0:_[e],!lb(_)||Wp&&Wp in _||!(qi(_)?Zx:Yx).test(Rd(_))?void 0:_},Zf=Sd(Object,"create"),$x=Object.prototype.hasOwnProperty,ay=Object.prototype.hasOwnProperty;zd.prototype.clear=function(){this.__data__=Zf?Zf(null):{},this.size=0},zd.prototype.delete=function(_){return _=this.has(_)&&delete this.__data__[_],this.size-=_?1:0,_},zd.prototype.get=function(_){var e=this.__data__;return Zf?(_=e[_])==="__lodash_hash_undefined__"?void 0:_:$x.call(e,_)?e[_]:void 0},zd.prototype.has=function(_){var e=this.__data__;return Zf?e[_]!==void 0:ay.call(e,_)},zd.prototype.set=function(_,e){var j=this.__data__;return this.size+=this.has(_)?0:1,j[_]=Zf&&e===void 0?"__lodash_hash_undefined__":e,this};var $f=function(_,e){return _===e||_!=_&&e!=e},wh=function(_,e){for(var j=_.length;j--;)if($f(_[j][0],e))return j;return-1},by=Array.prototype.splice;ce.prototype.clear=function(){this.__data__=[],this.size=0},ce.prototype.delete=function(_){var e=this.__data__;return!(0>(_=wh(e,_)))&&(_==e.length-1?e.pop():by.call(e,_,1),--this.size,!0)},ce.prototype.get=function(_){var e=this.__data__;return 0>(_=wh(e,_))?void 0:e[_][1]},ce.prototype.has=function(_){return-1<wh(this.__data__,_)},ce.prototype.set=function(_,e){var j=this.__data__,Vt=wh(j,_);return 0>Vt?(++this.size,j.push([_,e])):j[Vt][1]=e,this};var rg=ce,ag=Sd(Cb,"Map"),xh=function(_,e){_=_.__data__;var j=X(e);return(j=="string"||j=="number"||j=="symbol"||j=="boolean"?e!=="__proto__":e===null)?_[typeof e=="string"?"string":"hash"]:_.map};de.prototype.clear=function(){this.size=0,this.__data__={hash:new zd,map:new(ag||rg),string:new zd}},de.prototype.delete=function(_){return _=xh(this,_).delete(_),this.size-=_?1:0,_},de.prototype.get=function(_){return xh(this,_).get(_)},de.prototype.has=function(_){return xh(this,_).has(_)},de.prototype.set=function(_,e){var j=xh(this,_),Vt=j.size;return j.set(_,e),this.size+=j.size==Vt?0:1,this};var qg=de;gf.prototype.add=gf.prototype.push=function(_){return this.__data__.set(_,"__lodash_hash_undefined__"),this},gf.prototype.has=function(_){return this.__data__.has(_)};var Xp=function(_,e,j,Vt){var zt=_.length;for(j+=-1;++j<zt;)if(e(_[j],j,_))return j;return-1},cy=function(_){return _!=_},dy=function(_,e){var j;if(j=!(_==null||!_.length)){if(e==e)e:{j=-1;for(var Vt=_.length;++j<Vt;)if(_[j]===e){_=j;break e}_=-1}else _=Xp(_,cy,0);j=-1<_}return j},ey=function(_,e,j){for(var Vt=-1,zt=_==null?0:_.length;++Vt<zt;)if(j(e,_[Vt]))return!0;return!1},fy=function(_,e){return _.has(e)},Re=Sd(Cb,"Set"),gy=function(){},uk=function(_){var e=-1,j=Array(_.size);return _.forEach(function(Vt){j[++e]=Vt}),j},hy=1/0,iy=Re&&1/uk(new Re([,-0]))[1]==hy?function(_){return new Re(_)}:gy,vk=function(_,e,j){var Vt=-1,zt=dy,_r=_.length,_o=!0,ga=[],_a=ga;if(j)_o=!1,zt=ey;else if(200<=_r){if(zt=iy(_))return uk(zt);_o=!1,zt=fy,_a=new gf}else _a=ga;e:for(;++Vt<_r;){var _l=_[Vt],_d=_l;if(_l=j||_l!==0?_l:0,_o&&_d==_d){for(var _f=_a.length;_f--;)if(_a[_f]===_d)continue e;ga.push(_l)}else zt(_a,_d,j)||(_a!==ga&&_a.push(_d),ga.push(_l))}return ga},Yp=function(_){for(var e=-1,j=_==null?0:_.length,Vt={};++e<j;){var zt=_[e];Vt[zt[0]]=zt[1]}return Vt},he=function(_,e){for(var j=-1,Vt=_==null?0:_.length,zt=Array(Vt);++j<Vt;)zt[j]=e(_[j],j,_);return zt};ee.prototype.clear=function(){this.__data__=new rg,this.size=0},ee.prototype.delete=function(_){var e=this.__data__;return _=e.delete(_),this.size=e.size,_},ee.prototype.get=function(_){return this.__data__.get(_)},ee.prototype.has=function(_){return this.__data__.has(_)},ee.prototype.set=function(_,e){var j=this.__data__;if(j instanceof rg){var Vt=j.__data__;if(!ag||199>Vt.length)return Vt.push([_,e]),this.size=++j.size,this;j=this.__data__=new qg(Vt)}return j.set(_,e),this.size=j.size,this};var ge=ee,Is=function(_,e){for(var j=-1,Vt=_==null?0:_.length;++j<Vt&&e(_[j],j,_)!==!1;);return _},yh=function(){try{var _=Sd(Object,"defineProperty");return _({},"",{}),_}catch{}}(),bg=function(_,e,j){e=="__proto__"&&yh?yh(_,e,{configurable:!0,enumerable:!0,value:j,writable:!0}):_[e]=j},jy=Object.prototype.hasOwnProperty,Ml=function(_,e,j){var Vt=_[e];jy.call(_,e)&&$f(Vt,j)&&(j!==void 0||e in _)||bg(_,e,j)},re=function(_,e,j,Vt){var zt=!j;j||(j={});for(var _r=-1,_o=e.length;++_r<_o;){var ga=e[_r],_a=void 0;_a===void 0&&(_a=_[ga]),zt?bg(j,ga,_a):Ml(j,ga,_a)}return j},gc=function(_){return _!=null&&X(_)=="object"},Zp=function(_){return gc(_)&&Qd(_)=="[object Arguments]"},$p=Object.prototype,ky=$p.hasOwnProperty,ly=$p.propertyIsEnumerable,rf=Zp(function(){return arguments}())?Zp:function(_){return gc(_)&&ky.call(_,"callee")&&!ly.call(_,"callee")},Va=Array.isArray,my=function(){return!1},jf=$a(function(_,e){var j=(e=e&&!e.nodeType&&e)&&_&&!_.nodeType&&_;e=j&&j.exports===e?Cb.Buffer:void 0,_.exports=(e?e.isBuffer:void 0)||my}),ny=/^(?:0|[1-9]\d*)$/,wk=function(_,e){var j=X(_);return!!(e=e??9007199254740991)&&(j=="number"||j!="symbol"&&ny.test(_))&&-1<_&&_%1==0&&_<e},xk=function(_){return typeof _=="number"&&-1<_&&_%1==0&&9007199254740991>=_},Ea={};Ea["[object Float32Array]"]=Ea["[object Float64Array]"]=Ea["[object Int8Array]"]=Ea["[object Int16Array]"]=Ea["[object Int32Array]"]=Ea["[object Uint8Array]"]=Ea["[object Uint8ClampedArray]"]=Ea["[object Uint16Array]"]=Ea["[object Uint32Array]"]=!0,Ea["[object Arguments]"]=Ea["[object Array]"]=Ea["[object ArrayBuffer]"]=Ea["[object Boolean]"]=Ea["[object DataView]"]=Ea["[object Date]"]=Ea["[object Error]"]=Ea["[object Function]"]=Ea["[object Map]"]=Ea["[object Number]"]=Ea["[object Object]"]=Ea["[object RegExp]"]=Ea["[object Set]"]=Ea["[object String]"]=Ea["[object WeakMap]"]=!1;var oy=function(_){return gc(_)&&xk(_.length)&&!!Ea[Qd(_)]},zh=function(_){return function(e){return _(e)}},Se=$a(function(_,e){var j=e&&!e.nodeType&&e;j=(e=j&&_&&!_.nodeType&&_)&&e.exports===j&&Tp.process;e:{try{var Vt=e&&e.require&&e.require("util").types;if(Vt){var zt=Vt;break e}zt=j&&j.binding&&j.binding("util");break e}catch{}zt=void 0}_.exports=zt}),aq=Se&&Se.isTypedArray,bi=aq?zh(aq):oy,py=Object.prototype.hasOwnProperty,bq=function(_,e){var j=Va(_),Vt=!j&&rf(_),zt=!j&&!Vt&&jf(_),_r=!j&&!Vt&&!zt&&bi(_);if(j=j||Vt||zt||_r){Vt=_.length;for(var _o=String,ga=-1,_a=Array(Vt);++ga<Vt;)_a[ga]=_o(ga);Vt=_a}else Vt=[];for(var _l in _o=Vt.length,_)!e&&!py.call(_,_l)||j&&(_l=="length"||zt&&(_l=="offset"||_l=="parent")||_r&&(_l=="buffer"||_l=="byteLength"||_l=="byteOffset")||wk(_l,_o))||Vt.push(_l);return Vt},qy=Object.prototype,yk=function(_){var e=_&&_.constructor;return _===(typeof e=="function"&&e.prototype||qy)},cq=function(_,e){return function(j){return _(e(j))}},ry=cq(Object.keys,Object),sy=Object.prototype.hasOwnProperty,Ed=function(_){return _!=null&&xk(_.length)&&!qi(_)},Ad=function(_){if(Ed(_))_=bq(_);else if(yk(_)){var e,j=[];for(e in Object(_))sy.call(_,e)&&e!="constructor"&&j.push(e);_=j}else _=ry(_);return _},Es=function(_,e){return _&&re(e,Ad(e),_)},ty=Object.prototype.hasOwnProperty,kf=function(_){if(Ed(_))_=bq(_,!0);else if(lb(_)){var e=yk(_),j=[];for(Vt in _)(Vt!="constructor"||!e&&ty.call(_,Vt))&&j.push(Vt);_=j}else{var Vt=[];if(_!=null)for(e in Object(_))Vt.push(e);_=Vt}return _},Cs=function(_,e){return _&&re(e,kf(e),_)},Jl=$a(function(_,e){var j=(e=e&&!e.nodeType&&e)&&_&&!_.nodeType&&_,Vt=(e=j&&j.exports===e?Cb.Buffer:void 0)?e.allocUnsafe:void 0;_.exports=function(zt,_r){return _r?zt.slice():(_r=zt.length,_r=Vt?Vt(_r):new zt.constructor(_r),zt.copy(_r),_r)}}),Xh=function(_,e){var j=-1,Vt=_.length;for(e||(e=Array(Vt));++j<Vt;)e[j]=_[j];return e},uy=function(_,e){for(var j=-1,Vt=_==null?0:_.length,zt=0,_r=[];++j<Vt;){var _o=_[j];e(_o,j,_)&&(_r[zt++]=_o)}return _r},dq=function(){return[]},vy=Object.prototype.propertyIsEnumerable,eq=Object.getOwnPropertySymbols,zk=eq?function(_){return _==null?[]:(_=Object(_),uy(eq(_),function(e){return vy.call(_,e)}))}:dq,Ds=function(_,e){return re(_,zk(_),e)},ai=function(_,e){for(var j=-1,Vt=e.length,zt=_.length;++j<Vt;)_[zt+j]=e[j];return _},Ak=cq(Object.getPrototypeOf,Object),fq=Object.getOwnPropertySymbols?function(_){for(var e=[];_;)ai(e,zk(_)),_=Ak(_);return e}:dq,Bs=function(_,e){return re(_,fq(_),e)},gq=function(_,e,j){return e=e(_),Va(_)?e:ai(e,j(_))},Yh=function(_){return gq(_,Ad,zk)},Ll=function(_){return gq(_,kf,fq)},Bk=Sd(Cb,"DataView"),Ck=Sd(Cb,"Promise"),Dk=Sd(Cb,"WeakMap"),wy=Rd(Bk),xy=Rd(ag),yy=Rd(Ck),zy=Rd(Re),Ay=Rd(Dk),Td=Qd;(Bk&&Td(new Bk(new ArrayBuffer(1)))!="[object DataView]"||ag&&Td(new ag)!="[object Map]"||Ck&&Td(Ck.resolve())!="[object Promise]"||Re&&Td(new Re)!="[object Set]"||Dk&&Td(new Dk)!="[object WeakMap]")&&(Td=function(_){var e=Qd(_);if(_=(_=e=="[object Object]"?_.constructor:void 0)?Rd(_):"")switch(_){case wy:return"[object DataView]";case xy:return"[object Map]";case yy:return"[object Promise]";case zy:return"[object Set]";case Ay:return"[object WeakMap]"}return e});var hf=Td,By=Object.prototype.hasOwnProperty,As=function(_){var e=_.length,j=new _.constructor(e);return e&&typeof _[0]=="string"&&By.call(_,"index")&&(j.index=_.index,j.input=_.input),j},Ah=Cb.Uint8Array,Ek=function(_){var e=new _.constructor(_.byteLength);return new Ah(e).set(new Ah(_)),e},Cy=/\w*$/,hq=Pb?Pb.prototype:void 0,iq=hq?hq.valueOf:void 0,vm=function(_,e){return e=e?Ek(_.buffer):_.buffer,new _.constructor(e,_.byteOffset,_.length)},Fs=function(_,e,j){var Vt=_.constructor;switch(e){case"[object ArrayBuffer]":return Ek(_);case"[object Boolean]":case"[object Date]":return new Vt(+_);case"[object DataView]":return e=j?Ek(_.buffer):_.buffer,new _.constructor(e,_.byteOffset,_.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return vm(_,j);case"[object Map]":return new Vt;case"[object Number]":case"[object String]":return new Vt(_);case"[object RegExp]":return(e=new _.constructor(_.source,Cy.exec(_))).lastIndex=_.lastIndex,e;case"[object Set]":return new Vt;case"[object Symbol]":return iq?Object(iq.call(_)):{}}},jq=Object.create,Dy=function(){function _(){}return function(e){return lb(e)?jq?jq(e):(_.prototype=e,e=new _,_.prototype=void 0,e):{}}}(),Kl=function(_){return typeof _.constructor!="function"||yk(_)?{}:Dy(Ak(_))},Ey=function(_){return gc(_)&&hf(_)=="[object Map]"},kq=Se&&Se.isMap,Hs=kq?zh(kq):Ey,Fy=function(_){return gc(_)&&hf(_)=="[object Set]"},lq=Se&&Se.isSet,Gs=lq?zh(lq):Fy,wa={};wa["[object Arguments]"]=wa["[object Array]"]=wa["[object ArrayBuffer]"]=wa["[object DataView]"]=wa["[object Boolean]"]=wa["[object Date]"]=wa["[object Float32Array]"]=wa["[object Float64Array]"]=wa["[object Int8Array]"]=wa["[object Int16Array]"]=wa["[object Int32Array]"]=wa["[object Map]"]=wa["[object Number]"]=wa["[object Object]"]=wa["[object RegExp]"]=wa["[object Set]"]=wa["[object String]"]=wa["[object Symbol]"]=wa["[object Uint8Array]"]=wa["[object Uint8ClampedArray]"]=wa["[object Uint16Array]"]=wa["[object Uint32Array]"]=!0,wa["[object Error]"]=wa["[object Function]"]=wa["[object WeakMap]"]=!1;var ie=function(_){return X(_)=="symbol"||gc(_)&&Qd(_)=="[object Symbol]"},Gy=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hy=/^\w*$/,Fk=function(_,e){if(Va(_))return!1;var j=X(_);return!(j!="number"&&j!="symbol"&&j!="boolean"&&_!=null&&!ie(_))||Hy.test(_)||!Gy.test(_)||e!=null&&_ in Object(e)};Zh.Cache=qg;var Iy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jy=/\\(\\)?/g,Ky=function(_){var e=(_=Zh(_,function(j){return e.size===500&&e.clear(),j})).cache;return _}(function(_){var e=[];return _.charCodeAt(0)===46&&e.push(""),_.replace(Iy,function(j,Vt,zt,_r){e.push(zt?_r.replace(Jy,"$1"):Vt||j)}),e}),Js=1/0,mq=Pb?Pb.prototype:void 0,Ol=mq?mq.toString:void 0,Bh=function(_,e){return Va(_)?_:Fk(_,e)?[_]:Ky(_==null?"":Nl(_))},Ly=1/0,cg=function(_){if(typeof _=="string"||ie(_))return _;var e=_+"";return e=="0"&&1/_==-Ly?"-0":e},Ch=function(_,e){for(var j=0,Vt=(e=Bh(e,_)).length;_!=null&&j<Vt;)_=_[cg(e[j++])];return j&&j==Vt?_:void 0},My=function(_,e){if(!(2>(e=Bh(e,_)).length)){var j=e,Vt=0,zt=-1,_r=-1,_o=j.length;for(0>Vt&&(Vt=-Vt>_o?0:_o+Vt),0>(zt=zt>_o?_o:zt)&&(zt+=_o),_o=Vt>zt?0:zt-Vt>>>0,Vt>>>=0,zt=Array(_o);++_r<_o;)zt[_r]=j[_r+Vt];_=Ch(_,zt)}return(j=_==null)||(j=e==null?0:e.length,j=delete _[cg(j?e[j-1]:void 0)]),j},nq=Function.prototype.toString,Ny=Object.prototype.hasOwnProperty,Oy=nq.call(Object),wm=function(_){return!(!gc(_)||Qd(_)!="[object Object]")&&((_=Ak(_))===null||typeof(_=Ny.call(_,"constructor")&&_.constructor)=="function"&&_ instanceof _&&nq.call(_)==Oy)},Py=function(_){return wm(_)?void 0:_},oq=Pb?Pb.isConcatSpreadable:void 0,Ks=function(_){return Va(_)||rf(_)||!!(oq&&_&&_[oq])},Qy=function(_){return _!=null&&_.length?$h(_):[]},Ry=function(_,e,j){switch(j.length){case 0:return _.call(e);case 1:return _.call(e,j[0]);case 2:return _.call(e,j[0],j[1]);case 3:return _.call(e,j[0],j[1],j[2])}return _.apply(e,j)},pq=Math.max,qq=function(_,e,j){return e=pq(e===void 0?_.length-1:e,0),function(){for(var Vt=arguments,zt=-1,_r=pq(Vt.length-e,0),_o=Array(_r);++zt<_r;)_o[zt]=Vt[e+zt];for(zt=-1,_r=Array(e+1);++zt<e;)_r[zt]=Vt[zt];return _r[e]=j(_o),Ry(_,this,_r)}},Sy=function(_){return function(){return _}},Dh=function(_){return _},Ty=Date.now,rq=function(_){var e=0,j=0;return function(){var Vt=Ty(),zt=16-(Vt-j);if(j=Vt,0<zt){if(800<=++e)return arguments[0]}else e=0;return _.apply(void 0,arguments)}}(yh?function(_,e){return yh(_,"toString",{configurable:!0,enumerable:!1,value:Sy(e),writable:!0})}:Dh),Gk=function(_){return rq(qq(_,void 0,Qy),_+"")}(function(_,e){var j={};if(_==null)return j;var Vt=!1;e=he(e,function(_r){return _r=Bh(_r,_),Vt||(Vt=1<_r.length),_r}),re(_,Ll(_),j),Vt&&(j=fe(j,7,Py));for(var zt=e.length;zt--;)My(j,e[zt]);return j}),Uy=function(_,e,j,Vt){for(var zt=-1,_r=_==null?0:_.length;++zt<_r;){var _o=_[zt];e(Vt,_o,j(_o),_)}return Vt},um=function(_,e,j){for(var Vt=-1,zt=Object(_),_r=(j=j(_)).length;_r--;){var _o=j[++Vt];if(e(zt[_o],_o,zt)===!1)break}return _},sq=function(_,e){return _&&um(_,e,Ad)},Hk=function(_,e){return function(j,Vt){if(j==null)return j;if(!Ed(j))return _(j,Vt);for(var zt=j.length,_r=-1,_o=Object(j);++_r<zt&&Vt(_o[_r],_r,_o)!==!1;);return j}}(sq),Vy=function(_,e,j,Vt){return Hk(_,function(zt,_r,_o){e(Vt,zt,j(zt),_o)}),Vt},tq=function(_,e){for(var j=-1,Vt=_==null?0:_.length;++j<Vt;)if(e(_[j],j,_))return!0;return!1},Pl=function(_,e,j,Vt,zt,_r){var _o=1&j,ga=_.length,_a=e.length;if(ga!=_a&&!(_o&&_a>ga))return!1;_a=_r.get(_);var _l=_r.get(e);if(_a&&_l)return _a==e&&_l==_;_a=-1,_l=!0;var _d=2&j?new gf:void 0;for(_r.set(_,e),_r.set(e,_);++_a<ga;){var _f=_[_a],_m=e[_a];if(Vt)var tE=_o?Vt(_m,_f,_a,e,_,_r):Vt(_f,_m,_a,_,e,_r);if(tE!==void 0){if(tE)continue;_l=!1;break}if(_d){if(!tq(e,function(rE,oE){if(!_d.has(oE)&&(_f===rE||zt(_f,rE,j,Vt,_r)))return _d.push(oE)})){_l=!1;break}}else if(_f!==_m&&!zt(_f,_m,j,Vt,_r)){_l=!1;break}}return _r.delete(_),_r.delete(e),_l},Wy=function(_){var e=-1,j=Array(_.size);return _.forEach(function(Vt,zt){j[++e]=[zt,Vt]}),j},uq=Pb?Pb.prototype:void 0,Ik=uq?uq.valueOf:void 0,Ls=function(_,e,j,Vt,zt,_r,_o){switch(j){case"[object DataView]":if(_.byteLength!=e.byteLength||_.byteOffset!=e.byteOffset)break;_=_.buffer,e=e.buffer;case"[object ArrayBuffer]":if(_.byteLength!=e.byteLength||!_r(new Ah(_),new Ah(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return $f(+_,+e);case"[object Error]":return _.name==e.name&&_.message==e.message;case"[object RegExp]":case"[object String]":return _==e+"";case"[object Map]":var ga=Wy;case"[object Set]":if(ga||(ga=uk),_.size!=e.size&&!(1&Vt))break;return(j=_o.get(_))?j==e:(Vt|=2,_o.set(_,e),e=Pl(ga(_),ga(e),Vt,zt,_r,_o),_o.delete(_),e);case"[object Symbol]":if(Ik)return Ik.call(_)==Ik.call(e)}return!1},Ms=Object.prototype.hasOwnProperty,Ql=Object.prototype.hasOwnProperty,Xy=function(_,e,j,Vt){var zt=j.length,_r=zt;if(_==null)return!_r;for(_=Object(_);zt--;){var _o=j[zt];if(_o[2]?_o[1]!==_[_o[0]]:!(_o[0]in _))return!1}for(;++zt<_r;){var ga=(_o=j[zt])[0],_a=_[ga],_l=_o[1];if(_o[2]){if(_a===void 0&&!(ga in _))return!1}else{var _d;if(_o=new ge,_d===void 0?!je(_l,_a,3,Vt,_o):!_d)return!1}}return!0},Yy=function(_){for(var e=Ad(_),j=e.length;j--;){var Vt=e[j],zt=_[Vt];e[j]=[Vt,zt,zt==zt&&!lb(zt)]}return e},vq=function(_,e){return function(j){return j!=null&&j[_]===e&&(e!==void 0||_ in Object(j))}},Zy=function(_){var e=Yy(_);return e.length==1&&e[0][2]?vq(e[0][0],e[0][1]):function(j){return j===_||Xy(j,_,e)}},$y=function(_,e){return Fk(_)&&e==e&&!lb(e)?vq(cg(_),e):function(j){var Vt=j==null?void 0:Ch(j,_);if((Vt=Vt===void 0?void 0:Vt)===void 0&&Vt===e){if(Vt=j!=null){for(var zt=-1,_r=(Vt=Bh(Vt=_,j)).length,_o=!1;++zt<_r;){var ga=cg(Vt[zt]);if(!(_o=j!=null&&j!=null&&ga in Object(j)))break;j=j[ga]}_o||++zt!=_r?Vt=_o:Vt=!!(_r=j==null?0:j.length)&&xk(_r)&&wk(ga,_r)&&(Va(j)||rf(j))}ga=Vt}else ga=je(e,Vt,3);return ga}},az=function(_){return function(e){return e==null?void 0:e[_]}},bz=function(_){return function(e){return Ch(e,_)}},Te=function(_){return typeof _=="function"?_:_==null?Dh:X(_)=="object"?Va(_)?$y(_[0],_[1]):Zy(_):Fk(_)?az(cg(_)):bz(_)},Jk=function(_,e){return function(j,Vt){var zt={};return(Va(j)?Uy:Vy)(j,_,Te(Vt),zt)}}(function(_,e,j){bg(_,j,e)}),uc=function(_,e){var j={};return e=Te(e),sq(_,function(Vt,zt,_r){bg(j,zt,e(Vt,zt,_r))}),j};N({target:"String",proto:!0,forced:R(function(){var _="".sub('"');return _!==_.toLowerCase()||3<_.split('"').length})},{sub:function(){return"<sub>"+String(jb(this))+"</sub>"}});var U=xa,Qb=null;try{Qb=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(_){}xa.prototype.__isLong__,Object.defineProperty(xa.prototype,"__isLong__",{value:!0}),xa.isLong=mb;var Sl={},Rl={};xa.fromInt=Bd,xa.fromNumber=Gb,xa.fromBits=ya;var sg=Math.pow;xa.fromString=ci,xa.fromValue=Wb;var ke=4294967296,Tl=ke*ke,Vl=Tl/2,wq=Bd(16777216),Hb=Bd(0);xa.ZERO=Hb;var Cd=Bd(0,!0);xa.UZERO=Cd;var Ue=Bd(1);xa.ONE=Ue;var xq=Bd(1,!0);xa.UONE=xq;var Kk=Bd(-1);xa.NEG_ONE=Kk;var Wl=ya(-1,2147483647,!1);xa.MAX_VALUE=Wl;var Ul=ya(-1,-1,!0);xa.MAX_UNSIGNED_VALUE=Ul;var nb=ya(0,-2147483648,!1);xa.MIN_VALUE=nb;var D=xa.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*ke+(this.low>>>0):this.high*ke+(this.low>>>0)},D.toString=function(_){if(2>(_=_||10)||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(nb)){var e=Gb(_),j=this.div(e);return e=j.mul(e).sub(this),j.toString(_)+e.toInt().toString(_)}return"-"+this.neg().toString(_)}j=Gb(sg(_,6),this.unsigned),e=this;for(var Vt="";;){var zt=e.div(j),_r=(e.sub(zt.mul(j)).toInt()>>>0).toString(_);if((e=zt).isZero())return _r+Vt;for(;6>_r.length;)_r="0"+_r;Vt=""+_r+Vt}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(nb)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,e=31;0<e&&!(_&1<<e);e--);return this.high!=0?e+33:e+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&0>this.high},D.isPositive=function(){return this.unsigned||0<=this.high},D.isOdd=function(){return(1&this.low)==1},D.isEven=function(){return(1&this.low)==0},D.equals=function(_){return mb(_)||(_=Wb(_)),(this.unsigned===_.unsigned||this.high>>>31!=1||_.high>>>31!=1)&&this.high===_.high&&this.low===_.low},D.eq=D.equals,D.notEquals=function(_){return!this.eq(_)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(_){return 0>this.comp(_)},D.lt=D.lessThan,D.lessThanOrEqual=function(_){return 0>=this.comp(_)},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(_){return 0<this.comp(_)},D.gt=D.greaterThan,D.greaterThanOrEqual=function(_){return 0<=this.comp(_)},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(_){if(mb(_)||(_=Wb(_)),this.eq(_))return 0;var e=this.isNegative(),j=_.isNegative();return e&&!j?-1:!e&&j?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(nb)?nb:this.not().add(Ue)},D.neg=D.negate,D.add=function(_){mb(_)||(_=Wb(_));var e=this.high>>>16,j=65535&this.high,Vt=this.low>>>16,zt=_.high>>>16,_r=65535&_.high,_o=_.low>>>16;return Vt=(_o=((_=(65535&this.low)+(65535&_.low))>>>16)+(Vt+_o))>>>16,ya((65535&_o)<<16|65535&_,(e=((Vt+=j+_r)>>>16)+(e+zt)&65535)<<16|65535&Vt,this.unsigned)},D.subtract=function(_){return mb(_)||(_=Wb(_)),this.add(_.neg())},D.sub=D.subtract,D.multiply=function(_){if(this.isZero())return Hb;if(mb(_)||(_=Wb(_)),Qb){var e=Qb.mul(this.low,this.high,_.low,_.high);return ya(e,Qb.get_high(),this.unsigned)}if(_.isZero())return Hb;if(this.eq(nb))return _.isOdd()?nb:Hb;if(_.eq(nb))return this.isOdd()?nb:Hb;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(wq)&&_.lt(wq))return Gb(this.toNumber()*_.toNumber(),this.unsigned);e=this.high>>>16;var j=65535&this.high,Vt=this.low>>>16,zt=65535&this.low,_r=_.high>>>16,_o=65535&_.high,ga=_.low>>>16,_a=zt*(_=65535&_.low),_l=(_a>>>16)+Vt*_,_d=_l>>>16;_d+=(_l=(65535&_l)+zt*ga)>>>16;var _f=(_d+=j*_)>>>16;return ya((65535&_l)<<16|65535&_a,(_f=(_f+=(_d=(65535&_d)+Vt*ga)>>>16)+((_d=(65535&_d)+zt*_o)>>>16)+(e*_+j*ga+Vt*_o+zt*_r)&65535)<<16|65535&_d,this.unsigned)},D.mul=D.multiply,D.divide=function(_){if(mb(_)||(_=Wb(_)),_.isZero())throw Error("division by zero");if(Qb)return this.unsigned||this.high!==-2147483648||_.low!==-1||_.high!==-1?ya(_=(this.unsigned?Qb.div_u:Qb.div_s)(this.low,this.high,_.low,_.high),Qb.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Cd:Hb;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return Cd;if(_.gt(this.shru(1)))return xq;var e=Cd}else{if(this.eq(nb)){if(_.eq(Ue)||_.eq(Kk))return nb;if(_.eq(nb))return Ue;var j=this.shr(1).div(_).shl(1);if(j.eq(Hb))return _.isNegative()?Ue:Kk;var Vt=this.sub(_.mul(j));return j.add(Vt.div(_))}if(_.eq(nb))return this.unsigned?Cd:Hb;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();e=Hb}for(Vt=this;Vt.gte(_);){j=Math.max(1,Math.floor(Vt.toNumber()/_.toNumber()));var zt=Math.ceil(Math.log(j)/Math.LN2);zt=48>=zt?1:sg(2,zt-48);for(var _r=Gb(j),_o=_r.mul(_);_o.isNegative()||_o.gt(Vt);)_o=(_r=Gb(j-=zt,this.unsigned)).mul(_);_r.isZero()&&(_r=Ue),e=e.add(_r),Vt=Vt.sub(_o)}return e},D.div=D.divide,D.modulo=function(_){return mb(_)||(_=Wb(_)),Qb?ya(_=(this.unsigned?Qb.rem_u:Qb.rem_s)(this.low,this.high,_.low,_.high),Qb.get_high(),this.unsigned):this.sub(this.div(_).mul(_))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return ya(~this.low,~this.high,this.unsigned)},D.and=function(_){return mb(_)||(_=Wb(_)),ya(this.low&_.low,this.high&_.high,this.unsigned)},D.or=function(_){return mb(_)||(_=Wb(_)),ya(this.low|_.low,this.high|_.high,this.unsigned)},D.xor=function(_){return mb(_)||(_=Wb(_)),ya(this.low^_.low,this.high^_.high,this.unsigned)},D.shiftLeft=function(_){return mb(_)&&(_=_.toInt()),(_&=63)==0?this:32>_?ya(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):ya(0,this.low<<_-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(_){return mb(_)&&(_=_.toInt()),(_&=63)==0?this:32>_?ya(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):ya(this.high>>_-32,0<=this.high?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(_){if(mb(_)&&(_=_.toInt()),(_&=63)===0)return this;var e=this.high;return 32>_?ya(this.low>>>_|e<<32-_,e>>>_,this.unsigned):ya(_===32?e:e>>>_-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?ya(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:ya(this.low,this.high,!0)},D.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var _=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&_,_>>>8&255,_>>>16&255,_>>>24]},D.toBytesBE=function(){var _=this.high,e=this.low;return[_>>>24,_>>>16&255,_>>>8&255,255&_,e>>>24,e>>>16&255,e>>>8&255,255&e]},xa.fromBytes=function(_,e,j){return j?xa.fromBytesLE(_,e):xa.fromBytesBE(_,e)},xa.fromBytesLE=function(_,e){return new xa(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,e)},xa.fromBytesBE=function(_,e){return new xa(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],e)};var di=function(_,e){return(di=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,Vt){j.__proto__=Vt}||function(j,Vt){for(var zt in Vt)Vt.hasOwnProperty(zt)&&(j[zt]=Vt[zt])})(_,e)},Lk=!1,Ib={Promise:void 0,set useDeprecatedSynchronousErrorHandling(_){_?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):Lk&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),Lk=_},get useDeprecatedSynchronousErrorHandling(){return Lk}},Eh={closed:!0,next:function(_){},error:function(_){if(Ib.useDeprecatedSynchronousErrorHandling)throw _;me(_)},complete:function(){}},Jb=Array.isArray||function(_){return _&&typeof _.length=="number"},lf=function(){function _(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(j,Vt){return Vt+1+") "+j.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return _.prototype=Object.create(Error.prototype),_}(),Oa=function(){function _(e){this.closed=!1,this._subscriptions=this._parentOrParents=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return _.prototype.unsubscribe=function(){if(!this.closed){var e=this._parentOrParents,j=this._ctorUnsubscribe,Vt=this._unsubscribe,zt=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,e instanceof _)e.remove(this);else if(e!==null)for(var _r=0;_r<e.length;++_r)e[_r].remove(this);if(le(Vt)){j&&(this._unsubscribe=void 0);try{Vt.call(this)}catch(ga){var _o=ga instanceof lf?Xl(ga.errors):[ga]}}if(Jb(zt)){for(_r=-1,e=zt.length;++_r<e;)if(ei(j=zt[_r]))try{j.unsubscribe()}catch(ga){_o=_o||[],ga instanceof lf?_o=_o.concat(Xl(ga.errors)):_o.push(ga)}}if(_o)throw new lf(_o)}},_.prototype.add=function(e){var j=e;if(!e)return _.EMPTY;switch(X(e)){case"function":j=new _(e);case"object":if(j===this||j.closed||typeof j.unsubscribe!="function")return j;if(this.closed)return j.unsubscribe(),j;j instanceof _||(e=j,(j=new _)._subscriptions=[e]);break;default:throw Error("unrecognized teardown "+e+" added to Subscription.")}if((e=j._parentOrParents)===null)j._parentOrParents=this;else if(e instanceof _){if(e===this)return j;j._parentOrParents=[e,this]}else{if(e.indexOf(this)!==-1)return j;e.push(this)}return(e=this._subscriptions)===null?this._subscriptions=[j]:e.push(j),j},_.prototype.remove=function(e){var j=this._subscriptions;j&&(e=j.indexOf(e))!==-1&&j.splice(e,1)},_.EMPTY=function(e){return e.closed=!0,e}(new _),_}(),Fh=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ia=function(_){function e(j,Vt,zt){var _r=_.call(this)||this;switch(_r.syncErrorValue=null,_r.syncErrorThrown=!1,_r.syncErrorThrowable=!1,_r.isStopped=!1,arguments.length){case 0:_r.destination=Eh;break;case 1:if(!j){_r.destination=Eh;break}if(X(j)==="object"){j instanceof e?(_r.syncErrorThrowable=j.syncErrorThrowable,_r.destination=j,j.add(_r)):(_r.syncErrorThrowable=!0,_r.destination=new yq(_r,j));break}default:_r.syncErrorThrowable=!0,_r.destination=new yq(_r,j,Vt,zt)}return _r}return O(e,_),e.prototype[Fh]=function(){return this},e.create=function(j,Vt,zt){return(j=new e(j,Vt,zt)).syncErrorThrowable=!1,j},e.prototype.next=function(j){this.isStopped||this._next(j)},e.prototype.error=function(j){this.isStopped||(this.isStopped=!0,this._error(j))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_.prototype.unsubscribe.call(this))},e.prototype._next=function(j){this.destination.next(j)},e.prototype._error=function(j){this.destination.error(j),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var j=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=j,this},e}(Oa),yq=function(_){function e(j,Vt,zt,_r){var _o=_.call(this)||this;if(_o._parentSubscriber=j,j=_o,le(Vt))var ga=Vt;else Vt&&(ga=Vt.next,zt=Vt.error,_r=Vt.complete,Vt!==Eh&&(le((j=Object.create(Vt)).unsubscribe)&&_o.add(j.unsubscribe.bind(j)),j.unsubscribe=_o.unsubscribe.bind(_o)));return _o._context=j,_o._next=ga,_o._error=zt,_o._complete=_r,_o}return O(e,_),e.prototype.next=function(j){if(!this.isStopped&&this._next){var Vt=this._parentSubscriber;Ib.useDeprecatedSynchronousErrorHandling&&Vt.syncErrorThrowable?this.__tryOrSetError(Vt,this._next,j)&&this.unsubscribe():this.__tryOrUnsub(this._next,j)}},e.prototype.error=function(j){if(!this.isStopped){var Vt=this._parentSubscriber,zt=Ib.useDeprecatedSynchronousErrorHandling;if(this._error)zt&&Vt.syncErrorThrowable?this.__tryOrSetError(Vt,this._error,j):this.__tryOrUnsub(this._error,j),this.unsubscribe();else if(Vt.syncErrorThrowable)zt?(Vt.syncErrorValue=j,Vt.syncErrorThrown=!0):me(j),this.unsubscribe();else{if(this.unsubscribe(),zt)throw j;me(j)}}},e.prototype.complete=function(){var j=this;if(!this.isStopped){var Vt=this._parentSubscriber;if(this._complete){var zt=function(){return j._complete.call(j._context)};Ib.useDeprecatedSynchronousErrorHandling&&Vt.syncErrorThrowable?this.__tryOrSetError(Vt,zt):this.__tryOrUnsub(zt)}this.unsubscribe()}},e.prototype.__tryOrUnsub=function(j,Vt){try{j.call(this._context,Vt)}catch(zt){if(this.unsubscribe(),Ib.useDeprecatedSynchronousErrorHandling)throw zt;me(zt)}},e.prototype.__tryOrSetError=function(j,Vt,zt){if(!Ib.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{Vt.call(this._context,zt)}catch(_r){return Ib.useDeprecatedSynchronousErrorHandling?(j.syncErrorValue=_r,j.syncErrorThrown=!0):me(_r),!0}return!1},e.prototype._unsubscribe=function(){var j=this._parentSubscriber;this._parentSubscriber=this._context=null,j.unsubscribe()},e}(ia),ne=typeof Symbol=="function"&&Symbol.observable||"@@observable",Y=function(){function _(e){this._isScalar=!1,e&&(this._subscribe=e)}return _.prototype.lift=function(e){var j=new _;return j.source=this,j.operator=e,j},_.prototype.subscribe=function(e,j,Vt){var zt=this.operator;e:{if(e){if(e instanceof ia)break e;if(e[Fh]){e=e[Fh]();break e}}e=e||j||Vt?new ia(e,j,Vt):new ia(Eh)}if(zt?e.add(zt.call(e,this.source)):e.add(this.source||Ib.useDeprecatedSynchronousErrorHandling&&!e.syncErrorThrowable?this._subscribe(e):this._trySubscribe(e)),Ib.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable&&(e.syncErrorThrowable=!1,e.syncErrorThrown))throw e.syncErrorValue;return e},_.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(j){Ib.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=j),fi(e)?e.error(j):console.warn(j)}},_.prototype.forEach=function(e,j){var Vt=this;return new(j=Zl(j))(function(zt,_r){var _o=Vt.subscribe(function(ga){try{e(ga)}catch(_a){_r(_a),_o&&_o.unsubscribe()}},_r,zt)})},_.prototype._subscribe=function(e){var j=this.source;return j&&j.subscribe(e)},_.prototype[ne]=function(){return this},_.prototype.pipe=function(){for(var e=[],j=0;j<arguments.length;j++)e[j]=arguments[j];return e.length===0?this:Yl(e)(this)},_.prototype.toPromise=function(e){var j=this;return new(e=Zl(e))(function(Vt,zt){var _r;j.subscribe(function(_o){return _r=_o},function(_o){return zt(_o)},function(){return Vt(_r)})})},_.create=function(e){return new _(e)},_}(),qd=function(){function _(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return _.prototype=Object.create(Error.prototype),_}(),zq=function(_){function e(j,Vt){var zt=_.call(this)||this;return zt.subject=j,zt.subscriber=Vt,zt.closed=!1,zt}return O(e,_),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var j=this.subject,Vt=j.observers;this.subject=null,!Vt||Vt.length===0||j.isStopped||j.closed||(j=Vt.indexOf(this.subscriber))!==-1&&Vt.splice(j,1)}},e}(Oa),Aq=function(_){function e(j){var Vt=_.call(this,j)||this;return Vt.destination=j,Vt}return O(e,_),e}(ia),Pa=function(_){function e(){var j=_.call(this)||this;return j.observers=[],j.closed=!1,j.isStopped=!1,j.hasError=!1,j.thrownError=null,j}return O(e,_),e.prototype[Fh]=function(){return new Aq(this)},e.prototype.lift=function(j){var Vt=new Bq(this,this);return Vt.operator=j,Vt},e.prototype.next=function(j){if(this.closed)throw new qd;if(!this.isStopped){var Vt=this.observers,zt=Vt.length;Vt=Vt.slice();for(var _r=0;_r<zt;_r++)Vt[_r].next(j)}},e.prototype.error=function(j){if(this.closed)throw new qd;this.hasError=!0,this.thrownError=j,this.isStopped=!0;var Vt=this.observers,zt=Vt.length;Vt=Vt.slice();for(var _r=0;_r<zt;_r++)Vt[_r].error(j);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new qd;this.isStopped=!0;var j=this.observers,Vt=j.length;j=j.slice();for(var zt=0;zt<Vt;zt++)j[zt].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},e.prototype._trySubscribe=function(j){if(this.closed)throw new qd;return _.prototype._trySubscribe.call(this,j)},e.prototype._subscribe=function(j){if(this.closed)throw new qd;return this.hasError?(j.error(this.thrownError),Oa.EMPTY):this.isStopped?(j.complete(),Oa.EMPTY):(this.observers.push(j),new zq(this,j))},e.prototype.asObservable=function(){var j=new Y;return j.source=this,j},e.create=function(j,Vt){return new Bq(j,Vt)},e}(Y),Bq=function(_){function e(j,Vt){var zt=_.call(this)||this;return zt.destination=j,zt.source=Vt,zt}return O(e,_),e.prototype.next=function(j){var Vt=this.destination;Vt&&Vt.next&&Vt.next(j)},e.prototype.error=function(j){var Vt=this.destination;Vt&&Vt.error&&this.destination.error(j)},e.prototype.complete=function(){var j=this.destination;j&&j.complete&&this.destination.complete()},e.prototype._subscribe=function(j){return this.source?this.source.subscribe(j):Oa.EMPTY},e}(Pa),Ns=function(){function _(e){this.connectable=e}return _.prototype.call=function(e,j){var Vt=this.connectable;return Vt._refCount++,e=new cz(e,Vt),j=j.subscribe(e),e.closed||(e.connection=Vt.connect()),j},_}(),cz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).connectable=Vt,j}return O(e,_),e.prototype._unsubscribe=function(){var j=this.connectable;if(j){this.connectable=null;var Vt=j._refCount;0>=Vt?this.connection=null:(j._refCount=Vt-1,1<Vt?this.connection=null:(Vt=this.connection,j=j._connection,this.connection=null,!j||Vt&&j!==Vt||j.unsubscribe()))}else this.connection=null},e}(ia),Cq=function(_){function e(j,Vt){var zt=_.call(this)||this;return zt.source=j,zt.subjectFactory=Vt,zt._refCount=0,zt._isComplete=!1,zt}return O(e,_),e.prototype._subscribe=function(j){return this.getSubject().subscribe(j)},e.prototype.getSubject=function(){var j=this._subject;return j&&!j.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var j=this._connection;return j||(this._isComplete=!1,(j=this._connection=new Oa).add(this.source.subscribe(new dz(this.getSubject(),this))),j.closed&&(this._connection=null,j=Oa.EMPTY)),j},e.prototype.refCount=function(){return $l()(this)},e}(Y),At=function(){var _=Cq.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:_._subscribe},_isComplete:{value:_._isComplete,writable:!0},getSubject:{value:_.getSubject},connect:{value:_.connect},refCount:{value:_.refCount}}}(),dz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).connectable=Vt,j}return O(e,_),e.prototype._error=function(j){this._unsubscribe(),_.prototype._error.call(this,j)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),_.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var j=this.connectable;if(j){this.connectable=null;var Vt=j._connection;j._refCount=0,j._subject=null,j._connection=null,Vt&&Vt.unsubscribe()}},e}(Aq);(function(_){function e(j,Vt){return(j=_.call(this,j)||this).connectable=Vt,j}O(e,_),e.prototype._unsubscribe=function(){var j=this.connectable;if(j){this.connectable=null;var Vt=j._refCount;0>=Vt?this.connection=null:(j._refCount=Vt-1,1<Vt?this.connection=null:(Vt=this.connection,j=j._connection,this.connection=null,!j||Vt&&j!==Vt||j.unsubscribe()))}else this.connection=null}})(ia),function(_){function e(j,Vt,zt,_r,_o){return(j=_.call(this,j)||this).keySelector=Vt,j.elementSelector=zt,j.durationSelector=_r,j.subjectSelector=_o,j.groups=null,j.attemptedToUnsubscribe=!1,j.count=0,j}O(e,_),e.prototype._next=function(j){try{var Vt=this.keySelector(j)}catch(zt){return void this.error(zt)}this._group(j,Vt)},e.prototype._group=function(j,Vt){var zt=this.groups;zt||(zt=this.groups=new Map);var _r=zt.get(Vt);if(this.elementSelector)try{var _o=this.elementSelector(j)}catch(ga){this.error(ga)}else _o=j;if(!_r&&(_r=this.subjectSelector?this.subjectSelector():new Pa,zt.set(Vt,_r),j=new Mk(Vt,_r,this),this.destination.next(j),this.durationSelector)){j=void 0;try{j=this.durationSelector(new Mk(Vt,_r))}catch(ga){return void this.error(ga)}this.add(j.subscribe(new ez(Vt,_r,this)))}_r.closed||_r.next(_o)},e.prototype._error=function(j){var Vt=this.groups;Vt&&(Vt.forEach(function(zt,_r){zt.error(j)}),Vt.clear()),this.destination.error(j)},e.prototype._complete=function(){var j=this.groups;j&&(j.forEach(function(Vt,zt){Vt.complete()}),j.clear()),this.destination.complete()},e.prototype.removeGroup=function(j){this.groups.delete(j)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&_.prototype.unsubscribe.call(this))}}(ia);var ez=function(_){function e(j,Vt,zt){var _r=_.call(this,Vt)||this;return _r.key=j,_r.group=Vt,_r.parent=zt,_r}return O(e,_),e.prototype._next=function(j){this.complete()},e.prototype._unsubscribe=function(){var j=this.parent,Vt=this.key;this.key=this.parent=null,j&&j.removeGroup(Vt)},e}(ia),Mk=function(_){function e(j,Vt,zt){var _r=_.call(this)||this;return _r.key=j,_r.groupSubject=Vt,_r.refCountSubscription=zt,_r}return O(e,_),e.prototype._subscribe=function(j){var Vt=new Oa,zt=this.refCountSubscription,_r=this.groupSubject;return zt&&!zt.closed&&Vt.add(new fz(zt)),Vt.add(_r.subscribe(j)),Vt},e}(Y),fz=function(_){function e(j){var Vt=_.call(this)||this;return Vt.parent=j,j.count++,Vt}return O(e,_),e.prototype.unsubscribe=function(){var j=this.parent;j.closed||this.closed||(_.prototype.unsubscribe.call(this),--j.count,j.count===0&&j.attemptedToUnsubscribe&&j.unsubscribe())},e}(Oa),gz=function(_){function e(j){var Vt=_.call(this)||this;return Vt._value=j,Vt}return O(e,_),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(j){var Vt=_.prototype._subscribe.call(this,j);return Vt&&!Vt.closed&&j.next(this._value),Vt},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new qd;return this._value},e.prototype.next=function(j){_.prototype.next.call(this,this._value=j)},e}(Pa),dg=function(_){function e(j,Vt){var zt=_.call(this,j,Vt)||this;return zt.scheduler=j,zt.work=Vt,zt.pending=!1,zt}return O(e,_),e.prototype.schedule=function(j,Vt){if(Vt===void 0&&(Vt=0),this.closed)return this;this.state=j,j=this.id;var zt=this.scheduler;return j!=null&&(this.id=this.recycleAsyncId(zt,j,Vt)),this.pending=!0,this.delay=Vt,this.id=this.id||this.requestAsyncId(zt,this.id,Vt),this},e.prototype.requestAsyncId=function(j,Vt,zt){return zt===void 0&&(zt=0),setInterval(j.flush.bind(j,this),zt)},e.prototype.recycleAsyncId=function(j,Vt,zt){if(zt===void 0&&(zt=0),zt!==null&&this.delay===zt&&this.pending===!1)return Vt;clearInterval(Vt)},e.prototype.execute=function(j,Vt){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(j=this._execute(j,Vt))?j:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},e.prototype._execute=function(j,Vt){Vt=!1;var zt=void 0;try{this.work(j)}catch(_r){Vt=!0,zt=!!_r&&_r||Error(_r)}if(Vt)return this.unsubscribe(),zt},e.prototype._unsubscribe=function(){var j=this.id,Vt=this.scheduler,zt=Vt.actions,_r=zt.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,_r!==-1&&zt.splice(_r,1),j!=null&&(this.id=this.recycleAsyncId(Vt,j,null)),this.delay=null},e}(function(_){function e(j,Vt){return _.call(this)||this}return O(e,_),e.prototype.schedule=function(j,Vt){return this},e}(Oa)),hz=function(_){function e(j,Vt){var zt=_.call(this,j,Vt)||this;return zt.scheduler=j,zt.work=Vt,zt}return O(e,_),e.prototype.schedule=function(j,Vt){return Vt===void 0&&(Vt=0),0<Vt?_.prototype.schedule.call(this,j,Vt):(this.delay=Vt,this.state=j,this.scheduler.flush(this),this)},e.prototype.execute=function(j,Vt){return 0<Vt||this.closed?_.prototype.execute.call(this,j,Vt):this._execute(j,Vt)},e.prototype.requestAsyncId=function(j,Vt,zt){return zt===void 0&&(zt=0),zt!==null&&0<zt||zt===null&&0<this.delay?_.prototype.requestAsyncId.call(this,j,Vt,zt):j.flush(this)},e}(dg),Nk=function(){function _(e,j){j===void 0&&(j=_.now),this.SchedulerAction=e,this.now=j}return _.prototype.schedule=function(e,j,Vt){return j===void 0&&(j=0),new this.SchedulerAction(this,e).schedule(Vt,j)},_.now=function(){return Date.now()},_}(),eg=function(_){function e(j,Vt){Vt===void 0&&(Vt=Nk.now);var zt=_.call(this,j,function(){return e.delegate&&e.delegate!==zt?e.delegate.now():Vt()})||this;return zt.actions=[],zt.active=!1,zt.scheduled=void 0,zt}return O(e,_),e.prototype.schedule=function(j,Vt,zt){return Vt===void 0&&(Vt=0),e.delegate&&e.delegate!==this?e.delegate.schedule(j,Vt,zt):_.prototype.schedule.call(this,j,Vt,zt)},e.prototype.flush=function(j){var Vt=this.actions;if(this.active)Vt.push(j);else{var zt;this.active=!0;do if(zt=j.execute(j.state,j.delay))break;while(j=Vt.shift());if(this.active=!1,zt){for(;j=Vt.shift();)j.unsubscribe();throw zt}}},e}(Nk),fg=new(function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e}(eg))(hz),vb=new Y(function(_){return _.complete()}),am=function(_){return function(e){for(var j=0,Vt=_.length;j<Vt&&!e.closed;j++)e.next(_[j]);e.complete()}},Ok;(function(_){_.NEXT="N",_.ERROR="E",_.COMPLETE="C"})(Ok||(Ok={}));var Ve=function(){function _(e,j,Vt){this.kind=e,this.value=j,this.error=Vt,this.hasValue=e==="N"}return _.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},_.prototype.do=function(e,j,Vt){switch(this.kind){case"N":return e&&e(this.value);case"E":return j&&j(this.error);case"C":return Vt&&Vt()}},_.prototype.accept=function(e,j,Vt){return e&&typeof e.next=="function"?this.observe(e):this.do(e,j,Vt)},_.prototype.toObservable=function(){switch(this.kind){case"N":return bb(this.value);case"E":return Z(this.error);case"C":return mf()}throw Error("unexpected notification kind value")},_.createNext=function(e){return e!==void 0?new _("N",e):_.undefinedValueNotification},_.createError=function(e){return new _("E",void 0,e)},_.createComplete=function(){return _.completeNotification},_.completeNotification=new _("C"),_.undefinedValueNotification=new _("N",void 0),_}(),Rs=function(){function _(e,j){j===void 0&&(j=0),this.scheduler=e,this.delay=j}return _.prototype.call=function(e,j){return j.subscribe(new Dq(e,this.scheduler,this.delay))},_}(),Dq=function(_){function e(j,Vt,zt){return zt===void 0&&(zt=0),(j=_.call(this,j)||this).scheduler=Vt,j.delay=zt,j}return O(e,_),e.dispatch=function(j){j.notification.observe(j.destination),this.unsubscribe()},e.prototype.scheduleMessage=function(j){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new iz(j,this.destination)))},e.prototype._next=function(j){this.scheduleMessage(Ve.createNext(j))},e.prototype._error=function(j){this.scheduleMessage(Ve.createError(j)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Ve.createComplete()),this.unsubscribe()},e}(ia),iz=function(_,e){this.notification=_,this.destination=e},qe=function(_){function e(j,Vt,zt){j===void 0&&(j=Number.POSITIVE_INFINITY),Vt===void 0&&(Vt=Number.POSITIVE_INFINITY);var _r=_.call(this)||this;return _r.scheduler=zt,_r._events=[],_r._infiniteTimeWindow=!1,_r._bufferSize=1>j?1:j,_r._windowTime=1>Vt?1:Vt,Vt===Number.POSITIVE_INFINITY?(_r._infiniteTimeWindow=!0,_r.next=_r.nextInfiniteTimeWindow):_r.next=_r.nextTimeWindow,_r}return O(e,_),e.prototype.nextInfiniteTimeWindow=function(j){if(!this.isStopped){var Vt=this._events;Vt.push(j),Vt.length>this._bufferSize&&Vt.shift()}_.prototype.next.call(this,j)},e.prototype.nextTimeWindow=function(j){this.isStopped||(this._events.push(new jz(this._getNow(),j)),this._trimBufferThenGetEvents()),_.prototype.next.call(this,j)},e.prototype._subscribe=function(j){var Vt=this._infiniteTimeWindow,zt=Vt?this._events:this._trimBufferThenGetEvents(),_r=this.scheduler,_o=zt.length;if(this.closed)throw new qd;if(this.isStopped||this.hasError)var ga=Oa.EMPTY;else this.observers.push(j),ga=new zq(this,j);if(_r&&j.add(j=new Dq(j,_r)),Vt)for(Vt=0;Vt<_o&&!j.closed;Vt++)j.next(zt[Vt]);else for(Vt=0;Vt<_o&&!j.closed;Vt++)j.next(zt[Vt].value);return this.hasError?j.error(this.thrownError):this.isStopped&&j.complete(),ga},e.prototype._getNow=function(){return(this.scheduler||fg).now()},e.prototype._trimBufferThenGetEvents=function(){for(var j=this._getNow(),Vt=this._bufferSize,zt=this._windowTime,_r=this._events,_o=_r.length,ga=0;ga<_o&&!(j-_r[ga].time<zt);)ga++;return _o>Vt&&(ga=Math.max(ga,_o-Vt)),0<ga&&_r.splice(0,ga),_r},e}(Pa),jz=function(_,e){this.time=_,this.value=e},of=function(_){function e(){var j=_!==null&&_.apply(this,arguments)||this;return j.value=null,j.hasNext=!1,j.hasCompleted=!1,j}return O(e,_),e.prototype._subscribe=function(j){return this.hasError?(j.error(this.thrownError),Oa.EMPTY):this.hasCompleted&&this.hasNext?(j.next(this.value),j.complete(),Oa.EMPTY):_.prototype._subscribe.call(this,j)},e.prototype.next=function(j){this.hasCompleted||(this.value=j,this.hasNext=!0)},e.prototype.error=function(j){this.hasCompleted||_.prototype.error.call(this,j)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&_.prototype.next.call(this,this.value),_.prototype.complete.call(this)},e}(Pa),kz=1,lz=Promise.resolve(),ii={},Eq={setImmediate:function(_){var e=kz++;return ii[e]=!0,lz.then(function(){return bm(e)&&_()}),e},clearImmediate:function(_){bm(_)}},mz=function(_){function e(j,Vt){var zt=_.call(this,j,Vt)||this;return zt.scheduler=j,zt.work=Vt,zt}return O(e,_),e.prototype.requestAsyncId=function(j,Vt,zt){return zt===void 0&&(zt=0),zt!==null&&0<zt?_.prototype.requestAsyncId.call(this,j,Vt,zt):(j.actions.push(this),j.scheduled||(j.scheduled=Eq.setImmediate(j.flush.bind(j,null))))},e.prototype.recycleAsyncId=function(j,Vt,zt){if(zt===void 0&&(zt=0),zt!==null&&0<zt||zt===null&&0<this.delay)return _.prototype.recycleAsyncId.call(this,j,Vt,zt);j.actions.length===0&&(Eq.clearImmediate(Vt),j.scheduled=void 0)},e}(dg),ri=new(function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e.prototype.flush=function(j){this.active=!0,this.scheduled=void 0;var Vt,zt=this.actions,_r=-1,_o=zt.length;j=j||zt.shift();do if(Vt=j.execute(j.state,j.delay))break;while(++_r<_o&&(j=zt.shift()));if(this.active=!1,Vt){for(;++_r<_o&&(j=zt.shift());)j.unsubscribe();throw Vt}},e}(eg))(mz),nz=ri,Pk=new eg(dg),bd=Pk,oz=function(_){function e(j,Vt){var zt=_.call(this,j,Vt)||this;return zt.scheduler=j,zt.work=Vt,zt}return O(e,_),e.prototype.requestAsyncId=function(j,Vt,zt){return zt===void 0&&(zt=0),zt!==null&&0<zt?_.prototype.requestAsyncId.call(this,j,Vt,zt):(j.actions.push(this),j.scheduled||(j.scheduled=requestAnimationFrame(function(){return j.flush(null)})))},e.prototype.recycleAsyncId=function(j,Vt,zt){if(zt===void 0&&(zt=0),zt!==null&&0<zt||zt===null&&0<this.delay)return _.prototype.recycleAsyncId.call(this,j,Vt,zt);j.actions.length===0&&(cancelAnimationFrame(Vt),j.scheduled=void 0)},e}(dg),Fq=new(function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e.prototype.flush=function(j){this.active=!0,this.scheduled=void 0;var Vt,zt=this.actions,_r=-1,_o=zt.length;j=j||zt.shift();do if(Vt=j.execute(j.state,j.delay))break;while(++_r<_o&&(j=zt.shift()));if(this.active=!1,Vt){for(;++_r<_o&&(j=zt.shift());)j.unsubscribe();throw Vt}},e}(eg))(oz),pz=function(_){function e(j,Vt){j===void 0&&(j=Gq),Vt===void 0&&(Vt=Number.POSITIVE_INFINITY);var zt=_.call(this,j,function(){return zt.frame})||this;return zt.maxFrames=Vt,zt.frame=0,zt.index=-1,zt}return O(e,_),e.prototype.flush=function(){for(var j,Vt,zt=this.actions,_r=this.maxFrames;(Vt=zt[0])&&Vt.delay<=_r&&(zt.shift(),this.frame=Vt.delay,!(j=Vt.execute(Vt.state,Vt.delay))););if(j){for(;Vt=zt.shift();)Vt.unsubscribe();throw j}},e.frameTimeFactor=10,e}(eg),Gq=function(_){function e(j,Vt,zt){zt===void 0&&(zt=j.index+=1);var _r=_.call(this,j,Vt)||this;return _r.scheduler=j,_r.work=Vt,_r.index=zt,_r.active=!0,_r.index=j.index=zt,_r}return O(e,_),e.prototype.schedule=function(j,Vt){if(Vt===void 0&&(Vt=0),!this.id)return _.prototype.schedule.call(this,j,Vt);this.active=!1;var zt=new e(this.scheduler,this.work);return this.add(zt),zt.schedule(j,Vt)},e.prototype.requestAsyncId=function(j,Vt,zt){return zt===void 0&&(zt=0),this.delay=j.frame+zt,(j=j.actions).push(this),j.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(j,Vt,zt){},e.prototype._execute=function(j,Vt){if(this.active===!0)return _.prototype._execute.call(this,j,Vt)},e.sortActions=function(j,Vt){return j.delay===Vt.delay?j.index===Vt.index?0:j.index>Vt.index?1:-1:j.delay>Vt.delay?1:-1},e}(dg),Qk=function(){function _(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return _.prototype=Object.create(Error.prototype),_}(),vg=function(){function _(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return _.prototype=Object.create(Error.prototype),_}(),pb=function(){function _(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return _.prototype=Object.create(Error.prototype),_}(),Ss=function(){function _(e,j){this.project=e,this.thisArg=j}return _.prototype.call=function(e,j){return j.subscribe(new qz(e,this.project,this.thisArg))},_}(),qz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).project=Vt,j.count=0,j.thisArg=zt||j,j}return O(e,_),e.prototype._next=function(j){try{var Vt=this.project.call(this.thisArg,j,this.count++)}catch(zt){return void this.destination.error(zt)}this.destination.next(Vt)},e}(ia),Rk=function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e.prototype.notifyNext=function(j,Vt,zt,_r,_o){this.destination.next(Vt)},e.prototype.notifyError=function(j,Vt){this.destination.error(j)},e.prototype.notifyComplete=function(j){this.destination.complete()},e}(ia),Xs=function(_){function e(j,Vt,zt){var _r=_.call(this)||this;return _r.parent=j,_r.outerValue=Vt,_r.outerIndex=zt,_r.index=0,_r}return O(e,_),e.prototype._next=function(j){this.parent.notifyNext(this.outerValue,j,this.outerIndex,this.index++,this)},e.prototype._error=function(j){this.parent.notifyError(j,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(ia),rz=function(_){return function(e){return _.then(function(j){e.closed||(e.next(j),e.complete())},function(j){return e.error(j)}).then(null,me),e}},$c=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",sz=function(_){return function(e){for(var j=_[$c]();;){var Vt=void 0;try{Vt=j.next()}catch(zt){return e.error(zt),e}if(Vt.done){e.complete();break}if(e.next(Vt.value),e.closed)break}return typeof j.return=="function"&&e.add(function(){j.return&&j.return()}),e}},tz=function(_){return function(e){var j=_[ne]();if(typeof j.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return j.subscribe(e)}},hm=function(_){return _&&typeof _.length=="number"&&typeof _!="function"},pf=function(_){if(_&&typeof _[ne]=="function")return tz(_);if(hm(_))return am(_);if(fm(_))return rz(_);if(_&&typeof _[$c]=="function")return sz(_);throw _=ei(_)?"an invalid object":"'"+_+"'",new TypeError("You provided "+_+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Hq={},vz=function(){function _(e){this.resultSelector=e}return _.prototype.call=function(e,j){return j.subscribe(new uz(e,this.resultSelector))},_}(),uz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).resultSelector=Vt,j.active=0,j.values=[],j.observables=[],j}return O(e,_),e.prototype._next=function(j){this.values.push(Hq),this.observables.push(j)},e.prototype._complete=function(){var j=this.observables,Vt=j.length;if(Vt===0)this.destination.complete();else{this.toRespond=this.active=Vt;for(var zt=0;zt<Vt;zt++)this.add(ji(this,j[zt],void 0,zt))}},e.prototype.notifyComplete=function(j){--this.active==0&&this.destination.complete()},e.prototype.notifyNext=function(j,Vt,zt){var _r=(j=this.values)[zt];_r=this.toRespond?_r===Hq?--this.toRespond:this.toRespond:0,j[zt]=Vt,_r===0&&(this.resultSelector?this._tryResultSelector(j):this.destination.next(j.slice()))},e.prototype._tryResultSelector=function(j){try{var Vt=this.resultSelector.apply(this,j)}catch(zt){return void this.destination.error(zt)}this.destination.next(Vt)},e}(Rk),vc=function(_){function e(j){var Vt=_.call(this)||this;return Vt.parent=j,Vt}return O(e,_),e.prototype._next=function(j){this.parent.notifyNext(j)},e.prototype._error=function(j){this.parent.notifyError(j),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(ia);(function(_){function e(j,Vt,zt){var _r=_.call(this)||this;return _r.parent=j,_r.outerValue=Vt,_r.outerIndex=zt,_r}O(e,_),e.prototype._next=function(j){this.parent.notifyNext(this.outerValue,j,this.outerIndex,this)},e.prototype._error=function(j){this.parent.notifyError(j),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(ia);var wc=function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e.prototype.notifyNext=function(j){this.destination.next(j)},e.prototype.notifyError=function(j){this.destination.error(j)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(ia);(function(_){function e(){return _!==null&&_.apply(this,arguments)||this}O(e,_),e.prototype.notifyNext=function(j,Vt,zt,_r){this.destination.next(Vt)},e.prototype.notifyError=function(j){this.destination.error(j)},e.prototype.notifyComplete=function(j){this.destination.complete()}})(ia);var at=function(){function _(e,j){j===void 0&&(j=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=j}return _.prototype.call=function(e,j){return j.subscribe(new wz(e,this.project,this.concurrent))},_}(),wz=function(_){function e(j,Vt,zt){return zt===void 0&&(zt=Number.POSITIVE_INFINITY),(j=_.call(this,j)||this).project=Vt,j.concurrent=zt,j.hasCompleted=!1,j.buffer=[],j.active=0,j.index=0,j}return O(e,_),e.prototype._next=function(j){this.active<this.concurrent?this._tryNext(j):this.buffer.push(j)},e.prototype._tryNext=function(j){var Vt=this.index++;try{var zt=this.project(j,Vt)}catch(_r){return void this.destination.error(_r)}this.active++,this._innerSub(zt)},e.prototype._innerSub=function(j){var Vt=new vc(this),zt=this.destination;zt.add(Vt),(j=ic(j,Vt))!==Vt&&zt.add(j)},e.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(j){this.destination.next(j)},e.prototype.notifyComplete=function(){var j=this.buffer;this.active--,0<j.length?this._next(j.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},e}(wc),Sk=y.parseFloat,Iq=1/Sk(`	
\v\f\r \u2028\u2029\uFEFF-0`)!=-1/0?function(_){_=ik(String(_));var e=Sk(_);return e===0&&_.charAt(0)=="-"?-0:e}:Sk;N({global:!0,forced:parseFloat!=Iq},{parseFloat:Iq});var Tk=new Y(hc),ft=function(){function _(e,j){this.predicate=e,this.thisArg=j}return _.prototype.call=function(e,j){return j.subscribe(new xz(e,this.predicate,this.thisArg))},_}(),xz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).predicate=Vt,j.thisArg=zt,j.count=0,j}return O(e,_),e.prototype._next=function(j){try{var Vt=this.predicate.call(this.thisArg,j,this.count++)}catch(zt){return void this.destination.error(zt)}Vt&&this.destination.next(j)},e}(ia),gt=function(){function _(){}return _.prototype.call=function(e,j){return j.subscribe(new yz(e))},_}(),yz=function(_){function e(j){return(j=_.call(this,j)||this).hasFirst=!1,j.observables=[],j.subscriptions=[],j}return O(e,_),e.prototype._next=function(j){this.observables.push(j)},e.prototype._complete=function(){var j=this.observables,Vt=j.length;if(Vt===0)this.destination.complete();else{for(var zt=0;zt<Vt&&!this.hasFirst;zt++){var _r=ji(this,j[zt],void 0,zt);this.subscriptions&&this.subscriptions.push(_r),this.add(_r)}this.observables=null}},e.prototype.notifyNext=function(j,Vt,zt){if(!this.hasFirst){for(this.hasFirst=!0,j=0;j<this.subscriptions.length;j++)if(j!==zt){var _r=this.subscriptions[j];_r.unsubscribe(),this.remove(_r)}this.subscriptions=null}this.destination.next(Vt)},e}(Rk),jt=function(){function _(e){this.resultSelector=e}return _.prototype.call=function(e,j){return j.subscribe(new zz(e,this.resultSelector))},_}(),zz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).resultSelector=Vt,j.iterators=[],j.active=0,j.resultSelector=typeof Vt=="function"?Vt:void 0,j}return O(e,_),e.prototype._next=function(j){var Vt=this.iterators;Jb(j)?Vt.push(new Az(j)):typeof j[$c]=="function"?Vt.push(new Bz(j[$c]())):Vt.push(new Cz(this.destination,this,j))},e.prototype._complete=function(){var j=this.iterators,Vt=j.length;if(this.unsubscribe(),Vt===0)this.destination.complete();else{this.active=Vt;for(var zt=0;zt<Vt;zt++){var _r=j[zt];_r.stillUnsubscribed?this.destination.add(_r.subscribe()):this.active--}}},e.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},e.prototype.checkIterators=function(){for(var j=this.iterators,Vt=j.length,zt=this.destination,_r=0;_r<Vt;_r++){var _o=j[_r];if(typeof _o.hasValue=="function"&&!_o.hasValue())return}var ga=!1,_a=[];for(_r=0;_r<Vt;_r++){var _l=(_o=j[_r]).next();if(_o.hasCompleted()&&(ga=!0),_l.done)return void zt.complete();_a.push(_l.value)}this.resultSelector?this._tryresultSelector(_a):zt.next(_a),ga&&zt.complete()},e.prototype._tryresultSelector=function(j){try{var Vt=this.resultSelector.apply(this,j)}catch(zt){return void this.destination.error(zt)}this.destination.next(Vt)},e}(ia),Bz=function(){function _(e){this.iterator=e,this.nextResult=e.next()}return _.prototype.hasValue=function(){return!0},_.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},_.prototype.hasCompleted=function(){var e=this.nextResult;return!(!e||!e.done)},_}(),Az=function(){function _(e){this.array=e,this.length=this.index=0,this.length=e.length}return _.prototype[$c]=function(){return this},_.prototype.next=function(e){e=this.index++;var j=this.array;return e<this.length?{value:j[e],done:!1}:{value:null,done:!0}},_.prototype.hasValue=function(){return this.array.length>this.index},_.prototype.hasCompleted=function(){return this.array.length===this.index},_}(),Cz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).parent=Vt,j.observable=zt,j.stillUnsubscribed=!0,j.buffer=[],j.isComplete=!1,j}return O(e,_),e.prototype[$c]=function(){return this},e.prototype.next=function(){var j=this.buffer;return j.length===0&&this.isComplete?{value:null,done:!0}:{value:j.shift(),done:!1}},e.prototype.hasValue=function(){return 0<this.buffer.length},e.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},e.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(j){this.buffer.push(j),this.parent.checkIterators()},e.prototype.subscribe=function(){return ic(this.observable,new vc(this))},e}(wc),Dz=Object.freeze({__proto__:null,Observable:Y,ConnectableObservable:Cq,GroupedObservable:Mk,observable:ne,Subject:Pa,BehaviorSubject:gz,ReplaySubject:qe,AsyncSubject:of,asap:nz,asapScheduler:ri,async:bd,asyncScheduler:Pk,queue:fg,queueScheduler:fg,animationFrame:Fq,animationFrameScheduler:Fq,VirtualTimeScheduler:pz,VirtualAction:Gq,Scheduler:Nk,Subscription:Oa,Subscriber:ia,Notification:Ve,get NotificationKind(){return Ok},pipe:gi,noop:hc,identity:Yc,isObservable:function(_){return!!_&&(_ instanceof Y||typeof _.lift=="function"&&typeof _.subscribe=="function")},ArgumentOutOfRangeError:Qk,EmptyError:vg,ObjectUnsubscribedError:qd,UnsubscriptionError:lf,TimeoutError:pb,bindCallback:cm,bindNodeCallback:dm,combineLatest:function(){for(var _=[],e=0;e<arguments.length;e++)_[e]=arguments[e];var j=e=void 0;return Zc(_[_.length-1])&&(j=_.pop()),typeof _[_.length-1]=="function"&&(e=_.pop()),_.length===1&&Jb(_[0])&&(_=_[0]),nf(_,j).lift(new vz(e))},concat:im,defer:ad,empty:mf,forkJoin:jm,from:Kb,fromEvent:gb,fromEventPattern:lm,generate:function(_,e,j,Vt,zt){if(arguments.length==1){var _r=_.initialState;e=_.condition,j=_.iterate;var _o=_.resultSelector||Yc;zt=_.scheduler}else Vt===void 0||Zc(Vt)?(_r=_,_o=Yc,zt=Vt):(_r=_,_o=Vt);return new Y(function(ga){var _a=_r;if(zt)return zt.schedule(bt,0,{subscriber:ga,iterate:j,condition:e,resultSelector:_o,state:_a});for(;;){if(e){var _l=void 0;try{_l=e(_a)}catch(_d){ga.error(_d);break}if(!_l){ga.complete();break}}_l=void 0;try{_l=_o(_a)}catch(_d){ga.error(_d);break}if(ga.next(_l),ga.closed)break;try{_a=j(_a)}catch(_d){ga.error(_d);break}}})},iif:function(_,e,j){return e===void 0&&(e=vb),j===void 0&&(j=vb),ad(function(){return _()?e:j})},interval:mm,merge:Xb,never:function(){return Tk},of:bb,onErrorResumeNext:li,pairs:function(_,e){return new Y(e?function(j){var Vt=Object.keys(_),zt=new Oa;return zt.add(e.schedule(dt,0,{keys:Vt,index:0,subscriber:j,subscription:zt,obj:_})),zt}:function(j){for(var Vt=Object.keys(_),zt=0;zt<Vt.length&&!j.closed;zt++){var _r=Vt[zt];_.hasOwnProperty(_r)&&j.next([_r,_[_r]])}j.complete()})},partition:function(_,e,j){return[wb(e,j)(new Y(pf(_))),wb(et(e,j))(new Y(pf(_)))]},race:Ca,range:function(_,e,j){return _===void 0&&(_=0),new Y(function(Vt){e===void 0&&(e=_,_=0);var zt=0,_r=_;if(j)return j.schedule(ht,0,{index:zt,count:e,start:_,subscriber:Vt});for(;;){if(zt++>=e){Vt.complete();break}if(Vt.next(_r++),Vt.closed)break}})},throwError:Z,timer:Bc,using:function(_,e){return new Y(function(j){try{var Vt=_()}catch(_o){return void j.error(_o)}try{var zt=e(Vt)}catch(_o){return void j.error(_o)}var _r=(zt?Kb(zt):vb).subscribe(j);return function(){_r.unsubscribe(),Vt&&Vt.unsubscribe()}})},zip:mi,scheduled:gm,EMPTY:vb,NEVER:Tk,config:Ib}),kt=function(){function _(e){this.selector=e}return _.prototype.call=function(e,j){return j.subscribe(new Ez(e,this.selector,this.caught))},_}(),Ez=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).selector=Vt,j.caught=zt,j}return O(e,_),e.prototype.error=function(j){if(!this.isStopped){var Vt=void 0;try{Vt=this.selector(j,this.caught)}catch(zt){return void _.prototype.error.call(this,zt)}this._unsubscribeAndRecycle(),j=new vc(this),this.add(j),(Vt=ic(Vt,j))!==j&&this.add(Vt)}},e}(wc),lt=function(){function _(e){this.defaultValue=e}return _.prototype.call=function(e,j){return j.subscribe(new Fz(e,this.defaultValue))},_}(),Fz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).defaultValue=Vt,j.isEmpty=!0,j}return O(e,_),e.prototype._next=function(j){this.isEmpty=!1,this.destination.next(j)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(ia),mt=function(){function _(e,j){this.delay=e,this.scheduler=j}return _.prototype.call=function(e,j){return j.subscribe(new Gz(e,this.delay,this.scheduler))},_}(),Gz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).delay=Vt,j.scheduler=zt,j.queue=[],j.active=!1,j.errored=!1,j}return O(e,_),e.dispatch=function(j){for(var Vt=j.source,zt=Vt.queue,_r=j.scheduler,_o=j.destination;0<zt.length&&0>=zt[0].time-_r.now();)zt.shift().notification.observe(_o);0<zt.length?(Vt=Math.max(0,zt[0].time-_r.now()),this.schedule(j,Vt)):(this.unsubscribe(),Vt.active=!1)},e.prototype._schedule=function(j){this.active=!0,this.destination.add(j.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:j}))},e.prototype.scheduleNotification=function(j){if(this.errored!==!0){var Vt=this.scheduler;j=new Hz(Vt.now()+this.delay,j),this.queue.push(j),this.active===!1&&this._schedule(Vt)}},e.prototype._next=function(j){this.scheduleNotification(Ve.createNext(j))},e.prototype._error=function(j){this.errored=!0,this.queue=[],this.destination.error(j),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(Ve.createComplete()),this.unsubscribe()},e}(ia),Hz=function(_,e){this.time=_,this.notification=e},nt=function(){function _(e,j){this.keySelector=e,this.flushes=j}return _.prototype.call=function(e,j){return j.subscribe(new Iz(e,this.keySelector,this.flushes))},_}(),Iz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).keySelector=Vt,j.values=new Set,zt&&j.add(ic(zt,new vc(j))),j}return O(e,_),e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(j){this._error(j)},e.prototype._next=function(j){this.keySelector?this._useKeySelector(j):this._finalizeNext(j,j)},e.prototype._useKeySelector=function(j){var Vt=this.destination;try{var zt=this.keySelector(j)}catch(_r){return void Vt.error(_r)}this._finalizeNext(zt,j)},e.prototype._finalizeNext=function(j,Vt){var zt=this.values;zt.has(j)||(zt.add(j),this.destination.next(Vt))},e}(wc),pt=function(){function _(e){this.errorFactory=e}return _.prototype.call=function(e,j){return j.subscribe(new Jz(e,this.errorFactory))},_}(),Jz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).errorFactory=Vt,j.hasValue=!1,j}return O(e,_),e.prototype._next=function(j){this.hasValue=!0,this.destination.next(j)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var j=void 0;try{j=this.errorFactory()}catch(Vt){j=Vt}this.destination.error(j)},e}(ia),qt=function(){function _(e){if(this.total=e,0>this.total)throw new Qk}return _.prototype.call=function(e,j){return j.subscribe(new Kz(e,this.total))},_}(),Kz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).total=Vt,j.count=0,j}return O(e,_),e.prototype._next=function(j){var Vt=this.total,zt=++this.count;zt<=Vt&&(this.destination.next(j),zt===Vt&&(this.destination.complete(),this.unsubscribe()))},e}(ia),rt=function(){function _(e){this.project=e}return _.prototype.call=function(e,j){return j.subscribe(new Lz(e,this.project))},_}(),Lz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).project=Vt,j.hasSubscription=!1,j.hasCompleted=!1,j.index=0,j}return O(e,_),e.prototype._next=function(j){this.hasSubscription||this.tryNext(j)},e.prototype.tryNext=function(j){var Vt=this.index++;try{var zt=this.project(j,Vt)}catch(_r){return void this.destination.error(_r)}this.hasSubscription=!0,this._innerSub(zt)},e.prototype._innerSub=function(j){var Vt=new vc(this),zt=this.destination;zt.add(Vt),(j=ic(j,Vt))!==Vt&&zt.add(j)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(j){this.destination.next(j)},e.prototype.notifyError=function(j){this.destination.error(j)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(wc),st=function(){function _(e){this.callback=e}return _.prototype.call=function(e,j){return j.subscribe(new Mz(e,this.callback))},_}(),Mz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).add(new Oa(Vt)),j}return O(e,_),e}(ia),ut=function(){function _(){}return _.prototype.call=function(e,j){return j.subscribe(new Nz(e))},_}(),Nz=function(_){function e(){return _!==null&&_.apply(this,arguments)||this}return O(e,_),e.prototype._next=function(j){},e}(ia),vt=function(){function _(e){if(this.total=e,0>this.total)throw new Qk}return _.prototype.call=function(e,j){return j.subscribe(new Oz(e,this.total))},_}(),Oz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).total=Vt,j.ring=[],j.count=0,j}return O(e,_),e.prototype._next=function(j){var Vt=this.ring,zt=this.total,_r=this.count++;Vt.length<zt?Vt.push(j):Vt[_r%zt]=j},e.prototype._complete=function(){var j=this.destination,Vt=this.count;if(0<Vt)for(var zt=this.count>=this.total?this.total:this.count,_r=this.ring,_o=0;_o<zt;_o++){var ga=Vt++%zt;j.next(_r[ga])}j.complete()},e}(ia),wt=function(){function _(e){this.value=e}return _.prototype.call=function(e,j){return j.subscribe(new Pz(e,this.value))},_}(),Pz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).value=Vt,j}return O(e,_),e.prototype._next=function(j){this.destination.next(this.value)},e}(ia),xt=function(){function _(e,j,Vt){Vt===void 0&&(Vt=!1),this.accumulator=e,this.seed=j,this.hasSeed=Vt}return _.prototype.call=function(e,j){return j.subscribe(new Qz(e,this.accumulator,this.seed,this.hasSeed))},_}(),Qz=function(_){function e(j,Vt,zt,_r){return(j=_.call(this,j)||this).accumulator=Vt,j._seed=zt,j.hasSeed=_r,j.index=0,j}return O(e,_),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(j){this.hasSeed=!0,this._seed=j},enumerable:!0,configurable:!0}),e.prototype._next=function(j){if(this.hasSeed)return this._tryNext(j);this.seed=j,this.destination.next(j)},e.prototype._tryNext=function(j){var Vt=this.index++;try{var zt=this.accumulator(this.seed,j,Vt)}catch(_r){this.destination.error(_r)}this.seed=zt,this.destination.next(zt)},e}(ia),Bt=function(){function _(e,j){this.notifier=e,this.source=j}return _.prototype.call=function(e,j){return j.subscribe(new Rz(e,this.notifier,this.source))},_}(),Rz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).notifier=Vt,j.source=zt,j}return O(e,_),e.prototype.error=function(j){if(!this.isStopped){var Vt=this.errors,zt=this.retries,_r=this.retriesSubscription;if(zt)this.retriesSubscription=this.errors=void 0;else{Vt=new Pa;try{zt=(0,this.notifier)(Vt)}catch(_o){return _.prototype.error.call(this,_o)}_r=ic(zt,new vc(this))}this._unsubscribeAndRecycle(),this.errors=Vt,this.retries=zt,this.retriesSubscription=_r,Vt.next(j)}},e.prototype._unsubscribe=function(){var j=this.errors,Vt=this.retriesSubscription;j&&(j.unsubscribe(),this.errors=void 0),Vt&&(Vt.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var j=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=j,this.source.subscribe(this)},e}(wc),Et=function(){function _(e){this.project=e}return _.prototype.call=function(e,j){return j.subscribe(new Sz(e,this.project))},_}(),Sz=function(_){function e(j,Vt){return(j=_.call(this,j)||this).project=Vt,j.index=0,j}return O(e,_),e.prototype._next=function(j){var Vt=this.index++;try{var zt=this.project(j,Vt)}catch(_r){return void this.destination.error(_r)}this._innerSub(zt)},e.prototype._innerSub=function(j){var Vt=this.innerSubscription;Vt&&Vt.unsubscribe(),Vt=new vc(this);var zt=this.destination;zt.add(Vt),this.innerSubscription=ic(j,Vt),this.innerSubscription!==Vt&&zt.add(this.innerSubscription)},e.prototype._complete=function(){var j=this.innerSubscription;j&&!j.closed||_.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&_.prototype._complete.call(this)},e.prototype.notifyNext=function(j){this.destination.next(j)},e}(wc),Ft=function(){function _(e){this.notifier=e}return _.prototype.call=function(e,j){e=new Tz(e);var Vt=ic(this.notifier,new vc(e));return Vt&&!e.seenValue?(e.add(Vt),j.subscribe(e)):e},_}(),Tz=function(_){function e(j){return(j=_.call(this,j)||this).seenValue=!1,j}return O(e,_),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(wc),Ht=function(){function _(e,j){this.predicate=e,this.inclusive=j}return _.prototype.call=function(e,j){return j.subscribe(new Uz(e,this.predicate,this.inclusive))},_}(),Uz=function(_){function e(j,Vt,zt){return(j=_.call(this,j)||this).predicate=Vt,j.inclusive=zt,j.index=0,j}return O(e,_),e.prototype._next=function(j){var Vt=this.destination;try{var zt=this.predicate(j,this.index++)}catch(_r){return void Vt.error(_r)}this.nextOrComplete(j,zt)},e.prototype.nextOrComplete=function(j,Vt){var zt=this.destination;Vt?zt.next(j):(this.inclusive&&zt.next(j),zt.complete())},e}(ia),It=function(){function _(e,j,Vt){this.nextOrObserver=e,this.error=j,this.complete=Vt}return _.prototype.call=function(e,j){return j.subscribe(new Vz(e,this.nextOrObserver,this.error,this.complete))},_}(),Vz=function(_){function e(j,Vt,zt,_r){return(j=_.call(this,j)||this)._tapNext=hc,j._tapError=hc,j._tapComplete=hc,j._tapError=zt||hc,j._tapComplete=_r||hc,le(Vt)?(j._context=j,j._tapNext=Vt):Vt&&(j._context=Vt,j._tapNext=Vt.next||hc,j._tapError=Vt.error||hc,j._tapComplete=Vt.complete||hc),j}return O(e,_),e.prototype._next=function(j){try{this._tapNext.call(this._context,j)}catch(Vt){return void this.destination.error(Vt)}this.destination.next(j)},e.prototype._error=function(j){try{this._tapError.call(this._context,j)}catch(Vt){return void this.destination.error(Vt)}this.destination.error(j)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(j){return void this.destination.error(j)}return this.destination.complete()},e}(ia),Kt={leading:!0,trailing:!1};(function(_){function e(j,Vt,zt,_r){var _o=_.call(this,j)||this;return _o.destination=j,_o.durationSelector=Vt,_o._leading=zt,_o._trailing=_r,_o._hasValue=!1,_o}O(e,_),e.prototype._next=function(j){this._hasValue=!0,this._sendValue=j,this._throttled||(this._leading?this.send():this.throttle(j))},e.prototype.send=function(){var j=this._sendValue;this._hasValue&&(this.destination.next(j),this.throttle(j)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(j){(j=this.tryDurationSelector(j))&&this.add(this._throttled=ic(j,new vc(this)))},e.prototype.tryDurationSelector=function(j){try{return this.durationSelector(j)}catch(Vt){return this.destination.error(Vt),null}},e.prototype.throttlingDone=function(){var j=this._throttled,Vt=this._trailing;j&&j.unsubscribe(),this._throttled=void 0,Vt&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()}})(wc);for(var Lt=function(){function _(e,j,Vt,zt){this.duration=e,this.scheduler=j,this.leading=Vt,this.trailing=zt}return _.prototype.call=function(e,j){return j.subscribe(new Wz(e,this.duration,this.scheduler,this.leading,this.trailing))},_}(),Wz=function(_){function e(j,Vt,zt,_r,_o){return(j=_.call(this,j)||this).duration=Vt,j.scheduler=zt,j.leading=_r,j.trailing=_o,j._hasTrailingValue=!1,j._trailingValue=null,j}return O(e,_),e.prototype._next=function(j){this.throttled?this.trailing&&(this._trailingValue=j,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Mt,this.duration,{subscriber:this})),this.leading?this.destination.next(j):this.trailing&&(this._trailingValue=j,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},e.prototype.clearThrottle=function(){var j=this.throttled;j&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),j.unsubscribe(),this.remove(j),this.throttled=null)},e}(ia),Ot=function(){function _(e,j,Vt,zt){this.waitFor=e,this.absoluteTimeout=j,this.withObservable=Vt,this.scheduler=zt}return _.prototype.call=function(e,j){return j.subscribe(new Xz(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},_}(),Xz=function(_){function e(j,Vt,zt,_r,_o){return(j=_.call(this,j)||this).absoluteTimeout=Vt,j.waitFor=zt,j.withObservable=_r,j.scheduler=_o,j.scheduleTimeout(),j}return O(e,_),e.dispatchTimeout=function(j){var Vt=j.withObservable;j._unsubscribeAndRecycle(),j.add(ic(Vt,new vc(j)))},e.prototype.scheduleTimeout=function(){var j=this.action;j?this.action=j.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(j){this.absoluteTimeout||this.scheduleTimeout(),_.prototype._next.call(this,j)},e.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},e}(wc),Qt=function(){function _(e,j){this.observables=e,this.project=j}return _.prototype.call=function(e,j){return j.subscribe(new Yz(e,this.observables,this.project))},_}(),Yz=function(_){function e(j,Vt,zt){(j=_.call(this,j)||this).observables=Vt,j.project=zt,j.toRespond=[],zt=Vt.length,j.values=Array(zt);for(var _r=0;_r<zt;_r++)j.toRespond.push(_r);for(_r=0;_r<zt;_r++)j.add(ji(j,Vt[_r],void 0,_r));return j}return O(e,_),e.prototype.notifyNext=function(j,Vt,zt){this.values[zt]=Vt,0<(j=this.toRespond).length&&(zt=j.indexOf(zt))!==-1&&j.splice(zt,1)},e.prototype.notifyComplete=function(){},e.prototype._next=function(j){this.toRespond.length===0&&(j=[j].concat(this.values),this.project?this._tryProject(j):this.destination.next(j))},e.prototype._tryProject=function(j){try{var Vt=this.project.apply(this,j)}catch(zt){return void this.destination.error(zt)}this.destination.next(Vt)},e}(Rk),Jq=$a(function(_){var e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(e){var j=new Uint8Array(16);_.exports=function(){return e(j),j}}else{var Vt=Array(16);_.exports=function(){for(var zt,_r=0;16>_r;_r++)!(3&_r)&&(zt=4294967296*Math.random()),Vt[_r]=zt>>>((3&_r)<<3)&255;return Vt}}}),ab=[],Gh=0;256>Gh;++Gh)ab[Gh]=(Gh+256).toString(16).substr(1);var Kq=function(_,e){return e=e||0,[ab[_[e++]],ab[_[e++]],ab[_[e++]],ab[_[e++]],"-",ab[_[e++]],ab[_[e++]],"-",ab[_[e++]],ab[_[e++]],"-",ab[_[e++]],ab[_[e++]],"-",ab[_[e++]],ab[_[e++]],ab[_[e++]],ab[_[e++]],ab[_[e++]],ab[_[e++]]].join("")},Ud=function(_,e,j){if(j=e&&j||0,typeof _=="string"&&(e=_==="binary"?Array(16):null,_=null),(_=(_=_||{}).random||(_.rng||Jq)())[6]=15&_[6]|64,_[8]=63&_[8]|128,e)for(var Vt=0;16>Vt;++Vt)e[j+Vt]=_[Vt];return e||Kq(_)},gg=Ud(),Uk=!1,Pc,rd,Vk,Wk,sd,Vd,ec,We,Rb,Xk,Qc,Wd,Rc,Sc,Tc,Xe,Uc,Vc;(function(_){_[_.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",_[_.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",_[_.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",_[_.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",_[_.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",_[_.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",_[_.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(Pc||(Pc={})),function(_){_[_.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",_[_.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",_[_.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",_[_.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",_[_.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",_[_.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(rd||(rd={})),function(_){_[_.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(Vk||(Vk={})),function(_){_[_.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Wk||(Wk={})),function(_){_[_.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",_[_.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",_[_.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",_[_.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",_[_.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",_[_.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(sd||(sd={})),function(_){_[_.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",_[_.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",_[_.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",_[_.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",_[_.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(Vd||(Vd={})),function(_){_[_.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",_[_.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",_[_.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",_[_.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",_[_.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",_[_.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",_[_.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",_[_.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",_[_.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",_[_.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",_[_.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(ec||(ec={})),function(_){_[_.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",_[_.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",_[_.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",_[_.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(We||(We={})),function(_){_[_.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",_[_.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",_[_.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",_[_.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",_[_.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",_[_.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",_[_.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",_[_.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",_[_.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",_[_.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",_[_.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(Rb||(Rb={})),function(_){_[_.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Xk||(Xk={})),function(_){_[_.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",_[_.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",_[_.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",_[_.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",_[_.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",_[_.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",_[_.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Qc||(Qc={})),function(_){_[_.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",_[_.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",_[_.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",_[_.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",_[_.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(Wd||(Wd={})),function(_){_[_.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",_[_.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",_[_.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",_[_.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",_[_.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",_[_.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",_[_.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",_[_.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(Rc||(Rc={})),function(_){_[_.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",_[_.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(Sc||(Sc={})),function(_){_[_.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",_[_.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",_[_.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",_[_.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",_[_.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",_[_.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",_[_.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(Tc||(Tc={})),function(_){_[_.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",_[_.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",_[_.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",_[_.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(Xe||(Xe={})),function(_){_[_.UPLOAD_MEDIA_ERR_FAILURE=1]="UPLOAD_MEDIA_ERR_FAILURE",_[_.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="UPLOAD_MEDIA_ERR_INVALID_ARGUMENT",_[_.UPLOAD_MEDIA_ERR_TIMEOUT=3]="UPLOAD_MEDIA_ERR_TIMEOUT",_[_.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW=4]="UPLOAD_MEDIA_ERR_SIZE_OVERFLOW",_[_.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",_[_.UPLOAD_MEDIA_ERR_INTERRUPTED=6]="UPLOAD_MEDIA_ERR_INTERRUPTED",_[_.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="UPLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Uc||(Uc={})),function(_){_[_.DOWNLOAD_MEDIA_ERR_FAILURE=1]="DOWNLOAD_MEDIA_ERR_FAILURE",_[_.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT=2]="DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT",_[_.DOWNLOAD_MEDIA_ERR_TIMEOUT=3]="DOWNLOAD_MEDIA_ERR_TIMEOUT",_[_.DOWNLOAD_MEDIA_ERR_NOT_EXIST=4]="DOWNLOAD_MEDIA_ERR_NOT_EXIST",_[_.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED=5]="DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED",_[_.DOWNLOAD_MEDIA_ERR_INTERRUPTED=6]="DOWNLOAD_MEDIA_ERR_INTERRUPTED",_[_.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN=102]="DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN"}(Vc||(Vc={}));var Sb=Pc.ATTRIBUTE_OPERATION_ERR_FAILURE,Ja=Pc.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,se=Pc.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;Pc.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var Lq=Pc.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,Tb=Pc.ATTRIBUTE_OPERATION_ERR_TIMEOUT,Ub=Pc.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,hg=rd.CHANNEL_MESSAGE_ERR_FAILURE,Yk=rd.CHANNEL_MESSAGE_ERR_TIMEOUT,Mq=rd.CHANNEL_MESSAGE_ERR_TOO_OFTEN,Hh=rd.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE;rd.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL;var ig=rd.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,Zz=Vk.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Nq=Wk.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var Oq=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var Pq=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,$z=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;Sc.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var aA=Sc.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,bA=sd.GET_MEMBERS_ERR_FAILURE,cA=sd.GET_MEMBERS_ERR_REJECTED;sd.GET_MEMBERS_ERR_TIMEOUT,sd.GET_MEMBERS_ERR_TOO_OFTEN;var dA=sd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,eA=sd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,xc=Vd.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,fA=Vd.INVITATION_API_CALL_ERR_NOT_STARTED,Ih=Vd.INVITATION_API_CALL_ERR_ALREADY_END,Qq=Vd.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,gA=Vd.INVITATION_API_CALL_ERR_ALREADY_SENT,Rq=ec.JOIN_CHANNEL_ERR_FAILURE;ec.JOIN_CHANNEL_ERR_REJECTED;var hA=ec.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Sq=ec.JOIN_CHANNEL_TIMEOUT,Tq=ec.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Uq=ec.JOIN_CHANNEL_ERR_ALREADY_JOINED;ec.JOIN_CHANNEL_ERR_TOO_OFTEN;var Vq=ec.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,Wq=ec.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,Xq=We.LEAVE_CHANNEL_ERR_FAILURE,Yq=We.LEAVE_CHANNEL_ERR_REJECTED,iA=We.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,jA=We.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,Zq=Rb.LOGIN_ERR_UNKNOWN,jg=Rb.LOGIN_ERR_REJECTED,Jh=Rb.LOGIN_ERR_INVALID_ARGUMENT,$q=Rb.LOGIN_ERR_INVALID_APP_ID,ar=Rb.LOGIN_ERR_INVALID_TOKEN,Kh=Rb.LOGIN_ERR_TOKEN_EXPIRED;Rb.LOGIN_ERR_NOT_AUTHORIZED;var kA=Rb.LOGIN_ERR_ALREADY_LOGIN,lA=Rb.LOGIN_ERR_TIMEOUT,mA=Rb.LOGIN_ERR_TOO_OFTEN,br=Xk.LOGOUT_ERR_USER_NOT_LOGGED_IN,cr=Qc.PEER_MESSAGE_ERR_FAILURE,Zk=Qc.PEER_MESSAGE_ERR_TIMEOUT,dr=Qc.PEER_MESSAGE_ERR_TOO_OFTEN,$k=Qc.PEER_MESSAGE_ERR_INVALID_USERID,ve=Qc.PEER_MESSAGE_ERR_INVALID_MESSAGE,al=Qc.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,nA=Qc.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE,er=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;Wd.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var oA=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;Wd.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var pA=Wd.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,qA=Rc.RENEW_TOKEN_ERR_FAILURE,rA=Rc.RENEW_TOKEN_ERR_INVALID_ARGUMENT;Rc.RENEW_TOKEN_ERR_REJECTED,Rc.RENEW_TOKEN_ERR_TOO_OFTEN;var sA=Rc.RENEW_TOKEN_ERR_TOKEN_EXPIRED,tA=Rc.RENEW_TOKEN_ERR_INVALID_TOKEN,uA=Rc.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,fr=Tc.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,kg=Tc.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;Tc.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var vA=Tc.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;Tc.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var gr=Tc.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,bl=Tc.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,Xe.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var lg=Uc.UPLOAD_MEDIA_ERR_FAILURE,wf=Uc.UPLOAD_MEDIA_ERR_INVALID_ARGUMENT,Lh=Uc.UPLOAD_MEDIA_ERR_TIMEOUT,wA=Uc.UPLOAD_MEDIA_ERR_SIZE_OVERFLOW,xA=Uc.UPLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,hr=Uc.UPLOAD_MEDIA_ERR_INTERRUPTED,yA=Uc.UPLOAD_MEDIA_ERR_NOT_LOGGED_IN,mg=Vc.DOWNLOAD_MEDIA_ERR_FAILURE,cl=Vc.DOWNLOAD_MEDIA_ERR_INVALID_ARGUMENT,zA=Vc.DOWNLOAD_MEDIA_ERR_TIMEOUT,AA=Vc.DOWNLOAD_MEDIA_ERR_NOT_EXIST,BA=Vc.DOWNLOAD_MEDIA_ERR_CONCURRENCY_LIMIT_EXCEEDED,ir=Vc.DOWNLOAD_MEDIA_ERR_INTERRUPTED,CA=Vc.DOWNLOAD_MEDIA_ERR_NOT_LOGGED_IN,DA=function(_,e){var j;return Hk(_,function(Vt,zt,_r){return!(j=e(Vt,zt,_r))}),!!j},Mh=function(_,e,j){if(!lb(j))return!1;var Vt=X(e);return!!(Vt=="number"?Ed(j)&&wk(e,j.length):Vt=="string"&&e in j)&&$f(j[e],_)},dl=function(_,e,j){var Vt=Va(_)?tq:DA;return Vt(_,Te(e))},EA=function(_,e){var j=-1,Vt=Ed(_)?Array(_.length):[];return Hk(_,function(zt,_r,_o){Vt[++j]=e(zt,_r,_o)}),Vt},FA=function(_,e){var j=_.length;for(_.sort(e);j--;)_[j]=_[j].value;return _},GA=function(_,e,j){e=e.length?he(e,function(zt){return Va(zt)?function(_r){return Ch(_r,zt.length===1?zt[0]:zt)}:zt}):[Dh];var Vt=-1;return e=he(e,zh(Te)),_=EA(_,function(zt,_r,_o){return{criteria:he(e,function(ga){return ga(zt)}),index:++Vt,value:zt}}),FA(_,function(zt,_r){e:{for(var _o=-1,ga=zt.criteria,_a=_r.criteria,_l=ga.length,_d=j.length;++_o<_l;){t:{var _f=ga[_o],_m=_a[_o];if(_f!==_m){var tE=_f!==void 0,rE=_f===null,oE=_f==_f,dE=ie(_f),nE=_m!==void 0,sE=_m===null,lE=_m==_m,EE=ie(_m);if(!sE&&!EE&&!dE&&_f>_m||dE&&nE&&lE&&!sE&&!EE||rE&&nE&&lE||!tE&&lE||!oE){_f=1;break t}if(!rE&&!dE&&!EE&&_f<_m||EE&&tE&&oE&&!rE&&!dE||sE&&tE&&oE||!nE&&oE||!lE){_f=-1;break t}}_f=0}if(_f){zt=_o>=_d?_f:_f*(j[_o]=="desc"?-1:1);break e}}zt=zt.index-_r.index}return zt})},jr=function(_,e){return rq(qq(_,e,Dh),_+"")},kr=jr(function(_,e){if(_==null)return[];var j=e.length;return 1<j&&Mh(_,e[0],e[1])?e=[]:2<j&&Mh(e[0],e[1],e[2])&&(e=[e[0]]),GA(_,$h(e),[])}),lr=function(_){if(_.__esModule)return _;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(_).forEach(function(j){var Vt=Object.getOwnPropertyDescriptor(_,j);Object.defineProperty(e,j,Vt.get?Vt:{enumerable:!0,get:function(){return _[j]}})}),e}(Dz),mr=$a(function(_,e){Object.defineProperty(e,"__esModule",{value:!0});var j=[],Vt=function(zt,_r){return new WebSocket(zt,_r)};e.normalClosureMessage="Normal closure",e.default=function(zt,_r){var _o=(_r=_r===void 0?{protocols:j,makeWebSocket:Vt}:_r).protocols,ga=_o===void 0?j:_o,_a=(_r=_r.makeWebSocket)===void 0?Vt:_r;return new lr.Observable(function(_l){var _d,_f=new lr.Subject,_m=_a(zt,ga),tE=!1,rE=!1,oE=function(dE){if(_d)throw tE=!0,dE=Error("Web socket message factory function called more than once"),_l.error(dE),dE;return _d=dE.subscribe(function(nE){_m.send(nE)}),_f};return _m.onopen=function(){rE?(tE=!0,_m.close()):_l.next(oE)},_m.onmessage=function(dE){_f.next(dE.data)},_m.onerror=function(dE){tE=!0,_l.error(Error(dE.message))},_m.onclose=function(dE){tE||(tE=!0,rE?(_l.complete(),_f.complete()):_l.error(Error(dE.code===1e3?e.normalClosureMessage:dE.reason)))},function(){rE=!0,_d&&_d.unsubscribe(),tE||(tE=!0,_m.close())}})}});(function(_){_&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")&&_.default})(mr);var pi=function(_,e,j){(j===void 0||$f(_[e],j))&&(j!==void 0||e in _)||bg(_,e,j)},oi=function(_,e){if((e!=="constructor"||typeof _[e]!="function")&&e!="__proto__")return _[e]},HA=function(_){return jr(function(e,j){var Vt=-1,zt=j.length,_r=1<zt?j[zt-1]:void 0,_o=2<zt?j[2]:void 0;for(_r=3<_.length&&typeof _r=="function"?(zt--,_r):void 0,_o&&Mh(j[0],j[1],_o)&&(_r=3>zt?void 0:_r,zt=1),e=Object(e);++Vt<zt;)(_o=j[Vt])&&_(e,_o,Vt,_r);return e})}(function(_,e,j,Vt){tm(_,e,j,Vt)}),IA=Math.floor,JA=Math.random,nr=function(_,e){return _+IA(JA()*(e-_+1))},or=function(_){var e=_.length;return e?_[nr(0,e-1)]:void 0},KA=function(_,e){return he(e,function(j){return _[j]})},Ni=function(_){return _==null?[]:KA(_,Ad(_))},LA=function(_){return or(Ni(_))},bn=function(_){return(Va(_)?or:LA)(_)},xm=[],ym=function(_,e){return new WebSocket(_,e)},MA=Math.floor;N({target:"Number",stat:!0},{isInteger:function(_){return!ha(_)&&isFinite(_)&&MA(_)===_}}),Oo("from",Ej,Dj);var NA=function(_,e){for(var j=Array(arguments.length-1),Vt=0,zt=2,_r=!0;zt<arguments.length;)j[Vt++]=arguments[zt++];return new Promise(function(_o,ga){j[Vt]=function(_a){if(_r)if(_r=!1,_a)ga(_a);else{for(var _l=Array(arguments.length-1),_d=0;_d<_l.length;)_l[_d++]=arguments[_d];_o.apply(null,_l)}};try{_.apply(e||null,j)}catch(_a){_r&&(_r=!1,ga(_a))}})},OA=$a(function(_,e){e.length=function(zt){var _r=zt.length;if(!_r)return 0;for(var _o=0;1<--_r%4&&zt.charAt(_r)==="=";)++_o;return Math.ceil(3*zt.length)/4-_o};var j=Array(64),Vt=Array(123);for(_=0;64>_;)Vt[j[_]=26>_?_+65:52>_?_+71:62>_?_-4:_-59|43]=_++;e.encode=function(zt,_r,_o){for(var ga,_a=null,_l=[],_d=0,_f=0;_r<_o;){var _m=zt[_r++];switch(_f){case 0:_l[_d++]=j[_m>>2],ga=(3&_m)<<4,_f=1;break;case 1:_l[_d++]=j[ga|_m>>4],ga=(15&_m)<<2,_f=2;break;case 2:_l[_d++]=j[ga|_m>>6],_l[_d++]=j[63&_m],_f=0}8191<_d&&((_a||(_a=[])).push(String.fromCharCode.apply(String,_l)),_d=0)}return _f&&(_l[_d++]=j[ga],_l[_d++]=61,_f===1&&(_l[_d++]=61)),_a?(_d&&_a.push(String.fromCharCode.apply(String,_l.slice(0,_d))),_a.join("")):String.fromCharCode.apply(String,_l.slice(0,_d))},e.decode=function(zt,_r,_o){for(var ga,_a=_o,_l=0,_d=0;_d<zt.length;){var _f=zt.charCodeAt(_d++);if(_f===61&&1<_l)break;if((_f=Vt[_f])===void 0)throw Error("invalid encoding");switch(_l){case 0:ga=_f,_l=1;break;case 1:_r[_o++]=ga<<2|(48&_f)>>4,ga=_f,_l=2;break;case 2:_r[_o++]=(15&ga)<<4|(60&_f)>>2,ga=_f,_l=3;break;case 3:_r[_o++]=(3&ga)<<6|_f,_l=0}}if(_l===1)throw Error("invalid encoding");return _o-_a},e.test=function(zt){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(zt)}});yg.prototype.on=function(_,e,j){return(this._listeners[_]||(this._listeners[_]=[])).push({fn:e,ctx:j||this}),this},yg.prototype.off=function(_,e){if(_===void 0)this._listeners={};else if(e===void 0)this._listeners[_]=[];else{_=this._listeners[_];for(var j=0;j<_.length;)_[j].fn===e?_.splice(j,1):++j}return this},yg.prototype.emit=function(_){var e=this._listeners[_];if(e){for(var j=[],Vt=1;Vt<arguments.length;)j.push(arguments[Vt++]);for(Vt=0;Vt<e.length;)e[Vt].fn.apply(e[Vt++].ctx,j)}return this};var PA=zm(zm),QA=function(c){try{var a=eval("quire".replace(/^/,"re"))(c);if(a&&(a.length||Object.keys(a).length))return a}catch(_){}return null},RA=$a(function(_,e){e.length=function(j){for(var Vt,zt=0,_r=0;_r<j.length;++_r)128>(Vt=j.charCodeAt(_r))?zt+=1:2048>Vt?zt+=2:(64512&Vt)==55296&&(64512&j.charCodeAt(_r+1))==56320?(++_r,zt+=4):zt+=3;return zt},e.read=function(j,Vt,zt){if(1>zt-Vt)return"";for(var _r,_o=null,ga=[],_a=0;Vt<zt;)128>(_r=j[Vt++])?ga[_a++]=_r:191<_r&&224>_r?ga[_a++]=(31&_r)<<6|63&j[Vt++]:239<_r&&365>_r?(_r=((7&_r)<<18|(63&j[Vt++])<<12|(63&j[Vt++])<<6|63&j[Vt++])-65536,ga[_a++]=55296+(_r>>10),ga[_a++]=56320+(1023&_r)):ga[_a++]=(15&_r)<<12|(63&j[Vt++])<<6|63&j[Vt++],8191<_a&&((_o||(_o=[])).push(String.fromCharCode.apply(String,ga)),_a=0);return _o?(_a&&_o.push(String.fromCharCode.apply(String,ga.slice(0,_a))),_o.join("")):String.fromCharCode.apply(String,ga.slice(0,_a))},e.write=function(j,Vt,zt){for(var _r,_o,ga=zt,_a=0;_a<j.length;++_a)128>(_r=j.charCodeAt(_a))?Vt[zt++]=_r:(2048>_r?Vt[zt++]=_r>>6|192:((64512&_r)==55296&&(64512&(_o=j.charCodeAt(_a+1)))==56320?(_r=65536+((1023&_r)<<10)+(1023&_o),++_a,Vt[zt++]=_r>>18|240,Vt[zt++]=_r>>12&63|128):Vt[zt++]=_r>>12|224,Vt[zt++]=_r>>6&63|128),Vt[zt++]=63&_r|128);return zt-ga}}),SA=function(_,e,j){var Vt=j||8192,zt=Vt>>>1,_r=null,_o=Vt;return function(ga){return 1>ga||ga>zt?_(ga):(_o+ga>Vt&&(_r=_(Vt),_o=0),ga=e.call(_r,_o,_o+=ga),7&_o&&(_o=1+(7|_o)),ga)}},Xd=Wa.zero=new Wa(0,0);Xd.toNumber=function(){return 0},Xd.zzEncode=Xd.zzDecode=function(){return this},Xd.length=function(){return 1};var TA=Wa.zeroHash="\0\0\0\0\0\0\0\0";Wa.fromNumber=function(_){if(_===0)return Xd;var e=0>_;e&&(_=-_);var j=_>>>0;return _=(_-j)/4294967296>>>0,e&&(_=~_>>>0,j=~j>>>0,4294967295<++j&&(j=0,4294967295<++_&&(_=0))),new Wa(j,_)},Wa.from=function(_){if(typeof _=="number")return Wa.fromNumber(_);if(V.isString(_)){if(!V.Long)return Wa.fromNumber(parseInt(_,10));_=V.Long.fromString(_)}return _.low||_.high?new Wa(_.low>>>0,_.high>>>0):Xd},Wa.prototype.toNumber=function(_){if(!_&&this.hi>>>31){_=1+~this.lo>>>0;var e=~this.hi>>>0;return _||(e=e+1>>>0),-(_+4294967296*e)}return this.lo+4294967296*this.hi},Wa.prototype.toLong=function(_){return V.Long?new V.Long(0|this.lo,0|this.hi,!!_):{low:0|this.lo,high:0|this.hi,unsigned:!!_}};var td=String.prototype.charCodeAt;Wa.fromHash=function(_){return _===TA?Xd:new Wa((td.call(_,0)|td.call(_,1)<<8|td.call(_,2)<<16|td.call(_,3)<<24)>>>0,(td.call(_,4)|td.call(_,5)<<8|td.call(_,6)<<16|td.call(_,7)<<24)>>>0)},Wa.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Wa.prototype.zzEncode=function(){var _=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^_)>>>0,this.lo=(this.lo<<1^_)>>>0,this},Wa.prototype.zzDecode=function(){var _=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^_)>>>0,this.hi=(this.hi>>>1^_)>>>0,this},Wa.prototype.length=function(){var _=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,j=this.hi>>>24;return j===0?e===0?16384>_?128>_?1:2:2097152>_?3:4:16384>e?128>e?5:6:2097152>e?7:8:128>j?9:10};var V=$a(function(_,e){function j(zt,_r,_o){for(var ga=Object.keys(_r),_a=0;_a<ga.length;++_a)zt[ga[_a]]!==void 0&&_o||(zt[ga[_a]]=_r[ga[_a]]);return zt}function Vt(zt){function _r(_o,ga){if(!(this instanceof _r))return new _r(_o,ga);Object.defineProperty(this,"message",{get:function(){return _o}}),Error.captureStackTrace?Error.captureStackTrace(this,_r):Object.defineProperty(this,"stack",{value:Error().stack||""}),ga&&j(this,ga)}return(_r.prototype=Object.create(Error.prototype)).constructor=_r,Object.defineProperty(_r.prototype,"name",{get:function(){return zt}}),_r.prototype.toString=function(){return this.name+": "+this.message},_r}e.asPromise=NA,e.base64=OA,e.EventEmitter=yg,e.float=PA,e.inquire=QA,e.utf8=RA,e.pool=SA,e.LongBits=Wa,e.isNode=!!(Ya!==void 0&&Ya&&Ya.process&&Ya.process.versions&&Ya.process.versions.node),e.global=e.isNode&&Ya||typeof window<"u"&&window||typeof self<"u"&&self||Ya,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(zt){return typeof zt=="number"&&isFinite(zt)&&Math.floor(zt)===zt},e.isString=function(zt){return typeof zt=="string"||zt instanceof String},e.isObject=function(zt){return zt&&X(zt)==="object"},e.isset=e.isSet=function(zt,_r){var _o=zt[_r];return!(_o==null||!zt.hasOwnProperty(_r))&&(X(_o)!=="object"||0<(Array.isArray(_o)?_o.length:Object.keys(_o).length))},e.Buffer=function(){try{var zt=e.inquire("buffer").Buffer;return zt.prototype.utf8Write?zt:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(zt){return typeof zt=="number"?e.Buffer?e._Buffer_allocUnsafe(zt):new e.Array(zt):e.Buffer?e._Buffer_from(zt):typeof Uint8Array>"u"?zt:new Uint8Array(zt)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(zt){return zt?e.LongBits.from(zt).toHash():e.LongBits.zeroHash},e.longFromHash=function(zt,_r){return zt=e.LongBits.fromHash(zt),e.Long?e.Long.fromBits(zt.lo,zt.hi,_r):zt.toNumber(!!_r)},e.merge=j,e.lcFirst=function(zt){return zt.charAt(0).toLowerCase()+zt.substring(1)},e.newError=Vt,e.ProtocolError=Vt("ProtocolError"),e.oneOfGetter=function(zt){for(var _r={},_o=0;_o<zt.length;++_o)_r[zt[_o]]=1;return function(){for(var ga=Object.keys(this),_a=ga.length-1;-1<_a;--_a)if(_r[ga[_a]]===1&&this[ga[_a]]!==void 0&&this[ga[_a]]!==null)return ga[_a]}},e.oneOfSetter=function(zt){return function(_r){for(var _o=0;_o<zt.length;++_o)zt[_o]!==_r&&delete this[zt[_o]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var zt=e.Buffer;zt?(e._Buffer_from=zt.from!==Uint8Array.from&&zt.from||function(_r,_o){return new zt(_r,_o)},e._Buffer_allocUnsafe=zt.allocUnsafe||function(_r){return new zt(_r)}):e._Buffer_from=e._Buffer_allocUnsafe=null}}),xi=ja,el,Nh=V.LongBits,pr=V.base64,qr=V.utf8,rr=function(){return V.Buffer?function(){return(ja.create=function(){return new el})()}:function(){return new ja}};ja.create=rr(),ja.alloc=function(_){return new V.Array(_)},V.Array!==Array&&(ja.alloc=V.pool(ja.alloc,V.Array.prototype.subarray)),ja.prototype._push=function(_,e,j){return this.tail=this.tail.next=new sf(_,e,j),this.len+=e,this},ui.prototype=Object.create(sf.prototype),ui.prototype.fn=function(_,e,j){for(;127<_;)e[j++]=127&_|128,_>>>=7;e[j]=_},ja.prototype.uint32=function(_){return this.len+=(this.tail=this.tail.next=new ui(128>(_>>>=0)?1:16384>_?2:2097152>_?3:268435456>_?4:5,_)).len,this},ja.prototype.int32=function(_){return 0>_?this._push(vi,10,Nh.fromNumber(_)):this.uint32(_)},ja.prototype.sint32=function(_){return this.uint32((_<<1^_>>31)>>>0)},ja.prototype.uint64=function(_){return _=Nh.from(_),this._push(vi,_.length(),_)},ja.prototype.int64=ja.prototype.uint64,ja.prototype.sint64=function(_){return _=Nh.from(_).zzEncode(),this._push(vi,_.length(),_)},ja.prototype.bool=function(_){return this._push(ti,1,_?1:0)},ja.prototype.fixed32=function(_){return this._push(wi,4,_>>>0)},ja.prototype.sfixed32=ja.prototype.fixed32,ja.prototype.fixed64=function(_){return _=Nh.from(_),this._push(wi,4,_.lo)._push(wi,4,_.hi)},ja.prototype.sfixed64=ja.prototype.fixed64,ja.prototype.float=function(_){return this._push(V.float.writeFloatLE,4,_)},ja.prototype.double=function(_){return this._push(V.float.writeDoubleLE,8,_)};var UA=V.Array.prototype.set?function(_,e,j){e.set(_,j)}:function(_,e,j){for(var Vt=0;Vt<_.length;++Vt)e[j+Vt]=_[Vt]};ja.prototype.bytes=function(_){var e=_.length>>>0;if(!e)return this._push(ti,1,0);if(V.isString(_)){var j=ja.alloc(e=pr.length(_));pr.decode(_,j,0),_=j}return this.uint32(e)._push(UA,e,_)},ja.prototype.string=function(_){var e=qr.length(_);return e?this.uint32(e)._push(qr.write,e,_):this._push(ti,1,0)},ja.prototype.fork=function(){return this.states=new Tt(this),this.head=this.tail=new sf(si,0,0),this.len=0,this},ja.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new sf(si,0,0),this.len=0),this},ja.prototype.ldelim=function(){var _=this.head,e=this.tail,j=this.len;return this.reset().uint32(j),j&&(this.tail.next=_.next,this.tail=e,this.len+=j),this},ja.prototype.finish=function(){for(var _=this.head.next,e=this.constructor.alloc(this.len),j=0;_;)_.fn(_.val,e,j),j+=_.len,_=_.next;return e},ja._configure=function(_){el=_,ja.create=rr(),el._configure()},(jc.prototype=Object.create(xi.prototype)).constructor=jc,jc._configure=function(){jc.alloc=V._Buffer_allocUnsafe,jc.writeBytesBuffer=V.Buffer&&V.Buffer.prototype instanceof Uint8Array&&V.Buffer.prototype.set.name==="set"?function(_,e,j){e.set(_,j)}:function(_,e,j){if(_.copy)_.copy(e,j,0,_.length);else for(var Vt=0;Vt<_.length;)e[j++]=_[Vt++]}},jc.prototype.bytes=function(_){V.isString(_)&&(_=V._Buffer_from(_,"base64"));var e=_.length>>>0;return this.uint32(e),e&&this._push(jc.writeBytesBuffer,e,_),this},jc.prototype.string=function(_){var e=V.Buffer.byteLength(_);return this.uint32(e),e&&this._push(Ut,e,_),this},jc._configure();var zi=La,fl,Em=V.LongBits,VA=V.utf8,sr=typeof Uint8Array<"u"?function(_){if(_ instanceof Uint8Array||Array.isArray(_))return new La(_);throw Error("illegal buffer")}:function(_){if(Array.isArray(_))return new La(_);throw Error("illegal buffer")},tr=function(){return V.Buffer?function(_){return(La.create=function(e){return V.Buffer.isBuffer(e)?new fl(e):sr(e)})(_)}:sr};La.create=tr(),La.prototype._slice=V.Array.prototype.subarray||V.Array.prototype.slice,La.prototype.uint32=function(){var _=4294967295;return function(){if(_=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(_=(_|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(_=(_|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(_=(_|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(_=(_|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return _;if((this.pos+=5)>this.len)throw this.pos=this.len,Yb(this,10);return _}}(),La.prototype.int32=function(){return 0|this.uint32()},La.prototype.sint32=function(){var _=this.uint32();return _>>>1^-(1&_)|0},La.prototype.bool=function(){return this.uint32()!==0},La.prototype.fixed32=function(){if(this.pos+4>this.len)throw Yb(this,4);return zg(this.buf,this.pos+=4)},La.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Yb(this,4);return 0|zg(this.buf,this.pos+=4)},La.prototype.float=function(){if(this.pos+4>this.len)throw Yb(this,4);var _=V.float.readFloatLE(this.buf,this.pos);return this.pos+=4,_},La.prototype.double=function(){if(this.pos+8>this.len)throw Yb(this,4);var _=V.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,_},La.prototype.bytes=function(){var _=this.uint32(),e=this.pos,j=this.pos+_;if(j>this.len)throw Yb(this,_);return this.pos+=_,Array.isArray(this.buf)?this.buf.slice(e,j):e===j?new this.buf.constructor(0):this._slice.call(this.buf,e,j)},La.prototype.string=function(){var _=this.bytes();return VA.read(_,0,_.length)},La.prototype.skip=function(_){if(typeof _=="number"){if(this.pos+_>this.len)throw Yb(this,_);this.pos+=_}else do if(this.pos>=this.len)throw Yb(this);while(128&this.buf[this.pos++]);return this},La.prototype.skipType=function(_){switch(_){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(_=7&this.uint32())!=4;)this.skipType(_);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+_+" at offset "+this.pos)}return this},La._configure=function(_){fl=_,La.create=tr(),fl._configure();var e=V.Long?"toLong":"toNumber";V.merge(La.prototype,{int64:function(){return yi.call(this)[e](!1)},uint64:function(){return yi.call(this)[e](!0)},sint64:function(){return yi.call(this).zzDecode()[e](!1)},fixed64:function(){return Fm.call(this)[e](!0)},sfixed64:function(){return Fm.call(this)[e](!1)}})},(Fd.prototype=Object.create(zi.prototype)).constructor=Fd,Fd._configure=function(){V.Buffer&&(Fd.prototype._slice=V.Buffer.prototype.slice)},Fd.prototype.string=function(){var _=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+_,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+_,this.len))},Fd._configure(),(tf.prototype=Object.create(V.EventEmitter.prototype)).constructor=tf,tf.prototype.rpcCall=function _(e,j,Vt,zt,_r){if(!zt)throw TypeError("request must be specified");var _o=this;if(!_r)return V.asPromise(_,_o,e,j,Vt,zt);if(_o.rpcImpl)try{return _o.rpcImpl(e,j[_o.requestDelimited?"encodeDelimited":"encode"](zt).finish(),function(ga,_a){if(ga)return _o.emit("error",ga,e),_r(ga);if(_a!==null){if(!(_a instanceof Vt))try{_a=Vt[_o.responseDelimited?"decodeDelimited":"decode"](_a)}catch(_l){return _o.emit("error",_l,e),_r(_l)}return _o.emit("data",_a,e),_r(null,_a)}_o.end(!0)})}catch(ga){_o.emit("error",ga,e),setTimeout(function(){_r(ga)},0)}else setTimeout(function(){_r(Error("already ended"))},0)},tf.prototype.end=function(_){return this.rpcImpl&&(_||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var WA=$a(function(_,e){e.Service=tf}),XA={},fc=$a(function(_,e){function j(){Vt.util._configure(),Vt.Writer._configure(Vt.BufferWriter),Vt.Reader._configure(Vt.BufferReader)}var Vt=e;Vt.build="minimal",Vt.Writer=xi,Vt.BufferWriter=jc,Vt.Reader=zi,Vt.BufferReader=Fd,Vt.util=V,Vt.rpc=WA,Vt.roots=XA,Vt.configure=j,j()});fc.util.Long=U,fc.configure();var u=fc.Reader,L=fc.Writer,q=fc.util,t=fc.roots.default||(fc.roots.default={}),YA=t.URI=function(){var _={},e=Object.create(_);return e[_[0]="Unknown"]=0,e[_[1]="PingUri"]=1,e[_[2]="PongUri"]=2,e[_[11]="UserJoinUri"]=11,e[_[12]="UserRespUri"]=12,e[_[21]="UserQuitUri"]=21,e[_[22]="UserDropUri"]=22,e[_[31]="GroupEnterUri"]=31,e[_[32]="GroupLeaveUri"]=32,e[_[33]="GroupReplyUri"]=33,e[_[36]="GroupEnterNoticeUri"]=36,e[_[37]="GroupLeaveNoticeUri"]=37,e[_[38]="GroupEventNoticeUri"]=38,e[_[39]="GroupCountNoticeUri"]=39,e[_[41]="UserStatusListUri"]=41,e[_[42]="UserStatusResultUri"]=42,e[_[51]="GroupStatusListUri"]=51,e[_[52]="GroupStatusResultUri"]=52,e[_[55]="GroupAllUsersListUri"]=55,e[_[56]="GroupAllUsersResultUri"]=56,e[_[100]="MessageUri"]=100,e[_[101]="AckUri"]=101,e[_[115]="FileUploadIndexGetUri"]=115,e[_[116]="FileUploadIndexRetUri"]=116,e[_[117]="FileUploadIndexSetUri"]=117,e[_[118]="FileUploadIndexFinUri"]=118,e[_[119]="FileUploadIndexErrUri"]=119,e[_[125]="FileDownloadIndexGetUri"]=125,e[_[126]="FileDownloadIndexRetUri"]=126,e[_[127]="FileDownloadIndexErrUri"]=127,e[_[201]="UserJoinNoticeUri"]=201,e[_[202]="UserQuitNoticeUri"]=202,e[_[203]="UserWaitNoticeUri"]=203,e[_[301]="UserAttributeGetUri"]=301,e[_[302]="UserAttributeRetUri"]=302,e[_[303]="UserAttributeSetUri"]=303,e[_[304]="UserAttributeModUri"]=304,e[_[305]="UserAttributeDelUri"]=305,e[_[307]="UserAttributeRspUri"]=307,e[_[308]="UserAttributeErrUri"]=308,e[_[311]="UserAttributeKeysGetUri"]=311,e[_[312]="UserAttributeKeysRetUri"]=312,e[_[351]="GroupAttributeGetUri"]=351,e[_[352]="GroupAttributeRetUri"]=352,e[_[353]="GroupAttributeSetUri"]=353,e[_[354]="GroupAttributeModUri"]=354,e[_[355]="GroupAttributeDelUri"]=355,e[_[356]="GroupAttributeAltUri"]=356,e[_[357]="GroupAttributeRspUri"]=357,e[_[358]="GroupAttributeErrUri"]=358,e[_[361]="GroupAttributeKeysGetUri"]=361,e[_[362]="GroupAttributeKeysRetUri"]=362,e[_[401]="SubscribeUserStatusUri"]=401,e[_[402]="UnsubscribeUserStatusUri"]=402,e[_[499]="SubscribeResponseUri"]=499,e}(),Oh=t.Wrapper=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.uri=0,_.prototype.data=q.newBuffer([]),_.encode=function(e,j){return j||(j=L.create()),e.uri!=null&&Object.hasOwnProperty.call(e,"uri")&&j.uint32(8).int32(e.uri),e.data!=null&&Object.hasOwnProperty.call(e,"data")&&j.uint32(18).bytes(e.data),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.Wrapper;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.uri=e.int32();break;case 2:Vt.data=e.bytes();break;default:e.skipType(7&zt)}}return Vt},_}(),ZA=t.Ping=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&j.uint32(16).uint64(e.ms),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.Ping;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.ms=e.uint64();break;default:e.skipType(7&zt)}}return Vt},_}(),$A=t.Pong=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&j.uint32(16).uint64(e.ms),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.Pong;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.ms=e.uint64();break;default:e.skipType(7&zt)}}return Vt},_}(),aB=t.UserJoin=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.opt=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.ticket="",_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.opt!=null&&Object.hasOwnProperty.call(e,"opt")&&j.uint32(16).uint64(e.opt),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(24).uint64(e.instance),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(34).string(e.account),e.ticket!=null&&Object.hasOwnProperty.call(e,"ticket")&&j.uint32(42).string(e.ticket),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserJoin;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.opt=e.uint64();break;case 3:Vt.instance=e.uint64();break;case 4:Vt.account=e.string();break;case 5:Vt.ticket=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),bB=t.UserResp=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(24).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserResp;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),cB=t.UserQuit=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.encode=function(e,j){return j||(j=L.create()),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserQuit;e.pos<j;){var zt=e.uint32();e.skipType(7&zt)}return Vt},_}(),dB=t.UserDrop=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(8).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserDrop;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),eB=t.GroupEnter=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupEnter;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),fB=t.GroupLeave=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.account="",_.encode=function(e,j){return j||(j=L.create()),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(10).string(e.account),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupLeave;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.account=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),gB=t.GroupReply=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(24).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupReply;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),ur=t.GroupLeaveNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.user="",_.prototype.group="",_.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.size=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&j.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&j.uint32(40).uint32(e.size),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupLeaveNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.user=e.string();break;case 3:Vt.group=e.string();break;case 4:Vt.instance=e.uint64();break;case 5:Vt.size=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),vr=t.GroupEnterNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.user="",_.prototype.group="",_.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.size=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&j.uint32(18).string(e.user),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(26).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(32).uint64(e.instance),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&j.uint32(40).uint32(e.size),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupEnterNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.user=e.string();break;case 3:Vt.group=e.string();break;case 4:Vt.instance=e.uint64();break;case 5:Vt.size=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),wr=t.Message=function(){function _(e){if(this.MiscMap={},e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.options=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.src="",_.prototype.dst="",_.prototype.payload=q.newBuffer([]),_.prototype.MiscMap=q.emptyObject,_.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,_.encode=function(e,j){if(j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&j.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&j.uint32(24).uint64(e.sequence),e.options!=null&&Object.hasOwnProperty.call(e,"options")&&j.uint32(32).uint64(e.options),e.src!=null&&Object.hasOwnProperty.call(e,"src")&&j.uint32(42).string(e.src),e.dst!=null&&Object.hasOwnProperty.call(e,"dst")&&j.uint32(50).string(e.dst),e.payload!=null&&Object.hasOwnProperty.call(e,"payload")&&j.uint32(58).bytes(e.payload),e.MiscMap!=null&&Object.hasOwnProperty.call(e,"MiscMap"))for(var Vt=Object.keys(e.MiscMap),zt=0;zt<Vt.length;++zt)j.uint32(66).fork().uint32(10).string(Vt[zt]).uint32(18).bytes(e.MiscMap[Vt[zt]]).ldelim();return e.ms!=null&&Object.hasOwnProperty.call(e,"ms")&&j.uint32(72).uint64(e.ms),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt,zt,_r=new t.Message;e.pos<j;)switch(Vt=e.uint32(),Vt>>>3){case 1:_r.instance=e.uint64();break;case 2:_r.dialogue=e.uint64();break;case 3:_r.sequence=e.uint64();break;case 4:_r.options=e.uint64();break;case 5:_r.src=e.string();break;case 6:_r.dst=e.string();break;case 7:_r.payload=e.bytes();break;case 8:_r.MiscMap===q.emptyObject&&(_r.MiscMap={});var _o=e.uint32()+e.pos;for(Vt="",zt=[];e.pos<_o;){var ga=e.uint32();switch(ga>>>3){case 1:Vt=e.string();break;case 2:zt=e.bytes();break;default:e.skipType(7&ga)}}_r.MiscMap[Vt]=zt;break;case 9:_r.ms=e.uint64();break;default:e.skipType(7&Vt)}return _r},_}(),xr=t.Ack=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.dialogue=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.sequence=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.dialogue!=null&&Object.hasOwnProperty.call(e,"dialogue")&&j.uint32(16).uint64(e.dialogue),e.sequence!=null&&Object.hasOwnProperty.call(e,"sequence")&&j.uint32(24).uint64(e.sequence),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(32).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.Ack;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.instance=e.uint64();break;case 2:Vt.dialogue=e.uint64();break;case 3:Vt.sequence=e.uint64();break;case 4:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),hB=t.FileUploadIndexGet=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.hash=q.newBuffer([]),_.prototype.size=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&j.uint32(18).bytes(e.hash),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&j.uint32(24).uint32(e.size),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileUploadIndexGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.hash=e.bytes();break;case 3:Vt.size=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),iB=t.FileUploadIndexRet=function(){function _(e){if(this.servers=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.unit=0,_.prototype.servers=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&j.uint32(16).uint32(e.unit),e.servers!=null&&e.servers.length){j.uint32(26).fork();for(var Vt=0;Vt<e.servers.length;++Vt)j.uint32(e.servers[Vt]);j.ldelim()}return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileUploadIndexRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.unit=e.uint32();break;case 3:if(Vt.servers&&Vt.servers.length||(Vt.servers=[]),(7&zt)==2)for(zt=e.uint32()+e.pos;e.pos<zt;)Vt.servers.push(e.uint32());else Vt.servers.push(e.uint32());break;default:e.skipType(7&zt)}}return Vt},_}(),jB=t.FileUploadIndexSet=function(){function _(e){if(this.servers=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.hash=q.newBuffer([]),_.prototype.unit=0,_.prototype.servers=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&j.uint32(18).bytes(e.hash),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&j.uint32(24).uint32(e.unit),e.servers!=null&&e.servers.length){j.uint32(34).fork();for(var Vt=0;Vt<e.servers.length;++Vt)j.uint32(e.servers[Vt]);j.ldelim()}return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileUploadIndexSet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.hash=e.bytes();break;case 3:Vt.unit=e.uint32();break;case 4:if(Vt.servers&&Vt.servers.length||(Vt.servers=[]),(7&zt)==2)for(zt=e.uint32()+e.pos;e.pos<zt;)Vt.servers.push(e.uint32());else Vt.servers.push(e.uint32());break;default:e.skipType(7&zt)}}return Vt},_}(),kB=t.FileUploadIndexFin=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.zone=0,_.prototype.unit=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&j.uint32(16).uint32(e.zone),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&j.uint32(24).uint32(e.unit),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileUploadIndexFin;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.zone=e.uint32();break;case 3:Vt.unit=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),lB=t.FileUploadIndexErr=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(16).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileUploadIndexErr;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),mB=t.FileDownloadIndexGet=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.zone=0,_.prototype.hash=q.newBuffer([]),_.prototype.size=0,_.prototype.unit=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&j.uint32(16).uint32(e.zone),e.hash!=null&&Object.hasOwnProperty.call(e,"hash")&&j.uint32(26).bytes(e.hash),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&j.uint32(32).uint32(e.size),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&j.uint32(40).uint32(e.unit),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileDownloadIndexGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.zone=e.uint32();break;case 3:Vt.hash=e.bytes();break;case 4:Vt.size=e.uint32();break;case 5:Vt.unit=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),nB=t.FileDownloadIndexRet=function(){function _(e){if(this.servers=[],this.backups=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.unit=0,_.prototype.zone=0,_.prototype.servers=q.emptyArray,_.prototype.backups=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.unit!=null&&Object.hasOwnProperty.call(e,"unit")&&j.uint32(16).uint32(e.unit),e.zone!=null&&Object.hasOwnProperty.call(e,"zone")&&j.uint32(24).uint32(e.zone),e.servers!=null&&e.servers.length){j.uint32(34).fork();for(var Vt=0;Vt<e.servers.length;++Vt)j.uint32(e.servers[Vt]);j.ldelim()}if(e.backups!=null&&e.backups.length){for(j.uint32(42).fork(),Vt=0;Vt<e.backups.length;++Vt)j.uint32(e.backups[Vt]);j.ldelim()}return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileDownloadIndexRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.unit=e.uint32();break;case 3:Vt.zone=e.uint32();break;case 4:if(Vt.servers&&Vt.servers.length||(Vt.servers=[]),(7&zt)==2)for(zt=e.uint32()+e.pos;e.pos<zt;)Vt.servers.push(e.uint32());else Vt.servers.push(e.uint32());break;case 5:if(Vt.backups&&Vt.backups.length||(Vt.backups=[]),(7&zt)==2)for(zt=e.uint32()+e.pos;e.pos<zt;)Vt.backups.push(e.uint32());else Vt.backups.push(e.uint32());break;default:e.skipType(7&zt)}}return Vt},_}(),oB=t.FileDownloadIndexErr=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(16).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.FileDownloadIndexErr;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),pB=t.GroupAllUsersList=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.pageSize=0,_.prototype.pageNumber=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&j.uint32(24).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&j.uint32(32).uint32(e.pageNumber),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAllUsersList;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.pageSize=e.uint32();break;case 4:Vt.pageNumber=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),qB=t.GroupAllUsersResult=function(){function _(e){if(this.memberInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.totalSize=0,_.prototype.pageSize=0,_.prototype.pageNumber=0,_.prototype.memberInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.totalSize!=null&&Object.hasOwnProperty.call(e,"totalSize")&&j.uint32(24).uint32(e.totalSize),e.pageSize!=null&&Object.hasOwnProperty.call(e,"pageSize")&&j.uint32(32).uint32(e.pageSize),e.pageNumber!=null&&Object.hasOwnProperty.call(e,"pageNumber")&&j.uint32(40).uint32(e.pageNumber),e.memberInfos!=null&&e.memberInfos.length)for(var Vt=0;Vt<e.memberInfos.length;++Vt)t.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[Vt],j.uint32(50).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAllUsersResult;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.totalSize=e.uint32();break;case 4:Vt.pageSize=e.uint32();break;case 5:Vt.pageNumber=e.uint32();break;case 6:Vt.memberInfos&&Vt.memberInfos.length||(Vt.memberInfos=[]),Vt.memberInfos.push(t.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.MemberInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.account!=null&&Object.hasOwnProperty.call(j,"account")&&Vt.uint32(10).string(j.account),j.ts!=null&&Object.hasOwnProperty.call(j,"ts")&&Vt.uint32(16).uint32(j.ts),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupAllUsersResult.MemberInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.account=j.string();break;case 2:zt.ts=j.uint32();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),rB=t.UserStatusList=function(){function _(e){if(this.users=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.users=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var Vt=0;Vt<e.users.length;++Vt)j.uint32(18).string(e.users[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserStatusList;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.users&&Vt.users.length||(Vt.users=[]),Vt.users.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),sB=t.UserStatusResult=function(){function _(e){if(this.userInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.userInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.userInfos!=null&&e.userInfos.length)for(var Vt=0;Vt<e.userInfos.length;++Vt)t.UserStatusResult.UserStatusInfo.encode(e.userInfos[Vt],j.uint32(18).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserStatusResult;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.userInfos&&Vt.userInfos.length||(Vt.userInfos=[]),Vt.userInfos.push(t.UserStatusResult.UserStatusInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.UserStatusInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.account!=null&&Object.hasOwnProperty.call(j,"account")&&Vt.uint32(10).string(j.account),j.ts!=null&&Object.hasOwnProperty.call(j,"ts")&&Vt.uint32(16).uint32(j.ts),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.UserStatusResult.UserStatusInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.account=j.string();break;case 2:zt.ts=j.uint32();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),tB=t.UserAttributeGet=function(){function _(e){if(this.attributes=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.attributes=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var Vt=0;Vt<e.attributes.length;++Vt)j.uint32(26).string(e.attributes[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.attributes&&Vt.attributes.length||(Vt.attributes=[]),Vt.attributes.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),uB=t.UserAttributeRet=function(){function _(e){if(this.attributeInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.attributeInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.attributeInfos!=null&&e.attributeInfos.length)for(var Vt=0;Vt<e.attributeInfos.length;++Vt)t.UserAttributeRet.AttributeInfo.encode(e.attributeInfos[Vt],j.uint32(18).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.attributeInfos&&Vt.attributeInfos.length||(Vt.attributeInfos=[]),Vt.attributeInfos.push(t.UserAttributeRet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.UserAttributeRet.AttributeInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),vB=t.UserAttributeSet=function(){function _(e){if(this.attributeInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.attributeInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var Vt=0;Vt<e.attributeInfos.length;++Vt)t.UserAttributeSet.AttributeInfo.encode(e.attributeInfos[Vt],j.uint32(26).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeSet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.attributeInfos&&Vt.attributeInfos.length||(Vt.attributeInfos=[]),Vt.attributeInfos.push(t.UserAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.UserAttributeSet.AttributeInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),wB=t.UserAttributeMod=function(){function _(e){if(this.attributeInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.attributeInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.attributeInfos!=null&&e.attributeInfos.length)for(var Vt=0;Vt<e.attributeInfos.length;++Vt)t.UserAttributeMod.AttributeInfo.encode(e.attributeInfos[Vt],j.uint32(26).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeMod;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.attributeInfos&&Vt.attributeInfos.length||(Vt.attributeInfos=[]),Vt.attributeInfos.push(t.UserAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.UserAttributeMod.AttributeInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),xB=t.UserAttributeDel=function(){function _(e){if(this.attributes=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.prototype.attributes=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),e.attributes!=null&&e.attributes.length)for(var Vt=0;Vt<e.attributes.length;++Vt)j.uint32(26).string(e.attributes[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeDel;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;case 3:Vt.attributes&&Vt.attributes.length||(Vt.attributes=[]),Vt.attributes.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),yB=t.UserAttributeErr=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(16).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeErr;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),zB=t.UserAttributeKeysGet=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.account="",_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.account!=null&&Object.hasOwnProperty.call(e,"account")&&j.uint32(18).string(e.account),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeKeysGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.account=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),AB=t.UserAttributeKeysRet=function(){function _(e){if(this.keys=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.keys=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var Vt=0;Vt<e.keys.length;++Vt)j.uint32(18).string(e.keys[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeKeysRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.keys&&Vt.keys.length||(Vt.keys=[]),Vt.keys.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),BB=t.UserAttributeRsp=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserAttributeRsp;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;default:e.skipType(7&zt)}}return Vt},_}(),CB=t.GroupStatusList=function(){function _(e){if(this.groups=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.groups=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.groups!=null&&e.groups.length)for(var Vt=0;Vt<e.groups.length;++Vt)j.uint32(18).string(e.groups[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupStatusList;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.groups&&Vt.groups.length||(Vt.groups=[]),Vt.groups.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),DB=t.GroupStatusResult=function(){function _(e){if(this.groupInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.groupInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.groupInfos!=null&&e.groupInfos.length)for(var Vt=0;Vt<e.groupInfos.length;++Vt)t.GroupStatusResult.GroupInfo.encode(e.groupInfos[Vt],j.uint32(18).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupStatusResult;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.groupInfos&&Vt.groupInfos.length||(Vt.groupInfos=[]),Vt.groupInfos.push(t.GroupStatusResult.GroupInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.GroupInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.group="",e.prototype.memberCount=0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.group!=null&&Object.hasOwnProperty.call(j,"group")&&Vt.uint32(10).string(j.group),j.memberCount!=null&&Object.hasOwnProperty.call(j,"memberCount")&&Vt.uint32(16).uint32(j.memberCount),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupStatusResult.GroupInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.group=j.string();break;case 2:zt.memberCount=j.uint32();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),EB=t.GroupCountNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.size=0,_.encode=function(e,j){return j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(16).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(26).string(e.group),e.size!=null&&Object.hasOwnProperty.call(e,"size")&&j.uint32(32).uint32(e.size),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupCountNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.instance=e.uint64();break;case 2:Vt.seq=e.uint64();break;case 3:Vt.group=e.string();break;case 4:Vt.size=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),FB=t.GroupAttributeGet=function(){function _(e){if(this.attributes=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.attributes=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.attributes!=null&&e.attributes.length)for(var Vt=0;Vt<e.attributes.length;++Vt)j.uint32(26).string(e.attributes[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.attributes&&Vt.attributes.length||(Vt.attributes=[]),Vt.attributes.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),GB=t.GroupAttributeRet=function(){function _(e){if(this.attributeMaps=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.attributeMaps=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.attributeMaps!=null&&e.attributeMaps.length)for(var Vt=0;Vt<e.attributeMaps.length;++Vt)t.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[Vt],j.uint32(18).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.attributeMaps&&Vt.attributeMaps.length||(Vt.attributeMaps=[]),Vt.attributeMaps.push(t.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeMap=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),j.origin!=null&&Object.hasOwnProperty.call(j,"origin")&&Vt.uint32(26).string(j.origin),j.ms!=null&&Object.hasOwnProperty.call(j,"ms")&&Vt.uint32(32).uint64(j.ms),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupAttributeRet.AttributeMap;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;case 3:zt.origin=j.string();break;case 4:zt.ms=j.uint64();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),HB=t.GroupAttributeSet=function(){function _(e){if(this.attributeInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.broadcast=!1,_.prototype.attributeInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&j.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var Vt=0;Vt<e.attributeInfos.length;++Vt)t.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[Vt],j.uint32(34).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeSet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.broadcast=e.bool();break;case 4:Vt.attributeInfos&&Vt.attributeInfos.length||(Vt.attributeInfos=[]),Vt.attributeInfos.push(t.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupAttributeSet.AttributeInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),IB=t.GroupAttributeMod=function(){function _(e){if(this.attributeInfos=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.broadcast=!1,_.prototype.attributeInfos=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&j.uint32(24).bool(e.broadcast),e.attributeInfos!=null&&e.attributeInfos.length)for(var Vt=0;Vt<e.attributeInfos.length;++Vt)t.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[Vt],j.uint32(34).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeMod;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.broadcast=e.bool();break;case 4:Vt.attributeInfos&&Vt.attributeInfos.length||(Vt.attributeInfos=[]),Vt.attributeInfos.push(t.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeInfo=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupAttributeMod.AttributeInfo;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),JB=t.GroupAttributeDel=function(){function _(e){if(this.attributes=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.broadcast=!1,_.prototype.attributes=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.broadcast!=null&&Object.hasOwnProperty.call(e,"broadcast")&&j.uint32(24).bool(e.broadcast),e.attributes!=null&&e.attributes.length)for(var Vt=0;Vt<e.attributes.length;++Vt)j.uint32(34).string(e.attributes[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeDel;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.broadcast=e.bool();break;case 4:Vt.attributes&&Vt.attributes.length||(Vt.attributes=[]),Vt.attributes.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),KB=t.GroupAttributeAlt=function(){function _(e){if(this.attributeMaps=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.attributeMaps=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(24).uint64(e.instance),e.attributeMaps!=null&&e.attributeMaps.length)for(var Vt=0;Vt<e.attributeMaps.length;++Vt)t.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[Vt],j.uint32(34).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeAlt;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;case 3:Vt.instance=e.uint64();break;case 4:Vt.attributeMaps&&Vt.attributeMaps.length||(Vt.attributeMaps=[]),Vt.attributeMaps.push(t.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.AttributeMap=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=q.Long?q.Long.fromBits(0,0,!0):0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.key!=null&&Object.hasOwnProperty.call(j,"key")&&Vt.uint32(10).string(j.key),j.value!=null&&Object.hasOwnProperty.call(j,"value")&&Vt.uint32(18).string(j.value),j.origin!=null&&Object.hasOwnProperty.call(j,"origin")&&Vt.uint32(26).string(j.origin),j.ms!=null&&Object.hasOwnProperty.call(j,"ms")&&Vt.uint32(32).uint64(j.ms),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.GroupAttributeAlt.AttributeMap;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.key=j.string();break;case 2:zt.value=j.string();break;case 3:zt.origin=j.string();break;case 4:zt.ms=j.uint64();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),LB=t.GroupAttributeRsp=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeRsp;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;default:e.skipType(7&zt)}}return Vt},_}(),MB=t.GroupAttributeErr=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.code=0,_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(16).uint32(e.code),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeErr;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.code=e.uint32();break;default:e.skipType(7&zt)}}return Vt},_}(),NB=t.GroupAttributeKeysGet=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.group="",_.encode=function(e,j){return j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.group!=null&&Object.hasOwnProperty.call(e,"group")&&j.uint32(18).string(e.group),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeKeysGet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.group=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),OB=t.GroupAttributeKeysRet=function(){function _(e){if(this.keys=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.keys=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.keys!=null&&e.keys.length)for(var Vt=0;Vt<e.keys.length;++Vt)j.uint32(18).string(e.keys[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.GroupAttributeKeysRet;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.keys&&Vt.keys.length||(Vt.keys=[]),Vt.keys.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),PB=t.SubscribeUserStatus=function(){function _(e){if(this.users=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.users=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var Vt=0;Vt<e.users.length;++Vt)j.uint32(18).string(e.users[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.SubscribeUserStatus;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.users&&Vt.users.length||(Vt.users=[]),Vt.users.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),QB=t.UnsubscribeUserStatus=function(){function _(e){if(this.users=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.users=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.users!=null&&e.users.length)for(var Vt=0;Vt<e.users.length;++Vt)j.uint32(18).string(e.users[Vt]);return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UnsubscribeUserStatus;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.users&&Vt.users.length||(Vt.users=[]),Vt.users.push(e.string());break;default:e.skipType(7&zt)}}return Vt},_}(),RB=t.UserJoinNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.user="",_.encode=function(e,j){return j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&j.uint32(26).string(e.user),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserJoinNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.instance=e.uint64();break;case 2:Vt.seq=e.uint64();break;case 3:Vt.user=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),SB=t.UserQuitNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.user="",_.encode=function(e,j){return j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&j.uint32(26).string(e.user),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserQuitNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.instance=e.uint64();break;case 2:Vt.seq=e.uint64();break;case 3:Vt.user=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),TB=t.UserWaitNotice=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.instance=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.user="",_.encode=function(e,j){return j||(j=L.create()),e.instance!=null&&Object.hasOwnProperty.call(e,"instance")&&j.uint32(8).uint64(e.instance),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(16).uint64(e.seq),e.user!=null&&Object.hasOwnProperty.call(e,"user")&&j.uint32(26).string(e.user),j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.UserWaitNotice;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.instance=e.uint64();break;case 2:Vt.seq=e.uint64();break;case 3:Vt.user=e.string();break;default:e.skipType(7&zt)}}return Vt},_}(),UB=t.SubscribeResponse=function(){function _(e){if(this.errors=[],e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.seq=q.Long?q.Long.fromBits(0,0,!0):0,_.prototype.errors=q.emptyArray,_.encode=function(e,j){if(j||(j=L.create()),e.seq!=null&&Object.hasOwnProperty.call(e,"seq")&&j.uint32(8).uint64(e.seq),e.errors!=null&&e.errors.length)for(var Vt=0;Vt<e.errors.length;++Vt)t.SubscribeResponse.SubscribeErrorsType.encode(e.errors[Vt],j.uint32(18).fork()).ldelim();return j},_.decode=function(e,j){e instanceof u||(e=u.create(e)),j=j===void 0?e.len:e.pos+j;for(var Vt=new t.SubscribeResponse;e.pos<j;){var zt=e.uint32();switch(zt>>>3){case 1:Vt.seq=e.uint64();break;case 2:Vt.errors&&Vt.errors.length||(Vt.errors=[]),Vt.errors.push(t.SubscribeResponse.SubscribeErrorsType.decode(e,e.uint32()));break;default:e.skipType(7&zt)}}return Vt},_.SubscribeErrorsType=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(j,Vt){return Vt||(Vt=L.create()),j.account!=null&&Object.hasOwnProperty.call(j,"account")&&Vt.uint32(10).string(j.account),j.code!=null&&Object.hasOwnProperty.call(j,"code")&&Vt.uint32(16).uint32(j.code),Vt},e.decode=function(j,Vt){j instanceof u||(j=u.create(j)),Vt=Vt===void 0?j.len:j.pos+Vt;for(var zt=new t.SubscribeResponse.SubscribeErrorsType;j.pos<Vt;){var _r=j.uint32();switch(_r>>>3){case 1:zt.account=j.string();break;case 2:zt.code=j.uint32();break;default:j.skipType(7&_r)}}return zt},e}(),_}(),VB=Object.freeze({__proto__:null,URI:YA,Wrapper:Oh,Ping:ZA,Pong:$A,UserJoin:aB,UserResp:bB,UserQuit:cB,UserDrop:dB,GroupEnter:eB,GroupLeave:fB,GroupReply:gB,GroupLeaveNotice:ur,GroupEnterNotice:vr,Message:wr,Ack:xr,FileUploadIndexGet:hB,FileUploadIndexRet:iB,FileUploadIndexSet:jB,FileUploadIndexFin:kB,FileUploadIndexErr:lB,FileDownloadIndexGet:mB,FileDownloadIndexRet:nB,FileDownloadIndexErr:oB,GroupAllUsersList:pB,GroupAllUsersResult:qB,UserStatusList:rB,UserStatusResult:sB,UserAttributeGet:tB,UserAttributeRet:uB,UserAttributeSet:vB,UserAttributeMod:wB,UserAttributeDel:xB,UserAttributeErr:yB,UserAttributeKeysGet:zB,UserAttributeKeysRet:AB,UserAttributeRsp:BB,GroupStatusList:CB,GroupStatusResult:DB,GroupCountNotice:EB,GroupAttributeGet:FB,GroupAttributeRet:GB,GroupAttributeSet:HB,GroupAttributeMod:IB,GroupAttributeDel:JB,GroupAttributeAlt:KB,GroupAttributeRsp:LB,GroupAttributeErr:MB,GroupAttributeKeysGet:NB,GroupAttributeKeysRet:OB,SubscribeUserStatus:PB,UnsubscribeUserStatus:QB,UserJoinNotice:RB,UserQuitNotice:SB,UserWaitNotice:TB,SubscribeResponse:UB,default:t}),WB=Math.ceil,yr=function(_){return function(e,j,Vt){var zt=(e=String(jb(e))).length;return Vt=Vt===void 0?" ":String(Vt),(j=ta(j))<=zt||Vt==""?e:(j-=zt,(zt=Pn.call(Vt,WB(j/Vt.length))).length>j&&(zt=zt.slice(0,j)),_?e+zt:zt+e)}},XB=yr(!1),YB=yr(!0),zr=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(De);N({target:"String",proto:!0,forced:zr},{padEnd:function(_){return YB(this,_,1<arguments.length?arguments[1]:void 0)}});var ZB=zf,Ar=function(_){return function(e){e=qb(e);for(var j,Vt=Dc(e),zt=Vt.length,_r=0,_o=[];zt>_r;)j=Vt[_r++],ka&&!ZB.call(e,j)||_o.push(_?[j,e[j]]:e[j]);return _o}},$B=Ar(!0),aC=Ar(!1);N({target:"Object",stat:!0},{entries:function(_){return $B(_)}});var bC=Fb.f,Br="".endsWith,cC=Math.min,Cr=dk("endsWith"),dC=!Cr&&!!function(){var _=bC(String.prototype,"endsWith");return _&&!_.writable}();N({target:"String",proto:!0,forced:!dC&&!Cr},{endsWith:function(_){var e=String(jb(this));ck(_);var j=1<arguments.length?arguments[1]:void 0,Vt=ta(e.length);return j=j===void 0?Vt:cC(ta(j),Vt),Vt=String(_),Br?Br.call(e,Vt,j):e.slice(j-Vt.length,j)===Vt}}),dh("match",1,function(_,e,j){return[function(Vt){var zt=jb(this),_r=Vt==null?void 0:Vt[_];return _r!==void 0?_r.call(Vt,zt):new RegExp(Vt)[_](String(zt))},function(Vt){var zt=j(e,Vt,this);if(zt.done)return zt.value;if(Vt=va(Vt),zt=String(this),!Vt.global)return Ke(Vt,zt);var _r=Vt.unicode;Vt.lastIndex=0;for(var _o,ga=[],_a=0;(_o=Ke(Vt,zt))!==null;)_o=String(_o[0]),ga[_a]=_o,_o===""&&(Vt.lastIndex=xj(zt,ta(Vt.lastIndex),_r)),_a++;return _a===0?null:ga}]});var eC=Fb.f,Dr="".startsWith,fC=Math.min,Er=dk("startsWith"),gC=!Er&&!!function(){var _=eC(String.prototype,"startsWith");return _&&!_.writable}();N({target:"String",proto:!0,forced:!gC&&!Er},{startsWith:function(_){var e=String(jb(this));ck(_);var j=ta(fC(1<arguments.length?arguments[1]:void 0,e.length)),Vt=String(_);return Dr?Dr.call(e,Vt,j):e.slice(j,j+Vt.length)===Vt}});var Nm=function(_){var e=/(%?)(%([jds]))/g,j=Array.prototype.slice.call(arguments,1);return j.length&&(_=_.replace(e,function(Vt,zt,_r,_o){switch(_r=j.shift(),_o){case"s":_r=""+_r;break;case"d":_r=Number(_r);break;case"j":_r=JSON.stringify(_r)}return zt?(j.unshift(_r),Vt):_r})),j.length&&(_+=" "+j.join(" ")),""+(_=_.replace(/%{2,2}/g,"%"))},hC=/\s/,iC=function(_){for(var e=_.length;e--&&hC.test(_.charAt(e)););return e},jC=/^\s+/,Fr=NaN,kC=/^[-+]0x[0-9a-f]+$/i,lC=/^0b[01]+$/i,mC=/^0o[0-7]+$/i,nC=parseInt,gl=function(_){if(typeof _=="number")return _;if(ie(_))return Fr;if(lb(_)&&(_=typeof _.valueOf=="function"?_.valueOf():_,_=lb(_)?_+"":_),typeof _!="string")return _===0?_:+_;_=_&&_.slice(0,iC(_)+1).replace(jC,"");var e=lC.test(_);return e||mC.test(_)?nC(_.slice(2),e?2:8):kC.test(_)?Fr:+_},oC=Math.max,pC=Math.min,qC=function(_,e,j){function Vt(sE){var lE=_a,EE=_l;return _a=_l=void 0,tE=sE,_d=_.apply(EE,lE)}function zt(sE){var lE=sE-_m;return sE-=tE,_m===void 0||lE>=e||0>lE||oE&&sE>=nE}function _r(){var sE=Cb.Date.now();if(zt(sE))return _o(sE);var lE=setTimeout,EE=sE-tE;sE=e-(sE-_m),EE=oE?pC(sE,nE-EE):sE,_f=lE(_r,EE)}function _o(sE){return _f=void 0,dE&&_a?Vt(sE):(_a=_l=void 0,_d)}function ga(){var sE=Cb.Date.now(),lE=zt(sE);if(_a=arguments,_l=this,_m=sE,lE){if(_f===void 0)return tE=sE=_m,_f=setTimeout(_r,e),rE?Vt(sE):_d;if(oE)return clearTimeout(_f),_f=setTimeout(_r,e),Vt(_m)}return _f===void 0&&(_f=setTimeout(_r,e)),_d}var _a,_l,_d,_f,_m,tE=0,rE=!1,oE=!1,dE=!0;if(typeof _!="function")throw new TypeError("Expected a function");if(e=gl(e)||0,lb(j)){rE=!!j.leading;var nE=(oE="maxWait"in j)?oC(gl(j.maxWait)||0,e):nE;dE="trailing"in j?!!j.trailing:dE}return ga.cancel=function(){_f!==void 0&&clearTimeout(_f),tE=0,_a=_m=_l=_f=void 0},ga.flush=function(){return _f===void 0?_d:_o(Cb.Date.now())},ga},yc=function(_){function e(Vt,zt){return W(this,e),m(n(Vt=j.call(this,Mm(Vt,zt))),"originalError",void 0),m(n(Vt),"code",void 0),m(n(Vt),"serverCode",void 0),typeof zt=="number"?Vt.code=zt:typeof zt=="string"?Vt.name=zt:zt!==void 0&&(zt.originalError&&(Vt.originalError=zt.originalError),zt.code!==void 0&&(Vt.code=zt.code),zt.serverCode!==void 0&&(Vt.serverCode=zt.serverCode)),Vt}la(e,_);var j=ma(e);return e}(ef(Error)),Ia=function(_){function e(Vt,zt){return W(this,e),m(n(Vt=j.call(this,Mm(Vt,zt))),"name","RtmInternalError"),m(n(Vt),"code",void 0),Vt.code=zt,Vt}la(e,_);var j=ma(e);return e}(ef(Error)),Ph=function(){return function(_){function e(Vt){W(this,e);var zt=Object.keys(Vt);return j.call(this,Vt[zt[0]],zt[0])}la(e,_);var j=ma(e);return e}(Ia)},Fa=Ph(),db=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmTimeoutError"),Vt}la(e,_);var j=ma(e);return e}(yc),I=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmInvalidArgumentError"),Vt}la(e,_);var j=ma(e);return e}(yc),K=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmInvalidStatusError"),Vt}la(e,_);var j=ma(e);return e}(yc),hl=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmInterruptedError"),Vt}la(e,_);var j=ma(e);return e}(yc),ib=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmLimitExceededError"),Vt}la(e,_);var j=ma(e);return e}(yc),rC=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmInvokeTooOftenError"),Vt}la(e,_);var j=ma(e);return e}(yc),da=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmUnavailableError"),m(n(Vt),"serverCode",void 0),m(n(Vt),"statusCode",void 0),Vt}la(e,_);var j=ma(e);return e}(yc),Ye=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmUnauthenticatedError"),m(n(Vt),"serverCode",void 0),Vt}la(e,_);var j=ma(e);return e}(yc),Wc=function(_){function e(){W(this,e);for(var Vt=arguments.length,zt=Array(Vt),_r=0;_r<Vt;_r++)zt[_r]=arguments[_r];return m(n(Vt=j.call.apply(j,[this].concat(zt))),"name","RtmUnknownError"),Vt}la(e,_);var j=ma(e);return e}(yc),Sa=function(_){return _ instanceof db||_ instanceof pb},sa=function(_){return _ instanceof yc},Yd=function(_,e,j){return['Executing "%s.%s" timed out after %ds',_,e,j/1e3]},Lm=new Map,sC=function(){var _=new Date;return"".concat(_.toISOString().split("T")[1].replace(/\..+/,""),".").concat(_.getMilliseconds())},xf=Object.keys,Hg=Object.entries.bind(Object),Cg=function(_){return typeof _=="string"?_.endsWith(".")?_:"".concat(_,"."):_},Sm=function(_){for(var e="",j=(_=new Uint8Array(_)).byteLength,Vt=-1;++Vt<j;)e+=String.fromCharCode(_[Vt]);return e=btoa(e),"data:;base64,".concat(e)},tC=R(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});N({target:"Date",proto:!0,forced:tC},{toJSON:function(_){_=Qa(this);var e=lc(_);return typeof e!="number"||isFinite(e)?_.toISOString():null}}),N({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var $t=Object.prototype.hasOwnProperty,Gr=function(_,e,j){return JSON.stringify(Ym(_),e,j)};Gr.ensureProperties=Ym;var uC=function(_,e){e=e||{};var j=X(_);if(j==="string"&&0<_.length)return au(_);if(j==="number"&&isFinite(_))return e.long?_=864e5<=(e=Math.abs(_))?Jg(_,e,864e5,"day"):36e5<=e?Jg(_,e,36e5,"hour"):6e4<=e?Jg(_,e,6e4,"minute"):1e3<=e?Jg(_,e,1e3,"second"):_+" ms":_=864e5<=(e=Math.abs(_))?Math.round(_/864e5)+"d":36e5<=e?Math.round(_/36e5)+"h":6e4<=e?Math.round(_/6e4)+"m":1e3<=e?Math.round(_/1e3)+"s":_+"ms",_;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))},vC=function(_){function e(zt){function _r(){for(var _a=arguments.length,_l=Array(_a),_d=0;_d<_a;_d++)_l[_d]=arguments[_d];if(_r.enabled){_a=Number(new Date),_r.diff=_a-(_o||_a),_r.prev=_o,_o=_r.curr=_a,_l[0]=e.coerce(_l[0]),typeof _l[0]!="string"&&_l.unshift("%O");var _f=0;_l[0]=_l[0].replace(/%([a-zA-Z%])/g,function(_m,tE){return _m==="%%"?"%":(_f++,typeof(tE=e.formatters[tE])=="function"&&(_m=tE.call(_r,_l[_f]),_l.splice(_f,1),_f--),_m)}),e.formatArgs.call(_r,_l),(_r.log||e.log).apply(_r,_l)}}var _o,ga=null;return _r.namespace=zt,_r.useColors=e.useColors(),_r.color=e.selectColor(zt),_r.extend=j,_r.destroy=e.destroy,Object.defineProperty(_r,"enabled",{enumerable:!0,configurable:!1,get:function(){return ga===null?e.enabled(zt):ga},set:function(_a){ga=_a}}),typeof e.init=="function"&&e.init(_r),_r}function j(zt,_r){return(zt=e(this.namespace+(_r===void 0?":":_r)+zt)).log=this.log,zt}function Vt(zt){return zt.toString().substring(2,zt.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(zt){return zt instanceof Error?zt.stack||zt.message:zt},e.disable=function(){var zt=[].concat(G(e.names.map(Vt)),G(e.skips.map(Vt).map(function(_r){return"-"+_r}))).join(",");return e.enable(""),zt},e.enable=function(zt){e.save(zt),e.names=[],e.skips=[];var _r,_o=(typeof zt=="string"?zt:"").split(/[\s,]+/),ga=_o.length;for(_r=0;_r<ga;_r++)_o[_r]&&((zt=_o[_r].replace(/\*/g,".*?"))[0]==="-"?e.skips.push(new RegExp("^"+zt.substr(1)+"$")):e.names.push(new RegExp("^"+zt+"$")))},e.enabled=function(zt){if(zt[zt.length-1]==="*")return!0;var _r,_o=0;for(_r=e.skips.length;_o<_r;_o++)if(e.skips[_o].test(zt))return!1;for(_o=0,_r=e.names.length;_o<_r;_o++)if(e.names[_o].test(zt))return!0;return!1},e.humanize=uC,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(_).forEach(function(zt){e[zt]=_[zt]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(zt){for(var _r=0,_o=0;_o<zt.length;_o++)_r=(_r<<5)-_r+zt.charCodeAt(_o),_r|=0;return e.colors[Math.abs(_r)%e.colors.length]},e.enable(e.load()),e},Hr=$a(function(_,e){e.formatArgs=function(Vt){if(Vt[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Vt[0]+(this.useColors?"%c ":" ")+"+"+_.exports.humanize(this.diff),this.useColors){var zt="color: "+this.color;Vt.splice(1,0,zt,"color: inherit");var _r=0,_o=0;Vt[0].replace(/%[a-zA-Z%]/g,function(ga){ga!=="%%"&&(_r++,ga==="%c"&&(_o=_r))}),Vt.splice(_o,0,zt)}},e.save=function(Vt){try{Vt?e.storage.setItem("debug",Vt):e.storage.removeItem("debug")}catch{}},e.load=function(){try{var Vt=e.storage.getItem("debug")}catch{}return!Vt&&typeof process<"u"&&"env"in process&&(Vt=define_process_env_default.DEBUG),Vt},e.useColors=function(){return!(typeof window>"u"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator>"u"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};e:{try{var j=localStorage;break e}catch{}j=void 0}e.storage=j,e.destroy=function(){var Vt=!1;return function(){Vt||(Vt=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),e.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),e.log=console.debug||console.log||function(){},_.exports=vC(e),_.exports.formatters.j=function(Vt){try{return JSON.stringify(Vt)}catch(zt){return"[UnexpectedJSONParseError]: "+zt.message}}}),Ir=Hr("RTM:DEBUG"),Ze;Ir.enabled=!1,function(_){_[_.Uploading=0]="Uploading",_[_.Free=1]="Free"}(Ze||(Ze={}));var wC=function(){function _(e){W(this,_),m(this,"uploadRequest",void 0),m(this,"uploadState",void 0),m(this,"uploadResendCount",void 0),m(this,"LogCache",void 0),m(this,"LogsToPost",void 0),m(this,"processId",void 0),m(this,"sdkVersion",void 0),m(this,"logId",void 0),m(this,"rtmConfig",void 0),this.processId=e.processId,this.sdkVersion=e.sdkVersion,this.rtmConfig=e.rtmConfig,this.uploadRequest=e.uploadRequest,this.uploadState=Ze.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return Ha(_,[{key:"upload",value:function(e){this.LogCache.push(e),this.uploadState===Ze.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(e){var j=this;this.uploadState=Ze.Uploading,setTimeout(J(w.mark(function Vt(){var zt,_r,_o;return w.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:return zt={sdk_version:j.sdkVersion,process_id:j.processId,payload:JSON.stringify(e)},ga.prev=1,ga.next=4,j.uploadRequest(zt,(_r=j.rtmConfig.enableCloudProxy)!==null&&_r!==void 0&&_r);case 4:if(!Uk){ga.next=6;break}throw Error("RTM is busy");case 6:ga.next=13;break;case 8:return ga.prev=8,ga.t0=ga.catch(1),_o=2>j.uploadResendCount++?2e3:1e4,setTimeout(function(){return j.postLog(j.LogsToPost)},_o),ga.abrupt("return");case 13:if(Ir('The logs uploaded for "process-'.concat(gg,'"')),j.LogCache.length!==0){ga.next=17;break}return j.uploadState=Ze.Free,ga.abrupt("return");case 17:j.uploadResendCount=0,j.LogsToPost=40>j.LogCache.length?j.LogCache.splice(0,j.LogCache.length):j.LogCache.splice(0,40),j.postLog(j.LogsToPost);case 20:case"end":return ga.stop()}},Vt,null,[[1,8]])})),Zd.getParameter("LOG_UPLOAD_INTERVAL"))}}]),_}(),Jr=function(_,e,j,Vt,zt,_r,_o,ga){var _a=0;for(_o=!!_o&&Id(_o,ga,3);_a<Vt;){if(_a in j){if(ga=_o?_o(j[_a],_a,e):j[_a],0<_r&&gd(ga))zt=Jr(_,e,ga,ta(ga.length),zt,_r-1)-1;else{if(9007199254740991<=zt)throw TypeError("Exceed the acceptable array length");_[zt]=ga}zt++}_a++}return zt},xC=Jr;N({target:"Array",proto:!0},{flat:function(){var _=arguments.length?arguments[0]:void 0,e=Qa(this),j=ta(e.length),Vt=Sg(e,0);return Vt.length=xC(Vt,e,e,j,0,_===void 0?1:$b(_)),Vt}}),N({target:"Object",stat:!0},{values:function(_){return aC(_)}});var yC=["CODE"],Db,ud,F;(function(_){_.CHINA="CN",_.ASIA="AS",_.NORTH_AMERICA="NA",_.EUROPE="EU",_.JAPAN="JP",_.INDIA="IN",_.OCEANIA="OC",_.SOUTH_AMERICA="SA",_.AFRICA="AF",_.OVERSEA="OVERSEA",_.GLOBAL="GLOBAL"})(F||(F={}));var zC={CN:F.CHINA,NA:F.NORTH_AMERICA,EU:F.EUROPE,AS:F.ASIA,JP:F.JAPAN,IN:F.INDIA,GLOB:F.GLOBAL,AF:F.AFRICA,OC:F.OVERSEA,OVS:F.OVERSEA,SA:F.SOUTH_AMERICA},Kg=Wm((Db={},m(Db,F.ASIA,{CODE:F.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.NORTH_AMERICA,{CODE:F.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.EUROPE,{CODE:F.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.JAPAN,{CODE:F.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.INDIA,{CODE:F.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.OVERSEA,{CODE:F.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),m(Db,F.GLOBAL,{CODE:F.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.OCEANIA,{CODE:F.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.SOUTH_AMERICA,{CODE:F.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.AFRICA,{CODE:F.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),m(Db,F.CHINA,{CODE:F.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),Db)),yf=(ud={},m(ud,F.ASIA,[F.CHINA,F.JAPAN,F.INDIA]),m(ud,F.EUROPE,[]),m(ud,F.NORTH_AMERICA,[]),m(ud,F.SOUTH_AMERICA,[]),m(ud,F.OCEANIA,[]),m(ud,F.AFRICA,[]),ud),Kr=[F.OVERSEA,F.GLOBAL,F.CHINA,F.NORTH_AMERICA,F.EUROPE,F.ASIA,F.JAPAN,F.INDIA,F.OCEANIA,F.SOUTH_AMERICA,F.AFRICA],Zm=function(_){return Object.values(yf).flat().includes(_)},cu=function(_){var e;return(e=Hg(yf).find(function(j){return(j=ra(j,2))[0],j[1].includes(_)}))===null||e===void 0?void 0:e[0]},AC=function(_){return _.sort(function(e,j){return Kr.indexOf(e)-Kr.indexOf(j)})},xe=function(_){var e=new Set;if((_=AC(_).slice(0,3).map(function(j){var Vt=Kg[j];if(Vt===void 0)throw new Ia("invalid area key");return j=Vt.CODE,Vt=ff(Vt,yC),e.add(j),Vt})).length===0)throw new Ia("areas cannot be empty");return ua({CODES:e},_.reduce(function(j,Vt){for(var zt=0,_r=Hg(j);zt<_r.length;zt++){var _o=ra(_r[zt],2),ga=_o[0];_o=_o[1],j[ga]=Array.from(new Set([].concat(G(Vt[ga]),G(_o))))}return j}))},M,Lr=function(){var _=J(w.mark(function e(j,Vt){var zt,_r,_o,ga,_a,_l=arguments;return w.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(!(2<(_r=2<_l.length&&_l[2]!==void 0?_l[2]:0))){_d.next=3;break}return _d.abrupt("return");case 3:return _o={withCredentials:!0,body:j,timeout:2e4},ga=0<_r?(M==null?void 0:M.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(M==null?void 0:M.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",_a=Vt?"https://".concat((zt=M==null?void 0:M.PROXY_NGINX[0])!==null&&zt!==void 0?zt:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(ga,"&p=443&d=upload/v1"):"https://".concat(ga,"/upload/v1"),_d.next=8,te(_a,_o).catch(function(_f){return Lr(j,Vt,_r+1)});case 8:case"end":return _d.stop()}},e)}));return function(e,j){return _.apply(this,arguments)}}(),Mr=new wC({processId:"process-".concat(gg),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.4.3-17-g1e27aa38"),uploadRequest:Lr,rtmConfig:{}}),il="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Nr="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Or="serverReceivedTs isOfflineMessage enableHistoricalMessaging enableOfflineMessaging hasPeerReceived messageType enableNotificationToChannelMembers lastUpdateTs".split(" "),BC="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),ye=function(_){if(typeof _=="string")return oa(_);if(Array.isArray(_)&&_.every(function(_r){return typeof _r=="string"}))return _.map(function(_r){return oa(_r)});if(!Il(_)){for(var e={},j=0;j<Or.length;j++){var Vt=Or[j];Vt in _&&(e[Vt]=_[Vt])}if(0<Object.keys(e).length)return e;if(5>Object.keys(_).length){for(j=0,_=Object.entries(_);j<_.length;j++){var zt=ra(_[j],2);Vt=zt[0],zt=zt[1],il.includes(Vt)?e[Vt]="[Hidden Info]":e[oa(Vt)]=typeof zt=="string"?oa(zt):"[Sensitive Info]"}return e}return"[Sensitive Info]"}return _},Pr=function(_){return X(_)==="object"?yd(_)?Vm(fe(_,5),il,Nr):_.constructor&&_.constructor.name:_},Qr=function(_,e){return _ instanceof Error?_.message:typeof _!="string"?JSON.stringify(Vm(fe(_,5),il,Nr)):(e=e.map(function(j){return j instanceof Error?j.message:X(j)==="object"?Gr(Array.isArray(j)?j.map(Pr):Pr(j)):j}),Nm.apply(void 0,[_.replace(/%[%Oo]/g,function(j){return j==="%%"?"%":j==="%o"||j==="%O"?"%s":j})].concat(G(e))))},CC=1,Rr=function(_,e,j){var Vt=Hr(_);return Vt.enabled=!0,Vt.log=j,Vt.useColors=!1,function(zt){for(var _r=arguments.length,_o=Array(1<_r?_r-1:0),ga=1;ga<_r;ga++)_o[ga-1]=arguments[ga];if(e.enableLogUpload){_r=Cg(zt);var _a=Qr(_r,_o);Mr.upload({log_item_id:"".concat(CC++),log_level:_,payload_str:"[".concat(sC(),"] ").concat(_," - ").concat(256<_a.length?_a.slice(0,256):_a)})}switch(_r=function(_l){var _d=_a||Qr(Cg(zt),_o),_f=Nc.LOG_HANDLER;typeof _f=="function"&&_f({level:_l,message:_d}),Vt(_d)},_){case"RTM:INFO":e.logFilter.info&&_r("log");break;case"RTM:WARN":e.logFilter.warn&&_r("warning");break;case"RTM:ERROR":e.logFilter.error&&_r("error");break;case"RTM:TRACK":e.logFilter.track&&_r("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":e.logFilter.debug&&_r("debug");break;case"RTM:DEBUG":e.logFilter.debug&&_r("debug")}}},jl,Sr=function(_){return function(e){var j=jl===1||_===void 0?"":"Ins#".concat(_," ");return"".concat(j).concat(e)}},kl=function(_,e,j){var Vt=Sr(jl);return Rr("RTM:".concat(e),j,function(zt){return _(Vt(zt))})},tb=function(){return function(_){function e(Vt,zt){var _r=2<arguments.length&&arguments[2]!==void 0&&arguments[2];W(this,e);var _o=j.call(this);if(m(n(_o),"logError",void 0),m(n(_o),"invokeTracker",void 0),m(n(_o),"resultTracker",void 0),m(n(_o),"errorTracker",void 0),m(n(_o),"eventTracker",void 0),m(n(_o),"info",void 0),m(n(_o),"warn",void 0),m(n(_o),"log",void 0),m(n(_o),"genLogger",void 0),m(n(_o),"loggerId",void 0),m(n(_o),"logger",void 0),m(n(_o),"name",void 0),_o.logger=Vt,_o.name=zt,_o.loggerId=Vt.loggerId,_o.info=Vt.info,_o.warn=Vt.warn,_o.logError=Vt.logError,_o.genLogger=Vt.genLogger,_o.log=Vt.genLogger("RTM:DEBUG","<".concat(zt,"> ")),_o.invokeTracker=Vt.genTracker("Invoke"),_o.eventTracker=Vt.genTracker("Event"),_o.resultTracker=Vt.genTracker("Result"),_o.errorTracker=Vt.genTracker("Error"),_r){var ga=_o.emit.bind(n(_o));_o.emit=function(){for(var _a=arguments.length,_l=Array(_a),_d=0;_d<_a;_d++)_l[_d]=arguments[_d];_a=_l[0],_d=_l.slice(1);var _f=BC.includes(_a);_o.eventTracker.apply(_o,["%s: ".concat(0<_d.length?"%s emitted with args: ".concat(_d.map(function(){return"%o"})):"%s emitted"),zt,_a].concat(G(_f?_d.map(ye):_d)));try{ga.apply(void 0,_l)}catch(_m){_o.logError("Caught in the callback function of the event %s",_a,_m)}}}return _o}la(e,_);var j=ma(e);return e}(ea)},DC=function(_){return kl(console.log.bind(console),"INFO",_)},EC=function(_){return kl(console.warn.bind(console),"WARN",_)},FC=function(_){return kl(console.error.bind(console),"ERROR",_)},Tr=function(_,e){return function(j){var Vt=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",zt=Sr(_),_r=console.debug.bind(console),_o=Rr(j,e,function(ga){return _r(zt(ga))});return function(ga){for(var _a=arguments.length,_l=Array(1<_a?_a-1:0),_d=1;_d<_a;_d++)_l[_d-1]=arguments[_d];return _o.apply(void 0,[Vt+ga].concat(_l))}}},GC=function(_,e){return function(j){return Tr(_,e)("RTM:TRACK","[".concat(j,"] "))}},Li=t.URI,eu=Oh,HC=ff(VB,["Wrapper"]),$m=Gk(HC,"URI"),Ur=function(_,e){var j=-1,Vt=_.length,zt=Vt-1;for(e=e===void 0?Vt:e;++j<e;){var _r=_[Vt=nr(j,zt)];_[Vt]=_[j],_[j]=_r}return _.length=e,_},IC=function(_){return Ur(Xh(_))},JC=function(_){return Ur(Ni(_))},$e=function(_){return(Va(_)?IC:JC)(_)},af={0:9591,1:9593},$d=function(_){return"https://".concat(_,"/api/v1")},KC=bb.apply(void 0,G($e(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map($d)))),LC=bb.apply(void 0,G($e(["ap-web-1.agora.io","ap-web-2.agora.io"].map($d)))),MC=bb.apply(void 0,G($e(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map($d)))),NC=bb.apply(void 0,G($e(["ap-web-3.agora.io","ap-web-4.agora.io"].map($d)))),ll=Ph(),ml=function(_){function e(Vt,zt,_r,_o,ga,_a){W(this,e);var _l=j.call(this,ga,Ai("Socket-",ga.loggerId));if(m(n(_l),"isActiveClose",!1),m(n(_l),"loggedIn",!1),m(n(_l),"useNewDomain",void 0),m(n(_l),"receivedPacket",new Pa),m(n(_l),"open$",void 0),m(n(_l),"input$",new Pa),m(n(_l),"userJoin$",new Pa),m(n(_l),"attemptsSinceLastError",0),m(n(_l),"message$",new Pa),m(n(_l),"socket$",void 0),m(n(_l),"toClose",new Pa),m(n(_l),"toReconnect",new Pa),m(n(_l),"sendLogger",void 0),m(n(_l),"receiveLogger",void 0),m(n(_l),"ip",void 0),m(n(_l),"env",void 0),m(n(_l),"ticket",void 0),m(n(_l),"context",void 0),m(n(_l),"getDomain",function(){return an(_l.ip,_l.useNewDomain)}),m(n(_l),"socketReconnector",function(_m){var tE=function(rE){return _l.attemptsSinceLastError+=1,_l.warn("The %s of Env %d reconnecting %s",_l.name,_l.env,rE.message),Bc(3e3)};return _m.pipe(Ga(function(rE){return _l.log("socket connection closed"),_l.loggedIn=!1,2<=_l.attemptsSinceLastError?(_l.warn("socket connection failure"),_l.emit("connectionFailure"),_l.close(),Z(rE)):_l.isActiveClose?vb:(_l.emit("reconnect"),_l.useNewDomain=!_l.useNewDomain,Z(rE))}),oe(function(rE){return rE.pipe(Cc(tE))}))}),_l.ip=Vt,_l.env=zt,_l.ticket=_r,_l.context=_o,_l.useNewDomain=_a??.5<=Math.random(),_l.sendLogger=_l.genLogger("RTM:MSG:SEND"),_l.receiveLogger=_l.genLogger("RTM:MSG:RECV"),zt!==0&&zt!==1)throw new ll({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});if(!Gm(Vt))throw new ll({IP_NOT_VALID:"The ip from ap is not valid"});var _d=af[zt];_l.log("Opening websocket address %s for the Env %d",_l.ip,_l.env);var _f=Xb(_l.input$,_l.userJoin$.pipe(Rt(2)),_l.message$).pipe(ba(function(_m){return Oh.encode(_m).finish()}));return Vt=Xb(St("",{protocols:[],makeWebSocket:function(){if(_l.context.config.enableCloudProxy){if(_l.context.cloudProxyServers.length===0)throw _l.logError("No cloud proxy server to connect"),new da;var _m="wss://".concat(an(bn(_l.context.cloudProxyServers),!1),"/");_m=we(_m,"sid",_l.context.sid),_m=we(_m,"remote_port",_d.toString()),_m=we(_m,"remote_ip",_l.ip),_m=we(_m,"token",_l.context.key),_m=new WebSocket(_m)}else _m=new WebSocket("wss://".concat(_l.getDomain(),":").concat(_d));return _m.binaryType="arraybuffer",_m}}),_l.toReconnect),_l.socket$=Ca(Vt,Tk.pipe(hb(15e3),Ga(function(_m){return Sa(_m)&&_l.warn("socket open timed out"),Z(_m)}))).pipe(ba(function(_m){if(_m instanceof Error)throw _l.warn("Env_%d: Force reconnect the socket",_l.env),_m;return _m(_f).pipe(ba(function(tE){return Oh.decode(new Uint8Array(tE))}))}),_l.socketReconnector),_l.open$=_l.socket$.pipe(ca(function(_m){_l.log("Websocket opened",_l.name),_m.subscribe(function(tE){var rE=tE.data;tE=Li[tE.uri].slice(0,-3),rE=$m[tE].decode(rE);var oE=HA({},Gk(rE,"toJSON"),function(lE,EE){return EE instanceof U?Km(EE):EE}),dE=!1;if((rE instanceof vr||rE instanceof ur)&&rE.instance.lessThanOrEqual(4294967295)&&(dE=!0),rE instanceof wr||rE instanceof xr){var nE=rE.instance,sE=rE.sequence;(rE.dialogue.lessThanOrEqual(4294967295)||nE.lessThanOrEqual(4294967295)||sE.lessThan(1))&&(dE=!0)}dE?_l.warn("Env_%d: Illegal %s, abandoned %o",_l.env,tE,oE):(tE!=="Pong"&&_l.receiveLogger("Env_%d: %s %o",_l.env,tE,oE),_l.receivedPacket.next([tE,rE]))},function(){})}),qf(void 0),ob(_l.toClose),pe()),_l}la(e,_);var j=ma(e);return Ha(e,[{key:"address",get:function(){return"".concat(this.ip,":").concat(af[this.env])}},{key:"sendPacket",value:function(Vt,zt){if(Vt!=="Ping"){var _r=uc(zt,function(_o){return _o instanceof U?Km(_o):_o});this.sendLogger("Env_%d: %s %o",this.env,Vt,_r)}zt=du(Vt,zt),Vt==="UserJoin"?this.userJoin$.next(zt):Vt==="Message"?this.message$.next(zt):this.input$.next(zt)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(Vt){var zt=this;return this.receivedPacket.pipe(ca(function(_r){var _o=ra(_r,2);_r=_o[0],_o=_o[1],_r==="UserResp"&&(zt.attemptsSinceLastError=0,zt.loggedIn=!0),_r==="UserDrop"&&zt.emit("socketUserDrop",_o)}),wb(function(_r){return ra(_r,1)[0]===Vt}),ba(function(_r){return ra(_r,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new ll({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),e}(tb());N({target:"String",proto:!0,forced:zr},{padStart:function(_){return XB(this,_,1<arguments.length?arguments[1]:void 0)}});var OC=function(_){var e=xf(Kg);_=Yt(_);for(var j=0;j<e.length;j++){var Vt=Kg[e[j]];if(Vt!=null&&Vt.AP_DOMAINS.includes(_)||Vt!=null&&Vt.AP_BACKUP_DOMAINS.includes(_)||Vt!=null&&Vt.PROXY_AP.includes(_))return[Vt.CODE]}return[F.CHINA,F.GLOBAL]},PC={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},Vr={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},QC=[100,101,102],Qh=/web-(\d)/,Wr=function(_){function e(Vt,zt){var _r=2<arguments.length&&arguments[2]!==void 0&&arguments[2];W(this,e);var _o=j.call(this,zt,"AccessPoint");return m(n(_o),"handleUniLbsError",function(ga,_a){var _l=ga;if(4<ga.toString().length){var _d=ga.toString().padStart(8,"0"),_f=parseInt(_d.slice(0,4),10);if(_d=parseInt(_d.slice(4,8),10),_f===201)_l=_d;else if(_f===101&&!QC.includes(_d))return Z(Error("service is currently unavailable"))}if(_f=_l.toString(),!Object.keys(Vr).includes(_f))return(ga=new da(["Login is rejected by the server. The response code is %d",ga],jg)).serverCode=_l,Z(ga);switch(_f=Vr[_f],_l=PC[_f],_f){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(_a=new Ye(_l,$q)).serverCode=ga,Z(_a);case"INVALID_USER_ID":return(_a=new Ye(_l,Jh)).serverCode=ga,Z(_a);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(_a=new Ye(_l,Kh)).serverCode=ga,Z(_a);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(_a=new Ye(_l,ar)).serverCode=ga,Z(_a);case"CANNOT_MEET_AREA_DEMAND":return(_a=OC(_a)).forEach(function(_m){return _o.failedAreas.add(_m)}),_o.failedAreas.size===(M===void 0?2:M.CODES.size)?((_a=new I(_l,jg)).serverCode=ga,Z(_a)):Z(Error("ap ".concat(_a.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(_a=new da(_l,jg)).serverCode=ga,Z(_a);default:return Z(Im("ApResErrType",_f))}}),m(n(_o),"getApEdgeInfo$",void 0),m(n(_o),"getApEdgeInfoEndFirst$",void 0),m(n(_o),"apFinish$",new Pa),m(n(_o),"retryCount",0),m(n(_o),"failedAreas",new Set),m(n(_o),"usedUrl",[]),m(n(_o),"newDomainUsed",!1),m(n(_o),"backupNewDomainUsed",!1),m(n(_o),"genUrl",function(){return M===void 0?mi.apply(void 0,G($e([KC,LC]))).pipe(ni(function(ga){return bb.apply(void 0,G(ga))})):bb.apply(void 0,G(M.AP_DOMAINS.slice(0,3).map($d)))}),m(n(_o),"genBackupUrl",function(){return M===void 0?mi.apply(void 0,G($e([MC,NC]))).pipe(ni(function(ga){return bb.apply(void 0,G(ga))})):bb.apply(void 0,G(M.AP_BACKUP_DOMAINS.slice(0,3).map($d)))}),m(n(_o),"getApUrl$",function(ga){var _a,_l;return _o.genUrl().pipe(wb(function(_d){return(!_o.newDomainUsed||!_d.includes("sd-rtn.com"))&&(_d.includes("sd-rtn.com")&&(_o.newDomainUsed=!0),!dl(_o.usedUrl,function(_f){var _m;return _f===((_m=_d.match(Qh))===null||_m===void 0?void 0:_m[1])}))}),ca(function(_d){var _f;M===void 0&&typeof(_d=(_f=_d.match(Qh))===null||_f===void 0?void 0:_f[1])=="string"&&_o.usedUrl.push(_d)}),Ka(ga?Math.max(Nc.RECONNECTING_AP_NUM,(_a=M==null?void 0:M.CODES.size)!==null&&_a!==void 0?_a:0):(_l=M==null?void 0:M.CODES.size)!==null&&_l!==void 0?_l:2),Dd(function(){return e.runOutOfUrlSymbol}),Ga(function(_d,_f){return _o.newDomainUsed=!1,_d===e.runOutOfUrlSymbol?(_o.usedUrl=[],_f):Z(_d)}))}),m(n(_o),"getBackupApUrl$",function(ga){var _a,_l;return _o.genBackupUrl().pipe(wb(function(_d){return(!_o.backupNewDomainUsed||!_d.includes("sd-rtn.com"))&&(_d.includes("sd-rtn.com")&&(_o.backupNewDomainUsed=!0),!dl(_o.usedUrl,function(_f){var _m;return _f===((_m=_d.match(Qh))===null||_m===void 0?void 0:_m[1])}))}),ca(function(_d){var _f;M===void 0&&typeof(_d=(_f=_d.match(Qh))===null||_f===void 0?void 0:_f[1])=="string"&&_o.usedUrl.push(_d)}),Ka(ga?Math.max(Nc.RECONNECTING_AP_NUM,(_a=M==null?void 0:M.CODES.size)!==null&&_a!==void 0?_a:0):(_l=M==null?void 0:M.CODES.size)!==null&&_l!==void 0?_l:2),Dd(function(){return e.runOutOfUrlSymbol}),Ga(function(_d,_f){return _o.backupNewDomainUsed=!1,_d===e.runOutOfUrlSymbol?(_o.usedUrl=[],_f):Z(_d)}))}),m(n(_o),"getProxyApUrl$",function(ga){var _a,_l;return bb.apply(void 0,G(((M==null?void 0:M.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map($d))).pipe(Ka(ga?Math.max(Nc.RECONNECTING_AP_NUM,(_a=M==null?void 0:M.CODES.size)!==null&&_a!==void 0?_a:0):(_l=M==null?void 0:M.CODES.size)!==null&&_l!==void 0?_l:2))}),m(n(_o),"context",void 0),m(n(_o),"fetchCloudProxy",function(ga,_a){var _l=Ai("AP-",_o.loggerId);_o.log("The AccessPoint requests %s(%s)",ga,_l);var _d=new AbortController;return _o.apFinish$.pipe(Ka(1)).subscribe(function(){return _d.abort()}),ad(J(w.mark(function _f(){var _m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:return _m=Ag(0,Number.MAX_SAFE_INTEGER),_o.log("%s request opid: %d",_l,_m),tE.abrupt("return",te(ga,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:_o.context.sid,opid:_m,appid:_o.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:_a??_o.context.key,cname:_o.context.uid,uid:0,detail:ua({},M===void 0?{11:[F.CHINA,F.GLOBAL].join()}:{11:Array.from(M.CODES).map(function(rE){return rE===F.OVERSEA?"".concat(F.ASIA,",").concat(F.EUROPE,",").concat(F.AFRICA,",").concat(F.NORTH_AMERICA,",").concat(F.SOUTH_AMERICA,",").concat(F.OCEANIA):rE}).join(",")})}}]},signal:_d.signal}));case 3:case"end":return tE.stop()}},_f)}))).pipe(Ga(function(_f){return _f.name!=="AbortError"&&(_o.logError(_f),_o.warn("The AP server %s request failure",ga,_f)),vb}),cb(function(){var _f=J(w.mark(function _m(tE){var rE,oE,dE,nE,sE,lE,EE,wE,IE,_E,kE,ME,bE,LE,TE,OE,vE,NE,jE;return w.wrap(function(UE){for(;;)switch(UE.prev=UE.next){case 0:if(rE=tE.responseText,oE=JSON.parse(rE),_o.log("The %s response is %o",_l,oE),((dE=oE.response_body)===void 0||dE.length===0||dE.some(function(RE){var FE;return((FE=RE.buffer)===null||FE===void 0?void 0:FE.code)===void 0||RE.uri!==23}))&&Z(new da("cloud proxy response_body not valid",jg)),(nE=dE.filter(function(RE){return RE.buffer.code!==0})).length===0){UE.next=14;break}if((sE=nE.find(function(RE){return RE.buffer.flag===128}))===void 0){UE.next=12;break}return UE.abrupt("return",_o.handleUniLbsError(sE.buffer.code,ga));case 12:return _o.logError("cloud proxy error response"),UE.abrupt("return",_o.handleUniLbsError(nE[0].buffer.code,ga));case 14:for(lE=[],EE=0;EE<dE.length;EE++)if(((_E=dE[EE])==null||(wE=_E.buffer)===null||wE===void 0?void 0:wE.flag)===262144)(kE=_E.buffer)===null||kE===void 0||(ME=kE.edges_services)===null||ME===void 0||(bE=ME.forEach)===null||bE===void 0||bE.call(ME,function(RE){Gm(RE=RE.ip)&&_o.context.cloudProxyServers.indexOf(RE)===-1&&(_o.log("got cloud proxy server: %s",RE),_o.context.cloudProxyServers.push(RE))});else if((_E==null||(IE=_E.buffer)===null||IE===void 0?void 0:IE.flag)===128){for(vE=function(RE,FE){var VE=FE[RE];lE.some(function(BE){return BE.ip===VE.ip})||lE.push({ip:VE.ip,ticket:_E.buffer.cert})},NE=0,jE=_E.buffer.edges_services;NE<jE.length;NE++)vE(NE,jE);_o.context.rtmArea=(LE=(TE=_E.buffer)===null||TE===void 0||(OE=TE.detail)===null||OE===void 0?void 0:OE[9])!==null&&LE!==void 0?LE:""}return UE.abrupt("return",bb.apply(void 0,G(lE).concat([fg])));case 19:case"end":return UE.stop()}},_m)}));return function(_m){return _f.apply(this,arguments)}}()),Ga(function(_f){return sa(_f)?Z(_f):vb}),tg(),wb(function(_f){return _f!==void 0&&typeof _f.ip=="string"&&typeof _f.ticket=="string"}))}),m(n(_o),"fetchAp",function(ga,_a){var _l=Ai("AP-",_o.loggerId);_o.log("The AccessPoint requests %s(%s)",ga,_l);var _d=new AbortController;return _o.apFinish$.pipe(Ka(1)).subscribe(function(){return _d.abort()}),ad(J(w.mark(function _f(){var _m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:return _m=Ag(0,Number.MAX_SAFE_INTEGER),_o.log("%s request opid: %d",_l,_m),tE.abrupt("return",te(ga,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:_m,key:_a||_o.context.key,cname:_o.context.uid,detail:ua({},M===void 0?{11:[F.CHINA,F.GLOBAL].join()}:{11:Array.from(M.CODES).map(function(rE){return rE===F.OVERSEA?"".concat(F.ASIA,",").concat(F.EUROPE,",").concat(F.AFRICA,",").concat(F.NORTH_AMERICA,",").concat(F.SOUTH_AMERICA,",").concat(F.OCEANIA):rE}).join(",")}),uid:0,sid:_o.context.sid},signal:_d.signal}));case 3:case"end":return tE.stop()}},_f)}))).pipe(Ga(function(_f){return _f.name!=="AbortError"&&(_o.logError(_f),_o.warn("The AP server %s request failure",ga,_f)),vb}),cb(function(){var _f=J(w.mark(function _m(tE){var rE,oE,dE,nE,sE,lE,EE;return w.wrap(function(wE){for(;;)switch(wE.prev=wE.next){case 0:if(rE=tE.responseText,oE=JSON.parse(rE),_o.log("The %s response is %o",_l,oE),nE=(dE=oE).code,sE=dE.addresses,lE=dE.detail,nE===0){wE.next=6;break}return wE.abrupt("return",_o.handleUniLbsError(nE,ga));case 6:if((EE=sE).length!==0){wE.next=11;break}return wE.abrupt("return",Z(Error("No available edge address to connect")));case 11:return _o.context.rtmArea=lE==null?void 0:lE[9],wE.abrupt("return",bb.apply(void 0,G(EE).concat([fg])));case 13:case"end":return wE.stop()}},_m)}));return function(_m){return _f.apply(this,arguments)}}()),tg(),Ga(function(_f){return sa(_f)?Z(_f):vb}),wb(function(_f){return _f!==void 0&&typeof _f.ip=="string"&&typeof _f.ticket=="string"}))}),_o.context=Vt,_o.getApEdgeInfoEndFirst$=function(){var ga=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return Bc(0,ga||_r?Nc.RECONNECTING_AP_INTERVAL:2e3).pipe(Ka(1),ca(function(){_o.retryCount+=1}),cb(function(){return _o.context.config.enableCloudProxy?_o.getProxyApUrl$(ga||_r):(4<=_o.retryCount&&(_o.retryCount=0),3>=_o.retryCount?_o.getApUrl$(ga||_r):_o.getBackupApUrl$(ga||_r))}),cb(function(_a){return _o.context.config.enableCloudProxy?_o.fetchCloudProxy(_a):_o.fetchAp(_a)}),Ga(function(_a){return _a instanceof pb&&_o.warn("AP request timeout"),Z(_a)}),om(function(_a){return _a.ip}),ob(_o.apFinish$))},_o.getApEdgeInfo$=function(ga){return Bc(0,ga||_r?Nc.RECONNECTING_AP_INTERVAL:2e3).pipe(Ka(8),ca(function(){_o.retryCount+=1}),cb(function(){return _o.context.config.enableCloudProxy?_o.getProxyApUrl$(ga||_r):3>=_o.retryCount?_o.getApUrl$(ga||_r):_o.getBackupApUrl$(ga||_r)}),cb(function(_a){return(_o.context.config.enableCloudProxy?_o.fetchCloudProxy(_a):_o.fetchAp(_a)).pipe()}),Ga(function(_a){return _a instanceof pb&&_o.warn("AP request timeout"),Z(_a)}),om(function(_a){return _a.ip}),ob(_o.apFinish$))},_o}la(e,_);var j=ma(e);return Ha(e,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),e}(tb());m(Wr,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var Xr=Ph(),Yr=function(_){function e(Vt,zt,_r){W(this,e);var _o=j.call(this,zt,"Connection");m(n(_o),"apClient",void 0),m(n(_o),"lastOpenSockets",[new qe(1),new qe(1)]),m(n(_o),"curOpenSockets",[void 0,void 0]),m(n(_o),"ipIterator",0),m(n(_o),"firstEnv",.5<=Math.random()?1:0),m(n(_o),"firstSocketOpener",void 0),m(n(_o),"secondSocketOpener",void 0),m(n(_o),"firstOpenKeeperSubject",new Pa),m(n(_o),"secondOpenKeeperSubject",new Pa),m(n(_o),"edgeInfoReplayed",void 0),m(n(_o),"firstEnvOpenSocket",void 0),m(n(_o),"firstOpenKeeperSub",void 0),m(n(_o),"secondOpenKeeperSub",void 0),m(n(_o),"context",void 0),m(n(_o),"logger",void 0),_o.context=Vt,_o.logger=zt,_o.apClient=new Wr(_o.context,zt),_o.apClient.apFinish$.subscribe(function(){_o.log("Ap client fetch finished")});var ga,_a=[];return _o.edgeInfoReplayed=_o.apClient.getApEdgeInfo$(_r).pipe(oe(function(_l){return _l.pipe(ca(function(_d){if(sa(_d))throw _d}),cd(_r?Zd.getParameter("RECONNECTING_AP_INTERVAL"):900),ob(Bc(2e4)))}),wb(function(_l){return!dl(_a,_l)}),Dd(function(){return new Xr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),ca(function(_l){_a.push(_l),_o.log("An edge info got %o",_l)}),ca({error:function(_l){_o.emit("connectionInitFailure",_l)}}),wg(function(){_o.apClient.clearUp()}),sm()),_o.firstEnvOpenSocket=_o.edgeInfoReplayed.pipe(cb(function(_l){if(_l===void 0)return Z(Error("Invalid edge info"));var _d=new ml(_l.ip,_o.firstEnv,_l.ticket,_o.context,zt,ga);return _o.firstEnv=_o.firstEnv===1?0:1,_d.on("connectionFailure",function(){return _o.onSocketConnectionFailure(_d)}),ga=!_d.useNewDomain,_d.open$.pipe(qf(_d))}),ca(function(_l){_o.log("The websocket of ENV_%d opened to %s:%d",_l.env,_l.ip,af[_l.env]),_o.curOpenSockets[_l.env]=_l,_o.lastOpenSockets[_l.env].next(_l),_o.firstEnv=_l.env,_o.openSecondSocket(_l.env,_l.ip,_l.useNewDomain)}),Ka(1),pe()),_o.firstSocketOpener=_o.firstEnvOpenSocket.pipe(cb(function(_l){return _l.open$.pipe(ca(function(){_o.log("The websocket of first ENV_%d re-opened to %s:%d",_l.env,_l.ip,af[_l.env]),_o.curOpenSockets[_l.env]=_l,_o.lastOpenSockets[_l.env].next(_l)}))})),Vt=_o.firstOpenKeeperSubject.pipe(Cc(Yc)),_o.firstOpenKeeperSub=Vt.subscribe({error:_o.logError}),_o}la(e,_);var j=ma(e);return Ha(e,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(Vt,zt){if(![0,1].includes(Vt))throw new Fa({INVALID_ENV:"The env argument is not 0 or 1"});var _r=Vt===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var _o=this.curOpenSockets[Vt];this.curOpenSockets[Vt]=void 0,_o&&(_o.isActiveClose=!0,setTimeout(function(){_o.close()},zt)),_r!==void 0&&setTimeout(function(){_r==null||_r.unsubscribe()},zt)}},{key:"waitClosing",value:function(Vt){var zt=this;return Vt.isActiveClose=!0,Vt.open$.pipe(tt(),Ga(function(_r){return _r.message===mr.normalClosureMessage?vb:Z(_r)}),hb(5e3),Ga(function(_r){return _r instanceof pb?(zt.warn("Force closing the ENV_%d connection",Vt.env),vb):Z(_r)}))}},{key:"onSocketConnectionFailure",value:function(Vt){var zt=[0,1].filter(function(_r){return _r!==Vt.env})[0];(zt=this.curOpenSockets[zt])&&zt.loggedIn?this.reopenSocketWithApRequest(Vt.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(Vt,zt,_r){var _o=this,ga=Vt===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(rm(function(_a,_l){return[].concat(G(_a),[_l])},[]),ba(function(_a){return kr(_a,function(_l){return Jm(zt,_l.ip)}).slice(-1)[0]}),Ka(1),cb(function(_a){if(_a===void 0)return Z(Error("Invalid edge info"));var _l=new ml(_a.ip,ga,_a.ticket,_o.context,_o.logger,_r);return _l.on("connectionFailure",function(){return _o.onSocketConnectionFailure(_l)}),_l.open$.pipe(ca(function(){_o.lastOpenSockets[ga].next(_l),_o.curOpenSockets[ga]=_l}))}),pe()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Cc(Yc)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(Vt){var zt=this,_r=[0,1].filter(function(_a){return _a!==Vt})[0];if((_r=this.curOpenSockets[_r])!==void 0){var _o,ga=_r.ip;_r=this.apClient.getApEdgeInfoEndFirst$(!0).pipe(Dd(function(){return new Xr({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),oe(function(_a){return _a.pipe(ca(function(_l){if(_l.code===Kh)zt.emit("tokenExpired"),zt.apClient.apFinish$.next(void 0);else if(sa(_l))throw _l}),cd(Zd.getParameter("RECONNECTING_AP_INTERVAL")),ob(Bc(15e3)))}),ca(function(_a){zt.log("An edge info got %o",_a)}),wg(function(){zt.apClient.clearUp()})).pipe(rm(function(_a,_l){return[].concat(G(_a),[_l])},[]),ba(function(_a){return(_a=kr(_a,function(_l){return Jm(ga,_l.ip)})).length-1>=zt.ipIterator?_a.slice(-zt.ipIterator++-1)[0]:(zt.ipIterator=0,_a.slice(-1)[0])}),Dd(),cb(function(_a){if(_a===void 0)return Z(Error("Invalid edge info"));var _l=new ml(_a.ip,Vt,_a.ticket,zt.context,zt.logger,_o);return _l.on("connectionFailure",function(){return zt.onSocketConnectionFailure(_l)}),_o=!_l.useNewDomain,_l.open$.pipe(qf(_l))}),ca(function(_a){zt.log("The websocket of ENV_%d re-opened to %s:%d using ap",_a.env,_a.ip,af[_a.env]),zt.curOpenSockets[Vt]=_a,zt.lastOpenSockets[Vt].next(_a)}),cb(function(_a){return _a.open$.pipe(ca(function(){zt.log("The websocket of ENV_%d re-opened to %s:%d",_a.env,_a.ip,af[_a.env]),zt.curOpenSockets[Vt]=_a,zt.lastOpenSockets[Vt].next(_a)}))}),pe()),Vt===this.firstEnv?this.firstOpenKeeperSubject.next(_r):this.secondOpenKeeperSubject.next(_r)}}}]),e}(tb()),Xc=fc.Writer,na=fc.util,zc=fc.roots.default||(fc.roots.default={}),RC=zc.Session=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.appId="",_.prototype.ver="",_.prototype.buildno=0,_.prototype.installId="",_.prototype.os=0,_.prototype.did="",_.prototype.index=null,_.prototype.token="",_.prototype.version=0,_.prototype.subVersion=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.appId!=null&&Object.hasOwnProperty.call(e,"appId")&&j.uint32(42).string(e.appId),e.ver!=null&&Object.hasOwnProperty.call(e,"ver")&&j.uint32(50).string(e.ver),e.buildno!=null&&Object.hasOwnProperty.call(e,"buildno")&&j.uint32(56).int32(e.buildno),e.installId!=null&&Object.hasOwnProperty.call(e,"installId")&&j.uint32(66).string(e.installId),e.os!=null&&Object.hasOwnProperty.call(e,"os")&&j.uint32(128).int32(e.os),e.did!=null&&Object.hasOwnProperty.call(e,"did")&&j.uint32(138).string(e.did),e.index!=null&&Object.hasOwnProperty.call(e,"index")&&zc.Session.CommonIndex.encode(e.index,j.uint32(162).fork()).ldelim(),e.token!=null&&Object.hasOwnProperty.call(e,"token")&&j.uint32(170).string(e.token),e.version!=null&&Object.hasOwnProperty.call(e,"version")&&j.uint32(176).int32(e.version),e.subVersion!=null&&Object.hasOwnProperty.call(e,"subVersion")&&j.uint32(184).int32(e.subVersion),j},_.CommonIndex=function(){function e(j){if(j)for(var Vt=Object.keys(j),zt=0;zt<Vt.length;++zt)j[Vt[zt]]!=null&&(this[Vt[zt]]=j[Vt[zt]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(j,Vt){return Vt||(Vt=Xc.create()),j.index1!=null&&Object.hasOwnProperty.call(j,"index1")&&Vt.uint32(10).string(j.index1),j.index2!=null&&Object.hasOwnProperty.call(j,"index2")&&Vt.uint32(18).string(j.index2),j.index3!=null&&Object.hasOwnProperty.call(j,"index3")&&Vt.uint32(26).string(j.index3),Vt},e}(),_}(),SC=zc.Link=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.ec=0,_.prototype.sc=0,_.prototype.destServerIp="",_.prototype.ackedServerIp="",_.prototype.responseTime=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.ec!=null&&Object.hasOwnProperty.call(e,"ec")&&j.uint32(40).int32(e.ec),e.sc!=null&&Object.hasOwnProperty.call(e,"sc")&&j.uint32(48).int32(e.sc),e.destServerIp!=null&&Object.hasOwnProperty.call(e,"destServerIp")&&j.uint32(58).string(e.destServerIp),e.ackedServerIp!=null&&Object.hasOwnProperty.call(e,"ackedServerIp")&&j.uint32(66).string(e.ackedServerIp),e.responseTime!=null&&Object.hasOwnProperty.call(e,"responseTime")&&j.uint32(72).int32(e.responseTime),j},_}(),TC=zc.Logout=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),j},_}(),UC=zc.KickedOff=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.linkId=0,_.prototype.code=0,_.prototype.server="",_.prototype.serverCode=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.linkId!=null&&Object.hasOwnProperty.call(e,"linkId")&&j.uint32(48).int32(e.linkId),e.code!=null&&Object.hasOwnProperty.call(e,"code")&&j.uint32(56).int32(e.code),e.server!=null&&Object.hasOwnProperty.call(e,"server")&&j.uint32(66).string(e.server),e.serverCode!=null&&Object.hasOwnProperty.call(e,"serverCode")&&j.uint32(72).int32(e.serverCode),j},_}(),VC=zc.ChnJoin=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.cname="",_.prototype.errCode=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&j.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&j.uint32(56).int32(e.errCode),j},_}(),WC=zc.ChnJoinRes=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.cname="",_.prototype.errCode=0,_.prototype.serverErrCode=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&j.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&j.uint32(56).int32(e.errCode),e.serverErrCode!=null&&Object.hasOwnProperty.call(e,"serverErrCode")&&j.uint32(64).int32(e.serverErrCode),j},_}(),XC=zc.ChnLeave=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.cname="",_.prototype.errCode=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.cname!=null&&Object.hasOwnProperty.call(e,"cname")&&j.uint32(50).string(e.cname),e.errCode!=null&&Object.hasOwnProperty.call(e,"errCode")&&j.uint32(56).int32(e.errCode),j},_}(),YC=zc.ConnectionStateChange=function(){function _(e){if(e)for(var j=Object.keys(e),Vt=0;Vt<j.length;++Vt)e[j[Vt]]!=null&&(this[j[Vt]]=e[j[Vt]])}return _.prototype.sid="",_.prototype.userId="",_.prototype.lts=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.elapse=na.Long?na.Long.fromBits(0,0,!1):0,_.prototype.oldState=0,_.prototype.newState=0,_.prototype.reason=0,_.prototype.reconnId=0,_.encode=function(e,j){return j||(j=Xc.create()),e.sid!=null&&Object.hasOwnProperty.call(e,"sid")&&j.uint32(10).string(e.sid),e.userId!=null&&Object.hasOwnProperty.call(e,"userId")&&j.uint32(18).string(e.userId),e.lts!=null&&Object.hasOwnProperty.call(e,"lts")&&j.uint32(24).int64(e.lts),e.elapse!=null&&Object.hasOwnProperty.call(e,"elapse")&&j.uint32(32).int64(e.elapse),e.oldState!=null&&Object.hasOwnProperty.call(e,"oldState")&&j.uint32(40).int32(e.oldState),e.newState!=null&&Object.hasOwnProperty.call(e,"newState")&&j.uint32(48).int32(e.newState),e.reason!=null&&Object.hasOwnProperty.call(e,"reason")&&j.uint32(56).int32(e.reason),e.reconnId!=null&&Object.hasOwnProperty.call(e,"reconnId")&&j.uint32(64).int32(e.reconnId),j},_}(),fu=Object.freeze({__proto__:null,Session:RC,Link:SC,Logout:TC,KickedOff:UC,ChnJoin:VC,ChnJoinRes:WC,ChnLeave:XC,ConnectionStateChange:YC,default:zc}),gu=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191}}),ZC=function(_){function e(Vt,zt,_r){return W(this,e),m(n(_r=j.call(this,_r,"Context")),"_token",void 0),m(n(_r),"config",void 0),m(n(_r),"_uid",void 0),m(n(_r),"_sid",void 0),m(n(_r),"_area","CN"),m(n(_r),"appId",void 0),m(n(_r),"enableCloudProxy",!1),m(n(_r),"cloudProxyServers",[]),_r.appId=Vt,_r.config=zt,_r}la(e,_);var j=ma(e);return Ha(e,[{key:"token",set:function(Vt){this._token=typeof Vt=="string"&&Vt?Vt:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new Ia("Cannot get illegal uid")},set:function(Vt){if(this.log("The user ID is set to %s",oa(Vt)),!za(Vt))throw new Ia;this._uid=Vt}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new Ia("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new Ia("Cannot get illegal sid")},set:function(Vt){if(this.log("sid is set to %s",Vt),typeof Vt!="string"||!Vt)throw new Ia;this._sid=Vt}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new Ia("Cannot get illegal area")},set:function(Vt){this.log("area is set to %s",Vt),typeof Vt=="string"&&Vt?this._area=Vt:this.warn("set area failed")}}]),e}(tb()),$C=!!Fc&&R(function(){Fc.prototype.finally.call({then:function(){}},function(){})});if(N({target:"Promise",proto:!0,real:!0,forced:$C},{finally:function(_){var e=kd(this,mc("Promise")),j=typeof _=="function";return this.then(j?function(Vt){return mj(e,_()).then(function(){return Vt})}:_,j?function(Vt){return mj(e,_()).then(function(){throw Vt})}:_)}}),typeof Fc=="function"){var Zr=mc("Promise").prototype.finally;Fc.prototype.finally!==Zr&&Ta(Fc.prototype,"finally",Zr,{unsafe:!0})}var aD=function(){var _=J(w.mark(function e(j){return w.wrap(function(Vt){for(;;)switch(Vt.prev=Vt.next){case 0:return Vt.t0=Uint8Array,Vt.next=3,crypto.subtle.digest("SHA-256",j);case 3:return Vt.t1=Vt.sent,Vt.abrupt("return",new Vt.t0(Vt.t1));case 5:case"end":return Vt.stop()}},e)}));return function(e){return _.apply(this,arguments)}}(),$r=function(_){return Array.from(_).map(function(e){return e.toString(16).padStart(2,"0")}).join("")},bD=function(_){if(typeof _!="string")throw new TypeError("Expected input to be a string");if(_.length%2!=0)throw new RangeError("Expected string to be an even number of characters");for(var e=new Uint8Array(_.length/2),j=0;j<_.length;j+=2)e[j/2]=parseInt(_.substring(j,j+2),16);return e},as=function(_){return btoa(String.fromCharCode.apply(String,G(_))).replace(/={1,2}$/,"")},bs=function(){var _=J(w.mark(function e(j){var Vt;return w.wrap(function(zt){for(;;)switch(zt.prev=zt.next){case 0:return zt.prev=0,zt.next=3,crypto.subtle.digest("SHA-1",j);case 3:Vt=zt.sent,zt.next=9;break;case 6:zt.prev=6,zt.t0=zt.catch(0),Vt=sha1.arrayBuffer(j);case 9:return zt.abrupt("return",as(new Uint8Array(Vt)));case 10:case"end":return zt.stop()}},e,null,[[0,6]])}));return function(e){return _.apply(this,arguments)}}(),cs=function(_,e,j,Vt){Vt[e]=!0,j.has(_)?j.get(_).add(e):j.set(_,new Set([e]))},cD=function(_){switch(_){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";default:return"application/octet-stream"}},ds=function(_){function e(Vt,zt,_r,_o){W(this,e);var ga=j.call(this,_r,"ChunkDownloadManager");if(m(n(ga),"abortController",new AbortController),m(n(ga),"downloadedSize",0),m(n(ga),"successCount",0),m(n(ga),"timer",void 0),m(n(ga),"chunks",[]),m(n(ga),"retUnit",void 0),m(n(ga),"singleThread",!1),m(n(ga),"initialized",!1),m(n(ga),"ee",void 0),m(n(ga),"chunkCount",void 0),m(n(ga),"aborted",!1),m(n(ga),"serverToIndices",new Map),m(n(ga),"backupToIndices",new Map),m(n(ga),"indexToBackupServers",[]),m(n(ga),"busyBackupServers",new Map),m(n(ga),"downloadingChunks",new Set),m(n(ga),"metaInfo",void 0),m(n(ga),"transHandler",void 0),ga.metaInfo=Vt,ga.transHandler=zt,ga.ee=_o===void 0?new ea:_o,_r=Vt.size,Vt=Vt.unit,_r===0)throw new Ia("size cannot be 0");return zt.cancelSignal!==void 0&&zt.cancelSignal.addEventListener("abort",function(){ga.abortController.abort()},{once:!0}),ga.abortController.signal.addEventListener("abort",function(){ga.aborted=!0},{once:!0}),ga.chunkCount=Math.ceil(_r/(32768*Vt)),ga}la(e,_);var j=ma(e);return Ha(e,[{key:"setInfoByResponse",value:function(Vt){var zt=this,_r=Vt.serverList,_o=Vt.backupList;if(Vt=Vt.unit,_r.length<this.chunkCount&&_o.length<this.chunkCount)throw new Ia("servers is not enough");this.updateProgress(0),this.initialized=!0;var ga=Array(this.chunkCount).fill(!1);if(_r.forEach(function(_a,_l){return _a.forEach(function(_d){return cs(_d,_l,zt.serverToIndices,ga)})}),_o.forEach(function(_a,_l){return _a.forEach(function(_d){return cs(_d,_l,zt.backupToIndices,ga)})}),ga.some(function(){return!1}))throw new da("Not enough servers to download",mg);this.indexToBackupServers=_o.map(function(_a){return new Set(_a)}),this.retUnit=Vt}},{key:"downloadChunks",value:function(){this.aborted?this.warn("downloadChunks after abort, ignored"):this.serverToIndices.size===1&&Array.from(this.serverToIndices.keys())[0]===0?this.serversDownload(this.backupToIndices):1<=this.serverToIndices.size?this.serversDownload(this.serverToIndices,!0):this.ee.emit("error",new da("not enough servers to download",mg))}},{key:"updateProgress",value:function(Vt){var zt=this,_r=this.downloadedSize+Vt;this.downloadedSize>this.metaInfo.size?(this.warn("Invalid download size, overflowed"),this.ee.emit("error",new Wc("Invalid download size",mg))):(this.downloadedSize=_r,this.timer!==void 0&&Vt!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&this.successCount!==this.chunkCount&&(this.timer=setTimeout(function(){zt.ee.emit("timedOut"),zt.abortController.abort()},12e4)),this.initialized&&Vt===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.size,currentSize:this.downloadedSize}))}},{key:"getPayload",value:function(){for(var Vt=0,zt=0,_r=this.chunks;zt<_r.length;zt++)Vt+=_r[zt].byteLength;if(Vt!==this.metaInfo.size)throw new Ia("invalid chunks total size");Vt=new Uint8Array(Vt),_r=zt=0;for(var _o=this.chunks;_r<_o.length;_r++){var ga=_o[_r];Vt.set(new Uint8Array(ga),zt),zt+=ga.byteLength}return zt=Array.from(Vt.subarray(0,4)).map(function(_a){return _a.toString(16)}).join("").toUpperCase(),Zt(Vt.buffer,cD(zt))}},{key:"getDownloadUrl",value:function(Vt){var zt=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat(Dg(Vt).split(".").join("-"),".edge.").concat(zt,":9601/api/v1/chuck/download")}},{key:"serversDownload",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga=this,_a=arguments;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return _o=1<_a.length&&_a[1]!==void 0&&_a[1],_l.next=3,Promise.all(Array.from(_r.entries()).map(function(_d){return _d=ra(_d,2),ga.postDownloadRequest(_d[0],Array.from(_d[1]),_o).catch(function(_f){_f.statusCode===404?(ga.ee.emit("notExist"),ga.abortController.abort()):_f.name!=="AbortError"&&(Sa(_f)?ga.singleThread?(ga.abortController.abort(),ga.ee.emit("timedOut")):(ga.warn("%d download timed out after %d, retrying use single thread",_f.index,ga.singleThread?6e4:3e4),ga.abortController.abort(),ga.singleThread=!0,ga.ee.emit("multiTimeOut")):(ga.ee.emit("error",_f),ga.abortController.abort()))})}));case 3:case"end":return _l.stop()}},zt)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"postDownloadRequest",value:function(){var Vt=J(w.mark(function zt(_r,_o,ga){var _a,_l,_d,_f,_m,tE,rE,oE,dE,nE=this;return w.wrap(function(sE){for(;;)switch(sE.prev=sE.next){case 0:if(dE=function(){return(dE=J(w.mark(function lE(EE){var wE,IE,_E,kE,ME,bE,LE,TE,OE;return w.wrap(function(vE){for(;;)switch(vE.prev=vE.next){case 0:if(vE.prev=0,EE!==void 0||_r!==0){vE.next=5;break}throw new Ia("Invalid serverIp");case 5:wE=EE===void 0?rE.getDownloadUrl(_r):EE;case 6:return rE.downloadingChunks.add(_a),vE.next=9,tE(wE);case 9:return IE=vE.sent,_E=IE.responseData,rE.downloadingChunks.delete(_a),vE.abrupt("return",_E);case 15:if(vE.prev=15,vE.t0=vE.catch(0),rE.downloadingChunks.delete(_a),_o.unshift(_a),rE.metaInfo.useNewDomain=!1,vE.t0.name!=="AbortError"){vE.next=22;break}throw vE.t0;case 22:if(!Sa(vE.t0)){vE.next=25;break}throw vE.t0.index=_a,vE.t0;case 25:if(kE=_f,_f+=1,!(2>kE)){vE.next=30;break}return vE.t0 instanceof Ia||rE.warn("%o, %d download failed, retrying",vE.t0,_a),vE.abrupt("return",oE());case 30:if(vE.t0.statusCode!==504){vE.next=34;break}throw(ME=new db("download server timed out",{originalError:vE.t0,serverCode:504})).index=_a,ME;case 34:if(!ga||kE!==2||_m[0]===0){vE.next=45;break}return vE.t0 instanceof Ia||rE.warn("%d download failed, using backup: %d, %o",_a,_m[0],vE.t0),vE.next=38,rE.busyBackupServers.get(_m[0]);case 38:return bE=oE(rE.getDownloadUrl(_m[0])),rE.busyBackupServers.set(_m[0],bE),vE.next=42,bE;case 42:return LE=vE.sent,rE.busyBackupServers.delete(_m[0]),vE.abrupt("return",LE);case 45:if(!(ga&&2<kE&&_m[1]!==void 0&&_m[1]!==0)){vE.next=56;break}return rE.warn("%d download failed, using backup 1: %d",_a,_m[1]),vE.next=49,rE.busyBackupServers.get(_m[1]);case 49:return TE=oE(rE.getDownloadUrl(_m[1])),rE.busyBackupServers.set(_m[1],TE),vE.next=53,TE;case 53:return OE=vE.sent,rE.busyBackupServers.delete(_m[1]),vE.abrupt("return",OE);case 56:throw vE.t0.index=_a,vE.t0;case 58:case"end":return vE.stop()}},lE,null,[[0,15]])}))).apply(this,arguments)},oE=function(lE){return dE.apply(this,arguments)},!this.aborted){sE.next=4;break}throw new Ia("download already aborted");case 4:if((_a=_o.shift())!==void 0){sE.next=8;break}return this.log("%s download finished",_r),sE.abrupt("return");case 8:if(!(this.singleThread&&0<this.downloadingChunks.size)){sE.next=10;break}return sE.abrupt("return");case 10:if(!this.downloadingChunks.has(_a)){sE.next=13;break}return this.log("%s already downloading, return",_a),sE.abrupt("return");case 13:if(this.chunks[_a]===void 0){sE.next=19;break}return this.successCount===this.chunkCount&&(this.log("chunks all download"),this.ee.emit("finished")),this.log("%s already downloaded, do next",_a),sE.next=18,this.postDownloadRequest(_r,_o,ga);case 18:return sE.abrupt("return");case 19:return _l=new FormData,_d={hash:hu(this.metaInfo.hashHexStr),unit:this.retUnit===void 0?this.metaInfo.unit:this.retUnit,instance:this.metaInfo.instance,loginOpt:this.metaInfo.loginOpt,ticket:this.metaInfo.ticket,index:_a},_l.append("parameter",JSON.stringify(_d)),_f=0,_m=Array.from(this.indexToBackupServers[_a]),tE=function(lE){return te(lE,{body:_l,signal:nE.abortController.signal,timeout:nE.singleThread?12e4:3e4},{useBinaryResponse:!0})},rE=this,sE.next=28,oE().then(function(lE){return nE.chunks[_a]!==void 0?nE.log("chunk %d download duplicated",_a):(nE.chunks[_a]=lE,nE.log("chunk %d downloaded",_a),nE.successCount+=1,nE.updateProgress(nE.chunks[_a].byteLength)),nE.successCount===nE.chunkCount&&(nE.log("chunks all download"),nE.ee.emit("finished")),nE.singleThread?(nE.downloadChunks(),Promise.resolve()):nE.postDownloadRequest(_r,_o,ga)});case 28:case"end":return sE.stop()}},zt,this)}));return function(zt,_r,_o){return Vt.apply(this,arguments)}}()}]),e}(tb()),es=function(_){function e(Vt,zt,_r,_o){W(this,e);var ga=j.call(this,_r,"ChunkUploadManager");if(m(n(ga),"chunkCount",0),m(n(ga),"chunks",[]),m(n(ga),"uploadedChunks",[]),m(n(ga),"totalFailures",0),m(n(ga),"timer",void 0),m(n(ga),"initState","uninitialized"),m(n(ga),"ee",void 0),m(n(ga),"unit",0),m(n(ga),"uploadedSize",0),m(n(ga),"singleThread",!1),m(n(ga),"abortController",new AbortController),m(n(ga),"servers",[]),m(n(ga),"aborted",!1),m(n(ga),"metaInfo",void 0),m(n(ga),"transHandler",void 0),ga.metaInfo=Vt,ga.transHandler=zt,ga.ee=_o===void 0?new ea:_o,Vt.file.length===0)throw new I("file not found or is empty",wf);return zt.cancelSignal!==void 0&&zt.cancelSignal.addEventListener("abort",function(){ga.abortController.abort()},{once:!0}),ga.abortController.signal.addEventListener("abort",function(){ga.aborted=!0},{once:!0}),ga}la(e,_);var j=ma(e);return Ha(e,[{key:"initChunks",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f=this;return w.wrap(function(_m){for(;;)switch(_m.prev=_m.next){case 0:if(this.initState!=="initialized"&&this.initState!=="initializing"){_m.next=2;break}throw new Ia("cannot re-initialize");case 2:for(this.initState="initializing",this.unit=_r,_o=this.sliceFile(_r,this.metaInfo.file),this.chunkCount=_o.length,ga=[],_a=function(tE,rE){var oE=(tE=ra(rE[tE],2))[0],dE=tE[1];tE=bs(dE).then(function(nE){_f.chunks[oE]={payload:dE,sha1:nE,uploadedTo:void 0,index:oE,processed:!1}}),ga.push(tE)},_l=0,_d=Array.from(_o.entries());_l<_d.length;_l++)_a(_l,_d);return _m.next=11,Promise.all(ga);case 11:this.updateProgress(0),this.initState="initialized",this.log("upload chunks initialized");case 14:case"end":return _m.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"uploadToServers",value:function(){var Vt=this;if(!this.aborted){for(var zt=this.chunks.filter(function(ga){return!ga.processed}),_r=function(ga){var _a=zt[ga],_l=Vt.servers.filter(function(_f){return!_f.isUploading}).sort(function(_f,_m){return _f.successCount-_m.successCount}).sort(function(_f,_m){return _f.failureCount-_m.failureCount})[0];if(_l===void 0||1<_l.failureCount)return Vt.log("Upload server not available, waiting"),Vt.ee.emit("serverUsedUp"),Om(1e3).then(function(){Vt.totalFailures>2*Vt.chunkCount&&Vt.ee.emit("error"),Vt.totalFailures+=1,_l!==void 0&&(_l.failureCount=0),Vt.uploadToServers()}).catch(function(){}),"break";_a.processed=!0,_l.isUploading=!0,Vt.log("uploading chunk %d to server %s",_a.index,Dg(_l.ip));var _d=Vt.getUploadUrl(_l.ip);return J(w.mark(function _f(){var _m;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:return tE.prev=0,tE.next=3,Vt.postChunk(_a.payload,_d,_a.index);case 3:_m=Vt.chunks.findIndex(function(rE){return rE===_a}),_a.uploadedTo=_l.ip,Vt.chunks.splice(_m,1),Vt.uploadedChunks.push(_a),_l.successCount+=1,_l.isUploading=!1,Vt.updateProgress(_a.payload.byteLength),Vt.log("upload chunk %d successfully",_a.index),tE.next=31;break;case 13:if(tE.prev=13,tE.t0=tE.catch(0),_l.isUploading=!1,_a.processed=!1,tE.t0.statusCode!==504&&!Sa(tE.t0)){tE.next=27;break}if(Vt.singleThread){tE.next=24;break}return Vt.warn("%d upload timed out after %d, retrying use single thread",_a.index,Vt.singleThread?12e4:3e4),Vt.abortController.abort(),Vt.singleThread=!0,Vt.ee.emit("multiTimeOut"),tE.abrupt("return");case 24:return Vt.ee.emit("timedOut"),Vt.abortController.abort(),tE.abrupt("return");case 27:return Vt.metaInfo.useNewDomain=!1,_l.failureCount+=1,tE.next=31,Om(1e3);case 31:Vt.uploadedChunks.length===Vt.chunkCount?(Vt.log("chunks uploaded"),Vt.ee.emit("finished")):(Vt.singleThread||Vt.chunks.filter(function(rE){return!rE.processed}).length===1)&&Vt.uploadToServers();case 32:case"end":return tE.stop()}},_f,null,[[0,13]])}))(),Vt.singleThread?"break":void 0},_o=0;_o<zt.length&&_r(_o)!=="break";_o++);zt.length===0&&this.uploadedChunks.length!==this.chunkCount&&this.log("%d chunks left uploading",this.chunkCount-this.uploadedChunks.length)}}},{key:"getUploadServerIPs",value:function(){var Vt=!0,zt=[],_r=G(this.uploadedChunks).sort(function(_a,_l){return _a.index-_l.index}),_o=0;for(_r=Array.from(_r.values());_o<_r.length;_o++){var ga=_r[_o].uploadedTo;if(ga===void 0){Vt=!1;break}zt.push(ga)}if(!Vt)throw new Ia("some chunks not uploaded, cannot get upload server ips");return zt}},{key:"addServers",value:function(Vt){var zt=this;Vt.forEach(function(_r){var _o=zt.servers.findIndex(function(ga){return ga.ip===_r});_o!==-1?zt.servers[_o].failureCount=0:(zt.log("server %s added",Dg(_r)),zt.servers.push({successCount:0,isUploading:!1,ip:_r,failureCount:0}))})}},{key:"updateProgress",value:function(Vt){var zt=this,_r=Vt!==void 0?this.uploadedSize+Vt:this.metaInfo.file.length;_r>this.metaInfo.file.length?(this.warn("Invalid upload size, overflowed"),this.ee.emit("error",new Wc("Invalid upload size",lg))):(this.uploadedSize=_r,this.timer!==void 0&&Vt!==0&&(clearTimeout(this.timer),this.timer=void 0),this.timer===void 0&&Vt!==void 0&&this.uploadedChunks.length!==this.chunkCount&&(this.timer=setTimeout(function(){zt.ee.emit("timedOut"),zt.abortController.abort()},12e4)),this.initState==="initialized"&&Vt===0||this.transHandler.onOperationProgress===void 0||this.transHandler.onOperationProgress({totalSize:this.metaInfo.file.length,currentSize:this.uploadedSize}))}},{key:"sliceFile",value:function(Vt,zt){var _r=0,_o=[],ga=zt.length;for(Vt*=32768;_r<ga;)_o.push(zt.slice(_r,_r+Vt)),_r+=Vt;return this.log("chunks split into %d",_o.length),_o}},{key:"postChunk",value:function(){var Vt=J(w.mark(function zt(_r,_o,ga){var _a,_l,_d,_f,_m,tE,rE,oE;return w.wrap(function(dE){for(;;)switch(dE.prev=dE.next){case 0:if(!this.aborted){dE.next=2;break}throw new Ia("upload already aborted");case 2:if(this.unit!==void 0){dE.next=4;break}throw new Ia("unit is undefined");case 4:return _a=this.metaInfo,_l=_a.ticket,_d=_a.instance,_f=_a.loginOpt,_m=_a.hashStr,dE.t0=ga,dE.t1=_m,dE.next=9,bs(_r);case 9:return dE.t2=dE.sent,dE.t3=this.unit,dE.t4=_l,dE.t5=_d,dE.t6=_f,tE={index:dE.t0,hash:dE.t1,sha1:dE.t2,unit:dE.t3,ticket:dE.t4,instance:dE.t5,loginOpt:dE.t6},(rE=new FormData).append("parameter",JSON.stringify(tE)),rE.append("payload",new Blob([_r])),dE.next=20,te(_o,{headers:{Accept:"application/json"},body:rE,timeout:this.singleThread?12e4:3e4,signal:this.abortController.signal});case 20:if(oE=dE.sent,oE.status===201){dE.next=24;break}throw new da("uploading chunk ".concat(ga," failed"));case 24:case"end":return dE.stop()}},zt,this)}));return function(zt,_r,_o){return Vt.apply(this,arguments)}}()},{key:"getUploadUrl",value:function(Vt){var zt=this.metaInfo.useNewDomain?"sd-rtn.com":"agora.io";return"https://".concat(Dg(Vt).split(".").join("-"),".edge.").concat(zt,":9601/api/v1/chuck/upload")}}]),e}(tb()),fs=function(_){function e(Vt){W(this,e);var zt=j.call(this,Vt,"MediaTaskManager");return m(n(zt),"isProcessing",!1),m(n(zt),"authInfo",void 0),m(n(zt),"taskFinishers",{}),m(n(zt),"mediaTasks",new Map),m(n(zt),"ongoingTask",void 0),zt.on("connectionStateChanged",function(_r){if(_r===S.ConnectionState.ABORTED||_r===S.ConnectionState.DISCONNECTED){zt.ongoingTask!==void 0&&zt.cancelTask(zt.ongoingTask),_r=0;for(var _o=Array.from(zt.mediaTasks.entries());_r<_o.length;_r++){var ga=ra(_o[_r],2)[1];zt.cancelTask(ga)}zt.mediaTasks.clear(),zt.taskFinishers={}}else _r===S.ConnectionState.RECONNECTING?zt.ongoingTask!==void 0&&zt.ongoingTask.manager.abortController.abort():_r===S.ConnectionState.CONNECTED&&zt.ongoingTask!==void 0&&zt.ongoingTask.manager.ee.emit("reconnected")}),zt}la(e,_);var j=ma(e);return Ha(e,[{key:"setAuthInfo",value:function(Vt){this.authInfo=Vt}},{key:"waitMediaTask",value:function(Vt){var zt=this;return new Promise(function(_r,_o){zt.taskFinishers[Vt]={resolve:_r,reject:_o},zt.isProcessing||zt.processMediaTask()}).finally(function(){zt.ongoingTask!==void 0&&zt.ongoingTask.manager.timer!==void 0&&clearTimeout(zt.ongoingTask.manager.timer),delete zt.taskFinishers[Vt],zt.mediaTasks.size!==0?zt.processMediaTask():zt.isProcessing=!1})}},{key:"addUploadTask",value:function(Vt,zt,_r,_o){var ga=Vt.file;if(Vt=Vt.hash,this.authInfo===void 0)throw new Ia("session not found");if(this.mediaTasks.size>=e.MAX_PENDING_TASK_COUNT-1)throw new ib("Upload media failed, exceed max pending jobs",xA);return _o=new es({hashStr:as(Vt),file:ga,ticket:this.authInfo.ticket,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),useNewDomain:this.authInfo.useNewDomain},_o,this.logger),ga=Ud(),this.mediaTasks.set(ga,{type:"UPLOAD",manager:_o,hash:Vt,setter:_r,fetcher:zt,taskId:ga}),ga}},{key:"addDownloadTask",value:function(Vt,zt,_r){var _o=Vt.hashHexStr,ga=Vt.size,_a=Vt.unit;if(Vt=Vt.zone,this.authInfo===void 0)throw new Ia("session not found");if(this.mediaTasks.size>=e.MAX_PENDING_TASK_COUNT-1)throw new ib("Download media failed, exceed max pending jobs",BA);return _r=new ds({hashHexStr:_o,ticket:this.authInfo.ticket,useNewDomain:this.authInfo.useNewDomain,instance:this.authInfo.instance.toString(),loginOpt:this.authInfo.loginOpt.toString(),size:ga,zone:Vt,unit:_a},_r,this.logger),_o=Ud(),this.mediaTasks.set(_o,{type:"DOWNLOAD",manager:_r,fetcher:zt,taskId:_o}),_o}},{key:"doDownloadTaskImpl",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE,oE=this,dE=arguments;return w.wrap(function(nE){for(;;)switch(nE.prev=nE.next){case 0:return ga=2<dE.length&&dE[2]!==void 0&&dE[2],_l=_a=_r.manager,ga&&(_a=new ds(_l.metaInfo,_l.transHandler,this.logger,_l.ee)),_d=_r.fetcher,nE.next=7,_d();case 7:if(_f=nE.sent,_m=_f.serverList,tE=_f.backupList,rE=_f.unit,!ga||rE===_l.retUnit){nE.next=13;break}throw new da("download unit is different, reject to continue",mg);case 13:ga&&(_r.manager=_a,_a.downloadedSize=_l.downloadedSize,_a.successCount=_l.successCount,_a.timer=_l.timer,_a.chunks=_l.chunks,_a.initialized=_l.initialized,_a.singleThread=_l.singleThread,_a.updateProgress(0)),_a.ee.once("reconnected",function(){_a.ee.removeAllListeners(),oE.doDownloadTaskImpl(_r,_o,!0).catch(function(sE){_o.reject(sE)})}),_a.ee.once("multiTimeOut",function(){_a.ee.removeAllListeners(),oE.doDownloadTaskImpl(_r,_o,!0).catch(function(sE){_o.reject(sE)})}),_a.ee.once("error",function(sE){_a.ee.removeAllListeners(),_o.reject(new da(["download file file, index %d",sE.index],{code:mg,originalError:sE}))}),_a.ee.once("notExist",function(){_a.abortController.abort(),_a.ee.removeAllListeners(),_o.reject(new da("download file not found",AA))}),_a.ee.once("timedOut",function(){_a.ee.removeAllListeners(),_a.abortController.abort(),_o.reject(new db("download timed out",zA))}),_a.transHandler.cancelSignal!==void 0&&_a.transHandler.cancelSignal.addEventListener("abort",function(){_o.reject(new hl("Downloading canceled",ir))},{once:!0}),_a.ee.once("finished",function(){_o.resolve({type:"DOWNLOAD",payload:_a.getPayload()})}),_a.setInfoByResponse({serverList:_m,backupList:tE,unit:rE}),_a.downloadChunks();case 23:case"end":return nE.stop()}},zt,this)}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"doDownloadTask",value:function(Vt,zt){var _r=this,_o=2<arguments.length&&arguments[2]!==void 0&&arguments[2],ga=Vt.taskId;return _o||(this.mediaTasks.delete(ga),this.ongoingTask=Vt),new Promise(function(_a,_l){_r.doDownloadTaskImpl(Vt,zt,_o).then(_a).catch(_l)})}},{key:"doUploadTaskImpl",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE,oE,dE=this,nE=arguments;return w.wrap(function(sE){for(;;)switch(sE.prev=sE.next){case 0:return ga=2<nE.length&&nE[2]!==void 0&&nE[2],_l=_a=_r.manager,ga&&(_a=new es(_l.metaInfo,_l.transHandler,this.logger,_l.ee)),_d=_r.fetcher,_f=new Pa,tE=new Promise(function(lE,EE){var wE=_d(),IE=wE.ret,_E=wE.err,kE=wE.timeout;wE.fin.pipe(ob(_f)).subscribe({next:function(ME){_o.resolve({type:"UPLOAD",retUnit:ME.unit,zone:ME.zone})},complete:function(){lE({hasExist:!0}),_f.next(),_f.complete()}}),IE.pipe(ob(_f),cb(function(){var ME=J(w.mark(function bE(LE){var TE,OE;return w.wrap(function(vE){for(;;)switch(vE.prev=vE.next){case 0:if(TE=LE.servers,OE=LE.unit,ga&&_l.unit!==OE?_o.reject(new da("upload unit is different, reject to continue",lg)):ga&&(_r.manager=_a,_a.chunkCount=_l.chunkCount,_a.chunks=_l.chunks,_a.totalFailures=_l.totalFailures,_a.uploadedChunks=_l.uploadedChunks,_a.timer=_l.timer,_a.initState=_l.initState,_a.unit=_l.unit,_a.uploadedSize=_l.uploadedSize,_a.singleThread=_l.singleThread,_a.updateProgress(0)),_a.addServers(TE),_a.initState!=="uninitialized"){vE.next=7;break}return _m=_a.initChunks(OE),vE.next=7,_m;case 7:case"end":return vE.stop()}},bE)}));return function(bE){return ME.apply(this,arguments)}}())).subscribe({complete:function(){return lE({hasExist:!1})},error:EE}),wE=function(ME){_a.initState!=="uninitialized"&&_m?lE(_m.then(function(){return{hasExist:!1}})):EE(ME)},_E.pipe(ob(_f)).subscribe({error:wE}),kE.pipe(ob(_f)).subscribe({error:wE})}),sE.next=9,tE;case 9:if(rE=sE.sent,!rE.hasExist){sE.next=15;break}return _a.updateProgress(),this.log("file already exists, skipping upload"),sE.abrupt("return");case 15:_f.next(),_f.complete(),this.log("chunks initialization promise resolved"),oE=gb(_a.ee,"serverUsedUp").pipe(Gt(function(){return _a.chunkCount!==_a.uploadedChunks.length}),Jt(5e3,void 0,{leading:!1}),pm(function(){return _d().ret})).subscribe(function(lE){_a.addServers(lE.servers)}),_a.ee.once("reconnected",function(){_a.ee.removeAllListeners(),dE.doUploadTask(_r,_o,!0).catch(function(lE){_o.reject(lE)})}),_a.ee.once("multiTimeOut",function(){_a.ee.removeAllListeners(),dE.doUploadTask(_r,_o,!0).catch(function(lE){_o.reject(lE)})}),_a.ee.once("timedOut",function(){oE.unsubscribe(),_a.ee.removeAllListeners(),_a.abortController.abort(),_o.reject(new db("upload timed out",Lh))}),_a.ee.once("error",function(lE){oE.unsubscribe(),_a.ee.removeAllListeners(),_a.abortController.abort(),_o.reject(lE||new da("upload error",lg))}),_a.transHandler.cancelSignal!==void 0&&_a.transHandler.cancelSignal.addEventListener("abort",function(){_o.reject(new hl("Uploading canceled",hr))},{once:!0}),_a.ee.once("finished",J(w.mark(function lE(){var EE,wE,IE;return w.wrap(function(_E){for(;;)switch(_E.prev=_E.next){case 0:return oE.unsubscribe(),_E.next=3,_r.setter(_a.unit,_a.getUploadServerIPs());case 3:EE=_E.sent,wE=EE.zone,IE=EE.unit,_a.ee.removeAllListeners(),_o.resolve({type:"UPLOAD",retUnit:IE,zone:wE});case 8:case"end":return _E.stop()}},lE)}))),_a.uploadToServers();case 26:case"end":return sE.stop()}},zt,this)}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"doUploadTask",value:function(Vt,zt){var _r=this,_o=2<arguments.length&&arguments[2]!==void 0&&arguments[2],ga=Vt.taskId;return _o||(this.mediaTasks.delete(ga),this.ongoingTask=Vt),new Promise(function(_a,_l){_r.doUploadTaskImpl(Vt,zt,_o).then(_a).catch(_l)})}},{key:"processMediaTask",value:function(){var Vt=J(w.mark(function zt(){var _r,_o,ga;return w.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(this.mediaTasks.size!==0){_a.next=2;break}throw Error("no upload tasks");case 2:if(this.isProcessing=!0,_r=this.mediaTasks.keys().next().value,(_o=this.taskFinishers[_r])!==void 0){_a.next=7;break}throw Error("top task not found");case 7:if((ga=this.mediaTasks.get(_r))!==void 0){_a.next=10;break}throw new Ia("task invalid");case 10:if(ga.type!=="UPLOAD"){_a.next=15;break}return _a.next=13,this.doUploadTask(ga,_o).catch(function(_l){ga.manager.ee.removeAllListeners(),_o.reject(_l)});case 13:_a.next=18;break;case 15:if(ga.type!=="DOWNLOAD"){_a.next=18;break}return _a.next=18,this.doDownloadTask(ga,_o).catch(function(_l){ga.manager.ee.removeAllListeners(),_o.reject(_l)});case 18:case"end":return _a.stop()}},zt,this)}));return function(){return Vt.apply(this,arguments)}}()},{key:"cancelTask",value:function(Vt){var zt=Vt.type==="DOWNLOAD"?ir:hr;Vt.manager.ee.removeAllListeners(),Vt.manager.abortController.abort(),this.taskFinishers[Vt.taskId]!==void 0&&this.taskFinishers[Vt.taskId].reject(new hl("User logged out or kicked off, media task canceled",zt))}}]),e}(tb());m(fs,"MAX_PENDING_TASK_COUNT",9),Oo("of",function(){for(var _=0,e=arguments.length,j=new(Ne(this))(e);e>_;)j[_]=arguments[_++];return j},Dj);var gs=1/0,dD=Math.max,ju=function(_,e,j){var Vt=Object(_);if(!Ed(_)){var zt=Te(e);_=Ad(_),e=function(_r){return zt(Vt[_r],_r,Vt)}}return-1<(e=function(_r,_o,ga){var _a=_r==null?0:_r.length;if(!_a)return-1;if(ga==null)ga=0;else{var _l=(ga=ga?(ga=gl(ga))===gs||ga===-gs?17976931348623157e292*(0>ga?-1:1):ga==ga?ga:0:ga===0?ga:0)%1;ga=ga==ga?_l?ga-_l:ga:0}return 0>ga&&(ga=dD(_a+ga,0)),Xp(_r,Te(_o),ga)}(_,e,j))?Vt[zt?_[e]:e]:void 0},iu=function(_,e){return _&&_.length?vk(_,void 0,typeof e=="function"?e:void 0):[]},hs=function(){function _(){W(this,_),m(this,"size",0),m(this,"fields",new Map)}return Ha(_,[{key:"define",value:function(e,j,Vt){if(this.size+=Vt,64<this.size)throw new RangeError("the struct over 64 bits is not supported");Mg(j={val:0,isNumber:j==="number",isBoolean:j==="boolean",oneof:j==="number"||j==="boolean"?void 0:j,len:Vt}),this.fields.set(e,j)}},{key:"set",value:function(e,j){if(!(e=this.fields.get(e)))throw Error("field not found");var Vt=e.oneof;if(!U.isLong(j)&&typeof j!="number")if(typeof j=="boolean")j=j?1:0;else{if(Vt===void 0)throw Error("invalid field type");if((j=Vt[j])===void 0)throw Error("field type not found")}Mg(e,j),e.val=j}},{key:"toNumber",value:function(){for(var e=0,j=0,Vt=0,zt=Array.from(this.fields);Vt<zt.length;Vt++){var _r=ra(zt[Vt],2)[1],_o=_r.len;(_r=_r.val)!==void 0&&(e+=U.fromValue(_r).shiftLeft(j).toNumber(),j+=_o)}return e}},{key:"toLong",value:function(){for(var e=U.fromNumber(0,!0),j=0,Vt=0,zt=Array.from(this.fields);Vt<zt.length;Vt++){var _r=ra(zt[Vt],2)[1],_o=_r.len;(_r=_r.val)!==void 0&&(e=U.fromValue(_r).shiftLeft(j).add(e),j+=_o)}return e}},{key:"assert",value:function(e,j){function Vt(_o){if(!U.isLong(_o)&&typeof _o!="number")if(typeof _o=="boolean")_o=_o?1:0;else{if(_r===void 0)throw Error("invalid field type");if((_o=_r[_o])===void 0)throw Error("field type not found")}return Mg(zt,_o),Lg(_o,zt.val)}var zt=this.fields.get(e);if(!zt)throw Error("field not found");var _r=zt.oneof;if(!Array.isArray(j))return Vt(j);if(j.length===1)return Vt(j[0]);if(j.every(function(_o){return typeof _o=="string"})&&_r!==void 0)return j.some(function(_o){return Vt(_o)});throw Error("invalid valueTypes")}},{key:"from",value:function(e){e=U.fromValue(e);for(var j=0,Vt=0,zt=Array.from(this.fields);Vt<zt.length;Vt++){var _r=ra(zt[Vt],2)[1],_o=_r.len,ga=U.fromNumber(Math.pow(2,_o)-1,!0).shiftLeft(j);Mg(_r,ga=e.and(ga).shiftRightUnsigned(j)),_r.val=ga,j+=_o}}},{key:"typeOf",value:function(e){if((e=this.fields.get(e))!==void 0){var j=e.oneof;if(e=e.val,j!==void 0){var Vt=0;for(j=Object.entries(j);Vt<j.length;Vt++){var zt=ra(j[Vt],2),_r=zt[0];if(Lg(e,zt[1]))return _r}}}throw new TypeError("can only get type of oneof type")}}]),_}(),is=function(_){function e(Vt){W(this,e);var zt=j.call(this);return zt.define("Rejoin","boolean",1),zt.define("Unused","number",31),zt.define("Platform","number",8),zt.define("Version","number",12),zt.define("Subversion","number",12),zt.set("Platform",7),zt.set("Version",4),zt.set("Subversion",203),zt.set("Rejoin",Vt),zt}la(e,_);var j=ma(e);return e}(hs),eD=ua(ua(ua(ua({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),{PeerImageMessage:6,ChannelImageMessage:7,VendorImageMessage:8}),{PeerFileMessage:15,ChannelFileMessage:16,VendorFileMessage:17}),js={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},fD=ua(ua({},eD),js),gD={Uncompressed:0,Zlib:1},ae=function(_){function e(Vt){W(this,e);var zt=j.call(this);if(zt.define("MessageType",fD,8),zt.define("BroadcastJumps","number",2),zt.define("ToCache","boolean",1),zt.define("FromCache","boolean",1),zt.define("CompressionMethod",gD,2),zt.define("IterationNumber","number",4),zt.define("BufferedMessage","boolean",1),zt.define("ToArchive","boolean",1),zt.define("FromArchive","boolean",1),typeof Vt=="number"||U.isLong(Vt))zt.from(Vt);else if(Vt!==void 0){var _r=0;for(Vt=Hg(Vt);_r<Vt.length;_r++){var _o=ra(Vt[_r],2);zt.set(_o[0],_o[1])}}return zt}la(e,_);var j=ma(e);return Ha(e,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(Vt){var zt=this;return Vt!==void 0?this.assert("MessageType",Vt):xf(js).some(function(_r){return zt.assert("MessageType",_r)})}},{key:"isFileMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","ChannelFileMessage","VendorFileMessage"])}},{key:"isImageMessage",value:function(){return this.assert("MessageType",["PeerImageMessage","ChannelImageMessage","VendorImageMessage"])}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerFileMessage","PeerTextMessage","PeerImageMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),e}(hs),hD=function(_){function e(Vt){return W(this,e),m(n(Vt=j.call(this,Vt,"ChatManager")),"dialogueLru",new Sx(void 0,{maxlen:1e4,ttl:1e4})),Vt}la(e,_);var j=ma(e);return Ha(e,[{key:"getChatInfo",value:function(Vt){var zt=this.dialogueLru.get(Vt);if(this.dialogueLru.prune(),zt){var _r=zt.dialogue,_o={dialogue:_r,sequence:zt=zt.sequence.add(1)};return this.dialogueLru.set(Vt,{dialogue:_r,sequence:zt}),_o}return _r={dialogue:Bg(),sequence:U.fromNumber(1,!0)},this.dialogueLru.set(Vt,_r),_r}}]),e}(tb()),v={};X(module)=="object"&&(module.exports=v),v.parse=function(_,e){var j,Vt=v.bin.readUshort,zt=v.bin.readUint,_r={};for(j=(_=new Uint8Array(_)).length-4;zt(_,j)!=101010256;)j--;var _o=Vt(_,j=j+4+4);Vt(_,j+=2),zt(_,j+=2),j=zt(_,j+=4);for(var ga=0;ga<_o;ga++){zt(_,j),j+=4,j+=4,j+=4,zt(_,j+=4);var _a=zt(_,j+=4),_l=zt(_,j+=4),_d=Vt(_,j+=4),_f=Vt(_,j+2),_m=Vt(_,j+4);j+=6;var tE=zt(_,j+=8);j+=4,j+=_d+_f+_m,v._readLocal(_,tE,_r,_a,_l,e)}return _r},v._readLocal=function(_,e,j,Vt,zt,_r){var _o=v.bin.readUshort,ga=v.bin.readUint;ga(_,e),_o(_,e+=4),_o(_,e+=2);var _a=_o(_,e+=2);ga(_,e+=2),ga(_,e+=4),ga=_o(_,e=e+4+8);var _l=_o(_,e+=2);if(e+=2,_o=v.bin.readUTF8(_,e,ga),e=e+ga+_l,_r)j[_o]={size:zt,csize:Vt};else if(_=new Uint8Array(_.buffer,e),_a==0)j[_o]=new Uint8Array(_.buffer.slice(e,e+Vt));else{if(_a!=8)throw"unknown compression method: "+_a;e=new Uint8Array(zt),v.inflateRaw(_,e),j[_o]=e}},v.inflateRaw=function(_,e){return v.F.inflate(_,e)},v.inflate=function(_,e){return _[0],_[1],v.inflateRaw(new Uint8Array(_.buffer,_.byteOffset+2,_.length-2),e)},v.deflate=function(_,e){e==null&&(e={level:6});var j=0,Vt=new Uint8Array(50+Math.floor(1.1*_.length));return Vt[j]=120,Vt[j+1]=156,j=v.F.deflateRaw(_,Vt,j+2,e.level),_=v.adler(_,0,_.length),Vt[j+0]=_>>>24&255,Vt[j+1]=_>>>16&255,Vt[j+2]=_>>>8&255,Vt[j+3]=_>>>0&255,new Uint8Array(Vt.buffer,0,j+4)},v.deflateRaw=function(_,e){e==null&&(e={level:6});var j=new Uint8Array(50+Math.floor(1.1*_.length)),Vt=v.F.deflateRaw(_,j,Vt,e.level);return new Uint8Array(j.buffer,0,Vt)},v.encode=function(_,e){e==null&&(e=!1);var j,Vt=0,zt=v.bin.writeUint,_r=v.bin.writeUshort,_o={};for(j in _){var ga=!v._noNeed(j)&&!e,_a=_[j],_l=v.crc.crc(_a,0,_a.length);_o[j]={cpr:ga,usize:_a.length,crc:_l,file:ga?v.deflateRaw(_a):_a}}for(j in _o)Vt+=_o[j].file.length+30+46+2*v.bin.sizeUTF8(j);for(j in _=new Uint8Array(Vt+22),e=0,_a=[],_o)_l=_o[j],_a.push(e),e=v._writeHeader(_,e,j,_l,0);for(j in Vt=0,ga=e,_o)_l=_o[j],_a.push(e),e=v._writeHeader(_,e,j,_l,1,_a[Vt++]);return _o=e-ga,zt(_,e,101010256),_r(_,e=e+4+4,Vt),_r(_,e+=2,Vt),zt(_,e+=2,_o),zt(_,e+4,ga),_.buffer},v._noNeed=function(_){return _=_.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(_)!=-1},v._writeHeader=function(_,e,j,Vt,zt,_r){var _o=v.bin.writeUint,ga=v.bin.writeUshort,_a=Vt.file;return _o(_,e,zt==0?67324752:33639248),e+=4,zt==1&&(e+=2),ga(_,e,20),ga(_,e+=2,0),ga(_,e+=2,Vt.cpr?8:0),_o(_,e+=2,0),_o(_,e+=4,Vt.crc),_o(_,e+=4,_a.length),_o(_,e+=4,Vt.usize),ga(_,e+=4,v.bin.sizeUTF8(j)),ga(_,e+=2,0),e+=2,zt==1&&(_o(_,e=e+2+2+6,_r),e+=4),e+=j=v.bin.writeUTF8(_,e,j),zt==0&&(_.set(_a,e),e+=_a.length),e},v.crc={table:function(){for(var _=new Uint32Array(256),e=0;256>e;e++){for(var j=e,Vt=0;8>Vt;Vt++)j=1&j?3988292384^j>>>1:j>>>1;_[e]=j}return _}(),update:function(_,e,j,Vt){for(var zt=0;zt<Vt;zt++)_=v.crc.table[255&(_^e[j+zt])]^_>>>8;return _},crc:function(_,e,j){return 4294967295^v.crc.update(4294967295,_,e,j)}},v.adler=function(_,e,j){var Vt=1,zt=0,_r=e;for(e+=j;_r<e;){for(j=Math.min(_r+5552,e);_r<j;)zt+=Vt+=_[_r++];Vt%=65521,zt%=65521}return zt<<16|Vt},v.bin={readUshort:function(_,e){return _[e]|_[e+1]<<8},writeUshort:function(_,e,j){_[e]=255&j,_[e+1]=j>>8&255},readUint:function(_,e){return 16777216*_[e+3]+(_[e+2]<<16|_[e+1]<<8|_[e])},writeUint:function(_,e,j){_[e]=255&j,_[e+1]=j>>8&255,_[e+2]=j>>16&255,_[e+3]=j>>24&255},readASCII:function(_,e,j){for(var Vt="",zt=0;zt<j;zt++)Vt+=String.fromCharCode(_[e+zt]);return Vt},writeASCII:function(_,e,j){for(var Vt=0;Vt<j.length;Vt++)_[e+Vt]=j.charCodeAt(Vt)},pad:function(_){return 2>_.length?"0"+_:_},readUTF8:function(_,e,j){for(var Vt,zt="",_r=0;_r<j;_r++)zt+="%"+v.bin.pad(_[e+_r].toString(16));try{Vt=decodeURIComponent(zt)}catch{return v.bin.readASCII(_,e,j)}return Vt},writeUTF8:function(_,e,j){for(var Vt=j.length,zt=0,_r=0;_r<Vt;_r++){var _o=j.charCodeAt(_r);if(!(4294967168&_o))_[e+zt]=_o,zt++;else if(!(4294965248&_o))_[e+zt]=192|_o>>6,_[e+zt+1]=128|_o>>0&63,zt+=2;else if(!(4294901760&_o))_[e+zt]=224|_o>>12,_[e+zt+1]=128|_o>>6&63,_[e+zt+2]=128|_o>>0&63,zt+=3;else{if(4292870144&_o)throw"e";_[e+zt]=240|_o>>18,_[e+zt+1]=128|_o>>12&63,_[e+zt+2]=128|_o>>6&63,_[e+zt+3]=128|_o>>0&63,zt+=4}}return zt},sizeUTF8:function(_){for(var e=_.length,j=0,Vt=0;Vt<e;Vt++){var zt=_.charCodeAt(Vt);if(!(4294967168&zt))j++;else if(!(4294965248&zt))j+=2;else if(!(4294901760&zt))j+=3;else{if(4292870144&zt)throw"e";j+=4}}return j}},v.F={},v.F.deflateRaw=function(_,e,j,Vt){var zt=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][Vt],_r=v.F.U,_o=v.F._goodIndex;v.F._hash;var ga=v.F._putsE,_a=0;j<<=3;var _l=0,_d=_.length;if(Vt==0){for(;_a<_d;){var _f=Math.min(65535,_d-_a);ga(e,j,_a+_f==_d?1:0),j=v.F._copyExact(_,_a,_f,e,j+8),_a+=_f}return j>>>3}ga=_r.lits,Vt=_r.strt;var _m=_r.prev,tE=0,rE=0,oE=0,dE=0,nE=0;for(2<_d&&(Vt[nE=v.F._hash(_,0)]=0),_a=0;_a<_d;_a++){if(_f=nE,_a+1<_d-2){nE=v.F._hash(_,_a+1);var sE=_a+1&32767;_m[sE]=Vt[nE],Vt[nE]=sE}if(_l<=_a){if((14e3<tE||26697<rE)&&100<_d-_a&&(_l<_a&&(ga[tE]=_a-_l,tE+=2,_l=_a),j=v.F._writeBlock(_a==_d-1||_l==_d?1:0,ga,tE,dE,_,oE,_a-oE,e,j),tE=rE=dE=0,oE=_a),sE=0,_a<_d-2&&(sE=v.F._bestMatch(_,_a,_m,_f,Math.min(zt[2],_d-_a),zt[3])),sE!=0){_f=sE>>>16,sE&=65535;var lE=_o(_f,_r.of0);_r.lhst[257+lE]++;var EE=_o(sE,_r.df0);_r.dhst[EE]++,dE+=_r.exb[lE]+_r.dxb[EE],ga[tE]=_f<<23|_a-_l,ga[tE+1]=sE<<16|lE<<8|EE,tE+=2,_l=_a+_f}else _r.lhst[_[_a]]++;rE++}}for(oE==_a&&_.length!=0||(_l<_a&&(ga[tE]=_a-_l,tE+=2),j=v.F._writeBlock(1,ga,tE,dE,_,oE,_a-oE,e,j));7&j;)j++;return j>>>3},v.F._bestMatch=function(_,e,j,Vt,zt,_r){var _o=32767&e,ga=j[_o],_a=_o-ga+32768&32767;if(ga==_o||Vt!=v.F._hash(_,e-_a))return 0;for(var _l=Vt=0,_d=Math.min(32767,e);_a<=_d&&--_r!=0&&ga!=_o;){if((Vt==0||_[e+Vt]==_[e+Vt-_a])&&(_o=v.F._howLong(_,e,_a))>Vt){if(_l=_a,(Vt=_o)>=zt)break;_a+2<_o&&(_o=_a+2);for(var _f=0,_m=0;_m<_o-2;_m++){var tE=e-_a+_m+32768&32767,rE=tE-j[tE]+32768&32767;rE>_f&&(_f=rE,ga=tE)}}_a+=(_o=ga)-(ga=j[_o])+32768&32767}return Vt<<16|_l},v.F._howLong=function(_,e,j){if(_[e]!=_[e-j]||_[e+1]!=_[e+1-j]||_[e+2]!=_[e+2-j])return 0;var Vt=e,zt=Math.min(_.length,e+258);for(e+=3;e<zt&&_[e]==_[e-j];)e++;return e-Vt},v.F._hash=function(_,e){return(_[e]<<8|_[e+1])+(_[e+2]<<4)&65535},v.saved=0,v.F._writeBlock=function(_,e,j,Vt,zt,_r,_o,ga,_a){var _l=v.F.U,_d=v.F._putsF,_f=v.F._putsE;_l.lhst[256]++;var _m=v.F.getTrees(),tE=_m[0],rE=_m[1],oE=_m[2],dE=_m[3],nE=_m[4],sE=_m[5],lE=_m[6];_m=_m[7];var EE=32+(_a+3&7?8-(_a+3&7):0)+(_o<<3),wE=Vt+v.F.contSize(_l.fltree,_l.lhst)+v.F.contSize(_l.fdtree,_l.dhst);Vt=Vt+v.F.contSize(_l.ltree,_l.lhst)+v.F.contSize(_l.dtree,_l.dhst),Vt+=14+3*sE+v.F.contSize(_l.itree,_l.ihst)+(2*_l.ihst[16]+3*_l.ihst[17]+7*_l.ihst[18]);for(var IE=0;286>IE;IE++)_l.lhst[IE]=0;for(IE=0;30>IE;IE++)_l.dhst[IE]=0;for(IE=0;19>IE;IE++)_l.ihst[IE]=0;if(EE=EE<wE&&EE<Vt?0:wE<Vt?1:2,_d(ga,_a,_),_d(ga,_a+1,EE),_a+=3,EE==0){for(;7&_a;)_a++;_a=v.F._copyExact(zt,_r,_o,ga,_a)}else{if(EE==1)var _E=_l.fltree,kE=_l.fdtree;if(EE==2){for(v.F.makeCodes(_l.ltree,tE),v.F.revCodes(_l.ltree,tE),v.F.makeCodes(_l.dtree,rE),v.F.revCodes(_l.dtree,rE),v.F.makeCodes(_l.itree,oE),v.F.revCodes(_l.itree,oE),_E=_l.ltree,kE=_l.dtree,_f(ga,_a,dE-257),_f(ga,_a+=5,nE-1),_f(ga,_a+=5,sE-4),_a+=4,_=0;_<sE;_++)_f(ga,_a+3*_,_l.itree[1+(_l.ordr[_]<<1)]);_a=v.F._codeTiny(lE,_l.itree,ga,_a+3*sE),_a=v.F._codeTiny(_m,_l.itree,ga,_a)}for(sE=0;sE<j;sE+=2){for(lE=(_=e[sE])>>>23,_=_r+(8388607&_);_r<_;)_a=v.F._writeLit(zt[_r++],_E,ga,_a);lE!=0&&(_=(tE=e[sE+1])>>16,_o=tE>>8&255,tE&=255,_f(ga,_a=v.F._writeLit(257+_o,_E,ga,_a),lE-_l.of0[_o]),_a+=_l.exb[_o],_d(ga,_a=v.F._writeLit(tE,kE,ga,_a),_-_l.df0[tE]),_a+=_l.dxb[tE],_r+=lE)}_a=v.F._writeLit(256,_E,ga,_a)}return _a},v.F._copyExact=function(_,e,j,Vt,zt){var _r=zt>>>3;return Vt[_r]=j,Vt[_r+1]=j>>>8,Vt[_r+2]=255-Vt[_r],Vt[_r+3]=255-Vt[_r+1],_r+=4,Vt.set(new Uint8Array(_.buffer,e,j),_r),zt+(j+4<<3)},v.F.getTrees=function(){for(var _=v.F.U,e=v.F._hufTree(_.lhst,_.ltree,15),j=v.F._hufTree(_.dhst,_.dtree,15),Vt=[],zt=v.F._lenCodes(_.ltree,Vt),_r=[],_o=v.F._lenCodes(_.dtree,_r),ga=0;ga<Vt.length;ga+=2)_.ihst[Vt[ga]]++;for(ga=0;ga<_r.length;ga+=2)_.ihst[_r[ga]]++;ga=v.F._hufTree(_.ihst,_.itree,7);for(var _a=19;4<_a&&_.itree[1+(_.ordr[_a-1]<<1)]==0;)_a--;return[e,j,ga,zt,_o,_a,Vt,_r]},v.F.getSecond=function(_){for(var e=[],j=0;j<_.length;j+=2)e.push(_[j+1]);return e},v.F.nonZero=function(_){for(var e="",j=0;j<_.length;j+=2)_[j+1]!=0&&(e+=(j>>1)+",");return e},v.F.contSize=function(_,e){for(var j=0,Vt=0;Vt<e.length;Vt++)j+=e[Vt]*_[1+(Vt<<1)];return j},v.F._codeTiny=function(_,e,j,Vt){for(var zt=0;zt<_.length;zt+=2){var _r=_[zt],_o=_[zt+1];Vt=v.F._writeLit(_r,e,j,Vt);var ga=_r==16?2:_r==17?3:7;15<_r&&(v.F._putsE(j,Vt,_o,ga),Vt+=ga)}return Vt},v.F._lenCodes=function(_,e){for(var j=_.length;j!=2&&_[j-1]==0;)j-=2;for(var Vt=0;Vt<j;Vt+=2){var zt=_[Vt+1],_r=Vt+3<j?_[Vt+3]:-1,_o=Vt+5<j?_[Vt+5]:-1,ga=Vt==0?-1:_[Vt-1];if(zt==0&&_r==zt&&_o==zt){for(_r=Vt+5;_r+2<j&&_[_r+2]==zt;)_r+=2;11>(zt=Math.min(_r+1-Vt>>>1,138))?e.push(17,zt-3):e.push(18,zt-11),Vt+=2*zt-2}else if(zt==ga&&_r==zt&&_o==zt){for(_r=Vt+5;_r+2<j&&_[_r+2]==zt;)_r+=2;zt=Math.min(_r+1-Vt>>>1,6),e.push(16,zt-3),Vt+=2*zt-2}else e.push(zt,0)}return j>>>1},v.F._hufTree=function(_,e,j){var Vt=[],zt=_.length,_r=e.length,_o=0;for(_o=0;_o<_r;_o+=2)e[_o]=0,e[_o+1]=0;for(_o=0;_o<zt;_o++)_[_o]!=0&&Vt.push({lit:_o,f:_[_o]});if(_=Vt.length,zt=Vt.slice(0),_==0)return 0;if(_==1)return e[1+((j=Vt[0].lit)<<1)]=1,e[1+((j==0?1:0)<<1)]=1;Vt.sort(function(_d,_f){return _d.f-_f.f}),_o=Vt[0],_r=Vt[1];var ga=0,_a=1,_l=2;for(Vt[0]={lit:-1,f:_o.f+_r.f,l:_o,r:_r,d:0};_a!=_-1;)_o=ga!=_a&&(_l==_||Vt[ga].f<Vt[_l].f)?Vt[ga++]:Vt[_l++],_r=ga!=_a&&(_l==_||Vt[ga].f<Vt[_l].f)?Vt[ga++]:Vt[_l++],Vt[_a++]={lit:-1,f:_o.f+_r.f,l:_o,r:_r};for((Vt=v.F.setDepth(Vt[_a-1],0))>j&&(v.F.restrictDepth(zt,j,Vt),Vt=j),_o=0;_o<_;_o++)e[1+(zt[_o].lit<<1)]=zt[_o].d;return Vt},v.F.setDepth=function(_,e){return _.lit!=-1?_.d=e:Math.max(v.F.setDepth(_.l,e+1),v.F.setDepth(_.r,e+1))},v.F.restrictDepth=function(_,e,j){var Vt=0,zt=1<<j-e,_r=0;for(_.sort(function(ga,_a){return _a.d==ga.d?ga.f-_a.f:_a.d-ga.d}),Vt=0;Vt<_.length&&_[Vt].d>e;Vt++){var _o=_[Vt].d;_[Vt].d=e,_r+=zt-(1<<j-_o)}for(_r>>>=j-e;0<_r;)(_o=_[Vt].d)<e?(_[Vt].d++,_r-=1<<e-_o-1):Vt++;for(;0<=Vt;Vt--)_[Vt].d==e&&0>_r&&(_[Vt].d--,_r++);_r!=0&&console.log("debt left")},v.F._goodIndex=function(_,e){var j=0;return e[16|j]<=_&&(j|=16),e[8|j]<=_&&(j|=8),e[4|j]<=_&&(j|=4),e[2|j]<=_&&(j|=2),e[1|j]<=_&&(j|=1),j},v.F._writeLit=function(_,e,j,Vt){return v.F._putsF(j,Vt,e[_<<1]),Vt+e[1+(_<<1)]},v.F.inflate=function(_,e){var j=Uint8Array;if(_[0]==3&&_[1]==0)return e||new j(0);var Vt=v.F,zt=Vt._bitsF,_r=Vt._bitsE,_o=Vt._decodeTiny,ga=Vt.makeCodes,_a=Vt.codes2map,_l=Vt._get17,_d=Vt.U,_f=e==null;_f&&(e=new j(_.length>>>2<<3));for(var _m,tE,rE,oE,dE=0,nE=0,sE=tE=0,lE=0;dE==0;)if(dE=zt(_,lE,1),_m=zt(_,lE+1,2),lE+=3,_m==0)7&lE&&(lE+=8-(7&lE)),_m=_[(lE=4+(lE>>>3))-4]|_[lE-3]<<8,_f&&(e=v.F._check(e,sE+_m)),e.set(new j(_.buffer,_.byteOffset+lE,_m),sE),lE=lE+_m<<3,sE+=_m;else{if(_f&&(e=v.F._check(e,sE+131072)),_m==1&&(rE=_d.flmap,oE=_d.fdmap,nE=511,tE=31),_m==2){for(tE=_r(_,lE,5)+257,_m=_r(_,lE+5,5)+1,rE=_r(_,lE+10,4)+4,lE+=14,oE=0;38>oE;oE+=2)_d.itree[oE]=0,_d.itree[oE+1]=0;for(nE=1,oE=0;oE<rE;oE++){var EE=_r(_,lE+3*oE,3);_d.itree[1+(_d.ordr[oE]<<1)]=EE,EE>nE&&(nE=EE)}lE+=3*rE,ga(_d.itree,nE),_a(_d.itree,nE,_d.imap),rE=_d.lmap,oE=_d.dmap,lE=_o(_d.imap,(1<<nE)-1,tE+_m,_,lE,_d.ttree),nE=(1<<(EE=Vt._copyOut(_d.ttree,0,tE,_d.ltree)))-1,tE=(1<<(_m=Vt._copyOut(_d.ttree,tE,_m,_d.dtree)))-1,ga(_d.ltree,EE),_a(_d.ltree,EE,rE),ga(_d.dtree,_m),_a(_d.dtree,_m,oE)}for(;;)if(lE+=15&(_m=rE[_l(_,lE)&nE]),(EE=_m>>>4)>>>8==0)e[sE++]=EE;else{if(EE==256)break;_m=sE+EE-254,264<EE&&(_m=sE+((EE=_d.ldef[EE-257])>>>3)+_r(_,lE,7&EE),lE+=7&EE),lE+=15&(EE=oE[_l(_,lE)&tE]);var wE=((EE=_d.ddef[EE>>>4])>>>4)+zt(_,lE,15&EE);for(lE+=15&EE,_f&&(e=v.F._check(e,sE+131072));sE<_m;)e[sE]=e[sE++-wE],e[sE]=e[sE++-wE],e[sE]=e[sE++-wE],e[sE]=e[sE++-wE];sE=_m}}return e.length==sE?e:e.slice(0,sE)},v.F._check=function(_,e){var j=_.length;return e<=j?_:((e=new Uint8Array(Math.max(j<<1,e))).set(_,0),e)},v.F._decodeTiny=function(_,e,j,Vt,zt,_r){for(var _o=v.F._bitsE,ga=v.F._get17,_a=0;_a<j;){var _l=_[ga(Vt,zt)&e];zt+=15&_l;var _d=_l>>>4;if(15>=_d)_r[_a]=_d,_a++;else{var _f=_l=0;for(_d==16?(_f=3+_o(Vt,zt,2),zt+=2,_l=_r[_a-1]):_d==17?(_f=3+_o(Vt,zt,3),zt+=3):_d==18&&(_f=11+_o(Vt,zt,7),zt+=7),_d=_a+_f;_a<_d;)_r[_a]=_l,_a++}}return zt},v.F._copyOut=function(_,e,j,Vt){for(var zt=0,_r=0,_o=Vt.length>>>1;_r<j;){var ga=_[_r+e];Vt[_r<<1]=0,Vt[1+(_r<<1)]=ga,ga>zt&&(zt=ga),_r++}for(;_r<_o;)Vt[_r<<1]=0,Vt[1+(_r<<1)]=0,_r++;return zt},v.F.makeCodes=function(_,e){var j,Vt,zt=v.F.U,_r=_.length,_o=zt.bl_count;for(j=0;j<=e;j++)_o[j]=0;for(j=1;j<_r;j+=2)_o[_[j]]++;for(zt=zt.next_code,j=0,_o[0]=0,Vt=1;Vt<=e;Vt++)j=j+_o[Vt-1]<<1,zt[Vt]=j;for(e=0;e<_r;e+=2)(_o=_[e+1])!=0&&(_[e]=zt[_o],zt[_o]++)},v.F.codes2map=function(_,e,j){for(var Vt=_.length,zt=v.F.U.rev15,_r=0;_r<Vt;_r+=2)if(_[_r+1]!=0){var _o=_[_r+1],ga=_r>>1<<4|_o,_a=e-_o;for(_a=(_o=_[_r]<<_a)+(1<<_a);_o!=_a;)j[zt[_o]>>>15-e]=ga,_o++}},v.F.revCodes=function(_,e){for(var j=v.F.U.rev15,Vt=15-e,zt=0;zt<_.length;zt+=2)_[zt]=j[_[zt]<<e-_[zt+1]]>>>Vt},v.F._putsE=function(_,e,j){j<<=7&e,_[e>>>=3]|=j,_[e+1]|=j>>>8},v.F._putsF=function(_,e,j){j<<=7&e,_[e>>>=3]|=j,_[e+1]|=j>>>8,_[e+2]|=j>>>16},v.F._bitsE=function(_,e,j){return(_[e>>>3]|_[1+(e>>>3)]<<8)>>>(7&e)&(1<<j)-1},v.F._bitsF=function(_,e,j){return(_[e>>>3]|_[1+(e>>>3)]<<8|_[2+(e>>>3)]<<16)>>>(7&e)&(1<<j)-1},v.F._get17=function(_,e){return(_[e>>>3]|_[1+(e>>>3)]<<8|_[2+(e>>>3)]<<16)>>>(7&e)},v.F._get25=function(_,e){return(_[e>>>3]|_[1+(e>>>3)]<<8|_[2+(e>>>3)]<<16|_[3+(e>>>3)]<<24)>>>(7&e)},v.F.U=function(){var _=Uint16Array,e=Uint32Array;return{next_code:new _(16),bl_count:new _(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new _(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new _(512),fltree:[],fdmap:new _(32),fdtree:[],lmap:new _(32768),ltree:[],ttree:[],dmap:new _(32768),dtree:[],imap:new _(512),itree:[],rev15:new _(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new _(65536),prev:new _(32768)}}(),function(){function _(zt,_r,_o){for(;_r--!=0;)zt.push(0,_o)}for(var e=v.F.U,j=0;32768>j;j++){var Vt=j;Vt=(4278255360&(Vt=(4042322160&(Vt=(3435973836&(Vt=(2863311530&Vt)>>>1|(1431655765&Vt)<<1))>>>2|(858993459&Vt)<<2))>>>4|(252645135&Vt)<<4))>>>8|(16711935&Vt)<<8,e.rev15[j]=(Vt>>>16|Vt<<16)>>>17}for(j=0;32>j;j++)e.ldef[j]=e.of0[j]<<3|e.exb[j],e.ddef[j]=e.df0[j]<<4|e.dxb[j];_(e.fltree,144,8),_(e.fltree,112,9),_(e.fltree,24,7),_(e.fltree,8,8),v.F.makeCodes(e.fltree,9),v.F.codes2map(e.fltree,9,e.flmap),v.F.revCodes(e.fltree,9),_(e.fdtree,32,5),v.F.makeCodes(e.fdtree,5),v.F.codes2map(e.fdtree,5,e.fdmap),v.F.revCodes(e.fdtree,5),_(e.itree,19,0),_(e.ltree,286,0),_(e.dtree,30,0),_(e.ttree,320,0)}();var iD=["backups","servers"],jD=["backups","servers"],kD=["group"],nl=v.inflate,ks=v.deflate,ls=function(_){function e(Vt,zt,_r,_o){W(this,e);var ga=j.call(this,_o,"Session");return m(n(ga),"chatManager",void 0),m(n(ga),"joinedChannels",new Set),m(n(ga),"msgDedupLru",new tc(void 0,{maxlen:200})),m(n(ga),"startTime",Date.now()),m(n(ga),"seq",U.fromNumber(1,!0)),m(n(ga),"userJoinOptions",new is(!1)),m(n(ga),"seqSentStatuses",[!1,!1]),m(n(ga),"dialogueSequenceLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"loggedOut",!1),m(n(ga),"messageSentTimes",[]),m(n(ga),"curLoginSockets",[void 0,void 0]),m(n(ga),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),m(n(ga),"lastLoginSockets",[new qe(1),new qe(1)]),m(n(ga),"dialPendingMsgSubjectMap",new Map),m(n(ga),"context",void 0),m(n(ga),"connection",void 0),m(n(ga),"instanceId",void 0),m(n(ga),"registerSocketsFailureListener",function(){ga.connection.once("socketsFailure",function(){ga.log("socketsFailure, creating a new connection"),ad(function(){return ga.connection.removeAllListeners(),ga.connection=new Yr(ga.context,ga.logger,!0),ga.loginHandler(15e3,!0)}).pipe(oe(function(_a){return _a.pipe(cd(Zd.getParameter("RECONNECTING_AP_INTERVAL")))}),ob(ga.connection.apClient.apFinish$)).subscribe(function(){ga.log("new connection connected")})}),ga.connection.listenerCount("tokenExpired")===0&&ga.connection.on("tokenExpired",function(){ga.emit("tokenExpired")})}),ga.context=Vt,ga.connection=zt,ga.instanceId=_r,ga.chatManager=new hD(_o),ga.log("The instanceId is %s",ga.instanceId.toString()),ga}la(e,_);var j=ma(e);return Ha(e,[{key:"fetchFileUploadIndexGet",value:function(Vt){var zt=Vt.hash,_r=Vt.size;if((Vt=this.getLoginSockets()).length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return Vt.forEach(function(ga){ga.sendPacket("FileUploadIndexGet",{seq:_o,hash:zt,size:_r})}),{ret:Ca.apply(void 0,G(Vt.map(function(ga){return ga.fromReceived("FileUploadIndexRet").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))),fin:Ca.apply(void 0,G(Vt.map(function(ga){return ga.fromReceived("FileUploadIndexFin").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))),err:Xb.apply(void 0,G(Vt.map(function(ga){return ga.fromReceived("FileUploadIndexErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw new da(["The media message upload failure, code %d",_a.code],lg)}))}))),timeout:e.genTimeoutError(Lh)}}},{key:"requestFileUploadIndexSet",value:function(Vt){var zt=Vt.hash,_r=Vt.unit,_o=Vt.servers;if((Vt=this.getLoginSockets()).length===0)throw new K("Client is not logged in");var ga=this.incGetSeq();return Vt.forEach(function(_a){_a.sendPacket("FileUploadIndexSet",{seq:ga,servers:_o,hash:zt,unit:_r})}),Ca.apply(void 0,[e.genTimeoutError(Lh)].concat(G(Vt.map(function(_a){return _a.fromReceived("FileUploadIndexErr").pipe(aa(function(_l){return ga.eq(_l.seq)}),ba(function(_l){throw new da(["FileUploadIndexSet failure, code %d",_l.code],lg)}))})),G(Vt.map(function(_a){return _a.fromReceived("FileUploadIndexFin").pipe(aa(function(_l){return ga.eq(_l.seq)}))}))))}},{key:"requestFileDownloadIndexGet",value:function(Vt){var zt=Vt.size,_r=Vt.zone,_o=Vt.unit,ga=Vt.hash,_a=this.getLoginSockets();if(_a.length===0)throw new K("Client is not logged in");var _l=this.incGetSeq();return _a.forEach(function(_d){_d.sendPacket("FileDownloadIndexGet",{seq:_l,size:zt,zone:_r,unit:_o,hash:ga})}),Vt=Ca.apply(void 0,G(_a.map(function(_d){return _d.fromReceived("FileDownloadIndexRet").pipe(aa(function(_f){return _l.eq(_f.seq)}))}))).pipe(ba(function(_d){var _f=_d.backups,_m=_d.servers;return _d=ff(_d,iD),ua({backupList:_f.map(function(tE){return[tE]}),serverList:_m.map(function(tE){return[tE]})},_d)}),cd(500)),_a=jm(_a.map(function(_d){return _d.fromReceived("FileDownloadIndexRet").pipe(aa(function(_f){return _l.eq(_f.seq)}))})),Ca(Vt,_a.pipe(ba(function(_d){return _d.reduce(function(_f,_m){var tE=_f.backupList,rE=_f.serverList;_f=_m.backups;var oE=_m.servers;return _m=ff(_m,jD),ua({backupList:_f.map(function(dE,nE){return[dE].concat(G(tE!==void 0&&Array.isArray(tE[nE])?tE[nE]:[]))}),serverList:oE.map(function(dE,nE){return[dE].concat(G(tE!==void 0&&Array.isArray(rE[nE])?rE[nE]:[]))})},_m)},{})})),e.genTimeoutError(Lh))}},{key:"loginHandler",value:function(){var Vt=this,zt=0<arguments.length&&arguments[0]!==void 0?arguments[0]:2e4,_r=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&_r)throw new K("Already logged out, request ignored");_r&&this.registerSocketsFailureListener(),this.connection.initConnection();var _o=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),ga=Date.now();return _o.forEach(function(_a,_l){var _d=Vt.loginSocketSubs[_l].login;_d!==void 0&&_d.unsubscribe(),Vt.loginSocketSubs[_l].login=_a.pipe(ca(function(_f){var _m;Vt.curLoginSockets[_l]=_f;var tE=Date.now();eb("Link",{ackedServerIp:_f.address,destServerIp:_f.ip,ec:0,sc:0,elapse:fb(Vt.startTime),lts:U.fromNumber(tE),responseTime:ga-tE,sid:Xa(Vt.instanceId),userId:Vt.context.uid},(_m=Vt.context.config.enableCloudProxy)!==null&&_m!==void 0&&_m),Vt.emit("userJoined",_f.env),_r&&Vt.connection.apClient.apFinish$.next(void 0)})).subscribe(Vt.lastLoginSockets[_l])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),Xb.apply(void 0,G(_o).concat([gb(this.connection,"connectionInitFailure").pipe(ca(function(_a){throw sa(_a)||Sa(_a)?_a:new da("Login failure",{code:Zq,originalError:_a})}))])).pipe(Ka(1),hb(zt),Ga(function(_a){return _a instanceof pb&&Vt.warn("Client login timeout"),_a&&_a.code===Kh&&(Vt.connection.emit("tokenExpired"),Vt.connection.apClient.apFinish$.next(void 0)),Vt.clearSockets(0,_r),Z(_a)}),ca(function(){_r||Vt.registerSocketsFailureListener()}),wg(function(){_r||Vt.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:function(){var Vt=J(w.mark(function zt(){var _r,_o,ga,_a=this;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),_r=this.getLoginSockets(),_o=_r.map(function(_d){return _d.sendPacket("UserQuit",{}),_a.connection.waitClosing(_d)}),this.clearSockets(5e3),ga=_r.map(function(_d){return _d.env}),[0,1].filter(function(_d){return!ga.includes(_d)}).forEach(function(_d){_a.connection.closeSocket(_d,0)}),_l.abrupt("return",Xb.apply(void 0,G(_o)).toPromise());case 9:case"end":return _l.stop()}},zt,this)}));return function(){return Vt.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d=this;return w.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:if(this.getLoginSockets().length!==0){_f.next=2;break}throw new K("Client is not logged in. Cannot join the channel",Vq);case 2:return ga=gb(this,"channelLeft").pipe(wb(function(_m){return _m===_r}),Ka(1)),_a=this.incGetSeq(),(_l=this.lastLoginSockets.map(function(_m){return _m.pipe(Cc(function(tE,rE){rE!==0&&_d.incSeqIfNeeded(tE.env);var oE=rE===0?_a:_d.seq;return tE.sendPacket("GroupEnter",{account:_o,seq:oE}),tE.fromReceived("GroupReply").pipe(aa(function(dE){return oE.eq(dE.seq)}),ca(function(dE){if((dE=dE.code)!==0)throw new da(["Channel join failure. The response code is %d",dE],Rq)}))}),ob(ga),pe())})).forEach(function(_m,tE){var rE=function(){return _d.loginSocketSubs[tE].channels.delete(_r.channelId)};_d.loginSocketSubs[tE].channels.set(_r.channelId,_m.subscribe({error:rE,complete:rE}))}),_f.next=8,Xb.apply(void 0,G(_l)).pipe(Ka(1),hb(1e4),Ga(function(_m){return _m instanceof pb&&_d.warn("Channel join timeout"),Z(_m)})).toPromise();case 8:this.joinedChannels.add(_r);case 9:case"end":return _f.stop()}},zt,this)}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(Vt,zt){this.emit("channelLeft",Vt),this.joinedChannels.delete(Vt),this.getLoginSockets().forEach(function(_r){_r.sendPacket("GroupLeave",{account:zt})})}},{key:"requestChannelMemberList",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in. Cannot get the channel members",cA);var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("GroupAllUsersList",{group:Vt,pageNumber:0,pageSize:200,seq:_r})}),Ca.apply(void 0,[e.genTimeoutError(Pq)].concat(G(zt.map(function(_o){return _o.fromReceived("GroupAllUsersResult").pipe(aa(function(ga){var _a=ga.seq;return ga.group===Vt&&_r.eq(_a)}))}))))}},{key:"requestPeersOnlineStatus",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("UserStatusList",{users:Vt,seq:_r})}),Ca.apply(void 0,[e.genTimeoutError(oA)].concat(G(zt.map(function(_o){return _o.fromReceived("UserStatusResult").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(Vt,zt){var _r=this,_o=this.getLoginSockets();if(_o.length===0)throw new K("Client is not logged in");var ga=this.incGetSeq();return _o.forEach(function(_a,_l){zt!==void 0&&_l!==zt||_a.sendPacket("UserAttributeSet",{account:_r.context.uid,attributeInfos:Object.entries(Vt).map(function(_d){return{key:(_d=ra(_d,2))[0],value:_d[1]}}),seq:ga})}),Ca.apply(void 0,G(_o.map(function(_a){return _a.fromReceived("UserAttributeErr").pipe(aa(function(_l){return ga.eq(_l.seq)}),ba(function(_l){throw new da(["The user attributes set failure, code %d",_l.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_o.map(function(_a){return _a.fromReceived("UserAttributeRsp").pipe(aa(function(_l){return ga.eq(_l.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(Vt,zt,_r){var _o=this.getLoginSockets();if(_o.length===0)throw new K("Client is not logged in");var ga=this.incGetSeq();return _o.forEach(function(_a){_a.sendPacket("GroupAttributeSet",{broadcast:_r,group:Vt,attributeInfos:Object.entries(zt).map(function(_l){return{key:(_l=ra(_l,2))[0],value:_l[1]}}),seq:ga})}),Ca.apply(void 0,G(_o.map(function(_a){return _a.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return ga.eq(_l.seq)}),ba(function(_l){throw new da(["The group attributes set failure, code %d",_l.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_o.map(function(_a){return _a.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return ga.eq(_l.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(Vt){var zt=this,_r=this.getLoginSockets();if(_r.length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("UserAttributeMod",{account:zt.context.uid,attributeInfos:Object.entries(Vt).map(function(_a){return{key:(_a=ra(_a,2))[0],value:_a[1]}}),seq:_o})}),Ca.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw new da(["The user attributes add or update failure, code %d",_a.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_r.map(function(ga){return ga.fromReceived("UserAttributeRsp").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(Vt,zt,_r){var _o=this.getLoginSockets();if(_o.length===0)throw new K("Client is not logged in");var ga=this.incGetSeq();return _o.forEach(function(_a){_a.sendPacket("GroupAttributeMod",{broadcast:_r,group:Vt,attributeInfos:Object.entries(zt).map(function(_l){return{key:(_l=ra(_l,2))[0],value:_l[1]}}),seq:ga})}),Ca.apply(void 0,G(_o.map(function(_a){return _a.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return ga.eq(_l.seq)}),ba(function(_l){throw new da(["The group attributes add or update failure, code %d",_l.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_o.map(function(_a){return _a.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return ga.eq(_l.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(Vt){var zt=this,_r=this.getLoginSockets();if(_r.length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("UserAttributeDel",{account:zt.context.uid,attributes:Vt,seq:_o})}),Ca.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw new da(["The user attributes delete failure, code %d",_a.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_r.map(function(ga){return ga.fromReceived("UserAttributeRsp").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(Vt,zt,_r){var _o=this.getLoginSockets();if(_o.length===0)throw new K("Client is not logged in");var ga=this.incGetSeq();return _o.forEach(function(_a){_a.sendPacket("GroupAttributeDel",{group:Vt,broadcast:_r,attributes:zt,seq:ga})}),Ca.apply(void 0,G(_o.map(function(_a){return _a.fromReceived("GroupAttributeErr").pipe(aa(function(_l){return ga.eq(_l.seq)}),ba(function(_l){throw new da(["The channel attributes delete failure, code %d",_l.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_o.map(function(_a){return _a.fromReceived("GroupAttributeRsp").pipe(aa(function(_l){return ga.eq(_l.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var Vt=this,zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("UserAttributeSet",{account:Vt.context.uid,seq:_r,attributeInfos:[]})}),Ca.apply(void 0,G(zt.map(function(_o){return _o.fromReceived("UserAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ba(function(ga){throw new da(["The user attributes clear failure, code %d",ga.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(zt.map(function(_o){return _o.fromReceived("UserAttributeRsp").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(Vt,zt){var _r=this.getLoginSockets();if(_r.length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("GroupAttributeSet",{group:Vt,seq:_o,attributeInfos:[],broadcast:zt})}),Ca.apply(void 0,G(_r.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw new da(["The channel attributes clear failure, code %d",_a.code],Sb)}))})).concat([e.genTimeoutError(Tb)],G(_r.map(function(ga){return ga.fromReceived("GroupAttributeRsp").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(Vt,zt){var _r=this.getLoginSockets();if(_r.length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("UserAttributeGet",{account:Vt,seq:_o,attributes:zt})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(_r.map(function(ga){return ga.fromReceived("UserAttributeErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw(_a=_a.code)===10008?new da("The user requested is not online",Lq):new Wc(["User attribute operation unknown error code: %d",_a],Sb)}))})),G(_r.map(function(ga){return ga.fromReceived("UserAttributeRet").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(Vt,zt){var _r=this.getLoginSockets();if(_r.length===0)throw new K("Client is not logged in");var _o=this.incGetSeq();return _r.forEach(function(ga){ga.sendPacket("GroupAttributeGet",{group:Vt,seq:_o,attributes:zt})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(_r.map(function(ga){return ga.fromReceived("GroupAttributeErr").pipe(aa(function(_a){return _o.eq(_a.seq)}),ba(function(_a){throw new da(["The channel attributes get failure, code %d",_a.code],Sb)}))})),G(_r.map(function(ga){return ga.fromReceived("GroupAttributeRet").pipe(aa(function(_a){return _o.eq(_a.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("UserAttributeKeysGet",{account:Vt,seq:_r})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(zt.map(function(_o){return _o.fromReceived("UserAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ba(function(ga){throw(ga=ga.code)===10008?new da("The user requested is not online",Lq):new Wc(["User attribute operation unknown error code: %d",ga],Sb)}))})),G(zt.map(function(_o){return _o.fromReceived("UserAttributeKeysRet").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("GroupAttributeKeysGet",{group:Vt,seq:_r})}),Ca.apply(void 0,[e.genTimeoutError(Tb)].concat(G(zt.map(function(_o){return _o.fromReceived("GroupAttributeErr").pipe(aa(function(ga){return _r.eq(ga.seq)}),ba(function(ga){throw new Wc(["Channel attribute operation unknown error code: %d",ga.code],Sb)}))})),G(zt.map(function(_o){return _o.fromReceived("GroupAttributeKeysRet").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("GroupStatusList",{groups:Vt,seq:_r})}),Ca.apply(void 0,[e.genTimeoutError(Pq)].concat(G(zt.map(function(_o){return _o.fromReceived("GroupStatusResult").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();return zt.forEach(function(_o){_o.sendPacket("SubscribeUserStatus",{seq:_r,users:Vt})}),Ca.apply(void 0,[e.genTimeoutError(vA)].concat(G(zt.map(function(_o){return _o.fromReceived("SubscribeResponse").pipe(aa(function(ga){return _r.eq(ga.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(Vt){var zt=this.getLoginSockets();if(zt.length===0)throw new K("Client is not logged in");var _r=this.incGetSeq();zt.forEach(function(_o){_o.sendPacket("UnsubscribeUserStatus",{seq:_r,users:Vt})})}},{key:"sendInvitationMessage",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE=this;return w.wrap(function(lE){for(;;)switch(lE.prev=lE.next){case 0:if(_o=_r.peerId,ga=_r.callId,_a=_r.extra,_l=_r.isAcceptAck,_d=_r.channelId,_f=_r.type,_m={callId:ga},_l===void 0){lE.next=6;break}if(_f==="CallAccept"){lE.next=5;break}throw Error("invalid invitation type");case 5:_m.type=_l?"ack":"request";case 6:return _m.channel=_d,(_f==="CallInvite"||_f==="CallCancel"||_f==="CallReject"||_f==="CallAccept"&&_l===!1)&&_a!==void 0&&(_m.extra=_a),tE=Bg(),this.log("The sent invitation body is %o",_m),rE=function(EE){return{MiscMap:{},sequence:U.fromNumber(1),dialogue:tE,instance:sE.instanceId,dst:_o,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:EE,MessageType:_f}).toLong(),payload:new TextEncoder().encode(JSON.stringify(_m)),src:sE.context.uid}},lE.next=14,Kb(this.sendMessageToRetry(rE,!0)).pipe(hb(1e4),Ga(function(EE){return EE instanceof pb&&sE.warn("Send invitation timeout"),Z(EE)})).toPromise();case 14:return oE=lE.sent,dE=oE.code,nE=oE.retryTimes,lE.abrupt("return",{hasPeerReceived:dE===0,hasReSent:nE!==0});case 18:case"end":return lE.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"sendMediaMessage",value:function(){var Vt=J(w.mark(function zt(_r,_o,ga,_a,_l,_d){var _f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE,IE,_E,kE,ME,bE,LE,TE,OE,vE,NE,jE,UE,RE,FE,VE,BE,qE,e_,b_=this;return w.wrap(function(m_){for(;;)switch(m_.prev=m_.next){case 0:if(_m=_o.width,tE=_m===void 0?0:_m,rE=_o.height,oE=rE===void 0?0:rE,dE=_o.fileName,nE=dE===void 0?"":dE,sE=_o.description,lE=sE===void 0?"":sE,EE=_o.thumbnail,wE=EE===void 0?new Blob:EE,IE=_o.thumbnailHeight,_E=IE===void 0?0:IE,kE=_o.thumbnailWidth,ME=kE===void 0?0:kE,bE=_o.size,LE=bE===void 0?0:bE,TE=_o.mediaId,OE=_l.enableOfflineMessaging,vE=_l.enableHistoricalMessaging,za(ga)){m_.next=4;break}throw new I("The send message arguments are not valid",_a?$k:hg);case 4:if(!(32768<new Blob([nE,wE,lE]).size)){m_.next=6;break}throw new I("The size of message overflowed ",_a?ve:Hh);case 6:return NE=this.chatManager.getChatInfo(ga),jE=NE.dialogue,UE=NE.sequence,RE=this.instanceId,this.log('A%s media message is sending to %s: "'.concat(RE,"-").concat(jE,"#").concat(UE,'"'),_a?" peer":" channel",oa(ga)),m(_f={},"media_description",lE),m(_f,"media_width",tE),m(_f,"media_height",oE),m(_f,"media_thumbnailwidth",ME),m(_f,"media_thumbnailheight",_E),m(_f,"media_size",LE),m(_f,"media_id",TE),m(_f,"media_filename",nE),FE=uc(_f,function(I_){return new TextEncoder().encode(I_.toString())}),m_.t0=Uint8Array,m_.next=14,Ji(wE);case 14:return m_.t1=m_.sent,FE.media_thumbnail=new m_.t0(m_.t1),VE=_a&&_r==="IMAGE"?"PeerImageMessage":_a&&_r==="FILE"?"PeerFileMessage":_a||_r!=="IMAGE"?"ChannelFileMessage":"ChannelImageMessage",BE=function(I_){return{MiscMap:FE,sequence:UE,dialogue:jE,instance:RE,dst:ga,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:I_,CompressionMethod:"Uncompressed",MessageType:VE,ToCache:OE,ToArchive:vE}).toLong(),payload:new Uint8Array,src:b_.context.uid}},m_.next=20,Kb(this.sendMessageToRetry(BE,!0)).pipe(hb(_d===void 0?1e4:_d),Ga(function(I_){return I_ instanceof pb&&b_.warn("Send message timeout"),Z(I_)})).toPromise();case 20:if(qE=m_.sent,(e_=qE.code)!==2){m_.next=24;break}throw new da("The peer does not support this type of message",nA);case 24:return m_.abrupt("return",{hasPeerReceived:e_===0});case 25:case"end":return m_.stop()}},zt,this)}));return function(zt,_r,_o,ga,_a,_l){return Vt.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var Vt=J(w.mark(function zt(_r,_o,ga,_a,_l,_d){var _f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE=this;return w.wrap(function(IE){for(;;)switch(IE.prev=IE.next){case 0:if(_f=_l.enableOfflineMessaging,_m=_l.enableHistoricalMessaging,za(ga)&&_r instanceof Uint8Array&&typeof _o=="string"){IE.next=3;break}throw new I("The send message arguments are not valid",_a?$k:hg);case 3:if(!(32768<_r.byteLength+new Blob([_o]).size)){IE.next=5;break}throw new ib("The message size is over the 32KB limit",_a?ve:Hh);case 5:return tE=!Zd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=_r.byteLength,rE=this.chatManager.getChatInfo(ga),oE=rE.dialogue,dE=rE.sequence,nE=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(nE,"-").concat(oE,"#").concat(dE,'"'),tE?" compressed":"",_a?"peer":"channel",oa(ga)),sE=function(_E){return{MiscMap:{description:new TextEncoder().encode(_o)},sequence:dE,dialogue:oE,instance:nE,dst:ga,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:_E,CompressionMethod:tE?"Zlib":"Uncompressed",MessageType:_a?"PeerRawMessage":"ChannelRawMessage",ToCache:_f,ToArchive:_m}).toLong(),payload:tE?ks(_r):_r,src:wE.context.uid}},IE.next=12,Kb(this.sendMessageToRetry(sE,!0)).pipe(hb(_d===void 0?1e4:_d),Ga(function(_E){return _E instanceof pb&&wE.warn("Send message timeout"),Z(_E)})).toPromise();case 12:return lE=IE.sent,EE=lE.code,IE.abrupt("return",{hasPeerReceived:EE===0});case 15:case"end":return IE.stop()}},zt,this)}));return function(zt,_r,_o,ga,_a,_l){return Vt.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var Vt=J(w.mark(function zt(_r,_o,ga,_a,_l){var _d,_f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE=this;return w.wrap(function(IE){for(;;)switch(IE.prev=IE.next){case 0:if(_d=_a.enableOfflineMessaging,_f=_a.enableHistoricalMessaging,za(_o)){IE.next=3;break}throw new I("The send message arguments are not valid",ga?$k:hg);case 3:if(!(32768<new Blob([_r]).size)){IE.next=5;break}throw new ib("The message size is over the 32KB limit",ga?ve:Hh);case 5:return _m=!Zd.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([_r]).size,tE=this.chatManager.getChatInfo(_o),rE=tE.dialogue,oE=tE.sequence,dE=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(dE,"-").concat(rE,"#").concat(oE,'"'),_m?" compressed":"",ga?"peer":"channel",oa(_o)),nE=new TextEncoder().encode(_r),sE=function(_E){return{MiscMap:{},sequence:oE,dialogue:rE,instance:dE,dst:_o,ms:U.fromNumber(Date.now(),!0),options:new ae({IterationNumber:_E,CompressionMethod:_m?"Zlib":"Uncompressed",MessageType:ga?"PeerTextMessage":"ChannelTextMessage",ToCache:_d,ToArchive:_f}).toLong(),payload:_m?ks(nE):nE,src:wE.context.uid}},IE.next=13,Kb(this.sendMessageToRetry(sE,!0)).pipe(hb(_l===void 0?1e4:_l),Ga(function(_E){return _E instanceof pb&&wE.warn("Send message timeout"),Z(_E)})).toPromise();case 13:return lE=IE.sent,EE=lE.code,IE.abrupt("return",{hasPeerReceived:EE===0});case 16:case"end":return IE.stop()}},zt,this)}));return function(zt,_r,_o,ga,_a){return Vt.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(Vt,zt){Object.entries(this.loginSocketSubs[Vt]).forEach(function(_r){var _o=(_r=ra(_r,2))[1];_r[0]==="channels"&&zt||(Array.isArray(_o)||_o instanceof Map?_o.forEach(function(ga){return ga.unsubscribe()}):_o&&_o.unsubscribe())}),this.loginSocketSubs[Vt]={channels:zt?this.loginSocketSubs[Vt].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE,oE,dE=this,nE=arguments;return w.wrap(function(sE){for(;;)switch(sE.prev=sE.next){case 0:if(ga=2<nE.length&&nE[2]!==void 0?nE[2]:0,this.log("Attempt to send the message ".concat(_o?" with retrying, %o":"without retrying"),{retryTimes:ga}),(_a=this.getLoginSockets()).length!==0){sE.next=5;break}throw Error("no logged-in sockets");case 5:return _l=_r(ga),_a.forEach(function(lE){lE.sendPacket("Message",_l)}),_d=_l.dialogue,_f=_l.sequence,_m=_l.instance,tE=_a.map(function(lE){return lE.fromReceived("Ack").pipe(wb(function(EE){return _d.eq(EE.dialogue)&&_f.eq(EE.sequence)&&_m.eq(EE.instance)}))}),sE.prev=9,sE.next=12,Xb.apply(void 0,G(tE)).pipe(hb(6e3),Ga(function(lE){return Sa(lE)&&dE.warn("Message send timeout, retry times %d",ga),Z(lE)}),Ka(1)).toPromise();case 12:return rE=sE.sent,oE=rE.code,this.log("The message has been acked, %o",{code:oE}),sE.abrupt("return",{code:oE,retryTimes:ga});case 18:if(sE.prev=18,sE.t0=sE.catch(9),!(sE.t0 instanceof pb&&_o)){sE.next=22;break}return sE.abrupt("return",this.sendMessageToRetry(_r,!1,ga+1));case 22:throw sE.t0;case 23:case"end":return sE.stop()}},zt,this,[[9,18]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var Vt=this;this.lastLoginSockets.map(function(zt){return zt.pipe(Cc(function(_r){return Bc(0,2750).pipe(ca(function(){Vt.incSeqIfNeeded(_r.env),_r.sendPacket("Ping",{ms:U.fromNumber(Date.now(),!0),seq:Vt.seq})}))}))}).forEach(function(zt,_r){var _o=Vt.loginSocketSubs[_r].keepAlive;_o!==void 0&&_o.unsubscribe(),Vt.loginSocketSubs[_r].keepAlive=zt.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var Vt=this;this.lastLoginSockets.map(function(zt){return zt.pipe(Cc(function(_r){var _o,ga=!1,_a=_r.userJoin$.pipe(ca(function(){ga=!0})),_l=_r.input$.pipe(ca(function(_d){Li[_d.uri].slice(0,-3)!=="Ping"&&(ga=!1)}));return Xb(Bc(15e3,1e4).pipe(Pt(_r.receivedPacket),ca(function(_d){_d=ra(_d,2),_d=ra(_d[1],2)[1],_o!==_d||ga||_r.forceReconnect(),_o=_d})),_a,_l)}))}).forEach(function(zt,_r){var _o=Vt.loginSocketSubs[_r].keepAliveReconnector;_o!==void 0&&_o.unsubscribe(),Vt.loginSocketSubs[_r].keepAliveReconnector=zt.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var Vt=this;this.lastLoginSockets.map(function(zt){return zt.pipe(Cc(function(_r){return Xb(gb(_r,"reconnect").pipe(ca(Vt.onSocketReconnect(_r))),_r.fromReceived("Message").pipe(ca(Vt.onMessage(_r))),_r.fromReceived("GroupEnterNotice").pipe(ca(Vt.onGroupEnterNotice())),_r.fromReceived("GroupLeaveNotice").pipe(ca(Vt.onGroupLeaveNotice())),_r.fromReceived("GroupCountNotice").pipe(ca(Vt.onGroupCountNotice())),_r.fromReceived("GroupAttributeAlt").pipe(ca(Vt.onGroupAttributeAlt())),_r.fromReceived("UserJoinNotice").pipe(ca(Vt.onUserNotice(S.PeerOnlineState.ONLINE))),_r.fromReceived("UserQuitNotice").pipe(ca(Vt.onUserNotice(S.PeerOnlineState.OFFLINE))),_r.fromReceived("UserWaitNotice").pipe(ca(Vt.onUserNotice(S.PeerOnlineState.UNREACHABLE)))).pipe(qf(void 0))}))}).forEach(function(zt,_r){Vt.loginSocketSubs[_r].receivers.push(zt.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(Vt,zt,_r){var _o=this;return im(ad(function(){_o.userJoinOptions=new is(zt),Vt.sendPacket("UserJoin",{account:_o.context.uid,instance:_o.instanceId,opt:_o.userJoinOptions.toLong(),seq:_r,ticket:Vt.ticket})}),Vt.fromReceived("UserResp").pipe(aa(function(ga){return _r.eq(ga.seq)}),ca(function(ga){if((ga=ga.code)!==0)throw _o.clearSockets(),_o.logError("Connected to gateway success but the Rtm server rejected login"),new da(["Login failure. The response code from the RTM service is %d",ga],jg);_o.log("ENV_%d logged in",Vt.env)}),qf(Vt),hb(15e3))).pipe(wb(function(ga){return ga!==void 0}),Ga(function(ga){return ga instanceof pb&&_o.warn("Login response timeout, rejoin: %s",zt),Z(ga)}))}},{key:"getSocketLoginObservables",value:function(Vt,zt){var _r=this;return Vt.map(function(_o){return _o.pipe(ca(function(ga){ga.listenerCount("socketUserDrop")===0&&ga.on("socketUserDrop",function(_a){return _r.onUserDrop(_a,ga)})}),Cc(function(ga,_a){return _r.incSeqIfNeeded(ga.env),_r.requestSocketLogin(ga,_a!==0,_a===0?zt:_r.seq)}),pe())})}},{key:"incSeqIfNeeded",value:function(Vt){if(![0,1].includes(Vt))throw new Fa({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[Vt]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[Vt]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var Vt=this.curLoginSockets,zt=-1,_r=Vt==null?0:Vt.length,_o=0,ga=[];++zt<_r;){var _a=Vt[zt];_a&&(ga[_o++]=_a)}return ga}},{key:"emitMessage",value:function(Vt,zt){var _r=Vt.options,_o=Vt.payload,ga=Vt.src,_a=Vt.dst,_l=Vt.instance,_d=Vt.dialogue,_f=Vt.sequence,_m=Vt.ms,tE=Vt.MiscMap;this.dialogueSequenceLru.set(_d.toString(),_f),_l="".concat(_l,"-").concat(_d,"#").concat(_f),this.msgDedupLru.has(_l)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",zt,_l):(this.msgDedupLru.set(_l,void 0),zt=new ae(_r),this.lastLoginSockets.forEach(function(){var rE=J(w.mark(function oE(dE){var nE;return w.wrap(function(sE){for(;;)switch(sE.prev=sE.next){case 0:return sE.next=2,dE.pipe(Ka(1)).toPromise();case 2:nE=sE.sent,e.sendMessageAck(Vt,nE);case 4:case"end":return sE.stop()}},oE)}));return function(oE){return rE.apply(this,arguments)}}()),_r=zt.isZlibCompressed(),zt.isInvitation()?(_a=pa(_r?nl(Xm(_o,Uint8Array.of(0,0,0,0))):_o),_a=JSON.parse(_a),this.log("The received invitation body is %o",_a),this.emit("invitationMessage",{body:_a,type:zt.getInvitationType(),peerId:ga,serverReceivedTs:_m.toNumber()})):zt.isTextMessage()?(tE=zt.isPeerTextMessage(),_o=pa(_r?nl(Xm(_o,Uint8Array.of(0,0,0,0))):_o),this.info("Received a %s %s text message from %s to %s, %s",_r?" compressed":"",tE?"peer":"channel",oa(ga),oa(_a),_l),tE?(ga={text:_o,peerId:ga,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:zt.isFromCache()}},this.emit("peerTextMessage",ga)):this.emit("channelTextMessage",{channelId:_a,memberId:ga,text:_o,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:!1}})):zt.isRawMessage()?(_d=zt.isRawPeerMessage(),tE=(tE=tE.description)===void 0?"":pa(tE),_o=_r?nl(_o):_o,this.info("Received a %s %s raw message from %s to %s, %s",_r?" compressed":"",_d?"peer":"channel",oa(ga),oa(_a),_l),_d?(ga={desc:tE,raw:_o,peerId:ga,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:zt.isFromCache()}},this.emit("peerRawMessage",ga)):this.emit("channelRawMessage",{desc:tE,raw:_o,channelId:_a,memberId:ga,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:!1}})):(zt.isImageMessage()||zt.isFileMessage())&&(_o=zt.isPeerMessage(),this.info("Received a %s media message from %s to %s, %s",_o?"peer":"channel",oa(ga),oa(_a),_l),_o?this.emit("peerMediaMessage",{messageType:zt.isImageMessage()?"IMAGE":"FILE",details:tE,peerId:ga,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:zt.isFromCache()}}):this.emit("channelMediaMessage",{messageType:zt.isImageMessage()?"IMAGE":"FILE",details:tE,memberId:ga,channelId:_a,properties:{serverReceivedTs:_m.toNumber(),isOfflineMessage:zt.isFromCache()}})))}},{key:"onSocketReconnect",value:function(Vt){var zt=this;return function(){var _r=[0,1].filter(function(_o){return _o!==Vt.env})[0];(_r=zt.connection.curOpenSockets[_r])&&!_r.loggedIn&&zt.emit("connectionLost")}}},{key:"onUserDrop",value:function(Vt,zt){var _r;Vt=Vt.code,eb("KickedOff",{code:0,elapse:fb(this.startTime),linkId:parseInt(zt.name.split("-")[1],10),lts:U.fromNumber(Date.now()),server:zt.address,serverCode:Vt,sid:Xa(this.instanceId),userId:this.context.uid},(_r=this.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r),Vt===10006||Vt===10001?this.warn("Login too often and kicked off, reconnect and login"):Vt===10009?(this.warn("The instance ID conflicts, reconnecting"),this.instanceId=Bg(),this.context.sid=Xa(this.instanceId),this.emit("instanceChanged",this.instanceId)):[11,14,15,16].includes(Vt)&&(this.emit("userDrop",Vt),this.clearSockets())}},{key:"clearSockets",value:function(){var Vt=this,zt=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,_r=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(_o){Vt.cleanLoginSubs(_o,_r),Vt.connection.closeSocket(_o,zt)})}},{key:"onMessage",value:function(Vt){var zt=this;return function(_r){var _o=_r.dialogue,ga=_r.instance,_a=_r.sequence,_l=_r.options;if(_r.src===zt.context.uid)zt.log("The message is from the local account, ignored");else{var _d=_o.toString(),_f=zt.dialPendingMsgSubjectMap.get(_d);if(_o="".concat(ga,"-").concat(_o,"#").concat(_a),_f)_f.next(_r),zt.log("Env_%d: The dialogue has pending messages, next: %s",Vt.env,_o);else{var _m=zt.dialogueSequenceLru.get(_d);if(_f=!_m&&_a.eq(1),ga=_m!==void 0&&_a.sub(_m).eq(1),_f||ga)zt.emitMessage(_r,Vt.env);else{if(_m){if(_a.lte(_m))return;zt.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",Vt.env,_o)}else zt.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",Vt.env,_o);_a=new Pa,zt.dialPendingMsgSubjectMap.set(_d,_a);var tE=_a.pipe(Qs(Pk),xg(function(rE,oE){return[].concat(G(rE),[oE])},[]),ba(function(rE){return G(rE).sort(function(oE,dE){return oE=oE.sequence,dE=dE.sequence,oE.eq(dE)?0:oE.gt(dE)?1:-1})}),sm(1));_l=!(_l=new ae(_l)).isFromCache()&&!_l.isBufferedMessage(),tE.pipe(ob(Bc(_l?750:1500)),aa(function(rE){if(2>rE.length)return!1;for(var oE=_m===void 0?U.fromNumber(1,!0):_m.add(1),dE=0;dE<rE.length;oE=oE.add(1),dE++)if(!rE[dE].sequence.eq(oE))return!1;return!0}),wg(function(){zt.dialPendingMsgSubjectMap.delete(_d)})).subscribe(function(rE){rE.forEach(function(oE){zt.emitMessage(oE,Vt.env),zt.log("Env_%d: The message queue has fully ordered, emitting: %s",Vt.env,"".concat(oE.instance,"-").concat(oE.dialogue,"#").concat(oE.sequence))})},function(rE){rE instanceof vg&&tE.pipe(Ka(1)).subscribe(function(oE){return oE.forEach(function(dE){zt.log("Env_%d: The message pending queue expired, emitting: %s",Vt.env,"".concat(dE.instance,"-").concat(dE.dialogue,"#").concat(dE.sequence)),zt.emitMessage(dE,Vt.env)})})}),_a.next(_r)}}}}}},{key:"onGroupEnterNotice",value:function(){var Vt=this;return function(zt){Vt.emit("memberNotice",{channelId:zt.group,seq:zt.seq,instance:zt.instance,memberId:zt.user,type:"MemberJoined",size:zt.size})}}},{key:"onGroupLeaveNotice",value:function(){var Vt=this;return function(zt){Vt.emit("memberNotice",{channelId:zt.group,seq:zt.seq,instance:zt.instance,memberId:zt.user,type:"MemberLeft",size:zt.size})}}},{key:"onGroupCountNotice",value:function(){var Vt=this;return function(zt){Vt.emit("memberNotice",{channelId:zt.group,seq:zt.seq,instance:zt.instance,type:"MemberCountUpdated",size:zt.size})}}},{key:"onGroupAttributeAlt",value:function(){var Vt=this;return function(zt){var _r=zt.group;zt=ff(zt,kD),Vt.emit("channelAttributesUpdated",ua({channelId:_r},zt))}}},{key:"onUserNotice",value:function(Vt){var zt=this;return function(_r){zt.emit("peerOnlineStatusChanged",{peerId:_r.user,instance:_r.instance,seq:_r.seq,state:Vt})}}}],[{key:"sendMessageAck",value:function(Vt,zt){var _r=new ae(Vt.options);(_r.isInvitation()||_r.isPeerMessage())&&zt.sendPacket("Ack",{code:0,dialogue:Vt.dialogue,instance:Vt.instance,sequence:Vt.sequence})}}]),e}(tb());m(ls,"genTimeoutError",function(_,e){return bb(void 0).pipe(cd(e===void 0?1e4:e),ba(function(){throw new db(["Request timed out after %ds",e===void 0?1e4:e],_)}))});var ms,ol,pl=0,ql=0;Ud.v1=function(_,e,j){j=e&&j||0;var Vt=e||[],zt=(_=_||{}).node||ms,_r=_.clockseq!==void 0?_.clockseq:ol;if(zt==null||_r==null){var _o=Jq();zt==null&&(zt=ms=[1|_o[0],_o[1],_o[2],_o[3],_o[4],_o[5]]),_r==null&&(_r=ol=16383&(_o[6]<<8|_o[7]))}_o=_.msecs!==void 0?_.msecs:new Date().getTime();var ga=_.nsecs!==void 0?_.nsecs:ql+1,_a=_o-pl+(ga-ql)/1e4;if(0>_a&&_.clockseq===void 0&&(_r=_r+1&16383),(0>_a||_o>pl)&&_.nsecs===void 0&&(ga=0),1e4<=ga)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(pl=_o,ql=ga,ol=_r,_=(1e4*(268435455&(_o+=122192928e5))+ga)%4294967296,Vt[j++]=_>>>24&255,Vt[j++]=_>>>16&255,Vt[j++]=_>>>8&255,Vt[j++]=255&_,_=_o/4294967296*1e4&268435455,Vt[j++]=_>>>8&255,Vt[j++]=255&_,Vt[j++]=_>>>24&15|16,Vt[j++]=_>>>16&255,Vt[j++]=_r>>>8|128,Vt[j++]=255&_r,_r=0;6>_r;++_r)Vt[j+_r]=zt[_r];return e||Kq(Vt)},Ud.v4=Ud;var rl=Ph(),vd,bf=S.LocalInvitationFailureReason,Ba=S.LocalInvitationState,lD=(vd=function(_){function e(Vt,zt,_r){W(this,e);var _o=j.call(this,_r,"RtmLocalInvitation",!0);return m(n(_o),"state",Ba.IDLE),m(n(_o),"localInvitationEnd$",Ca(gb(n(_o),"LocalInvitationAccepted"),gb(n(_o),"LocalInvitationRefused"),gb(n(_o),"LocalInvitationFailure"),gb(n(_o),"LocalInvitationCanceled")).pipe(Ka(1))),m(n(_o),"callId",Ud.v4()),m(n(_o),"_content",""),m(n(_o),"_channelId",""),m(n(_o),"_response",""),m(n(_o),"calleeId",void 0),m(n(_o),"logger",void 0),m(n(_o),"getSession",void 0),_o.calleeId=Vt,_o.getSession=zt,_o.logger=_r,_o}la(e,_);var j=ma(e);return Ha(e,[{key:"channelId",get:function(){return this._channelId},set:function(Vt){this.state!==Ba.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=Vt)}},{key:"content",get:function(){return this._content},set:function(Vt){this.log("set content for %s",this.callId),this._content=Vt}},{key:"response",get:function(){return this._response},set:function(Vt){throw new I('Cannot set the "response" of the LocalInvitation instance.',xc)}},{key:"send",value:function(){var Vt,zt=this;if(this.state===Ba.SENT_TO_REMOTE||this.state===Ba.RECEIVED_BY_REMOTE)throw new K("The local invitation send failure. The call invitation has already been sent.",gA);if(this.isLocalInvitationEnd())throw new K("The local invitation send failure. The call invitation has ended.",Ih);if(0<this._channelId.length&&!za(this._channelId))throw new I("Illegal invitation channel ID",xc);if(!za(this.calleeId))throw new I("Illegal invitation callee user ID",xc);if(8192<Ig(this._content))throw new I('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',xc);this.state=Ba.SENT_TO_REMOTE,ad(J(w.mark(function _r(){var _o,ga,_a;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:return _l.next=2,zt.getSession().sendInvitationMessage({peerId:zt.calleeId,callId:zt.callId,extra:zt._content,type:"CallInvite",channelId:zt._channelId});case 2:if(_o=_l.sent,ga=_o.hasPeerReceived,_a=_o.hasReSent,!zt.isLocalInvitationEnd()){_l.next=7;break}throw new db("send invitation timeout");case 7:if(zt.log("The local invitation has sent to the callee"),ga||_a){_l.next=11;break}throw Vt=new rl({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(ga){_l.next=14;break}throw Vt=new rl({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return _l.stop()}},_r)}))).pipe(oe(function(_r){return _r.pipe(ca(function(_o){if(!(_o instanceof rl))throw _o}),cd(2e3))}),hb(3e4),Ga(function(_r){return Sa(_r)&&zt.warn("local invitation ack timed out"),Z(_r)}),ob(this.localInvitationEnd$)).subscribe({next:function(){zt.state===Ba.RECEIVED_BY_REMOTE?zt.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):zt.state!==Ba.SENT_TO_REMOTE?zt.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(zt.info("The peer received the local invitation %s.",zt.callId),zt.state=Ba.RECEIVED_BY_REMOTE,zt.emit("LocalInvitationReceivedByPeer"),zt.localInvitationEnd$.pipe(hb(6e4),Ga(function(_r){return Sa(_r)&&zt.warn("local invitation expired"),Z(_r)})).subscribe({error:function(){zt.state=Ba.FAILURE,zt.emit("LocalInvitationFailure",bf.INVITATION_EXPIRE)}}))},error:function(_r){zt.isLocalInvitationEnd()?zt.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(zt.state=Ba.FAILURE,Sa(_r)&&Vt?Vt.code==="PEER_NOT_ONLINE"?zt.emit("LocalInvitationFailure",bf.PEER_OFFLINE):Vt.code==="RESENT_AND_OFFLINE"&&zt.emit("LocalInvitationFailure",bf.PEER_NO_RESPONSE):Sa(_r)?zt.emit("LocalInvitationFailure",bf.PEER_NO_RESPONSE):_r.name==="RtmInvalidStatusError"?zt.emit("LocalInvitationFailure",bf.NOT_LOGGEDIN):zt.emit("LocalInvitationFailure",bf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new K("The local invitation cancel failure",Ih);if(this.state===Ba.IDLE)throw new K("The local invitation has not been sent",fA);if(8192<Ig(this._content))throw new I('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',xc);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Ba.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(Vt){if(this.isLocalInvitationEnd()&&this.state!==Ba.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Ba.IDLE)throw new K("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Ba.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Ba.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Ba.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Ba.ACCEPTED_BY_REMOTE,this._response=Vt,this.emit("LocalInvitationAccepted",Vt))}}},{key:"onRefuseReceived",value:function(Vt){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Ba.IDLE)throw new K("the local have not sent the invitation, how can remote refuse it?");this.state===Ba.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Ba.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=Vt,this.state=Ba.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",Vt)}}},{key:"isLocalInvitationEnd",value:function(){return[Ba.CANCELED,Ba.FAILURE,Ba.ACCEPTED_BY_REMOTE,Ba.REFUSED_BY_REMOTE].includes(this.state)}}]),e}(tb()),fa(vd.prototype,"send",[Nb],Object.getOwnPropertyDescriptor(vd.prototype,"send"),vd.prototype),fa(vd.prototype,"cancel",[Nb],Object.getOwnPropertyDescriptor(vd.prototype,"cancel"),vd.prototype),vd),Rh=S.RemoteInvitationFailureReason,kb=S.RemoteInvitationState,mD=function(_){function e(Vt){var zt=Vt.invitationChannel,_r=Vt.extraContent,_o=Vt.callId,ga=Vt.callerId,_a=Vt.logger;Vt=Vt.getSession,W(this,e);var _l=j.call(this,_a,"RtmRemoteInvitation",!0);return m(n(_l),"state",kb.INVITATION_RECEIVED),m(n(_l),"remoteInvitationEnd$",Ca(gb(n(_l),"RemoteInvitationCanceled"),gb(n(_l),"RemoteInvitationRefused"),gb(n(_l),"RemoteInvitationAccepted"),gb(n(_l),"RemoteInvitationFailure")).pipe(Ka(1))),m(n(_l),"callerId",void 0),m(n(_l),"callId",void 0),m(n(_l),"_getSession",void 0),m(n(_l),"logger",void 0),m(n(_l),"_content",void 0),m(n(_l),"_channelId",void 0),m(n(_l),"_response",""),_l._channelId=zt,_l._content=_r,_l.callId=_o,_l.callerId=ga,_l._getSession=Vt,_l.logger=_a,_l.remoteInvitationEnd$.pipe(hb(6e4),Ga(function(_d){return Sa(_d)&&_l.warn("Remote invitation expired"),Z(_d)})).subscribe({error:function(){_l.state=kb.FAILURE,_l.emit("RemoteInvitationFailure",Rh.INVITATION_EXPIRE)}}),_l}la(e,_);var j=ma(e);return Ha(e,[{key:"channelId",get:function(){return this._channelId},set:function(Vt){throw new I('Cannot set the "response" of the RemoteInvitation instance.',xc)}},{key:"content",get:function(){return this._content},set:function(Vt){throw new I('Cannot set the "content" of the RemoteInvitation instance.',xc)}},{key:"response",get:function(){return this._response},set:function(Vt){this._response=Vt}},{key:"accept",value:function(){var Vt,zt=this;if(this.isRemoteInvitationEnd())throw new K("The local invitation has ended. Cannot accept.",Ih);if(this.state===kb.ACCEPT_SENT_TO_LOCAL)throw new K("The remote invitation is accepting. Cannot do the operation.",Qq);if(8192<Ig(this._response))throw new I('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',xc);this.state=kb.ACCEPT_SENT_TO_LOCAL,Xb(mm(1e3).pipe(cb(function(){return ad(J(w.mark(function _r(){return w.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:return _o.abrupt("return",zt._getSession().sendInvitationMessage({peerId:zt.callerId,callId:zt.callId,extra:zt.response,type:"CallAccept",isAcceptAck:!1,channelId:zt.channelId}));case 1:case"end":return _o.stop()}},_r)})))}),wb(function(_r){return Vt=_r.hasPeerReceived}),Ka(1)),gb(this,"RemoteInvitationAccepted")).pipe(hb(5e3),ob(this.remoteInvitationEnd$)).subscribe({error:function(_r){if(zt.logError(_r),zt.state=kb.FAILURE,Sa(_r))switch(Vt){case void 0:case!0:return void zt.emit("RemoteInvitationFailure",Rh.ACCEPT_FAILURE);case!1:return void zt.emit("RemoteInvitationFailure",Rh.PEER_OFFLINE)}zt.emit("RemoteInvitationFailure",Rh.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===kb.ACCEPT_SENT_TO_LOCAL)throw new K("The remote invitation is accepting. Cannot do the operation.",Qq);if(this.isRemoteInvitationEnd())throw new K("The invitation is end. Cannot refuse",Ih);if(8192<Ig(this._response))throw new I('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',xc);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=kb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(Vt){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===kb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=Vt,this.state=kb.CANCELED,this.emit("RemoteInvitationCanceled",Vt))}},{key:"onAcceptAckReceived",value:function(){this.state!==kb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=kb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[kb.ACCEPTED,kb.REFUSED,kb.CANCELED,kb.FAILURE].includes(this.state)}}]),e}(tb()),nD=function(_){function e(Vt,zt){W(this,e);var _r=j.call(this,zt,"InvitationManager");return m(n(_r),"getSession",void 0),m(n(_r),"invitationDispatcher",new ea.EventEmitter),m(n(_r),"outgoingLocalInvitations",new Map),m(n(_r),"receivedRemoteInvitations",new tc(void 0,{maxlen:1e4})),m(n(_r),"logger",void 0),_r.getSession=cn(Vt),_r.logger=zt,_r.invitationDispatcher.on("remoteInvitationToManager",function(_o){var ga=_o.callId,_a=_o.extra,_l=_o.callerId;_o=_o.channelId,_r.receivedRemoteInvitations.has(ga)||((_a=new mD({callerId:_l,callId:ga,getSession:_r.getSession,logger:zt,extraContent:_a,invitationChannel:_o})).remoteInvitationEnd$.subscribe(function(){_r.receivedRemoteInvitations.delete(ga)}),_r.receivedRemoteInvitations.set(ga,_a),_r.emit("remoteInvitationInstance",_a))}),_r.invitationDispatcher.on("acceptAckToRemoteInvitation",function(_o){(_o=_r.receivedRemoteInvitations.get(_o.callId))&&_o.onAcceptAckReceived()}),_r.invitationDispatcher.on("cancelToRemoteInvitation",function(_o){var ga=_o.extra;(_o=_r.receivedRemoteInvitations.get(_o.callId))&&_o.onCancelReceived(ga)}),_r.invitationDispatcher.on("acceptToLocalInvitation",function(_o){var ga=_o.extra;(_o=_r.outgoingLocalInvitations.get(_o.callId))&&_o.onAcceptReceived(ga)}),_r.invitationDispatcher.on("refuseToLocalInvitation",function(_o){var ga=_o.extra;(_o=_r.outgoingLocalInvitations.get(_o.callId))&&_o.onRefuseReceived(ga)}),_r}la(e,_);var j=ma(e);return Ha(e,[{key:"invitationMessageHandler",value:function(Vt){var zt=Vt.body,_r=zt.callId,_o=zt.extra;_o=_o===void 0?"":_o;var ga=zt.type,_a=(zt=zt.channel)===void 0?"":zt,_l=Vt.type;switch(zt=Vt.peerId,Vt=Vt.serverReceivedTs,_l){case"CallAccept":ga==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:_r}):ga==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:_r,extra:_o});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:_r,callerId:zt,extra:_o,channelId:_a});break;case"CallCancel":if(_r==="0"){_r="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(_a,"_").concat(_o),this.getSession().emit("peerTextMessage",{peerId:zt,properties:{serverReceivedTs:Vt,isOfflineMessage:!1},text:_r});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:_r,extra:_o});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:_r,extra:_o});break;default:throw Im("invitationType",_l)}}},{key:"genLocalInvitation",value:function(Vt){var zt=this,_r=new lD(Vt,this.getSession,this.logger);return _r.localInvitationEnd$.subscribe(function(){zt.outgoingLocalInvitations.delete(_r.callId)}),this.outgoingLocalInvitations.set(_r.callId,_r),_r}}]),e}(tb()),oD=function(_,e,j){var Vt=!0,zt=!0;if(typeof _!="function")throw new TypeError("Expected a function");return lb(j)&&(Vt="leading"in j?!!j.leading:Vt,zt="trailing"in j?!!j.trailing:zt),qC(_,e,{leading:Vt,maxWait:e,trailing:zt})},ub,cf;(function(_){_[_.JOINED=0]="JOINED",_[_.LEFT=1]="LEFT"})(cf||(cf={}));var ns=S.ConnectionState,pD=(ub=function(_){function e(Vt,zt,_r,_o){W(this,e);var ga=j.call(this,_o,"RtmChannel",!0);return m(n(ga),"onMemberCountUpdated",oD(function(_a){_a!==ga.memberCount&&(ga.memberCount=_a,ga.emit("MemberCountUpdated",_a))},1e3)),m(n(ga),"getSession",void 0),m(n(ga),"memberCount",0),m(n(ga),"memberJoinedLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"memberLeftLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"memberJoinStateLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"attributesSeqLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"channelId",void 0),m(n(ga),"client",void 0),m(n(ga),"onAttributesUpdated",function(_a){var _l=_a.channelId,_d=_a.attributeMaps,_f=_a.seq;_a=_a.instance.toString();var _m=ga.attributesSeqLru.get(_a);if((!_m||_f.greaterThan(_m))&&(ga.attributesSeqLru.set(_a,_f),_l===ga.channelId)){for(_l={},_f=0;_f<_d.length;_f++){var tE=_d[_f];_a=tE.key,_m=tE.ms;var rE=tE.value;if(tE=tE.origin,typeof _a!="string"||!U.isLong(_m)||typeof rE!="string"||!za(tE))break;_l[_a]={value:rE,lastUpdateUserId:tE,lastUpdateTs:_m.toNumber()}}ga.emit("AttributesUpdated",_l)}}),m(n(ga),"onChannelTextMessage",function(_a){var _l=_a.memberId,_d=_a.text,_f=_a.properties;_a.channelId===ga.channelId&&ga.emit("ChannelMessage",{text:_d,messageType:S.MessageType.TEXT},_l,_f)}),m(n(ga),"onChannelMediaMessage",function(_a){var _l=_a.memberId,_d=_a.properties,_f=_a.details,_m=_a.messageType;_a.channelId===ga.channelId&&(_m==="FILE"?ga.emit("ChannelMessage",{messageType:S.MessageType.FILE,size:parseInt(pa(_f.media_size),10),description:pa(_f.media_description),fileName:pa(_f.media_filename),mediaId:pa(_f.media_id),thumbnail:new Blob([_f.media_thumbnail])},_l,_d):_m==="IMAGE"&&ga.emit("ChannelMessage",{messageType:S.MessageType.IMAGE,size:parseInt(pa(_f.media_size),10),description:pa(_f.media_description),fileName:pa(_f.media_filename),mediaId:pa(_f.media_id),thumbnail:new Blob([_f.media_thumbnail]),height:parseInt(pa(_f.media_height),10),width:parseInt(pa(_f.media_width),10),thumbnailHeight:parseInt(pa(_f.media_thumbnailheight),10),thumbnailWidth:parseInt(pa(_f.media_thumbnailwidth),10)},_l,_d))}),m(n(ga),"onChannelRawMessage",function(_a){var _l=_a.desc,_d=_a.raw,_f=_a.memberId,_m=_a.properties;_a.channelId===ga.channelId&&ga.emit("ChannelMessage",{messageType:S.MessageType.RAW,rawMessage:_d,description:_l},_f,_m)}),m(n(ga),"onMemberNotice",function(_a){var _l=_a.memberId,_d=_a.type,_f=_a.size;if(_a.channelId===ga.channelId){var _m=_a.instance.toString();_a=_a.seq.toString();var tE={MemberLeft:ga.memberLeftLru,MemberJoined:ga.memberJoinedLru,MemberCountUpdated:void 0}[_d];if(tE){if(tE.has(_m+_a))return void ga.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",_d,_a,oa(ga.channelId),oa(_l||""));if(tE.set(_m+_a,void 0),typeof _l!="string")return;if(_l!==ga.getSession().context.uid&&((_m=ga.memberJoinStateLru.get(_l))===cf.JOINED&&_d==="MemberJoined"||_m===cf.LEFT&&_d==="MemberLeft"))return void ga.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",_d,_a,oa(ga.channelId),oa(_l||""));ga.memberJoinStateLru.set(_l,_d==="MemberJoined"?cf.JOINED:cf.LEFT)}ga.info("Channel %s - %s, memberId: %s",_d,oa(ga.channelId),_d==="MemberCountUpdated"?"[unknown]":oa(_l||"")),_m=_l===ga.getSession().context.uid,_d==="MemberLeft"&&za(_l)||_d==="MemberJoined"&&za(_l)?(_m||ga.emit(_d,_l),ga.onMemberCountUpdated(_f)):_d==="MemberCountUpdated"&&typeof _f=="number"&&ga.onMemberCountUpdated(_f)}}),ga.getSession=cn(zt),ga.channelId=Vt,ga.client=_r,ga.info("A channel created, id %s",oa(Vt)),ga}la(e,_);var j=ma(e);return Ha(e,[{key:"join",value:function(){var Vt=J(w.mark(function zt(){var _r,_o,ga,_a,_l,_d,_f;return w.wrap(function(_m){for(;;)switch(_m.prev=_m.next){case 0:if(za(this.channelId)){_m.next=2;break}throw new I(["The %s in the arguments is invalid","channelId"],hA);case 2:_m.prev=2,_r=this.getSession(),_m.next=9;break;case 6:throw _m.prev=6,_m.t0=_m.catch(2),new K("The client is not logged in. Cannot do the operation",Vq);case 9:if(!_r.joinedChannels.has(this)){_m.next=12;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_r.context.uid,elapse:fb(_r.startTime),errCode:Uq,sid:Xa(_r.instanceId)},(_o=this.client.context.config.enableCloudProxy)!==null&&_o!==void 0&&_o),new K("The channel has joined. Cannot rejoin",Uq);case 12:if(_m.prev=12,this.log("Joining the channel %s",oa(this.channelId)),!this.hasOtherChannelJoined()){_m.next=17;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_r.context.uid,elapse:fb(_r.startTime),errCode:Wq,sid:Xa(_r.instanceId)},(_l=this.client.context.config.enableCloudProxy)!==null&&_l!==void 0&&_l),new K("A channel of the same channel ID has already joined. Cannot rejoin",Wq);case 17:if(_r.joinedChannels.size!==20){_m.next=20;break}throw eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_r.context.uid,elapse:fb(_r.startTime),errCode:Tq,sid:Xa(_r.instanceId)},(_d=this.client.context.config.enableCloudProxy)!==null&&_d!==void 0&&_d),new ib("The joined channels has exceeded the limit of 20",Tq);case 20:return eb("ChnJoin",{cname:this.channelId,lts:U.fromNumber(Date.now()),userId:_r.context.uid,elapse:fb(_r.startTime),errCode:0,sid:Xa(_r.instanceId)},(ga=this.client.context.config.enableCloudProxy)!==null&&ga!==void 0&&ga),_m.next=23,_r.requestChannelJoin(this,this.channelId);case 23:eb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(_r.startTime),errCode:0,sid:Xa(_r.instanceId),serverErrCode:0,userId:_r.context.uid},(_a=this.client.context.config.enableCloudProxy)!==null&&_a!==void 0&&_a),this.info("The channel %s joined successfully",oa(this.channelId)),_r.on("channelTextMessage",this.onChannelTextMessage),_r.on("channelRawMessage",this.onChannelRawMessage),_r.on("channelMediaMessage",this.onChannelMediaMessage),_r.on("memberNotice",this.onMemberNotice),_r.on("channelAttributesUpdated",this.onAttributesUpdated),_m.next=41;break;case 32:if(_m.prev=32,_m.t1=_m.catch(12),this.logError(_m.t1),!sa(_m.t1)){_m.next=37;break}throw _m.t1;case 37:if(!Sa(_m.t1)){_m.next=40;break}throw eb("ChnJoinRes",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(_r.startTime),errCode:Sq,sid:Xa(_r.instanceId),serverErrCode:0,userId:_r.context.uid},(_f=this.client.context.config.enableCloudProxy)!==null&&_f!==void 0&&_f),new db(["Join channel %s timed out",oa(this.channelId)],Sq);case 40:throw new Wc(["The channel %s join failure",oa(this.channelId)],{code:Rq,originalError:_m.t1});case 41:case"end":return _m.stop()}},zt,this,[[2,6],[12,32]])}));return function(){return Vt.apply(this,arguments)}}()},{key:"leave",value:function(){var Vt=J(w.mark(function zt(){var _r,_o,ga,_a;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:_l.prev=0,_o=this.getSession(),_l.next=7;break;case 4:throw _l.prev=4,_l.t0=_l.catch(0),new K("The client is not logged in. Cannot do the operation",jA);case 7:if(_o.joinedChannels.has(this)){_l.next=9;break}throw new K("The channel does not join. Cannot do the operation",iA);case 9:_l.prev=9,_o.requestChannelLeave(this,this.channelId),this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,_o.removeListener("channelTextMessage",this.onChannelTextMessage),_o.removeListener("channelRawMessage",this.onChannelRawMessage),_o.removeListener("channelMediaMessage",this.onChannelMediaMessage),_o.removeListener("memberNotice",this.onMemberNotice),_o.removeListener("channelAttributesUpdated",this.onAttributesUpdated),_l.next=32;break;case 23:if(_l.prev=23,_l.t1=_l.catch(9),this.logError(_l.t1),!sa(_l.t1)){_l.next=30;break}throw _l.t1.code===void 0&&(_l.t1.code=Yq),eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(_o.startTime),errCode:Yq,sid:Xa(_o.instanceId),userId:_o.context.uid},(_a=this.client.context.config.enableCloudProxy)!==null&&_a!==void 0&&_a),_l.t1;case 30:throw eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(_o.startTime),errCode:Xq,sid:Xa(_o.instanceId),userId:_o.context.uid},(ga=this.client.context.config.enableCloudProxy)!==null&&ga!==void 0&&ga),new Wc("The channel leave failure",{code:Xq,originalError:_l.t1});case 32:eb("ChnLeave",{cname:this.channelId,lts:U.fromNumber(Date.now()),elapse:fb(_o.startTime),errCode:0,sid:Xa(_o.instanceId),userId:_o.context.uid},(_r=this.client.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r);case 33:case"end":return _l.stop()}},zt,this,[[0,4],[9,23]])}));return function(){return Vt.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f=this,_m=arguments;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:_o=1<_m.length&&_m[1]!==void 0?_m[1]:{},ga=_o.enableHistoricalMessaging,_a=ga!==void 0&&ga,Tm(_r,Hh),tE.prev=2,_l=this.getSession(),tE.next=9;break;case 6:throw tE.prev=6,tE.t0=tE.catch(2),new K("The client is not logged in. Cannot do the operation",ig);case 9:if(_l.joinedChannels.has(this)){tE.next=11;break}throw new K("The channel does not join. Cannot do the operation",ig);case 11:if(this.client.connectionState!==ns.RECONNECTING){tE.next=16;break}return _d=Date.now(),tE.next=15,new Promise(function(rE,oE){var dE=function(){var sE=J(w.mark(function lE(){var EE;return w.wrap(function(wE){for(;;)switch(wE.prev=wE.next){case 0:return EE=Date.now()-_d,wE.prev=1,wE.next=4,Gg({message:_r,peerId:_f.channelId,toPeer:!1,session:_f.getSession(),errorCodes:{NOT_LOGGED_IN:ig,TOO_OFTEN:Mq},diff:EE,logger:_f.logger,options:{enableHistoricalMessaging:_a,enableOfflineMessaging:!1}});case 4:rE(),wE.next=12;break;case 7:wE.prev=7,wE.t0=wE.catch(1),Sa(wE.t0)&&oE(new db(Yd(_f.name,"sendMessageToPeer",1e4),Yk)),sa(wE.t0)&&oE(wE.t0),oE(new da("Channel message send failure",{code:hg,originalError:wE.t0}));case 12:return wE.prev=12,clearTimeout(nE),wE.finish(12);case 15:case"end":return wE.stop()}},lE,null,[[1,7,12,15]])}));return function(){return sE.apply(this,arguments)}}();_f.client.internalEmitter.once("RECONNECTED",dE);var nE=setTimeout(function(){_f.client.internalEmitter.off("RECONNECTED",dE),oE(new db(Yd(_f.name,"sendMessageToPeer",1e4),Yk))},9e3)});case 15:return tE.abrupt("return");case 16:if(this.client.connectionState===ns.CONNECTED){tE.next=18;break}throw new K("The client is not logged in. Cannot do the operation",ig);case 18:return tE.prev=18,tE.next=21,Gg({message:_r,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:ig,TOO_OFTEN:Mq},diff:0,logger:this.logger,options:{enableHistoricalMessaging:_a,enableOfflineMessaging:!1}});case 21:tE.next=31;break;case 23:if(tE.prev=23,tE.t1=tE.catch(18),!Sa(tE.t1)){tE.next=27;break}throw new db(Yd(this.name,"sendMessage",1e4),Yk);case 27:if(!sa(tE.t1)){tE.next=30;break}throw this.logError(tE.t1),tE.t1;case 30:throw new Wc("The channel message send failure",hg);case 31:case"end":return tE.stop()}},zt,this,[[2,6],[18,23]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"getMembers",value:function(){var Vt=J(w.mark(function zt(){var _r,_o,ga;return w.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:_a.prev=0,_a.prev=1,_r=this.getSession(),_a.next=8;break;case 5:throw _a.prev=5,_a.t0=_a.catch(1),new K("The client is not logged in. Cannot do the operation",eA);case 8:if(_r.joinedChannels.has(this)){_a.next=10;break}throw new K("The channel does not join. Cannot do the operation",dA);case 10:return _o=this.getSession().requestChannelMemberList(this.channelId),_a.next=13,_o.pipe(ba(function(_l){return _l.memberInfos.map(function(_d){return _d.account})})).toPromise();case 13:return ga=_a.sent,this.info("Channel %s - get members success, %o",oa(this.channelId),ga.map(oa)),_a.abrupt("return",ga);case 18:if(_a.prev=18,_a.t1=_a.catch(0),!sa(_a.t1)){_a.next=23;break}throw this.logError(_a.t1),_a.t1;case 23:throw new Wc("The channel members get failure",bA);case 24:case"end":return _a.stop()}},zt,this,[[0,18],[1,5]])}));return function(){return Vt.apply(this,arguments)}}()},{key:"hasOtherChannelJoined",value:function(){var Vt=this;return!this.getSession().joinedChannels.has(this)&&Array.from(this.getSession().joinedChannels).some(function(zt){return zt.channelId===Vt.channelId})}}]),e}(tb()),fa(ub.prototype,"join",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"join"),ub.prototype),fa(ub.prototype,"leave",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"leave"),ub.prototype),fa(ub.prototype,"sendMessage",[Nb],Object.getOwnPropertyDescriptor(ub.prototype,"sendMessage"),ub.prototype),fa(ub.prototype,"getMembers",[Ma],Object.getOwnPropertyDescriptor(ub.prototype,"getMembers"),ub.prototype),ub),E,Eb=S.ConnectionChangeReason,T=S.ConnectionState,os={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},qD={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},rD=(E=function(_){function e(Vt,zt,_r,_o){W(this,e);var ga=j.call(this,zt,"RtmClient",!0);return m(n(ga),"connectionState",T.DISCONNECTED),m(n(ga),"internalEmitter",new ea),m(n(ga),"context",void 0),m(n(ga),"attributes",{}),m(n(ga),"loginPromise",void 0),m(n(ga),"attributeDrafts",new Set),m(n(ga),"session",void 0),m(n(ga),"lastLoginTime",void 0),m(n(ga),"reconnId",0),m(n(ga),"channelAttributesCacheLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"invitationManager",void 0),m(n(ga),"subscribedPeerStatusCache",{}),m(n(ga),"peerStatusSeqLru",new tc(void 0,{maxlen:1e4})),m(n(ga),"peerUnreachableTimers",{}),m(n(ga),"mediaTaskManager",void 0),m(n(ga),"setParameters",void 0),m(n(ga),"updateConfig",void 0),m(n(ga),"userDropHandler",function(_a){if(ga.connectionState!==T.ABORTED)switch(_a){case 11:ga.logError("Kicked off by remote session"),ga.onConnectionStateChanged(T.ABORTED,Eb.REMOTE_LOGIN);break;case 14:case 15:case 16:ga.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[_a])),ga.onConnectionStateChanged(T.ABORTED,Eb.BANNED_BY_SERVER);break;default:ga.logError("User kicked off for unknown code: ".concat(_a)),ga.onConnectionStateChanged(T.ABORTED,Eb.INTERRUPTED)}}),ga.context=new ZC(Vt,_r,zt),ga.mediaTaskManager=new fs(zt),ga.context.config=_r,ga.internalEmitter.setMaxListeners(512),ga.setParameters=_o.bind(n(ga)),ga.updateConfig=_o.bind(n(ga)),ga.invitationManager=new nD(function(){return ga.session},zt),ga.invitationManager.on("remoteInvitationInstance",function(_a){ga.emit("RemoteInvitationReceived",_a)}),ga}la(e,_);var j=ma(e);return Ha(e,[{key:"renewToken",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l=this;return w.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(typeof _r=="string"&&_r.length!==0){_d.next=2;break}throw new I("Invalid argument",rA);case 2:if(this.connectionState!==T.ABORTED){_d.next=5;break}return _d.next=5,new Promise(function(){});case 5:if(this.connectionState===T.CONNECTED||this.connectionState===T.RECONNECTING){_d.next=7;break}throw new K("The client is not logged in",uA);case 7:if(this.session!==void 0){_d.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _d.prev=9,_o=this.context.token,this.context.token=_r,_d.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe(Dd(function(){return Error("No available edge address to connect")}),oe(function(_f){return _f.pipe(ca(function(_m){if(sa(_m))throw _m}),cd(2500),Ka(4))}),Ka(1),hb(2e4),Ga(function(_f){return Sa(_f)&&_l.warn("renewToken timed out"),Z(_f)})).toPromise();case 14:ga=_d.sent,_a=ga.ticket,_d.next=27;break;case 18:if(_d.prev=18,_d.t0=_d.catch(9),this.context.token=_o,_d.t0.code!==$q&&_d.t0.code!==ar){_d.next=23;break}throw new Ye("Invalid token",tA);case 23:if(_d.t0.code!==Kh){_d.next=25;break}throw new Ye("The token expired",sA);case 25:if(!Sa(_d.t0)){_d.next=27;break}throw new db("Renew token timed out",qA);case 27:this.session.curLoginSockets.filter(function(_f){return _f!==void 0}).forEach(function(_f){return _f.ticket=_a});case 28:case"end":return _d.stop()}},zt,this,[[9,18]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a=this;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(this.connectionState===T.CONNECTED){_l.next=2;break}throw new K("The client is not logged in",pA);case 2:if(this.session!==void 0){_l.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(_r)||_r.length===0||_r.some(function(_d){return!za(_d)})||256<_r.length)){_l.next=6;break}throw new I("invalid arguments",er);case 6:return _l.next=8,this.session.requestPeersOnlineStatus(_r).toPromise();case 8:return _o=_l.sent,ga=uc(Jk(_o.userInfos,"account"),function(_d){return!!_d.ts}),Object.keys(ga).forEach(function(_d){if(_d in _a.subscribedPeerStatusCache&&_a.subscribedPeerStatusCache[_d]!==S.PeerOnlineState.UNREACHABLE){var _f=ga[_d]?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE;_a.emit("PeersOnlineStatusChanged",m({},_d,_f)),_a.subscribedPeerStatusCache[_d]=_f}}),_l.abrupt("return",ga);case 12:case"end":return _l.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE=this;return w.wrap(function(rE){for(;;)switch(rE.prev=rE.next){case 0:if(this.connectionState===T.CONNECTED){rE.next=2;break}throw new K("The client is not logged in",aA);case 2:if(this.session!==void 0){rE.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_r)&&_r.every(function(oE){return typeof oE=="string"})&&_r.length!==0){rE.next=6;break}throw new I("Invalid arguments: channelIds",Oq);case 6:if(!(32<_r.length)){rE.next=8;break}throw new I("getChannelMemberCount exceed limit of 32 channelIds",$z);case 8:_o=0;case 9:if(!(_o<_r.length)){rE.next=16;break}if(za(ga=_r[_o])){rE.next=13;break}throw new I(["getChannelMemberCount channel id %s is invalid",ga],Oq);case 13:_o++,rE.next=9;break;case 16:return rE.next=18,this.session.requestGetChannelMemberCount(_r).toPromise();case 18:for(_a=rE.sent,_l=_a.groupInfos,_d={},_f=function(oE){var dE=(oE=_l[oE]).group,nE=oE.memberCount;za(dE)&&typeof nE=="number"&&(tE.session.joinedChannels.forEach(function(sE){sE.channelId===dE&&sE.onMemberCountUpdated(nE)}),_d[dE]=nE)},_m=0;_m<_l.length;_m++)_f(_m);return rE.abrupt("return",_d);case 24:case"end":return rE.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga;return w.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(uf({attributes:_r,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){_a.next=3;break}throw new K("The client is not logged in",Ub);case 3:if(this.session!==void 0){_a.next=5;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _o=this.session.requestSetLocalUserAttributes(_r).toPromise(),ga={attribute:_r,promise:_o},this.attributeDrafts.add(ga),_a.prev=8,_a.next=11,_o;case 11:this.attributes=_r,_a.next=19;break;case 14:if(_a.prev=14,_a.t0=_a.catch(8),!sa(_a.t0)){_a.next=18;break}throw _a.t0;case 18:throw new I("arguments is not valid",Ja);case 19:return _a.prev=19,this.attributeDrafts.delete(ga),_a.finish(19);case 22:case"end":return _a.stop()}},zt,this,[[8,14,19,22]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m=arguments;return w.wrap(function(tE){for(;;)switch(tE.prev=tE.next){case 0:if(ga=2<_m.length&&_m[2]!==void 0?_m[2]:{},_a=ga.enableNotificationToChannelMembers,_l=_a!==void 0&&_a,uf({attributes:_o,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){tE.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){tE.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _d=this.session.requestSetChannelAttributes(_r,_o,_l).toPromise(),tE.prev=7,tE.next=10,_d;case 10:_f=uc(_o,function(rE){return new Blob([rE]).size}),this.channelAttributesCacheLru.set(_r,_f),tE.next=19;break;case 14:if(tE.prev=14,tE.t0=tE.catch(7),!sa(tE.t0)){tE.next=18;break}throw tE.t0;case 18:throw new I("arguments is not valid",Ja);case 19:case"end":return tE.stop()}},zt,this,[[7,14]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(_o=ua(ua({},this.attributes),_r),uf({attributes:_r,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),uf({attributes:_o,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===T.CONNECTED){_l.next=5;break}throw new K("The client is not logged in",Ub);case 5:if(this.session!==void 0){_l.next=7;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return ga=this.session.requestAddOrUpdateLocalUserAttributes(_r).toPromise(),_a={attribute:_o,promise:ga},this.attributeDrafts.add(_a),_l.prev=10,_l.next=13,ga;case 13:this.attributes=_o,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(10),!sa(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new I("arguments is not valid",er);case 21:return _l.prev=21,this.attributeDrafts.delete(_a),_l.finish(21);case 24:case"end":return _l.stop()}},zt,this,[[10,16,21,24]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE=arguments;return w.wrap(function(oE){for(;;)switch(oE.prev=oE.next){case 0:if(ga=2<rE.length&&rE[2]!==void 0?rE[2]:{},_a=ga.enableNotificationToChannelMembers,_l=_a!==void 0&&_a,_d=this.channelAttributesCacheLru.get(_r,{}),_f=uc(_o,function(dE){return new Blob([dE]).size}),_m=ua(ua({},_d),_f),uf({attributes:_o,attrSizeMap:_m,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===T.CONNECTED){oE.next=7;break}throw new K("The client is not logged in",Ub);case 7:if(this.session!==void 0){oE.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return tE=this.session.requestAddOrUpdateChannelAttributes(_r,_o,_l).toPromise(),oE.prev=10,oE.next=13,tE;case 13:this.channelAttributesCacheLru.set(_r,_m),oE.next=21;break;case 16:if(oE.prev=16,oE.t0=oE.catch(10),!sa(oE.t0)){oE.next=20;break}throw oE.t0;case 20:throw new I("arguments is not valid",Ja);case 21:case"end":return oE.stop()}},zt,this,[[10,16]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l;return w.wrap(function(_d){for(;;)switch(_d.prev=_d.next){case 0:if(Array.isArray(_r)&&_r.length!==0&&!_r.some(function(_f){return _f.length===0})){_d.next=2;break}throw new K("arguments is not valid",Ja);case 2:if(this.connectionState===T.CONNECTED){_d.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){_d.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _o=this.session.requestDeleteLocalUserAttributesByKeys(_r).toPromise(),ga={attribute:Gk(this.attributes,_r),promise:_o},this.attributeDrafts.add(ga),_d.prev=9,_d.next=12,_o;case 12:for(_a=0;_a<_r.length;_a++)_l=_r[_a],delete this.attributes[_l];_d.next=20;break;case 15:if(_d.prev=15,_d.t0=_d.catch(9),!sa(_d.t0)){_d.next=19;break}throw _d.t0;case 19:throw new I("arguments is not valid",Ja);case 20:return _d.prev=20,this.attributeDrafts.delete(ga),_d.finish(20);case 23:case"end":return _d.stop()}},zt,this,[[9,15,20,23]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE=arguments;return w.wrap(function(oE){for(;;)switch(oE.prev=oE.next){case 0:if(ga=2<rE.length&&rE[2]!==void 0?rE[2]:{},_a=ga.enableNotificationToChannelMembers,_l=_a!==void 0&&_a,Array.isArray(_o)&&_o.length!==0&&za(_r)&&!_o.some(function(dE){return dE.length===0||512<dE.length})){oE.next=3;break}throw new K("arguments is not valid",Ja);case 3:if(this.connectionState===T.CONNECTED){oE.next=5;break}throw new K("The client is not logged in",Ub);case 5:if(this.session!==void 0){oE.next=7;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _d=this.session.requestDeleteChannelAttributesByKeys(_r,_o,_l).toPromise(),oE.prev=8,oE.next=11,_d;case 11:if(_f=this.channelAttributesCacheLru.get(_r))for(_m=0;_m<_o.length;_m++)tE=_o[_m],delete _f[tE];oE.next=20;break;case 15:if(oE.prev=15,oE.t0=oE.catch(8),!sa(oE.t0)){oE.next=19;break}throw oE.t0;case 19:throw new I("arguments is not valid",Ja);case 20:case"end":return oE.stop()}},zt,this,[[8,15]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var Vt=J(w.mark(function zt(){var _r,_o;return w.wrap(function(ga){for(;;)switch(ga.prev=ga.next){case 0:if(this.connectionState===T.CONNECTED){ga.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){ga.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _r=this.session.requestClearLocalUserAttributes().toPromise(),_o={attribute:{},promise:_r},this.attributeDrafts.add(_o),ga.prev=7,ga.next=10,_r;case 10:this.attributes={},ga.next=18;break;case 13:if(ga.prev=13,ga.t0=ga.catch(7),!sa(ga.t0)){ga.next=17;break}throw ga.t0;case 17:throw new I("arguments is not valid",Ja);case 18:return ga.prev=18,this.attributeDrafts.delete(_o),ga.finish(18);case 21:case"end":return ga.stop()}},zt,this,[[7,13,18,21]])}));return function(){return Vt.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d=arguments;return w.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:if(_o=1<_d.length&&_d[1]!==void 0?_d[1]:{},ga=_o.enableNotificationToChannelMembers,_a=ga!==void 0&&ga,this.connectionState===T.CONNECTED){_f.next=3;break}throw new K("The client is not logged in",Ub);case 3:if(this.session!==void 0){_f.next=5;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _l=this.session.requestClearChannelAttributes(_r,_a).toPromise(),_f.prev=6,_f.next=9,_l;case 9:this.channelAttributesCacheLru.delete(_r),_f.next=17;break;case 12:if(_f.prev=12,_f.t0=_f.catch(6),!sa(_f.t0)){_f.next=16;break}throw _f.t0;case 16:throw new I("arguments is not valid",Ja);case 17:case"end":return _f.stop()}},zt,this,[[6,12]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a;return w.wrap(function(_l){for(;;)switch(_l.prev=_l.next){case 0:if(za(_r)){_l.next=2;break}throw new I("Not a valid user ID",Ja);case 2:if(this.connectionState===T.CONNECTED){_l.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){_l.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _l.prev=6,_l.next=9,this.session.requestGetUserAttributeKeys(_r).toPromise();case 9:return _o=_l.sent,ga=_o.keys,_l.next=13,this.session.requestGetUserAttributesByKeys(_r,ga.slice(0,512)).toPromise();case 13:_a=_l.sent,_l.next=21;break;case 16:if(_l.prev=16,_l.t0=_l.catch(6),!sa(_l.t0)){_l.next=20;break}throw _l.t0;case 20:throw new I("arguments is not valid",Ja);case 21:return _l.abrupt("return",Yp(_a.attributeInfos.map(function(_d){return[_d.key,_d.value]})));case 22:case"end":return _l.stop()}},zt,this,[[6,16]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE;return w.wrap(function(nE){for(;;)switch(nE.prev=nE.next){case 0:if(za(_r)){nE.next=2;break}throw new I("Not a valid channel ID",Ja);case 2:if(this.connectionState===T.CONNECTED){nE.next=4;break}throw new K("The client is not logged in",Ub);case 4:if(this.session!==void 0){nE.next=6;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return nE.prev=6,nE.next=9,this.session.requestGetChannelAttributesKeys(_r).toPromise();case 9:return _o=nE.sent,ga=_o.keys,nE.next=13,this.session.requestGetChannelAttributesByKeys(_r,ga).toPromise();case 13:_a=nE.sent,_l=_a.attributeMaps,nE.next=22;break;case 17:if(nE.prev=17,nE.t0=nE.catch(6),!sa(nE.t0)){nE.next=21;break}throw nE.t0;case 21:throw new I("arguments is not valid",Ja);case 22:_d={},_f=0;case 24:if(!(_f<_l.length)){nE.next=32;break}if(_m=_l[_f],tE=_m.key,rE=_m.ms,oE=_m.value,dE=_m.origin,typeof tE=="string"&&U.isLong(rE)&&typeof oE=="string"&&za(dE)){nE.next=28;break}return nE.abrupt("break",32);case 28:_d[tE]={value:oE,lastUpdateUserId:dE,lastUpdateTs:rE.toNumber()};case 29:_f++,nE.next=24;break;case 32:return this.channelAttributesCacheLru.set(_r,uc(_d,function(sE){return new Blob([sE.value]).size})),nE.abrupt("return",_d);case 34:case"end":return nE.stop()}},zt,this,[[6,17]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE,rE,oE,dE;return w.wrap(function(nE){for(;;)switch(nE.prev=nE.next){case 0:if(this.connectionState===T.CONNECTED){nE.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){nE.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Hm(_r,_o),nE.prev=5,nE.next=8,this.session.requestGetChannelAttributesByKeys(_r,_o).toPromise();case 8:ga=nE.sent,_a=ga.attributeMaps,nE.next=17;break;case 12:if(nE.prev=12,nE.t0=nE.catch(5),!sa(nE.t0)){nE.next=16;break}throw nE.t0;case 16:throw new I("arguments is not valid",Ja);case 17:_l={},_d=this.channelAttributesCacheLru.get(_r,{}),_f=0;case 20:if(!(_f<_a.length)){nE.next=29;break}if(_m=_a[_f],tE=_m.key,rE=_m.ms,oE=_m.value,dE=_m.origin,typeof tE=="string"&&U.isLong(rE)&&typeof oE=="string"&&za(dE)){nE.next=24;break}return nE.abrupt("break",29);case 24:_d[tE]=new Blob([oE]).size,_l[tE]={value:oE,lastUpdateUserId:dE,lastUpdateTs:rE.toNumber()};case 26:_f++,nE.next=20;break;case 29:return this.channelAttributesCacheLru.set(_r,_d),nE.abrupt("return",_l);case 31:case"end":return nE.stop()}},zt,this,[[5,12]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga;return w.wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(this.connectionState===T.CONNECTED){_a.next=2;break}throw new K("The client is not logged in",Ub);case 2:if(this.session!==void 0){_a.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Hm(_r,_o),_a.prev=5,_a.next=8,this.session.requestGetUserAttributesByKeys(_r,_o).toPromise();case 8:ga=_a.sent,_a.next=16;break;case 11:if(_a.prev=11,_a.t0=_a.catch(5),!sa(_a.t0)){_a.next=15;break}throw _a.t0;case 15:throw new I("arguments is not valid",Ja);case 16:return _a.abrupt("return",Yp(ga.attributeInfos.map(function(_l){return[_l.key,_l.value]})));case 17:case"end":return _a.stop()}},zt,this,[[5,11]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"login",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d=this;return w.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:if(Uk=!0,_o=Bg(),ga=_r.token,_r.token===this.context.appId&&(ga=void 0),setTimeout(function(){var _m;eb("Session",{appId:_d.context.appId,did:navigator.userAgent,elapse:fb(_d.session&&_d.session.startTime),index:{index1:_r.uid,index2:_d.context.appId,index3:"enableLogUpload=".concat(_d.context.config.enableLogUpload)},installId:gg,lts:U.fromNumber(Date.now()),os:7,sid:Xa(_o),token:ga||"",userId:_r.uid,ver:"1.4.3-203",buildno:603,subVersion:203,version:4},(_m=_d.context.config.enableCloudProxy)!==null&&_m!==void 0&&_m)},1e4),yd(_r)&&za(_r.uid)){_f.next=7;break}throw new I("not a valid user id",Jh);case 7:if(typeof ga!="string"||!ga){_f.next=11;break}this.context.token=ga,_f.next=13;break;case 11:if(typeof ga=="string"||ga==null){_f.next=13;break}throw new I('The "token" is not a valid string.',Jh);case 13:return _a=Date.now(),this.context.sid=Xa(_o),this.loginPromise=this.loginImpl({uid:_r.uid,instanceId:_o}),this.info("RTM Client logging in as ".concat(oa(_r.uid))),_f.prev=17,_f.next=20,this.loginPromise;case 20:_f.next=27;break;case 22:throw _f.prev=22,_f.t0=_f.catch(17),sa(_f.t0)&&eb("Link",{ackedServerIp:"",destServerIp:"",ec:_f.t0.code||1,sc:_f.t0.serverCode,elapse:fb(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),responseTime:Date.now()-_a,sid:Xa(_o),userId:_r.uid},(_l=this.context.config.enableCloudProxy)!==null&&_l!==void 0&&_l),this.context.token=void 0,_f.t0;case 27:return _f.prev=27,this.loginPromise=void 0,_f.finish(27);case 30:Uk=!1;case 31:case"end":return _f.stop()}},zt,this,[[17,22,27,30]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"logout",value:function(){var Vt=J(w.mark(function zt(){var _r;return w.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:if(!this.loginPromise){_o.next=3;break}return _o.next=3,this.loginPromise;case 3:if(this.connectionState!==T.DISCONNECTED){_o.next=6;break}throw this.logError("Already in logout state"),new K("Logout failure. The client has already been logged out",br);case 6:if(this.connectionState!==T.ABORTED){_o.next=10;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),_o.abrupt("return");case 10:if(this.session!==void 0){_o.next=13;break}return this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),_o.abrupt("return");case 13:return eb("Logout",{elapse:fb(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Xa(this.session.instanceId),userId:this.context.uid},(_r=this.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r),_o.next=16,this.session.logoutHandler();case 16:this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT),this.log("Log out success");case 18:case"end":return _o.stop()}},zt,this)}));return function(){return Vt.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var Vt,zt=this;if(this.connectionState===T.DISCONNECTED)throw this.logError("Already in logout state"),new K("Logout failure. The client has already been logged out",br);this.connectionState===T.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&(eb("Logout",{elapse:fb(this.session.startTime),lts:U.fromNumber(Date.now()),sid:Xa(this.session.instanceId),userId:this.context.uid},(Vt=this.context.config.enableCloudProxy)!==null&&Vt!==void 0&&Vt),this.session.logoutHandler().then(function(){zt.log("Log out success")})),this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var Vt=J(w.mark(function zt(_r,_o){var ga,_a,_l,_d,_f,_m,tE=this,rE=arguments;return w.wrap(function(oE){for(;;)switch(oE.prev=oE.next){case 0:if(ga=2<rE.length&&rE[2]!==void 0?rE[2]:{},_a=ga.enableOfflineMessaging,_l=_a!==void 0&&_a,_d=ga.enableHistoricalMessaging,_f=_d!==void 0&&_d,Tm(_r,ve),this.connectionState!==T.RECONNECTING){oE.next=5;break}return _m=Date.now(),oE.abrupt("return",new Promise(function(dE,nE){var sE=function(){var EE=J(w.mark(function wE(){var IE;return w.wrap(function(_E){for(;;)switch(_E.prev=_E.next){case 0:if(tE.session!==void 0){_E.next=2;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return IE=Date.now()-_m,_E.prev=3,_E.t0=dE,_E.next=7,Gg({message:_r,peerId:_o,toPeer:!0,session:tE.session,errorCodes:{NOT_LOGGED_IN:al,TOO_OFTEN:dr},diff:IE,logger:tE.logger,options:{enableHistoricalMessaging:_f,enableOfflineMessaging:_l}});case 7:_E.t1=_E.sent,(0,_E.t0)(_E.t1),_E.next=16;break;case 11:_E.prev=11,_E.t2=_E.catch(3),Sa(_E.t2)&&nE(new db(Yd(tE.name,"sendMessageToPeer",1e4),Zk)),sa(_E.t2)&&nE(_E.t2),nE(new da("Peer-to-peer message send failure",{code:cr,originalError:_E.t2}));case 16:return _E.prev=16,clearTimeout(lE),_E.finish(16);case 19:case"end":return _E.stop()}},wE,null,[[3,11,16,19]])}));return function(){return EE.apply(this,arguments)}}();tE.internalEmitter.once("RECONNECTED",sE);var lE=setTimeout(function(){tE.internalEmitter.off("RECONNECTED",sE),nE(new db(Yd(tE.name,"sendMessageToPeer",1e4),Zk))},9e3)}));case 5:if(this.connectionState===T.CONNECTED){oE.next=7;break}throw new K("Failed to send the peer-to-peer message. The client is not logged in",al);case 7:if(this.session!==void 0){oE.next=9;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return oE.prev=9,oE.next=12,Gg({message:_r,peerId:_o,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:al,TOO_OFTEN:dr},diff:0,logger:this.logger,options:{enableHistoricalMessaging:_f,enableOfflineMessaging:_l}});case 12:return oE.abrupt("return",oE.sent);case 15:if(oE.prev=15,oE.t0=oE.catch(9),!Sa(oE.t0)){oE.next=19;break}throw new db(Yd(this.name,"sendMessageToPeer",1e4),Zk);case 19:if(!sa(oE.t0)){oE.next=21;break}throw oE.t0;case 21:throw new da("Peer-to-peer message send failure",{code:cr,originalError:oE.t0});case 22:case"end":return oE.stop()}},zt,this,[[9,15]])}));return function(zt,_r){return Vt.apply(this,arguments)}}()},{key:"createChannel",value:function(Vt){var zt=this;if(!za(Vt))throw new I(["The %s in the arguments is invalid",Object.keys({channelId:Vt})[0]],Zz);return new pD(Vt,function(){return zt.session},this,this.logger)}},{key:"createLocalInvitation",value:function(Vt){if(!za(Vt))throw new I(["The %s in the arguments is invalid",Object.keys({calleeId:Vt})[0]],xc);return this.invitationManager.genLocalInvitation(Vt)}},{key:"subscribePeersOnlineStatus",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE,lE=this;return w.wrap(function(EE){for(;;)switch(EE.prev=EE.next){case 0:if(this.connectionState===T.CONNECTED){EE.next=2;break}throw new K("The client is not logged in",bl);case 2:if(this.session!==void 0){EE.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_r)&&_r.length!==0){EE.next=6;break}throw new I("Invalid arguments: peerIds",kg);case 6:_o=0;case 7:if(!(_o<_r.length)){EE.next=14;break}if(za(ga=_r[_o])){EE.next=11;break}throw new I(["subscribePeersOnlineStatus peer id %s is invalid",ga],kg);case 11:_o++,EE.next=7;break;case 14:if(!(512<(_a=_r&&_r.length?vk(_r):[]).length+Object.keys(this.subscribedPeerStatusCache).length)){EE.next=17;break}throw new ib("Subscribed peers overflows",gr);case 17:return EE.next=19,this.session.requestSubscribePeersOnlineStatus(_a).toPromise();case 19:_l=EE.sent,_d=_l.errors,_f=[],_m=[],tE=0;case 24:if(!(tE<_d.length)){EE.next=32;break}if(rE=_d[tE],oE=rE.code,typeof(dE=rE.account)=="string"){EE.next=28;break}throw new da("Returned account is invalid",fr);case 28:oE!==0&&_f.push(dE);case 29:tE++,EE.next=24;break;case 32:for(nE=0;nE<_a.length;nE++)sE=_a[nE],_f.includes(sE)||(_m.push(sE),this.subscribedPeerStatusCache[sE]=void 0);if(this.session.requestPeersOnlineStatus(_m).pipe(ba(function(wE){return uc(Jk(wE.userInfos,"account"),function(IE){return!!IE.ts})})).subscribe(function(wE){wE=uc(wE,function(IE,_E){return IE=IE?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,lE.subscribedPeerStatusCache[_E]=IE}),lE.emit("PeersOnlineStatusChanged",wE)}),_f.length===0){EE.next=36;break}throw new da("Subscription failed",fr);case 36:case"end":return EE.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d;return w.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:if(this.connectionState===T.CONNECTED){_f.next=2;break}throw new K("The client is not logged in",bl);case 2:if(this.session!==void 0){_f.next=4;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_r)&&_r.length!==0){_f.next=6;break}throw new I("Invalid arguments: peerIds",kg);case 6:_o=0;case 7:if(!(_o<_r.length)){_f.next=14;break}if(za(ga=_r[_o])){_f.next=11;break}throw new I(["subscribePeersOnlineStatus peer id %s is invalid",ga],kg);case 11:_o++,_f.next=7;break;case 14:if(!(512<_r.length)){_f.next=16;break}throw new ib("Unsubscribed peers overflows",gr);case 16:for(_a=_r&&_r.length?vk(_r):[],this.session.requestUnsubscribePeersOnlineStatus(_a),_l=0;_l<_a.length;_l++)_d=_a[_l],delete this.subscribedPeerStatusCache[_d];case 19:case"end":return _f.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var Vt=J(w.mark(function zt(_r){return w.wrap(function(_o){for(;;)switch(_o.prev=_o.next){case 0:if(this.connectionState===T.CONNECTED){_o.next=2;break}throw new K("The client is not logged in",bl);case 2:if(_r!==S.PeerSubscriptionOption.ONLINE_STATUS){_o.next=4;break}return _o.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new I("Subscription option not supported",kg);case 5:case"end":return _o.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"createMessage",value:function(Vt){return Vt.messageType==="IMAGE"?ua({width:0,height:0,fileName:"",description:"",thumbnail:new Blob,thumbnailWidth:0,thumbnailHeight:0,size:0},Vt):Vt.messageType==="FILE"?ua({fileName:"",description:"",thumbnail:new Blob,size:0},Vt):Vt}},{key:"downloadMedia",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE,lE,EE=this,wE=arguments;return w.wrap(function(IE){for(;;)switch(IE.prev=IE.next){case 0:if(_o=1<wE.length&&wE[1]!==void 0?wE[1]:{},typeof _r=="string"){IE.next=3;break}throw new I("invalid mediaId format",cl);case 3:if(IE.prev=3,ga=_r.split("z"),_a=ra(ga,3),_l=_a[0],_d=_a[1],_f=_a[2],_m=_l.slice(1,65),tE=bD(_m),rE=parseInt(_l.slice(65),10),oE=parseInt(_d,10),dE=parseInt(_f,10),!(Number.isNaN(rE)||Number.isNaN(oE)||Number.isNaN(dE))){IE.next=12;break}throw new I("Invalid mediaId content",cl);case 12:IE.next=19;break;case 14:if(IE.prev=14,IE.t0=IE.catch(3),!sa(IE.t0)){IE.next=18;break}throw IE.t0;case 18:throw new I("parse mediaId failure",{code:cl,originalError:IE.t0});case 19:if(this.connectionState===T.CONNECTED){IE.next=21;break}throw new K("The client is not logged in, cannot download",CA);case 21:if(this.session!==void 0){IE.next=23;break}throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});case 23:return nE=this.mediaTaskManager.addDownloadTask({unit:oE,zone:rE,hashHexStr:_m,size:dE},function(){if(EE.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return EE.session.requestFileDownloadIndexGet({hash:tE,zone:rE,unit:oE,size:dE}).toPromise()},_o),IE.next=26,this.mediaTaskManager.waitMediaTask(nE);case 26:return sE=IE.sent,lE=sE.payload,IE.abrupt("return",lE);case 29:case"end":return IE.stop()}},zt,this,[[3,14]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"createMediaMessageByUploading",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d,_f,_m,tE,rE,oE,dE,nE,sE,lE,EE,wE,IE,_E,kE,ME,bE,LE,TE,OE,vE=this,NE=arguments;return w.wrap(function(jE){for(;;)switch(jE.prev=jE.next){case 0:if(_o=1<NE.length&&NE[1]!==void 0?NE[1]:{},ga=2<NE.length&&NE[2]!==void 0?NE[2]:{},yd(_o)){jE.next=4;break}throw new I("Invalid params",wf);case 4:if(_a="thumbnailWidth"in _o||"thumbnailHeight"in _o||"width"in _o||"height"in _o,_l=_o.messageType,_d=_l===void 0?_a?"IMAGE":"FILE":_l,_f=_o.description,_m=_f===void 0?"":_f,tE=_o.fileName,rE=tE===void 0?"":tE,oE=_o.thumbnail,typeof _o.messageType=="string"&&typeof _m=="string"&&typeof rE=="string"&&(Pm(oE)||oE===void 0)&&Pm(_r)){jE.next=8;break}throw new I("Invalid message params type",wf);case 8:if(!_a||_d!=="FILE"){jE.next=10;break}throw new I("Invalid message params, unexpected field in RtmFileMessage",wf);case 10:if(!(33554432<(dE=_r.size))){jE.next=13;break}throw new ib("The payload size overflow 32 MB",wA);case 13:return jE.next=15,Ji(_r);case 15:return nE=jE.sent,jE.next=18,aD(nE);case 18:if(sE=jE.sent,this.connectionState===T.CONNECTED){jE.next=21;break}throw new K("The client is not logged in",yA);case 21:if(_d!=="IMAGE"){jE.next=29;break}return jE.next=24,Xt(_o,nE);case 24:lE=jE.sent,EE=lE.height,wE=lE.width,IE=lE.thumbnailWidth,_E=lE.thumbnailHeight;case 29:return kE=this.mediaTaskManager.addUploadTask({file:new Uint8Array(nE),hash:sE},function(){if(vE.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return vE.session.fetchFileUploadIndexGet({hash:sE,size:dE})},function(UE,RE){if(vE.session===void 0)throw new Fa({SESSION_NOT_FOUND:"Failed to get session of the client"});return vE.session.requestFileUploadIndexSet({hash:sE,unit:UE,servers:RE}).toPromise()},ga),jE.next=32,this.mediaTaskManager.waitMediaTask(kE);case 32:if(ME=jE.sent,bE=ME.zone,LE=ME.retUnit,_d!=="IMAGE"){jE.next=38;break}return TE={height:EE,width:wE,fileName:rE,size:dE,description:_m,thumbnail:oE,messageType:_d,thumbnailWidth:IE,thumbnailHeight:_E,mediaId:"0".concat($r(sE)).concat(bE,"z").concat(LE,"z").concat(dE,"z").concat(EE,"z").concat(wE)},jE.abrupt("return",TE);case 38:return OE={fileName:rE,size:dE,description:_m,mediaId:"0".concat($r(sE)).concat(bE,"z").concat(LE,"z").concat(dE),thumbnail:oE,messageType:_d},jE.abrupt("return",OE);case 40:case"end":return jE.stop()}},zt,this)}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var Vt=J(w.mark(function zt(_r){var _o,ga,_a,_l,_d=this;return w.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:if(_o=_r.uid,ga=_r.instanceId,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){_f.next=4;break}throw new rC(["The frequency of login exceeded the limit of %d queries per second",2],mA);case 4:if(this.connectionState===T.DISCONNECTED){_f.next=6;break}throw new K("The SDK is either logging in or has logged in the Agora RTM system",kA);case 6:_f.prev=6,this.context.uid=_o,_f.next=13;break;case 10:throw _f.prev=10,_f.t0=_f.catch(6),new I(["The %s in the arguments is invalid",Object.keys({uid:_o})[0]],Jh);case 13:return this.onConnectionStateChanged(T.CONNECTING,Eb.LOGIN),this.session=_a=new ls(this.context,new Yr(this.context,this.logger,!1),ga,this.logger),_l=function(){_d.connectionState===T.CONNECTED&&(_d.onConnectionStateChanged(T.RECONNECTING,Eb.INTERRUPTED),_d.session)&&_d.session.once("userJoined",function(){_d.onConnectionStateChanged(T.CONNECTED,Eb.LOGIN_SUCCESS)})},_a.on("connectionLost",_l),_a.on("tokenExpired",function(){_d.emit("TokenExpired")}),_a.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(_m){_d.emit("MessageFromPeer",{text:_m.text,messageType:S.MessageType.TEXT},_m.peerId,_m.properties)}),this.session.on("peerMediaMessage",function(_m){var tE=_m.peerId,rE=_m.properties,oE=_m.messageType;_m=_m.details,oE==="FILE"?_d.emit("MessageFromPeer",{messageType:S.MessageType.FILE,size:parseInt(pa(_m.media_size),10),description:pa(_m.media_description),fileName:pa(_m.media_filename),mediaId:pa(_m.media_id),thumbnail:new Blob([_m.media_thumbnail])},tE,rE):oE==="IMAGE"&&_d.emit("MessageFromPeer",{messageType:S.MessageType.IMAGE,size:parseInt(pa(_m.media_size),10),description:pa(_m.media_description),fileName:pa(_m.media_filename),mediaId:pa(_m.media_id),thumbnail:new Blob([_m.media_thumbnail]),height:parseInt(pa(_m.media_height),10),width:parseInt(pa(_m.media_width),10),thumbnailHeight:parseInt(pa(_m.media_thumbnailheight),10),thumbnailWidth:parseInt(pa(_m.media_thumbnailwidth),10)},tE,rE)}),this.session.on("peerRawMessage",function(_m){_d.emit("MessageFromPeer",{rawMessage:_m.raw,description:_m.desc,messageType:S.MessageType.RAW},_m.peerId,_m.properties)}),_a.on("instanceChanged",function(_m){return ga=_m}),_a.on("peerOnlineStatusChanged",function(_m){var tE=_m.instance.toString()+_m.state,rE=_d.peerStatusSeqLru.get(tE);!rE||_m.seq.greaterThan(rE)?(_d.peerStatusSeqLru.set(tE,_m.seq),_m.state!==_d.subscribedPeerStatusCache[_m.peerId]&&_d.emit("PeersOnlineStatusChanged",m({},_m.peerId,_m.state)),_d.subscribedPeerStatusCache[_m.peerId]=_m.state,clearTimeout(_d.peerUnreachableTimers[tE]),_m.state===S.PeerOnlineState.UNREACHABLE&&(_d.peerUnreachableTimers[tE]=setTimeout(function(){_d.subscribedPeerStatusCache[_m.peerId]===S.PeerOnlineState.UNREACHABLE&&(_d.subscribedPeerStatusCache[_m.peerId]=S.PeerOnlineState.ONLINE,_d.emit("PeersOnlineStatusChanged",m({},_m.peerId,S.PeerOnlineState.ONLINE)))},3e4))):_d.log("peerOnlineStatusChanged dedup for %s, %d",tE,_m.seq.toNumber())}),_a.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),_a.on("channelAttributesUpdated",function(_m){var tE=_m.channelId;_m=_m.attributeMaps;for(var rE={},oE=0;oE<_m.length;oE++){var dE=_m[oE],nE=dE.key,sE=dE.ms,lE=dE.value;if(dE=dE.origin,typeof nE!="string"||!U.isLong(sE)||typeof lE!="string"||!za(dE))break;rE[nE]=new Blob([lE]).size}_d.channelAttributesCacheLru.set(tE,rE)}),_a.on("userJoined",function(_m){if(Object.keys(_d.attributes).length!==0){if(_d.session===void 0)return;_d.session.requestSetLocalUserAttributes(_d.attributes,_m).toPromise()}if(_d.attributeDrafts.size!==0)for(var tE=function(dE,nE){var sE=(dE=nE[dE]).attribute;dE.promise.then(function(){_d.session!==void 0&&_d.session.requestSetLocalUserAttributes(sE,_m).toPromise()})},rE=0,oE=Array.from(_d.attributeDrafts);rE<oE.length;rE++)tE(rE,oE);Object.keys(_d.subscribedPeerStatusCache).length!==0&&_a.requestSubscribePeersOnlineStatus(Object.keys(_d.subscribedPeerStatusCache))}),this.lastLoginTime=Date.now(),_f.prev=29,_f.next=32,_a.loginHandler().toPromise();case 32:this.mediaTaskManager.setAuthInfo({ticket:_a.connection.curOpenSockets.filter(function(_m){return _m!==void 0})[0].ticket,instance:_a.instanceId,useNewDomain:.5<=Math.random(),loginOpt:_a.userJoinOptions.toLong()}),_f.next=44;break;case 35:if(_f.prev=35,_f.t1=_f.catch(29),!Sa(_f.t1)){_f.next=40;break}throw this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGIN_TIMEOUT),new db(Yd(this.name,"login",2e4),lA);case 40:if(this.onConnectionStateChanged(T.DISCONNECTED,Eb.LOGIN_FAILURE),!sa(_f.t1)){_f.next=43;break}throw _f.t1;case 43:throw new da("Login failure",{code:Zq,originalError:_f.t1});case 44:this.onConnectionStateChanged(T.CONNECTED,Eb.LOGIN_SUCCESS);case 45:case"end":return _f.stop()}},zt,this,[[6,10],[29,35]])}));return function(zt){return Vt.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(Vt,zt){var _r,_o=this;Vt===T.RECONNECTING&&(this.reconnId+=1),eb("ConnectionStateChange",{elapse:fb(this.session&&this.session.startTime),lts:U.fromNumber(Date.now()),newState:os[Vt],oldState:os[this.connectionState],reason:qD[zt],sid:Xa(this.session&&this.session.instanceId||U.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(_r=this.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r),this.connectionState===T.RECONNECTING&&Vt===T.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(ba(function(ga){return uc(Jk(ga.userInfos,"account"),function(_a){return!!_a.ts})})).subscribe(function(ga){ga=uc(ga,function(_a,_l){return _a=_a?S.PeerOnlineState.ONLINE:S.PeerOnlineState.OFFLINE,_o.subscribedPeerStatusCache[_l]=_a}),_o.emit("PeersOnlineStatusChanged",ga)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=Vt,Vt!==T.ABORTED&&Vt!==T.DISCONNECTED||(this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.joinedChannels.clear(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.session=void 0,this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.mediaTaskManager.emit("connectionStateChanged",Vt),this.emit("ConnectionStateChanged",Vt,zt)}}]),e}(tb()),fa(E.prototype,"renewToken",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"renewToken"),E.prototype),fa(E.prototype,"queryPeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersOnlineStatus"),E.prototype),fa(E.prototype,"getChannelMemberCount",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelMemberCount"),E.prototype),fa(E.prototype,"setLocalUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"setLocalUserAttributes"),E.prototype),fa(E.prototype,"setChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"setChannelAttributes"),E.prototype),fa(E.prototype,"addOrUpdateLocalUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateLocalUserAttributes"),E.prototype),fa(E.prototype,"addOrUpdateChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"addOrUpdateChannelAttributes"),E.prototype),fa(E.prototype,"deleteLocalUserAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"deleteLocalUserAttributesByKeys"),E.prototype),fa(E.prototype,"deleteChannelAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"deleteChannelAttributesByKeys"),E.prototype),fa(E.prototype,"clearLocalUserAttributes",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"clearLocalUserAttributes"),E.prototype),fa(E.prototype,"clearChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"clearChannelAttributes"),E.prototype),fa(E.prototype,"getUserAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributes"),E.prototype),fa(E.prototype,"getChannelAttributes",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributes"),E.prototype),fa(E.prototype,"getChannelAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getChannelAttributesByKeys"),E.prototype),fa(E.prototype,"getUserAttributesByKeys",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"getUserAttributesByKeys"),E.prototype),fa(E.prototype,"login",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"login"),E.prototype),fa(E.prototype,"logout",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"logout"),E.prototype),fa(E.prototype,"logoutSync",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"logoutSync"),E.prototype),fa(E.prototype,"sendMessageToPeer",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"sendMessageToPeer"),E.prototype),fa(E.prototype,"createChannel",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"createChannel"),E.prototype),fa(E.prototype,"createLocalInvitation",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"createLocalInvitation"),E.prototype),fa(E.prototype,"subscribePeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"subscribePeersOnlineStatus"),E.prototype),fa(E.prototype,"unsubscribePeersOnlineStatus",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"unsubscribePeersOnlineStatus"),E.prototype),fa(E.prototype,"queryPeersBySubscriptionOption",[Ma],Object.getOwnPropertyDescriptor(E.prototype,"queryPeersBySubscriptionOption"),E.prototype),fa(E.prototype,"createMessage",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"createMessage"),E.prototype),fa(E.prototype,"downloadMedia",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"downloadMedia"),E.prototype),fa(E.prototype,"createMediaMessageByUploading",[Nb],Object.getOwnPropertyDescriptor(E.prototype,"createMediaMessageByUploading"),E.prototype),E),ps={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},qs={enableLogUpload:!1,logFilter:ps.LOG_FILTER_INFO,enableCloudProxy:!1},Zd=ua(ua({createInstance:function(_){var e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},j=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(_))throw new I(["The %s in the arguments is invalid",Object.keys({appId:_})[0]],Nq);var Vt=Object.keys(e).filter(function(_d){return!(_d in qs)});if(Vt.length!==0)throw new I("Invalid RTM config: ".concat(Vt.join(", ")),Nq);var zt=ua(ua({},qs),e);if(j!==void 0&&(!Array.isArray(j)||j.length===0))throw new I("Invalid area config");if(j!=null){if(!j.every(function(_d){return _d in S.LegacyAreaCode}))throw new I("Invalid area codes: ".concat(j.filter(function(_d){return!(_d in S)}).join(", ")));M=xe(j.map(function(_d){return zC[_d]}))}j=jl=Ya.__global_unique_id__=(Ya.__global_unique_id__||0)+1;var _r=DC(zt);Vt=EC(zt);var _o=FC(zt),ga=GC(j,zt),_a=Tr(j,zt),_l=_a("RTM:DEBUG","<Entry> ");return Mr.rtmConfig=zt,_r("The Agora RTM Web SDK version is %s","1.4.3-203"),e.enableCloudProxy&&_r("RTM cloud proxy enabled"),e.enableLogUpload&&_r("Log upload enabled"),M&&_l("Area is set to %s",Array.from(M.CODES).map(function(_d){return xf(F).find(function(_f){return F[_f]===_d})}).join(", ")),_l("Creating an RtmClient instance"),_l('The Git commit ID is "'.concat("v1.4.3-17-g1e27aa38",'"')),_l("The App ID is %s",Um(_,4,10,"*".repeat(6))),_r("The process ID is %s",gg),_l("The build is %s","v1.4.3-17-g1e27aa38"),_l("NODE_ENV is %s","production"),new rD(_,{genLogger:_a,genTracker:ga,info:_r,warn:Vt,logError:_o,loggerId:j},zt,function(_d){for(var _f=0,_m=xf(_d);_f<_m.length;_f++){var tE=_m[_f];try{var rE=_d[tE];rE!=null&&(_d.enableCloudProxy&&_r("RTM cloud proxy enabled"),_d.enableLogUpload&&_r("Log upload enabled"),zt[tE]=rE)}catch{throw new I(["The %s in the arguments is invalid",tE],void 0)}}})},BUILD:"v1.4.3-17-g1e27aa38",VERSION:"1.4.3-203",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:gg,ConnectionChangeReason:S.ConnectionChangeReason,ConnectionState:S.ConnectionState,LocalInvitationFailureReason:S.LocalInvitationFailureReason,LocalInvitationState:S.LocalInvitationState,RemoteInvitationFailureReason:S.RemoteInvitationFailureReason,RemoteInvitationState:S.RemoteInvitationState,MessageType:S.MessageType,PeerOnlineState:S.PeerOnlineState,PeerSubscriptionOption:S.PeerSubscriptionOption},ps),{},{setParameter:function(_,e){Object.keys(Nc).includes(_)&&(Nc[_]=e)},getParameter:function(_){return Nc[_]},setArea:function(_){var e=_.areaCodes;if(_=_.excludedArea,!Array.isArray(e)||e.length===0||!e.every(function(j){return j in S.AreaCode}))throw new I("Invalid area config");if(_!==void 0&&_===S.AreaCode.GLOBAL)throw new I("Excluded area cannot be global");if(_===void 0)M=xe(e.map(function(j){return F[j]}));else{if(e.includes(_))throw new I("Excluded area cannot be in areaCodes");if(!(_ in F))throw new I("Invalid excludedArea:",_);M=bu({areas:e.map(function(j){return F[j]}),excludedArea:F[_]})}}});return Zd})})(agoraRtmSdk,agoraRtmSdk.exports);var agoraRtmSdkExports=agoraRtmSdk.exports;const AgoraRTM__default=getDefaultExportFromCjs(agoraRtmSdkExports);var createLazyClient=function _(){var e;function j(Vt,zt,_r){return e||(e=AgoraRTM__default.createInstance(Vt,zt,_r)),e}return function(Vt,zt,_r){return j(Vt,zt,_r)}},createLazyChannel=function _(){var e;function j(Vt,zt){return e||(e=Vt.createChannel(zt)),e}return function(Vt,zt){return j(Vt,zt)}},AreaCode;(function(_){_.GLOBAL="GLOBAL",_.INDIA="INDIA",_.JAPAN="JAPAN",_.ASIA="ASIA",_.EUROPE="EUROPE",_.CHINA="CHINA",_.NORTH_AMERICA="NORTH_AMERICA"})(AreaCode||(AreaCode={}));function _extends(){return _extends=Object.assign||function(_){for(var e=1;e<arguments.length;e++){var j=arguments[e];for(var Vt in j)Object.prototype.hasOwnProperty.call(j,Vt)&&(_[Vt]=j[Vt])}return _},_extends.apply(this,arguments)}typeof Symbol<"u"&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")));typeof Symbol<"u"&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function _catch(_,e){try{var j=_()}catch(Vt){return e(Vt)}return j&&j.then?j.then(void 0,e):j}var RtcContext=React.createContext({}),RtcProvider=RtcContext.Provider;RtcContext.Consumer;var remoteTrackState;(function(_){_[_.yes=0]="yes",_[_.subbed=1]="subbed",_[_.no=2]="no"})(remoteTrackState||(remoteTrackState={}));var layout;(function(_){_[_.grid=0]="grid",_[_.pin=1]="pin"})(layout||(layout={}));var ToggleState;(function(_){_[_.disabled=0]="disabled",_[_.enabled=1]="enabled",_[_.disabling=2]="disabling",_[_.enabling=3]="enabling"})(ToggleState||(ToggleState={}));var initialValue={rtcProps:{appId:"",channel:"",role:"host"},rtmProps:{}},PropsContext=React.createContext(initialValue),PropsProvider=PropsContext.Provider,MaxUidContext=React.createContext([]),MaxUidProvider=MaxUidContext.Provider,MaxUidConsumer=MaxUidContext.Consumer,MinUidContext=React.createContext([]),MinUidProvider=MinUidContext.Provider,MinUidConsumer=MinUidContext.Consumer,TracksContext=React.createContext({}),TracksProvider=TracksContext.Provider,initState={max:[{uid:0,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}],min:[],isScreensharing:!1},reducer=function _(e,j){var Vt=initState,zt=[].concat(e.max,e.min).map(function(_l){return _l.uid});switch(j.type){case"Screensharing":Vt=_extends({},e,{isScreensharing:j.value[0]}),console.log("!Screensharingstate",e,Vt);break;case"update-user-video":Vt={min:e.min.map(function(_l){return _l.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:_l}),max:e.max.map(function(_l){return _l.uid===0?{uid:0,hasAudio:remoteTrackState.subbed,hasVideo:remoteTrackState.subbed}:_l}),isScreensharing:e.isScreensharing};break;case"user-joined":if(zt.indexOf(j.value[0].uid)===-1){var _r=[].concat(e.min,[{uid:j.value[0].uid,hasAudio:remoteTrackState.no,hasVideo:remoteTrackState.no}]);_r.length===1&&e.max[0].uid===0?Vt={max:_r,min:e.max,isScreensharing:e.isScreensharing}:Vt={min:_r,max:e.max,isScreensharing:e.isScreensharing}}break;case"user-unpublished":if(e.max[0].uid===j.value[0].uid)Vt={max:[{uid:j.value[0].uid,hasAudio:j.value[1]==="audio"?remoteTrackState.no:e.max[0].hasAudio,hasVideo:j.value[1]==="video"?remoteTrackState.no:e.max[0].hasVideo}],min:e.min,isScreensharing:e.isScreensharing};else{var _o=e.min.find(function(_l){return _l.uid===j.value[0].uid});if(_o){var ga=[].concat(e.min.filter(function(_l){return _l.uid!==j.value[0].uid}),[{uid:j.value[0].uid,hasAudio:j.value[1]==="audio"?remoteTrackState.no:_o.hasAudio,hasVideo:j.value[1]==="video"?remoteTrackState.no:_o.hasVideo}]);Vt={min:ga,max:e.max,isScreensharing:e.isScreensharing}}}break;case"user-published":e.max[0].uid===j.value[0].uid?Vt={max:[{uid:j.value[0].uid,hasAudio:j.value[1]==="audio"?remoteTrackState.subbed:e.max[0].hasAudio,hasVideo:j.value[1]==="video"?remoteTrackState.subbed:e.max[0].hasVideo}],min:e.min,isScreensharing:e.isScreensharing}:Vt={min:e.min.map(function(_l){return _l.uid!==j.value[0].uid?_l:{uid:_l.uid,hasAudio:j.value[1]==="audio"?remoteTrackState.subbed:_l.hasAudio,hasVideo:j.value[1]==="video"?remoteTrackState.subbed:_l.hasVideo}}),max:e.max,isScreensharing:e.isScreensharing};break;case"user-left":if(e.max[0].uid===j.value[0].uid){var _a=[].concat(e.min);Vt={max:[_a.pop()],min:_a,isScreensharing:e.isScreensharing}}else Vt={min:e.min.filter(function(_l){return _l.uid!==j.value[0].uid}),max:e.max,isScreensharing:e.isScreensharing};break;case"user-swap":e.max[0].uid===j.value[0].uid||(Vt={max:[j.value[0]],min:[].concat(e.min.filter(function(_l){return _l.uid!==j.value[0].uid}),[e.max[0]]),isScreensharing:e.isScreensharing});break;case"local-user-mute-video":Vt={min:e.min.map(function(_l){return _l.uid===0?{uid:0,hasAudio:_l.hasAudio,hasVideo:j.value[0]}:_l}),max:e.max.map(function(_l){return _l.uid===0?{uid:0,hasAudio:_l.hasAudio,hasVideo:j.value[0]}:_l}),isScreensharing:e.isScreensharing};break;case"local-user-mute-audio":Vt={min:e.min.map(function(_l){return _l.uid===0?{uid:0,hasAudio:j.value[0],hasVideo:_l.hasVideo}:_l}),max:e.max.map(function(_l){return _l.uid===0?{uid:0,hasAudio:j.value[0],hasVideo:_l.hasVideo}:_l}),isScreensharing:e.isScreensharing};break;case"remote-user-mute-video":Vt={min:e.min.map(function(_l){return _l.uid===j.value[0].uid?{uid:_l.uid,hasVideo:j.value[1],hasAudio:_l.hasAudio}:_l}),max:e.max.map(function(_l){return _l.uid===j.value[0].uid?{uid:_l.uid,hasVideo:j.value[1],hasAudio:_l.hasAudio}:_l}),isScreensharing:e.isScreensharing};break;case"remote-user-mute-audio":Vt={min:e.min.map(function(_l){return _l.uid===j.value[0].uid?{uid:_l.uid,hasAudio:j.value[1],hasVideo:_l.hasVideo}:_l}),max:e.max.map(function(_l){return _l.uid===j.value[0].uid?{uid:_l.uid,hasAudio:j.value[1],hasVideo:_l.hasVideo}:_l}),isScreensharing:e.isScreensharing};break;case"leave-channel":Vt=initState;break;case"ActiveSpeaker":e.max[0].uid===j.value[0]?Vt=_extends({},e):Vt={max:[e.min.find(function(_l){return _l.uid===j.value[0]})],min:[].concat(e.min.filter(function(_l){return _l.uid!==j.value[0]}),[e.max[0]]),isScreensharing:e.isScreensharing};break}return console.log("!state-update",_extends({},e,Vt),Vt),_extends({},e,Vt)},startScreenshare=function _(e,j,Vt,zt,_r,_o,ga){try{var _a=function(){try{try{console.log(_f),_o&&(_f.on("token-privilege-will-expire",function(){try{return console.log("token will expire"),Promise.resolve(fetch(_o+"/rtc/"+j+"/publisher/uid/"+tE+"/")).then(function(nE){return Promise.resolve(nE.json()).then(function(sE){var lE=sE.rtcToken;_f.renewToken(lE)})})}catch(nE){return Promise.reject(nE)}}),_f.on("token-privilege-did-expire",function(){try{return Promise.resolve(fetch(_o+"/rtc/"+j+"/publisher/uid/"+tE+"/")).then(function(nE){return Promise.resolve(nE.json()).then(function(sE){var lE=sE.rtcToken;_f.renewToken(lE)})})}catch(nE){return Promise.reject(nE)}})),Vt.on("track-ended",function(){_f.leave(),_f.removeAllListeners()})}catch(nE){console.log(nE)}return Promise.resolve()}catch(nE){return Promise.reject(nE)}},_l=function(){try{_f.setClientRole("host");var nE=function(){if(_o){var sE=_catch(function(){return Promise.resolve(fetch(_o+"/rtc/"+j+"/publisher/uid/"+tE+"/")).then(function(lE){return Promise.resolve(lE.json()).then(function(EE){var wE=EE.rtcToken;return Promise.resolve(_f.join(e,j,wE,tE)).then(function(IE){_m=IE})})})},function(lE){console.log(lE)});if(sE&&sE.then)return sE.then(function(){})}else return Promise.resolve(_f.join(e,j,zt||null,tE||0)).then(function(lE){_m=lE})}();return Promise.resolve(nE&&nE.then?nE.then(function(){}):void 0)}catch(sE){return Promise.reject(sE)}},_d=function(){try{var nE=function(){var EE=function(){if(Vt.enabled){var wE=function(){if(!rE)return Promise.resolve(_f.publish([Vt]).then(function(){rE=!0})).then(function(){})}();if(wE&&wE.then)return wE.then(function(){})}}();if(EE&&EE.then)return EE.then(function(){})},sE=function(){if(ga)return Promise.resolve(_f.enableDualStream()).then(function(){})}();return Promise.resolve(sE&&sE.then?sE.then(nE):nE(sE))}catch(lE){return Promise.reject(lE)}},_f=AgoraRTC__default.createClient({mode:"live",role:"host",codec:"vp8"}),_m=0,tE=_r||1,rE=!1,oE=function(){try{var nE=_catch(function(){return Vt.close(),Promise.resolve(_f.leave()).then(function(){_f.removeAllListeners()})},function(sE){console.log(sE)});return Promise.resolve(nE&&nE.then?nE.then(function(){}):void 0)}catch(sE){return Promise.reject(sE)}};return stopScreenshare=oE,Promise.resolve(_a()).then(function(){return Promise.resolve(_l()).then(function(){return Promise.resolve(_d()).then(function(){_m&&console.log(_m)})})})}catch(dE){return Promise.reject(dE)}},stopScreenshare=function _(){},useClient=createClient({codec:"vp8",mode:"live"}),RtcConfigure=function _(e){var j=reactExports.useRef(),Vt=reactExports.useRef(),zt=reactExports.useRef(!1),_r=reactExports.useContext(TracksContext),_o=_r.localVideoTrack,ga=_r.localAudioTrack,_a=reactExports.useContext(PropsContext),_l=_a.callbacks,_d=_a.rtcProps,_f=reactExports.useState(!1),_m=_f[0],tE=_f[1],rE=reactExports.useState(!1),oE=rE[0],dE=rE[1],nE=null,sE=reactExports.useRef(new Promise(function(TE,OE){nE=TE,console.log(OE)})),lE=useClient();_d.customRtcClient&&(lE.removeAllListeners(),lE=_d.customRtcClient);var EE=!1,wE=!1,IE=reactExports.useRef({}),_E=e.callActive;_E===void 0&&(_E=!0);var kE=reactExports.useReducer(reducer,initState),ME=kE[0],bE=kE[1];reactExports.useEffect(function(){var TE=function(){try{try{if(console.log(lE),lE.on("user-joined",function(){try{for(var RE=arguments.length,FE=new Array(RE),VE=0;VE<RE;VE++)FE[VE]=arguments[VE];var BE=FE[0];return BE.uid===e.screenshareUid&&zt.current||BE.uid===1&&zt.current||(IE.current[BE.uid]={}),bE({type:"user-joined",value:FE}),Promise.resolve()}catch(qE){return Promise.reject(qE)}}),lE.on("user-published",function(){for(var RE=arguments.length,FE=new Array(RE),VE=0;VE<RE;VE++)FE[VE]=arguments[VE];try{var BE=FE[0],qE=FE[1];return console.log("user-published",BE.uid),BE.uid===e.screenshareUid&&zt.current||BE.uid===1&&zt.current?bE({type:"user-published",value:FE}):lE.subscribe(BE,qE).then(function(e_){if(IE.current[BE.uid][qE+"Track"]=BE[qE+"Track"],qE==="audio"){var b_;(b_=BE.audioTrack)===null||b_===void 0||b_.play()}else _d.enableDualStream&&_d.dualStreamMode&&lE.setStreamFallbackOption(BE.uid,_d.dualStreamMode);bE({type:"user-published",value:FE})}).catch(function(e_){return console.log(e_)}),Promise.resolve()}catch(e_){return Promise.reject(e_)}}),lE.on("user-unpublished",function(){try{for(var RE=arguments.length,FE=new Array(RE),VE=0;VE<RE;VE++)FE[VE]=arguments[VE];var BE=FE[0],qE=FE[1];if(console.log("user-unpublished",BE.uid),qE==="audio"){var e_;(e_=BE.audioTrack)===null||e_===void 0||e_.stop()}return bE({type:"user-unpublished",value:FE}),Promise.resolve()}catch(b_){return Promise.reject(b_)}}),lE.on("connection-state-change",function(){try{for(var RE=arguments.length,FE=new Array(RE),VE=0;VE<RE;VE++)FE[VE]=arguments[VE];var BE=FE[0],qE=FE[1],e_=FE[2];if(console.log("connection",qE,BE,e_),BE==="CONNECTED")dE(!0);else if(BE==="DISCONNECTED"){try{stopScreenshare(),zt.current=!1}catch(b_){console.log("stopscreenshare",b_)}bE({type:"leave-channel",value:null})}else dE(!1);return Promise.resolve()}catch(b_){return Promise.reject(b_)}}),lE.on("user-left",function(){for(var RE=arguments.length,FE=new Array(RE),VE=0;VE<RE;VE++)FE[VE]=arguments[VE];bE({type:"user-left",value:FE})}),_d.tokenUrl){var vE=_d.tokenUrl,NE=_d.channel,jE=_d.uid;lE.on("token-privilege-will-expire",function(){try{return console.log("token will expire"),Promise.resolve(fetch(vE+"/rtc/"+NE+"/publisher/uid/"+(jE||0)+"/")).then(function(RE){return Promise.resolve(RE.json()).then(function(FE){var VE=FE.rtcToken;lE.renewToken(VE)})})}catch(RE){return Promise.reject(RE)}}),lE.on("token-privilege-did-expire",function(){try{return Promise.resolve(fetch(vE+"/rtc/"+NE+"/publisher/uid/"+(jE||0)+"/")).then(function(RE){return Promise.resolve(RE.json()).then(function(FE){var VE=FE.rtcToken;lE.renewToken(VE)})})}catch(RE){return Promise.reject(RE)}})}if(_l){var UE=Object.keys(_l);UE.map(function(RE){try{lE.on(RE,function(){for(var FE=arguments.length,VE=new Array(FE),BE=0;BE<FE;BE++)VE[BE]=arguments[BE];_l[RE].apply(null,VE)})}catch(FE){console.log(FE)}})}nE(!0),tE(!0)}catch(RE){console.log("!!!",RE)}return Promise.resolve()}catch(RE){return Promise.reject(RE)}};return nE?(TE(),function(){try{lE.removeAllListeners()}catch(OE){console.log(OE)}}):function(){}},[_d.appId]),reactExports.useEffect(function(){var TE=function(){try{return Promise.resolve(sE.current).then(function(){var NE=_d.tokenUrl,jE=_d.channel,UE=_d.uid,RE=_d.appId,FE=_d.token,VE=function(){if(lE&&!OE){_d.role==="audience"?lE.setClientRole(_d.role):lE.setClientRole("host");var BE=function(){if(NE){var qE=_catch(function(){return Promise.resolve(fetch(NE+"/rtc/"+jE+"/publisher/uid/"+(UE||0)+"/")).then(function(e_){return Promise.resolve(e_.json()).then(function(b_){var m_=b_.rtcToken;return Promise.resolve(lE.join(RE,jE,m_,UE||0)).then(function(I_){j.current=I_})})})},function(e_){console.log(e_)});if(qE&&qE.then)return qE.then(function(){})}else return Promise.resolve(lE.join(RE,jE,FE||null,UE||0)).then(function(e_){j.current=e_})}();if(BE&&BE.then)return BE.then(function(){})}else console.error("trying to join before RTC Engine was initialized")}();if(VE&&VE.then)return VE.then(function(){})})}catch(NE){return Promise.reject(NE)}},OE=!1;return _E?(TE(),console.log("Attempted join: ",_d.channel)):console.log("In precall - waiting to join"),function(){if(OE=!0,_E){console.log("Leaving channel");try{stopScreenshare(),zt.current=!1}catch(vE){console.log(vE)}sE.current=lE.leave().catch(function(vE){return console.log(vE)})}}},[_d.channel,_d.uid,_E,_d.tokenUrl]),reactExports.useEffect(function(){var TE=function(){try{var vE=function(){function UE(){var FE=function(){if(_o!=null&&_o.enabled&&oE){var VE=function(){if(!EE)return Promise.resolve(lE.publish([_o]).then(function(){EE=!0})).then(function(){})}();if(VE&&VE.then)return VE.then(function(){})}}();if(FE&&FE.then)return FE.then(function(){})}var RE=function(){if(ga!=null&&ga.enabled&&oE){var FE=function(){if(!wE)return Promise.resolve(lE.publish([ga]).then(function(){wE=!0})).then(function(){})}();if(FE&&FE.then)return FE.then(function(){})}}();return RE&&RE.then?RE.then(UE):UE(RE)},NE=function(){if(_d.enableDualStream)return Promise.resolve(lE.enableDualStream()).then(function(){})}();return Promise.resolve(NE&&NE.then?NE.then(vE):vE(NE))}catch(jE){return Promise.reject(jE)}};console.log("Publish",_o,ga,_E),_E&&TE()},[_E,_o==null?void 0:_o.enabled,ga==null?void 0:ga.enabled,oE]),reactExports.useEffect(function(){_o&&ga!==null&&(IE.current[0]={audioTrack:ga,videoTrack:_o},bE({type:"update-user-video",value:[ga,_o]}))},[_d.channel,oE]),reactExports.useEffect(function(){oE&&_d.token&&lE.renewToken(_d.token).then(function(TE){return console.log("renewed token",TE)})},[_d.token,oE]),reactExports.useEffect(function(){_d.role&&lE.setClientRole(_d.role).then(function(TE){return console.log("changed role",TE)})},[_d.role,oE]),reactExports.useEffect(function(){var TE=function(){try{var vE=function(){if(_d.activeSpeaker&&_d.layout!==layout.grid)return lE.on("volume-indicator",function(NE){var jE=NE.reduce(function(FE,VE){return FE===null||VE.level>FE.level?VE:FE},null),UE=jE?jE.uid:void 0,RE=UE===j.current?0:UE;UE!==void 0&&bE({type:"ActiveSpeaker",value:[RE]})}),Promise.resolve(lE.enableAudioVolumeIndicator()).then(function(){})}();return Promise.resolve(vE&&vE.then?vE.then(function(){}):void 0)}catch(NE){return Promise.reject(NE)}};return _E&&TE(),function(){lE.removeAllListeners("volume-indicator")}},[_d.activeSpeaker,_d.layout]);var LE=function(){try{var OE=function(){try{return bE({type:"Screensharing",value:[!0]}),Promise.resolve(AgoraRTC__default.createScreenVideoTrack({},"disable")).then(function(jE){Vt.current=jE;var UE=_d.screenshareUid||1;return IE.current[UE]={videoTrack:Vt.current},Vt.current.on("track-ended",function(){zt.current=!1,bE({type:"Screensharing",value:[!1]})}),zt.current=!0,Promise.resolve(startScreenshare(_d.appId,_d.channel,Vt.current,_d.screenshareToken,_d.screenshareUid,_d.tokenUrl,_d.enableDualStream)).then(function(){})})}catch(jE){return Promise.reject(jE)}},vE=function(){stopScreenshare(),zt.current=!1};return zt.current?vE():OE(),Promise.resolve()}catch(NE){return Promise.reject(NE)}};return React.createElement(RtcProvider,{value:{client:lE,mediaStore:IE.current,localVideoTrack:_o,localAudioTrack:ga,dispatch:bE,localUid:j,channelJoined:oE,toggleScreensharing:LE,isScreensharing:zt.current}},React.createElement(MaxUidProvider,{value:ME.max},React.createElement(MinUidProvider,{value:ME.min},_m?e.children:null)))},icons={videocam:React.createElement(React.Fragment,null,React.createElement("polygon",{points:"23 7 16 12 23 17 23 7"}),React.createElement("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"})),videocamOff:React.createElement(React.Fragment,null,React.createElement("path",{d:"M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"}),React.createElement("line",{x1:"1",y1:"1",x2:"23",y2:"23"})),remoteSwap:React.createElement(React.Fragment,null,React.createElement("polyline",{points:"15 3 21 3 21 9"}),React.createElement("polyline",{points:"9 21 3 21 3 15"}),React.createElement("line",{x1:"21",y1:"3",x2:"14",y2:"10"}),React.createElement("line",{x1:"3",y1:"21",x2:"10",y2:"14"})),callEnd:React.createElement(React.Fragment,null,React.createElement("path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"}),React.createElement("line",{x1:"23",y1:"1",x2:"1",y2:"23"})),mic:React.createElement(React.Fragment,null,React.createElement("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),React.createElement("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),React.createElement("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),React.createElement("line",{x1:"8",y1:"23",x2:"16",y2:"23"})),micOff:React.createElement(React.Fragment,null,React.createElement("line",{x1:"1",y1:"1",x2:"23",y2:"23"}),React.createElement("path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}),React.createElement("path",{d:"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"}),React.createElement("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),React.createElement("line",{x1:"8",y1:"23",x2:"16",y2:"23"})),screen:React.createElement(React.Fragment,null,React.createElement("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),React.createElement("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),React.createElement("line",{x1:"12",y1:"17",x2:"12",y2:"21"})),stop:React.createElement(React.Fragment,null,React.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),React.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))},BtnTemplate=function _(e){var j=e.onClick,Vt=e.name,zt=e.disabled,_r=e.style,_o=reactExports.useContext(PropsContext),ga=_o.styleProps,_a=ga||{},_l=_a.theme,_d=_a.BtnTemplateStyles,_f=_a.iconSize,_m=_a.customIcon;return React.createElement("div",{style:_extends({},{width:35,height:35,borderRadius:"100%",borderWidth:2,borderStyle:"solid",borderColor:"#fff",backgroundColor:"rgba(0,80,180,0.2)",alignItems:"center",justifyContent:"center",display:"flex",cursor:zt?"auto":"pointer",margin:4},_d,_r),onClick:j},_m?React.createElement("img",{src:_m[Vt],alt:Vt}):React.createElement("svg",{style:{width:_f||24,height:_f||24},xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",opacity:zt?"0.5":"1",stroke:_l||"#fff",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},icons[Vt]))};function EndCall(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=_.callbacks,Vt=e||{},zt=Vt.localBtnStyles,_r=zt||{},_o=_r.endCall;return React.createElement(BtnTemplate,{style:_o||{backgroundColor:"#ef5588",borderColor:"#f00"},name:"callEnd",onClick:function(){return(j==null?void 0:j.EndCall)&&j.EndCall()}})}var LocalContext=reactExports.createContext({}),LocalUserContext=function _(e){var j=reactExports.useContext(MaxUidContext),Vt=reactExports.useContext(MinUidContext),zt;return j[0].uid===0?zt=j[0]:zt=Vt.find(function(_r){return _r.uid===0}),React.createElement(LocalContext.Provider,{value:zt},e.children)},muteAudio=function(_,e,j,Vt){try{var zt=function(){if(_.uid===0){var _r=_.hasAudio,_o=function(){if(_r===ToggleState.enabled||_r===ToggleState.disabled){var ga=_r===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;e({type:"local-user-mute-audio",value:[ga]}),Vt&&Vt["local-user-mute-audio"]&&Vt["local-user-mute-audio"](ga);var _a=_catch(function(){return Promise.resolve(j==null?void 0:j.setEnabled(_r!==ToggleState.enabled)).then(function(){ga=_r===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,Vt&&Vt["local-user-mute-audio"]&&Vt["local-user-mute-audio"](ga),e({type:"local-user-mute-audio",value:[_r===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled]})})},function(){e({type:"local-user-mute-audio",value:[_r]})});if(_a&&_a.then)return _a.then(function(){})}}();if(_o&&_o.then)return _o.then(function(){})}}();return Promise.resolve(zt&&zt.then?zt.then(function(){}):void 0)}catch(_r){return Promise.reject(_r)}};function LocalAudioMute(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=_.callbacks,Vt=e||{},zt=Vt.localBtnStyles,_r=zt||{},_o=_r.muteLocalAudio,ga=reactExports.useContext(RtcContext),_a=ga.dispatch,_l=ga.localAudioTrack,_d=reactExports.useContext(LocalContext);return React.createElement("div",null,React.createElement(BtnTemplate,{style:_o,name:_d.hasAudio===ToggleState.enabled?"mic":"micOff",onClick:function(){return _l&&muteAudio(_d,_a,_l,j)}}))}function Screenshare(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=e||{},Vt=j.localBtnStyles,zt=Vt||{},_r=zt.screenshare,_o=reactExports.useContext(RtcContext),ga=_o.toggleScreensharing,_a=_o.isScreensharing;return React.createElement("div",null,React.createElement(BtnTemplate,{style:_r,name:_a?"stop":"screen",onClick:function(){return ga()}}))}var muteVideo=function(_,e,j,Vt){try{var zt=function(){if(_.uid===0){var _r=_.hasVideo,_o=function(){if(_r===ToggleState.enabled||_r===ToggleState.disabled){var ga=_r===ToggleState.enabled?ToggleState.disabling:ToggleState.enabling;e({type:"local-user-mute-video",value:[ga]}),Vt&&Vt["local-user-mute-video"]&&Vt["local-user-mute-video"](ga);var _a=_catch(function(){return Promise.resolve(j==null?void 0:j.setEnabled(_r!==ToggleState.enabled)).then(function(){ga=_r===ToggleState.enabled?ToggleState.disabled:ToggleState.enabled,Vt&&Vt["local-user-mute-video"]&&Vt["local-user-mute-video"](ga),e({type:"local-user-mute-video",value:[ga]})})},function(){e({type:"local-user-mute-video",value:[_r]})});if(_a&&_a.then)return _a.then(function(){})}}();if(_o&&_o.then)return _o.then(function(){})}}();return Promise.resolve(zt&&zt.then?zt.then(function(){}):void 0)}catch(_r){return Promise.reject(_r)}};function LocalVideoMute(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=_.callbacks,Vt=e||{},zt=Vt.localBtnStyles,_r=zt||{},_o=_r.muteLocalVideo,ga=reactExports.useContext(RtcContext),_a=ga.dispatch,_l=ga.localVideoTrack,_d=reactExports.useContext(LocalContext);return React.createElement("div",null,React.createElement(BtnTemplate,{style:_o,name:_d.hasVideo===ToggleState.enabled?"videocam":"videocamOff",onClick:function(){return _l&&muteVideo(_d,_a,_l,j)}}))}function LocalControls(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=_.rtcProps,Vt=e||{},zt=Vt.localBtnContainer;return React.createElement("div",{style:_extends({},{backgroundColor:"#007bff",width:"100%",height:70,zIndex:10,display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},zt)},j.role!=="audience"&&React.createElement(LocalVideoMute,null),j.role!=="audience"&&React.createElement(LocalAudioMute,null),j.role!=="audience"&&j.enableScreensharing&&React.createElement(Screenshare,null),React.createElement(EndCall,null))}var rtmStatusEnum;(function(_){_[_.initFailed=0]="initFailed",_[_.offline=1]="offline",_[_.initialising=2]="initialising",_[_.loggingIn=3]="loggingIn",_[_.loggedIn=4]="loggedIn",_[_.connected=5]="connected",_[_.loginFailed=6]="loginFailed"})(rtmStatusEnum||(rtmStatusEnum={}));var clientRoleRaw;(function(_){_[_.broadcaster=0]="broadcaster",_[_.audience=1]="audience"})(clientRoleRaw||(clientRoleRaw={}));var mutingDevice;(function(_){_[_.camera=0]="camera",_[_.microphone=1]="microphone"})(mutingDevice||(mutingDevice={}));var popUpStateEnum;(function(_){_[_.closed=0]="closed",_[_.muteMic=1]="muteMic",_[_.muteCamera=2]="muteCamera",_[_.unmuteMic=3]="unmuteMic",_[_.unmuteCamera=4]="unmuteCamera"})(popUpStateEnum||(popUpStateEnum={}));var RtmContext=reactExports.createContext(null),RtmProvider=RtmContext.Provider;RtmContext.Consumer;function RemoteVideoMute(_){var e=reactExports.useContext(PropsContext),j=e.styleProps,Vt=reactExports.useContext(RtmContext),zt=Vt.sendMuteRequest,_r=Vt.uidMap,_o=j||{},ga=_o.remoteBtnStyles,_a=ga||{},_l=_a.muteRemoteVideo,_d=_.UIKitUser,_f=_d.hasVideo===remoteTrackState.no;return _d.uid!==0&&_r[_d.uid]?React.createElement("div",null,React.createElement(BtnTemplate,{name:_d.hasVideo===remoteTrackState.subbed?"videocam":"videocamOff",style:_l,onClick:function(){return zt(mutingDevice.camera,_d.uid,!_f)}})):null}function RemoteAudioMute(_){var e=reactExports.useContext(PropsContext),j=e.styleProps,Vt=j||{},zt=Vt.remoteBtnStyles,_r=reactExports.useContext(RtmContext),_o=_r.sendMuteRequest,ga=_r.uidMap,_a=zt||{},_l=_a.muteRemoteAudio,_d=_.UIKitUser,_f=_d.hasAudio===remoteTrackState.no;return _d.uid!==0&&ga[_d.uid]?React.createElement("div",null,React.createElement(BtnTemplate,{style:_l,name:_d.hasAudio===remoteTrackState.subbed?"mic":"micOff",onClick:function(){return _o(mutingDevice.microphone,_d.uid,!_f)}})):null}function SwapUser(_){var e=reactExports.useContext(RtcContext),j=e.dispatch,Vt=_.UIKitUser;return React.createElement("div",null,React.createElement(BtnTemplate,{name:"remoteSwap",onClick:function(){return j({type:"user-swap",value:[Vt]})}}))}var VideoPlaceholder=function _(e){var j=reactExports.useContext(PropsContext),Vt=j.styleProps,zt=j.rtcProps,_r=Vt||{},_o=_r.maxViewStyles,ga=_r.maxViewOverlayContainer,_a=e.user,_l=zt.CustomVideoPlaceholder;return _l?_l&&_l(_extends({},e),null):React.createElement("div",{key:_a.uid,style:_extends({},style.max,_o)},React.createElement("div",{style:style.imgContainer},React.createElement("img",{style:style.img,src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=="})),e.isShown&&React.createElement("div",{style:_extends({},style.btnContainer,ga)},e.showButtons&&React.createElement(React.Fragment,null,!zt.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:_a}),!zt.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:_a}),e.showSwap&&React.createElement(SwapUser,{UIKitUser:_a}))))},style={max:{flex:1,display:"flex",backgroundColor:"#007bff33",flexDirection:"row",position:"relative"},imgContainer:{flex:10,display:"flex",justifyContent:"center"},img:{width:100,height:100,position:"absolute",alignSelf:"center",justifySelf:"center",margin:"auto",display:"flex"},btnContainer:{position:"absolute",margin:5,flexDirection:"column",display:"flex"}},Username=function _(e){var j=reactExports.useContext(RtmContext),Vt=j.usernames,zt=reactExports.useContext(PropsContext),_r=zt.rtmProps,_o=zt.styleProps,ga=e.user;return _r!=null&&_r.displayUsername?React.createElement("p",{style:_extends({},styles$1.username,_o==null?void 0:_o.usernameText)},ga.uid===1?"Screenshare":Vt[ga.uid]):React.createElement(React.Fragment,null)},styles$1={username:{position:"absolute",background:"#007bffaa",padding:"2px 8px",color:"#fff",margin:0,bottom:0,right:0,zIndex:90}},MaxVideoView=function _(e){var j=reactExports.useContext(RtcContext),Vt=j.mediaStore,zt=reactExports.useContext(PropsContext),_r=zt.styleProps,_o=zt.rtcProps,ga=_r||{},_a=ga.maxViewStyles,_l=ga.videoMode,_d=ga.maxViewOverlayContainer,_f=_l==null?void 0:_l.max,_m=reactExports.useState(!1),tE=_m[0],rE=_m[1],oE=e.user;return React.createElement("div",{style:_extends({},styles$1$1.container,e.style,_a),onMouseEnter:function(){return rE(!0)},onMouseLeave:function(){return rE(!1)}},oE.hasVideo===1?React.createElement("div",{style:styles$1$1.videoContainer},!_o.disableRtm&&React.createElement(Username,{user:oE}),React.createElement(AgoraVideoPlayer,{style:styles$1$1.videoplayer,config:{fit:_f||"cover"},videoTrack:Vt[oE.uid].videoTrack}),tE&&React.createElement("div",{style:_extends({},styles$1$1.overlay,_d)},!_o.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:oE}),!_o.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:oE}))):React.createElement("div",{style:styles$1$1.videoContainer},!_o.disableRtm&&React.createElement(Username,{user:oE}),React.createElement(VideoPlaceholder,{user:oE,isShown:tE,showButtons:!0})))},styles$1$1={container:{display:"flex",flex:1},videoContainer:{display:"flex",flex:1,position:"relative"},videoplayer:{width:"100%",display:"flex",flex:1},overlay:{position:"absolute",margin:5,flexDirection:"column",display:"flex"},username:{position:"absolute",background:"#007bffaa",padding:"2px 8px",color:"#fff",margin:0,bottom:0,right:0,zIndex:90}},MinVideoView=function _(e){var j=reactExports.useContext(RtcContext),Vt=j.mediaStore,zt=reactExports.useContext(PropsContext),_r=zt.styleProps,_o=zt.rtcProps,ga=_r||{},_a=ga.minViewStyles,_l=ga.videoMode,_d=ga.minViewOverlayContainer,_f=_l==null?void 0:_l.min,_m=reactExports.useState(!1),tE=_m[0],rE=_m[1],oE=e.user;return React.createElement("div",{style:_extends({},{display:"flex",flex:1},_a),onMouseEnter:function(){return rE(!0)},onMouseLeave:function(){return rE(!1)}},oE.hasVideo===1?React.createElement("div",{style:_extends({},{display:"flex",flex:1,position:"relative"})},React.createElement(AgoraVideoPlayer,{style:{flex:10,display:"flex"},config:{fit:_f!==void 0?_f:"cover"},videoTrack:Vt[oE.uid].videoTrack}),tE&&React.createElement("div",{style:_extends({},{margin:4,position:"absolute",flex:1,display:"flex",flexDirection:"column"},_d)},!_o.disableRtm&&React.createElement(RemoteVideoMute,{UIKitUser:oE}),!_o.disableRtm&&React.createElement(RemoteAudioMute,{UIKitUser:oE}),React.createElement(SwapUser,{UIKitUser:oE}))):React.createElement(VideoPlaceholder,{user:oE,isShown:tE,showButtons:!0,showSwap:!0}))},styles$2={test:"_3ybTi",scrollbar:"_3Sxu7"},PinnedVideo=function _(){var e=reactExports.useContext(PropsContext),j=e.styleProps,Vt=e.rtcProps,zt=j||{},_r=zt.minViewContainer,_o=zt.pinnedVideoContainer,ga=zt.maxViewContainer,_a=zt.scrollViewContainer,_l=reactExports.useRef(null),_d=reactExports.useState(0),_f=_d[0],_m=_d[1],tE=reactExports.useState(0),rE=tE[0],oE=tE[1],dE=_f>rE;return reactExports.useEffect(function(){var nE=function(){_l.current&&(_m(_l.current.offsetWidth),oE(_l.current.offsetHeight))};return window.addEventListener("resize",nE),_l.current&&(_m(_l.current.offsetWidth),oE(_l.current.offsetHeight)),function(){window.removeEventListener("resize",nE)}},[]),React.createElement("div",{ref:_l,style:_extends({},{display:"flex",flex:1,flexDirection:dE?"row":"column-reverse",overflow:"hidden"},_o)},React.createElement("div",{style:_extends({},{display:"flex",flex:dE?5:4},ga)},React.createElement(MaxUidConsumer,null,function(nE){return Vt.role==="audience"&&nE[0].uid===0?null:React.createElement(MaxVideoView,{user:nE[0]})})),React.createElement("div",{className:styles$2.scrollbar,style:_extends({},{overflowY:dE?"scroll":"hidden",overflowX:dE?"hidden":"scroll",display:"flex",flex:1,flexDirection:dE?"column":"row"},_a)},React.createElement(MinUidConsumer,null,function(nE){return nE.map(function(sE){return Vt.role==="audience"&&sE.uid===0?null:React.createElement("div",{style:_extends({},{minHeight:dE?"35vh":"99%",minWidth:dE?"99%":"40vw",margin:2,display:"flex"},_r),key:sE.uid},React.createElement(MinVideoView,{user:sE}))})})))},GridVideo=function _(){var e=reactExports.useContext(PropsContext),j=e.styleProps,Vt=e.rtcProps,zt=j||{},_r=zt.gridVideoCells,_o=zt.gridVideoContainer,ga=reactExports.useContext(MaxUidContext),_a=reactExports.useContext(MinUidContext),_l=Vt.role==="audience"?[].concat(ga,_a).filter(function(lE){return lE.uid!==0}):[].concat(ga,_a),_d=reactExports.useRef(null),_f=reactExports.useState(window.innerWidth),_m=_f[0],tE=_f[1],rE=reactExports.useState(window.innerHeight),oE=rE[0],dE=rE[1],nE=_m>oE,sE="minmax(0, 1fr) ";return reactExports.useEffect(function(){var lE=function(){_d.current&&(tE(_d.current.offsetWidth),dE(_d.current.offsetHeight))};return window.addEventListener("resize",lE),_d.current&&(tE(_d.current.offsetWidth),dE(_d.current.offsetHeight)),function(){window.removeEventListener("resize",lE)}},[]),React.createElement("div",{ref:_d,style:_extends({},{width:"100%",height:"100%",display:"grid",gridTemplateColumns:nE?_l.length>9?sE.repeat(4):_l.length>4?sE.repeat(3):_l.length>1?sE.repeat(2):sE:_l.length>8?sE.repeat(3):_l.length>2?sE.repeat(2):sE},_o)},_l.map(function(lE){return React.createElement(MaxVideoView,{user:lE,style:_extends({},{height:"100%",width:"100%"},_r),key:lE.uid})}))},useTracks=createMicrophoneAndCameraTracks({encoderConfig:{}},{encoderConfig:{}}),TracksConfigure=function _(e){var j=reactExports.useState(!1),Vt=j[0],zt=j[1],_r=reactExports.useState(null),_o=_r[0],ga=_r[1],_a=reactExports.useState(null),_l=_a[0],_d=_a[1],_f=useTracks(),_m=_f.ready,tE=_f.tracks,rE=_f.error,oE=reactExports.useRef({});return reactExports.useEffect(function(){return tE!==null?(_d(tE[0]),ga(tE[1]),oE.current[0]={audioTrack:tE[0],videoTrack:tE[1]},zt(!0)):rE&&(console.error(rE),zt(!1)),function(){if(tE){var dE,nE;(dE=tE[0])===null||dE===void 0||dE.close(),(nE=tE[1])===null||nE===void 0||nE.close()}}},[_m,rE]),React.createElement(TracksProvider,{value:{localVideoTrack:_o,localAudioTrack:_l}},Vt?e.children:null)},timeNow=function _(){return new Date().getTime()},useChannel=createLazyChannel(),useClient$1=createLazyClient(),RtmConfigure=function _(e){var j=reactExports.useContext(PropsContext),Vt=j.rtcProps,zt=j.rtmProps,_r=reactExports.useState(!1),_o=_r[0],ga=_r[1],_a=useClient$1(Vt.appId),_l=useChannel(_a,Vt.channel),_d=reactExports.useRef(""),_f=reactExports.useRef(5),_m=reactExports.useContext(LocalContext),tE=reactExports.useContext(PropsContext),rE=tE.rtmCallbacks,oE=reactExports.useState({}),dE=oE[0],nE=oE[1],sE=reactExports.useState({}),lE=sE[0],EE=sE[1],wE=reactExports.useState({}),IE=wE[0],_E=wE[1],kE=reactExports.useState(popUpStateEnum.closed),ME=kE[0],bE=kE[1],LE=reactExports.useState(rtmStatusEnum.offline),TE=LE[0],OE=LE[1],vE=reactExports.useContext(RtcContext),NE=vE.localUid,jE=vE.localAudioTrack,UE=vE.localVideoTrack,RE=vE.dispatch,FE=vE.channelJoined,VE=function oS(){try{var q_=Vt.tokenUrl,E0=function(){if(q_){var S_=_catch(function(){return Promise.resolve(fetch(q_+"/rtm/"+((zt==null?void 0:zt.uid)||_d.current))).then(function(k0){return Promise.resolve(k0.json()).then(function(QS){var yR=QS.rtmToken;return Promise.resolve(_a.login({uid:(zt==null?void 0:zt.uid)||_d.current,token:yR})).then(function(){_f.current=5})})})},function(){setTimeout(function(){try{return _f.current=_f.current+_f.current,oS(),Promise.resolve()}catch(k0){return Promise.reject(k0)}},_f.current*1e3)});if(S_&&S_.then)return S_.then(function(){})}else{var v0=_catch(function(){return Promise.resolve(_a.login({uid:(zt==null?void 0:zt.uid)||_d.current,token:(zt==null?void 0:zt.token)||void 0})).then(function(){_f.current=5})},function(){setTimeout(function(){try{return _f.current=_f.current+_f.current,oS(),Promise.resolve()}catch(k0){return Promise.reject(k0)}},_f.current*1e3)});if(v0&&v0.then)return v0.then(function(){})}}();return Promise.resolve(E0&&E0.then?E0.then(function(){}):void 0)}catch(S_){return Promise.reject(S_)}},BE=function oS(){try{var q_=_catch(function(){return Promise.resolve(_l.join()).then(function(){_f.current=5})},function(){setTimeout(function(){try{return _f.current=_f.current+_f.current,oS(),Promise.resolve()}catch(E0){return Promise.reject(E0)}},_f.current*1e3)});return Promise.resolve(q_&&q_.then?q_.then(function(){}):void 0)}catch(E0){return Promise.reject(E0)}},qE=function(){try{if(OE(rtmStatusEnum.initialising),Vt.uid?_d.current=String(Vt.uid):_d.current=String(timeNow()),_a.on("ConnectionStateChanged",function(S_,v0){console.log(S_,v0)}),_a.on("TokenExpired",function(){try{var S_=Vt.tokenUrl;console.log("token expired - renewing");var v0=function(){if(S_){var k0=_catch(function(){return Promise.resolve(fetch(S_+"/rtm/"+((zt==null?void 0:zt.uid)||_d.current))).then(function(QS){return Promise.resolve(QS.json()).then(function(yR){var TS=yR.rtmToken;return Promise.resolve(_a.renewToken(TS)).then(function(){_f.current=5})})})},function(QS){console.error("TokenExpiredError",QS)});if(k0&&k0.then)return k0.then(function(){})}}();return Promise.resolve(v0&&v0.then?v0.then(function(){}):void 0)}catch(k0){return Promise.reject(k0)}}),_a.on("MessageFromPeer",function(S_,v0){m_(S_,v0)}),_l.on("ChannelMessage",function(S_,v0){m_(S_,v0)}),_l.on("MemberJoined",function(S_){try{return Promise.resolve(LS(e_(),S_)).then(function(){})}catch(v0){return Promise.reject(v0)}}),_l.on("MemberCountUpdated",function(S_){try{return console.log("RTM-MemberCountUpdated: ",S_),Promise.resolve()}catch(v0){return Promise.reject(v0)}}),rE!=null&&rE.channel?Object.keys(rE.channel).map(function(S_){rE.channel&&_l.on(S_,rE.channel[S_])}):rE!=null&&rE.client&&Object.keys(rE.client).map(function(S_){rE.client&&_a.on(S_,rE.client[S_])}),Vt.tokenUrl){var q_=Vt.tokenUrl,E0=Vt.uid;_a.on("TokenExpired",function(){try{return console.log("token expired"),Promise.resolve(fetch(q_+"/rtm/"+(E0||0)+"/")).then(function(S_){return Promise.resolve(S_.json()).then(function(v0){var k0=v0.rtmToken;_a.renewToken(k0)})})}catch(S_){return Promise.reject(S_)}})}return OE(rtmStatusEnum.loggingIn),Promise.resolve(VE()).then(function(){return OE(rtmStatusEnum.loggedIn),Promise.resolve(BE()).then(function(){OE(rtmStatusEnum.connected),EE(function(S_){return _extends({},S_,{0:zt==null?void 0:zt.username})}),oT(e_())})})}catch(S_){return Promise.reject(S_)}},e_=function(){return{messageType:"UserData",rtmId:(zt==null?void 0:zt.uid)||_d.current,rtcId:NE.current,username:zt==null?void 0:zt.username,role:Vt.role==="audience"?1:0,uikit:{platform:"web",framework:"react",version:"1.2.0"},agora:{rtm:AgoraRTM__default.VERSION,rtc:AgoraRTC__default.VERSION}}},b_=function(q_,E0,S_){var v0=(zt==null?void 0:zt.showPopUpBeforeRemoteMute)===!1,k0={messageType:"MuteRequest",device:q_,rtcId:E0,mute:S_,isForceful:v0},QS=dE[E0];v0&&!S_?console.log("cannot send force unmute request"):QS?LS(k0,QS):console.log("peer not found")},m_=function(q_,E0){var S_;if(q_.messageType==="RAW"?S_=parsePayload(q_.rawMessage):q_.messageType==="TEXT"&&(S_=JSON.parse(q_.text)),console.log(S_,E0),S_)switch(S_.messageType){case"UserData":I_(S_);break;case"MuteRequest":w0(S_);break;case"RtmDataRequest":switch(S_.type){case"ping":yT(E0);break;case"userData":YT(E0);break;default:console.log(E0)}break;default:console.log("unknown message content")}else console.log("unknown rtm message type")},I_=function(q_){nE(function(E0){var S_;return _extends({},E0,(S_={},S_[q_.rtcId]=q_.rtmId,S_))}),EE(function(E0){var S_;return _extends({},E0,(S_={},S_[q_.rtcId]=q_.username,S_))}),_E(function(E0){var S_;return _extends({},E0,(S_={},S_[q_.rtmId]=q_,S_))})},w0=function(q_){NE.current===q_.rtcId&&(q_.isForceful?q_.mute?q_.device===mutingDevice.microphone?jE&&muteAudio(_m,RE,jE):q_.device===mutingDevice.camera&&UE&&muteVideo(_m,RE,UE):console.error("cannot force unmute"):q_.device===mutingDevice.microphone?q_.mute?bE(popUpStateEnum.muteMic):bE(popUpStateEnum.unmuteMic):q_.device===mutingDevice.camera&&(q_.mute?bE(popUpStateEnum.muteCamera):bE(popUpStateEnum.unmuteCamera)))},yT=function(q_){LS({messageType:"RtmDataRequest",type:"pong"},q_)},YT=function(q_){LS(e_(),q_)},oT=function(q_){try{var E0=_a.createMessage({text:JSON.stringify(q_),messageType:AgoraRTM__default.MessageType.TEXT}),S_=_catch(function(){return Promise.resolve(_l.sendMessage(E0)).then(function(){})},function(v0){console.error(v0)});return Promise.resolve(S_&&S_.then?S_.then(function(){}):void 0)}catch(v0){return Promise.reject(v0)}},LS=function(q_,E0){try{var S_=_a.createMessage({text:JSON.stringify(q_),messageType:AgoraRTM__default.MessageType.TEXT}),v0=_catch(function(){return Promise.resolve(_a.sendMessageToPeer(S_,String(E0))).then(function(){})},function(k0){console.error(k0)});return Promise.resolve(v0&&v0.then?v0.then(function(){}):void 0)}catch(k0){return Promise.reject(k0)}},lS=function(){try{return Promise.resolve(_a.logout()).then(function(){return Promise.resolve(_a.removeAllListeners()).then(function(){})})}catch(q_){return Promise.reject(q_)}};return reactExports.useEffect(function(){return FE&&(qE(),ga(!0)),function(){FE&&lS()}},[Vt.channel,Vt.appId,FE]),React.createElement(RtmProvider,{value:{rtmStatus:TE,sendPeerMessage:LS,sendChannelMessage:oT,sendMuteRequest:b_,rtmClient:_a,uidMap:dE,usernames:lE,userDataMap:IE,popUpState:ME,setPopUpState:bE}},_o?e.children:React.createElement(React.Fragment,null))};new TextEncoder;var dec=new TextDecoder,parsePayload=function _(e){return JSON.parse(dec.decode(e))};function PopUp(){var _=reactExports.useContext(PropsContext),e=_.styleProps,j=reactExports.useContext(RtmContext),Vt=j.popUpState,zt=j.setPopUpState,_r=e||{},_o=_r.popUpContainer,ga=reactExports.useContext(RtcContext),_a=ga.dispatch,_l=ga.localVideoTrack,_d=ga.localAudioTrack,_f=reactExports.useContext(LocalContext);return Vt!==popUpStateEnum.closed?React.createElement("div",{style:_extends({},styles$3.container,_o)},React.createElement("div",{style:{color:"#fff",fontSize:18,fontWeight:700}},Vt===popUpStateEnum.muteCamera||Vt===popUpStateEnum.muteMic?"Mute ":"Unmute ",Vt===popUpStateEnum.muteCamera||Vt===popUpStateEnum.unmuteCamera?"Camera":"Mic","?"),React.createElement("div",{style:{flexDirection:"row",display:"flex",width:"100%",justifyContent:"space-around"}},React.createElement("div",{onClick:function(){switch(Vt){case popUpStateEnum.muteCamera:_f.hasVideo&&_l&&muteVideo(_f,_a,_l);break;case popUpStateEnum.muteMic:_f.hasAudio&&_d&&muteAudio(_f,_a,_d);break;case popUpStateEnum.unmuteCamera:!_f.hasVideo&&_l&&muteVideo(_f,_a,_l);break;case popUpStateEnum.unmuteMic:!_f.hasAudio&&_d&&muteAudio(_f,_a,_d);break}zt(popUpStateEnum.closed)},style:styles$3.button},"Confirm"),React.createElement("div",{style:styles$3.buttonClose,onClick:function(){return zt(popUpStateEnum.closed)}},"Close"))):null}var styles$3={button:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},buttonClose:{color:"#fff",cursor:"pointer",borderWidth:2,borderStyle:"solid",borderColor:"#fff",padding:"2px 4px",borderRadius:4},container:{backgroundColor:"#007bffaa",position:"absolute",width:240,height:80,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:100,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center"}},AgoraUIKit=function _(e){var j=e.styleProps,Vt=e.rtcProps,zt=j||{},_r=zt.UIKitContainer;return React.createElement(PropsProvider,{value:e},React.createElement("div",{style:_extends({},style$1,_r)},Vt.role==="audience"?React.createElement(VideocallUI,null):React.createElement(TracksConfigure,null,React.createElement(VideocallUI,null))))},VideocallUI=function _(){var e=reactExports.useContext(PropsContext),j=e.rtcProps;return React.createElement(RtcConfigure,{callActive:j.callActive},React.createElement(LocalUserContext,null,j.disableRtm?React.createElement(React.Fragment,null,(j==null?void 0:j.layout)===layout.grid?React.createElement(GridVideo,null):React.createElement(PinnedVideo,null),React.createElement(LocalControls,null)):React.createElement(RtmConfigure,null,React.createElement(PopUp,null),(j==null?void 0:j.layout)===layout.grid?React.createElement(GridVideo,null):React.createElement(PinnedVideo,null),React.createElement(LocalControls,null))))},style$1={display:"flex",flex:1,minHeight:0,flexDirection:"column"};const VideoRoomMeeting=({channel:_,appId:e,onTornOffCall:j})=>{const Vt={appId:e,channel:_,token:null},zt={EndCall:()=>{j()}};return jsxRuntimeExports.jsx(AgoraUIKit,{rtcProps:Vt,callbacks:zt,styleProps:{localBtnContainer:{backgroundColor:"transparent",justifyContent:"center",height:"fit-content"},BtnTemplateStyles:{backgroundColor:"#3890a2"}}})},rejectcall="/mocho_web/assets/rejectcall-C7mnkxCE.png",acceptcall="/mocho_web/assets/acceptcall-BtdBkDuj.png",record_audio="/mocho_web/assets/record_audio-CcqY7a9T.gif",chamando="/mocho_web/assets/phone-call-14472-DeX6OdOm.mp3",novaChamada="/mocho_web/assets/ringing-151670-CuXDrjul.mp3",messageListContainer="_messageListContainer_12cjj_1",styles={messageListContainer},ChatRoom=({selectedUser:_,userLoggedIn:e,socket:j})=>{console.log("user",_,e);const[Vt,zt]=reactExports.useState([]),[_r,_o]=reactExports.useState(null),[ga,_a]=reactExports.useState(null),[_l,_d]=reactExports.useState(null),_f=reactExports.useRef(null),_m=reactExports.useRef(null),tE=reactExports.useRef(null),[rE,oE]=reactExports.useState(!1),[dE,nE]=reactExports.useState(null),sE=reactExports.useRef(null),lE=reactExports.useRef([]),[EE,wE]=reactExports.useState("no call"),IE=reactExports.useRef(null),[_E,kE]=reactExports.useState("374ae075f2d74cdd8799f0aaa1689c44"),ME=()=>{const BE=new Date;zt(qE=>[...qE,{id:BE,cod_user_reciever:_.id,cod_user_sender:e==null?void 0:e.id,created_at:BE.getDay()+"-"+BE.getMonth()+"-"+BE.getFullYear()+" "+BE.getHours()+":"+BE.getMinutes(),text:_l}]),j.emit("send message to the participant",{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,cod_user_sender:e==null?void 0:e.id,cod_user_reciever:_.id,text:_l}),_d("")},bE=()=>{_o(ga.channel),wE("in a call"),j.emit("call accepted",{user:ga.user.id})},LE=BE=>{BE.current.click()},TE=async BE=>{const qE=BE.target.files[0];if(qE&&(qE.type=="image/jpeg"||qE.type=="image/png"||qE.type=="application/pdf")){const e_=new FileReader;e_.onload=()=>{const b_=new Date;zt(m_=>[...m_,{id:b_,cod_user_reciever:_.id,cod_user_sender:e==null?void 0:e.id,created_at:b_.getDay()+"-"+b_.getMonth()+"-"+b_.getFullYear()+" "+b_.getHours()+":"+b_.getMinutes(),text:"",file:e_.result,file_type:qE.type}]),(qE.type=="image/jpeg"||qE.type=="image/png")&&j.emit("send image from web to the participant",{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,cod_user_sender:e==null?void 0:e.id,cod_user_reciever:_.id,file:qE,text:"",file_type:qE.type}),qE.type.includes("image/")||j.emit("send doc from web to the participant",{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,cod_user_sender:e==null?void 0:e.id,cod_user_reciever:_.id,file:qE,text:"",file_type:qE.type})},e_.readAsDataURL(qE)}},OE=()=>{j.emit("reject call",{user:ga.user.id}),wE("no call")},vE=()=>{_o(""),wE("no call"),j.emit("video call invite aborted",{user:{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,id:e==null?void 0:e.id},guest:_.id})},NE=async()=>{const BE=await navigator.mediaDevices.getUserMedia({audio:!0});sE.current=new MediaRecorder(BE),sE.current.start(),oE(!0),sE.current.ondataavailable=qE=>{lE.current.push(qE.data)}},jE=()=>{sE.current.stop(),sE.current.onstop=()=>{const BE=new Blob(lE.current,{type:"audio/mp3"}),qE=URL.createObjectURL(BE);lE.current=[];const e_=new Date;zt(b_=>[...b_,{id:e_,cod_user_reciever:_.id,cod_user_sender:e==null?void 0:e.id,created_at:e_.getDay()+"-"+e_.getMonth()+"-"+e_.getFullYear()+" "+e_.getHours()+":"+e_.getMinutes(),text:"",file:qE,file_type:"audio/mp3"}]),j.emit("send audio from web to the participant",{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,cod_user_sender:e==null?void 0:e.id,cod_user_reciever:_.id,file:BE,text:"",file_type:"audio/mp3"})},oE(!1)},UE=()=>{if(EE=="no call"||EE=="call rejected"||EE=="video call invitation aborted"){const BE=`channel${e==null?void 0:e.id}${_.id}`;_o(BE),wE("started a call"),j.emit("invite user to video call",{user:{nome:e==null?void 0:e.nome,sobrenome:e==null?void 0:e.sobrenome,id:e==null?void 0:e.id},channel:BE,guest:_.id})}};reactExports.useEffect(()=>{j.on("new user to user message",({cod_user_sender:BE,text:qE,created_at:e_,file:b_,file_type:m_})=>{Vt.length&&(_==null?void 0:_.id)==BE?zt([...Vt,{id:new Date,cod_user_reciever:_.id,cod_user_sender:BE,created_at:e_,file:b_,file_type:m_,text:qE}]):(_==null?void 0:_.id)==BE&&zt({id:new Date,cod_user_reciever:_.id,cod_user_sender:BE,created_at:e_,file:b_,file_type:m_,text:qE})})},[Vt,_]);const RE=(BE,qE)=>{(BE=="image/jpeg"||BE=="image/png"||BE=="application/pdf")&&nE({file_type:BE,file:qE})};reactExports.useEffect(()=>{j.on("messages loaded",BE=>{zt(BE.messages)}),j.on("video call invite",({channel:BE,user:qE})=>{EE=="no call"&&(_a({channel:BE,user:qE}),wE("new call invitation"))}),j.on("video call invitation aborted",()=>{_a(null),wE("video call invitation aborted")}),j.on("call rejected",()=>{wE("call rejected"),_o(null)}),j.on("call accepted",()=>{wE("in a call")})},[EE]);const FE=()=>{var BE,qE;_f.current&&Vt.length>0&&((qE=(BE=_f.current)==null?void 0:BE.lastElementChild)==null||qE.scrollIntoView({behavior:"smooth"}))};reactExports.useEffect(()=>{FE()},[Vt]);const VE=BE=>BE.map(({id:qE,file:e_,cod_user_sender:b_,created_at:m_,text:I_,file_type:w0})=>jsxRuntimeExports.jsx("div",{className:b_==(e==null?void 0:e.id)?"h-fit w-fit p-2 rounded-lg bg-primary text-white self-end my-4":"h-fit w-fit p-2 bg-opacity-75 rounded-lg bg-green-600 text-white my-4",children:jsxRuntimeExports.jsxs("button",{onClick:()=>RE(w0,e_),children:[(w0=="image/jpeg"||w0=="image/png")&&jsxRuntimeExports.jsx("img",{src:e_,className:"w-20 h-20 object-cover"}),w0=="audio/mp3"&&jsxRuntimeExports.jsx("audio",{controls:!0,src:e_}),w0=="application/pdf"&&jsxRuntimeExports.jsx("embed",{src:e_,type:"application/pdf",className:"h-300 w-300"}),jsxRuntimeExports.jsx("p",{children:I_}),jsxRuntimeExports.jsx("p",{className:"text-xs text-right",children:m_})]})},qE));return jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col h-full p-4 pb-2 relative",children:[dE&&jsxRuntimeExports.jsx("div",{className:"w-full h-full z-10 absolute flex justify-center items-center",children:jsxRuntimeExports.jsxs("div",{className:"w-1/2 h-1/2 bg-white relative rounded-xl overflow-hidden",children:[jsxRuntimeExports.jsx("button",{className:"absolute z-10 right-10 top-5 font-bold text-xl",title:"Fechar",onClick:()=>nE(null),children:"x"}),(dE.file_type=="image/jpeg"||dE.file_type=="image/png")&&jsxRuntimeExports.jsx("img",{className:"w-full h-full object-contain",src:dE.file}),dE.file_type=="application/pdf"&&jsxRuntimeExports.jsx("embed",{src:dE.file,type:"application/pdf",className:"h-full w-full"})]})}),(e==null?void 0:e.nome)&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between h-10 items-center relative",children:[jsxRuntimeExports.jsxs("h1",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:userplaceholderimage}),_.nome+"  "+_.sobrenome]}),jsxRuntimeExports.jsx("button",{onClick:UE,children:jsxRuntimeExports.jsx(I,{size:32,className:"hover:text-primary"})}),EE=="new call invitation"&&jsxRuntimeExports.jsxs("div",{className:"w-fit h-fit p-2 z-10 rounded-md absolute top-0 right-24 bg-primary",children:[jsxRuntimeExports.jsx("p",{className:"text-white font-semibold text-lg",children:"Nova video chamada de:"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center my-6 justify-center",children:[jsxRuntimeExports.jsx("img",{className:"w-6 h-6 rounded-full object-cover",src:userplaceholderimage}),jsxRuntimeExports.jsx("p",{className:"ml-2 text-white font-semibold text-sm",children:ga.user.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center flex-1 justify-evenly",children:[jsxRuntimeExports.jsx("button",{onClick:bE,children:jsxRuntimeExports.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:acceptcall})}),jsxRuntimeExports.jsx("button",{onClick:OE,className:"-rotate-90",children:jsxRuntimeExports.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:rejectcall})})]})]}),(EE=="started a call"||EE=="started a call")&&jsxRuntimeExports.jsxs("div",{className:"w-fit h-fit p-2 z-10 rounded-md absolute top-0 right-24 bg-primary",children:[jsxRuntimeExports.jsx("p",{className:"text-white font-semibold text-lg",children:EE=="started a call"?"Ligando para:":"Chamada rejeitada"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center my-6 justify-center",children:[jsxRuntimeExports.jsx("img",{className:"w-6 h-6 rounded-full object-cover",src:userplaceholderimage}),jsxRuntimeExports.jsx("p",{className:"ml-2 text-white font-semibold text-sm",children:(_==null?void 0:_.nome)+" "+_.sobrenome}),jsxRuntimeExports.jsx("div",{className:"flex items-center flex-1 justify-end ml-4",children:jsxRuntimeExports.jsx("button",{onClick:vE,className:"-rotate-90",children:jsxRuntimeExports.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:rejectcall})})})]})]})]}),EE!="in a call"&&jsxRuntimeExports.jsx("div",{className:`my-2 flex-1 flex flex-col overflow-y-auto ${styles.messageListContainer} w-full`,ref:_f,children:Vt&&VE(Vt)}),EE=="in a call"&&jsxRuntimeExports.jsx(VideoRoomMeeting,{appId:_E,channel:_r,onTornOffCall:vE}),jsxRuntimeExports.jsx("audio",{controls:!0,src:EE=="started a call"?chamando:novaChamada,ref:IE,className:"hidden",loop:!0}),rE&&jsxRuntimeExports.jsxs("div",{className:"w-full flex justify-start items-center mb-2",children:[jsxRuntimeExports.jsx("img",{src:record_audio,className:"h-10 w-10 rounded-full"}),jsxRuntimeExports.jsx("p",{className:"ml-1 text-sm",children:"Gravando..."})]}),(e==null?void 0:e.nome)&&EE!="in a call"&&jsxRuntimeExports.jsxs("div",{className:"flex gap-2 h-10 items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex w-full bg-white rounded-xl px-4 py-1 items-center gap-4",children:[jsxRuntimeExports.jsx("textarea",{rows:1,className:"flex-1 resize-none outline-none overflow-y-hidden",placeholder:"Escreva a sua mensagem",value:_l,onChange:BE=>_d(BE.target.value)}),jsxRuntimeExports.jsx("input",{type:"file",ref:_m,accept:"image/*,video/*",className:"hidden",onChange:TE}),jsxRuntimeExports.jsx("input",{type:"file",ref:tE,accept:"application/pdf, .doc, .docx",className:"hidden",onChange:TE}),jsxRuntimeExports.jsx("button",{onClick:()=>LE(tE),children:jsxRuntimeExports.jsx(P,{size:25,className:"hover:text-primary"})}),jsxRuntimeExports.jsx("button",{onClick:()=>LE(_m),children:jsxRuntimeExports.jsx(w$3,{size:25,className:"hover:text-primary"})}),jsxRuntimeExports.jsx("button",{onClick:ME,children:jsxRuntimeExports.jsx(h,{size:25,className:"hover:text-primary"})})]}),!rE&&jsxRuntimeExports.jsx("button",{className:"w-7 h-7 bg-primary rounded-full flex justify-center items-center",onClick:NE,children:jsxRuntimeExports.jsx(I$1,{size:20,className:"hover:text-white"})}),rE&&jsxRuntimeExports.jsx("button",{className:"w-7 h-7 bg-primary rounded-full flex justify-center items-center",onClick:jE,children:jsxRuntimeExports.jsx(R,{size:20,className:"hover:text-white"})})]})]})},Conversations=()=>{const[_,e]=reactExports.useState({}),{user:j}=useAuth(),{socket:Vt}=useSocket(),zt=_r=>{console.log(_r);const{id:_o,nome:ga,sobrenome:_a,foto:_l}=_r;e({id:_o,nome:ga,sobrenome:_a,foto:_l}),Vt.emit("load messages user to user web",{cod_user_sender:j==null?void 0:j.id,cod_user_reciever:_o})};return jsxRuntimeExports.jsx(AppLayout,{children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden justify-center items-center shadow-md rounded-xl bg-white bg-opacity-50 mx-4",children:[jsxRuntimeExports.jsx(UsersConversation,{onSelectUser:zt,userLoggedIn:j}),_!=null&&_.id?jsxRuntimeExports.jsx(ChatRoom,{selectedUser:_,userLoggedIn:j,socket:Vt}):jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col m-auto items-center",children:[jsxRuntimeExports.jsx("img",{src:meeting,className:"w-52 h-52 object-cover rounded-full"}),jsxRuntimeExports.jsxs("h2",{className:"text-center text-2xl font-bold mt-4",children:["Conversas privadas e seguras",_==null?void 0:_.name,"oo"]})]})]})})},RoomMeeting=()=>jsxRuntimeExports.jsx("div",{children:"RoomMeeting"});var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(_,e=0){return(byteToHex[_[e+0]]+byteToHex[_[e+1]]+byteToHex[_[e+2]]+byteToHex[_[e+3]]+"-"+byteToHex[_[e+4]]+byteToHex[_[e+5]]+"-"+byteToHex[_[e+6]]+byteToHex[_[e+7]]+"-"+byteToHex[_[e+8]]+byteToHex[_[e+9]]+"-"+byteToHex[_[e+10]]+byteToHex[_[e+11]]+byteToHex[_[e+12]]+byteToHex[_[e+13]]+byteToHex[_[e+14]]+byteToHex[_[e+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(_,e,j){if(native.randomUUID&&!e&&!_)return native.randomUUID();_=_||{};var Vt=_.random||(_.rng||rng)();return Vt[6]=Vt[6]&15|64,Vt[8]=Vt[8]&63|128,unsafeStringify(Vt)}const CreateOrJoinToMeeting=()=>{const[_,e]=reactExports.useState(null),{id:j}=useParams(),{user:Vt}=useAuth(),[zt,_r]=reactExports.useState("374ae075f2d74cdd8799f0aaa1689c44"),[_o,ga]=reactExports.useState(""),[_a,_l]=reactExports.useState(!1),[_d,_f]=reactExports.useState(!1),{socket:_m}=useSocket(),[tE,rE]=reactExports.useState([]),[oE,dE]=reactExports.useState(!1),[nE,sE]=reactExports.useState([]),lE=()=>{dE(TE=>!TE)},EE=(TE,OE)=>{const vE=tE.filter(NE=>NE.id!=TE);rE(vE),_m.emit("response to join meeting",{user:TE,feedback:OE})},wE=()=>{const TE=nE.filter(OE=>OE.selected===!0).map(OE=>OE.id);TE.length>0?_m.emit("create meeting",{user:Vt,room:_,guests:TE}):alert("","A reunio deve ter ao menos um convidado.")},IE=TE=>{const OE=nE.map(vE=>vE.id==TE?{...vE,selected:!vE.selected}:vE);sE(OE)};reactExports.useEffect(()=>{fetch(`${backend_crud}load_all_users_not_me?id_user=${Vt.id}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(TE){return TE.json()}).then(function(TE){TE.length>0&&sE(TE)}).catch(TE=>alert("Error:",TE))},[]),reactExports.useEffect(()=>{_m.on("meeting created",({status:TE,room:OE,appId:vE,token:NE})=>{TE==1&&_f(!0),console.log(TE,OE,vE,NE)}),_m.on("request to join meeting",({user:TE})=>{rE(OE=>[...OE,TE])})},[]),reactExports.useEffect(()=>{j&&(e(j),_f(!0))},[j]);const _E=TE=>{ga(TE.target.value)},kE=TE=>{e(v4()),_l(!0)},ME=()=>{_f(!1)},bE=TE=>TE.map(({id:OE,nome:vE,sobrenome:NE,foto:jE,selected:UE})=>jsxRuntimeExports.jsxs("li",{className:"bg-white mb-4 w-1/2 h-fit p-4 rounded-lg flex justify-between items-center",onClick:()=>IE(OE),children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 justify-center items-center",children:[jsxRuntimeExports.jsx("img",{className:"w-10 h-10 rounded-full object-cover",src:userplaceholderimage}),jsxRuntimeExports.jsx("span",{children:vE+" "+NE})]}),UE&&jsxRuntimeExports.jsx(k,{size:32,className:"text-primary"})]},OE)),LE=_o===""?nE:nE.filter(TE=>TE.nome.toLowerCase()+" "+TE.sobrenome.toLowerCase().includes(_o));return jsxRuntimeExports.jsx(AppLayout,{showSearchBar:_a,searchBarPlaceHolder:"Buscar usuarios",onSearch:_E,children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden justify-center items-center mx-4 relative",children:[tE.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-primary h-4/5 w-64 absolute bottom-0 rounded-md p-2 z-10 right-0 overflow-auto",children:[jsxRuntimeExports.jsx("p",{className:"text-white mb-4",children:"Pedidos"}),jsxRuntimeExports.jsx("ul",{children:tE.map(TE=>jsxRuntimeExports.jsxs("li",{className:"flex flex-col justify-between items-center bg-white p-2 rounded-md mb-2",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm",children:[TE.nome+" "+TE.sobrenome," deseja ingressar na reunio"]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center mt-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>EE(TE.id,!1),className:"bg-red-400 flex-1 h-50 rounded-md ml-4 p-2 text-white text-sm",children:"Rejeitar"}),jsxRuntimeExports.jsx("button",{onClick:()=>EE(TE.id,!0),className:"bg-green-600 flex-1 h-50 rounded-md ml-4 p-2 text-white text-sm",children:"Aceitar"})]})]}))})]}),!_a&&!_d&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("img",{src:meeting,className:"h-72 rounded-full w-72 object-cover"}),jsxRuntimeExports.jsx("p",{className:"font-bold text-lg my-4",children:"Crie ou junte-se  reunies seguras e privadas."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-5 relative h-fit",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"bg-primary p-2 w-40 rounded-lg text-white font-bold",onClick:lE,children:"Criar"}),oE&&jsxRuntimeExports.jsxs("div",{className:"bg-white w-50 h-50 flex flex-col py-4 absolute right-0 -top-24",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:kE,className:"px-2 text-black  text-sm text-start flex-1 mb-4",children:"Reunio instantnea"}),jsxRuntimeExports.jsx("button",{type:"button",className:"px-2 text-black  text-sm text-start flex-1",children:"Reunio agendada"})]})]})]}),_a&&!_d&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center w-1/2 self-start",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-20 my-4 w-full justify-center",children:[jsxRuntimeExports.jsx("h2",{className:"font-bold my-4",children:"Convide usuarios"}),jsxRuntimeExports.jsx("button",{className:"bg-primary p-2 rounded-lg text-white",onClick:wE,children:"Entrar para a reunio"})]}),jsxRuntimeExports.jsx("ul",{className:"flex flex-col items-center w-full overflow-y-auto",children:bE(LE)})]}),_d&&jsxRuntimeExports.jsx("div",{className:"flex-1 flex flex-col h-full p-4 pb-2",children:jsxRuntimeExports.jsx(VideoRoomMeeting,{appId:zt,channel:_,onTornOffCall:ME})})]})})},router=createBrowserRouter([{path:"/",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(Home,{})}),errorElement:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h1",{children:"404 A pgina solicitada no existe"})})},{path:"/chat/:id",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(Chat,{})})},{path:"/conversations",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(Conversations,{})})},{path:"/roommeeting",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(RoomMeeting,{})})},{path:"/createorjointomeeting",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(CreateOrJoinToMeeting,{})})},{path:"/createorjointomeeting/:id",element:jsxRuntimeExports.jsx(ProtectedRoutes,{children:jsxRuntimeExports.jsx(CreateOrJoinToMeeting,{})})},{path:"/signin",element:jsxRuntimeExports.jsx(Login,{})},{path:"signup",element:jsxRuntimeExports.jsx(Register,{})}]),App=()=>(reactExports.useEffect(()=>{const _=j=>{j.preventDefault()},e=j=>{console.log(j),j.key==="PrintScreen"&&(j.preventDefault(),alert("captura des")),(j.ctrlKey&&j.shiftKey&&j.key.toLowerCase()==="s"||j.ctrlKey&&j.key.toLowerCase()==="s")&&(j.preventDefault(),alert("captura des"))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("contextmenu",_),document.removeEventListener("keydown",e)}},[]),jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(SocketProvider,{children:jsxRuntimeExports.jsx(RouterProvider,{router})})}));function Virtual(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;j({virtual:{enabled:!1,slides:[],cache:!0,renderSlide:null,renderExternal:null,renderExternalUpdate:!0,addSlidesBefore:0,addSlidesAfter:0}});let _r;const _o=getDocument();e.virtual={cache:{},from:void 0,to:void 0,slides:[],offset:0,slidesGrid:[]};const ga=_o.createElement("div");function _a(rE,oE){const dE=e.params.virtual;if(dE.cache&&e.virtual.cache[oE])return e.virtual.cache[oE];let nE;return dE.renderSlide?(nE=dE.renderSlide.call(e,rE,oE),typeof nE=="string"&&(ga.innerHTML=nE,nE=ga.children[0])):e.isElement?nE=createElement("swiper-slide"):nE=createElement("div",e.params.slideClass),nE.setAttribute("data-swiper-slide-index",oE),dE.renderSlide||(nE.innerHTML=rE),dE.cache&&(e.virtual.cache[oE]=nE),nE}function _l(rE,oE){const{slidesPerView:dE,slidesPerGroup:nE,centeredSlides:sE,loop:lE,initialSlide:EE}=e.params;if(oE&&!lE&&EE>0)return;const{addSlidesBefore:wE,addSlidesAfter:IE}=e.params.virtual,{from:_E,to:kE,slides:ME,slidesGrid:bE,offset:LE}=e.virtual;e.params.cssMode||e.updateActiveIndex();const TE=e.activeIndex||0;let OE;e.rtlTranslate?OE="right":OE=e.isHorizontal()?"left":"top";let vE,NE;sE?(vE=Math.floor(dE/2)+nE+IE,NE=Math.floor(dE/2)+nE+wE):(vE=dE+(nE-1)+IE,NE=(lE?dE:nE)+wE);let jE=TE-NE,UE=TE+vE;lE||(jE=Math.max(jE,0),UE=Math.min(UE,ME.length-1));let RE=(e.slidesGrid[jE]||0)-(e.slidesGrid[0]||0);lE&&TE>=NE?(jE-=NE,sE||(RE+=e.slidesGrid[0])):lE&&TE<NE&&(jE=-NE,sE&&(RE+=e.slidesGrid[0])),Object.assign(e.virtual,{from:jE,to:UE,offset:RE,slidesGrid:e.slidesGrid,slidesBefore:NE,slidesAfter:vE});function FE(){e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),zt("virtualUpdate")}if(_E===jE&&kE===UE&&!rE){e.slidesGrid!==bE&&RE!==LE&&e.slides.forEach(m_=>{m_.style[OE]=`${RE-Math.abs(e.cssOverflowAdjustment())}px`}),e.updateProgress(),zt("virtualUpdate");return}if(e.params.virtual.renderExternal){e.params.virtual.renderExternal.call(e,{offset:RE,from:jE,to:UE,slides:function(){const I_=[];for(let w0=jE;w0<=UE;w0+=1)I_.push(ME[w0]);return I_}()}),e.params.virtual.renderExternalUpdate?FE():zt("virtualUpdate");return}const VE=[],BE=[],qE=m_=>{let I_=m_;return m_<0?I_=ME.length+m_:I_>=ME.length&&(I_=I_-ME.length),I_};if(rE)e.slides.filter(m_=>m_.matches(`.${e.params.slideClass}, swiper-slide`)).forEach(m_=>{m_.remove()});else for(let m_=_E;m_<=kE;m_+=1)if(m_<jE||m_>UE){const I_=qE(m_);e.slides.filter(w0=>w0.matches(`.${e.params.slideClass}[data-swiper-slide-index="${I_}"], swiper-slide[data-swiper-slide-index="${I_}"]`)).forEach(w0=>{w0.remove()})}const e_=lE?-ME.length:0,b_=lE?ME.length*2:ME.length;for(let m_=e_;m_<b_;m_+=1)if(m_>=jE&&m_<=UE){const I_=qE(m_);typeof kE>"u"||rE?BE.push(I_):(m_>kE&&BE.push(I_),m_<_E&&VE.push(I_))}if(BE.forEach(m_=>{e.slidesEl.append(_a(ME[m_],m_))}),lE)for(let m_=VE.length-1;m_>=0;m_-=1){const I_=VE[m_];e.slidesEl.prepend(_a(ME[I_],I_))}else VE.sort((m_,I_)=>I_-m_),VE.forEach(m_=>{e.slidesEl.prepend(_a(ME[m_],m_))});elementChildren(e.slidesEl,".swiper-slide, swiper-slide").forEach(m_=>{m_.style[OE]=`${RE-Math.abs(e.cssOverflowAdjustment())}px`}),FE()}function _d(rE){if(typeof rE=="object"&&"length"in rE)for(let oE=0;oE<rE.length;oE+=1)rE[oE]&&e.virtual.slides.push(rE[oE]);else e.virtual.slides.push(rE);_l(!0)}function _f(rE){const oE=e.activeIndex;let dE=oE+1,nE=1;if(Array.isArray(rE)){for(let sE=0;sE<rE.length;sE+=1)rE[sE]&&e.virtual.slides.unshift(rE[sE]);dE=oE+rE.length,nE=rE.length}else e.virtual.slides.unshift(rE);if(e.params.virtual.cache){const sE=e.virtual.cache,lE={};Object.keys(sE).forEach(EE=>{const wE=sE[EE],IE=wE.getAttribute("data-swiper-slide-index");IE&&wE.setAttribute("data-swiper-slide-index",parseInt(IE,10)+nE),lE[parseInt(EE,10)+nE]=wE}),e.virtual.cache=lE}_l(!0),e.slideTo(dE,0)}function _m(rE){if(typeof rE>"u"||rE===null)return;let oE=e.activeIndex;if(Array.isArray(rE))for(let dE=rE.length-1;dE>=0;dE-=1)e.params.virtual.cache&&(delete e.virtual.cache[rE[dE]],Object.keys(e.virtual.cache).forEach(nE=>{nE>rE&&(e.virtual.cache[nE-1]=e.virtual.cache[nE],e.virtual.cache[nE-1].setAttribute("data-swiper-slide-index",nE-1),delete e.virtual.cache[nE])})),e.virtual.slides.splice(rE[dE],1),rE[dE]<oE&&(oE-=1),oE=Math.max(oE,0);else e.params.virtual.cache&&(delete e.virtual.cache[rE],Object.keys(e.virtual.cache).forEach(dE=>{dE>rE&&(e.virtual.cache[dE-1]=e.virtual.cache[dE],e.virtual.cache[dE-1].setAttribute("data-swiper-slide-index",dE-1),delete e.virtual.cache[dE])})),e.virtual.slides.splice(rE,1),rE<oE&&(oE-=1),oE=Math.max(oE,0);_l(!0),e.slideTo(oE,0)}function tE(){e.virtual.slides=[],e.params.virtual.cache&&(e.virtual.cache={}),_l(!0),e.slideTo(0,0)}Vt("beforeInit",()=>{if(!e.params.virtual.enabled)return;let rE;if(typeof e.passedParams.virtual.slides>"u"){const oE=[...e.slidesEl.children].filter(dE=>dE.matches(`.${e.params.slideClass}, swiper-slide`));oE&&oE.length&&(e.virtual.slides=[...oE],rE=!0,oE.forEach((dE,nE)=>{dE.setAttribute("data-swiper-slide-index",nE),e.virtual.cache[nE]=dE,dE.remove()}))}rE||(e.virtual.slides=e.params.virtual.slides),e.classNames.push(`${e.params.containerModifierClass}virtual`),e.params.watchSlidesProgress=!0,e.originalParams.watchSlidesProgress=!0,_l(!1,!0)}),Vt("setTranslate",()=>{e.params.virtual.enabled&&(e.params.cssMode&&!e._immediateVirtual?(clearTimeout(_r),_r=setTimeout(()=>{_l()},100)):_l())}),Vt("init update resize",()=>{e.params.virtual.enabled&&e.params.cssMode&&setCSSProperty(e.wrapperEl,"--swiper-virtual-size",`${e.virtualSize}px`)}),Object.assign(e.virtual,{appendSlide:_d,prependSlide:_f,removeSlide:_m,removeAllSlides:tE,update:_l})}function Keyboard(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r=getDocument(),_o=getWindow();e.keyboard={enabled:!1},j({keyboard:{enabled:!1,onlyInViewport:!0,pageUpDown:!0}});function ga(_d){if(!e.enabled)return;const{rtlTranslate:_f}=e;let _m=_d;_m.originalEvent&&(_m=_m.originalEvent);const tE=_m.keyCode||_m.charCode,rE=e.params.keyboard.pageUpDown,oE=rE&&tE===33,dE=rE&&tE===34,nE=tE===37,sE=tE===39,lE=tE===38,EE=tE===40;if(!e.allowSlideNext&&(e.isHorizontal()&&sE||e.isVertical()&&EE||dE)||!e.allowSlidePrev&&(e.isHorizontal()&&nE||e.isVertical()&&lE||oE))return!1;if(!(_m.shiftKey||_m.altKey||_m.ctrlKey||_m.metaKey)&&!(_r.activeElement&&_r.activeElement.nodeName&&(_r.activeElement.nodeName.toLowerCase()==="input"||_r.activeElement.nodeName.toLowerCase()==="textarea"))){if(e.params.keyboard.onlyInViewport&&(oE||dE||nE||sE||lE||EE)){let wE=!1;if(elementParents(e.el,`.${e.params.slideClass}, swiper-slide`).length>0&&elementParents(e.el,`.${e.params.slideActiveClass}`).length===0)return;const IE=e.el,_E=IE.clientWidth,kE=IE.clientHeight,ME=_o.innerWidth,bE=_o.innerHeight,LE=elementOffset(IE);_f&&(LE.left-=IE.scrollLeft);const TE=[[LE.left,LE.top],[LE.left+_E,LE.top],[LE.left,LE.top+kE],[LE.left+_E,LE.top+kE]];for(let OE=0;OE<TE.length;OE+=1){const vE=TE[OE];if(vE[0]>=0&&vE[0]<=ME&&vE[1]>=0&&vE[1]<=bE){if(vE[0]===0&&vE[1]===0)continue;wE=!0}}if(!wE)return}e.isHorizontal()?((oE||dE||nE||sE)&&(_m.preventDefault?_m.preventDefault():_m.returnValue=!1),((dE||sE)&&!_f||(oE||nE)&&_f)&&e.slideNext(),((oE||nE)&&!_f||(dE||sE)&&_f)&&e.slidePrev()):((oE||dE||lE||EE)&&(_m.preventDefault?_m.preventDefault():_m.returnValue=!1),(dE||EE)&&e.slideNext(),(oE||lE)&&e.slidePrev()),zt("keyPress",tE)}}function _a(){e.keyboard.enabled||(_r.addEventListener("keydown",ga),e.keyboard.enabled=!0)}function _l(){e.keyboard.enabled&&(_r.removeEventListener("keydown",ga),e.keyboard.enabled=!1)}Vt("init",()=>{e.params.keyboard.enabled&&_a()}),Vt("destroy",()=>{e.keyboard.enabled&&_l()}),Object.assign(e.keyboard,{enable:_a,disable:_l})}function Mousewheel(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r=getWindow();j({mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarget:"container",thresholdDelta:null,thresholdTime:null,noMousewheelClass:"swiper-no-mousewheel"}}),e.mousewheel={enabled:!1};let _o,ga=now(),_a;const _l=[];function _d(lE){let _E=0,kE=0,ME=0,bE=0;return"detail"in lE&&(kE=lE.detail),"wheelDelta"in lE&&(kE=-lE.wheelDelta/120),"wheelDeltaY"in lE&&(kE=-lE.wheelDeltaY/120),"wheelDeltaX"in lE&&(_E=-lE.wheelDeltaX/120),"axis"in lE&&lE.axis===lE.HORIZONTAL_AXIS&&(_E=kE,kE=0),ME=_E*10,bE=kE*10,"deltaY"in lE&&(bE=lE.deltaY),"deltaX"in lE&&(ME=lE.deltaX),lE.shiftKey&&!ME&&(ME=bE,bE=0),(ME||bE)&&lE.deltaMode&&(lE.deltaMode===1?(ME*=40,bE*=40):(ME*=800,bE*=800)),ME&&!_E&&(_E=ME<1?-1:1),bE&&!kE&&(kE=bE<1?-1:1),{spinX:_E,spinY:kE,pixelX:ME,pixelY:bE}}function _f(){e.enabled&&(e.mouseEntered=!0)}function _m(){e.enabled&&(e.mouseEntered=!1)}function tE(lE){return e.params.mousewheel.thresholdDelta&&lE.delta<e.params.mousewheel.thresholdDelta||e.params.mousewheel.thresholdTime&&now()-ga<e.params.mousewheel.thresholdTime?!1:lE.delta>=6&&now()-ga<60?!0:(lE.direction<0?(!e.isEnd||e.params.loop)&&!e.animating&&(e.slideNext(),zt("scroll",lE.raw)):(!e.isBeginning||e.params.loop)&&!e.animating&&(e.slidePrev(),zt("scroll",lE.raw)),ga=new _r.Date().getTime(),!1)}function rE(lE){const EE=e.params.mousewheel;if(lE.direction<0){if(e.isEnd&&!e.params.loop&&EE.releaseOnEdges)return!0}else if(e.isBeginning&&!e.params.loop&&EE.releaseOnEdges)return!0;return!1}function oE(lE){let EE=lE,wE=!0;if(!e.enabled||lE.target.closest(`.${e.params.mousewheel.noMousewheelClass}`))return;const IE=e.params.mousewheel;e.params.cssMode&&EE.preventDefault();let _E=e.el;e.params.mousewheel.eventsTarget!=="container"&&(_E=document.querySelector(e.params.mousewheel.eventsTarget));const kE=_E&&_E.contains(EE.target);if(!e.mouseEntered&&!kE&&!IE.releaseOnEdges)return!0;EE.originalEvent&&(EE=EE.originalEvent);let ME=0;const bE=e.rtlTranslate?-1:1,LE=_d(EE);if(IE.forceToAxis)if(e.isHorizontal())if(Math.abs(LE.pixelX)>Math.abs(LE.pixelY))ME=-LE.pixelX*bE;else return!0;else if(Math.abs(LE.pixelY)>Math.abs(LE.pixelX))ME=-LE.pixelY;else return!0;else ME=Math.abs(LE.pixelX)>Math.abs(LE.pixelY)?-LE.pixelX*bE:-LE.pixelY;if(ME===0)return!0;IE.invert&&(ME=-ME);let TE=e.getTranslate()+ME*IE.sensitivity;if(TE>=e.minTranslate()&&(TE=e.minTranslate()),TE<=e.maxTranslate()&&(TE=e.maxTranslate()),wE=e.params.loop?!0:!(TE===e.minTranslate()||TE===e.maxTranslate()),wE&&e.params.nested&&EE.stopPropagation(),!e.params.freeMode||!e.params.freeMode.enabled){const OE={time:now(),delta:Math.abs(ME),direction:Math.sign(ME),raw:lE};_l.length>=2&&_l.shift();const vE=_l.length?_l[_l.length-1]:void 0;if(_l.push(OE),vE?(OE.direction!==vE.direction||OE.delta>vE.delta||OE.time>vE.time+150)&&tE(OE):tE(OE),rE(OE))return!0}else{const OE={time:now(),delta:Math.abs(ME),direction:Math.sign(ME)},vE=_a&&OE.time<_a.time+500&&OE.delta<=_a.delta&&OE.direction===_a.direction;if(!vE){_a=void 0;let NE=e.getTranslate()+ME*IE.sensitivity;const jE=e.isBeginning,UE=e.isEnd;if(NE>=e.minTranslate()&&(NE=e.minTranslate()),NE<=e.maxTranslate()&&(NE=e.maxTranslate()),e.setTransition(0),e.setTranslate(NE),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses(),(!jE&&e.isBeginning||!UE&&e.isEnd)&&e.updateSlidesClasses(),e.params.loop&&e.loopFix({direction:OE.direction<0?"next":"prev",byMousewheel:!0}),e.params.freeMode.sticky){clearTimeout(_o),_o=void 0,_l.length>=15&&_l.shift();const RE=_l.length?_l[_l.length-1]:void 0,FE=_l[0];if(_l.push(OE),RE&&(OE.delta>RE.delta||OE.direction!==RE.direction))_l.splice(0);else if(_l.length>=15&&OE.time-FE.time<500&&FE.delta-OE.delta>=1&&OE.delta<=6){const VE=ME>0?.8:.2;_a=OE,_l.splice(0),_o=nextTick(()=>{e.slideToClosest(e.params.speed,!0,void 0,VE)},0)}_o||(_o=nextTick(()=>{_a=OE,_l.splice(0),e.slideToClosest(e.params.speed,!0,void 0,.5)},500))}if(vE||zt("scroll",EE),e.params.autoplay&&e.params.autoplayDisableOnInteraction&&e.autoplay.stop(),IE.releaseOnEdges&&(NE===e.minTranslate()||NE===e.maxTranslate()))return!0}}return EE.preventDefault?EE.preventDefault():EE.returnValue=!1,!1}function dE(lE){let EE=e.el;e.params.mousewheel.eventsTarget!=="container"&&(EE=document.querySelector(e.params.mousewheel.eventsTarget)),EE[lE]("mouseenter",_f),EE[lE]("mouseleave",_m),EE[lE]("wheel",oE)}function nE(){return e.params.cssMode?(e.wrapperEl.removeEventListener("wheel",oE),!0):e.mousewheel.enabled?!1:(dE("addEventListener"),e.mousewheel.enabled=!0,!0)}function sE(){return e.params.cssMode?(e.wrapperEl.addEventListener(event,oE),!0):e.mousewheel.enabled?(dE("removeEventListener"),e.mousewheel.enabled=!1,!0):!1}Vt("init",()=>{!e.params.mousewheel.enabled&&e.params.cssMode&&sE(),e.params.mousewheel.enabled&&nE()}),Vt("destroy",()=>{e.params.cssMode&&nE(),e.mousewheel.enabled&&sE()}),Object.assign(e.mousewheel,{enable:nE,disable:sE})}function createElementIfNotDefined(_,e,j,Vt){return _.params.createElements&&Object.keys(Vt).forEach(zt=>{if(!j[zt]&&j.auto===!0){let _r=elementChildren(_.el,`.${Vt[zt]}`)[0];_r||(_r=createElement("div",Vt[zt]),_r.className=Vt[zt],_.el.append(_r)),j[zt]=_r,e[zt]=_r}}),j}function Navigation(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;j({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};function _r(rE){let oE;return rE&&typeof rE=="string"&&e.isElement&&(oE=e.el.querySelector(rE),oE)?oE:(rE&&(typeof rE=="string"&&(oE=[...document.querySelectorAll(rE)]),e.params.uniqueNavElements&&typeof rE=="string"&&oE&&oE.length>1&&e.el.querySelectorAll(rE).length===1?oE=e.el.querySelector(rE):oE&&oE.length===1&&(oE=oE[0])),rE&&!oE?rE:oE)}function _o(rE,oE){const dE=e.params.navigation;rE=makeElementsArray(rE),rE.forEach(nE=>{nE&&(nE.classList[oE?"add":"remove"](...dE.disabledClass.split(" ")),nE.tagName==="BUTTON"&&(nE.disabled=oE),e.params.watchOverflow&&e.enabled&&nE.classList[e.isLocked?"add":"remove"](dE.lockClass))})}function ga(){const{nextEl:rE,prevEl:oE}=e.navigation;if(e.params.loop){_o(oE,!1),_o(rE,!1);return}_o(oE,e.isBeginning&&!e.params.rewind),_o(rE,e.isEnd&&!e.params.rewind)}function _a(rE){rE.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),zt("navigationPrev"))}function _l(rE){rE.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),zt("navigationNext"))}function _d(){const rE=e.params.navigation;if(e.params.navigation=createElementIfNotDefined(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(rE.nextEl||rE.prevEl))return;let oE=_r(rE.nextEl),dE=_r(rE.prevEl);Object.assign(e.navigation,{nextEl:oE,prevEl:dE}),oE=makeElementsArray(oE),dE=makeElementsArray(dE);const nE=(sE,lE)=>{sE&&sE.addEventListener("click",lE==="next"?_l:_a),!e.enabled&&sE&&sE.classList.add(...rE.lockClass.split(" "))};oE.forEach(sE=>nE(sE,"next")),dE.forEach(sE=>nE(sE,"prev"))}function _f(){let{nextEl:rE,prevEl:oE}=e.navigation;rE=makeElementsArray(rE),oE=makeElementsArray(oE);const dE=(nE,sE)=>{nE.removeEventListener("click",sE==="next"?_l:_a),nE.classList.remove(...e.params.navigation.disabledClass.split(" "))};rE.forEach(nE=>dE(nE,"next")),oE.forEach(nE=>dE(nE,"prev"))}Vt("init",()=>{e.params.navigation.enabled===!1?tE():(_d(),ga())}),Vt("toEdge fromEdge lock unlock",()=>{ga()}),Vt("destroy",()=>{_f()}),Vt("enable disable",()=>{let{nextEl:rE,prevEl:oE}=e.navigation;if(rE=makeElementsArray(rE),oE=makeElementsArray(oE),e.enabled){ga();return}[...rE,...oE].filter(dE=>!!dE).forEach(dE=>dE.classList.add(e.params.navigation.lockClass))}),Vt("click",(rE,oE)=>{let{nextEl:dE,prevEl:nE}=e.navigation;dE=makeElementsArray(dE),nE=makeElementsArray(nE);const sE=oE.target;let lE=nE.includes(sE)||dE.includes(sE);if(e.isElement&&!lE){const EE=oE.path||oE.composedPath&&oE.composedPath();EE&&(lE=EE.find(wE=>dE.includes(wE)||nE.includes(wE)))}if(e.params.navigation.hideOnClick&&!lE){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===sE||e.pagination.el.contains(sE)))return;let EE;dE.length?EE=dE[0].classList.contains(e.params.navigation.hiddenClass):nE.length&&(EE=nE[0].classList.contains(e.params.navigation.hiddenClass)),zt(EE===!0?"navigationShow":"navigationHide"),[...dE,...nE].filter(wE=>!!wE).forEach(wE=>wE.classList.toggle(e.params.navigation.hiddenClass))}});const _m=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),_d(),ga()},tE=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),_f()};Object.assign(e.navigation,{enable:_m,disable:tE,update:ga,init:_d,destroy:_f})}function classesToSelector(_){return _===void 0&&(_=""),`.${_.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function Pagination(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r="swiper-pagination";j({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:nE=>nE,formatFractionTotal:nE=>nE,bulletClass:`${_r}-bullet`,bulletActiveClass:`${_r}-bullet-active`,modifierClass:`${_r}-`,currentClass:`${_r}-current`,totalClass:`${_r}-total`,hiddenClass:`${_r}-hidden`,progressbarFillClass:`${_r}-progressbar-fill`,progressbarOppositeClass:`${_r}-progressbar-opposite`,clickableClass:`${_r}-clickable`,lockClass:`${_r}-lock`,horizontalClass:`${_r}-horizontal`,verticalClass:`${_r}-vertical`,paginationDisabledClass:`${_r}-disabled`}}),e.pagination={el:null,bullets:[]};let _o,ga=0;function _a(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function _l(nE,sE){const{bulletActiveClass:lE}=e.params.pagination;nE&&(nE=nE[`${sE==="prev"?"previous":"next"}ElementSibling`],nE&&(nE.classList.add(`${lE}-${sE}`),nE=nE[`${sE==="prev"?"previous":"next"}ElementSibling`],nE&&nE.classList.add(`${lE}-${sE}-${sE}`)))}function _d(nE){const sE=nE.target.closest(classesToSelector(e.params.pagination.bulletClass));if(!sE)return;nE.preventDefault();const lE=elementIndex(sE)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===lE)return;e.slideToLoop(lE)}else e.slideTo(lE)}function _f(){const nE=e.rtl,sE=e.params.pagination;if(_a())return;let lE=e.pagination.el;lE=makeElementsArray(lE);let EE,wE;const IE=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,_E=e.params.loop?Math.ceil(IE/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(wE=e.previousRealIndex||0,EE=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(EE=e.snapIndex,wE=e.previousSnapIndex):(wE=e.previousIndex||0,EE=e.activeIndex||0),sE.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){const kE=e.pagination.bullets;let ME,bE,LE;if(sE.dynamicBullets&&(_o=elementOuterSize(kE[0],e.isHorizontal()?"width":"height"),lE.forEach(TE=>{TE.style[e.isHorizontal()?"width":"height"]=`${_o*(sE.dynamicMainBullets+4)}px`}),sE.dynamicMainBullets>1&&wE!==void 0&&(ga+=EE-(wE||0),ga>sE.dynamicMainBullets-1?ga=sE.dynamicMainBullets-1:ga<0&&(ga=0)),ME=Math.max(EE-ga,0),bE=ME+(Math.min(kE.length,sE.dynamicMainBullets)-1),LE=(bE+ME)/2),kE.forEach(TE=>{const OE=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(vE=>`${sE.bulletActiveClass}${vE}`)].map(vE=>typeof vE=="string"&&vE.includes(" ")?vE.split(" "):vE).flat();TE.classList.remove(...OE)}),lE.length>1)kE.forEach(TE=>{const OE=elementIndex(TE);OE===EE?TE.classList.add(...sE.bulletActiveClass.split(" ")):e.isElement&&TE.setAttribute("part","bullet"),sE.dynamicBullets&&(OE>=ME&&OE<=bE&&TE.classList.add(...`${sE.bulletActiveClass}-main`.split(" ")),OE===ME&&_l(TE,"prev"),OE===bE&&_l(TE,"next"))});else{const TE=kE[EE];if(TE&&TE.classList.add(...sE.bulletActiveClass.split(" ")),e.isElement&&kE.forEach((OE,vE)=>{OE.setAttribute("part",vE===EE?"bullet-active":"bullet")}),sE.dynamicBullets){const OE=kE[ME],vE=kE[bE];for(let NE=ME;NE<=bE;NE+=1)kE[NE]&&kE[NE].classList.add(...`${sE.bulletActiveClass}-main`.split(" "));_l(OE,"prev"),_l(vE,"next")}}if(sE.dynamicBullets){const TE=Math.min(kE.length,sE.dynamicMainBullets+4),OE=(_o*TE-_o)/2-LE*_o,vE=nE?"right":"left";kE.forEach(NE=>{NE.style[e.isHorizontal()?vE:"top"]=`${OE}px`})}}lE.forEach((kE,ME)=>{if(sE.type==="fraction"&&(kE.querySelectorAll(classesToSelector(sE.currentClass)).forEach(bE=>{bE.textContent=sE.formatFractionCurrent(EE+1)}),kE.querySelectorAll(classesToSelector(sE.totalClass)).forEach(bE=>{bE.textContent=sE.formatFractionTotal(_E)})),sE.type==="progressbar"){let bE;sE.progressbarOpposite?bE=e.isHorizontal()?"vertical":"horizontal":bE=e.isHorizontal()?"horizontal":"vertical";const LE=(EE+1)/_E;let TE=1,OE=1;bE==="horizontal"?TE=LE:OE=LE,kE.querySelectorAll(classesToSelector(sE.progressbarFillClass)).forEach(vE=>{vE.style.transform=`translate3d(0,0,0) scaleX(${TE}) scaleY(${OE})`,vE.style.transitionDuration=`${e.params.speed}ms`})}sE.type==="custom"&&sE.renderCustom?(kE.innerHTML=sE.renderCustom(e,EE+1,_E),ME===0&&zt("paginationRender",kE)):(ME===0&&zt("paginationRender",kE),zt("paginationUpdate",kE)),e.params.watchOverflow&&e.enabled&&kE.classList[e.isLocked?"add":"remove"](sE.lockClass)})}function _m(){const nE=e.params.pagination;if(_a())return;const sE=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length;let lE=e.pagination.el;lE=makeElementsArray(lE);let EE="";if(nE.type==="bullets"){let wE=e.params.loop?Math.ceil(sE/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&wE>sE&&(wE=sE);for(let IE=0;IE<wE;IE+=1)nE.renderBullet?EE+=nE.renderBullet.call(e,IE,nE.bulletClass):EE+=`<${nE.bulletElement} ${e.isElement?'part="bullet"':""} class="${nE.bulletClass}"></${nE.bulletElement}>`}nE.type==="fraction"&&(nE.renderFraction?EE=nE.renderFraction.call(e,nE.currentClass,nE.totalClass):EE=`<span class="${nE.currentClass}"></span> / <span class="${nE.totalClass}"></span>`),nE.type==="progressbar"&&(nE.renderProgressbar?EE=nE.renderProgressbar.call(e,nE.progressbarFillClass):EE=`<span class="${nE.progressbarFillClass}"></span>`),e.pagination.bullets=[],lE.forEach(wE=>{nE.type!=="custom"&&(wE.innerHTML=EE||""),nE.type==="bullets"&&e.pagination.bullets.push(...wE.querySelectorAll(classesToSelector(nE.bulletClass)))}),nE.type!=="custom"&&zt("paginationRender",lE[0])}function tE(){e.params.pagination=createElementIfNotDefined(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const nE=e.params.pagination;if(!nE.el)return;let sE;typeof nE.el=="string"&&e.isElement&&(sE=e.el.querySelector(nE.el)),!sE&&typeof nE.el=="string"&&(sE=[...document.querySelectorAll(nE.el)]),sE||(sE=nE.el),!(!sE||sE.length===0)&&(e.params.uniqueNavElements&&typeof nE.el=="string"&&Array.isArray(sE)&&sE.length>1&&(sE=[...e.el.querySelectorAll(nE.el)],sE.length>1&&(sE=sE.filter(lE=>elementParents(lE,".swiper")[0]===e.el)[0])),Array.isArray(sE)&&sE.length===1&&(sE=sE[0]),Object.assign(e.pagination,{el:sE}),sE=makeElementsArray(sE),sE.forEach(lE=>{nE.type==="bullets"&&nE.clickable&&lE.classList.add(...(nE.clickableClass||"").split(" ")),lE.classList.add(nE.modifierClass+nE.type),lE.classList.add(e.isHorizontal()?nE.horizontalClass:nE.verticalClass),nE.type==="bullets"&&nE.dynamicBullets&&(lE.classList.add(`${nE.modifierClass}${nE.type}-dynamic`),ga=0,nE.dynamicMainBullets<1&&(nE.dynamicMainBullets=1)),nE.type==="progressbar"&&nE.progressbarOpposite&&lE.classList.add(nE.progressbarOppositeClass),nE.clickable&&lE.addEventListener("click",_d),e.enabled||lE.classList.add(nE.lockClass)}))}function rE(){const nE=e.params.pagination;if(_a())return;let sE=e.pagination.el;sE&&(sE=makeElementsArray(sE),sE.forEach(lE=>{lE.classList.remove(nE.hiddenClass),lE.classList.remove(nE.modifierClass+nE.type),lE.classList.remove(e.isHorizontal()?nE.horizontalClass:nE.verticalClass),nE.clickable&&(lE.classList.remove(...(nE.clickableClass||"").split(" ")),lE.removeEventListener("click",_d))})),e.pagination.bullets&&e.pagination.bullets.forEach(lE=>lE.classList.remove(...nE.bulletActiveClass.split(" ")))}Vt("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;const nE=e.params.pagination;let{el:sE}=e.pagination;sE=makeElementsArray(sE),sE.forEach(lE=>{lE.classList.remove(nE.horizontalClass,nE.verticalClass),lE.classList.add(e.isHorizontal()?nE.horizontalClass:nE.verticalClass)})}),Vt("init",()=>{e.params.pagination.enabled===!1?dE():(tE(),_m(),_f())}),Vt("activeIndexChange",()=>{typeof e.snapIndex>"u"&&_f()}),Vt("snapIndexChange",()=>{_f()}),Vt("snapGridLengthChange",()=>{_m(),_f()}),Vt("destroy",()=>{rE()}),Vt("enable disable",()=>{let{el:nE}=e.pagination;nE&&(nE=makeElementsArray(nE),nE.forEach(sE=>sE.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),Vt("lock unlock",()=>{_f()}),Vt("click",(nE,sE)=>{const lE=sE.target,EE=makeElementsArray(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&EE&&EE.length>0&&!lE.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&lE===e.navigation.nextEl||e.navigation.prevEl&&lE===e.navigation.prevEl))return;const wE=EE[0].classList.contains(e.params.pagination.hiddenClass);zt(wE===!0?"paginationShow":"paginationHide"),EE.forEach(IE=>IE.classList.toggle(e.params.pagination.hiddenClass))}});const oE=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:nE}=e.pagination;nE&&(nE=makeElementsArray(nE),nE.forEach(sE=>sE.classList.remove(e.params.pagination.paginationDisabledClass))),tE(),_m(),_f()},dE=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:nE}=e.pagination;nE&&(nE=makeElementsArray(nE),nE.forEach(sE=>sE.classList.add(e.params.pagination.paginationDisabledClass))),rE()};Object.assign(e.pagination,{enable:oE,disable:dE,render:_m,update:_f,init:tE,destroy:rE})}function Scrollbar(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r=getDocument();let _o=!1,ga=null,_a=null,_l,_d,_f,_m;j({scrollbar:{el:null,dragSize:"auto",hide:!1,draggable:!1,snapOnRelease:!0,lockClass:"swiper-scrollbar-lock",dragClass:"swiper-scrollbar-drag",scrollbarDisabledClass:"swiper-scrollbar-disabled",horizontalClass:"swiper-scrollbar-horizontal",verticalClass:"swiper-scrollbar-vertical"}}),e.scrollbar={el:null,dragEl:null};function tE(){if(!e.params.scrollbar.el||!e.scrollbar.el)return;const{scrollbar:TE,rtlTranslate:OE}=e,{dragEl:vE,el:NE}=TE,jE=e.params.scrollbar,UE=e.params.loop?e.progressLoop:e.progress;let RE=_d,FE=(_f-_d)*UE;OE?(FE=-FE,FE>0?(RE=_d-FE,FE=0):-FE+_d>_f&&(RE=_f+FE)):FE<0?(RE=_d+FE,FE=0):FE+_d>_f&&(RE=_f-FE),e.isHorizontal()?(vE.style.transform=`translate3d(${FE}px, 0, 0)`,vE.style.width=`${RE}px`):(vE.style.transform=`translate3d(0px, ${FE}px, 0)`,vE.style.height=`${RE}px`),jE.hide&&(clearTimeout(ga),NE.style.opacity=1,ga=setTimeout(()=>{NE.style.opacity=0,NE.style.transitionDuration="400ms"},1e3))}function rE(TE){!e.params.scrollbar.el||!e.scrollbar.el||(e.scrollbar.dragEl.style.transitionDuration=`${TE}ms`)}function oE(){if(!e.params.scrollbar.el||!e.scrollbar.el)return;const{scrollbar:TE}=e,{dragEl:OE,el:vE}=TE;OE.style.width="",OE.style.height="",_f=e.isHorizontal()?vE.offsetWidth:vE.offsetHeight,_m=e.size/(e.virtualSize+e.params.slidesOffsetBefore-(e.params.centeredSlides?e.snapGrid[0]:0)),e.params.scrollbar.dragSize==="auto"?_d=_f*_m:_d=parseInt(e.params.scrollbar.dragSize,10),e.isHorizontal()?OE.style.width=`${_d}px`:OE.style.height=`${_d}px`,_m>=1?vE.style.display="none":vE.style.display="",e.params.scrollbar.hide&&(vE.style.opacity=0),e.params.watchOverflow&&e.enabled&&TE.el.classList[e.isLocked?"add":"remove"](e.params.scrollbar.lockClass)}function dE(TE){return e.isHorizontal()?TE.clientX:TE.clientY}function nE(TE){const{scrollbar:OE,rtlTranslate:vE}=e,{el:NE}=OE;let jE;jE=(dE(TE)-elementOffset(NE)[e.isHorizontal()?"left":"top"]-(_l!==null?_l:_d/2))/(_f-_d),jE=Math.max(Math.min(jE,1),0),vE&&(jE=1-jE);const UE=e.minTranslate()+(e.maxTranslate()-e.minTranslate())*jE;e.updateProgress(UE),e.setTranslate(UE),e.updateActiveIndex(),e.updateSlidesClasses()}function sE(TE){const OE=e.params.scrollbar,{scrollbar:vE,wrapperEl:NE}=e,{el:jE,dragEl:UE}=vE;_o=!0,_l=TE.target===UE?dE(TE)-TE.target.getBoundingClientRect()[e.isHorizontal()?"left":"top"]:null,TE.preventDefault(),TE.stopPropagation(),NE.style.transitionDuration="100ms",UE.style.transitionDuration="100ms",nE(TE),clearTimeout(_a),jE.style.transitionDuration="0ms",OE.hide&&(jE.style.opacity=1),e.params.cssMode&&(e.wrapperEl.style["scroll-snap-type"]="none"),zt("scrollbarDragStart",TE)}function lE(TE){const{scrollbar:OE,wrapperEl:vE}=e,{el:NE,dragEl:jE}=OE;_o&&(TE.preventDefault&&TE.cancelable?TE.preventDefault():TE.returnValue=!1,nE(TE),vE.style.transitionDuration="0ms",NE.style.transitionDuration="0ms",jE.style.transitionDuration="0ms",zt("scrollbarDragMove",TE))}function EE(TE){const OE=e.params.scrollbar,{scrollbar:vE,wrapperEl:NE}=e,{el:jE}=vE;_o&&(_o=!1,e.params.cssMode&&(e.wrapperEl.style["scroll-snap-type"]="",NE.style.transitionDuration=""),OE.hide&&(clearTimeout(_a),_a=nextTick(()=>{jE.style.opacity=0,jE.style.transitionDuration="400ms"},1e3)),zt("scrollbarDragEnd",TE),OE.snapOnRelease&&e.slideToClosest())}function wE(TE){const{scrollbar:OE,params:vE}=e,NE=OE.el;if(!NE)return;const jE=NE,UE=vE.passiveListeners?{passive:!1,capture:!1}:!1,RE=vE.passiveListeners?{passive:!0,capture:!1}:!1;if(!jE)return;const FE=TE==="on"?"addEventListener":"removeEventListener";jE[FE]("pointerdown",sE,UE),_r[FE]("pointermove",lE,UE),_r[FE]("pointerup",EE,RE)}function IE(){!e.params.scrollbar.el||!e.scrollbar.el||wE("on")}function _E(){!e.params.scrollbar.el||!e.scrollbar.el||wE("off")}function kE(){const{scrollbar:TE,el:OE}=e;e.params.scrollbar=createElementIfNotDefined(e,e.originalParams.scrollbar,e.params.scrollbar,{el:"swiper-scrollbar"});const vE=e.params.scrollbar;if(!vE.el)return;let NE;if(typeof vE.el=="string"&&e.isElement&&(NE=e.el.querySelector(vE.el)),!NE&&typeof vE.el=="string"){if(NE=_r.querySelectorAll(vE.el),!NE.length)return}else NE||(NE=vE.el);e.params.uniqueNavElements&&typeof vE.el=="string"&&NE.length>1&&OE.querySelectorAll(vE.el).length===1&&(NE=OE.querySelector(vE.el)),NE.length>0&&(NE=NE[0]),NE.classList.add(e.isHorizontal()?vE.horizontalClass:vE.verticalClass);let jE;NE&&(jE=NE.querySelector(classesToSelector(e.params.scrollbar.dragClass)),jE||(jE=createElement("div",e.params.scrollbar.dragClass),NE.append(jE))),Object.assign(TE,{el:NE,dragEl:jE}),vE.draggable&&IE(),NE&&NE.classList[e.enabled?"remove":"add"](...classesToTokens(e.params.scrollbar.lockClass))}function ME(){const TE=e.params.scrollbar,OE=e.scrollbar.el;OE&&OE.classList.remove(...classesToTokens(e.isHorizontal()?TE.horizontalClass:TE.verticalClass)),_E()}Vt("changeDirection",()=>{if(!e.scrollbar||!e.scrollbar.el)return;const TE=e.params.scrollbar;let{el:OE}=e.scrollbar;OE=makeElementsArray(OE),OE.forEach(vE=>{vE.classList.remove(TE.horizontalClass,TE.verticalClass),vE.classList.add(e.isHorizontal()?TE.horizontalClass:TE.verticalClass)})}),Vt("init",()=>{e.params.scrollbar.enabled===!1?LE():(kE(),oE(),tE())}),Vt("update resize observerUpdate lock unlock changeDirection",()=>{oE()}),Vt("setTranslate",()=>{tE()}),Vt("setTransition",(TE,OE)=>{rE(OE)}),Vt("enable disable",()=>{const{el:TE}=e.scrollbar;TE&&TE.classList[e.enabled?"remove":"add"](...classesToTokens(e.params.scrollbar.lockClass))}),Vt("destroy",()=>{ME()});const bE=()=>{e.el.classList.remove(...classesToTokens(e.params.scrollbar.scrollbarDisabledClass)),e.scrollbar.el&&e.scrollbar.el.classList.remove(...classesToTokens(e.params.scrollbar.scrollbarDisabledClass)),kE(),oE(),tE()},LE=()=>{e.el.classList.add(...classesToTokens(e.params.scrollbar.scrollbarDisabledClass)),e.scrollbar.el&&e.scrollbar.el.classList.add(...classesToTokens(e.params.scrollbar.scrollbarDisabledClass)),ME()};Object.assign(e.scrollbar,{enable:bE,disable:LE,updateSize:oE,setTranslate:tE,init:kE,destroy:ME})}function Parallax(_){let{swiper:e,extendParams:j,on:Vt}=_;j({parallax:{enabled:!1}});const zt="[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]",_r=(_a,_l)=>{const{rtl:_d}=e,_f=_d?-1:1,_m=_a.getAttribute("data-swiper-parallax")||"0";let tE=_a.getAttribute("data-swiper-parallax-x"),rE=_a.getAttribute("data-swiper-parallax-y");const oE=_a.getAttribute("data-swiper-parallax-scale"),dE=_a.getAttribute("data-swiper-parallax-opacity"),nE=_a.getAttribute("data-swiper-parallax-rotate");if(tE||rE?(tE=tE||"0",rE=rE||"0"):e.isHorizontal()?(tE=_m,rE="0"):(rE=_m,tE="0"),tE.indexOf("%")>=0?tE=`${parseInt(tE,10)*_l*_f}%`:tE=`${tE*_l*_f}px`,rE.indexOf("%")>=0?rE=`${parseInt(rE,10)*_l}%`:rE=`${rE*_l}px`,typeof dE<"u"&&dE!==null){const lE=dE-(dE-1)*(1-Math.abs(_l));_a.style.opacity=lE}let sE=`translate3d(${tE}, ${rE}, 0px)`;if(typeof oE<"u"&&oE!==null){const lE=oE-(oE-1)*(1-Math.abs(_l));sE+=` scale(${lE})`}if(nE&&typeof nE<"u"&&nE!==null){const lE=nE*_l*-1;sE+=` rotate(${lE}deg)`}_a.style.transform=sE},_o=()=>{const{el:_a,slides:_l,progress:_d,snapGrid:_f,isElement:_m}=e,tE=elementChildren(_a,zt);e.isElement&&tE.push(...elementChildren(e.hostEl,zt)),tE.forEach(rE=>{_r(rE,_d)}),_l.forEach((rE,oE)=>{let dE=rE.progress;e.params.slidesPerGroup>1&&e.params.slidesPerView!=="auto"&&(dE+=Math.ceil(oE/2)-_d*(_f.length-1)),dE=Math.min(Math.max(dE,-1),1),rE.querySelectorAll(`${zt}, [data-swiper-parallax-rotate]`).forEach(nE=>{_r(nE,dE)})})},ga=function(_a){_a===void 0&&(_a=e.params.speed);const{el:_l,hostEl:_d}=e,_f=[..._l.querySelectorAll(zt)];e.isElement&&_f.push(..._d.querySelectorAll(zt)),_f.forEach(_m=>{let tE=parseInt(_m.getAttribute("data-swiper-parallax-duration"),10)||_a;_a===0&&(tE=0),_m.style.transitionDuration=`${tE}ms`})};Vt("beforeInit",()=>{e.params.parallax.enabled&&(e.params.watchSlidesProgress=!0,e.originalParams.watchSlidesProgress=!0)}),Vt("init",()=>{e.params.parallax.enabled&&_o()}),Vt("setTranslate",()=>{e.params.parallax.enabled&&_o()}),Vt("setTransition",(_a,_l)=>{e.params.parallax.enabled&&ga(_l)})}function Zoom(_){let{swiper:e,extendParams:j,on:Vt,emit:zt}=_;const _r=getWindow();j({zoom:{enabled:!1,limitToOriginalSize:!1,maxRatio:3,minRatio:1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}}),e.zoom={enabled:!1};let _o=1,ga=!1,_a,_l;const _d=[],_f={originX:0,originY:0,slideEl:void 0,slideWidth:void 0,slideHeight:void 0,imageEl:void 0,imageWrapEl:void 0,maxRatio:3},_m={isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},tE={x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0};let rE=1;Object.defineProperty(e.zoom,"scale",{get(){return rE},set(BE){if(rE!==BE){const qE=_f.imageEl,e_=_f.slideEl;zt("zoomChange",BE,qE,e_)}rE=BE}});function oE(){if(_d.length<2)return 1;const BE=_d[0].pageX,qE=_d[0].pageY,e_=_d[1].pageX,b_=_d[1].pageY;return Math.sqrt((e_-BE)**2+(b_-qE)**2)}function dE(){const BE=e.params.zoom,qE=_f.imageWrapEl.getAttribute("data-swiper-zoom")||BE.maxRatio;if(BE.limitToOriginalSize&&_f.imageEl&&_f.imageEl.naturalWidth){const e_=_f.imageEl.naturalWidth/_f.imageEl.offsetWidth;return Math.min(e_,qE)}return qE}function nE(){if(_d.length<2)return{x:null,y:null};const BE=_f.imageEl.getBoundingClientRect();return[(_d[0].pageX+(_d[1].pageX-_d[0].pageX)/2-BE.x-_r.scrollX)/_o,(_d[0].pageY+(_d[1].pageY-_d[0].pageY)/2-BE.y-_r.scrollY)/_o]}function sE(){return e.isElement?"swiper-slide":`.${e.params.slideClass}`}function lE(BE){const qE=sE();return!!(BE.target.matches(qE)||e.slides.filter(e_=>e_.contains(BE.target)).length>0)}function EE(BE){const qE=`.${e.params.zoom.containerClass}`;return!!(BE.target.matches(qE)||[...e.hostEl.querySelectorAll(qE)].filter(e_=>e_.contains(BE.target)).length>0)}function wE(BE){if(BE.pointerType==="mouse"&&_d.splice(0,_d.length),!lE(BE))return;const qE=e.params.zoom;if(_a=!1,_l=!1,_d.push(BE),!(_d.length<2)){if(_a=!0,_f.scaleStart=oE(),!_f.slideEl){_f.slideEl=BE.target.closest(`.${e.params.slideClass}, swiper-slide`),_f.slideEl||(_f.slideEl=e.slides[e.activeIndex]);let e_=_f.slideEl.querySelector(`.${qE.containerClass}`);if(e_&&(e_=e_.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),_f.imageEl=e_,e_?_f.imageWrapEl=elementParents(_f.imageEl,`.${qE.containerClass}`)[0]:_f.imageWrapEl=void 0,!_f.imageWrapEl){_f.imageEl=void 0;return}_f.maxRatio=dE()}if(_f.imageEl){const[e_,b_]=nE();_f.originX=e_,_f.originY=b_,_f.imageEl.style.transitionDuration="0ms"}ga=!0}}function IE(BE){if(!lE(BE))return;const qE=e.params.zoom,e_=e.zoom,b_=_d.findIndex(m_=>m_.pointerId===BE.pointerId);b_>=0&&(_d[b_]=BE),!(_d.length<2)&&(_l=!0,_f.scaleMove=oE(),_f.imageEl&&(e_.scale=_f.scaleMove/_f.scaleStart*_o,e_.scale>_f.maxRatio&&(e_.scale=_f.maxRatio-1+(e_.scale-_f.maxRatio+1)**.5),e_.scale<qE.minRatio&&(e_.scale=qE.minRatio+1-(qE.minRatio-e_.scale+1)**.5),_f.imageEl.style.transform=`translate3d(0,0,0) scale(${e_.scale})`))}function _E(BE){if(!lE(BE)||BE.pointerType==="mouse"&&BE.type==="pointerout")return;const qE=e.params.zoom,e_=e.zoom,b_=_d.findIndex(m_=>m_.pointerId===BE.pointerId);b_>=0&&_d.splice(b_,1),!(!_a||!_l)&&(_a=!1,_l=!1,_f.imageEl&&(e_.scale=Math.max(Math.min(e_.scale,_f.maxRatio),qE.minRatio),_f.imageEl.style.transitionDuration=`${e.params.speed}ms`,_f.imageEl.style.transform=`translate3d(0,0,0) scale(${e_.scale})`,_o=e_.scale,ga=!1,e_.scale>1&&_f.slideEl?_f.slideEl.classList.add(`${qE.zoomedSlideClass}`):e_.scale<=1&&_f.slideEl&&_f.slideEl.classList.remove(`${qE.zoomedSlideClass}`),e_.scale===1&&(_f.originX=0,_f.originY=0,_f.slideEl=void 0)))}let kE;function ME(){e.touchEventsData.preventTouchMoveFromPointerMove=!1}function bE(){clearTimeout(kE),e.touchEventsData.preventTouchMoveFromPointerMove=!0,kE=setTimeout(()=>{ME()})}function LE(BE){const qE=e.device;if(!_f.imageEl||_m.isTouched)return;qE.android&&BE.cancelable&&BE.preventDefault(),_m.isTouched=!0;const e_=_d.length>0?_d[0]:BE;_m.touchesStart.x=e_.pageX,_m.touchesStart.y=e_.pageY}function TE(BE){if(!lE(BE)||!EE(BE))return;const qE=e.zoom;if(!_f.imageEl||!_m.isTouched||!_f.slideEl)return;_m.isMoved||(_m.width=_f.imageEl.offsetWidth||_f.imageEl.clientWidth,_m.height=_f.imageEl.offsetHeight||_f.imageEl.clientHeight,_m.startX=getTranslate(_f.imageWrapEl,"x")||0,_m.startY=getTranslate(_f.imageWrapEl,"y")||0,_f.slideWidth=_f.slideEl.offsetWidth,_f.slideHeight=_f.slideEl.offsetHeight,_f.imageWrapEl.style.transitionDuration="0ms");const e_=_m.width*qE.scale,b_=_m.height*qE.scale;if(_m.minX=Math.min(_f.slideWidth/2-e_/2,0),_m.maxX=-_m.minX,_m.minY=Math.min(_f.slideHeight/2-b_/2,0),_m.maxY=-_m.minY,_m.touchesCurrent.x=_d.length>0?_d[0].pageX:BE.pageX,_m.touchesCurrent.y=_d.length>0?_d[0].pageY:BE.pageY,Math.max(Math.abs(_m.touchesCurrent.x-_m.touchesStart.x),Math.abs(_m.touchesCurrent.y-_m.touchesStart.y))>5&&(e.allowClick=!1),!_m.isMoved&&!ga){if(e.isHorizontal()&&(Math.floor(_m.minX)===Math.floor(_m.startX)&&_m.touchesCurrent.x<_m.touchesStart.x||Math.floor(_m.maxX)===Math.floor(_m.startX)&&_m.touchesCurrent.x>_m.touchesStart.x)){_m.isTouched=!1,ME();return}if(!e.isHorizontal()&&(Math.floor(_m.minY)===Math.floor(_m.startY)&&_m.touchesCurrent.y<_m.touchesStart.y||Math.floor(_m.maxY)===Math.floor(_m.startY)&&_m.touchesCurrent.y>_m.touchesStart.y)){_m.isTouched=!1,ME();return}}BE.cancelable&&BE.preventDefault(),BE.stopPropagation(),bE(),_m.isMoved=!0;const I_=(qE.scale-_o)/(_f.maxRatio-e.params.zoom.minRatio),{originX:w0,originY:yT}=_f;_m.currentX=_m.touchesCurrent.x-_m.touchesStart.x+_m.startX+I_*(_m.width-w0*2),_m.currentY=_m.touchesCurrent.y-_m.touchesStart.y+_m.startY+I_*(_m.height-yT*2),_m.currentX<_m.minX&&(_m.currentX=_m.minX+1-(_m.minX-_m.currentX+1)**.8),_m.currentX>_m.maxX&&(_m.currentX=_m.maxX-1+(_m.currentX-_m.maxX+1)**.8),_m.currentY<_m.minY&&(_m.currentY=_m.minY+1-(_m.minY-_m.currentY+1)**.8),_m.currentY>_m.maxY&&(_m.currentY=_m.maxY-1+(_m.currentY-_m.maxY+1)**.8),tE.prevPositionX||(tE.prevPositionX=_m.touchesCurrent.x),tE.prevPositionY||(tE.prevPositionY=_m.touchesCurrent.y),tE.prevTime||(tE.prevTime=Date.now()),tE.x=(_m.touchesCurrent.x-tE.prevPositionX)/(Date.now()-tE.prevTime)/2,tE.y=(_m.touchesCurrent.y-tE.prevPositionY)/(Date.now()-tE.prevTime)/2,Math.abs(_m.touchesCurrent.x-tE.prevPositionX)<2&&(tE.x=0),Math.abs(_m.touchesCurrent.y-tE.prevPositionY)<2&&(tE.y=0),tE.prevPositionX=_m.touchesCurrent.x,tE.prevPositionY=_m.touchesCurrent.y,tE.prevTime=Date.now(),_f.imageWrapEl.style.transform=`translate3d(${_m.currentX}px, ${_m.currentY}px,0)`}function OE(){const BE=e.zoom;if(!_f.imageEl)return;if(!_m.isTouched||!_m.isMoved){_m.isTouched=!1,_m.isMoved=!1;return}_m.isTouched=!1,_m.isMoved=!1;let qE=300,e_=300;const b_=tE.x*qE,m_=_m.currentX+b_,I_=tE.y*e_,w0=_m.currentY+I_;tE.x!==0&&(qE=Math.abs((m_-_m.currentX)/tE.x)),tE.y!==0&&(e_=Math.abs((w0-_m.currentY)/tE.y));const yT=Math.max(qE,e_);_m.currentX=m_,_m.currentY=w0;const YT=_m.width*BE.scale,oT=_m.height*BE.scale;_m.minX=Math.min(_f.slideWidth/2-YT/2,0),_m.maxX=-_m.minX,_m.minY=Math.min(_f.slideHeight/2-oT/2,0),_m.maxY=-_m.minY,_m.currentX=Math.max(Math.min(_m.currentX,_m.maxX),_m.minX),_m.currentY=Math.max(Math.min(_m.currentY,_m.maxY),_m.minY),_f.imageWrapEl.style.transitionDuration=`${yT}ms`,_f.imageWrapEl.style.transform=`translate3d(${_m.currentX}px, ${_m.currentY}px,0)`}function vE(){const BE=e.zoom;_f.slideEl&&e.activeIndex!==e.slides.indexOf(_f.slideEl)&&(_f.imageEl&&(_f.imageEl.style.transform="translate3d(0,0,0) scale(1)"),_f.imageWrapEl&&(_f.imageWrapEl.style.transform="translate3d(0,0,0)"),_f.slideEl.classList.remove(`${e.params.zoom.zoomedSlideClass}`),BE.scale=1,_o=1,_f.slideEl=void 0,_f.imageEl=void 0,_f.imageWrapEl=void 0,_f.originX=0,_f.originY=0)}function NE(BE){const qE=e.zoom,e_=e.params.zoom;if(!_f.slideEl){BE&&BE.target&&(_f.slideEl=BE.target.closest(`.${e.params.slideClass}, swiper-slide`)),_f.slideEl||(e.params.virtual&&e.params.virtual.enabled&&e.virtual?_f.slideEl=elementChildren(e.slidesEl,`.${e.params.slideActiveClass}`)[0]:_f.slideEl=e.slides[e.activeIndex]);let XT=_f.slideEl.querySelector(`.${e_.containerClass}`);XT&&(XT=XT.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),_f.imageEl=XT,XT?_f.imageWrapEl=elementParents(_f.imageEl,`.${e_.containerClass}`)[0]:_f.imageWrapEl=void 0}if(!_f.imageEl||!_f.imageWrapEl)return;e.params.cssMode&&(e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.touchAction="none"),_f.slideEl.classList.add(`${e_.zoomedSlideClass}`);let b_,m_,I_,w0,yT,YT,oT,LS,lS,oS,q_,E0,S_,v0,k0,QS,yR,TS;typeof _m.touchesStart.x>"u"&&BE?(b_=BE.pageX,m_=BE.pageY):(b_=_m.touchesStart.x,m_=_m.touchesStart.y);const yS=typeof BE=="number"?BE:null;_o===1&&yS&&(b_=void 0,m_=void 0);const JT=dE();qE.scale=yS||JT,_o=yS||JT,BE&&!(_o===1&&yS)?(yR=_f.slideEl.offsetWidth,TS=_f.slideEl.offsetHeight,I_=elementOffset(_f.slideEl).left+_r.scrollX,w0=elementOffset(_f.slideEl).top+_r.scrollY,yT=I_+yR/2-b_,YT=w0+TS/2-m_,lS=_f.imageEl.offsetWidth||_f.imageEl.clientWidth,oS=_f.imageEl.offsetHeight||_f.imageEl.clientHeight,q_=lS*qE.scale,E0=oS*qE.scale,S_=Math.min(yR/2-q_/2,0),v0=Math.min(TS/2-E0/2,0),k0=-S_,QS=-v0,oT=yT*qE.scale,LS=YT*qE.scale,oT<S_&&(oT=S_),oT>k0&&(oT=k0),LS<v0&&(LS=v0),LS>QS&&(LS=QS)):(oT=0,LS=0),yS&&qE.scale===1&&(_f.originX=0,_f.originY=0),_f.imageWrapEl.style.transitionDuration="300ms",_f.imageWrapEl.style.transform=`translate3d(${oT}px, ${LS}px,0)`,_f.imageEl.style.transitionDuration="300ms",_f.imageEl.style.transform=`translate3d(0,0,0) scale(${qE.scale})`}function jE(){const BE=e.zoom,qE=e.params.zoom;if(!_f.slideEl){e.params.virtual&&e.params.virtual.enabled&&e.virtual?_f.slideEl=elementChildren(e.slidesEl,`.${e.params.slideActiveClass}`)[0]:_f.slideEl=e.slides[e.activeIndex];let e_=_f.slideEl.querySelector(`.${qE.containerClass}`);e_&&(e_=e_.querySelectorAll("picture, img, svg, canvas, .swiper-zoom-target")[0]),_f.imageEl=e_,e_?_f.imageWrapEl=elementParents(_f.imageEl,`.${qE.containerClass}`)[0]:_f.imageWrapEl=void 0}!_f.imageEl||!_f.imageWrapEl||(e.params.cssMode&&(e.wrapperEl.style.overflow="",e.wrapperEl.style.touchAction=""),BE.scale=1,_o=1,_f.imageWrapEl.style.transitionDuration="300ms",_f.imageWrapEl.style.transform="translate3d(0,0,0)",_f.imageEl.style.transitionDuration="300ms",_f.imageEl.style.transform="translate3d(0,0,0) scale(1)",_f.slideEl.classList.remove(`${qE.zoomedSlideClass}`),_f.slideEl=void 0,_f.originX=0,_f.originY=0)}function UE(BE){const qE=e.zoom;qE.scale&&qE.scale!==1?jE():NE(BE)}function RE(){const BE=e.params.passiveListeners?{passive:!0,capture:!1}:!1,qE=e.params.passiveListeners?{passive:!1,capture:!0}:!0;return{passiveListener:BE,activeListenerWithCapture:qE}}function FE(){const BE=e.zoom;if(BE.enabled)return;BE.enabled=!0;const{passiveListener:qE,activeListenerWithCapture:e_}=RE();e.wrapperEl.addEventListener("pointerdown",wE,qE),e.wrapperEl.addEventListener("pointermove",IE,e_),["pointerup","pointercancel","pointerout"].forEach(b_=>{e.wrapperEl.addEventListener(b_,_E,qE)}),e.wrapperEl.addEventListener("pointermove",TE,e_)}function VE(){const BE=e.zoom;if(!BE.enabled)return;BE.enabled=!1;const{passiveListener:qE,activeListenerWithCapture:e_}=RE();e.wrapperEl.removeEventListener("pointerdown",wE,qE),e.wrapperEl.removeEventListener("pointermove",IE,e_),["pointerup","pointercancel","pointerout"].forEach(b_=>{e.wrapperEl.removeEventListener(b_,_E,qE)}),e.wrapperEl.removeEventListener("pointermove",TE,e_)}Vt("init",()=>{e.params.zoom.enabled&&FE()}),Vt("destroy",()=>{VE()}),Vt("touchStart",(BE,qE)=>{e.zoom.enabled&&LE(qE)}),Vt("touchEnd",(BE,qE)=>{e.zoom.enabled&&OE()}),Vt("doubleTap",(BE,qE)=>{!e.animating&&e.params.zoom.enabled&&e.zoom.enabled&&e.params.zoom.toggle&&UE(qE)}),Vt("transitionEnd",()=>{e.zoom.enabled&&e.params.zoom.enabled&&vE()}),Vt("slideChange",()=>{e.zoom.enabled&&e.params.zoom.enabled&&e.params.cssMode&&vE()}),Object.assign(e.zoom,{enable:FE,disable:VE,in:NE,out:jE,toggle:UE})}function Controller(_){let{swiper:e,extendParams:j,on:Vt}=_;j({controller:{control:void 0,inverse:!1,by:"slide"}}),e.controller={control:void 0};function zt(_l,_d){const _f=function(){let oE,dE,nE;return(sE,lE)=>{for(dE=-1,oE=sE.length;oE-dE>1;)nE=oE+dE>>1,sE[nE]<=lE?dE=nE:oE=nE;return oE}}();this.x=_l,this.y=_d,this.lastIndex=_l.length-1;let _m,tE;return this.interpolate=function(oE){return oE?(tE=_f(this.x,oE),_m=tE-1,(oE-this.x[_m])*(this.y[tE]-this.y[_m])/(this.x[tE]-this.x[_m])+this.y[_m]):0},this}function _r(_l){e.controller.spline=e.params.loop?new zt(e.slidesGrid,_l.slidesGrid):new zt(e.snapGrid,_l.snapGrid)}function _o(_l,_d){const _f=e.controller.control;let _m,tE;const rE=e.constructor;function oE(dE){if(dE.destroyed)return;const nE=e.rtlTranslate?-e.translate:e.translate;e.params.controller.by==="slide"&&(_r(dE),tE=-e.controller.spline.interpolate(-nE)),(!tE||e.params.controller.by==="container")&&(_m=(dE.maxTranslate()-dE.minTranslate())/(e.maxTranslate()-e.minTranslate()),(Number.isNaN(_m)||!Number.isFinite(_m))&&(_m=1),tE=(nE-e.minTranslate())*_m+dE.minTranslate()),e.params.controller.inverse&&(tE=dE.maxTranslate()-tE),dE.updateProgress(tE),dE.setTranslate(tE,e),dE.updateActiveIndex(),dE.updateSlidesClasses()}if(Array.isArray(_f))for(let dE=0;dE<_f.length;dE+=1)_f[dE]!==_d&&_f[dE]instanceof rE&&oE(_f[dE]);else _f instanceof rE&&_d!==_f&&oE(_f)}function ga(_l,_d){const _f=e.constructor,_m=e.controller.control;let tE;function rE(oE){oE.destroyed||(oE.setTransition(_l,e),_l!==0&&(oE.transitionStart(),oE.params.autoHeight&&nextTick(()=>{oE.updateAutoHeight()}),elementTransitionEnd(oE.wrapperEl,()=>{_m&&oE.transitionEnd()})))}if(Array.isArray(_m))for(tE=0;tE<_m.length;tE+=1)_m[tE]!==_d&&_m[tE]instanceof _f&&rE(_m[tE]);else _m instanceof _f&&_d!==_m&&rE(_m)}function _a(){e.controller.control&&e.controller.spline&&(e.controller.spline=void 0,delete e.controller.spline)}Vt("beforeInit",()=>{if(typeof window<"u"&&(typeof e.params.controller.control=="string"||e.params.controller.control instanceof HTMLElement)){const _l=document.querySelector(e.params.controller.control);if(_l&&_l.swiper)e.controller.control=_l.swiper;else if(_l){const _d=_f=>{e.controller.control=_f.detail[0],e.update(),_l.removeEventListener("init",_d)};_l.addEventListener("init",_d)}return}e.controller.control=e.params.controller.control}),Vt("update",()=>{_a()}),Vt("resize",()=>{_a()}),Vt("observerUpdate",()=>{_a()}),Vt("setTranslate",(_l,_d,_f)=>{!e.controller.control||e.controller.control.destroyed||e.controller.setTranslate(_d,_f)}),Vt("setTransition",(_l,_d,_f)=>{!e.controller.control||e.controller.control.destroyed||e.controller.setTransition(_d,_f)}),Object.assign(e.controller,{setTranslate:_o,setTransition:ga})}function A11y(_){let{swiper:e,extendParams:j,on:Vt}=_;j({a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",slideLabelMessage:"{{index}} / {{slidesLength}}",containerMessage:null,containerRoleDescriptionMessage:null,itemRoleDescriptionMessage:null,slideRole:"group",id:null}}),e.a11y={clicked:!1};let zt=null,_r,_o,ga=new Date().getTime();function _a(UE){const RE=zt;RE.length!==0&&(RE.innerHTML="",RE.innerHTML=UE)}function _l(UE){const RE=()=>Math.round(16*Math.random()).toString(16);return"x".repeat(UE).replace(/x/g,RE)}function _d(UE){UE=makeElementsArray(UE),UE.forEach(RE=>{RE.setAttribute("tabIndex","0")})}function _f(UE){UE=makeElementsArray(UE),UE.forEach(RE=>{RE.setAttribute("tabIndex","-1")})}function _m(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("role",RE)})}function tE(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("aria-roledescription",RE)})}function rE(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("aria-controls",RE)})}function oE(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("aria-label",RE)})}function dE(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("id",RE)})}function nE(UE,RE){UE=makeElementsArray(UE),UE.forEach(FE=>{FE.setAttribute("aria-live",RE)})}function sE(UE){UE=makeElementsArray(UE),UE.forEach(RE=>{RE.setAttribute("aria-disabled",!0)})}function lE(UE){UE=makeElementsArray(UE),UE.forEach(RE=>{RE.setAttribute("aria-disabled",!1)})}function EE(UE){if(UE.keyCode!==13&&UE.keyCode!==32)return;const RE=e.params.a11y,FE=UE.target;if(!(e.pagination&&e.pagination.el&&(FE===e.pagination.el||e.pagination.el.contains(UE.target))&&!UE.target.matches(classesToSelector(e.params.pagination.bulletClass)))){if(e.navigation&&e.navigation.prevEl&&e.navigation.nextEl){const VE=makeElementsArray(e.navigation.prevEl);makeElementsArray(e.navigation.nextEl).includes(FE)&&(e.isEnd&&!e.params.loop||e.slideNext(),e.isEnd?_a(RE.lastSlideMessage):_a(RE.nextSlideMessage)),VE.includes(FE)&&(e.isBeginning&&!e.params.loop||e.slidePrev(),e.isBeginning?_a(RE.firstSlideMessage):_a(RE.prevSlideMessage))}e.pagination&&FE.matches(classesToSelector(e.params.pagination.bulletClass))&&FE.click()}}function wE(){if(e.params.loop||e.params.rewind||!e.navigation)return;const{nextEl:UE,prevEl:RE}=e.navigation;RE&&(e.isBeginning?(sE(RE),_f(RE)):(lE(RE),_d(RE))),UE&&(e.isEnd?(sE(UE),_f(UE)):(lE(UE),_d(UE)))}function IE(){return e.pagination&&e.pagination.bullets&&e.pagination.bullets.length}function _E(){return IE()&&e.params.pagination.clickable}function kE(){const UE=e.params.a11y;IE()&&e.pagination.bullets.forEach(RE=>{e.params.pagination.clickable&&(_d(RE),e.params.pagination.renderBullet||(_m(RE,"button"),oE(RE,UE.paginationBulletMessage.replace(/\{\{index\}\}/,elementIndex(RE)+1)))),RE.matches(classesToSelector(e.params.pagination.bulletActiveClass))?RE.setAttribute("aria-current","true"):RE.removeAttribute("aria-current")})}const ME=(UE,RE,FE)=>{_d(UE),UE.tagName!=="BUTTON"&&(_m(UE,"button"),UE.addEventListener("keydown",EE)),oE(UE,FE),rE(UE,RE)},bE=UE=>{_o&&_o!==UE.target&&!_o.contains(UE.target)&&(_r=!0),e.a11y.clicked=!0},LE=()=>{_r=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.destroyed||(e.a11y.clicked=!1)})})},TE=UE=>{ga=new Date().getTime()},OE=UE=>{if(e.a11y.clicked||new Date().getTime()-ga<100)return;const RE=UE.target.closest(`.${e.params.slideClass}, swiper-slide`);if(!RE||!e.slides.includes(RE))return;_o=RE;const FE=e.slides.indexOf(RE)===e.activeIndex,VE=e.params.watchSlidesProgress&&e.visibleSlides&&e.visibleSlides.includes(RE);FE||VE||UE.sourceCapabilities&&UE.sourceCapabilities.firesTouchEvents||(e.isHorizontal()?e.el.scrollLeft=0:e.el.scrollTop=0,requestAnimationFrame(()=>{_r||(e.params.loop?e.slideToLoop(parseInt(RE.getAttribute("data-swiper-slide-index")),0):e.slideTo(e.slides.indexOf(RE),0),_r=!1)}))},vE=()=>{const UE=e.params.a11y;UE.itemRoleDescriptionMessage&&tE(e.slides,UE.itemRoleDescriptionMessage),UE.slideRole&&_m(e.slides,UE.slideRole);const RE=e.slides.length;UE.slideLabelMessage&&e.slides.forEach((FE,VE)=>{const BE=e.params.loop?parseInt(FE.getAttribute("data-swiper-slide-index"),10):VE,qE=UE.slideLabelMessage.replace(/\{\{index\}\}/,BE+1).replace(/\{\{slidesLength\}\}/,RE);oE(FE,qE)})},NE=()=>{const UE=e.params.a11y;e.el.append(zt);const RE=e.el;UE.containerRoleDescriptionMessage&&tE(RE,UE.containerRoleDescriptionMessage),UE.containerMessage&&oE(RE,UE.containerMessage);const FE=e.wrapperEl,VE=UE.id||FE.getAttribute("id")||`swiper-wrapper-${_l(16)}`,BE=e.params.autoplay&&e.params.autoplay.enabled?"off":"polite";dE(FE,VE),nE(FE,BE),vE();let{nextEl:qE,prevEl:e_}=e.navigation?e.navigation:{};qE=makeElementsArray(qE),e_=makeElementsArray(e_),qE&&qE.forEach(m_=>ME(m_,VE,UE.nextSlideMessage)),e_&&e_.forEach(m_=>ME(m_,VE,UE.prevSlideMessage)),_E()&&makeElementsArray(e.pagination.el).forEach(I_=>{I_.addEventListener("keydown",EE)}),getDocument().addEventListener("visibilitychange",TE),e.el.addEventListener("focus",OE,!0),e.el.addEventListener("focus",OE,!0),e.el.addEventListener("pointerdown",bE,!0),e.el.addEventListener("pointerup",LE,!0)};function jE(){zt&&zt.remove();let{nextEl:UE,prevEl:RE}=e.navigation?e.navigation:{};UE=makeElementsArray(UE),RE=makeElementsArray(RE),UE&&UE.forEach(VE=>VE.removeEventListener("keydown",EE)),RE&&RE.forEach(VE=>VE.removeEventListener("keydown",EE)),_E()&&makeElementsArray(e.pagination.el).forEach(BE=>{BE.removeEventListener("keydown",EE)}),getDocument().removeEventListener("visibilitychange",TE),e.el&&typeof e.el!="string"&&(e.el.removeEventListener("focus",OE,!0),e.el.removeEventListener("pointerdown",bE,!0),e.el.removeEventListener("pointerup",LE,!0))}Vt("beforeInit",()=>{zt=createElement("span",e.params.a11y.notificationClass),zt.setAttribute("aria-live","assertive"),zt.setAttribute("aria-atomic","true")}),Vt("afterInit",()=>{e.params.a11y.enabled&&NE()}),Vt("slidesLengthChange snapGridLengthChange slidesGridLengthChange",()=>{e.params.a11y.enabled&&vE()}),Vt("fromEdge toEdge afterInit lock unlock",()=>{e.params.a11y.enabled&&wE()}),Vt("paginationUpdate",()=>{e.params.a11y.enabled&&kE()}),Vt("destroy",()=>{e.params.a11y.enabled&&jE()})}function History(_){let{swiper:e,extendParams:j,on:Vt}=_;j({history:{enabled:!1,root:"",replaceState:!1,key:"slides",keepQuery:!1}});let zt=!1,_r={};const _o=tE=>tE.toString().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""),ga=tE=>{const rE=getWindow();let oE;tE?oE=new URL(tE):oE=rE.location;const dE=oE.pathname.slice(1).split("/").filter(EE=>EE!==""),nE=dE.length,sE=dE[nE-2],lE=dE[nE-1];return{key:sE,value:lE}},_a=(tE,rE)=>{const oE=getWindow();if(!zt||!e.params.history.enabled)return;let dE;e.params.url?dE=new URL(e.params.url):dE=oE.location;const nE=e.virtual&&e.params.virtual.enabled?e.slidesEl.querySelector(`[data-swiper-slide-index="${rE}"]`):e.slides[rE];let sE=_o(nE.getAttribute("data-history"));if(e.params.history.root.length>0){let EE=e.params.history.root;EE[EE.length-1]==="/"&&(EE=EE.slice(0,EE.length-1)),sE=`${EE}/${tE?`${tE}/`:""}${sE}`}else dE.pathname.includes(tE)||(sE=`${tE?`${tE}/`:""}${sE}`);e.params.history.keepQuery&&(sE+=dE.search);const lE=oE.history.state;lE&&lE.value===sE||(e.params.history.replaceState?oE.history.replaceState({value:sE},null,sE):oE.history.pushState({value:sE},null,sE))},_l=(tE,rE,oE)=>{if(rE)for(let dE=0,nE=e.slides.length;dE<nE;dE+=1){const sE=e.slides[dE];if(_o(sE.getAttribute("data-history"))===rE){const EE=e.getSlideIndex(sE);e.slideTo(EE,tE,oE)}}else e.slideTo(0,tE,oE)},_d=()=>{_r=ga(e.params.url),_l(e.params.speed,_r.value,!1)},_f=()=>{const tE=getWindow();if(e.params.history){if(!tE.history||!tE.history.pushState){e.params.history.enabled=!1,e.params.hashNavigation.enabled=!0;return}if(zt=!0,_r=ga(e.params.url),!_r.key&&!_r.value){e.params.history.replaceState||tE.addEventListener("popstate",_d);return}_l(0,_r.value,e.params.runCallbacksOnInit),e.params.history.replaceState||tE.addEventListener("popstate",_d)}},_m=()=>{const tE=getWindow();e.params.history.replaceState||tE.removeEventListener("popstate",_d)};Vt("init",()=>{e.params.history.enabled&&_f()}),Vt("destroy",()=>{e.params.history.enabled&&_m()}),Vt("transitionEnd _freeModeNoMomentumRelease",()=>{zt&&_a(e.params.history.key,e.activeIndex)}),Vt("slideChange",()=>{zt&&e.params.cssMode&&_a(e.params.history.key,e.activeIndex)})}function HashNavigation(_){let{swiper:e,extendParams:j,emit:Vt,on:zt}=_,_r=!1;const _o=getDocument(),ga=getWindow();j({hashNavigation:{enabled:!1,replaceState:!1,watchState:!1,getSlideIndex(_m,tE){if(e.virtual&&e.params.virtual.enabled){const rE=e.slides.filter(dE=>dE.getAttribute("data-hash")===tE)[0];return rE?parseInt(rE.getAttribute("data-swiper-slide-index"),10):0}return e.getSlideIndex(elementChildren(e.slidesEl,`.${e.params.slideClass}[data-hash="${tE}"], swiper-slide[data-hash="${tE}"]`)[0])}}});const _a=()=>{Vt("hashChange");const _m=_o.location.hash.replace("#",""),tE=e.virtual&&e.params.virtual.enabled?e.slidesEl.querySelector(`[data-swiper-slide-index="${e.activeIndex}"]`):e.slides[e.activeIndex],rE=tE?tE.getAttribute("data-hash"):"";if(_m!==rE){const oE=e.params.hashNavigation.getSlideIndex(e,_m);if(typeof oE>"u"||Number.isNaN(oE))return;e.slideTo(oE)}},_l=()=>{if(!_r||!e.params.hashNavigation.enabled)return;const _m=e.virtual&&e.params.virtual.enabled?e.slidesEl.querySelector(`[data-swiper-slide-index="${e.activeIndex}"]`):e.slides[e.activeIndex],tE=_m?_m.getAttribute("data-hash")||_m.getAttribute("data-history"):"";e.params.hashNavigation.replaceState&&ga.history&&ga.history.replaceState?(ga.history.replaceState(null,null,`#${tE}`||""),Vt("hashSet")):(_o.location.hash=tE||"",Vt("hashSet"))},_d=()=>{if(!e.params.hashNavigation.enabled||e.params.history&&e.params.history.enabled)return;_r=!0;const _m=_o.location.hash.replace("#","");if(_m){const rE=e.params.hashNavigation.getSlideIndex(e,_m);e.slideTo(rE||0,0,e.params.runCallbacksOnInit,!0)}e.params.hashNavigation.watchState&&ga.addEventListener("hashchange",_a)},_f=()=>{e.params.hashNavigation.watchState&&ga.removeEventListener("hashchange",_a)};zt("init",()=>{e.params.hashNavigation.enabled&&_d()}),zt("destroy",()=>{e.params.hashNavigation.enabled&&_f()}),zt("transitionEnd _freeModeNoMomentumRelease",()=>{_r&&_l()}),zt("slideChange",()=>{_r&&e.params.cssMode&&_l()})}function Autoplay(_){let{swiper:e,extendParams:j,on:Vt,emit:zt,params:_r}=_;e.autoplay={running:!1,paused:!1,timeLeft:0},j({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let _o,ga,_a=_r&&_r.autoplay?_r.autoplay.delay:3e3,_l=_r&&_r.autoplay?_r.autoplay.delay:3e3,_d,_f=new Date().getTime(),_m,tE,rE,oE,dE,nE,sE;function lE(RE){!e||e.destroyed||!e.wrapperEl||RE.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",lE),!(sE||RE.detail&&RE.detail.bySwiperTouchMove)&&bE())}const EE=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?_m=!0:_m&&(_l=_d,_m=!1);const RE=e.autoplay.paused?_d:_f+_l-new Date().getTime();e.autoplay.timeLeft=RE,zt("autoplayTimeLeft",RE,RE/_a),ga=requestAnimationFrame(()=>{EE()})},wE=()=>{let RE;return e.virtual&&e.params.virtual.enabled?RE=e.slides.filter(VE=>VE.classList.contains("swiper-slide-active"))[0]:RE=e.slides[e.activeIndex],RE?parseInt(RE.getAttribute("data-swiper-autoplay"),10):void 0},IE=RE=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(ga),EE();let FE=typeof RE>"u"?e.params.autoplay.delay:RE;_a=e.params.autoplay.delay,_l=e.params.autoplay.delay;const VE=wE();!Number.isNaN(VE)&&VE>0&&typeof RE>"u"&&(FE=VE,_a=VE,_l=VE),_d=FE;const BE=e.params.speed,qE=()=>{!e||e.destroyed||(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(BE,!0,!0),zt("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,BE,!0,!0),zt("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(BE,!0,!0),zt("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,BE,!0,!0),zt("autoplay")),e.params.cssMode&&(_f=new Date().getTime(),requestAnimationFrame(()=>{IE()})))};return FE>0?(clearTimeout(_o),_o=setTimeout(()=>{qE()},FE)):requestAnimationFrame(()=>{qE()}),FE},_E=()=>{_f=new Date().getTime(),e.autoplay.running=!0,IE(),zt("autoplayStart")},kE=()=>{e.autoplay.running=!1,clearTimeout(_o),cancelAnimationFrame(ga),zt("autoplayStop")},ME=(RE,FE)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(_o),RE||(nE=!0);const VE=()=>{zt("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",lE):bE()};if(e.autoplay.paused=!0,FE){dE&&(_d=e.params.autoplay.delay),dE=!1,VE();return}_d=(_d||e.params.autoplay.delay)-(new Date().getTime()-_f),!(e.isEnd&&_d<0&&!e.params.loop)&&(_d<0&&(_d=0),VE())},bE=()=>{e.isEnd&&_d<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(_f=new Date().getTime(),nE?(nE=!1,IE(_d)):IE(),e.autoplay.paused=!1,zt("autoplayResume"))},LE=()=>{if(e.destroyed||!e.autoplay.running)return;const RE=getDocument();RE.visibilityState==="hidden"&&(nE=!0,ME(!0)),RE.visibilityState==="visible"&&bE()},TE=RE=>{RE.pointerType==="mouse"&&(nE=!0,sE=!0,!(e.animating||e.autoplay.paused)&&ME(!0))},OE=RE=>{RE.pointerType==="mouse"&&(sE=!1,e.autoplay.paused&&bE())},vE=()=>{e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",TE),e.el.addEventListener("pointerleave",OE))},NE=()=>{e.el&&typeof e.el!="string"&&(e.el.removeEventListener("pointerenter",TE),e.el.removeEventListener("pointerleave",OE))},jE=()=>{getDocument().addEventListener("visibilitychange",LE)},UE=()=>{getDocument().removeEventListener("visibilitychange",LE)};Vt("init",()=>{e.params.autoplay.enabled&&(vE(),jE(),_E())}),Vt("destroy",()=>{NE(),UE(),e.autoplay.running&&kE()}),Vt("_freeModeStaticRelease",()=>{(rE||nE)&&bE()}),Vt("_freeModeNoMomentumRelease",()=>{e.params.autoplay.disableOnInteraction?kE():ME(!0,!0)}),Vt("beforeTransitionStart",(RE,FE,VE)=>{e.destroyed||!e.autoplay.running||(VE||!e.params.autoplay.disableOnInteraction?ME(!0,!0):kE())}),Vt("sliderFirstMove",()=>{if(!(e.destroyed||!e.autoplay.running)){if(e.params.autoplay.disableOnInteraction){kE();return}tE=!0,rE=!1,nE=!1,oE=setTimeout(()=>{nE=!0,rE=!0,ME(!0)},200)}}),Vt("touchEnd",()=>{if(!(e.destroyed||!e.autoplay.running||!tE)){if(clearTimeout(oE),clearTimeout(_o),e.params.autoplay.disableOnInteraction){rE=!1,tE=!1;return}rE&&e.params.cssMode&&bE(),rE=!1,tE=!1}}),Vt("slideChange",()=>{e.destroyed||!e.autoplay.running||(dE=!0)}),Object.assign(e.autoplay,{start:_E,stop:kE,pause:ME,resume:bE})}function Thumb(_){let{swiper:e,extendParams:j,on:Vt}=_;j({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let zt=!1,_r=!1;e.thumbs={swiper:null};function _o(){const _l=e.thumbs.swiper;if(!_l||_l.destroyed)return;const _d=_l.clickedIndex,_f=_l.clickedSlide;if(_f&&_f.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof _d>"u"||_d===null)return;let _m;_l.params.loop?_m=parseInt(_l.clickedSlide.getAttribute("data-swiper-slide-index"),10):_m=_d,e.params.loop?e.slideToLoop(_m):e.slideTo(_m)}function ga(){const{thumbs:_l}=e.params;if(zt)return!1;zt=!0;const _d=e.constructor;if(_l.swiper instanceof _d)e.thumbs.swiper=_l.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(isObject$2(_l.swiper)){const _f=Object.assign({},_l.swiper);Object.assign(_f,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new _d(_f),_r=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",_o),!0}function _a(_l){const _d=e.thumbs.swiper;if(!_d||_d.destroyed)return;const _f=_d.params.slidesPerView==="auto"?_d.slidesPerViewDynamic():_d.params.slidesPerView;let _m=1;const tE=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(_m=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(_m=1),_m=Math.floor(_m),_d.slides.forEach(dE=>dE.classList.remove(tE)),_d.params.loop||_d.params.virtual&&_d.params.virtual.enabled)for(let dE=0;dE<_m;dE+=1)elementChildren(_d.slidesEl,`[data-swiper-slide-index="${e.realIndex+dE}"]`).forEach(nE=>{nE.classList.add(tE)});else for(let dE=0;dE<_m;dE+=1)_d.slides[e.realIndex+dE]&&_d.slides[e.realIndex+dE].classList.add(tE);const rE=e.params.thumbs.autoScrollOffset,oE=rE&&!_d.params.loop;if(e.realIndex!==_d.realIndex||oE){const dE=_d.activeIndex;let nE,sE;if(_d.params.loop){const lE=_d.slides.filter(EE=>EE.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];nE=_d.slides.indexOf(lE),sE=e.activeIndex>e.previousIndex?"next":"prev"}else nE=e.realIndex,sE=nE>e.previousIndex?"next":"prev";oE&&(nE+=sE==="next"?rE:-1*rE),_d.visibleSlidesIndexes&&_d.visibleSlidesIndexes.indexOf(nE)<0&&(_d.params.centeredSlides?nE>dE?nE=nE-Math.floor(_f/2)+1:nE=nE+Math.floor(_f/2)-1:nE>dE&&_d.params.slidesPerGroup,_d.slideTo(nE,_l?0:void 0))}}Vt("beforeInit",()=>{const{thumbs:_l}=e.params;if(!(!_l||!_l.swiper))if(typeof _l.swiper=="string"||_l.swiper instanceof HTMLElement){const _d=getDocument(),_f=()=>{const tE=typeof _l.swiper=="string"?_d.querySelector(_l.swiper):_l.swiper;if(tE&&tE.swiper)_l.swiper=tE.swiper,ga(),_a(!0);else if(tE){const rE=oE=>{_l.swiper=oE.detail[0],tE.removeEventListener("init",rE),ga(),_a(!0),_l.swiper.update(),e.update()};tE.addEventListener("init",rE)}return tE},_m=()=>{if(e.destroyed)return;_f()||requestAnimationFrame(_m)};requestAnimationFrame(_m)}else ga(),_a(!0)}),Vt("slideChange update resize observerUpdate",()=>{_a()}),Vt("setTransition",(_l,_d)=>{const _f=e.thumbs.swiper;!_f||_f.destroyed||_f.setTransition(_d)}),Vt("beforeDestroy",()=>{const _l=e.thumbs.swiper;!_l||_l.destroyed||_r&&_l.destroy()}),Object.assign(e.thumbs,{init:ga,update:_a})}function freeMode(_){let{swiper:e,extendParams:j,emit:Vt,once:zt}=_;j({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function _r(){if(e.params.cssMode)return;const _a=e.getTranslate();e.setTranslate(_a),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function _o(){if(e.params.cssMode)return;const{touchEventsData:_a,touches:_l}=e;_a.velocities.length===0&&_a.velocities.push({position:_l[e.isHorizontal()?"startX":"startY"],time:_a.touchStartTime}),_a.velocities.push({position:_l[e.isHorizontal()?"currentX":"currentY"],time:now()})}function ga(_a){let{currentPos:_l}=_a;if(e.params.cssMode)return;const{params:_d,wrapperEl:_f,rtlTranslate:_m,snapGrid:tE,touchEventsData:rE}=e,dE=now()-rE.touchStartTime;if(_l<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(_l>-e.maxTranslate()){e.slides.length<tE.length?e.slideTo(tE.length-1):e.slideTo(e.slides.length-1);return}if(_d.freeMode.momentum){if(rE.velocities.length>1){const kE=rE.velocities.pop(),ME=rE.velocities.pop(),bE=kE.position-ME.position,LE=kE.time-ME.time;e.velocity=bE/LE,e.velocity/=2,Math.abs(e.velocity)<_d.freeMode.minimumVelocity&&(e.velocity=0),(LE>150||now()-kE.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=_d.freeMode.momentumVelocityRatio,rE.velocities.length=0;let nE=1e3*_d.freeMode.momentumRatio;const sE=e.velocity*nE;let lE=e.translate+sE;_m&&(lE=-lE);let EE=!1,wE;const IE=Math.abs(e.velocity)*20*_d.freeMode.momentumBounceRatio;let _E;if(lE<e.maxTranslate())_d.freeMode.momentumBounce?(lE+e.maxTranslate()<-IE&&(lE=e.maxTranslate()-IE),wE=e.maxTranslate(),EE=!0,rE.allowMomentumBounce=!0):lE=e.maxTranslate(),_d.loop&&_d.centeredSlides&&(_E=!0);else if(lE>e.minTranslate())_d.freeMode.momentumBounce?(lE-e.minTranslate()>IE&&(lE=e.minTranslate()+IE),wE=e.minTranslate(),EE=!0,rE.allowMomentumBounce=!0):lE=e.minTranslate(),_d.loop&&_d.centeredSlides&&(_E=!0);else if(_d.freeMode.sticky){let kE;for(let ME=0;ME<tE.length;ME+=1)if(tE[ME]>-lE){kE=ME;break}Math.abs(tE[kE]-lE)<Math.abs(tE[kE-1]-lE)||e.swipeDirection==="next"?lE=tE[kE]:lE=tE[kE-1],lE=-lE}if(_E&&zt("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(_m?nE=Math.abs((-lE-e.translate)/e.velocity):nE=Math.abs((lE-e.translate)/e.velocity),_d.freeMode.sticky){const kE=Math.abs((_m?-lE:lE)-e.translate),ME=e.slidesSizesGrid[e.activeIndex];kE<ME?nE=_d.speed:kE<2*ME?nE=_d.speed*1.5:nE=_d.speed*2.5}}else if(_d.freeMode.sticky){e.slideToClosest();return}_d.freeMode.momentumBounce&&EE?(e.updateProgress(wE),e.setTransition(nE),e.setTranslate(lE),e.transitionStart(!0,e.swipeDirection),e.animating=!0,elementTransitionEnd(_f,()=>{!e||e.destroyed||!rE.allowMomentumBounce||(Vt("momentumBounce"),e.setTransition(_d.speed),setTimeout(()=>{e.setTranslate(wE),elementTransitionEnd(_f,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(Vt("_freeModeNoMomentumRelease"),e.updateProgress(lE),e.setTransition(nE),e.setTranslate(lE),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,elementTransitionEnd(_f,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(lE),e.updateActiveIndex(),e.updateSlidesClasses()}else if(_d.freeMode.sticky){e.slideToClosest();return}else _d.freeMode&&Vt("_freeModeNoMomentumRelease");(!_d.freeMode.momentum||dE>=_d.longSwipesMs)&&(Vt("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:_r,onTouchMove:_o,onTouchEnd:ga}})}function Grid(_){let{swiper:e,extendParams:j,on:Vt}=_;j({grid:{rows:1,fill:"column"}});let zt,_r,_o,ga;const _a=()=>{let oE=e.params.spaceBetween;return typeof oE=="string"&&oE.indexOf("%")>=0?oE=parseFloat(oE.replace("%",""))/100*e.size:typeof oE=="string"&&(oE=parseFloat(oE)),oE},_l=oE=>{const{slidesPerView:dE}=e.params,{rows:nE,fill:sE}=e.params.grid,lE=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:oE.length;_o=Math.floor(lE/nE),Math.floor(lE/nE)===lE/nE?zt=lE:zt=Math.ceil(lE/nE)*nE,dE!=="auto"&&sE==="row"&&(zt=Math.max(zt,dE*nE)),_r=zt/nE},_d=()=>{e.slides&&e.slides.forEach(oE=>{oE.swiperSlideGridSet&&(oE.style.height="",oE.style[e.getDirectionLabel("margin-top")]="")})},_f=(oE,dE,nE)=>{const{slidesPerGroup:sE}=e.params,lE=_a(),{rows:EE,fill:wE}=e.params.grid,IE=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:nE.length;let _E,kE,ME;if(wE==="row"&&sE>1){const bE=Math.floor(oE/(sE*EE)),LE=oE-EE*sE*bE,TE=bE===0?sE:Math.min(Math.ceil((IE-bE*EE*sE)/EE),sE);ME=Math.floor(LE/TE),kE=LE-ME*TE+bE*sE,_E=kE+ME*zt/EE,dE.style.order=_E}else wE==="column"?(kE=Math.floor(oE/EE),ME=oE-kE*EE,(kE>_o||kE===_o&&ME===EE-1)&&(ME+=1,ME>=EE&&(ME=0,kE+=1))):(ME=Math.floor(oE/_r),kE=oE-ME*_r);dE.row=ME,dE.column=kE,dE.style.height=`calc((100% - ${(EE-1)*lE}px) / ${EE})`,dE.style[e.getDirectionLabel("margin-top")]=ME!==0?lE&&`${lE}px`:"",dE.swiperSlideGridSet=!0},_m=(oE,dE)=>{const{centeredSlides:nE,roundLengths:sE}=e.params,lE=_a(),{rows:EE}=e.params.grid;if(e.virtualSize=(oE+lE)*zt,e.virtualSize=Math.ceil(e.virtualSize/EE)-lE,e.params.cssMode||(e.wrapperEl.style[e.getDirectionLabel("width")]=`${e.virtualSize+lE}px`),nE){const wE=[];for(let IE=0;IE<dE.length;IE+=1){let _E=dE[IE];sE&&(_E=Math.floor(_E)),dE[IE]<e.virtualSize+dE[0]&&wE.push(_E)}dE.splice(0,dE.length),dE.push(...wE)}},tE=()=>{ga=e.params.grid&&e.params.grid.rows>1},rE=()=>{const{params:oE,el:dE}=e,nE=oE.grid&&oE.grid.rows>1;ga&&!nE?(dE.classList.remove(`${oE.containerModifierClass}grid`,`${oE.containerModifierClass}grid-column`),_o=1,e.emitContainerClasses()):!ga&&nE&&(dE.classList.add(`${oE.containerModifierClass}grid`),oE.grid.fill==="column"&&dE.classList.add(`${oE.containerModifierClass}grid-column`),e.emitContainerClasses()),ga=nE};Vt("init",tE),Vt("update",rE),e.grid={initSlides:_l,unsetSlides:_d,updateSlide:_f,updateWrapperSize:_m}}function appendSlide(_){const e=this,{params:j,slidesEl:Vt}=e;j.loop&&e.loopDestroy();const zt=_r=>{if(typeof _r=="string"){const _o=document.createElement("div");_o.innerHTML=_r,Vt.append(_o.children[0]),_o.innerHTML=""}else Vt.append(_r)};if(typeof _=="object"&&"length"in _)for(let _r=0;_r<_.length;_r+=1)_[_r]&&zt(_[_r]);else zt(_);e.recalcSlides(),j.loop&&e.loopCreate(),(!j.observer||e.isElement)&&e.update()}function prependSlide(_){const e=this,{params:j,activeIndex:Vt,slidesEl:zt}=e;j.loop&&e.loopDestroy();let _r=Vt+1;const _o=ga=>{if(typeof ga=="string"){const _a=document.createElement("div");_a.innerHTML=ga,zt.prepend(_a.children[0]),_a.innerHTML=""}else zt.prepend(ga)};if(typeof _=="object"&&"length"in _){for(let ga=0;ga<_.length;ga+=1)_[ga]&&_o(_[ga]);_r=Vt+_.length}else _o(_);e.recalcSlides(),j.loop&&e.loopCreate(),(!j.observer||e.isElement)&&e.update(),e.slideTo(_r,0,!1)}function addSlide(_,e){const j=this,{params:Vt,activeIndex:zt,slidesEl:_r}=j;let _o=zt;Vt.loop&&(_o-=j.loopedSlides,j.loopDestroy(),j.recalcSlides());const ga=j.slides.length;if(_<=0){j.prependSlide(e);return}if(_>=ga){j.appendSlide(e);return}let _a=_o>_?_o+1:_o;const _l=[];for(let _d=ga-1;_d>=_;_d-=1){const _f=j.slides[_d];_f.remove(),_l.unshift(_f)}if(typeof e=="object"&&"length"in e){for(let _d=0;_d<e.length;_d+=1)e[_d]&&_r.append(e[_d]);_a=_o>_?_o+e.length:_o}else _r.append(e);for(let _d=0;_d<_l.length;_d+=1)_r.append(_l[_d]);j.recalcSlides(),Vt.loop&&j.loopCreate(),(!Vt.observer||j.isElement)&&j.update(),Vt.loop?j.slideTo(_a+j.loopedSlides,0,!1):j.slideTo(_a,0,!1)}function removeSlide(_){const e=this,{params:j,activeIndex:Vt}=e;let zt=Vt;j.loop&&(zt-=e.loopedSlides,e.loopDestroy());let _r=zt,_o;if(typeof _=="object"&&"length"in _){for(let ga=0;ga<_.length;ga+=1)_o=_[ga],e.slides[_o]&&e.slides[_o].remove(),_o<_r&&(_r-=1);_r=Math.max(_r,0)}else _o=_,e.slides[_o]&&e.slides[_o].remove(),_o<_r&&(_r-=1),_r=Math.max(_r,0);e.recalcSlides(),j.loop&&e.loopCreate(),(!j.observer||e.isElement)&&e.update(),j.loop?e.slideTo(_r+e.loopedSlides,0,!1):e.slideTo(_r,0,!1)}function removeAllSlides(){const _=this,e=[];for(let j=0;j<_.slides.length;j+=1)e.push(j);_.removeSlide(e)}function Manipulation(_){let{swiper:e}=_;Object.assign(e,{appendSlide:appendSlide.bind(e),prependSlide:prependSlide.bind(e),addSlide:addSlide.bind(e),removeSlide:removeSlide.bind(e),removeAllSlides:removeAllSlides.bind(e)})}function effectInit(_){const{effect:e,swiper:j,on:Vt,setTranslate:zt,setTransition:_r,overwriteParams:_o,perspective:ga,recreateShadows:_a,getEffectParams:_l}=_;Vt("beforeInit",()=>{if(j.params.effect!==e)return;j.classNames.push(`${j.params.containerModifierClass}${e}`),ga&&ga()&&j.classNames.push(`${j.params.containerModifierClass}3d`);const _f=_o?_o():{};Object.assign(j.params,_f),Object.assign(j.originalParams,_f)}),Vt("setTranslate",()=>{j.params.effect===e&&zt()}),Vt("setTransition",(_f,_m)=>{j.params.effect===e&&_r(_m)}),Vt("transitionEnd",()=>{if(j.params.effect===e&&_a){if(!_l||!_l().slideShadows)return;j.slides.forEach(_f=>{_f.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(_m=>_m.remove())}),_a()}});let _d;Vt("virtualUpdate",()=>{j.params.effect===e&&(j.slides.length||(_d=!0),requestAnimationFrame(()=>{_d&&j.slides&&j.slides.length&&(zt(),_d=!1)}))})}function effectTarget(_,e){const j=getSlideTransformEl(e);return j!==e&&(j.style.backfaceVisibility="hidden",j.style["-webkit-backface-visibility"]="hidden"),j}function effectVirtualTransitionEnd(_){let{swiper:e,duration:j,transformElements:Vt,allSlides:zt}=_;const{activeIndex:_r}=e,_o=ga=>ga.parentElement?ga.parentElement:e.slides.filter(_l=>_l.shadowRoot&&_l.shadowRoot===ga.parentNode)[0];if(e.params.virtualTranslate&&j!==0){let ga=!1,_a;zt?_a=Vt:_a=Vt.filter(_l=>{const _d=_l.classList.contains("swiper-slide-transform")?_o(_l):_l;return e.getSlideIndex(_d)===_r}),_a.forEach(_l=>{elementTransitionEnd(_l,()=>{if(ga||!e||e.destroyed)return;ga=!0,e.animating=!1;const _d=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});e.wrapperEl.dispatchEvent(_d)})})}}function EffectFade(_){let{swiper:e,extendParams:j,on:Vt}=_;j({fadeEffect:{crossFade:!1}}),effectInit({effect:"fade",swiper:e,on:Vt,setTranslate:()=>{const{slides:_o}=e,ga=e.params.fadeEffect;for(let _a=0;_a<_o.length;_a+=1){const _l=e.slides[_a];let _f=-_l.swiperSlideOffset;e.params.virtualTranslate||(_f-=e.translate);let _m=0;e.isHorizontal()||(_m=_f,_f=0);const tE=e.params.fadeEffect.crossFade?Math.max(1-Math.abs(_l.progress),0):1+Math.min(Math.max(_l.progress,-1),0),rE=effectTarget(ga,_l);rE.style.opacity=tE,rE.style.transform=`translate3d(${_f}px, ${_m}px, 0px)`}},setTransition:_o=>{const ga=e.slides.map(_a=>getSlideTransformEl(_a));ga.forEach(_a=>{_a.style.transitionDuration=`${_o}ms`}),effectVirtualTransitionEnd({swiper:e,duration:_o,transformElements:ga,allSlides:!0})},overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!e.params.cssMode})})}function EffectCube(_){let{swiper:e,extendParams:j,on:Vt}=_;j({cubeEffect:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94}});const zt=(_a,_l,_d)=>{let _f=_d?_a.querySelector(".swiper-slide-shadow-left"):_a.querySelector(".swiper-slide-shadow-top"),_m=_d?_a.querySelector(".swiper-slide-shadow-right"):_a.querySelector(".swiper-slide-shadow-bottom");_f||(_f=createElement("div",`swiper-slide-shadow-cube swiper-slide-shadow-${_d?"left":"top"}`.split(" ")),_a.append(_f)),_m||(_m=createElement("div",`swiper-slide-shadow-cube swiper-slide-shadow-${_d?"right":"bottom"}`.split(" ")),_a.append(_m)),_f&&(_f.style.opacity=Math.max(-_l,0)),_m&&(_m.style.opacity=Math.max(_l,0))};effectInit({effect:"cube",swiper:e,on:Vt,setTranslate:()=>{const{el:_a,wrapperEl:_l,slides:_d,width:_f,height:_m,rtlTranslate:tE,size:rE,browser:oE}=e,dE=e.params.cubeEffect,nE=e.isHorizontal(),sE=e.virtual&&e.params.virtual.enabled;let lE=0,EE;dE.shadow&&(nE?(EE=e.wrapperEl.querySelector(".swiper-cube-shadow"),EE||(EE=createElement("div","swiper-cube-shadow"),e.wrapperEl.append(EE)),EE.style.height=`${_f}px`):(EE=_a.querySelector(".swiper-cube-shadow"),EE||(EE=createElement("div","swiper-cube-shadow"),_a.append(EE))));for(let IE=0;IE<_d.length;IE+=1){const _E=_d[IE];let kE=IE;sE&&(kE=parseInt(_E.getAttribute("data-swiper-slide-index"),10));let ME=kE*90,bE=Math.floor(ME/360);tE&&(ME=-ME,bE=Math.floor(-ME/360));const LE=Math.max(Math.min(_E.progress,1),-1);let TE=0,OE=0,vE=0;kE%4===0?(TE=-bE*4*rE,vE=0):(kE-1)%4===0?(TE=0,vE=-bE*4*rE):(kE-2)%4===0?(TE=rE+bE*4*rE,vE=rE):(kE-3)%4===0&&(TE=-rE,vE=3*rE+rE*4*bE),tE&&(TE=-TE),nE||(OE=TE,TE=0);const NE=`rotateX(${nE?0:-ME}deg) rotateY(${nE?ME:0}deg) translate3d(${TE}px, ${OE}px, ${vE}px)`;LE<=1&&LE>-1&&(lE=kE*90+LE*90,tE&&(lE=-kE*90-LE*90),e.browser&&e.browser.need3dFix&&Math.abs(lE)/90%2===1&&(lE+=.001)),_E.style.transform=NE,dE.slideShadows&&zt(_E,LE,nE)}if(_l.style.transformOrigin=`50% 50% -${rE/2}px`,_l.style["-webkit-transform-origin"]=`50% 50% -${rE/2}px`,dE.shadow)if(nE)EE.style.transform=`translate3d(0px, ${_f/2+dE.shadowOffset}px, ${-_f/2}px) rotateX(89.99deg) rotateZ(0deg) scale(${dE.shadowScale})`;else{const IE=Math.abs(lE)-Math.floor(Math.abs(lE)/90)*90,_E=1.5-(Math.sin(IE*2*Math.PI/360)/2+Math.cos(IE*2*Math.PI/360)/2),kE=dE.shadowScale,ME=dE.shadowScale/_E,bE=dE.shadowOffset;EE.style.transform=`scale3d(${kE}, 1, ${ME}) translate3d(0px, ${_m/2+bE}px, ${-_m/2/ME}px) rotateX(-89.99deg)`}const wE=(oE.isSafari||oE.isWebView)&&oE.needPerspectiveFix?-rE/2:0;_l.style.transform=`translate3d(0px,0,${wE}px) rotateX(${e.isHorizontal()?0:lE}deg) rotateY(${e.isHorizontal()?-lE:0}deg)`,_l.style.setProperty("--swiper-cube-translate-z",`${wE}px`)},setTransition:_a=>{const{el:_l,slides:_d}=e;if(_d.forEach(_f=>{_f.style.transitionDuration=`${_a}ms`,_f.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(_m=>{_m.style.transitionDuration=`${_a}ms`})}),e.params.cubeEffect.shadow&&!e.isHorizontal()){const _f=_l.querySelector(".swiper-cube-shadow");_f&&(_f.style.transitionDuration=`${_a}ms`)}},recreateShadows:()=>{const _a=e.isHorizontal();e.slides.forEach(_l=>{const _d=Math.max(Math.min(_l.progress,1),-1);zt(_l,_d,_a)})},getEffectParams:()=>e.params.cubeEffect,perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,resistanceRatio:0,spaceBetween:0,centeredSlides:!1,virtualTranslate:!0})})}function createShadow(_,e,j){const Vt=`swiper-slide-shadow${j?`-${j}`:""}${_?` swiper-slide-shadow-${_}`:""}`,zt=getSlideTransformEl(e);let _r=zt.querySelector(`.${Vt.split(" ").join(".")}`);return _r||(_r=createElement("div",Vt.split(" ")),zt.append(_r)),_r}function EffectFlip(_){let{swiper:e,extendParams:j,on:Vt}=_;j({flipEffect:{slideShadows:!0,limitRotation:!0}});const zt=(_a,_l)=>{let _d=e.isHorizontal()?_a.querySelector(".swiper-slide-shadow-left"):_a.querySelector(".swiper-slide-shadow-top"),_f=e.isHorizontal()?_a.querySelector(".swiper-slide-shadow-right"):_a.querySelector(".swiper-slide-shadow-bottom");_d||(_d=createShadow("flip",_a,e.isHorizontal()?"left":"top")),_f||(_f=createShadow("flip",_a,e.isHorizontal()?"right":"bottom")),_d&&(_d.style.opacity=Math.max(-_l,0)),_f&&(_f.style.opacity=Math.max(_l,0))};effectInit({effect:"flip",swiper:e,on:Vt,setTranslate:()=>{const{slides:_a,rtlTranslate:_l}=e,_d=e.params.flipEffect;for(let _f=0;_f<_a.length;_f+=1){const _m=_a[_f];let tE=_m.progress;e.params.flipEffect.limitRotation&&(tE=Math.max(Math.min(_m.progress,1),-1));const rE=_m.swiperSlideOffset;let dE=-180*tE,nE=0,sE=e.params.cssMode?-rE-e.translate:-rE,lE=0;e.isHorizontal()?_l&&(dE=-dE):(lE=sE,sE=0,nE=-dE,dE=0),e.browser&&e.browser.need3dFix&&(Math.abs(dE)/90%2===1&&(dE+=.001),Math.abs(nE)/90%2===1&&(nE+=.001)),_m.style.zIndex=-Math.abs(Math.round(tE))+_a.length,_d.slideShadows&&zt(_m,tE);const EE=`translate3d(${sE}px, ${lE}px, 0px) rotateX(${nE}deg) rotateY(${dE}deg)`,wE=effectTarget(_d,_m);wE.style.transform=EE}},setTransition:_a=>{const _l=e.slides.map(_d=>getSlideTransformEl(_d));_l.forEach(_d=>{_d.style.transitionDuration=`${_a}ms`,_d.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(_f=>{_f.style.transitionDuration=`${_a}ms`})}),effectVirtualTransitionEnd({swiper:e,duration:_a,transformElements:_l})},recreateShadows:()=>{e.params.flipEffect,e.slides.forEach(_a=>{let _l=_a.progress;e.params.flipEffect.limitRotation&&(_l=Math.max(Math.min(_a.progress,1),-1)),zt(_a,_l)})},getEffectParams:()=>e.params.flipEffect,perspective:()=>!0,overwriteParams:()=>({slidesPerView:1,slidesPerGroup:1,watchSlidesProgress:!0,spaceBetween:0,virtualTranslate:!e.params.cssMode})})}function EffectCoverflow(_){let{swiper:e,extendParams:j,on:Vt}=_;j({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),effectInit({effect:"coverflow",swiper:e,on:Vt,setTranslate:()=>{const{width:_o,height:ga,slides:_a,slidesSizesGrid:_l}=e,_d=e.params.coverflowEffect,_f=e.isHorizontal(),_m=e.translate,tE=_f?-_m+_o/2:-_m+ga/2,rE=_f?_d.rotate:-_d.rotate,oE=_d.depth;for(let dE=0,nE=_a.length;dE<nE;dE+=1){const sE=_a[dE],lE=_l[dE],EE=sE.swiperSlideOffset,wE=(tE-EE-lE/2)/lE,IE=typeof _d.modifier=="function"?_d.modifier(wE):wE*_d.modifier;let _E=_f?rE*IE:0,kE=_f?0:rE*IE,ME=-oE*Math.abs(IE),bE=_d.stretch;typeof bE=="string"&&bE.indexOf("%")!==-1&&(bE=parseFloat(_d.stretch)/100*lE);let LE=_f?0:bE*IE,TE=_f?bE*IE:0,OE=1-(1-_d.scale)*Math.abs(IE);Math.abs(TE)<.001&&(TE=0),Math.abs(LE)<.001&&(LE=0),Math.abs(ME)<.001&&(ME=0),Math.abs(_E)<.001&&(_E=0),Math.abs(kE)<.001&&(kE=0),Math.abs(OE)<.001&&(OE=0),e.browser&&e.browser.need3dFix&&(Math.abs(_E)/90%2===1&&(_E+=.001),Math.abs(kE)/90%2===1&&(kE+=.001));const vE=`translate3d(${TE}px,${LE}px,${ME}px)  rotateX(${kE}deg) rotateY(${_E}deg) scale(${OE})`,NE=effectTarget(_d,sE);if(NE.style.transform=vE,sE.style.zIndex=-Math.abs(Math.round(IE))+1,_d.slideShadows){let jE=_f?sE.querySelector(".swiper-slide-shadow-left"):sE.querySelector(".swiper-slide-shadow-top"),UE=_f?sE.querySelector(".swiper-slide-shadow-right"):sE.querySelector(".swiper-slide-shadow-bottom");jE||(jE=createShadow("coverflow",sE,_f?"left":"top")),UE||(UE=createShadow("coverflow",sE,_f?"right":"bottom")),jE&&(jE.style.opacity=IE>0?IE:0),UE&&(UE.style.opacity=-IE>0?-IE:0)}}},setTransition:_o=>{e.slides.map(_a=>getSlideTransformEl(_a)).forEach(_a=>{_a.style.transitionDuration=`${_o}ms`,_a.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(_l=>{_l.style.transitionDuration=`${_o}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}function EffectCreative(_){let{swiper:e,extendParams:j,on:Vt}=_;j({creativeEffect:{limitProgress:1,shadowPerProgress:!1,progressMultiplier:1,perspective:!0,prev:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1},next:{translate:[0,0,0],rotate:[0,0,0],opacity:1,scale:1}}});const zt=ga=>typeof ga=="string"?ga:`${ga}px`;effectInit({effect:"creative",swiper:e,on:Vt,setTranslate:()=>{const{slides:ga,wrapperEl:_a,slidesSizesGrid:_l}=e,_d=e.params.creativeEffect,{progressMultiplier:_f}=_d,_m=e.params.centeredSlides;if(_m){const tE=_l[0]/2-e.params.slidesOffsetBefore||0;_a.style.transform=`translateX(calc(50% - ${tE}px))`}for(let tE=0;tE<ga.length;tE+=1){const rE=ga[tE],oE=rE.progress,dE=Math.min(Math.max(rE.progress,-_d.limitProgress),_d.limitProgress);let nE=dE;_m||(nE=Math.min(Math.max(rE.originalProgress,-_d.limitProgress),_d.limitProgress));const sE=rE.swiperSlideOffset,lE=[e.params.cssMode?-sE-e.translate:-sE,0,0],EE=[0,0,0];let wE=!1;e.isHorizontal()||(lE[1]=lE[0],lE[0]=0);let IE={translate:[0,0,0],rotate:[0,0,0],scale:1,opacity:1};dE<0?(IE=_d.next,wE=!0):dE>0&&(IE=_d.prev,wE=!0),lE.forEach((OE,vE)=>{lE[vE]=`calc(${OE}px + (${zt(IE.translate[vE])} * ${Math.abs(dE*_f)}))`}),EE.forEach((OE,vE)=>{let NE=IE.rotate[vE]*Math.abs(dE*_f);e.browser&&e.browser.need3dFix&&Math.abs(NE)/90%2===1&&(NE+=.001),EE[vE]=NE}),rE.style.zIndex=-Math.abs(Math.round(oE))+ga.length;const _E=lE.join(", "),kE=`rotateX(${EE[0]}deg) rotateY(${EE[1]}deg) rotateZ(${EE[2]}deg)`,ME=nE<0?`scale(${1+(1-IE.scale)*nE*_f})`:`scale(${1-(1-IE.scale)*nE*_f})`,bE=nE<0?1+(1-IE.opacity)*nE*_f:1-(1-IE.opacity)*nE*_f,LE=`translate3d(${_E}) ${kE} ${ME}`;if(wE&&IE.shadow||!wE){let OE=rE.querySelector(".swiper-slide-shadow");if(!OE&&IE.shadow&&(OE=createShadow("creative",rE)),OE){const vE=_d.shadowPerProgress?dE*(1/_d.limitProgress):dE;OE.style.opacity=Math.min(Math.max(Math.abs(vE),0),1)}}const TE=effectTarget(_d,rE);TE.style.transform=LE,TE.style.opacity=bE,IE.origin&&(TE.style.transformOrigin=IE.origin)}},setTransition:ga=>{const _a=e.slides.map(_l=>getSlideTransformEl(_l));_a.forEach(_l=>{_l.style.transitionDuration=`${ga}ms`,_l.querySelectorAll(".swiper-slide-shadow").forEach(_d=>{_d.style.transitionDuration=`${ga}ms`})}),effectVirtualTransitionEnd({swiper:e,duration:ga,transformElements:_a,allSlides:!0})},perspective:()=>e.params.creativeEffect.perspective,overwriteParams:()=>({watchSlidesProgress:!0,virtualTranslate:!e.params.cssMode})})}function EffectCards(_){let{swiper:e,extendParams:j,on:Vt}=_;j({cardsEffect:{slideShadows:!0,rotate:!0,perSlideRotate:2,perSlideOffset:8}}),effectInit({effect:"cards",swiper:e,on:Vt,setTranslate:()=>{const{slides:_o,activeIndex:ga,rtlTranslate:_a}=e,_l=e.params.cardsEffect,{startTranslate:_d,isTouched:_f}=e.touchEventsData,_m=_a?-e.translate:e.translate;for(let tE=0;tE<_o.length;tE+=1){const rE=_o[tE],oE=rE.progress,dE=Math.min(Math.max(oE,-4),4);let nE=rE.swiperSlideOffset;e.params.centeredSlides&&!e.params.cssMode&&(e.wrapperEl.style.transform=`translateX(${e.minTranslate()}px)`),e.params.centeredSlides&&e.params.cssMode&&(nE-=_o[0].swiperSlideOffset);let sE=e.params.cssMode?-nE-e.translate:-nE,lE=0;const EE=-100*Math.abs(dE);let wE=1,IE=-_l.perSlideRotate*dE,_E=_l.perSlideOffset-Math.abs(dE)*.75;const kE=e.virtual&&e.params.virtual.enabled?e.virtual.from+tE:tE,ME=(kE===ga||kE===ga-1)&&dE>0&&dE<1&&(_f||e.params.cssMode)&&_m<_d,bE=(kE===ga||kE===ga+1)&&dE<0&&dE>-1&&(_f||e.params.cssMode)&&_m>_d;if(ME||bE){const vE=(1-Math.abs((Math.abs(dE)-.5)/.5))**.5;IE+=-28*dE*vE,wE+=-.5*vE,_E+=96*vE,lE=`${-25*vE*Math.abs(dE)}%`}if(dE<0?sE=`calc(${sE}px ${_a?"-":"+"} (${_E*Math.abs(dE)}%))`:dE>0?sE=`calc(${sE}px ${_a?"-":"+"} (-${_E*Math.abs(dE)}%))`:sE=`${sE}px`,!e.isHorizontal()){const vE=lE;lE=sE,sE=vE}const LE=dE<0?`${1+(1-wE)*dE}`:`${1-(1-wE)*dE}`,TE=`
        translate3d(${sE}, ${lE}, ${EE}px)
        rotateZ(${_l.rotate?_a?-IE:IE:0}deg)
        scale(${LE})
      `;if(_l.slideShadows){let vE=rE.querySelector(".swiper-slide-shadow");vE||(vE=createShadow("cards",rE)),vE&&(vE.style.opacity=Math.min(Math.max((Math.abs(dE)-.5)/.5,0),1))}rE.style.zIndex=-Math.abs(Math.round(oE))+_o.length;const OE=effectTarget(_l,rE);OE.style.transform=TE}},setTransition:_o=>{const ga=e.slides.map(_a=>getSlideTransformEl(_a));ga.forEach(_a=>{_a.style.transitionDuration=`${_o}ms`,_a.querySelectorAll(".swiper-slide-shadow").forEach(_l=>{_l.style.transitionDuration=`${_o}ms`})}),effectVirtualTransitionEnd({swiper:e,duration:_o,transformElements:ga})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0,virtualTranslate:!e.params.cssMode})})}const modules=[Virtual,Keyboard,Mousewheel,Navigation,Pagination,Scrollbar,Parallax,Zoom,Controller,A11y,History,HashNavigation,Autoplay,Thumb,freeMode,Grid,Manipulation,EffectFade,EffectCube,EffectFlip,EffectCoverflow,EffectCreative,EffectCards];Swiper$1.use(modules);const formatValue=_=>{if(parseFloat(_)===Number(_))return Number(_);if(_==="true"||_==="")return!0;if(_==="false")return!1;if(_==="null")return null;if(_!=="undefined"){if(typeof _=="string"&&_.includes("{")&&_.includes("}")&&_.includes('"')){let e;try{e=JSON.parse(_)}catch{e=_}return e}return _}},modulesParamsList=["a11y","autoplay","controller","cards-effect","coverflow-effect","creative-effect","cube-effect","fade-effect","flip-effect","free-mode","grid","hash-navigation","history","keyboard","mousewheel","navigation","pagination","parallax","scrollbar","thumbs","virtual","zoom"];function getParams(_,e,j){const Vt={},zt={};extend$1(Vt,defaults$1);const _r=[...paramsList,"on"],_o=_r.map(_a=>_a.replace(/_/,""));_r.forEach(_a=>{_a=_a.replace("_",""),typeof _[_a]<"u"&&(zt[_a]=_[_a])});const ga=[..._.attributes];return typeof e=="string"&&typeof j<"u"&&ga.push({name:e,value:isObject$1(j)?{...j}:j}),ga.forEach(_a=>{const _l=modulesParamsList.filter(_d=>_a.name.indexOf(`${_d}-`)===0)[0];if(_l){const _d=attrToProp(_l),_f=attrToProp(_a.name.split(`${_l}-`)[1]);typeof zt[_d]>"u"&&(zt[_d]={}),zt[_d]===!0&&(zt[_d]={enabled:!0}),zt[_d][_f]=formatValue(_a.value)}else{const _d=attrToProp(_a.name);if(!_o.includes(_d))return;const _f=formatValue(_a.value);zt[_d]&&modulesParamsList.includes(_a.name)&&!isObject$1(_f)?(zt[_d].constructor!==Object&&(zt[_d]={}),zt[_d].enabled=!!_f):zt[_d]=_f}}),extend$1(Vt,zt),Vt.navigation?Vt.navigation={prevEl:".swiper-button-prev",nextEl:".swiper-button-next",...Vt.navigation!==!0?Vt.navigation:{}}:Vt.navigation===!1&&delete Vt.navigation,Vt.scrollbar?Vt.scrollbar={el:".swiper-scrollbar",...Vt.scrollbar!==!0?Vt.scrollbar:{}}:Vt.scrollbar===!1&&delete Vt.scrollbar,Vt.pagination?Vt.pagination={el:".swiper-pagination",...Vt.pagination!==!0?Vt.pagination:{}}:Vt.pagination===!1&&delete Vt.pagination,{params:Vt,passedParams:zt}}const SwiperCSS=":host{--swiper-theme-color:#007aff}:host{position:relative;display:block;margin-left:auto;margin-right:auto;z-index:1}.swiper{width:100%;height:100%;margin-left:auto;margin-right:auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1;display:block}.swiper-vertical>.swiper-wrapper{flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:flex;transition-property:transform;transition-timing-function:var(--swiper-wrapper-transition-timing-function,initial);box-sizing:content-box}.swiper-android ::slotted(swiper-slide),.swiper-ios ::slotted(swiper-slide),.swiper-wrapper{transform:translate3d(0px,0,0)}.swiper-horizontal{touch-action:pan-y}.swiper-vertical{touch-action:pan-x}::slotted(swiper-slide){flex-shrink:0;width:100%;height:100%;position:relative;transition-property:transform;display:block}::slotted(.swiper-slide-invisible-blank){visibility:hidden}.swiper-autoheight,.swiper-autoheight ::slotted(swiper-slide){height:auto}.swiper-autoheight .swiper-wrapper{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden ::slotted(swiper-slide){transform:translateZ(0);-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-3d.swiper-css-mode .swiper-wrapper{perspective:1200px}.swiper-3d .swiper-wrapper{transform-style:preserve-3d}.swiper-3d{perspective:1200px}.swiper-3d .swiper-cube-shadow,.swiper-3d ::slotted(swiper-slide){transform-style:preserve-3d}.swiper-css-mode>.swiper-wrapper{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode>.swiper-wrapper::-webkit-scrollbar{display:none}.swiper-css-mode ::slotted(swiper-slide){scroll-snap-align:start start}.swiper-css-mode.swiper-horizontal>.swiper-wrapper{scroll-snap-type:x mandatory}.swiper-css-mode.swiper-vertical>.swiper-wrapper{scroll-snap-type:y mandatory}.swiper-css-mode.swiper-free-mode>.swiper-wrapper{scroll-snap-type:none}.swiper-css-mode.swiper-free-mode ::slotted(swiper-slide){scroll-snap-align:none}.swiper-css-mode.swiper-centered>.swiper-wrapper::before{content:'';flex-shrink:0;order:9999}.swiper-css-mode.swiper-centered ::slotted(swiper-slide){scroll-snap-align:center center;scroll-snap-stop:always}.swiper-css-mode.swiper-centered.swiper-horizontal ::slotted(swiper-slide):first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-horizontal>.swiper-wrapper::before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-css-mode.swiper-centered.swiper-vertical ::slotted(swiper-slide):first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-vertical>.swiper-wrapper::before{width:100%;min-width:1px;height:var(--swiper-centered-offset-after)}.swiper-virtual ::slotted(swiper-slide){-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode .swiper-wrapper::after{content:'';position:absolute;left:0;top:0;pointer-events:none}.swiper-virtual.swiper-css-mode.swiper-horizontal .swiper-wrapper::after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical .swiper-wrapper::after{width:1px;height:var(--swiper-virtual-size)}:host{--swiper-navigation-size:44px}.swiper-button-next,.swiper-button-prev{position:absolute;top:var(--swiper-navigation-top-offset,50%);width:calc(var(--swiper-navigation-size)/ 44 * 27);height:var(--swiper-navigation-size);margin-top:calc(0px - (var(--swiper-navigation-size)/ 2));z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--swiper-navigation-color,var(--swiper-theme-color))}.swiper-button-next.swiper-button-disabled,.swiper-button-prev.swiper-button-disabled{opacity:.35;cursor:auto;pointer-events:none}.swiper-button-next.swiper-button-hidden,.swiper-button-prev.swiper-button-hidden{opacity:0;cursor:auto;pointer-events:none}.swiper-navigation-disabled .swiper-button-next,.swiper-navigation-disabled .swiper-button-prev{display:none!important}.swiper-button-next svg,.swiper-button-prev svg{width:100%;height:100%;object-fit:contain;transform-origin:center}.swiper-rtl .swiper-button-next svg,.swiper-rtl .swiper-button-prev svg{transform:rotate(180deg)}.swiper-button-prev,.swiper-rtl .swiper-button-next{left:var(--swiper-navigation-sides-offset,10px);right:auto}.swiper-button-next,.swiper-rtl .swiper-button-prev{right:var(--swiper-navigation-sides-offset,10px);left:auto}.swiper-button-lock{display:none}.swiper-pagination{position:absolute;text-align:center;transition:.3s opacity;transform:translate3d(0,0,0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-disabled>.swiper-pagination,.swiper-pagination.swiper-pagination-disabled{display:none!important}.swiper-horizontal>.swiper-pagination-bullets,.swiper-pagination-bullets.swiper-pagination-horizontal,.swiper-pagination-custom,.swiper-pagination-fraction{bottom:var(--swiper-pagination-bottom,8px);top:var(--swiper-pagination-top,auto);left:0;width:100%}.swiper-pagination-bullets-dynamic{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transform:scale(.33);position:relative}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{transform:scale(.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{transform:scale(.33)}.swiper-pagination-bullet{width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px));height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));display:inline-block;border-radius:var(--swiper-pagination-bullet-border-radius,50%);background:var(--swiper-pagination-bullet-inactive-color,#000);opacity:var(--swiper-pagination-bullet-inactive-opacity, .2)}button.swiper-pagination-bullet{border:none;margin:0;padding:0;box-shadow:none;-webkit-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet:only-child{display:none!important}.swiper-pagination-bullet-active{opacity:var(--swiper-pagination-bullet-opacity, 1);background:var(--swiper-pagination-color,var(--swiper-theme-color))}.swiper-pagination-vertical.swiper-pagination-bullets,.swiper-vertical>.swiper-pagination-bullets{right:var(--swiper-pagination-right,8px);left:var(--swiper-pagination-left,auto);top:50%;transform:translate3d(0px,-50%,0)}.swiper-pagination-vertical.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0;display:block}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;transition:.2s transform,.2s top}.swiper-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;transform:translateX(-50%);white-space:nowrap}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s left}.swiper-horizontal.swiper-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:.2s transform,.2s right}.swiper-pagination-fraction{color:var(--swiper-pagination-fraction-color,inherit)}.swiper-pagination-progressbar{background:var(--swiper-pagination-progressbar-bg-color,rgba(0,0,0,.25));position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--swiper-pagination-color,var(--swiper-theme-color));position:absolute;left:0;top:0;width:100%;height:100%;transform:scale(0);transform-origin:left top}.swiper-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{transform-origin:right top}.swiper-horizontal>.swiper-pagination-progressbar,.swiper-pagination-progressbar.swiper-pagination-horizontal,.swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite,.swiper-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:100%;height:var(--swiper-pagination-progressbar-size,4px);left:0;top:0}.swiper-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-vertical,.swiper-vertical>.swiper-pagination-progressbar{width:var(--swiper-pagination-progressbar-size,4px);height:100%;left:0;top:0}.swiper-pagination-lock{display:none}.swiper-scrollbar{border-radius:var(--swiper-scrollbar-border-radius,10px);position:relative;touch-action:none;background:var(--swiper-scrollbar-bg-color,rgba(0,0,0,.1))}.swiper-scrollbar-disabled>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-disabled{display:none!important}.swiper-horizontal>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-horizontal{position:absolute;left:var(--swiper-scrollbar-sides-offset,1%);bottom:var(--swiper-scrollbar-bottom,4px);top:var(--swiper-scrollbar-top,auto);z-index:50;height:var(--swiper-scrollbar-size,4px);width:calc(100% - 2 * var(--swiper-scrollbar-sides-offset,1%))}.swiper-scrollbar.swiper-scrollbar-vertical,.swiper-vertical>.swiper-scrollbar{position:absolute;left:var(--swiper-scrollbar-left,auto);right:var(--swiper-scrollbar-right,4px);top:var(--swiper-scrollbar-sides-offset,1%);z-index:50;width:var(--swiper-scrollbar-size,4px);height:calc(100% - 2 * var(--swiper-scrollbar-sides-offset,1%))}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:var(--swiper-scrollbar-drag-bg-color,rgba(0,0,0,.5));border-radius:var(--swiper-scrollbar-border-radius,10px);left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}::slotted(.swiper-slide-zoomed){cursor:move;touch-action:none}.swiper .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-free-mode>.swiper-wrapper{transition-timing-function:ease-out;margin:0 auto}.swiper-grid>.swiper-wrapper{flex-wrap:wrap}.swiper-grid-column>.swiper-wrapper{flex-wrap:wrap;flex-direction:column}.swiper-fade.swiper-free-mode ::slotted(swiper-slide){transition-timing-function:ease-out}.swiper-fade ::slotted(swiper-slide){pointer-events:none;transition-property:opacity}.swiper-fade ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-fade ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-fade ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-cube{overflow:visible}.swiper-cube ::slotted(swiper-slide){pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;transform-origin:0 0;width:100%;height:100%}.swiper-cube ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-cube.swiper-rtl ::slotted(swiper-slide){transform-origin:100% 0}.swiper-cube ::slotted(.swiper-slide-active),.swiper-cube ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-cube ::slotted(.swiper-slide-active),.swiper-cube ::slotted(.swiper-slide-next),.swiper-cube ::slotted(.swiper-slide-prev){pointer-events:auto;visibility:visible}.swiper-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0px;width:100%;height:100%;opacity:.6;z-index:0}.swiper-cube .swiper-cube-shadow:before{content:'';background:#000;position:absolute;left:0;top:0;bottom:0;right:0;filter:blur(50px)}.swiper-cube ::slotted(.swiper-slide-next)+::slotted(swiper-slide){pointer-events:auto;visibility:visible}.swiper-flip{overflow:visible}.swiper-flip ::slotted(swiper-slide){pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-flip ::slotted(swiper-slide) ::slotted(swiper-slide){pointer-events:none}.swiper-flip ::slotted(.swiper-slide-active),.swiper-flip ::slotted(.swiper-slide-active) ::slotted(.swiper-slide-active){pointer-events:auto}.swiper-creative ::slotted(swiper-slide){-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}.swiper-cards{overflow:visible}.swiper-cards ::slotted(swiper-slide){transform-origin:center bottom;-webkit-backface-visibility:hidden;backface-visibility:hidden;overflow:hidden}",SwiperSlideCSS="::slotted(.swiper-slide-shadow),::slotted(.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-top){position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}::slotted(.swiper-slide-shadow){background:rgba(0,0,0,.15)}::slotted(.swiper-slide-shadow-left){background-image:linear-gradient(to left,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-right){background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-top){background-image:linear-gradient(to top,rgba(0,0,0,.5),rgba(0,0,0,0))}::slotted(.swiper-slide-shadow-bottom){background-image:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,0))}.swiper-lazy-preloader{animation:swiper-preloader-spin 1s infinite linear;width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;transform-origin:50%;box-sizing:border-box;border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top-color:transparent}@keyframes swiper-preloader-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-cube.swiper-slide-shadow-top){z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-bottom),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-left),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-right),::slotted(.swiper-slide-shadow-flip.swiper-slide-shadow-top){z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}::slotted(.swiper-zoom-container){width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-align:center}::slotted(.swiper-zoom-container)>canvas,::slotted(.swiper-zoom-container)>img,::slotted(.swiper-zoom-container)>svg{max-width:100%;max-height:100%;object-fit:contain}";class DummyHTMLElement{}const ClassToExtend=typeof window>"u"||typeof HTMLElement>"u"?DummyHTMLElement:HTMLElement,arrowSvg=`<svg width="11" height="20" viewBox="0 0 11 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.38296 20.0762C0.111788 19.805 0.111788 19.3654 0.38296 19.0942L9.19758 10.2796L0.38296 1.46497C0.111788 1.19379 0.111788 0.754138 0.38296 0.482966C0.654131 0.211794 1.09379 0.211794 1.36496 0.482966L10.4341 9.55214C10.8359 9.9539 10.8359 10.6053 10.4341 11.007L1.36496 20.0762C1.09379 20.3474 0.654131 20.3474 0.38296 20.0762Z" fill="currentColor"/></svg>
    `,addStyle=(_,e)=>{if(typeof CSSStyleSheet<"u"&&_.adoptedStyleSheets){const j=new CSSStyleSheet;j.replaceSync(e),_.adoptedStyleSheets=[j]}else{const j=document.createElement("style");j.rel="stylesheet",j.textContent=e,_.appendChild(j)}};class SwiperContainer extends ClassToExtend{constructor(){super(),this.attachShadow({mode:"open"})}static get nextButtonSvg(){return arrowSvg}static get prevButtonSvg(){return arrowSvg.replace("/></svg>",' transform-origin="center" transform="rotate(180)"/></svg>')}cssStyles(){return[SwiperCSS,...this.injectStyles&&Array.isArray(this.injectStyles)?this.injectStyles:[]].join(`
`)}cssLinks(){return this.injectStylesUrls||[]}calcSlideSlots(){const e=this.slideSlots||0,j=[...this.querySelectorAll("[slot^=slide-]")].map(Vt=>parseInt(Vt.getAttribute("slot").split("slide-")[1],10));if(this.slideSlots=j.length?Math.max(...j)+1:0,!!this.rendered){if(this.slideSlots>e)for(let Vt=e;Vt<this.slideSlots;Vt+=1){const zt=document.createElement("swiper-slide");zt.setAttribute("part",`slide slide-${Vt+1}`);const _r=document.createElement("slot");_r.setAttribute("name",`slide-${Vt+1}`),zt.appendChild(_r),this.shadowRoot.querySelector(".swiper-wrapper").appendChild(zt)}else if(this.slideSlots<e){const Vt=this.swiper.slides;for(let zt=Vt.length-1;zt>=0;zt-=1)zt>this.slideSlots&&Vt[zt].remove()}}}render(){if(this.rendered)return;this.calcSlideSlots();let e=this.cssStyles();this.slideSlots>0&&(e=e.replace(/::slotted\(([a-z-0-9.]*)\)/g,"$1")),e.length&&addStyle(this.shadowRoot,e),this.cssLinks().forEach(Vt=>{if(this.shadowRoot.querySelector(`link[href="${Vt}"]`))return;const _r=document.createElement("link");_r.rel="stylesheet",_r.href=Vt,this.shadowRoot.appendChild(_r)});const j=document.createElement("div");j.classList.add("swiper"),j.part="container",j.innerHTML=`
      <slot name="container-start"></slot>
      <div class="swiper-wrapper" part="wrapper">
        <slot></slot>
        ${Array.from({length:this.slideSlots}).map((Vt,zt)=>`
        <swiper-slide part="slide slide-${zt}">
          <slot name="slide-${zt}"></slot>
        </swiper-slide>
        `).join("")}
      </div>
      <slot name="container-end"></slot>
      ${needsNavigation(this.passedParams)?`
        <div part="button-prev" class="swiper-button-prev">${this.constructor.prevButtonSvg}</div>
        <div part="button-next" class="swiper-button-next">${this.constructor.nextButtonSvg}</div>
      `:""}
      ${needsPagination(this.passedParams)?`
        <div part="pagination" class="swiper-pagination"></div>
      `:""}
      ${needsScrollbar(this.passedParams)?`
        <div part="scrollbar" class="swiper-scrollbar"></div>
      `:""}
    `,this.shadowRoot.appendChild(j),this.rendered=!0}initialize(){var e=this;if(this.initialized)return;this.initialized=!0;const{params:j,passedParams:Vt}=getParams(this);this.swiperParams=j,this.passedParams=Vt,delete this.swiperParams.init,this.render(),this.swiper=new Swiper$1(this.shadowRoot.querySelector(".swiper"),{...j.virtual?{}:{observer:!0,observeSlideChildren:this.slideSlots>0},...j,touchEventsTarget:"container",onAny:function(zt){zt==="observerUpdate"&&e.calcSlideSlots();const _r=j.eventsPrefix?`${j.eventsPrefix}${zt.toLowerCase()}`:zt.toLowerCase();for(var _o=arguments.length,ga=new Array(_o>1?_o-1:0),_a=1;_a<_o;_a++)ga[_a-1]=arguments[_a];const _l=new CustomEvent(_r,{detail:ga,bubbles:zt!=="hashChange",cancelable:!0});e.dispatchEvent(_l)}})}connectedCallback(){this.initialized&&this.nested&&this.closest("swiper-slide")&&this.closest("swiper-slide").swiperLoopMoveDOM||this.init===!1||this.getAttribute("init")==="false"||this.initialize()}disconnectedCallback(){this.nested&&this.closest("swiper-slide")&&this.closest("swiper-slide").swiperLoopMoveDOM||(this.swiper&&this.swiper.destroy&&this.swiper.destroy(),this.initialized=!1)}updateSwiperOnPropChange(e,j){const{params:Vt,passedParams:zt}=getParams(this,e,j);this.passedParams=zt,this.swiperParams=Vt,!(this.swiper&&this.swiper.params[e]===j)&&updateSwiper({swiper:this.swiper,passedParams:this.passedParams,changedParams:[attrToProp(e)],...e==="navigation"&&zt[e]?{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"}:{},...e==="pagination"&&zt[e]?{paginationEl:".swiper-pagination"}:{},...e==="scrollbar"&&zt[e]?{scrollbarEl:".swiper-scrollbar"}:{}})}attributeChangedCallback(e,j,Vt){this.initialized&&(j==="true"&&Vt===null&&(Vt=!1),this.updateSwiperOnPropChange(e,Vt))}static get observedAttributes(){return paramsList.filter(j=>j.includes("_")).map(j=>j.replace(/[A-Z]/g,Vt=>`-${Vt}`).replace("_","").toLowerCase())}}paramsList.forEach(_=>{_!=="init"&&(_=_.replace("_",""),Object.defineProperty(SwiperContainer.prototype,_,{configurable:!0,get(){return(this.passedParams||{})[_]},set(e){this.passedParams||(this.passedParams={}),this.passedParams[_]=e,this.initialized&&this.updateSwiperOnPropChange(_,e)}}))});class SwiperSlide extends ClassToExtend{constructor(){super(),this.attachShadow({mode:"open"})}render(){const e=this.lazy||this.getAttribute("lazy")===""||this.getAttribute("lazy")==="true";if(addStyle(this.shadowRoot,SwiperSlideCSS),this.shadowRoot.appendChild(document.createElement("slot")),e){const j=document.createElement("div");j.classList.add("swiper-lazy-preloader"),j.part.add("preloader"),this.shadowRoot.appendChild(j)}}initialize(){this.render()}connectedCallback(){this.initialize()}}const register=()=>{typeof window>"u"||(window.customElements.get("swiper-container")||window.customElements.define("swiper-container",SwiperContainer),window.customElements.get("swiper-slide")||window.customElements.define("swiper-slide",SwiperSlide))};typeof window<"u"&&(window.SwiperElementRegisterParams=_=>{paramsList.push(..._)});register();client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
